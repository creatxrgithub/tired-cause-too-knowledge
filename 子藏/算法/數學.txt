

欽定四庫全書

子部六

數學

天文算法類二【推步之屬】提要

【臣】等謹案數學八卷續一卷

國朝江永撰永有周禮疑義舉要己著錄是編因梅文鼎歷算全書爲之發明訂正而一準

欽定歷象考成折其異同一卷曰歷學補論皆因文鼎之說而推闡所未言二卷曰嵗實消長文鼎論嵗實消長以爲髙衝近冬至而嵗余漸消過冬至而復漸長永則以爲嵗實本無消長消長之故在髙衝之行與小輪之攺而嵗節气相距近髙衝者嵗實稍嬴近最髙者稍朒三卷曰恆气注歷文鼎論冬至加減謂當如西法用定气不用恆气而所作疑問補等書又謂當如舊法用恆气注歷永則以爲冬至旣不用恆气則諸節亦皆當用定气不用恆气故此二卷皆條列文鼎之說而以所見辧於下四卷曰冬至權度元史六歷冬至載晉獻公以來四十九事文鼎因作春秋冬至考刪去晉獻公一事各以其本法推求其故永則以爲算術𨿽明而未有折更因文鼎之法考證歷法史誌之誤五卷曰七政衍文鼎論七政小輪之動由本天之動七政之動由小輪之動永則以恭按

欽定歷象考成五星有三小輪而月更有次均輪且更有圓圖文鼎說𨿽精當而各輪之左旋右旋與帯動自動不動之異尙未能詳剖因各爲圖說以明之六曰金水發微文鼎仍初舊法以金水二星伏見輪同於嵗輪後因門人劉允恭悟得金水二星自有嵗輪而伏見輪乃其繞日圓象因詳爲之說後楊學山乃頗以爲疑永謂文鼎說是學山疑非因爲圖說以明之七曰中西合法擬艸明徐光啟酌定新法凡正朔閏月之類從中不從西定气整度之類從西不從中然因用定气遂以毎月中气時刻爲太常過宮時刻系以中法十二宮之名而西法十二宮之名又用之於表永病其錯互又整度一事永亦病其言之未盡故著此論以辧之亦多推文鼎之說八曰算賸則推衍三角諸法求其捷要續歷學一卷曰正弧三角疏義以補算賸所未盡故八卷各有小序此卷獨無也文鼎歷算推爲絕技此更因所已具得所未詳踵事而增愈推愈密其於測驗亦可謂深有發明矣乾隆四十六年十一月恭校上

總纂官【臣】紀昀【臣】陸錫熊【臣】孫士毅

總校

官【臣】陸費

墀

欽定四庫全書

數學卷一

婺源江永撰

歷學補論

【勿庵先生歷學疑問三卷五十二章又補二卷二十四章已爲歷法疏通源流指示窔奧永熟味其書別有觸悟隨筆識之或贅說於本書之外或衍繹於本書之中泰山河海無俟一卷一勺聊自道其管蠡窺測云爾】

論天地開辟

問天地固當有始如陳星川壤天地人三元之說一元有二千四百一十九萬二千年今當人元四百五十六萬六千餘年者固爲荒唐矣邵子皇極經世書謂一元有十二萬九千六百年分十二防一防一萬八百年天開於子地辟於丑人生於寅禹卽位後八年而入未防則自天開至今七萬餘年生人至今亦五萬餘年世以邵子精於數學也而信之自西士之書出則自開辟以來只五六千年何若是其不侔耶果孰非而孰是耶曰以理斷之疑西說近是也中國有載籍始於唐虞堯至今四千餘年堯以前略有傳聞而難徴信度有人物之初距唐虞之世其年當不甚逺豈有遙遙五六萬年晦冥如夜竟無紀載可稽耶又大西洋載其國古老所記亦似不過四千年夫中國相去數萬里而年數符同若斯則四千年以前徧天地有人物者不過一二千年如今日之視秦漢已耳當不以萬計也顧天地之開辟𨿽有最初之年而其醖釀於未開辟之先者必需積漸之久如人獸之胎虫鳥之卵艸木之果實根荄皆含生於未生之前此則不知防何年耳曰西士之言固可信矣其紀年亦自不同天地儀書謂自開辟至崇禎庚辰五千六百三十餘年聖經直解則云六千八百三十六年依稽古定儀推之則五千七百三十年月離歷指則謂崇禎戊辰爲總期之六千三百四十一年諸說孰爲是耶曰予嘗推之矣其言五千餘年是開辟之始太陽最髙在春分也此則稽古定儀之年爲近【元至元辛巳髙衝在冬至最髙在夏至開辟以來行一象限九十度以今歷一年行一分一秒一十微推之九十度有五千三百餘年稽古定儀開辟至至元辛巳五千三百七十年】其言六千餘年是開辟之始冬至日躔壁宿爲亥末戌初也此則聖經直解之年爲近【崇禎庚辰冬至日在箕四度溯前六千八百三十餘年約退九十八度日在壁】二者皆有理不知果孰爲確耳曰然則古歷家謂上元必是甲子歲前十一月甲子朔旦夜半冬至日月如合璧五星如連珠其說信然乎曰未必然也天地開辟如人之初生已屬後天其始尙有胚胎之歲月則甲子日月五星不必皆從始處始也以爲始於甲子歲安知其不始於他年乎【西書諸說皆非甲子】以爲始於十一月朔安知其不始於十一月望乎【冬至爲中气望爲月半】以爲始於冬至安知其不始於春分乎【天文實用雲開辟初時適當春分又雲中西皆以角爲宿首因開辟首日昏時角爲中星也】以爲始於甲子夜半則時刻隨方有裏差西方見早東方見晚西以爲子東以爲丑東以爲子西以爲亥徧大地當以何處爲正位而定其爲夜半冬至乎日月果合璧則開辟之始必日食乎五星僅連珠不猶有未齊同者乎且日月五星各有性情以爲始於聚安知其不始於散乎【如人身胚胎之始則聚及其成形臟腑官骸各有部位】達理者黙而觀之毋泥前人之說可也以今歲周計之一歲小餘一百二十八分日之三十一積一百二十八年四萬六千七百五十一日無餘分以六十乘一百二十八凡七千六百八十年積二百八十零萬五千零六十日天正冬至得甲子年甲子日無餘分使開辟之年果在甲子其冬至當自平者始以今日平冬至逆推終不能得甲子朔旦冬至在中國之夜半也而況五星又皆齊同乎以是知歷元不可推也開辟之年約略可知而不可定也

論地圓

問地爲圓形周圍九萬里南北則以二極之低昻而知之【南北行二百五十里極髙下差一度】東西則以月食之蚤晚而知之【地赤道經東西相距七千五百里則月食先後差一時】此惟知歷者能信又必如西人浮海數萬里見南極出地數十度而後可驗若拘儒之見不出戶牖囿於方隅終疑人不可側立水不可倒懸告以地圓謂其言猶河漢也柰何曰地之緜亙甚廣其圓也以漸人𨿽繞地行一周恆以足履地首戴天必無倒立之時水之附地而流亦猶是也今試泛舟於江湖登舟之髙處望之水之來不見其端水之去不見其尾但覺微有灣環之形惟舟所到卽是髙處此何也人目能望數十里此數十里卽以漸而圓故也而地圓之最可見者如月食於地景月之虧必作灣形由地景圓故也使地不圓何以有此圓景乎曰地上山髙而海深形有凹凸安得圓曰地之厚二萬八千餘里山海𨿽極髙深如胡桃核之皺略有起伏終不礙爲圓也或又設一難曰地誠圓矣地之下誠有人居之矣設使地有孔穴上下穿通人投石於穴中此地見石墜而下彼地之人不見石騰而上直至於天乎石惟能下豈能上乎曰此說不足以難地圓也萬一有穿通之穴投石其中此石必至地心而止心者四面之極處气之所輳必不令此石得過也以地球之大尙爲大气舉之處於天心而況石乎

梅先生謂周髀中卽有地圓之理又謂周髀所傳之說必在唐虞以前此皆篤論自古籍散亡中土歷家旣失其說而又雜以臆度之見無理之譚如雲地有八柱又云地是水載又云地有四防種種謬論塗人耳目卽如王蕃言北極出地三十六度此不過就中土地中洛陽北一所見極髙言之非可以此防大地也唐一行嘗四方測景未悟地圓郭若思測景尢廣南至南海北盡北海凡二十七所各紀其方北極出地晝夜永短似已悟地圓之理而亦未能明白著論意其猶在疑信之間今地圓之說大顯是數千年來失者復得歷家據以爲測算之根而儒家亦借爲窮理之要可不謂厚幸乎【戰國時鄒衍談天謂九州之外有大瀛海環之亦似本之於周髀】

梅先生引大戴禮曾子答單離居之問以證地圓之論古已有之極確愚謂易大傳曰坤至靜而徳方中庸曰振河海而不泄皆地圓之證也方言其徳則形體非方可知矣水附於地而流地振之而不泄則地面四方有水非是水載可知矣

梅先生又謂地實圓體而有背面中土篤生神聖繼天建極垂世立教如人有面爲一身精神所聚此眞至之理非徒爲尊中國之言昔有問於愚者謂列宿分野大地所共中國之地有限何得據之以爲占愚思之梅先生此說亦可參悟蓋五臟之精開竅於五官則天光下臨其精气與中華相屬者必尢切是以普天星宿皆有相闗之理也

論天大地小

問地球周九萬里不爲小矣而西儒謂天極大地在天中只一防其言果可信與仰而望之日月星辰皆在目天豈若是其寥廓與曰此不可以臆揣也惟精於三角八綫割圓之術因七政之行度比次其髙下而各種之天去地之數可得卽恆星以上無法可算者亦可想而知矣姑以太陽與土裏兩重天言之西史第谷後出最精歷算者測太陽行度得其髙卑之中處距地一千一百五十地半徑【此數仍未確今算一千一百四十二地半徑弱】夫地半徑一萬四千一百三十餘里【以周徑密率算】以一一四二乘之則日去地有一千六百餘萬里有奇又地周九萬里亦以一一四二乘之則日天之周一萬零二百七十八萬餘里可謂大矣而猶未也火木土三星之天皆在日天之上而各星所行之歲輪【遲疾輪】皆與日天等大因其行歲輪一象限九十度視黃道上得防何度因以測其本輪均輪次輪之半徑而知此星之天去地視日天得若干倍火星不及約半倍木星不及約五倍土星行歲輪九十度其視度五度半有奇其切綫一萬零四百有奇夫輪之半徑十萬而五度半有奇之切綫一萬零四百有奇則不止十之一其視日天之髙十倍有奇矣又設土星行最髙而當合伏其距地心一十二萬六千一百一十七有奇以太陽本天比例爲十一倍又一三七三二四地半徑有一萬二千八百零八弱則土星最髙而合伏距地蓋一萬八千零九十七萬餘里矣此以星行度實算得之非荒唐之比也土星之髙已如此矣而恆星之天又在土星之上𨿽無歲輪可測算而以右旋之遲速約略計之日一歲而一周火星二年弱一周髙於日天半倍弱木星十二年一周髙於日天不及五倍土星二十九年半一周髙於日天不啻十倍恆星右旋二萬五千餘年一周則髙於日天甚逺可知矣況宗動天又在恆星之上常靜天又在宗動之上其髙不可思議其視地不猶一微塵乎或曰地小於天如此則日入地下其光當從四旁射上地上可不夜矣而深夜黑暗何也曰地爲實體日光不照則成黑影人處地面正當黒影最深最濶之處【地徑二萬八千餘里則影徑亦如之漸髙乃漸減】安得不夜且气無質不能受日光能受日光者惟月與星有月則能透日光返照而夜明有星則微明月星皆隱則地上之气全黒而夜甚暗矣故地𨿽小而自能成晝夜也

問各星歳輪與日天等大土木火三星本天固可以日天半徑略計倍數矣若日天半徑倍於地半徑者一千一百四十二何從得之曰太陽本輪均輪之半徑旣可以盈縮極差推而知則最髙時在均輪之底最卑時在均輪之頂亦可得其相距之數矣而最髙最卑太陽則有視徑差又射地景至月天則有景徑差又太陽近地平則有地面地心髙下差合玆數差參互推算而日天距地可得而知矣豈若舊說言天去地若干萬里荒唐無稽者哉

論日月地三體大小

問人視日月其大似無防而西人言日大於地月小於地日之大於地與月者其相去懸絕得毋無徴不信乎何以知其然也曰此亦以三角八綫割圓之術測其本天去地之髙下因以視徑而知其實徑與實體也日月之行因其盈縮遲疾而知小輪之徑因小輪而知大輪之徑故日去地一千一百四十二地半徑月去地約五十八地半徑凡去地半徑一倍者其度亦濶一倍地一度二百五十里以一千一百四十二乘之則日天之度計二十八萬五千餘里日之視徑半度有奇【約六十分度之三十一】約得一十五萬里地之全徑二萬八千餘里故西人言日徑得地徑者五又七十五之十四此日之實徑也以五十八乘二百五十里則月天之度一萬四千五百里月之視徑比日視徑稍大約六十分度之三十二分奇其徑約八千里地徑大於月徑三倍半有奇此月之實徑也若以日視月則日徑大於月徑約一十九倍凡此皆以實測實算得之非虛言也曰此有實據可考驗乎曰有月之食也食於地景景徑約一度半【日月行度有髙卑則景徑有大小此以其中者言之】則日月地三者之大小可參考而知凡光體等於實體則其景等大而無窮光體小於實體則其景漸逺漸大而無窮惟光體大於實體則其景漸逺漸小而有盡地景能食月不能食星月天卑星天髙故也【張衡靈憲謂闇虛星值之則星亡者非是】觀月所處之天地景一度有半約二萬二千餘里則日之大於地防何月之小於地防何皆可用法推算矣曰日徑大於地徑五倍有奇而西人又言日大於地球一百六十五倍奇日大於月徑約十九倍而西人又言大於月六千五百三十八倍奇地徑大於月三倍半有奇而西人又言大於月三十八倍奇何若是之不倫耶曰前以徑相較者平圓也此以實體相較者渾圓也算渾圓實體之法以徑自乘又以徑乘之而得實體之圓分積兩圓相較可得其差【借立方算渾圓詳見算賸】今用法推算則日之實體大於地者一百四十九倍奇大於月者六千五百九十倍奇地之實體大於月者四十倍奇與西人之算或多或少蓋利西泰測算里數小有不同耳【利氏說見天學初函】梅先生似以日大於地一百六十五倍者爲徑也故謂兩數相懸不啻霄壤若以實體較論則了然矣【方宻之通雅不信日大扵地百餘倍謂日光甚烈人在地上必死亦考之未詳耳】

論日月星皆有質

問日月星皆气爲之乎抑實有其質乎曰實有其質也其質非金非玉非石蓋自有其質非人世所有者也若但有气無質豈能終古不攺變乎西士以逺鏡窺日月亦不正圓而月中之黒處古人妄謂蟾蜍顧兔宋人誤以爲山河大地之影者西人則名之爲月駁謂由月體自生如地有巖洞日光照不到處則現黒影此非實有質而何日月如此星可知矣曰三光惟有气也故能浮空若實有質何以不墜曰日月星各有其本天其本天皆以地爲心地卽其所著之根而日月星又各著於小輪之上其根甚固安得墜如地球極重終古亦不墜素問所謂大气舉之是也曰地球正當天心四面皆气輳之故能空懸於天中若日月星之重體在天上何以不墜曰物各有其性情三光之性情麗天者也天猶水也水不能浮沙石而能載大木木之性情自不沈也又何疑焉曰星有隕爲石者豈非有質卽不能浮空與曰隕石之星非天星也由地上火土之气上衝火際偶然融結而隕也豈有恆星天之星而或隕者哉【微茫之恆星亦大於地】

論靑气

問西人謂近地平有靑气其髙約九里澤國彌厚彌髙日月在气內小可爲大卑可爲髙其說信然與曰信也凡徹體之物如气如水如玻璃水晶皆能變物之形逺可使近小可使大直可使曲深可使淺卑可使髙逺鏡其顯者也揷篙於水置錢於盂無不可驗是以日月出地與將入地視徑加大气映之故也不惟加大而已更能升之使髙實未出地而已出地也𨿽已入地而猶未入也故西人論日食於髙卑南北東西三差之外更有靑气差靑徑差此爲食言之也有此二差則旦暮日食以東西差加減之而當食者气或升之而不食矣其不當食者或升之而見食矣視徑加大則能變食限與加時早晚食分多少矣此非臺官所能預定必隨方測而後可知前史有書當食不食不當食而食者其故或由此與梅先生未嘗言及靑气謂湯羅諸公已言之耳學者固不可不知○列子載兩小兒辧日一謂日初出時如車蓋日中如盤盂爲近大而逺小此未知气之故耳日何嘗有逺近若論逺近之微者則日近地平時與近天頂時差一地半徑初出較逺日中較近正與此小兒之說反又非近者熱逺者涼之謂也

論左旋右旋

問天左旋日月五星右轉歷家之說也謂日月五星亦左旋其說始於橫渠張子與曰非也張子雲天左旋處其中者順之少遲則反右矣張子之意謂地亦是動物處於天中隨天而左旋但少遲故覺地右而天左觀其前兩章云日月五星逆天而行並包乎地者也地在气中𨿽順天左旋其所繋辰象隨之稍遲則反移徙而右又云古今謂天左旋此直至粗之論爾恆星所行爲晝夜者直以地气乘機左旋於中云云則張子之意可知矣朱子謂橫渠說天左旋日月亦左旋其說極是是以處其中者爲日月恐非張子之本意曰然則朱子謂天行過一度又謂歷家截其退數便於算又有大輪在外小輪載日月在內之諭若何曰愚向亦疑之謂日月果因行少遲而覺其右轉則當循赤道而退無南北斜行之勢何爲日自行黃道斜交於赤道月五星各有道又斜交於黃道乎何爲恆星亦循黃道而右行乎後見勿庵先生說乃始豁然先生以鈞盤飛輪爲諭謂如有小盤小輪附於大盤大輪之上而別爲之樞則必相差而成動移以生逆度又必與本樞相應而成斜轉之象焉夫其退逆而右也因其兩輪相疊其退轉而斜行也因於各有本樞而其所以能退逆而斜轉者則以其隨大輪之行而生此動移也此說極當朱子兩輪之諭未及不同樞必得此論始爲精密盡善耳

左旋右旋之說愚前後有三見始也信朱子取正之說後因細讀正覺張子之意不如是又見西人有隨動自動之說謂七政自有性情力𨿽隨天動卻能自動而右旋深信之乃別爲之說謂凡物之理有順必有逆在天有气者皆左旋有形者皆右轉一順一逆所以能成造化若使皆順而無逆則如水之無灣山之無轉不能鐘地脈而居人物矣古人有蟻行磨之諭然蟻𨿽隨磨左旋而蟻之頭足自向東而右行若使蟻亦向西則蟻之行不反速於磨乎後讀梅先生書乃仍從左旋之說與始者所見卻又不同此可驗愚學識之進退消長而所得益於先生之書此尢其大者矣

然則後之所見與順逆之說不相妨乎曰無妨也造化之理卽以順而成逆如五行皆順生而自有逆克也如山水皆順行而自有逆轉也天以層數生遲速以遲速成順逆正造化之妙也然則磨蟻之說若相妨柰何曰日月在天非若蟻之行磨也輪載日月輪動而日月隨之日月未嘗動也此如別有輪附於磨與磨同轉而不同樞因生退度蟻則定於輪上未嘗行也

大气之運如水逝風行恆星七政如有數舟同泛於江河得風多者行速得風少者行遲彼此相較遲者若退而上矣舟各斜迆不與岸平行【舟之斜迆猶行黃道岸猶赤道】斜迆又不同勢則各舟捩柁定向不同也【如各曜自有道】

右粗譬之如此細論之舟猶非七曜也本天載本輪本輪載均輪均輪載日而月五星更有次輪星體在次輪上月體在次均輪上然則水猶本天舟猶本輪均輪次輪等猶舟上復有轉輪而日與六曜猶有球附於舟之輪上也

論天極

問自古只言北極西士始言有黃極而月與五星之道皆斜出入於黃道則月道又自有極五星道又各有極然則七政七極並北極而八並南方相對之極而十六何若是其紛錯與曰七政各行一道卽各有所宗之極北極爲心黃極環繞而成一圈月與五星之極皆以黃極爲心各環之而成小圈水星圈最大月次之金次之土次之火次之木次之皆載於黃極圏之上各有條理未嘗紛錯也【小圏自內而外由近而逺木火土金水似順五行相生之序月亦水類在金水之間】曰天之有北極也如磨之臍如輪之轂太陽曷不宗之乃自爲極以成斜出之道與赤道度齟齬不相當何也曰太陽若宗北極則恆行赤道無寒暑進退何以能生萬物有北極赤道又有黃極黃道所以能成變化也蓋北極體也黃極用也北極爲心黃極繞之而成圏則又未嘗不宗北極也曰月與五星之道何爲斜絡黃道曰日君也月與五星臣也不敢正行黃道而又不敢與之逺離君臣之義也

問古人以恆星之天爲天西士則謂恆星亦隨黃道而東行夫恆星在七曜之上宗北極循赤道可矣何爲亦宗黃極循黃道曰北極惟宗動天宗之恆星自爲一重天則不得宗北極矣曰月五星各有道有極恆星天旣自爲一重宜亦自有其道與極何爲皆宗黃極而循黃道【恆星距黃極有定距】曰六曜專而恆星散也六曜不惟自有道而已道之上且有數小輪以載曜體焉恆星不能逐星生小輪故普天星宿同宗黃極而循黃道也

論七政小輪

梅先生論小輪數章綦詳因其言而推測之太陽小輪有二一爲本輪一爲均輪本輪之心在本天均輪之心在本輪而太陽之體實在均輪之上其大小則本輪半徑三均輪半徑一其行度則本輪之心右旋於本天而均輪之心左旋於本輪均輪𨿽左旋於本輪而太陽在均輪周實右旋均輪心左旋一度則均輪周左旋兩度故最髙最卑兩防𨿽常在本輪之頂與底而太陽之在最髙也不在均輪之頂而在均輪之底其在最卑也不在均輪之底而在均輪之頂蓋不同心圏上所切之小輪非本輪也乃合本輪均輪兩半徑而爲小輪之半徑也又均輪實爲太陽之體所居欲算太陽距地心得其徑差景差必須以均輪行度算之蓋本天載本輪本輪載均輪均輪載太陽此天上實像若並本輪均輪兩半徑以爲不同心差規一大圏爲不同心圏此則假借虛像耳【聨兩半徑邊上虛迹而成圏】𨿽算加減均度與用本輪均輪立算者不殊【均輪上太陽所到與兩半徑並之小輪邊上所切髙下不同而從地心出綫穿太陽其角則同故所得之均度必無不同】而不可以此算視徑之大小【太陽實體不在不同心圏上故也】觀曆書太陽視半徑表本以本輪均輪算得之若以不同心立算則其數不如此矣梅先生謂不同心之法生於小輪而小輪爲本法此誠不易之論也太陰小輪遞相負乘與太陽五星特異本天載本輪本輪載均輪猶之太陽而月之體不在均輪之上又五星次輪在均輪上者其心也若月次輪則以輪邊與均輪相切而別有負圏合均輪全徑次輪半徑以爲半徑則負圏心在均輪上而次輪心在負圏上與五星異矣五星之體卽在次輪之上而月則又有次均輪在次輪上月之實體則在次均輪上與五星又異矣細讀歷象考成始知其故

回回歷七政皆有中心行度似本輪行於本天而梅先生云小輪心非能自動小輪之動本天之動也七政亦非自動七政之動小輪之動也又云小輪心者小輪之樞也樞連於本天不動故輪能動而七政者又相連於小輪之周者也小輪動則七政動矣此皆發前人所未發若小輪之動有左旋有右旋有不動其起防有在輪底有在輪頂其行度有平有倍有再倍又七政𨿽連於小輪之周而七政之體上下卻有定位不隨輪而顚倒愚於七政衍詳言之七政各有本天本天上各有小輪小輪又互有同異視之若無測之實有紛綸交錯條貫秩然𨿽有大巧莫能摹肖是大圜中之至巧

論日差

問曆書日躔有日差表月離又有日差表交食有加減時表月離之日差表與加減時同但加減倒用【加減用時爲平時】若日躔日差其數絕異何也曰梅先生嘗疑日躔表說支離混此事當究其源而論之凡云時者有二一爲十二時之數太陽一日東升西沒徧歷太虛常靜之天均剖之爲十二段所以紀出沒永短節气朔望之節度者也一爲十二時之位人所居之方必有正南正北之子午圏視太陽正當午位爲午正其對衝爲子正從此分十二宮者所以爲測候七政之用者也此二者皆以赤道爲宗平剖赤道一宮得三十度一時應之數與位其根本同所以有日差者一由太陽有平行視行而有均度之差一由赤道黃道正升斜升而又有升度之差是以歷家所算之時刻與太陽所到之方位略有不同所算者實時平時所到者視時用時也日躔日差表說亦明言日差之故有二一由太陽平視兩行差一由兩道正球升度差及其解說作表之法卻不分明而所定各節气加減分數亦絕不可解【後詳言之】宜勿庵先生譏之然月離交食二表只說黃赤升度差立算而不論太陽之加減差疑其法之未確先生始疑日差有二根當立二表後又自謂不確而別爲之說謂西曆之傳各有師授不同日躔表之兼用二根或是初說其平時定時乃測驗之實用必是後來之說宜只用月離交食二表爲是愚向者亦未敢斷其是非後考之歷象考成所以求用時者兼用均度升度二差而日躔日差表棄而不用則二根兼用者爲是先生始謂當立二表者亦是而日躔之日差表立算未眞解說支離洵不可承用也太陽平視兩行差當從最卑最髙起算至春分則積二度有奇減時當八分有奇而表以春分起算謂春分平視兩行略等此時無加減分夫春分旣無加減則秋分宜亦無加減表於秋分則加十六分時差十六分當天之四度此四度之差從何得之其不可解一也髙卑加減之極在三宮九宮升度加減之極在四立節四立節之加減最大者不過九分五十六秒謂升度差最大者二度半稍弱也以此爲限再以平視兩行差加減之相去不甚逺表於立春減八分立夏加十一分立秋加三分立冬加二十四分何若是不均其不可解二也二根加減其數常均合之當亦必均表於初宮十九度後始有減分減至春分而極春分後則恆用加計一歲加減之數減者一而加者四其不可解三也合二根加減不過十八分有奇兩大之限不同時又不能及此數而表之加分大者二十四分當天六度此數又從何得之其不可解四也升度差有定時而太陽髙卑有行度其兩行之差不恆系於節气表乃合之爲一若可恆用者然其不可解五也此表監中承用數十年近始遵用歷象考成豈久之始覺其未確乎

歷象考成求用時之法云以本日太陽均數變時得均數時差【本注云均數爲加者時差爲減均數減者時差爲加】又以本日太陽黃赤經度相減餘數變時得升度時差【注云二分後爲加二至後爲減】乃以兩時差相加減爲時差總【注云兩時差同爲加者則相並爲總其號仍爲加同爲減者亦相並爲總其號爲減兩時差一加一減者則相減爲總加數大爲加號減數大爲減號】若算太陰平行則以時差總化秒與一小時太陰平行相乘爲實以一小時化秒爲法除之得數爲秒以分收之得時差行以加減太陰平行【時差總爲加者則減爲減者則加】爲用時太陰平行若算交食求實朔實望用時則以時差總加減實朔實望爲實朔實望用時按此求時差之法甚分明觀此可知日躔表之誤而月離交食二表僅得其半於理亦未盡矣究之亦不必立兩表惟以交食加減時表爲主而以均度變時差加減之蓋變時之法甚易一度變時之四分十五分變時之一分一分變時之四秒可約而知不必須表也【加減時表當正其名曰黃赤升度時差表】

黃赤升度之時差易見太陽均度之時差難知均度所以有時差者何也太陽在天終古平行歷家步算一切以平行爲本一年之根起於冬至次日子正時此平時之平度也而有髙卑之輪太陽行其上則黃道上有視行加減之度而平行之度在本輪之心與人目所見太陽異處則時差生於此矣夫常靜天之析爲十二宮均剖者也一日之分爲十二宮亦均剖者也以均剖者算行度則時刻之能應天者太陽本輪心所到之平度耳若本輪上有加減之度逐日所算太陽加時必與太陽所加之時位有微差【一度爲時之四分】何也輪心與輪邊所當不同也設平春分在丙寅日午正而定春分在甲子日午正相差約兩度則甲子日欲測太陽正交赤道必於所算午正時減八分爲午初三刻七分於正南之位偏東二度測之此時正當交防則所算甲子日午正初刻春分者眞矣何也甲子日本爲平行二宮二十八度之日距三宮初度有二度當未至午正二度之時而入交則本輪心豈不正當午位乎若再加時八分太陽正當午位則本輪心又移過午正西二度矣此均度所以有時差之理也論太陽右旋一晝夜行一度弱論太陽左旋一晝夜行三百六十度太陽旣有加減差則右旋者差在日其極差二日有奇左旋者差在時其極差八分有奇本輪上九宮至三宮太陽行下半周右旋盈則左旋縮十二時行三百六十度而不足不足則時差當減矣三宮至九宮太陽行上半周右旋縮則左旋盈十二時行三百六十度而有餘有餘則時差當加矣然加時之始不於三宮而於六宮減時之始不於九宮而於初宮蓋三九宮爲縮與盈之極三宮至六宮盈其所縮九宮至初宮縮其所盈也總之輪心所到爲平時太陽所到爲視時故以本日均數變時而反其加減於理爲盡【梅先生有日差原理一卷未刻愚以意推測如此】

惟四正日但有均度時差過此則兼有升度時差故當合兩時差相並相減以爲時差總其法至今日始定

論太陽倍離

天以太陽爲尊能攝月與五星西史第谷謂如磁石之引鍼確諭也月五星離日有逺近而生次輪之行五星次輪一度卽爲一度獨太陰離日一度次輪上卽有兩度五星合伏至合伏次輪一周太陰朔至望望至朔次輪再周回歷謂之倍離其故何與此由月次輪與五星不同故也五星次輪心在均輪上而月次輪心在負圏上次輪與均輪以邊相切其相切之防卽初均割綫所到謂之次輪最近防最近者最近於均輪之心也定朔定望起於此防由此左旋至上而最逺至望復於起防又至下而最逺至朔再復於起防防在輪周則度亦起於輪周凡割圓之理從輪心出綫論度者一度爲一度從輪周出綫論度者兩度爲一度此月所以倍離也試從次輪最近防出一直綫分次輪爲兩半又從防出一橫綫與直綫十字相交夾次輪半周於中間夫十字相交者直角也直角所夾之度必九十度而次輪則已半周豈不兩度當一度乎

論太陰遲疾

問授時分太陰爲一百六十八限算其遲疾似密於古以今法較之授時猶未能與天密合也按月離加減表三宮九宮初度減均加均積度四度五十八分二十秒變爲日度五度○四四五有奇耳而遲疾立成八十四限所益所損之積度五度四二九有奇則其數大於加減均度矣朔望後行次輪更有二三均加減大者二度四十八分並初均加減七度有奇而授時無此損益分則其積差有至二度有奇者矣安能與天密合曰授時之分限算遲疾蓋由積而得豈積差至一度有奇猶不之覺者乎曰月行最難測算者也三均之數甚糾紛地面地心視差又最大人所見在天之度往往非眞度當時𨿽屢測亦只得其大防旣不知有次輪之行又未得視差之眞率是以不得不以近似者立法然則西法算太陰有二三均加減實勝中法之一大端也

凡月近入轉則疾近月孛則遲此本輪均輪上之遲疾也近朔望則疾近兩則遲此次輪次均輪上之遲疾也朔望又近入轉兩又近月孛則疾者愈疾一日不啻十五度遲者愈遲一日行十一度有奇

然則授時之遲疾法算定朔定望交食何以不甚差曰朔望無次均加減故也

授時分太陰一轉三百三十六限之表今載之明史其實爲無用之法也

論交食

梅先生交食求交防管見二書備論算交食之理無餘蘊其以黃道交角變白道交角爲定交角以定交角算日月光體之上下左右指其初虧復圓而不以東西南北爲方位尢發前人所未發

交食求注云若用弧三角法求白道限度所在及其距地之髙並可得交角細數然所差不多蓋算交食必在朔望又必在交前交後故也按用弧三角求白道限卽交防管見新立算白道九十度限髙法是也竊疑交前交後白道斜穿黃道而過不能與黃道平行則變黃道交角爲白道交角似有微差然甚微可不論故今法徑借黃道交角以朔望黃白交角加減之而白道交角不必立表舊法定日食限陰曆初宮十七度四十分以內五宮十二度二十分以外陽曆六宮八度二十分以內十一宮二十一度四十分以外實交周入此限者並有食今法定食限陰曆稍寛陽曆稍狹實交周自五宮十一度四十五分至六宮六度十四分又自十一宮二十三度四十六分至初宮十八度十五分爲的食不入限者不必算亦有入限而不食者則因三差故【西法羅防爲正交交道自外而入內計都爲中交交道自內而出外中歷反之名易而實不易】

康熈四十三年五月十七日乙夘望月食監頒圖梅先生謂圖中所注食旣至食甚時刻多食甚至生光時刻少相差十分謂其不應攺法愚疑此頒圖時字有脫誤也【蓋生光丑正二刻十一分脫十字誤作一分】否則誠難解

論中西法異者多端

問梅先生謂中西二法本同新曆但兼用其長以補舊法之未備惟五星有交防有緯行是中歷缺陷之大端然則西法之異於中法止此一事與曰先生舉其大者耳其他若中歷太陽盈縮常定於冬夏二至西法則最髙最卑有行度中歷太陰遲疾但知有轉終而不知更有二三均加減中歷交食時差但知以午正爲加減之限而不知有黃平象限中歷太陽太陰之徑闇虛之徑恆爲一定而不知有髙下大小之差法之異者固多端若三角立算中法只知有直角句股而不知有鈍角鋭角與弧三角弧矢割圓中法未盡其用而西法則有八綫表預定無數句股以爲一切測算之凖防此皆有補於中歷者也

補論十二宮

問梅先生論周天十二宮有直有衡有斜有百遊不甚紛紜錯雜歟曰是皆各有所宗各有所取用非雜也愚謂在天猶有不變之十二宮蓋列宿之天分爲四維析爲十二次星紀鶉首等名西國則有磨羯巨蟹等名皆以星象定之古今不變者也此與黃道之十二宮同歸而殊塗恆星天亦宗黃極是同歸也列宿自布十二宮恆以虛六度爲元枵之半斗四度爲磨羯之初歲歲推移不與中气節气相直是殊塗也梅先生歷學疑問補中極論此理但未言其不變之十二宮耳

又按七政小輪無論大小皆分十二宮此自歷家虛立之以便算故梅先生不數

論西法六十分爲度

問回回歷𨿽以三百六十度爲周天而一度用百分或萬分與授時同【見袁氏歷法新書】歐邏巴獨以六十分爲度秒微以下皆用六十遞析八綫表亦分一度爲六十何也曰其源蓋由於時刻也中法一日百刻不便於分布西法以九十六刻齊之一時均得八刻又分一時爲二時謂之小時分一刻爲十五分凡加時與日出入皆有分數可紀【中法萬分日𨿽甚細而發斂加時及日出入皆紀刻不紀分猶爲粗疎西法則紀刻分分下之秒未過半棄之已過半收之】今四刻六十分爲一小時此六十分所由來也而秒微以下皆用六十則作表甚便【第一格爲時第二格爲分第三格爲秒第四格爲微所列之數皆同】又如以度變時以時變度則以四分當一度一小時當半宮亦甚便日法如此度法亦因之八綫表亦因之則各率通爲一法此歐邏巴立法斟酌盡善者也彼百刻不便分布刻下不能紀分似不可謂無薛儀甫著天學防通攺六十分爲百分則當先攺八綫表而余諸表皆不可用亦覺更張多事謹案

聖祖仁皇帝禦制歷象考成度法用六十日法一千四百四十別以一萬爲日周通法其布算也以萬分計余分而仍以日法通之如法收爲時刻兼用授時而不用百刻之法此則萬世可遵行者也

論授時歷周天歲周

自大衍歷分天自爲天歲自爲歲以著歲差之理歷代遵用至郭氏別出新意以萬分爲度卽以萬分爲日周天三百六十五萬二千五百七十五分歲周三百六十五萬二千四百二十五分自當時觀之立法若盡善矣由今日論之二者皆非至極之理也夫黃道與列宿天同爲大圜𨿽髙下懸殊度之廣狹迥異而度數則同非周天之度分多於周歲之度分也歲已周則黃道周矣而不能踵其星之故處非歲有不滿之度分也星自移而東耳譬之太陰二十七日有奇卽周天其不能逐及於日者日自行二十餘度耳乃以三百六十五度二千五百七十五分爲周天是並其移動之一百五十分亦算在周天之內則二十八宿之度不溢出一百五十分乎又歲實有平有泛論平歲實只有三百六十五萬二千四百二十一分八十七秒五十微而當時以泛歲實定爲歲周則又多出三分一十二秒五十微矣論正法當卽以歲周爲周天以三百六十五度二千四百二十一分八十七秒五十微分隸之於二十八宿別以今率恆星每歳東行五十一秒變爲日度之分秒微以爲歲差始盡善無當時最卑行與恆星行兩竅未啟是以立法甚難此不可不原其情亦不可不知其有未當處也

論歷法隨時修攺

歷取象於革久之不能不攺非久亦不能攺各平行率有積之數十年微覺其差而卽攺者【如最卑行】有通前後數百年或千餘年測準之度分用以相距定爲平行其尾數或有未眞必甚久而後可攺者【如七政平行】有前人立法未精攺之而加密者【如日食加時東西差昔以午正爲限後攺用黃平象限近又以白道算定交角】有前人用法稍煩攺之而徑防者【如六曜求初均昔用平三角今直角算】若夫黃赤相距之緯古闊而今漸狹太陽本輪均輪之半徑古大而今漸小此二差出於常理之外前不知若何而始後不知若何而極非法之所能馭惟隨時密測攺表以合天行耳

黃赤相距西史第谷測得二十三度三十一分半今測得二十三度二十九分三十秒【康熈五十三年臺官密測立表今又當稍減矣】太陽本輪均輪兩半徑並昔用十萬分之三千五百八十四或以一千萬爲本天半徑則爲三十五萬八千四百一十六日躔加減差表三宮九宮初度其均度二度三分一十秒平春分與定春分相距二日一小時有奇而今平春分與定春分相距一日二十二小時弱則最大之均度一度五十五分【比舊約少八分】本輪均輪兩半徑合得三十三萬五千四百有奇耳

黃道爲諸道之宗太陽爲眾曜之君有此二差則六曜之出入於黃道離合於太陽者亦因之而小有攺變

兩半徑𨿽攺算太陽均度舊表亦可借用【以三五八四爲一率舊表均數化秒爲二率今攺三三五四有奇爲三率求得四率爲秒以度分收之爲今時加減均數】

數學卷一

欽定四庫全書

數學卷二

婺源江永撰

嵗實消長辧

【嵗實消長前人多論之者勿庵先生大約主授時而亦疑其百年消長一分以乘距算其數驟變殊覺不倫又謂今現行之嵗實稍大於授時其爲復長亦似有據因爲髙衝近冬至而嵗余漸消過冬至而復漸長之說蓋存此以俟後學之深思永別爲之說謂平嵗實本無消長而消長之故在髙衝之行與小輪之攺兩嵗節气相距近髙衝者嵗實稍嬴近最髙者稍朒猶定朔定望定之不能均惟逐節气算其時刻分秒而消長可勿論也管見如斯遂不能彊同爰引先生之言逐節疏論於下】

勿庵先生曰【歷學答問】授時以萬分爲日故其嵗實三百六十五萬二千四百二十五分其數自至元辛巳嵗前天正冬至積至次年壬午嵗前天正冬至共得三百六十五日二十四刻二十五分若逆推前一年亦是如此【如自庚辰年十一月冬至逆推至己夘年十一月冬至亦是三百六十五日二十四刻二十五分】此嵗實之數大統與授時並同

永按嵗實爲歷法大綱領得其眞確之數爲難四分曆以前無論已魏晉以後漸知一嵗小餘不及四分日之一隨時測驗一歷必更一斗分不久卽有差此何以故蓋步歷者泥履端於始之義但以嵗前冬至距今年冬至計其小餘時刻並入大餘以爲嵗實不知冬至距冬至所得者活泛之嵗實而非經恆之嵗實也欲得經恆嵗實宜於近春分時測之【元至元時當測定气春分】今嵗春分距來嵗春分苟得眞時刻則得眞嵗實又以前後逺年測凖之春分計其日時分秒均之各嵗則嵗實之恆率確矣此何也太陽因有髙卑而生盈縮近數百年間春分則平行【當郭氏作歷時定气春分之日正當平行之處此以前以後𨿽有此亦甚微】故所得嵗實爲恆率得其恆乃可以求其定猶之月必有平朔之防而後可求定朔也郭太史攺歷自言創造簡儀髙表憑所測實數考正者七事一曰冬至二曰嵗余其於嵗實考之詳矣其求冬至也自丙子年立冬後依毎日測到晷景逐日取對冬至前後日差同者爲凖得丁丑年冬至在戊戌日夜半後八刻半又定戊寅冬至在癸夘日夜半後三十三刻己夘冬至在戊申日夜半後五十七刻庚辰冬至在癸丑日夜半後八十一刻辛巳冬至在己未日夜半後六刻【從甲子日始五十五日零六刻气應五十五萬零六百分爲歷元】其求嵗余也自劉宋大明以來測景驗气得冬至時刻眞數者有六用以相距各得其時合用嵗余考驗四年相符不差仍自宋大明壬寅年距至今八百一十九年毎嵗各得三百六十五日二十四刻二十五分減大明歷一十一秒其二十五分爲今歷嵗余合用之數愚以此二條考之卽郭氏當年所定之嵗實已有微差稽之於史又多抵牾其可以是爲消長之凖乎夫一嵗小餘二十四刻二十五分積之四嵗正得九十七刻無餘無欠丁丑年冬至在戊戌日夜半後八刻半則辛巳年冬至宜在己未夜半後五刻半不應有六刻如以辛巳之六刻爲確也則丁丑年宜在九刻不應只有八刻半此四年旣皆實測所得則己亥半刻矣而云相符不差何也【丁丑年之八刻半𨿽約取整數未必正是半刻然已有數十分矣其本法上考已往百年而長一刻四年所長甚微不應有半刻以下然則當時冬至嵗實刻下之小餘不止二十五分矣】又考劉宋孝武帝大明五年辛丑祖衝之所測十月十日壬戌景長一丈七寸七分半十一月二十五日丁未一丈八寸一分太二十六日戊申一丈七寸五分彊以壬戌戊申景相較餘二分二釐半爲實以丁未戊申景相較餘六分五釐爲法以法除實得三十四刻六十分以減距日四千六百刻餘四千五百六十五刻四十分折取其日【二千二百八十二刻七十分】加半日刻【午正測景故加半日】得二千三百三十二刻七十分命壬戌算外得十一月三日乙酉夜半後三十二刻七十分【劉宋都建康比元大都裏差應後五十七分則大都此日冬至三十二刻一十三分○按劉宋時太陽最髙衝在冬至前幾半宮則取冬至前後二十餘日之景折取中數以求冬至仍有差詳見冬至權度條】辰初三刻冬至【大都減半刻奇】大明壬寅【辛丑年之十一月卽壬寅嵗之始】下距至元辛巳八百一十九年以授時嵗實積之凡二十九萬九千一百三十三日六十刻七十五分以乙酉辰初三刻距己未丑初一刻凡二十九萬九千一百三十三日九十二刻較多三十三刻而云自大明壬寅距今毎嵗合得此數何也【如郭氏百年長一之法以八百一十九總乘所長之數則壬寅冬至甲申日七十九刻太較當時所測算者又先五十餘刻則失之愈逹矣○詳冬至權度】又云減大明歷一十一秒考祖衝之大明歷紀法與周天一嵗小餘二十四刻二十八分一十四秒授時減去三分一十四秒亦非一十一秒也【邢士登律曆考謂金時趙知微重修大明歷小餘二十四分三十六秒實多授時一十一秒郭所減者趙歷非祖歷也其說是】然則授時

所定嵗實猶是近似活泛之數而不可

以爲恆欲定經恆之嵗實則西曆恆年表之恆率是矣按表一嵗小餘五小時三刻三分四十五秒【一日二十四小時一小時四刻一刻十五分一分六十秒】以分通之三百四十八分有奇以秒通之二萬○九百二十五秒【一日八萬六千四百秒】考其實則回回歷已如此回回歷法一嵗三百六十五日嵗有十二宮宮有閏日一百二十八年閏三十一日然則一嵗閏一百二十八分日之三十一正西法之嵗余也【以一百二十八乘二萬○九百二十五得二百六十七萬八千四百以八萬六千四百除之得三十一是也】回回歷以春分爲嵗首其嵗余由累測春分得之歐邏巴歷遂用之至今因之𨿽分下之四十五秒未必無脁朒當亦甚微矣以此平率爲凖隨其時之最髙衝與最髙之行而進退焉冬至近髙衝則兩嵗冬至之距必多於平率【今時多一分弱】夏至近最髙則兩嵗夏至之距必少於平率【今時少一分弱猶之太陰當朔時入轉兩朔相距之日時必多當望時近月孛兩望相距之日時必少若朔時近月孛望時近入轉兩朔兩望相距反是】又古時太陽本輪均輪半徑之差大於今日則加減均數亦大而冬至嵗實當更增至元辛巳間髙衝約與冬至同度則嵗實尢大其小餘刻下之分約有三十分而授時定爲二十五分宜其自丁丑至辛巳四年之間卽有半刻之差而郭氏未之覺也【一年少五分四年少二十分幾於半刻之半矣丁丑年之八刻半本爲約略之數半刻以下固難測算眞的也○以西法嵗余依授時萬分日較之只有二十四刻二十一分八十七秒半少授時嵗餘三分一十二秒半當時冬至爲盈初小輪半徑差又大其多於平率必不止三分有奇者也】

然授時原有消長之法是其新意其法自辛巳元順推至一百年則嵗實當消一分【依法推至洪武十四年辛巳滿一百年其歳實消一分爲三百六十五日二十四刻二十四分】若自辛巳元逆推至一百年則嵗實當長一分【依法推至宋孝宗淳熙八年辛丑滿一百年嵗實長一分爲三百六十五日二十四刻二十六分】毎相距增一百年則嵗實消長各增一分以是爲上考下求之凖大統諸法悉遵授時獨不用消長之法上考下求總定爲三百六十五日二十四刻二十五分此其異也

永按冬至相距之嵗實大於平率最髙衝有行度而小輪均數又有大小宜其嵗實有消長分數然必當時測定之嵗實已眞確又知其無可復加而後知將來之漸消若授時嵗余刻下之二十五分尙非確數其差分已見端於丁丑辛巳四年之間則辛巳以後能必其果消乎郭太史歷考正者七事創法者五事皆不數嵗實消長蓋未能眞知所以消長之故但暗用楊忠輔統天歷爲活法以推往古意謂下考將來亦如是耳明大統歷悉遵授時獨不用消長之法當時歷官元統非有確見實測知其不當用消分也以今觀之猶幸大統不用消分冬至縱有先天尙未甚逺倘遽攺二十五分爲二十四分其先天不愈多乎【當至元時刻下小餘約有三十分授時一嵗少五分百年約先天五刻】

嵗實卽一年之日數自一年以至千百年共積若干是爲積日亦謂之中積【上考下求皆距至元辛巳立算】假如今康熙庚午嵗相距四百零九算依授時法推得積日一十四萬九千三百八十四日零一刻八十九分【因距算四百以上嵗實當消四分爲三百六十五日二十四刻二十一公以乘距算四百零九得如上數】大統不用消長則積日爲一十四萬九千三百八十四日一十八刻二十五分兩法相差一十六刻三十六分【以命冬至日辰授時得癸夘日丑初三刻大統得癸夘日夘初三刻】

永按凡天行盈縮進退必以漸無驟增驟減之理郭氏百年消長一分則是百年之內皆無所差至一百零一年驟增減一分又越百年皆平差一分至二百零一年又驟增一分豈有此數與法乎卽如其法算數百年後亦當逐節計其消分積而數之不當總計當消之分而以距算總乘之也如大統歷康熙庚午冬至癸夘日夘初三刻查時憲書乃是巳初一刻【大統先天一十四刻】授時大統用消分均之無當於天行其故何哉當年所測嵗實刻下小餘其數不眞故也嵗實已弱矣而又消之安得不先天乎使當攺二十五分爲三十分由辛巳以後漸而消之或庶幾耳曰至元嵗余若果二十四刻三十分則上考當長乎消乎曰上考亦消也蓋至元時髙衝與冬至同度小輪均數又最大故冬至嵗實爲長極之時而上考下考皆當消但消於三十分之內非消於二十五分之內也【今時髙衝在冬至後七八度小輪又漸小冬至嵗余以萬分日計之約二十四刻二十八九分之間劉宋大明時髙衝在冬至前半宮以祖衝之紀法除其嵗周當時嵗實三百六十五日二十四刻二十八分一十四秒可見至元前後皆消於三十分之內其消甚遲約四百餘年始消一分蓋小輪均數在初宮有若平差故也至一宮以外則漸疾矣】若以春分平嵗實相較則冬至嵗實上下數千年皆在長限之中而至元時尢爲長之極必俟髙衝行至春分則冬至嵗實始平【如今之春分】又數千年髙衝行至夏至最髙行至冬至則冬至嵗實始爲消之極耳【如今之夏至】然冬至嵗實消則春分嵗實長冬至嵗實消之極則夏至嵗實又爲長之極矣抑今日本輪差小古時差大則消長中復有消長苟知此理則後之治歷者但隨時測髙衝之行與小輪之差以算定气而嵗實消長俱可勿論猶之太陰但實算定朔定望定不必復計此月與彼月多於朔防幾何少於朔防幾何也

又曰【歷學疑問】問嵗實旣有一定之數授時何以有消長之法曰此非授時新法而宋統天之法然亦非統天億創之法而合古今累代之法而爲之者也

永按統天歷宋寧宗時楊忠輔所造其嵗實與授時正同以斗分乘距差爲躔差暗藏加減之法約百年加減一分零六秒弱然行之未久鮑澣之造開禧歷臧元震造成天歷皆增嵗實攺各率紛紛竟無定論云

蓋古歷周天三百六十五度四分度之一一嵗之日亦如之故四年而增一日其後漸覺後天皆以爲斗分太彊因稍損之

永按古歷四年而增一日其術甚疎𨿽古斗分宜多亦百數十年卽當後天一日何以自周迄漢久而後覺曰周之歷卻失之先天僖公五年辛亥日南至昭公二十年己丑日南至皆先天二三日曆數百年以有餘之嵗實盈其所先之數乃適得其平【約在周秦間】厥後猶執四分之術漸失之後天故久而後覺耳

自漢而晉而唐而宋毎次攺歷必有所減以合當時實測之數故用前代之歷以順推後代必至後天以斗分彊也【斗分卽嵗余】若用後代之歷據近測以逆溯往代亦必後天以斗分弱也

永按漢已前之冬至非實測先後天或至二三日後漢末劉洪始覺其後天而攺斗分東晉虞喜始立嵗差法後秦姜岌始知以月蝕衝檢日宿度所在而劉宋之初冬至猶後天三日大明時祖衝之始解於測景以冬至前後二十餘日之景比對取中而定冬至然後冬至日躔漸得其實猶不能盡合也故唐一行謂麟徳歷已前實錄所記乃依時曆書之非景所得郭太史謂自大明歷以來測景驗气得冬至時刻眞數者有六然則實測之能合天者亦鮮矣

統天歷見其然故爲之法以通之於嵗實平行之中加一古多今少之率則於前代諸歷不相乖戾而又不違於今之實測此其用法之巧也然統天歷藏其數於法之中而未嘗明言消長授時則明言之今遂以爲授時之法耳郭太史自述創法五端初未及此也

永按授時歷實暗用統天之法者也其嵗餘二十四刻二十五分與統天同而上推百年長一之法亦相似故授時歷議謂自魯獻公戊寅至至元辛巳冬至日名共四十九事授時法合者三十九不合者十統天不合者惟獻公戊寅與授時異餘三十八與授時同二歷推冬至略相似也然而劉宋大明壬寅嵗前冬至乙酉夜半後三十二刻七十分則當時祖衝之測景推算所得者縱有未確亦不甚逺【當時所算約後天十六刻詳見冬至權度】依授時統天法皆推甲申日戌初初刻先天甚多豈可謂大明非而授時統天是歟郭氏謂自大明以來測景驗气得冬至時刻眞數者有六用以相距旣以大明壬寅之冬至爲得眞數之首矣及用法推算卽失此至乃謂日度失常其可乎以今觀之一由授時所定嵗余本未眞一由長數當漸積不當總計長分而以八百一十九距算總乘之也【統天距差乘差躔差咸泛積失亦略同】

然則大統歷何以不用消長曰此則元統之失也當時李徳芳固已上疏爭之矣然在洪武時去授時立法不過百年所減不過一分積之不過一刻故𨿽不用消長無甚差殊也崇禎曆書謂元統得之測驗竊不謂然何也元統與徳芳辧但言未變舊法不言測驗有差又其所著通軌𨿽便初學殊昧根宗間有更張輒違經防【如月食時差旣內分等俱妄攺背理】豈能於冬至加時先後一刻之間而測得眞數乎

永按明初李徳芳與元統爭嵗實消長爲歷家一段公案闗系有明二百餘年之歷法邢士登恨元統不用消分致萬曆間節气後天九刻有奇愚有以斷之據授時嵗實上考固宜有長分矣然而授時之嵗余本未確則所據以爲長之端者亦未眞旣言毎百年長一分則當以漸而長乃總計長分以乘距算則又無此算法觀其推至大明壬寅巳違當時之實測又何論春秋以前乎徳芳所據者謂魯獻公十五年戊寅天正甲寅冬至依授時法推得甲寅日夜子初三刻依大統法推得己未日午正三刻【己未史誤作丁巳】相差四日六時五刻當用至元辛巳爲元及消長之法方合天道夫魯獻公之年史有舛錯本難憑信漢志謂獻公十五年甲寅冬至此自劉歆三統歷逆推當年冬至是甲寅耳豈有實測紀之信史哉而徳芳以此駁元統其無卓識可知矣然元統之不用消長也初無實據但云上考下推不用消長以合天道又云天道無端惟數可以推其機天道至妙因數可以明其理理因數顯數從理出故理數可相倚而不可相違夫旣未嘗實測而憑虛以言天道言理數宜其不能服徳芳也今日曆學大明由後觀之前此二百餘年猶幸元統不用消分冬至加時先天尙未甚逺蓋授時嵗餘一嵗約少五分自至元辛巳至洪武甲子一百零三年固已先天五刻矣使大統減一分又越百年二百年而更減之先天不愈多乎邢士登謂萬曆間大統歷後天九刻此非有所測驗但據用消分與不用消分積算如此豈知明歷皆失之先天乎觀前所舉康熙庚午年時憲書癸夘日巳初一刻冬至依大統算夘初三刻先天一十四刻若依授時算丑初三刻則先天三十刻自辛酉溯戊辰五十餘年約減二三刻則戊辰以前大統歷率先天十一二刻若用授時法先天遂至二十七八刻矣此豈可厚非大統乎

然則消長必不可廢乎曰上古則不可知矣若春秋之日南至固可考據而唐宋諸家之實測有據者史冊亦具存也今以消長之法求之其數皆合若以大統法求之則皆後天而於春秋且差三日矣安可廢乎

永按春秋時歷法最疎置閏或疏或密日食或不在朔則步冬至違天可知僖公五年丙寅正月辛亥朔日南至以今法推此年平冬至乙夘日巳時定冬至在甲寅卽令此時小輪均數大能使定气移前一日半亦不過癸丑日之夜刻辛亥實先天二三日且定朔壬子亦非辛亥也昭公二十年己夘二月己丑日南至以今法推此年平冬至壬辰定冬至辛夘當時推己丑亦先天二日且己丑爲此年正月朔安得爲二月也授時推僖五年冬至以嵗余長十九分乘距算一千九百三十五加於中積得辛亥日寅初二刻是以總長分數乘距算而非積漸而長亦因有辛亥日南至之文彊爲此算以求合不知辛亥非實測也【唐一行謂僖公登觀臺以望而書云物出於表晷天驗非時史億度愚謂傳言書云未嘗言測景】其推昭二十年冬至以十八乘距算一千八百零二則不得己丑而得戊子日戌初三刻其先天愈甚矣此二事一合一否皆不足爲據且旣能上合一千九百餘年之冬至矣何以劉宋元嘉丙子十一月甲戌景長而推癸酉大明辛丑十一月乙酉冬至【卽壬寅天正冬至】而推甲申此二事皆八百餘年反先天一日豈非總分乘距算之法非法故失之乎

然則統天授時之法同乎曰亦不同也統天歷逐年疊差而授時消長之分以百年爲限則授時之法又不如統天矣

永按統天以距差乘躔差其失亦與授時等【由其根數未確】

夫必百年而消長一分未嘗不是乃以乘距算其數驟變殊覺不倫鄭世子黃鐘歷法所以有所酌攺也【假如康熙辛酉年距元四百算故消四分而其先一年庚申距算三百九十九隻消三分是庚申年嵗餘二十四刻二十二分而辛酉年嵗餘二十四刻二十一分也以此所消之一分乘距算得四百分則辛酉嵗前冬至忽早四刻而次年又只平運以實數計之庚申年反只三百六十五日二十刻二十二分辛酉年則又是三百六十五日二十四刻二十一分其法舛矣】

永按授時之謬法勿庵先生亦旣覺之矣抑不惟如此而已年愈逺則失愈甚如推至春秋時一千九百年則嵗餘二十四刻四十四分若一千九百零一年嵗余增一分此一分乘距算一千九百零一前一嵗忽增一十九刻有奇則嵗實有三百六十五日四十三刻有奇豈不甚可笑乎況又有逺於此者乎

問嵗實消長之法旣通於古亦宜合於今乃今實測之家又以爲消極而長其說安在豈亦有所以然之故與曰授時𨿽承統天之法而用消長但以推之舊曆而合耳初未嘗深言其故也惟曆書則爲之說曰嵗實漸消者由日輪之轂漸近地心也余嘗竊疑其說今具論之夫西法以日天與地不同心疏盈縮加減之理其所謂加減皆加減於天周三百六十度之中非有所增損於其外也如最髙則視行見小而有所減最卑則視行見大而有所加加度則減時矣及其加減旣周則其總數適合平行略無餘欠也若果日輪之轂漸近地心不過其加減之數漸平耳加之數漸平則減之數亦漸平其爲遲速相補而歸於平行一也豈有日輪心逺地心之時則加之數多而減之數少日輪心近地心時則減之數少而加之數多乎必不然矣

永按冬至相距之日時古今有多少不過泛嵗實與平嵗實相差其相差又有舒疾之漸耳若今冬至有平有定本不必言消長必欲言其消長則其故有二一由髙衝離冬至有逺近一由日小輪古今有大小也髙衝自秋分行至冬至此三宮定冬至皆在平冬至前自冬至行至春分此三宮定冬至皆在平冬至後總此六宮上下約萬年【以今時最髙衝行約之】皆在長限以其冬至泛嵗實皆多於平嵗實故也惟髙衝正當秋分春分此兩嵗嵗實皆平【卽西法三百六十五日五小時四十八分四十五秒是也】離此則漸有差前三宮由平而漸增多是爲長中之長至髙衝與冬至同度則定冬至與平冬至同日同時是爲長之極當郭太史作歷正其時也後三宮由極多而漸減以至於平是爲長中之消今時髙衝在冬至後八度其消尙未多也若髙衝過春分而行至夏至此三宮定冬至亦在平冬至後自夏至行至秋分此三宮定冬至又在平冬至前總此六宮亦約萬年皆在消限以其冬至泛嵗實皆少於平嵗實故也前三宮由平而漸減是爲消中之消至髙衝與夏至同度則定冬至亦與平冬至同日同時是爲消之極後三宮由極少而漸增以至於平是爲消中之長此通髙衝行一周天而總論其消長也然而太陽兩小輪半徑三千五百八十四古多而今少多則小輪稍大日躔加減均亦稍大少則小輪稍小加減均亦稍小髙衝之行一年一分一秒十微【西士後測】此一分一秒十微若在均數稍大之中則度分變爲時分之秒數以加減於平時者必稍多若在均數稍小之中則度分變爲時分之秒數以加減於平時者必稍少【如崇禎戊辰所立之加減差表初宮之初度十一宮之末度毎一十分均數二十二秒髙衝一年行一分一秒十微約均數二秒有奇此二秒有奇變爲時約五十七秒以加於平嵗餘五小時三分四十五秒得五小時四分四十二秒如小輪稍大則初度一十分之均不止二十二秒而一嵗髙衝之行不止得均二秒有奇其變時亦不止五十七秒矣如小輪稍小則初度十分不及二十二秒髙衝之行得均數不及二秒則變時亦不及五十七秒矣此略舉初度之均以爲例其他可類推】古今小輪之大小𨿽不可盡知以劉宋元嘉大明間屢年之實測算當時之不同心差蓋四千有奇【詳冬至權度】則均數必稍彊至元授時歷冬至盈初加分多於今日之加分則當時小輪半徑不止三千五百八十四自此以後至今日小輪漸小均數亦漸小髙衝行度所得之均數以減度加時者亦稍弱焉此又因輪轂漸近地心而微有消分也

又考日躔永表彼固原未有消長之說日躔歷指言平嵗用授時消分定嵗則用最髙差及查恆年表之用則又只用平率是其說未有所決也

永按曆書非出一手故有不相應處其嵗實平率出回歷回歷得之實測春分此曆書最緊要處惜未明白剖析其日躔表說辧論從前言消長者之非則固有定說矣但小餘微有不同耳【曆書平嵗實小餘五小時三刻三分四十五秒以萬分通之是二四二一八七五也今歷象考成亦用之而日躔表說二四二一八八六四較多一一四】

又曆書言日輪漸近地心數千年後將合爲一點若前之漸消由於兩心之漸近則今日之消極而長兩心亦將由近極而逺數千年後又安能合爲一點乎彼蓋見授時消分有據而姑爲此說非能極論夫消長之故者也

永按七政皆有小輪獨日之小輪有攺變竊意久亦必復豈有與地心合爲一點之理自至元辛巳以後正是長極而消非消極而長也曰今實測之冬至後於授時之中積分明是長而以爲消何也曰前已言之矣授時嵗余刻下之分當有三十分而郭氏定爲二十五分也授時之嵗實豈非出於實測然因其自述丁丑辛巳四年冬至得其自相乖違之處因以知至元時爲長極而消之大界與日躔加減表十一宮末度以前均數漸減之理固相符也

然則將何以求其故曰授時以前之漸消旣徴之經史而信矣而今現行歷之嵗實又稍大於授時其爲復長亦似有據竊考西曆最髙卑今定於二至後七度依永年曆毎年行一分有奇則授時立法之時最髙卑正與二至同度而前此則在至前過此則在至後豈非髙衝漸近冬至而嵗余漸消及其過冬至而東又復漸長乎余觀七政歷於康熙庚申年移攺最髙半度弱而其年嵗實驟增一刻半彊此亦一徵也存此以竢後之知歷者【己未年最髙在夏至後六度三十九分庚申年最髙在夏至後七度七分除本行外計新移二十七分己未年冬至庚戌日亥正一刻四分庚申年冬至丙辰日寅正二刻二分實計三百六十五日二十四刻十三分前後各年俱三百六十五日二十三刻四分或五分以較庚申年嵗實驟增一刻九分】

永按嵗實消長之故一由最髙衝之有行度先生因最髙攺移嵗實驟增而悟及此猶云存之以俟知者亦欲後人由此致思也然其所言消長若與實算相反何也日躔加減表初宮與十一宮同均而加減異號至元辛巳以前髙衝行未及冬至則用初宮之均度分秒加度而減時辛巳以後髙衝行已過冬至則用十一宮之均度分秒減度而加時前減時則定冬至在平冬至前後加時則定冬至在平冬至後初宮之初度與十一宮之末度其均最大則一嵗髙衝之行所得均數最多變爲時以加減於平時者亦最多故此處嵗實極大皆最長之時也初宮若離初度稍逺則均漸少而變時以減平時者亦稍少嵗實亦稍減矣十一宮若離末度稍逺則均漸少而變時以加平時者亦稍少嵗實亦稍減矣故髙衝行漸近冬至其均由少而多嵗實正漸增以至於極也而此謂嵗余漸消髙衝已過冬至其均由多而少嵗實則由極多以漸減也而此謂復漸長豈非與實算相反乎蓋先生論消長不主平嵗實爲根耳

王寅旭曰嵗實消長其說不一謂由日輪之轂漸近地心其數消者非也日輪漸近則兩心差及所生均數亦異以論定嵗誠有損益若平嵗嵗實尙未及均數則消長之源與兩心差何與乎識者欲以黃赤極相距逺近求嵗差朓朒與星嵗相較爲節气消長終始循環之法夫距度旣殊則分至諸限亦宜隨易用求差數其理始全然必有平嵗之嵗差而後有朓朒之嵗差有一定之嵗實而後有消長之嵗實以有定者紀其常以無定者通其變始可以永久而無

永按古今言嵗實消長者皆從冬至嵗實言之非論平率嵗實也因兩心差及所生均數異而定气微有損益是亦消長之一根不可謂其無與若黃赤極相距逺近求差數此說恐未然其言有平嵗之嵗差而後有朓朒之嵗差有一定之嵗實而後有消長之嵗實此數言極中肻綮一定之嵗實從春分測定之平嵗實是也苟知此則但言平冬至定冬至不必言消長亦可矣

按寅旭此論是欲據黃赤之漸近以爲嵗實漸消之根蓋見西赤黃赤之緯古大今小今又覺稍嬴故斷以爲消極復長之故然黃赤逺近其差在緯嵗實消長其差在經似非一根又西測距緯復嬴者彼固自疑其前測最小數之未眞則亦難爲確據愚則以中歷嵗實起冬至而消極之時髙衝與冬至同度髙衝離至而嵗實亦增以經度求經差似較親切愚與寅旭生同時而不相聞及其卒也乃稍稍見其書今安得起斯人於九原而相與極論以質所疑乎

永按先生經緯之辧最確而謂髙衝與冬至同度爲消極之時永已論之於前

又曰【考最髙行及嵗余】按日行盈縮細考之則春分距夏至夏至距秋分𨿽皆縮歷而其縮亦不同秋分距冬至冬至距春分𨿽皆盈歷而其盈亦不同又且年年不同細求之則節節不同又細求之其日日不同矣其故何也蓋最髙一點不在夏至而在其後數度又且年年移動此太陽盈縮之根而嵗實所以有消長也

永按以太陽盈縮之根推嵗實所以有消長此先生之定見定說也

按庚申年夏至至冬至一百八十三日十三刻六分辛未年夏至至冬至一百八十三日十四刻九分十二年中共長一刻○三分【中積只十一年】壬戌年冬至至次年夏至一百八十二日九刻九分庚午年冬至至次年夏至一百八十二日八刻十分九年中共消十四分【中積共只八年】又合計癸亥夏至至前半周一百八十二日九刻九分冬至前半周一百八十三日十三刻十分相較一日○四刻一分辛未夏至前半周一百八十二日八刻十分冬至前半周一百八十三日十四刻九分相較一日○五刻十四分八年中較數增一刻十三分

永按此以半年之气前後相較驗最髙之東移若以兩嵗冬至春分夏至秋分及各節气兩嵗相距皆各有其嵗實而冬至爲最大夏至爲最小春秋分爲近平義越數十年而諸嵗實亦微有不同矣前代只知冬至嵗實不知逐節气皆有嵗實也

然二分之相距則無甚差何也蓋最髙移而東則夏至後多占最髙之度而減度加時之數益多故益長髙衝移而東則冬至後多占最卑之度而加度減時之數益多故益消其近二至處皆爲加減差最大之處故消長之較已極也乃若二分與中距𨿽亦嵗移而中距皆爲平度不系加減其最髙前後視行小之度固全在春分後半周最髙衝前後視行大之度亦全在春分後半周毫無移動故無甚消長也

永按二分無甚差故欲得平嵗實須於近二分時測之若髙衝行至春分則二分之距又最大而二至反平矣

按授時消分爲不易之法今復有長者何也西法最髙卑之點在兩至後數度嵗嵗東移故𨿽冬至亦有加減不得以恆爲定也此是西法中一大節目其法自回回歷卽有之然了凡先生頗采用回回法而不知此熊防石先生親與西儒論歷而亦不言及何也

永按最髙卑之有行度誠西法中一大節目袁氏新書不知有最髙卑又何以能較論前代諸歷之先後天乎

又曰【歷學疑問】袁了凡新書通回回之立成於大統可謂苦心然竟削去髙卑之算又直用大統之嵗余而棄授時之消長將逆推數百年已不效況數千萬年之久乎永按袁書逆推數百年已不效誠然若棄授時之消長則無足論授時本非不刋之法也今時歷象考成推步只有求天正冬至與求定冬至之法而不言消長紛紛之論可定矣

數學卷二

欽定四庫全書

數學卷三

婺源江永撰

恆气注歷辧

【攺憲以來用定气注歷久矣勿庵先生嘗舉康熙己未以後歷年髙行以及四正相距時日別爲一卷而云治歷首務太陽太陽重在盈縮又云西法最髙卑之點在兩至後數度嵗嵗束移故𨿽冬至亦有加減不得以恆爲定此是西法中一大節日則先生亦甚重定气矣而疑問補等書謂當如舊法之恆气注歷持論甚堅永深思之謂恆气與平气不同冬至旣不得以恆爲定則諸气節亦當用定不可用恆爰引先生之說疏論其下惜不獲依門墻而質正也】

勿庵先生曰【歷學疑問補】問舊法節气之日數皆平分今則有長短何也曰節气日數平分者古法謂之恆气【以嵗用三百六十五日二十四刻奇平分爲二十四气各得一十五日二十一刻八十四分奇】其日數有多寡者謂之定气【冬至前後有十四日奇爲一气夏至前後有十六日爲一气其餘節气各各不同並以日行盈歷而其日數減行縮歷而其數增】二者之算古歷皆有之然各有所用唐一行大衍歷議曰以恆气注歷以定气算日月交食是則舊法原知有定气但不以之注歷耳永按七政在天皆有平行有視行平行爲步算之根視行爲人事之用故月必以定朔定望推交食五星必以嵗輪視度察淩犯太陽尢爲气化之主其用於人最大𨿽行於本天者一日一度【此古之日度】無盈縮進退而輪有髙卑人視黃道上度有盈縮則气有短長一切分至啟閉及諸節气皆當用其視行之定气不當用其平行之恆气也何以言之如雲冬至夏至至者極也人視日極南極北立表測之景極長極短而晝夜之短長亦於此日爲極也春分秋分黃道與赤道交日正當其交處陽曆陰曆於此分而晝夜時刻均亦於此日平分也若景非極長極短不得謂之至日不正當赤道不得謂之分故皆當用視度不用平度如史紀冬至有從測景得者書曰某日景長景長者定冬至非平冬至也平與定之差隨髙衝離冬至逺近而異元至元以前定冬至皆在平冬至前至元以後定冬至皆在平冬至後其相差之極亦如今之春秋分前後約二日有奇【日躔如減差表均數最多者二度有奇故平气定气能差二日有奇】而歷家紀冬至必據景長之日人事之最重大者如朝防園丘皆以是日爲定則自古以來冬至皆用定气矣一嵗節气獨冬至用定其餘二十三气皆用恆寧有是理況其所謂恆气者並非恆气也如欲定在天之恆气當以太陽本天界爲二十四段一段均得十五度【據今法整度言之】又以一嵗三百六十五日二十三刻三分四十五秒之平嵗實【據今歷嵗實平率言之】分爲二十四气一气約得十五日二十刻一十四分三十一秒五十二微半【亦據今之刻分秒微言之】以年冬至起根而均之猶曰此在天太陽平行之平气也今乃以太陽視行之定冬至與來嵗定冬至相距之時日折半以爲夏至四折以爲春秋分又均以爲諸中气節气無論春秋分非交赤道之日卽諸中气節气亦無一气合乎在天之均平者矣何也平冬至與定冬至起根不同也兩嵗冬至相距爲活泛之嵗實與平率嵗實多寡不同也如月有平朔平望平有定朔定望定步算者必以月之經朔時日爲根【卽平朔】以朔防累加之爲逐月經朔朔防折半爲平望四折爲平若以此月定朔與後月定朔之時日【多者二十九日九時少者二十九日三時】折半爲望又折半爲則平者皆非平矣古歷不知定朔自唐以來旣用定朔定望推交食必無復用平朔平望注歷之理若以定朔爲距折半爲望又折半爲無此理亦無此法恆气亦猶是也古歷家惟隋劉焯皇極歷始用定气其歷未頒行大衍歷以後諸家皆有推定气之法然一行之言曰凡推日月度及軌漏交蝕依定气注歷依常气則唐以後歷家必用恆气注歷者皆一行此言誤之也何可復仍其誤乎

譯西法者未加詳考輒謂舊法春秋二分並差兩日則厚誣古人矣夫授時歷所注二分日各距二至九十一日奇乃恆气也【歷經歷艸皆明言恆气】

永按授時之恆气與大衍之恆气𨿽若無異亦微有辧至元時平冬至與定冬至時刻略同則其均之恆气以定冬至爲根猶之以平冬至爲根也若一行作歷在至元辛巳前五百五十餘年髙衝約在冬至前十度其時兩心差又較大定冬至約在平冬至前四十餘刻其所謂恆气者以定冬至爲距非以平冬至爲根則當年恆气二分加時或近夜半前後者與在天之平气二分相差亦可一日矣【春分先天秋分後天】此理一行固未知郭氏亦未曉【郭氏之時與天偶符】由太陽有髙卑髙卑又有行度兩心又有微差重闗未啟故也今日此理已明固可無疑於定气

其所注晝夜各五十刻者必在春分前兩日奇及秋分後兩日奇則定气也定气二分與恆气二分原相差兩日授時旣遵大衍歷議以恆气二分注歷不得復用定气故但於晝夜平分之日紀其刻數則定气可以互見非不知也且授時果不知有定气平分之日又何以能知其日之爲晝夜平分乎

永按授時固明言四正定气矣然自小寒至大雪二十三气皆用恆气注歷由惑於一行之歷議亦由當時髙衝與冬至同度最髙與夏至同度冬至爲盈初夏至爲縮初意其盈縮之限常如此故以兩冬至相距之時日均爲二十四气以爲合於天之平分時日也設當時早有西士之說發明最髙最卑隨時推移之理而告之曰今日之盈初在冬至縮初在夏至者由太陽髙卑兩點與二至同度故也向後五十餘年兩點各東移一度則平冬至與定冬至不相值而諸節气中气平定皆不同矣又細推之前後一嵗半嵗亦微有不同者矣及其極也平冬至與定冬至相差兩日有奇當是時猶以兩定冬至相距時日均爲二十四气則小寒至大雪二十三气不皆與平气相差兩日乎倘欲並冬至亦用平舎景長之日而用景未極長之日旣有所未可或欲令二十三气皆從平冬至起根而均之則是冬至至小寒驟減兩日只有十三日大雪至冬至驟增兩日竟有十七日奇也寧有是理乎進退無所據則欲遵大衍常以恆气注歷者爲舛矣郭氏聞此論亦當別立隨時推定气之法不當以恆气注歷矣

夫不知定气是不知太陽之有盈縮也又何以能算交食何以能算定朔乎【經朔猶恆气定朔猶定气望與上下亦然】

永按經朔猶恆气定朔猶定气此理極是然恆气與經朔猶有辧何也以日月平行算其相防是以平爲根今注歷之冬至由日躔加減表與日差表定其加時則是視行之定冬至非平行之平冬至矣上下數千年惟至元辛巳間定冬至卽平冬至其他皆有差其相差之極至二日猶執算定之冬至以爲根逐气均命爲恆气而謂其猶經朔可乎

夫西法以最髙卑疏盈縮其理原精初不必爲此過當之言良由譯書者並從西法入手遂無暇參稽古歷之源流而其時亦未有能眞知授時立法之意者爲之援據古義以相與虛公論定故遂有此等偏說以來後人之疑議不可不知也

永按曆書之言固過然使今日猶執一行之恆气注歷推其流失有如前條進退無據之云者

又曰其所以爲此說者無非欲以定气注歷使春秋二分各居晝夜平分之日以見古法授時之差兩日以自顯其長殊不知授時是用恆气原未嘗不知定气不得爲差而西法之長於授時者亦不在此以定气注歷不足爲奇而徒失古人置閏之法欲以自暴其長反見短矣故此處宜酌攺也後條詳之

永按授時𨿽知有定气未知盈縮二根之有推移今時冬至旣不爲盈初則據定气冬至爲根均一嵗之二十三气似不得爲長矣【失古人置閏之法詳見後辧】

又曰問授時旣知有定气何爲不以注歷曰古者注歷只用恆气爲置閏地也

永按定气注歷亦正爲密於置閏地也閏以無中气之月爲的然必合算定朔定气視其無中气之月置閏於此乃爲眞閏月若只用定朔不用定气則無中气之月未必果無中气也譬之算定朔必合太陽盈縮太陰遲疾視其相防之日命爲朔乃爲眞定朔若得其一遺其一則或有以晦爲朔以二日爲朔者矣古歷置閏疎謬後漸知用定朔置閏於無中气之月矣而不知用定气則無中气之月亦非眞然則堯命羲和以閏定四時成嵗之法至今日始精耳

春秋傳曰先王之正時也履端於始舉正於中歸邪於終【邪與餘同謂余分也○永按左傳本作余漢書引作邪】履端於始序則不愆舉正於中民則不惑歸邪於終事則不悖蓋謂推步者必以十一月朔日冬至爲起算之端故曰履端於始而序不愆也

永按履端於始先生說近是然不必朔日也一嵗始冬至卽履端於始也杜注步歷之始以爲術之端首似後世之推歷元者非也

又十二月之中气必在其月如月內有冬至斯爲仲冬十一月月內有雨水斯爲孟春正月月內有春分斯爲仲春二月餘月並同皆以本月之中气正在本月三十日之中而後可名之爲此月故曰舉正於中民則不惑也

永按舉正於中正卽三正之正此正朔示民使民遵之故曰民則不惑正月爲嵗首而言舉正於中者對冬至爲始嵗終爲終則正朔在其中間也周之正𨿽與冬至同月而步歷猶以冬至爲始故舉正爲中且言先王之正時亦通三正而言之也杜注云舉中气以正月果爾何以不云舉中而云舉正乎且古歷節气亦由略而詳由疎而密上古少皞氏以鳥名官有司分司至司啟司閉而左氏亦云凡分至啟閉必書云物啟者立春立夏閉者立秋立冬並二分二至爲八節則古時只有八節未有二十四气也二十四气之名蓋秦漢以來始有之其名義大約有所本如雲驚蟄者今夏小正之啟蟄月令之蟄虫始振也雨水者本月令之始雨水也芒種者本周禮澤艸所生種之芒種也小暑者本月令小暑至也處暑者本楚語處暑之旣至也白露者本月令白露降也霜降者本荀子霜降殺內月令霜始降也大寒者本魯語大寒降也而中气節气漢以來亦有小異漢以驚蟄爲正月中雨水爲二月節而劉歆三統歷始攺雨水爲正月中驚蟄爲二月節三統歷猶以谷雨爲三月節淸明爲三月中而易緯通卦驗則以淸明爲三月節谷雨爲三月中然則左氏時尙未有中气節气如今歷之詳密不得以舉正爲舉中气

右一月之內只有一節气而無中气則不能名之爲何月斯則余分之所積而爲閏月矣閏卽余也前此余分累積歸於此月而成閏月有此閏月以爲余分之所歸則不致春之月入於夏且不致冬之月入於明春故曰歸邢於終事則不悖也

永按左氏之意本謂閏月當在嵗終今文公元年閏三月爲非禮【文公元年本無閏三月永別有辧此未暇及】此左氏習見當時置閏常在嵗終故爲此言本非確論亦可見古歷未有中气節气如後世之詳密不能定其當閏何月故不得已總歸之嵗末秦人以十月爲嵗首閏月則爲後九月漢初猶仍其失太初歷以後始攺之左氏歸余於終之言信矣梅先生謂歸余分於無中气之月則終字之義似無所指然先生於此句本有兩說其答李祠部云閏月之義大防不出兩端其一謂無中气爲閏月此據左氏舉正於中爲說乃歷家之法也其一謂古閏月俱在嵗終此據左氏歸余於終爲論乃經學家之詁也古今歷法原自不同推步之理踵事加密故自今日言歷則以無中气置閏爲安而論春秋閏月則以歸余之說爲長何則治春秋者當主經文今考本經書閏月俱在年終此其據矣按歸余於終當以此說爲正然則上句舉正於中非謂舉中气以正月益明矣

然惟以恆气注歷則置閏之理易明何則恆气之日數皆平分故其毎月之內各有一節气一中气【假如冬至在十一月朔則必有小寒在其月望後若冬至在十一月晦則必有大雪節气在其月望前餘月並然】此兩气防之日合之共三十日四十三刻奇以較毎月常數三十日多四十三刻奇謂之气盈又太陰自合朔至第二合朔實止二十九日五十三刻奇以較毎月三十日又少四十六刻奇謂之朔虛合气盈朔虛計之共餘九十刻奇謂之月閏乃毎月朔策與兩气策相較之差也【假如十一月經朔與冬至同時刻則大寒中气必在十二月經朔後九十刻而雨水中气必在次年正月經朔後一日又八十刻奇其餘月準此求之】積此月閏至三十三个月間【卽二年零九个月】其餘分必滿月防而生閏月矣閏月之法其前月中气必在其晦後月中气必在其朔則閏月只有一節气而無中气然後名之爲閏月【假如閏十一月則冬至必在十一月之晦大寒必在十二月之朔而閏月只有小寒節气更無中气則不可謂之爲十一月亦不可謂之爲十二月卽不得不名之爲閏月矣】斯乃自然而然天造地設無可疑惑者也一年十二个月俱有兩節气惟此一个月只一節气望而知爲閏月

永按造化之妙莫妙於均平與參差二者相爲用也若無均平之數則無以爲立算之根若無參差之行則無以爲變化之用故七政各居一重天各有其本行而必有本輪均輪以生盈縮遲疾且復有最髙最卑之行度焉又有兩心差之攺焉所以變動不窮也使太陽可用恆气何不去其小輪終古只一平行乎

今以定气注歷則節气之日數多寡不齊故遂有一月內三節气之時又或有原非閏月而一月內反只有一中气之時其所置閏月𨿽亦以余分所積而置閏之理不明民乃惑矣

永按一月三節气甚稀間有之今時必在冬月又必定朔最大然後有此其或首尾皆節气而中气在月中也則去閏月尙逺其或首尾皆中气而節气在月中也則置閏在此月之前不以後月爲閏此於置閏之法初無所妨若一月之內只一中气更無妨於閏月矣

然非西法之咎乃譯書者之疎略耳何則西法原只有閏日而無閏月其仍用閏月者遵舊法也亦徐文定公所謂鎔西洋之巧算入大統之型模也

永按定气注歷攺憲之大者當時譯書者之失惟在星紀等名系諸中气耳

按堯典云以閏月定四時成嵗乃帝堯所以命羲和萬世不刋之典也今旣遵堯典而用閏月卽當遵用其置閏之法而乃不用恆气用定气以滋人惑亦昧於先王正時之理矣是故測算𨿽精而有當酌攺者此亦一端也

永按羲和之歷或用恆气與否不可考使當時惟知用恆气今攺用定气猶平朔攺爲定朔其理益精益當耳

又曰今但依古法以恆气注歷亦仍用西法最髙卑之差以分晝夜長短進退之序而分注於定气日之下卽置閏之理昭然眾著而定气之用亦並存而不廢矣永按定气之用甚大一切陰陽五行自干支出者或系於月建則交節气之日時爲要【未交節气系前月旣交系今月】或系於年嵗則交立春之日時爲要【未交立春系前年旣交系今年】諸節气中气各方農家或以之占有驗而祿命三式諸術不可盡信亦不可盡廢者年月干支爲綱維其交界之際尢不可不確也定气恆气之差小者在時大者在日其極差兩日有奇此豈可不辧其理之是非以定年月之交界而姑爲並存之說使定气僅爲分晝夜長短之用乎夫定气所以必當用者何也太陽有本輪均輪本輪之心恆平行於本天而太陽之體實旋行於輪上從地心出綫至輪心其度皆平度若太陽行輪上有加減則人視黃道所當之度非輪心之度而气亦非均平之气日行卑時气策未滿而度已盈故气短日行髙時气策已滿而度未盈故气長其積差在髙卑之中兩日有奇故定气之度卽黃道上平剖爲二十四段者太陽旣到其上卽爲實度其气卽爲眞气人生於地安得不稟於其所視而更從輪心之平行者乎況又不以平冬至爲根而以定至起算天上原無此界限夫以本無之界限命爲恆气而注之歷以爲民用大者系一年次者系一月非前人之失乎

又按恆气在西法爲太陽本天之平行定气在西法爲黃道上視行平行度與視行度之積差有一度半弱西法與古法略同所異者最髙衝有行分耳古法恆气注歷卽是用太陽本天平行度數分節气

永按定气時日不均而度均若恆气者時日均而度反不均矣且又以定冬至起算卽非本天平行度數之分限【觀後壬辰年節气圖可見】

又曰【歷學駢枝】按古歷毎日行一度原無盈縮言盈縮者自北齊張子信始也厥後隋劉焯唐李淳風僧一行言之綦詳歷宋至元爲法益密然不以之注歷者爲閏月也大衍歷議曰以恆气注歷定气算日月食由今以觀固不僅交食用盈縮也凡定朔定望定無處不用但毎月中節仍用恆气不似西洋之用定气耳西洋原無閏月祗有閏日故以定气注歷爲便若中土之法以無中气爲閏月故以恆气注歷爲宜治西法者不諳此理輒訶古法爲不知盈縮固其所矣永按定气注歷無妨於置閏而置閏得此始眞前已辧之明矣若唐以來中土歷家知有定气而仍以恆气注歷者其故多端一由不知日之所以盈縮者生於小輪也一由不知盈縮之初限不恆系二至也一由不知冬至相距爲活泛嵗實而別有恆嵗實也一由不知景長爲定冬至而別有平冬至也由不知恆气起定冬至天上無此界限也種種機竅未啟宜其貿貿然用之以注歷豈謂其宜於置閏哉治西法者不能明辧恆气之失而徒訶古法爲不知盈縮此則徐李湯羅諸公之疎也康熙壬辰年節气圖

【恆气非卽平气前辧𨿽明非圖不顯今以昔年所推康熙壬辰年平定節气分爲兩層別以一層載古法恆气以顯平气恆气之異】

﹤子部﹐天文算法類﹐推步之屬﹐數學﹐卷三﹥

右圖第一層太陽黃道上視行定气注歷以爲用者也第二層太陽本天平行平气以平冬至爲立算之根諸气皆爲定气加減之根不注諸歷者也此兩行者在天實有此界限若第三層則冬至爲視行定气小寒以後皆從定冬至爲根以平气累加之其平气又非平嵗實均剖但以兩定冬至嵗實平之【終嵗有微差】謂之恆气在天實無此界限此年最髙衝在冬至後七度三十八分四十四秒實減一十六分有奇變爲時以加於平冬至者二十六刻有奇故諸恆气皆後於平气三時有奇後此數千年髙衝行二三宮定冬至在平冬至後二日則諸恆气不皆後於平气二日乎

或曰天體渾然本無界限界限皆人所分卽恆气亦自古歷家所分何以知其實有而實無曰十二月建在天實有者也一月分爲節气中气亦自然之理也太陽本輪心在本天上平行而黃道上有太陽實行因此兩種行度各平分之則有兩種界限𨿽人所分亦因理之實有者而分之若從定冬至起根均二十三气無此理卽無此數矣從來推平望平者必無從定朔起算之理何獨於恆气而疑之

定气注歷遵行已久前此順治康熙年間民間推步爲祿命家用者或仍用恆气或兼存古法無識者將滋其惑嘗邂逅先生門人猶有堅持師說者是以不得不辧

數學卷三﹤子部﹐天文算法類﹐推步之屬﹐數學﹥

欽定四庫全書

數學卷四

婺源江永撰

冬至權度

【履端於始序則不愆歷家詳求冬至且求千歲以上冬至証之史傳或離或合其故難言元史有六歷冬至開載魯獻公戊寅至元庚辰四十九事紀大衍宣明紀元統天重修大明授時時刻之異同勿庵先生因之作春秋以來冬至攷刪去獻公一事各以其歷本法詳衍術𨿽明而未有折衷永因先生所攷定者用實法推算有不合者斷其歷誤史誤名曰冬至權度俟知歷者攷焉】

一論平歲實

太陽本天有平行歷黃道一周爲平歲實與月五星周率朔策合率同理別有本輪均輪最卑最髙之行以視行加減平行二十四气時刻多少歲歲不同而古今冬至不能以一率齊之是爲活泛之歲實猶之月有實防逐月不同五星有實合毎周不同也授時大統以前太陽髙卑之理未明𨿽知一歲之行有盈縮不悟盈縮之中爲平歲實但求歲實於活泛之冬至故一歷必更一周率與歲實然合今則戾古合古又違今統天歷遂立距差躔差之法暗藏消長以求上下兩合授時歷本之有百年長一消一之說西曆本回歷以春分相距測定歲周小餘五小時三刻三分四十五秒以萬分通之爲二四二一八七五此爲平行之歲實小餘而各節气之定气則以均度加減定之此不易之法也欲攷往古冬至當以平歲實爲本當年平冬至時刻乃以定冬至較之知其距最卑之遠近或與今法有不合則知其時本輪均輪之有半徑差有相去之遠者則知史傳所記非實測所謂苟求其故千歲之日至可坐而致者此爲庶幾焉倘以授時之歲實爲歲實而以百年長一消一爲凖則非法矣

一論最卑行

太陽本輪最卑防爲縮未盈初之端歲有推移與月入轉五星入歷皆有行度同理平冬至之攺爲定冬至也視此防之前後逺近以加度而減時減度而加時焉至元辛巳間最卑與平冬至同度自是以前定冬至皆在平冬至前以後定冬至皆在平冬至後最卑有行度故也【郭氏時未悟此理恆以冬至爲盈初大統承用數百年誤矣】西法近率最卑歲行一分一秒十微以遠年冬至攷之此率似微朒大約當加二秒上求古時定冬至以此爲凖焉

一論輪徑差

最卑旣有行度矣而太陽之體在均輪均輪之心在本輪本輪之心在本天此兩輪半徑古今又有不同則距地遠近兩心有差西法始定兩輪半徑並千萬分之三十五萬八千四百一十六而今又漸減則古時必多於此半徑大則加減差亦大而以均度變時分加減於平冬至者視今時必稍贏焉此差率出於恆差之外歷家亦不能定者也上攷又當以此消息之【余因劉宋大明五年測景求彼時兩半徑並詳後】

右三事者攷冬至之權度也大統以前歷家莫能知而勿庵先生言之未詳永竊爲補之

春秋以來冬至攷

勿庵先生云春秋以來冬至多矣而所攷只此者以其測驗之可據也歷議原載四十八事今攷獻公在春秋前無信史可徴故刪之而以左傳僖公一條爲首實四十七事也【並至元庚辰四十八事】

永竊疑四十七事𨿽有信史可徴而歷算與紀載未必無誤若左傳所記兩冬至尢未可信其由於實測後詳之

魯僖公五年丙寅歲正月辛亥朔旦冬至

唐開元大衍歷【辛亥亥正三刻】唐宣明歷【辛亥申正初刻】宋崇寧紀元歷【壬子戌正一刻】宋統天歷【辛亥寅正三刻】金重修大明歷【壬子亥初二刻】元授時歷【辛亥寅初二刻】

按傳載是年正月辛亥朔日南至公旣視朔遂登觀臺以望而書古歷家皆謂至朔同日之年也今詳推之謹按歷象考成康熈甲子天正冬至气應七日六五六三七四九二六爲七日十五小時四十五分十一秒上距僖公丙寅二千三百三十八年中積八十五萬三千九百三十六日五小時三十七分三十秒滿紀法去之餘一十六日五小時三十七分三十秒轉減气應【加一紀減之】餘五十一日十小時七分四十一秒平冬至乙夘巳正初刻八分又按至元辛巳前四年丁丑髙衝【卽最卑】與冬至同度上距此年一千九百三十一年約四百年行七度則此年髙衝在冬至前一宮三度四十八分於今法當加均一度八分變時一日三小時三十七分減平冬至猶是甲寅日夘時再約計是時小輪並徑加大其加減均或能至一度二三十分之間變時一日十餘小時以減平冬至則定冬至亦止癸丑日亥子之間而已必不能減至辛亥則是時所推冬至先天兩三日矣又此月平朔定朔皆在壬子而當時誤推辛亥亦先天一日【春秋緯命歷序壬子朔隋張賔張冑唐一行皆從之】實攷之此年正月壬子朔二日癸丑冬至耳至朔何嘗同日乎【張賔依命歷序壬子朔冬至張冑謂三日甲寅冬至旣不從傳亦不從命歷序𨿽甲寅或稍後天然而冑之識卓矣】春秋時王朝未必頒歷各國自爲推步閏餘乖次月日參差日食或不在朔所以考求日至者必不能如後世之精宻差至二三日固無足怪【魏晉以後歷法漸明劉宋時景初曆冬至猶後天三日則春秋時無足怪】歷家過信左氏意謂此年特載日南至必當時實測【唐一行謂僖公登觀臺以望而書云物出於表晷天驗非時史億度此一行之蔽也傳言書云未嘗言測景】作歷欲求合於古則多增斗分以就之大衍推辛亥亥正三刻宣明推辛亥申正初刻皆泥此至之過也【大衍號稱善歷行之數年而卽差由斗分大彊之故】紀元與重修大明僅能得壬子與辛亥差一日知斗分不可過增寧失此至不彊求合猶爲近之若統天創爲距差躔差之法巧合此至而授時遂暗用之有百年長一之率此至皆得辛亥日寅時此無法之法最爲乖謬夫總計距乘而益之越百年則有驟增之時刻年愈逺則驟增之數愈多【勿庵先生亦嘗疑之】授時以至元辛巳爲元上距此年一千九百三十五卽以一九三五總乘所長之一九數而益歲餘設減三十五爲辛丑當文公七年距一千九百則歲餘二十四刻四十四分矣前一年庚子距一千九百零一歲餘增一分此一分乘一千九百零一凡一十九刻有奇則當此庚子年驟增一十九刻有奇天道寧有此數乎況越二千年而驟增者愈多其長伊於胡底乎故消長之法斷不可用而此年正月辛亥朔日南至當以實法考求決其爲步之誤不可過信傳文而捨法以求合也

魯昭公二十年己夘歲正月己丑朔旦冬至

大衍【己丑巳正三刻】宣明【己丑寅正三刻】紀元【庚寅夘正初刻】統天【戊子亥正三刻】重修大明【庚寅辰初初刻】授時【戊子戌初三刻】

按此年上距僖公五年一百三十三年平冬至二十八日十五小時一十一分二十六秒壬辰日申初初刻十一分約計加均及小輪徑差減時不過一日八九小時定冬至不過辛夘日夘辰之間而已必不能減至己丑而傳載己丑日南至以此知春秋時步冬至恆先天二三日也且魯歷前年失閏此年日南至在二月夫周以子月爲正日至必無在二月者當時梓愼輩徒知望氛祥占禍福於時月之易明者猶不能正何能實測冬至與天脗合乎大衍宣明紀元重修大明斗分有多少故日名有合有不合若統天授時皆以活法求之又先己丑一日失之愈逺矣同一左氏傳也丙寅之冬至則合己夘之冬至則違亦可見活法之有時窮矣由今觀之違者固非合者亦未盡是而元史歷議乃以此至爲日度失行不亦誣乎

劉宋文帝元嘉十二年乙亥歲十一月十五日戊辰景長

大衍【戊辰辰正二刻】宣明【戊辰辰初三刻】紀元【戊辰巳初二刻】統天【戊辰午正三刻】重修大明【戊辰巳初三刻】授時【戊辰午初一刻】

按史記冬至景長始此是時用景初曆推冬至率後天三日何承天上表言之太史令錢樂之言是年景初推十一月十八日冬至其十五日景極長今推此年平冬至五日九小時四十五分一十一秒己巳日巳初三刻【今京師時刻劉宋都建康當減八分四秒後陳朝仿此】是時髙衝約在平冬至前十四度太又小輪半徑差多於今加均減不啻半日定冬至宜在戊辰與史合然均度不過三十餘分減時不能越十五小時戊辰日加時大約在酉半以後是以明年冬至當越六日甲戌景長六歷推此年平冬至非不得戊辰而加時皆蚤旣在午刻以前則明年安得甲戌景長乎

元嘉十三年丙子歲十一月二十六日甲戌景長【景初曆推二十九日冬至】

大衍【癸酉未正一刻】宣明【癸酉未初三刻】紀元【癸酉申初一刻】統天【癸酉酉正二刻】重修大明【癸酉申初三刻】授時【癸酉酉初初刻】

今推此年平冬至一十日十五小時三十三分五十六秒甲戌日申初二刻四分是時加均減時不能越十五時是以定冬至亦在甲戌史紀此日景長必是實測而六歷皆先一日癸酉其不能與天宻合此已見其端矣【乂按後四年庚辰甲午景長四年之間小餘平積二十日二十三時一十五分庚辰定冬至未至乙未則甲午必是夜子初幾刻逆推此年甲戌必是子正幾刻】

又按唐一行歷議云元嘉十三年十一月甲戌景長皇極麟徳開元歷皆得之癸酉蓋日度變常耳祖衝之旣失甲戌冬至以爲加時太早增小餘以附防之而十二年戊辰景長得己巳十七年甲午景長得乙未十一年己亥景長得庚子合一失三其失愈多愚謂此年景長甲戌可推也而一行以爲日度變常非是

元嘉十五年戊寅歲十一月十八日甲申景長【景初曆推二十一日冬至】

大衍【甲申丑正初刻】宣明【甲申丑初二刻】紀元【甲申寅初初刻】統天【甲申夘正一刻】重修大明【甲申寅初二刻】授時【甲申寅正三刻】

今推此年平冬至二十一日三小時一十一分二十六秒乙酉日寅初初刻十一分定冬至以丙子歲甲戌子正幾刻推之當在甲申午正前後之間六歷皆先天

元嘉十六年己夘歲十一月二十九日己丑景長【景初曆推次月二日壬辰冬至】

大衍【己丑辰初三刻】宣明【己丑辰初一刻】紀元【己丑辰正三刻】統天【己丑午正初刻】重修大明【己丑巳初一刻】授時【己丑巳正二刻】

今推此年平冬至二十六日九小時零一十一秒庚寅日巳初初刻定冬至當在己丑酉正前六歷皆先天

元嘉十七年庚辰歲十一月初十日甲午景長【景初曆推十二日冬至】

大衍【甲午未初三刻】宣明【甲午未初初刻】紀元【甲午未正三刻】統天【甲午酉正初刻】重修大明【甲午申初初刻】授時【甲午申正二刻】

今推此年平冬至三十一日十四小時四十八分五十六秒乙未日未正三刻四分而景長在甲午必在夜子初幾刻減時幾有十五小時則加均約三十六分以當時髙衝在冬至前十四度有奇推之而小輪半徑之差亦大略可知矣

又按隋書律曆志劉孝孫等言此年曆法十三日冬至十一日景長則是乙未日矣

元嘉十八年辛巳歲十一月二十一日己亥景長【景初曆推二十五日冬至】

大衍【己亥戌初二刻】宣明【己亥酉正四刻】紀元【己亥戌正二刻】統天【己亥夜子初三刻】重修大明【己亥亥初初刻】授時【己亥亥正一刻】

今推此年平冬至三十六日二十小時三十七分四十一秒庚子日戌正二刻八分歷攷元嘉間定冬至加均減時不能越十五時此年若己亥景長則減時二十有奇蓋史文二十二日譌爲二十一日唐一行歷議與元史沿誤差一日也錢樂之謂尋校前後以景極長爲冬至並差三日此年景初推二十五日冬至景長在二十二日是差三日若二十一日則差四日矣【定冬至宜在庚子日寅夘之間六歷𨿽皆推己亥未足爲據】

又按隋書劉孝孫等云此年陰無景可驗今歷二十二日冬至更可證是庚子

元嘉十九年壬午歲十一月初三日乙巳景長【景初曆推六日冬至】

大衍【乙巳丑初二刻】宣明【乙巳子正四刻】紀元【乙巳丑正一刻】統天【乙己夘初三刻】重修大明【乙己丑正三刻】授時【乙巳寅正初刻】

今推此年平冬至四十二日二小時二十六分二十六秒丙午日丑正一刻十一分定冬至乙巳午初

孝武帝大明五年辛丑歲十一月乙酉冬至

大衍【甲申申正四刻】宣明【甲申申正二刻】紀元【甲申酉初二刻】統元【甲申戌初初刻】重修大明【甲申酉正一刻】授時【甲申戌初初刻】

按此年祖衝之詳記測景推算冬至乙酉日夜半後三十二刻七十分今細推之當時算冬至稍後天而六歷推甲申皆先天也詳推如左

一推此年平冬至

按大明辛丑距康熈甲子天正冬至一千二百二十二年中積四十四萬六千三百二十五日二十二小時五十二分三十秒轉減甲子气應【加一紀減之】餘二十一日十六小時五十二分四十一秒平冬至乙酉申正三刻七分四十一秒建康加八分四秒酉初初刻四十五秒

一推此年髙衝行

按元至元辛巳前四年丁丑髙衝與冬至同度上距此年八百一十五年若依今法一年行一分一秒十微則此年髙衝在冬至前十三度五十分五十一秒如此率未的一年約加二秒四百年行七度則此年髙衝在冬至前十四度十六分

一推此年十月十日壬戌景長髙弧距緯並經度按史此年祖衝之測景十月十日壬戌景長一丈七寸七分半○以三率法推算【一率表八尺二率景一丈七寸七分半三率半徑全數四率爲余切綫】求得一三四七以余切檢八綫表此日午正日髙弧三十六度三十五分二十四秒○表所得者太陽上邊之景宜減太陽半徑一十五分二十九秒得太陽中心距地平三十六度一十九分五十五秒○日軌髙視差二分二十三秒內減去靑气差二十七秒余視差一分五十六秒加於太陽中心距地平得實髙三十六度二十一分五十一秒距天頂五十三度三十八分九秒○建康極出地約三十二度以減距天頂度餘二十一度三十八分九秒爲本日午正黃赤距緯○設此時兩道大距二十三度三十九分二十三秒用三率法【兩道大距正爲一率本日午正黃赤距緯正爲二率半徑全數爲三率得四率爲余】求得余九一八九檢表二十三度十四分爲壬戌午正距冬至實經度減用時【七分二十九秒】爲平時午初三刻七分半太陽距冬至實經度

一推壬戌午時太陽平行度

建康平冬至【見前】距壬戌午初三刻七分半二十三日五小時八分二十五秒太陽平行二十二度五十二分五十秒以減全周壬戌午初三刻七分半太陽平行十一宮七度七分一十秒

一推十一月二十五日丁未景長髙弧距緯並經度按史丁未景長一丈八寸一分太○以三率法推算【一率表八尺二率景長一丈八寸一七五三率半徑全數四率爲余切綫】求得余切一三五二二檢表此日午正日髙弧三十六度二十九分三秒○減太陽半徑一十五分二十六秒太陽中心距地平三十六度一十三分三十七秒○日軌髙視差二分二十四秒減去靑气差二十七秒余視差一分五十七秒加於太陽中心距地平得實髙三十六度一十五分三十四秒距天頂五十三度四十四分二十六秒○極髙三十二度減距天頂度餘二十一度四十四分二十六秒爲本日午正黃赤距緯○設兩道大距二十三度三十九分二十三秒用三率法求得余九二三一一檢表二十二度三十七分六秒爲本日午正距冬至實經度加用時二分三十五秒爲平時午正初刻二分三十五秒太陽距冬至實經度

一推丁未午時太陽平行度

建康平冬至距丁未午正初刻二分三十五秒二十一日十九小時一分五十秒太陽平行二十一度二十八分四十七秒

一推此時小輪半徑差

以本年髙衝冬至前十四度十六分減壬戌太陽平行距平冬至二十二度五十二分五十秒餘八度三十六分五十秒查舊日躔加減差表減十八分四十八秒化作一千一百二十八秒爲一率以舊表兩心差三五八四爲二率又於壬戌經度二十三度一十四分內減平行二十二度五十二分五十秒餘二十一分十秒化作一千二百七十秒爲三率求得四率四○三五二爲此時兩小輪半徑並【太陽本天一百萬本輪半徑三萬零三百六十四均輪半徑一萬零八十八由此可算其均數】

一推乙酉日定冬至

前壬戌日午正太陽平行十一宮七度七分一十秒至乙酉日子正二十二日半平行二十二度一十分三十八秒加入壬戌午正平行度此時平行十一宮二十九度一十七分四十八秒加髙衝十四度十六分滿周天去之餘一十三度三十四分爲引數以此時兩小輪半徑並算之約加均度三十二分奇加入前子正平行在十一宮二十九度五十分未滿周天者十分爲時約四小時定冬至在子正後十六刻有奇當時以前後景折算乙酉日子正後三十一刻冬至約後天十五刻

按以冬至前後日景折算取中求冬至時刻此法惟郭太史時可用其時髙衝與冬至同度故也若大明時髙衝在冬至前十四度有奇則冬至前之日近髙衝太陽之行速而景之進退也疾冬至後之日遠髙衝太陽之行稍遲而景之漸短亦必稍緩𨿽前後之日景大略相同而中間所歷之時刻必不均當時欲以均數求冬至宜其後天十五刻也【冬至前二十餘日日行較連時刻宜減冬至後二十餘日日行較遲時刻宜加若欲均之則折半處必在所減之後故後天】然劉宋之初歷法甚疎景初曆後天至三日猶幸祖氏用景長推算違天尙未甚逺又幸史冊紀載之詳去今千有餘年猶可細推其後天之時刻也郭太史攺歷所定歳周小餘二四二五者謂自大明壬寅距今每歲合得此數按此年下距至元辛巳八百一十九年以授時歲周積之二十九萬九千一百三十三日六十刻七五五分以辛巳天正冬至己未日子正後六刻逆計之則當時冬至在乙酉日子正後五十四刻後天愈加多矣旣不能與當時所測算者宻合又爲百年長一之法以求合於逺古之冬至以八百一十九總乘所長之數而益之則此年冬至又在甲申日七十九刻太不又先天三十七刻乎以此知授時之歲餘非定率而統天之距差躔差授時之消長皆謬法也此年冬至所關者鉅故攷論加詳若大衍諸歷先天愈多則無足論而授時指爲日度失行者總論之於後云

陳文帝天嘉六年乙酉歲十一月庚寅景長

大衍【庚寅寅初初刻】宣明【庚寅寅初初刻】紀元【庚寅寅初二刻】統天【庚寅夘初四刻】重修大明【庚寅丑初四刻】授時【庚寅寅正初刻】

今推此年平冬至二十六日二十一時二十二分四十一秒庚寅亥初一刻八分定冬至蓋在辰巳間諸歷推丑寅皆太蚤統天近之

臨海王光大二年戊子歲十一月乙巳景長

大衍【乙巳戌正二刻】宣明【乙巳戌正三刻】紀元【乙巳戌初初刻】統天【乙巳夜子初二刻】重修大明【乙巳戌初二刻】授時【乙巳戌初二刻】

此年平冬至丙午未正三刻九分定冬至蓋在乙巳與丙午之間乙巳之景長於次日當亦甚微然以後四歲丁夘景長推之此年所紀猶可疑說見後

宣帝太建四年壬辰歲十一月二十九日丁夘景長大衍【丙寅戌正初刻】宣明【丙寅戌正一刻】紀元【丙寅酉正二刻】統天【丙寅亥正三刻】重修大明【丙寅酉正三刻】授時【丙寅戌正四刻】

今推此年平冬至三日一十四時三分五十六秒丁夘未正初刻四分史記丁夘景長則定冬至蓋在子正初刻以前四歲乙巳景長較之殊可疑此年平冬至子正後一十四時四分而景長猶在本日是加均減時不能越十四時四分也光大二年之平冬至在丙午日子正後十四時四十五分乃能越之而景長在前一日乙巳不應四歲之間差殊如此此兩歲定冬至皆在子初子正之間景長最難眞確乙巳與丁夘當時測驗有一是必有一非竊疑乙巳之測未確

太建九年丁酉歲十一月二十三日壬辰景長

大衍【癸巳丑初一刻】宣明【癸巳丑初二刻】紀元【壬辰夜子初三刻】統天【癸巳寅正一刻】重修大明【癸巳子正初刻】授時【癸巳丑正初刻】

今推此年平冬至二十九日一十九時七分四十一秒癸巳戌初初刻八分定冬至蓋在本日寅夘之間統天近之二十三日壬辰景長此必史誤

太建十年戊戌歲十一月五日戊戌景長

大衍【戊戌辰初一刻】宣明【戊戌辰初二刻】紀元【戊戌夘初二刻】統天【戊戌巳正初刻】重修大明【戊戌夘初四刻】授時【戊戌辰正初刻】

此與丁酉歲相去一年平冬至己亥定冬至戊戌可考而知故不細推

隋文帝開皇四年甲辰歲十一月十一日己巳景長大衍【己巳酉正二刻】宣明【己巳酉正三刻】紀元【己巳夜子初一刻】統天【己巳戌初初刻】重修大明【己巳酉初初刻】授時【己巳戌正二刻】

今推此年平冬至六日一十一時四十八分五十六秒庚午日午初三刻四分【隋都長安早二刻後唐朝則仿此】定冬至己巳亥子之間【史云此年在洛川測冬至景與京師二處進退絲毫不差張賔歷推己巳冬至張冑歷推庚午冬至】

開皇五年乙巳歲十一月二十二日乙亥景長

大衍【乙亥子正一刻】宣明【乙亥子正二刻】紀元【甲戌亥正二刻】統天【乙亥寅初初刻】重修大明【甲戌戌正三刻】授時【乙亥丑正二刻】

今推此年平冬至十一日一十七時三十七分四十一秒乙亥酉初二刻八分定冬至在本日寅時推甲戌者非是

開皇六年丙午歲十一月三日庚辰景長

大衍【庚辰夘正初刻】宣明【庚辰夘正一刻】紀元【庚辰寅正一刻】統天【庚辰辰正三刻】重修大明【庚辰寅正三刻】授時【庚辰辰正一刻】

與前年相距一歲平定冬至皆在庚辰可攷而知

開皇七年丁未歲十一月十四日乙酉景長

大衍【乙酉午正初刻】宣明【乙酉午正一刻】紀元【乙酉巳正初刻】統天【乙酉未正三刻】重修大明【乙酉巳正二刻】授時【乙酉未正初刻】

此年平冬至丙戌夘初一刻定冬至乙酉申時

開皇十一年辛亥歲十一月二十八日丙午景長大衍【丙午午初二刻】宣明【丙午午初三刻】紀元【丙午巳初二刻】統天【丙午未正初刻】重修大明【丙午巳初四刻】授時【丙午未初二刻】

此年平冬至四十三日四時三十分一十一秒丁未寅正二刻定冬至丙午申時

開皇十四年甲寅歲十一月辛酉朔旦冬至

大衍【壬戌夘初初刻】宣明【壬戌夘初二刻】紀元【壬戌寅初初刻】統天【壬戌辰初二刻】重修大明【壬戌寅初二刻】授時【壬戌辰初初刻】

今推此年平冬至五十八日二十一時五十六分二十六秒壬戌亥初三刻十一分定冬至本日己午間而史記辛酉朔冬至當時歷誤推先天

唐太宗貞觀十八年甲辰歲十一月乙酉景長

大衍【甲申巳正一刻】宣明【甲申午初初刻】紀元【甲申辰初二刻】統天【甲申午正初刻】重修大明【甲申辰初三刻】授時【甲申巳正三刻】

今推此年平冬至二十一日三十三分五十六秒乙酉子正二刻四分長安裏差二刻平冬至已是子正初刻矣減時不啻十時定冬至當在甲申日未時而史謂乙酉景長誤

貞觀二十三年己酉歲十一月辛亥景長

大衍【庚戌申初二刻】宣明【庚戌申正一刻】紀元【庚戌午正三刻】統天【庚戌酉初一刻】重修大明【庚戌未初初刻】授時【庚戌申初三刻】

今推此年平冬至四十七日五時三十七分四十一秒辛亥夘初二刻八分定冬至庚戌日酉戌之間而史謂辛亥景長亦誤

髙宗龍朔二年壬戌十一月四日己未至戊午景長大衍【戊午戌正初刻】宣明【戊午戌正二刻】紀元【戊午申正三刻】統天【戊午戌正初刻】重修大明【戊午酉初初刻】授時【戊午戌初三刻】

今推此年平冬至己未巳初初刻十一分長安辰正二刻十一分此時加均減時約十小時定冬至戊午夜子時是以戊午景長當時歷推冬至己未而實測景長在戊午今推之果不爽也

髙宗儀鳯元年丙子歲十一月壬申景長

大衍【壬申夘正初刻】宣明【壬申夘正三刻】紀元【壬申丑正二刻】統天【壬申辰初初刻】重修大明【壬申丑正三刻】授時【壬申卯初一刻】

今推此年平冬至八日一十八時三十三分五十六秒壬申酉正二刻四分定冬至辰時

髙宗永淳元年壬午歲十一月癸夘景長

大衍【癸夘酉初一刻】宣明【癸夘酉正初刻】紀元【癸夘未初二刻】統天【癸夘酉正一刻】重修大明【癸夘未初四刻】授時【癸夘酉初三刻】

此年平冬至甲辰夘初一刻十一分定冬至癸夘酉戌之間

明皇開元十年壬戌歲十一月癸酉景長

大衍【癸酉午初四刻】宣明【癸酉午正四刻】紀元【癸酉辰初二刻】統天【癸酉午初初刻】重修大明【癸酉辰初三刻】授時【癸酉午初初刻】

此年平冬至癸酉亥初三刻十一分定冬至巳時

開元十一年癸亥十一月戊寅景長

大衍【戊寅酉初三刻】宣明【戊寅酉正三刻】紀元【戊寅未初三刻】統天【戊寅初初三刻】重修大明【戊寅未初二刻】授時【戊寅酉初初刻】

此年平冬至己夘定冬至戊寅與前間一歲可攷而知

開元十二年甲子歲十一月癸未冬至

大衍【癸未夜子初二刻】宣明【甲申子正三刻】紀元【癸未戌初一刻】統天【癸未夜子初三刻】重修大明【癸未戌初二刻】授時【癸未亥正三刻】

按此年僧一行陽城測景癸未最長今推此年平冬至二十九日時三十三分五十六秒甲申巳初二刻四分陽城約早一刻十分爲巳初初刻九分此年距元至元丁丑五百五十二年髙衝約行九度四十分以今加減表攷之加均二十分二十秒變時八時一十五分以減平時餘五十四分爲甲申子正三刻九分當時小輪半徑大於今再減一時有奇則定冬至在癸未夜子刻而大衍歷推算癸未九十八刻太彊此當年之實測今固可追步也

按大衍歷以三千零四十爲通法一百一十一萬零三百四十三爲策實一萬五千九百四十三爲防余以通法五減策余餘七百四十三爲小餘以萬分通之小餘二千四百四十四又七九弱視授時之二四二五者多一十九太彊當時小餘𨿽大必不及此數是以自此年以前大衍推往古則先天推後來則後天【小餘之太彊由欲彊合僖五年辛亥日南至故也】

宋眞宗景徳四年丁未歲十一月戊辰日南至

大衍【戊辰寅初三刻】宣明【戊辰夘正一刻】紀元【丁夘酉初三刻】統天【丁夘戌初一刻】重修大明【丁夘酉正初刻】授時【丁夘戌初一刻】

今推此年平冬至三日二十二時三十分一秒丁夘亥正二刻宋都河南蚤八分其時髙衝在冬至前約四度四十二分又有小輪半徑差通減時約四時三刻有奇定冬至蓋在丁夘酉初二刻紀元近之史記戊辰日南至斗分太多誤推後天也

仁宗皇祐二年庚寅歲十一月三十日癸丑景長大衍【癸丑申初二刻】宣明【癸丑酉正三刻】紀元【癸丑夘初一刻】統天【癸丑夘初初刻】重修大明【癸丑夘初一刻】授時【癸丑夘初三刻】

今推此年平冬至四十九日八時二十六分一十六秒癸丑辰正一刻十一分定冬至寅時

神宗元丰六年癸亥歲十一月丙午景長

大衍【丙午酉初二刻】宣明【丙午戌正二刻】紀元【丙午夘正一刻】統天【丙午夘正一刻】重修大明【丙午夘正一刻】授時【丙午夘正一刻】

今推此年平冬至四十二日八時一十五分一秒丙午辰正一刻定冬至寅夘之間

元丰七年甲子歲十一月辛亥景長

大衍【辛亥夜子初一刻】宣明【壬子丑正一刻】紀元【辛亥午正初刻】統天【辛亥午正一刻】重修大明【辛亥午正初刻】授時【辛亥午正一刻】

此與前間一歲定冬至在辛亥巳時

哲宗元祐三年戊辰歲十一月壬申景長

大衍【壬申亥正三刻】宣明【癸酉丑初二刻】紀元【壬申午初二刻】統天【壬申午初二刻】重修大明【壬申午初二刻】授時【壬申午初二刻】

此年平冬至壬申未初一刻四分定冬至巳時

元祐四年己巳歲十一月丁丑景長

大衍【戊寅寅正二刻】宣明【戊寅辰初三刻】紀元【丁丑酉初一刻】統天【丁丑酉初一刻】重修大明【丁丑酉初一刻】授時【丁丑酉初一刻】

此與前間一歲定冬至丁丑申時

元祐五年庚午歲十一月壬午冬至

大衍【癸未巳正二刻】宣明【癸未未初二刻】紀元【壬午夜子初初刻】統天【壬午夜子初一刻】重修大明【壬午夜子初一刻】授時【壬午夜子初初刻】

此與前間一歲定冬至壬午亥時

元祐七年壬申歲十一月癸巳冬至

大衍【癸巳亥正一刻】宣明【甲午丑初一刻】紀元【癸己巳正三刻】統天【癸己巳正三刻】重修大明【癸己巳正三刻】授時【癸己巳正三刻】

此年平冬至癸巳午正二刻四分定冬至巳初

哲宗元符元年戊寅歲十一月甲子冬至

大衍【乙丑巳初二刻】宣明【乙丑午正二刻】紀元【甲子亥正初刻】統天【甲子亥初三刻】重修大明【甲子亥正初刻】授時【甲子亥初三刻】

此年平冬至甲子二十三時二十六分一十六秒夜子初一刻十分定冬至戌時

按授時百年長一之率年逺則所加分漸贏其所定歲餘刻下二十五分又失之太弱是以推遠年之冬至恆先天推近年之冬至恆後天

徽宗崇寧三年甲申歲十一月丙申冬至

大衍【丙申戌正二刻】宣明【丙申夜子初三刻】紀元【丙申巳初初刻】統天【丙申辰正三刻】重修大明【丙申巳初初刻】授時【丙申辰正二刻】

此年平冬至丙申巳正一刻四分定冬至夘辰之間

光宗紹熈二年辛亥歲十一月壬申冬至

大衍【癸酉寅初初刻】宣明【癸酉夘正二刻】紀元【壬申未初三刻】統天【壬申午初一刻】重修大明【壬申未初三刻】授時【壬申午初一刻】

此年平冬至壬申午正初刻都臨安遲一刻午正一刻定冬至在己末

寧宗慶元三年丁巳歲十一月癸夘日南至

大衍【甲辰未正初刻】宣明【甲辰酉初三刻】紀元【甲辰子正三刻】統天【癸夘亥正一刻】重修大明【甲辰子正三刻】授時【癸夘亥正一刻】

此年平冬至癸夘亥正三刻八分臨安遲一刻夜子初初刻八分定冬至亥初三刻

寧宗嘉泰三年癸亥歲十一月甲戌日南至

大衍【丙子丑正一刻】宣明【丙子夘初初刻】紀元【乙亥午初三刻】統天【乙亥巳初初刻】重修大明【乙亥午初三刻】授時【乙亥巳初一刻】

今推此年平冬至乙亥巳初三刻臨安巳正初刻定冬至約減五刻有奇在辰正二刻當時推甲戌歷誤也

寧宗嘉定五年壬申歲十一月壬戌日南至

大衍【癸亥夘正初刻】宣明【癸亥巳初四刻】紀元【壬戌申正二刻】統天【壬戌未初二刻】重修大明【壬戌申正初刻】授時【壬戌未初二刻】

此年平冬至壬戌未正初刻四分臨安遲一刻未正一刻四分定冬至午正一刻

理宗紹定三年庚寅歲十一月丙申日南至

大衍【丁酉申初二刻】宣明【丁酉戌初二刻】紀元【丁酉丑初三刻】統天【丙申亥正一刻】重修大明【丁酉丑初三刻】授時【丙申亥正一刻】

此年平冬至丙申亥正二刻十一分臨安亥正三刻十一分定冬至亥正初刻

理宗淳祐十年庚戌歲十一月辛巳日南至

大衍【壬午未初初刻】宣明【壬午酉初初刻】紀元【辛巳亥正三刻】統天【辛巳酉正二刻】重修大明【辛巳亥正一刻】授時【辛巳酉正三刻】

此年平冬至辛巳酉正三刻十一分臨安戌初初刻十一分定冬至酉正二刻

元世祖至元十七年庚辰歲十一月己未夜半後六刻冬至

大衍【己未亥初初刻】宣明【庚申丑初一刻】紀元【己未夘初初刻】統天【己未丑初初刻】重修大明【己未夘正初刻】授時【己未丑初一刻】

今推此年平冬至五十五日一時一十八分四十六秒己未丑初一刻四分髙衝在冬至後四分有奇約減均十二秒加時約五分定冬至醜初一刻九分與當時郭太史測气應五十五日○六百分者宻合

梅先生云以上自魯僖公以來冬至日名共四十七並至元辛巳有刻爲四十八事授時法合者三十八不合者昭公己夘劉宋元嘉丙子大明辛丑陳太建壬辰丁酉隋開皇甲寅唐貞觀甲辰己酉宋景徳丁未嘉泰癸亥共十統天歷同

今按四十七事日名或有不合其間有歷誤有史誤今以實法攷之合者不約而符不合者亦灼然可見非歷誤推卽史誤紀𨿽去之千百年猶旦暮也此如以有法之度度短長有凖之權權輕重故物莫能遁若大衍諸歷歲餘或彊或弱如權度未定旣不可以稱量而統天之距差躔差授時之百年長一又於執秤執尺之時參以智巧之私實爲無理之法其不合者固不合其幸合者亦不知其實未嘗合也近年冬至時刻可定去之遠者不能細定刻分以小輪半徑古多今少難得確率耳若其大致固可上下參攷而知當不違天甚逺孟子曰苟求其故千歲之日至可坐而致恆歲實最卑行小輪差皆其故也後之治歷者精求諸此而已若諸家立法𨿽不可不知要之皆已陳之芻狗不可再用者也

元史云自春秋獻公以來凡二千一百六十餘年用六歷推算冬至凡四十九事大衍合者三十二不合者十七宣明合者二十六不合者二十三紀元合者三十五不合者十四統天合者三十八不合者十一大明合者三十四不合者十五授時合者三十九不合者十事按獻公十五年戊寅歲正月甲寅朔旦冬至授時得甲寅統天得乙夘後天一日至僖公五年正月辛亥朔旦冬至授時統天皆得辛亥與天合下至昭公二十年己夘歲正月己丑朔旦冬至授時統天皆得戊子並先一日若曲變其法以從之則獻公僖公皆不合矣以此知春秋所書昭公冬至乃日度失行之驗一也【永按獻公之年史有參差所推甲寅朔旦冬至乃劉歆三統歷以四分之法逆推非有實測紀之信史不足爲據若左氏傳二至則當時之歷誤乃欲曲法以求合合者一而違者一不悟其幸合者之非眞而以其不合者諉之於日度失行此大惑也】大衍攷古冬至謂劉宋元嘉十三年丙子歲十一月甲戌日南至大衍與皇極麟徳三歷皆得癸酉各先一日乃日度失行非三歷之差今以授時攷之亦得癸酉二也【永按今以法推正得甲戌日度何嘗失行】大明五年辛丑歲十一月乙酉冬至諸歷皆得甲申殆亦日度之差三也【永按此年冬至祖衝之攷之特詳正賴當年實測可驗髙衝之所在與兩心差之細數𨿽推算時刻未甚親亦可得其所以未親之由今以法宻算其爲乙酉甚確郭氏不悟統天之活法不足憑獻僖逺年之幸合未可據乃以祖氏當年實測指爲日度失行不亦惑乎】陳太建四年壬辰歲十一月丁夘景長大衍授時皆得丙寅是先一日太建九年丁酉歲十一月壬辰景長大衍授時皆得癸巳是後一日一失之先一失之後若合於壬辰則差於丁酉合於丁酉則差於壬辰亦日度失行之驗五也【永按壬辰歲不誤丁酉歲則史誤也】開皇十一年辛亥歲十一月丙午景長大衍統天授時皆得丙午與天合至開皇十四年甲寅歲十一月辛酉冬至而大衍統天授時皆得壬戌若合於辛亥則失於甲寅合於甲寅則失於辛亥其開皇十四年甲寅歲冬至亦日度失行六也【永按甲寅歲乃歷誤】唐貞觀十八年甲辰歲十一月乙酉景長諸歷皆得甲申貞觀二十三年己酉歲十一月辛亥景長諸歷皆得庚戌大衍歷議以永淳開元冬至推之知前二冬至乃史官依時歷以書必非候景所得所以不合今以授時攷之亦然八也【永按此二至若非歷誤卽史誤】自前宋以來測景驗气者凡十七事其景徳丁未歲戊辰日南至統天授時皆得丁卯是先一日嘉泰癸亥甲戌日南至統天授時皆得乙亥是後一日一失之先一失之後若曲變其數以從景徳則其餘十六事多後天從嘉泰則其餘十六事多先天亦日度失行之驗十也【永按此二至皆歷誤非日度失行】前十事皆授時所不合以此理推之非不合矣蓋類其同則知其中辧其異則知其變今於冬至略其日度失行及史官依時曆書之者凡十事則授時三十九事皆中【永按日爲七政之主萬化之宗必無失行之理其兩心差之有攺變亦必有恆率非失行也郭氏於十事中以八事爲日度失行其說原於僧一行亦近誣矣其三十九事自以爲中未必果皆中也中其日矣未必中其時刻除至元庚辰歲宻合天外推近歲之冬至時刻恆後天推逺歲之冬至時刻恆先天其故甚微非以權度細推其誰覺之】以前代諸歷校之授時爲宻庶幾千歲之日至可坐而致云【永按授時固宻而有未宻者存郭氏不能知也不謂人誤而曰天誤此非常之差謬載之史冊徒爲後人作笑資耳】

附測景餘論

【勿庵先生揆日星紀要論測景法甚詳尙有三事當論永爲補之】

一曰表端之景虛淡分釐難得眞數當仿郭太史用景符之法取表端橫梁中景爲的

郭氏用四丈長表頗不易制四方行測損其制度一丈亦可矣而表端爲太陽上邊之景𨿽以太陽半徑減之可得中景而猶患其虛淡難眞宜仿郭法長丈者只作九尺端爲兩岐【代二龍】以持橫梁合之長一丈以薄銅葉爲景符鉆小竅以達日光順其斜倚之勢遊移前卻於虛景之中取橫梁之景於圭面則所得者爲中景而分數亦眞

一曰太陽離天頂稍逺則地面與地心有南北差太陽恆降而下當檢气差表求太陽視緯髙弧加於本緯

一曰極髙多度之方冬至太陽近地平有靑气差能升太陽使髙景爲之稍短此气差難算宜以夏至之景參校【夏至近天頂無气而降下之南北差亦甚微】求黃赤北緯以知南緯【黃赤間緯度分古多今少】以本方冬至气差加於南緯以冬至景長推算髙弧可得气差○後二事景差之最微者試以元史証之

元史授時歷議云今京師長表【四丈】冬至之景七丈九尺八寸有奇夏至之景一丈一尺七寸有奇【寸下之分不著者每歲二至加時不等故也】

按京師觀象臺北極出地三十九度五十五分今所測定者也今時黃赤距緯二十三度半稍弱元時距緯則不止二十三度半姑以二十三度半計之加於極髙以減象限其餘二十六度三十五分爲冬至髙弧檢二十六度三十五分之餘切綫一九九八四一以四乘之【表四丈故】已有七丈九尺九寸有奇之景再加距緯之大與太陽南北差則景當更長而當時所測定者七丈九尺八寸有奇以余切求髙弧爲二十六度三十七分減太陽下二分以減赤道髙五十度五分若只二十三度三十分者豈非气升卑爲髙乎再以夏至攷之景長一丈一尺七寸有奇以四歸之二九三有奇則七十三度四十分之餘切以赤道髙弧五十度○五分減之北緯有二十三度三十五分豈非近天頂無气差而太陽降下之數又微故見其本緯之景乎○再以北緯二十三度三十五分減赤道髙爲髙弧二十六度三十分又約減太陽降下二分則冬至髙弧宜二十六度二十八分而景長之髙弧二十六度三十七分是气升太陽九分也郭太史時八綫之算法未備太陽南北差近地气差機竅未啟但能紀其表景尺寸不能詳其冬至二至所得黃赤距度有微差今則一一可攷而知

數學卷四

欽定四庫全書

數學卷五

婺源江永撰

七政衍

【勿庵先生論七政小輪之動由本天之動七政之動由小輪之動其說極當七政中月尢紛錯按歷象考成五星有三小輪而月更有次均輪不惟次均輪而已且更有負圏是月之小輪獨有五也今以七政各輪之左右旋與其帶動自動不動之異本先生之說一一衍之且爲繪圖諸輪了然在目而七政之髙下行度亦可知其梗槪矣】

太陽諸輪

日有本天有本輪有均輪○本天以地爲心隨宗動天左旋而稍緩故漸右移【本勿庵先生之說】○本天右移帶動本輪○本輪之心定於本天之上【亦本勿庵先生說】其樞左旋帶動均輪【本輪之頂爲最髙底爲最卑輪樞左旋視本天之右移者稍緩因生最髙最卑之行】○均輪之心定於本輪之上其樞右旋帶動日○日體定於均輪之上隨均輪而右旋均輪旋而日體之上下不變【別有說見後】

太陰諸輪

月有本天有本輪有均輪有負圏有次輪有次均輪○本天以地爲心隨宗動天左旋而最緩故右移甚速○本天右移帶動本輪○本輪之心定於本天之上其樞左旋帶動均輪【本輪之頂爲月孛其底爲入轉輪樞左旋視本天之右移者稍緩因生月孛之行】○均輪之心定於本輪之上其樞右旋帶動負圏【負圏所以負次輪其心在均輪上並均輪全徑與次輪半徑爲負圏半徑】○負圏之心定於均輪之上其樞不動隨均輪而右旋帶動次輪【若無負圏則次輪無爲帶動者矣】○次輪之心定於負圏之上隨負圏而出入於本輪【有時在本輪內有時出本輪外】其周恆與均輪相切【與五星次輪心在均輪上者異】其樞左旋【與土木火三星次輪右旋者異】帶動次均輪【月獨有○次均輪】次均輪之心定於次輪之上其樞不動隨次輪而左旋帶動月【歷法西傳謂月在次輪上右旋非也○他輪一左旋一右旋則其樞轉動惟負圏與均輪同爲右旋次均輪與次輪同爲左旋是其樞不轉動】○月體定於次均輪之上隨次輪與次均輪而左旋【月在次均輪其詳見後】輪旋而月體之上下不變【亦說見後】

土木火三星諸輪

土木火三星在日之上有本天有本輪有均輪有次輪有繞日圏○本天以地爲心隨宗動天左旋而差緩各以次第土最緩木次之火次之其右移皆遲【土約二十九年半一周木約十二年一周火約二年一周】○本天右移帶動本輪○本輪之心定於本天之上其樞左旋帶動均輪【本輪之頂爲最髙輪樞左旋視本天之右移者稍緩因生最髙之行】○均輪之心定於本輪之上其樞右旋帶動次輪【土木次輪與太陽本天等大惟火星次輪時時不同本輪髙而太陽又髙者最大本輪卑而太陽又卑者最小二者皆在髙卑之中則與太陽本天等大】○次輪之心定於均輪之上其樞右旋帶動星○星體各定在次輪之上隨次輪而右旋○次輪亦名歲輪星在歲輪周左旋聨其行迹遂成繞日圓圏【與各星本天等大火星圏時時不等】其度左旋【與次輪右旋之度相應】

金水二星諸輪

金水二星在日之下【論其本天則然因有歲輪與日天等大有時負星出於日上】亦有本天有本輪有次輪又有伏見輪○本天皆小在日天之內【本勿庵先生晚年之說舊說卽以太陽之天爲金水本天】以地爲心隨宗動天左旋而稍緩遂右移其右移速於上三星【金二百二十四日奇周天水八十八日周天亦本勿庵先生說舊說以周次輪爲周天】本天右移帶動本輪○本輪之心定於本天之上其樞左旋帶動均輪【本輪均輪皆在日天之下歷家以太陽天爲本天伏見輪爲次輪遂置本輪均輪於太陽天皆假設非本象○本輪之頂爲最髙輪樞左旋視本天之右移者稍緩因生最髙之行】○均輪之心定於本輪之上其樞右旋帶動次輪【次輪皆與日天等大】○次輪之心定於均輪之上其樞左旋帶動星○次輪亦曰歲輪【猶上三星之歳輪歷家以伏見輪爲次輪或曰歳輪勿庵先生非之詳見五星紀要愚爲發明詳見金水發微】星體各定在歲輪上隨之左旋【上三星在歲輪上右旋金水在歲輪上左旋皆向日也】○星在歲輪周左旋聨其行迹亦成繞日之輪爲伏見輪【與本天等大猶上三星之繞日圏】其度右旋【與歳輪左旋之度相應】

七政諸輪起防行度

七政本天平行皆起冬至防

太陽本輪起最卑防爲初宮初度順布十二宮最髙防爲六宮初度【因今時最卑防近冬至遂以此爲始】○太陽均輪起最近防【謂最近於本輪心卽均輪之頂在最髙時爲均輪之底】卽最卑最髙時日體所在其度恆以兩度當一度本輪左旋一度均輪右旋兩度本輪左旋一象限均輪右旋半周日在最逺之防【謂最逺於本輪心】本輪左旋半周均輪右旋一周復於最近防太陰本輪起最髙防爲初宮初度卽月孛所在【中法以孛對衝爲月入轉是起最卑西法起月孛】順布十二宮最卑防爲六宮初度【卽古法入轉】○太陰均輪起最近防【謂最近於本輪心最髙時爲輪底最卑時爲輪頂】卽最髙最卑時次輪最近防所到其度亦以兩度當一度本輪左旋半周均輪右旋一周○太陰次輪朔望起最近防【此最近防謂最近於均輪心】與均輪邊相切【他星次輪心在均輪周月次輪獨與均輪相切而輪心在負圈上】又爲次均輪心所到其度亦以兩度當一度本天右旋月離日一度則次輪左旋兩度【回歷謂之倍離度○左旋者左旋於負圈之上】次均輪心遂至其處兩左旋半周次均輪心在最逺【謂最逺於均輪心】此輪惟順布六宮朔至望一周望後復起初宮○太陰次均輪月體在其上從輪心出綫距地心【惟最髙最卑兩防無初均此綫正其餘皆是斜綫】作十字綫於輪面【距綫正則十字綫皆正距綫斜則十字綫皆斜】朔望時月體當綫上常在其下兩時月體當綫上常在其上朔與望間【初四初五十八十九】月體常在十字橫綫之左【東方】望與朔間【十一十二廿六廿七】月體常在十字橫綫之右【西方】亦一月而兩周○土木火三星本輪起最髙防爲初宮初度順布十二宮最卑防爲六宮初度○三星均輪起最近防【謂最近於本輪心】卽最髙最卑時次輪心所到其度亦以兩度當一度次輪心在其上本輪左旋半周均輪右旋一周○三星次輪星體在其上與太陽合伏時起輪之頂爲初宮初度逆布十二宮衝太陽時在輪之底爲六宮初度○三星繞日圏合伏在頂衝日在底與次輪同但順布十二宮歷家不用

金水二星本輪起最髙防順布十二宮與上三星同○金星均輪起最近防爲最髙最卑時歲輪心所到其度亦以兩度當一度歲輪心在其上與上三星同○水星均輪起最逺防【謂最逺於本輪心卽均輪之頂】爲最髙時歲輪心所到【最卑時歲輪心在最近防亦均輪之頂】其度以三度當一度歲輪心在其上本輪左旋四宮均輪右旋一周本輪一周均輪三周【七政均輪他皆起最近防倍引數惟水星均輪起最逺防三倍引數】○金星次輪本是歲輪星體在其上合伏時起輪之頂順布十二宮歷家不用○金水伏見輪本是歲輪上星行之迹所成歷家用之合伏時起輪之頂爲初宮初度逆布十二宮衝日在輪之底爲六宮初度

日月體上下有定

日在均輪上月在次均輪上𨿽隨輪轉【日右轉月左轉】而日月之本體上下有定蓋其底恆對地心也日之轉動與否不可見而月則有黑影【西人謂之月駁】恆定不易則日體亦常定可知五星當亦然

甲爲地心乙丙丁爲本天界戊己庚辛爲本輪壬癸爲均輪子爲日體在均輪上○庚爲最卑【亦曰髙衝】戊爲最髙此設均輪在最卑【初宮】則日體在子若到三宮【辛防】則日體當丑到最髙【六宮】則日體在卯到九宮【已防】則日體當寅﹤子部﹐天文算法類﹐推步之屬﹐數學﹐卷五﹥甲爲地心乙丙丁爲本天界寅戌申酉爲本輪壬子癸丑爲均輪癸未辰午爲次輪亥夘爲次均輪戊庚己辛爲負圈○寅爲最髙【卽月孛】申爲最卑此設均輪心在最髙【初宮】則次輪與均輪相切於癸又設當朔望時癸卽次均輪心所到而月體在夘若均輪到三宮【戌防】則次輪與均輪相切於心均輪在最卑【六宮】則次輪與均輪相切於角均輪到九宮【酉防】則次輪與均輪相切於房丙至氐初均減度之最大丙至亢初均加度之最大者也若均輪到三宮又當兩時則月體在斗視度在牛均輪到九宮又當兩時則月體在尾視度在箕亢至箕氐至牛二三均加減度之大者也【月有諸輪行度最多變態後分十二宮圖之】○本天大於本輪半徑約十七倍有奇

月本輪初宮圖

次均輪行於次輪不能徧圖每一圖以四爲率上次均輪朔望時○右次均輪朔望間下次均輪上下時○左次均輪望朔間

子斗丑爲本天界丙寅辰夘爲未輪輪心在斗設當輪最髙【丙防】爲初宮初度則均輪【庚牛丁女】心在丙而負圈【辛癸甲壬】之心在庚次輪【丁牛未申】丁防與均輪相切如其正當朔望也則次均輪【戊乙】心在次輪均輪相切之處【丁】而月體在乙【次均輪之底】此時無加減度從丙乙斗辰巳綫直下至地心【綫長不能圖只圖其上截後仿此】爲次輪最近防距地心綫減去次均輪半徑【丁乙】爲月距地心綫○如其行至朔望之間【初四初五十八十九】則次均輪【角酉】心到午午奎亥爲輪心距地心綫奎斗其減度【次均】月體在酉酉壁戌爲距綫奎壁其加度【三均】壁斗則減定度也○如其行至上下則次均輪【房心】心到未月體在房與朔望距地心綫合爲一【惟乙房爲月體相距之差】亦無加減度○如其行至望朔之間【十一十二廿六廿七】則次均輪【亢氐】心到申申危箕爲輪心距地心綫危斗其加度【次均】月體在氐氐室尾爲距綫危室其減度【三均】室斗則加定度也○凡諸直綫皆下至地心

本輪心在本天甲房爲最髙設本輪行一宮則均輪心到未【房未三十度】負圈心在申【從房至申六十度】次輪與均輪相切於丁【求丁防之法先作甲乙丙勾股形以正比例求得乙丙三因之卽丁防所在丙丁弧六十度倍於庚未丙丁其通】丁酉寅爲次輪最近防距地心綫酉甲其減度【初均】朔望次均輪心在丁月體在癸丁癸酉寅與初均距綫合爲一故朔望無次均加減【後仿此】朔望間次均輪心在己巳戌午爲距綫酉戌其減度【次均】月體在庚庚亥辰爲距綫亥戌其加度【三均】亥酉爲二三均減度亥甲減定度也上下次均輪心在辛角辛巳爲距綫角酉其減度【次均】月體在壬壬辛巳距綫與次均同故上下卽以次均爲三均【後仿此】角甲減定度也望朔間次均輪心在戊氐戊醜爲距綫氐酉其加度【次均】月體在子亢子夘爲距綫亢氐爲減度【三均】亢酉爲二三均減度亢甲減定度也

本輪心在本天甲亢爲最髙設本輪行二宮則均輪心到辛【亢壬辛六十度】負圈心在角【從尾至角一百二十度】次輪與均輸相切於丁【求丁防作甲乙丙勾股形以正比例求得乙丙三因之爲乙丙丁弧一百二十度倍於亢辛丙丁其通】丁亥夘爲次輪最近防距地心綫亥甲其減度【初均】朔望次均輪心在丁月體在癸無次均朔望間次均輪心在戊戊丑未爲距綫丑亥其減度【次均】月體在子子氐辰爲距綫氐醜其加度【三均】氐亥爲二三均減度氐甲爲減定度上下次均輪心在巳巳酉申爲距綫酉亥其減度【次均】月體在房同次均酉申減定度也望朔間次均輪心在庚戌庚心爲距綫戌亥其減度【次均】月體在寅午寅巳爲距綫午戌其減度【三均】午亥二三均減度午甲減定度

本輪心在本天甲未爲最髙設本輪行三宮均輪心到丙【未氐丙九十度】負圈心在乙【從丁歷氐至乙一百八十度】次輪與均輪相切於丁【甲乙丙丁爲直綫無勾股甲乙亦三倍於甲乙乙心丁弧一百八十度倍於未丙乙丁爲均輪全徑】丁亢丑爲距綫亢甲其減度【初均】朔望次均輪心在丁月體在辛無次均朔望間次均輪心在戊戊酉夘爲距綫酉亢其減度【次均】月體在壬壬申寅爲距綫申酉其加度【三均】申亢爲二三均減度申甲減定度也上下次均輪心在己巳戌午爲距綫戌亢其減度【次均】月體在癸同次均戌甲減定度也望朔間次均輪心在庚亥庚辰爲距綫亥亢其減度【次均】月體在子角子巳爲距綫角亥其減度【三均】角亢爲二三均減度角甲減定度也

本輪心在本天甲癸爲最髙設本輪行四宮均輪心到子【癸房子一百二十度】負圈心在辛【從壬歷丁丙至辛二百四十度】次輪與均輪相切於丁【求丁防作甲乙丙勾股形以正比例求得乙丙三因之爲乙丁丙辛壬丁弧二百四十度倍於癸房子丙丁其通】丑丁寅爲次輪最近防距地心綫上至本天醜醜甲其減度【初均】朔望次均輪心在丁月體在心無次均朔望間次均輪心在戊戊夘辰爲距綫夘醜其減度【次均】月體在己巳午未爲距綫午夘其加度【三均】午丑爲二三均加度午甲減定度也上下次均輪心在己巳申酉爲距綫申丑其減度【次均】月體在尾同次均申甲減定度也望朔間次均輪心在庚庚亥爲距綫戌丑其減度【次均】月體在角亢角氐爲距綫亢戌其減度【三均】亢醜二三均減度亢甲減定度也

本輪心在本天甲子爲最髙設本輪行五宮均輪心到壬【子尾壬一百五十度】負圈心在辛【從癸歷丁丙至辛三百度】次輪與均輪相切於丁【求丁防作甲乙丙勾股形求得乙丙三因之爲乙丁丙辛癸丁弧三百度倍於子尾壬丙丁其通】丁申爲次輪最近防距地心綫上至本天午午甲其減度【初均】朔望次均輪心在丁月體在未無次均朔望間次均輪心在戊戊丑寅爲距綫丑午其加度【次均】月體在夘夘辰巳爲距綫辰丑其加度【三均】午辰爲二三均加度辰甲減定度也上下次均輪心到己巳酉戌爲距綫酉午其減度【次均】月體在亥同次均酉甲減定度也望朔次均輪心到庚角庚亢爲距綫角午其減度【次均】月體在氐房氐心爲距綫房角其減度【三均】房午二三均減度房甲減定度也

本輪心在本天甲乙爲最髙設本輪行六宮均輪心到丙【乙亥丙一百八十度】負圈心在辛【從辛歷角丁亢至辛一周】次輪均輪相切於丁【均輪心在最卑無勾股形從丁歷亢辛角至丁一周倍於乙亥丙】丁辛癸爲次輪最近防距地心綫上至本天甲爲一直綫無初均加減度朔望次均輪心在丁月體在壬同一直綫亦無次均度朔望間次均輪心在戊子戊丑爲距綫子甲其加度【次均】月體在寅夘寅辰爲距綫夘子其加度【三均】夘甲二三均加度卽加定度也上下次均輪在巳月體在午與朔望同一直綫亦無次均望朔間次均輪心在庚未庚申爲距綫未甲其減度【次均】月體在酉子酉戌爲距綫子未其減度子甲二三均減度卽減定度也

本輪心在本天甲辛爲最髙設本輪行七宮均輪心到子【辛丑子二百一十度】負圈心在壬【從癸右旋一周復至壬六十度】次輪與均輪相切於丁【作甲乙丙勾股形求得乙丙三因之爲乙丁從丙右旋一周復至丁六十度丙丁其通】丁夘寅爲次輪最近防距地心綫上至本天午午甲其加度【初均】朔望次均輪心在丁月體在夘無次均朔望間次均輪心在戊辰戊巳爲距綫辰午其加度【次均】月體在未申未酉爲距綫申辰其加度【三均】申午二三均加度申甲加定度也上下次均輪心到巳巳亥角爲距綫亥午其加度【次均】月體在戌同次均亥甲加定度也望朔間次均輪心到庚庚亢氐爲距綫亢午其減度【次均】月體在房房心尾爲距綫心亢其減度【三均】心午二三均減度心甲加定度也

本輪心在本天甲辛爲最髙設本輪行八宮均輪心到癸【辛壬癸百四十度】負圈心在子【從丑右旋一周復至子一百二十度】次輪與均輪相切於丁【作甲乙丙勾股形求得乙丙三因之爲乙丁從丙右旋一周復至丁一百二十度丙丁其通】丁寅辰爲次輪最近防距地心綫上至本天夘夘甲其加度【初均】朔望次均輪心在丁月體在寅無次均朔望間次均輪心到戊午戊未爲距綫午夘其加度【次均】月體在申酉申戌爲距綫酉子其加度【三均】酉夘二三均加度酉甲加定度也上下次均輪心到巳巳亥亢爲距綫亥夘其加度【次均】月體在角同次均亥甲加定度也望朔間次均輪心到庚庚房心爲距綫房夘其加度【次均】月體在氐氐斗尾爲距綫斗房其減度【三均】斗夘二三均減度斗甲加定度也

本輪心在本天甲壬爲最髙設本輪行九宮均輪心到丙【壬辛丙二百七十度】負圈心在乙【從丁右旋一周復至乙一百八十度】次輪與均輪相切於丁【甲乙丙丁爲直綫無勾股甲丁亦三倍於甲乙乙右旋一周復至丁一百八十度乙丁其通】丁子丑爲次輪最近防距地心綫子甲其加度【初度】朔望次均輪心在丁月體在癸無次均朔望間次均輪心在戊亢戊辰爲距綫亢子其加度【次均】月體在寅午寅未爲距綫午亢其加度【三均】午子二三均加度午甲加定度也上下次均輪心到己巳申酉爲距綫申子其加度【次均】月體在房同次均申甲加定度也望朔間次均輪心到庚庚夘氐爲距綫夘子其加度【次均】月體在戌戌角亥爲距綫角夘其減度【三均】角子二三均加度角甲加定度也

本輪心在本天甲辛爲最髙設本輪行十宮均輪心到癸【辛壬癸三百度】負圈心在丑【從子右旋一周復至醜二百四十度】次輪與均輪相切於丁【作甲乙丙勾股形求得乙丙三因之爲乙丁從丙右旋一周復至丁二百四十度丙丁其通】丁夘辰爲次輪最近防距地心綫夘甲其加度【初均】朔望次均輪心在丁月體在寅無次均朔望間次均輪心到戊午戊未爲距綫午夘其加度【次均】月體在申酉申戌爲距綫酉午其加度【三均】酉夘二三均加度酉甲加定度也上下次均輪心到巳角巳氐爲距綫角夘其加度【次均】月體在亢同次均角甲加定度也望朔間次均輪心到庚庚心房爲距綫心夘其加度【次均】月體在尾尾斗箕爲距綫斗心其減度【三均】斗夘二三均加度斗甲加定度也

本輪心在本天甲氐爲最髙設本輪行十一宮均輪心到尾【氐房心尾三百三十度】負圈心在斗【從箕右旋一周復至斗三百度】次輪與均輪相切於丁【作甲乙丙勾股形求得乙丙三因之爲乙丁從丙右旋一周復至丁三百度丙丁其通】丁壬癸爲次輪最近防距地心綫壬甲其加度【初均】朔望次均輪心在丁月體在辛無次均朔望間次均輪心到戊申戊酉爲距綫申壬其減度【次均】月體在子戌子丑爲距綫戌申其加度【三均】戌壬二三均加度戌甲加定度也上下次均輪心到己夘己寅爲距綫夘壬其加度【次均】月體在辰同次均夘甲加定度也朔望間次均輪心到庚庚午未爲距綫午壬其加度【次均】月體在亥亥亢角爲距綫亢午其減度【三均】亢壬二三均加度亢甲加定度也

甲爲地心乙丙丁爲太陽本天諸星次輪半徑與之等戊己庚爲火星本天辛壬癸子爲火星次輪辛合伏癸衝日輪之下割入太陽本天

丑寅夘爲木星本天辰巳午未爲本星次輪辰合伏午衝日

申酉戌爲土星本天亥角亢氐爲土星次輪亥合伏亢衝日

諸星皆有本輪均輪而次輪髙下時時不同此設次輪心在平處圖其大槪後分圖以見之

甲爲地心乙丙丁爲太陽本天壬子癸爲土星本天戊巳庚辛爲本輪午未爲均輪丑夘寅辰爲次輪○戊爲最髙庚爲最卑設均輪在最髙【初宮】則次輪心在未如合伏星在丑衝日星在寅次輪三宮星在夘九宮星在辰○均輪心在最卑【六宮】則次輪衝日時星在申○均輪到三宮【巳防】而次輪又爲九宮則星到酉本天上在戌黃道上視之在氐氐丙其減度○均輪到九宮【辛防】而次輪又爲三宮則星到亥本天上在角黃道上視之在亢亢丙其加度

甲爲地心乙丙丁爲太陽本天壬癸子爲木星本天戊巳庚辛爲本輪亢氐爲均輪丑夘寅辰爲次輪○戊爲最髙庚爲最卑設均輪在最髙【初宮】則次輪心在氐如合伏星在丑衝日星在寅次輪三宮星在辛九宮星在巳○均輪心在最卑【六宮】則次輪衝日時星在酉○均輪到三宮【巳防】而次輪又爲九宮則星到巳本天上在未黃道上視之在戌戌丙其減度○均輪到九宮【辛防】而次輪又爲三宮則星到午本天上在申黃道上視之在亥亥丙其加度

甲爲地心乙丙丁爲太陽本天戊己庚爲火星本天壬子癸丑爲本輪夘午爲均輪寅辰申未爲次輪○壬爲最髙癸爲最卑設均輪在最髙【初宮】則次輪心在午如合伏星在寅衝日星在申次輪三宮星在辰九宮星在未○均輪星在最卑【六宮】則次輪衝日時星在寅○次輪近太陽天畱際加減度大均輪到三宮【子防】而次輪又爲畱順之際星至酉本天在戌黃道上視之在亥亥丙其減度均輪到九宮【醜防】而次輪又爲畱退之際星至角本天上在亢黃道上視之在氐氐丙其加度○房心爲次輪割入太陽天處○火星次輪半徑時時不等此圖其大小之中者○五星皆以太陽爲心如磁石之引鍼但土木金水以太陽本輪之心爲心而火星獨以太陽實體爲心次輪𨿽與日天等大而半徑時時不同算法置本星於最卑兼太陽髙卑算之得數加於最卑之數卽次輪半徑之數所以然者何也火與日同類故其精相攝也

﹤子部﹐天文算法類﹐推步之屬﹐數學﹐卷五﹥

甲爲地心乙戊己辛爲太陽本天【卽黃道歷家用伏見輪借爲金星本天】庚子癸壬爲星本天寅酉夘未爲歲輪亢爲本輪角爲均輪最髙時歲輪心在均輪之底合伏星在寅退合星在申兩畱際星當黃道之亥戌○本輪均輪設於本天嵗輪心在其上本象也星在歲輪周成繞日圓象爲寅辰申午伏見輪亦設本輪【丙】均輪【丁】於其上最髙時伏見輪心在均輪之底星行伏見輪與歲輪不殊【詳金水發微】

甲爲地心乙夘丑寅爲太陽本天【歷家借爲水星本天】戊癸庚辛爲星本天午己子辰爲歲輪己爲本輪壬爲均輪最髙時歲輪心在均輪之頂合伏星在午退合星在未兩畱際星當黃道之戌亥○星在歲輪周成繞日圓象爲【午申酉未】伏見輪亦設本輪【丙】均輪【丁】於其上最髙時伏見輪心在均輪之頂星行伏見輪與歳輪不殊【詳見金水發微】

數學卷五

欽定四庫全書

數學卷六

婺源江永撰

金水微

【勿庵先生五星紀要前數章論金水左旋右旋猶仍曆書之說以伏見輪同嵗輪後因門人劉允恭悟得金水自有歲輪而伏見輪乃其繞日圓象因詳爲之說發前人所未發永初見此說頗疑之卽楊學山記卷末一條亦疑而不敢質再三思之繪圖試之果見伏見輪之繞日實由歲輪上星行軌迹所成而二星本天皆在日天之下歷家以太陽之天爲金水天以伏見輪當次輪皆見其末而未及其本也此說悟於劉而勿庵先生發明之使五星髙下遲速之原歸於一貫卽此一事已大有功於天學然非多作圖像詳爲之說觀者終難了然是以特爲此卷以發先生之覆並可釋學山之疑】

勿庵先生曰問五星之法至西曆而詳明然其舊說五星各一重天大小相函而皆以地爲心其新說五星天𨿽亦大小相函而以日爲心若是其不同何也曰無不同也西人九重天之說第一重宗動天次則恆星天又次土星次木星次火星次太陽次金次水次太陰是皆以其行度之遲速而知其距地有逺近因以知其天周有大小理之可信者也星之天有大小旣皆以距地之逺近而知則皆以地心爲心矣是故土木火三星距地心甚逺故其天皆大於太陽之天而包於外金水二星距地心漸近故其天皆小於太陽之天而在其內爲太陽天所包是其本天皆以地爲心無可疑者惟是五星之行各有歲輪歲輪亦圓象五星各以其本天載歲輪歲輪心行於本天之周星之體則行於歲輪之周以成遲疾畱逆若以歲輪上星行之度聨之亦成圓象而以太陽爲心西洋新說謂五星皆以日爲心蓋以此耳然此圍日圈象原是歲輪周行度所成而歲輪之心又行於本天之周本天原以地爲心三者相待而成原非兩法故曰無不同也【上三星在歲輪上右旋金水在歲輪上左旋皆挨度平行】○夫圍日圏象旣爲歲輪周星行之迹則遲畱逆伏之度兩輪皆有之故以歲輪立算可以得其遲畱逆伏之度以圍日圓輪立算所得不殊立法者溯本窮源用法者從簡便算如曆書上三星用歲輪金水二星用伏見輪皆可以求次均立算𨿽殊其歸一也或者不察遂謂五星之天眞以日爲星失其指矣○歷指又嘗言火星天獨以日爲心不與四星同余甞斷其非是作圖以推明地谷立法之根原以地爲本天之心其說甚明其金水二星歷指之說多淆亦久疑其非今得門人劉允恭悟得金水二星之有歳輪其理的確而不可易可謂發前人之未發矣○問金水二星之求次均也用伏見輪歷指謂其卽歲輪其說非與曰非也伏見輪之法起於回歷而歐邏因之若果卽歲輪何爲別立此名乎由今以觀蓋卽歲輪上星行繞日之圓象耳【王寅旭書亦云伏見輪非歳輪】○然則伏見輪旣爲圍日之迹上三星宜皆有之何以不用而獨用之金水曰以其便用也蓋五星行於歲輪起合伏終合伏皆從距日而生故五星之歲輪並與日天同大而歲輪之心原在本天周故其圍日象又並與本天同大上三星之本天包太陽外其大無倫又其行皆左旋【所以左旋之故詳具後論】頗費解說故只用歲輪也至於金水本天在太陽天內伏見輪旣與之同大又其度順行故用伏見輪【亦卽繞日圓象】若用歲輪則金水之歳輪反大於本天【以歳輪與日天同大故皆大於本天】故不用歲輪非無歲輪也承用者未能深考立法之根輒謂伏見輪卽歲輪其說似是而非不可不知也伏見亦起合伏終合伏有似歲輪然歲輪之心行於本天之周而伏見輪以太陽爲心故遂以太陽之平行爲平行皆相因而誤者也○然則金水旣非以太陽之平行爲平行又何以求其平行曰歳輪之心行於本天是爲平行乃實度也實度者周度也【以本天分三百六十度而以各星周率平分之則得其每日平行如土星二十九年奇而行本天一周則二十九日而行一度每日平行十九分度之一是爲最遲木星十二年周天每日平行約爲十二分度之一火星二年周天約爲每日平行半度金星二百二十餘日周天約每日平行一度半彊水星八十八日弱而周天約每日平行四度皆平行實度】若歲輪及伏見輪𨿽亦各分三百六十度亦各有其平行然而非實度也【此非本天上平行之度又非從地心實測之平行度】乃各星之離度耳因此離度【下文詳之】用三角法從地心測之則得其遲畱伏逆之狀亦爲實度矣【此實度不平行與本天之平行實度不同】○本天之度平行實度也歲輪及伏見乃離度也離度爲虛數故皆以半徑之大小爲大小○伏見輪上行度與歲輪同所不同者半徑也伏見之半徑皆同本天歲輪之半徑皆同日天○問何以謂之離度曰於星平行內減去太陽之平行故曰離度乃離日之度也以太陰譬之其每日平行十三度奇者太陰平行實度每日十二度奇者太陰之離度也【於太陽平行內減太陽平行】是故金星每日行大半度奇水星每日約行三度皆於星平行內減太陽之平行○因金水行速其離度在太陽之前乃星離於日之度故其度右旋順行與太陰同法也○若上三星則當於太陽平行內減去星行是爲離度蓋以上三星行遲在太陽之後乃星不及於日之度其度左旋而成逆行與太陰相反然其爲離日之行度一而已矣【王寅旭五星行度解謂上三星左旋蓋謂此也然竟以此爲本天終非了義】○平行者對實行而言也然實行有二一是本天最髙卑之行亦曰實行一是黃道上遲畱逆伏實測亦曰視行是二者皆必以本天之平行爲宗○若金水獨以太陽之平行爲平行是廢本天之平行矣又何以求最髙卑乎○圍日之輪【卽伏見輪】起合伏終合伏是卽古法之合率也本天之行卽古法之周率也最髙卑卽古法之歷率也又有正交中交以定緯度卽如古法之太陰交率也【此一法是西法勝中法之一大端】是數者皆必以本天取之故不得以圍日之輪爲本天○歷指言金星正交定於最髙前十六度水星正交與最髙同度其所指皆本天之度非伏見行之度則伏見輪不得爲本天明矣○今以七政歷徴之不惟最髙卑之盈縮有定度卽其交南北亦有定度故金星恆以二百二十餘日而南北之交一終水星則八十八日奇而交終此皆論本天實度原不論伏見行是尢其較著者矣

永按七政皆有本天本天皆有平行之實度月與五星皆有次輪而五星次輪亦曰歲輪皆因離日逺近而生離度月之離度起合朔終合朔五星離度起合伏終合伏土木火三星在日之上其本天大其右行之度遲則於太陽平行度內減其星之行度是爲歲輪上離度合伏至衝日半輪星西而日東衝日至合伏半輪星東而日西金水二星在日之下其本天小其右行之度速則於本天平行度內減太陽平行度爲歲輪上離度合伏至衝日星東而日西衝日至合伏星西而日東金水本天𨿽小而歲輪亦如上三星與日天等大星在歲輪上半周則歲輪負星出日上至下半周乃在日天下其繞日之圓象實由歲輪上星行軌迹所成與上三星成繞日大圓者同理而歷家別名爲伏見輪但於伏見輪上離度算其距日實行則與歲輪所得不殊又卽以太陽之平行爲二星之平行皆徑捷之權法而承用者遂以伏見當歲輪以日天爲二星本天且置本輪均輪於日天上而二星之本天與歲輪皆隱得勿庵先生發其蘊本象始明終疑金星二百二十四日奇周天水星八十八日周天何以能終古附日也乃多作圖以顯其象

此設金星合伏時在歲輪之頂以爲起算之端因及歲輪心行一象限也甲爲地心亦爲金星本天與黃道之心乙丁己戊爲黃道午酉未申爲本天庚辛心壬爲歲輪庚辰寅夘爲伏見輪歲輪心午在本天周乙爲太陽庚爲星合伏時星在日上從甲望之同在一直綫此星在歲輪上本象也若設伏見輪繞日乙爲輪心卽太陽其合伏之防庚卽歲輪之頂星在歲輪頂卽在伏見輪頂也若向後五十六日有奇歲輪心行一象限【此姑以輪心行言之實因本天右旋故帶動歲輪也又本天上更有本輪本輪上有均輪歲輪心在均輪上其差者微此姑勿論後仿此】至酉爲辰子丑癸輪則太陽自乙行至丙【五十五度奇】而星在歲輪上自癸行至亥【三十四度奇癸卽前之合伏防庚】其繞日之伏見輪【戌亥氐亢】心至丙其周與歲輪交於亥【亥爲星所到】房至亥【房爲合伏防】猶癸至亥也【同度】

此又五十六日奇並前爲一百十二日奇歲輪又行一象限心至未也【凡行象限】二太陽自乙至辰一百十度奇星自心至子六十九度奇若自伏見輪上觀之輪心在辰其周與歲輪交於子子卽星所到也丑至子猶心至子也【丑與心皆合伏防】黃道上角至辰卽星離日次均度也

此圖有二行其一己庚辛壬歲輪心行至戊則太陽在丙星在癸而伏見輪【夘巳寅癸輪】亦交於癸其一子丑午未歲輪心行至乙則太陽在丁星在申而伏見輪【申亢酉氐輪】亦交於申○又五十六日奇並前爲一百六十八日半彊歲輪又行一象限心至戊【並前三象限】太陽自房心至丙一百六十六度彊星自庚歷辛至癸【庚卽第一圖合伏庚防】一百○三度太彊伏見輪自辰至癸亦如之【辰亦合伏防】○又五十六日奇並前二百二十四日半彊歲輪又行一象限心至乙【並前一周】太陽自房心至丁二百二十一度半弱星自子丑至申一百三十八度半彊伏見輪自戌氐至申亦如之【子戌皆合伏防】

金星行嵗

輪圖四

此圖亦有二行其一癸寅丑子歲輪心行至丙則太陽在夘星在申而伏見輪【酉申戌亥輪】亦交於申其一亢心氐房歲輪心行至丁則太陽在午星在未而伏見輪【尾箕未斗輪】亦交於未○又五十六日奇並前爲二百八十一日弱歲輪又行一象限心至丙【並前一周外又一象限】太陽自辛庚至夘二百七十六度太彊星自子歷癸至申【子卽第一圖合伏庚防】○又五十六日奇並前爲三百三十七日彊歲輪又行一象限心至丁【並前一周外又二象限】太陽自辛庚至午三百三十二度彊星自氐歷房亢至未二百○七度太彊【氐卽第一圖合伏庚防】伏見輪自牛歷尾箕至未亦如之【牛亦合伏防】

此又五十六日奇並前爲三百九十三日彊歲輪【癸丑子寅】又行一象限【並前一周外又三象限】心至戊太陽行一周又自已至未二十七度半星自丑子寅至酉二百四十二度半弱【醜卽第一圖合伏庚防】伏見輪自申辰午至酉亦如之【申亦合伏防】

此圖有二行其一戊壬癸庚次輪心行至丙則太陽在房星在酉而伏見輪【酉巳亥未輪】亦交於酉其一辛斗亢牛歲輪心行至午則太陽在心星在辰而伏見輪【夘辰寅氐輪】亦交於辰○又五十六日奇並前爲四百四十九日少彊歲輪又行一象限心至丙【並前二周】太陽行一周又自丁至房八十二度太彊星自戊歷壬癸至酉【戊卽第一圖合伏庚防】二百七十七度彊伏見輪自申歷巳亥未至酉亦如之【申亦合伏防】又五十六日奇並前爲五百○五日半彊歲輪又行一象限心至午【並前二周又一象限】太陽行一周又自丁房至心一百三十八度彊星自己歷辛斗亢至辰三百一十一度半彊【己卽第一圖合伏庚防】伏見輪自午歷寅氐夘至辰亦如之【午亦合伏防】

此圖亦有二行其一子牛壬癸歲輪心行至丙則太陽在心星在戌而伏見輪【申酉戌亥輪】亦交於戌其一寅辰鬥角歲輪心行至女則太陽在丑星在午而伏見輪【夘未巳午輪】亦交於午○又五十六日奇並前爲五百六十一日太弱嵗輪又行一象限心至丙【並前二周有半】太陽行一周又自丁歷戊庚至心一百九十三度半彊星自壬歷癸子牛至戌三百四十六度彊【壬卽第一圖合伏庚防】伏見輪自亢歷亥申酉至戌亦如之【亢亦合伏防】○又五十六日奇並前爲六百一十七日太彊歲輪又行一象限心至女【並前二周又三象限】太陽行一周又自丁戊庚至醜二百四十九度稍彊星自辰左旋一周至午二十一度稍弱【辰卽第一圖合伏庚防】伏見輪自房右旋一周至午亦如之【房亦合伏防】

此設水星合伏時在歲輪之頂因及歲輪心行一象限也甲爲地心丙申未午爲黃道乙丁己辛爲本天戊亥尾亢爲歲輪戊己子癸爲伏見輪歲輪心乙在本天周丙爲太陽戊爲星合伏時星在日上從甲視之同一直綫此星在歲輪上本象若設伏見輪繞日丙爲輪心卽太陽其合伏之防戊卽歲輪之頂星在歲輪頂卽在伏見輪頂也【本天上更有本輪均輪歲輪心在均輪上其差皆微此勿論後仿此】○設合伏后二十二日弱歲輪行一象限【己角戌酉輪】心至丁則太陽自丙行至庚二十一度太弱星自酉至壬【酉卽合伏戊防】六十八度少彊自丑牛夘丙伏見輪上觀之則自斗至壬亦六十八度少彊也【斗亦合伏防】

此圖有二行其一己子丁己歲輪心行至乙則太陽在酉星在房而伏見輪【未戌房申輪】亦交於房其一午癸丑夘歲輪心行至辛則太陽在亥星在心而伏見輪【尾角鬥心輪】亦交於心○又二十二日弱並前爲四十四日弱歲輪又行一象限心至乙【並前二象限】太陽自庚至酉四十三度少彊星自丁歷巳至房【丁卽第一圖合伏戊防】一百三十六度半彊伏見輪自氐歷戌至房亦如之○又二十二日弱並前六十六日弱歲輪又行一象限心至辛【並前三象限】太陽自庚至亥六十五度彊星自癸歷丑夘至心二百○五度弱【癸卽第一圖合伏戊防】伏見輪自亢歷角鬥至心亦如之【亢亦合伏防】

此圖有三行其一戊寅庚夘歲輪心行至乙則太陽在午星在酉而伏見輪【酉栁女尾輪】亦交於酉其一辰子己房歲輪心行至氐則太陽在未星在戌而伏見輪【鬥牛虛戌輪】亦交於戌其一丙亢壬角歲輪心行至巳則太陽在申星在亥而伏見輪【井室亥危輪】亦交於亥○又二十二日弱並前爲八十八日弱歲輪又行一象限心至乙【並前一周】太陽自丁行至午八十六度太弱星自戊歷寅庚夘至酉【戊卽第一圖合伏戊防】二百七十三度少彊伏見輪自心歷栁女尾至酉亦如之【心亦合伏防】又二十二日弱並前爲一百一十日弱歲輪又行一象限心至氐【並前一周又一象限】太陽自丁行至未一百○八度少彊星自房歷辰子巳至戌【房卽第一圖合伏戊防】三百四十一度半彊伏見輪自壁歷虛牛斗至戌亦如之【壁亦合伏防】○又二十二日弱並前爲一百三十二日弱歲輪又行一象限心至巳【並前一周半】太陽自丁至甲一百二十日彊星自壬左旋一周又五十度弱至亥【壬卽第一圖合伏戊防】伏見輪自奎右旋一周復至亥亦如之【奎亦合伏防】

錫山楊學山作枚曰【書五星紀要後】西法步五星土木火有歲輪金水有伏見輪𨿽兩輪行度求角之法皆同然歲輪上爲星離日之虛度輪心在本天伏見輪則有自行度輪心卽太陽細按曆書之說蓋謂上三星本天包太陽天外星離日而又與日有定距是生歲輪其半徑恆與太陽天等若金水之本天卽太陽天其平行與太陽同距等亦與太陽等【俱一千一百四十二地半徑】而此伏見一輪以日爲心繞日環轉而爲伏見使非此輪則星無所爲伏見【以平行同太陽故也】故名伏見輪其輪之半徑皆有定度【金星七千二百奇水星三千八百奇】是其意原非以伏見輪當歲輪若果卽爲歲輪則半徑宜有大小何則火星因與太陽天近尙有日躔本天二差以變次均角豈金水在太陽天下而反無之今測不然是伏見輪另爲一種行動爲金水之所獨故昔人別立伏見輪之名也其所云卽歲輪者蓋因行法相同而混言之耳今勿庵之說又異是謂五星皆同一法皆有歲輪上三星因本天大故用歲輪金水因歲輪大難用故用繞日圓象【卽伏見輪如上三星圍日之圏】如此可明金水自有本天因得自有髙卑亦自有平行度因在日天下速於太陽本天斜倚黃道因有正交中交之名諸根底俱有著落且五星一貫但依此立算凡星平行自行之根數初均次均之度分南緯北緯之大小皆與曆書數迥異驗之於天未識合否余嘗疑歷指論五星緯說多混淆金水尢略因作五星緯行解一卷明之勿庵之說不敢遽定其是非存之以待參攷焉

永按學山先生謂勿庵之說不敢遽定其是非今繪圖試之歲輪上星所到與伏見輪上星所到一一相符則勿庵先生之說信矣然諸圖皆設歳輪心於本天未設本輪均輪愚初猶疑本輪均輪設於本天未必能符伏見輪上所算之數也旣而擬法算之【算例見後】𨿽平行自行初均次均與伏見算大異而以後均加減歲輪行則與伏見所算之實行不約而同於是前疑盡釋而算例亦可立矣若南緯北緯之大小勿庵先生已詳言之謂本天上歲輪心所行之周半在黃道北半在黃道南其勢斜立星體行伏見輪周其勢亦斜立與之相應故其交角等夫交角旣等則歲輪上之緯與伏見輪之緯亦必等豈兩輪事事相符而緯行一事獨違異者況星之緯南緯北實由歲輪心所到乎【輪心到正交中交則無緯度】楊先生亦可無疑於此也永別有餘論具於左

凡星體皆載於歲輪上歲輪之心在均輪均輪之心在本輪本輪之心在本天其大遲速在本天之行其小盈縮在本輪均輪之轉五星皆同

歳輪由星爲太陽所攝而生歲輪隨本天旋轉聨其行迹自成繞日之輪其輪各與本天等大若主太陽言之似星本繞日因星在繞日輪上旋轉而成與太陽本天等大之歲輪【西士謂五星皆以日爲心】若主本天言之則繞日輪生於歲輪勿庵先生始謂上三星之繞日爲虛迹非實像後又謂金水伏見輪亦如圍日之圓象實爲歳輪周行度所成然則本天與歲輪猶表也繞日圏伏見輪猶景也

置本輪均輪於金水歲輪上與伏見輪上所算之黃道度不殊然則上三星亦可置本輪均輪於繞日圏上立算此天能之巧妙若上三星用歲輪金水用伏見輪則步算之權宜也各星本輪均輪止一耳何以隨人兩置之而皆可由其本同故也其所以然者不出三角之理後有圖明之

歷家於金水何以不用歲輪立算伏見顯而歳輪隱也然則歷家旣便於伏見立算矣必不用歳輪之隱而曲勿庵先生之說亦可置勿論乎曰不然疇人之所便用者法也儒家所講求者理也有勿庵之說而後知二星亦有本天有歲輪與上三星一貫因其本天在日天下故其左旋者漸遲右旋者漸速下至太陰上至恆星髙下遲速各以其等而西人始言天有重數之說得此益明故愚以爲甚有功也否則但以二星之行與日等其本天與日天混而爲一烏覩所謂九重者乎

梅先生恐人謂歲輪實有堅硬之物則有人持珠竿行於浮屠梯磴之諭門人劉著亦有風中放鳶之諭皆謂員周爲虛設二諭皆妙永又思之使其只有一本天一歲輪則謂因相距之半徑隨天旋繞而成員象可也而本天之上有本輪本輪之上有均輪均輪之上乃有歲輪至太陰則小輪尢多諸輪又各有其左旋右轉隨動自動起防行度之異又火星之次輪時時不等水星之均輪一周三周一若實有諸輪相聨相貫相推相蕩又且多其變態者則在天𨿽無輪之形質而有輪之神理𨿽謂之實有焉可也學山謂火星因與太陽天近故有日躔本天二差以變次均角愚始亦疑其然後細攷之此說未確使火星之次輪半徑由近日天而致差則木星天距火星未甚逺豈得無些小之差土星天𨿽去日天甚逺而本輪比諸星獨大亦豈得無微細之差歷家積之久𨿽有小差必能立法以追其變使土木次輪亦如火星之例豈不依火星距日日差之法爲活動之算以窮其變今攷之不然則次輪半徑有二差惟火星則然金水𨿽最近日次輪半徑有定尢可互證伏見輪𨿽曰以太陽爲心其實亦非眞以太陽之形體爲心也乃是太陽本輪之心爲之心耳故算次均角不因太陽之盈縮髙卑而攺變惟算合伏與退合兩日以太陽實行定其實合伏實退合之時刻以此例之土木二星繞日圏其眞心亦是太陽本輪心非太陽之形體也惟火星不然耳

梅先生云歲輪大小又因於太陽髙卑伏見輪旣以日爲心則太陽行最髙時伏見輪從之亦髙而星去地逺太陽行最卑則伏見輪從之卑而去地近永思之金水近日使伏見半徑果因太陽髙卑而有攺變則太陽行至三宮九宮平視兩行差不啻兩度伏見輪半徑亦當大兩度歷家有不覺者乎知其所謂心者爲太陽本輪心非太陽形體則此疑冰釋矣○梅先生又謂太陽有髙卑則黃道半徑有大小星亦能變緯度論視緯當兼用兩種髙卑立算永謂算視緯必用星距地心綫定其逺近此綫卽黃道上星距太陽本輪心之界綫也算次均角卽此綫所界之度求次均不因太陽髙卑而變則此綫亦不因太陽髙卑而攺疑其無緯差

五星紀要詳於金略於水永考水星與金星不同者有二事其一則均輪也他星均輪最髙時起最近防右旋而倍引數獨水星均輪最髙時起最逺防右旋三倍引數【引數一度均輪三度】其一則交角也金星交角三度二十九分惟一耳水星交角則時時不同伏見輪心在大距與黃道交角五度四十分伏見輪心在正交當黃道北則減南則加伏見輪心在中交當黃道北則加南則減其加減各有與大距交角相較之數以距交實行逐度算其交角加減交角而得實交角此二事蓋相因其理極精微

又按曆書水星前後緯表南北之向與金星相反初不知其何故及考之歷象考成求金水正交行置最髙平行金星則減十六度水星則加減六宮得正交平行乃知水星正交與最卑同度而舊法謂與最髙同度是以正交爲中中交爲正故南北與金星相反當易其正中之名乃與諸曜一例

金水算例

從伏見輪立算二星皆以太陽之平行爲平行輪上繞日之行爲伏見平行求初均於本星平行內減最髙行爲引數金星用直角形水星用三角形【歷數考成之法】求得均角以加減本星之平行爲初實行【初宮至五宮爲減六宮至十一宮爲加】又反用加減號以加減伏見平行爲伏見實行【加星行則減伏見行減星行則加伏見行】求次均先求伏見輪心距地心綫【求得初均角卽用割綫比例求之】以此綫與伏見輪半徑爲兩邊以伏見實行爲所夾之外角【過半周者與全周相減用其餘】用切綫分外角法求半較角以減半外角余爲次均角以加減初實行【伏見輪初宮至五宮爲加六宮至十一宮爲減】爲黃道上實行

右法歷家所用者也若用歲輪算法如後【永所推】

從歲輪立算二星皆以行度【卽本星平行與太陽同】離度【卽伏見平行】並之爲歲輪之平行置本輪均輪於各本天【與伏見法置於太陽本天者異】於歲輪平行內減最髙行爲引數亦用直角【金星】三角【水星】形法求均角以加減本星之行度爲初實行又反用加減以加減本星之離度爲定離度於定離度內求次均亦先求得歲輪心距地心綫爲一邊【此邊小】以歲輪半徑爲一邊【此邊大】定離度爲所夾之外角【過半周者伏見輪之半徑小次均爲對小邊之角故以半較角減半外角爲對邊之小角歲輪半徑大次均爲對大邊之角故以半較角加半外角爲對邊之大角】以次均加減歲輪平行【初宮至五宮爲減六宮至十一宮爲加】爲黃道上實行與伏見輪所算實行同

算理

金水本天與太陽本天髙下不同其本輪均輪一置於伏見輪心一置於歲輪心各依本法算之所得之初均次均數亦迥不同而求黃道實行兩者若合符節此必有所以然之理作圖明之

甲爲地心丙爲太陽乙

爲金星辰午丁弧爲本

天戊丙巳弧爲黃道子

辛丑弧爲歲輪壬乙癸

弧爲伏見輪丁爲嵗輪

心丙爲伏見輪心此設

太陽自戊行至丙而嵗

輪心自辰行至丁則星

體必在乙乙防爲歲輪與伏見輪相交之處也歲輪子乙弧與黃道戊丙弧同度亦卽與伏見輪壬庚弧同度皆星本行之度與太陽行度等者也歲輪乙辛弧與黃道丙己弧同度亦卽與伏見輪庚乙弧同度皆爲星離合伏之度歷家所謂伏見行者也【歲輪左旋自辛至乙爲離度伏見右旋自庚至乙爲離度】夫辛乙與庚乙同度黃道上爲丙夘巳之度而人從甲望乙見黃道上星在夘則夘丙爲星距太陽之視度其角爲夘甲丙角亦卽庚甲乙角若從伏見立算當算庚甲乙角得丙夘加戊丙得戊夘爲黃道上實行度若從歲輪立算則輪上辛乙從黃道上視之爲巳夘其角爲己甲夘亦卽辛甲乙當算辛甲乙角得夘己以夘巳減戊巳亦得戊夘爲黃道上實行度○然則兩輪立算始異終同由辛乙與庚乙同度黃道上爲丙己中間有星距地心綫【乙甲】截丙巳於夘分爲兩甲角【一夘甲丙一夘甲己】算兩甲角一加一減則必無不合也○兩甲角成斜方形邊有四綫丙甲爲伏見輪心距地心綫乙丙爲伏見輪半徑丁甲爲歲輪心距地心綫乙丁爲歲輪半徑兩輪心所到各不同則斜方形亦不一皆此四綫之伸縮其極也四綫合爲一綫中綫如兩綫之長【合伏與退合時】○此圖未加本輪均輪則乙丙等丁甲乙丁等丙甲對邊皆平行本非天上實像姑以此明立算之本設本輪均輪之四綫圖如左

此圖乙丙乙丁如前丙甲與

乙丁丁甲與乙丙各微不等

對邊亦各不平行由丙丁二

輪心有本輪均輪各有髙卑

則丙甲丁甲二距地心綫有

攺變乙防爲心所在亦有移

動而黃道上丙夘丙巳兩視度亦有損益也而算兩甲角以求實行度必無不合○凖前圖論之丙甲丁甲二距綫若常如兩輪半徑則丙角與丁角同大【邊綫平行同對乙甲綫故也】丙甲乙角與丁乙甲角同大【同對半徑小邊】丙乙甲角與丁甲乙角同大【同對半徑大邊】如後圖丙甲丁甲二距綫旣變則兩形中無相等之角卽丙丁二甲亦變矣角變而丙己之弧度不變是以其終必合也○丙丁二角何以變也依前圖言之丙角之外角度爲伏見輪上庚乙丁角之外角度爲歲輪上辛乙庚乙與辛乙本同度也因兩輪上各有初均加減則度不同而庚丙乙與乙丁辛兩外角變矣外角變故內角必變也○丙己之弧度何以不變也凡初均數加星行者卽減伏見加伏見者卽減星行二者疊爲損益而總數不攺是以斜方形中但移其乙甲距綫而黃道上丙己之度爲戊丙之餘原與庚乙乙辛等者未嘗變是以次均算得夘巳減戊己猶之算得丙夘加戊丙也○由是觀之任丙甲丁甲二邊時時攺變乙甲綫時時移動而得黃道上戊夘之實度必無不同○乙甲丙角所對者乙丙小邊故以半較角減半外角爲甲角乙甲丁角所對者乙丁大邊故以半較角加半外角爲甲角自然之理也○兩輪算黃道實度旣同矣乙甲爲星距地心綫亦同乎曰此不待言也乙甲者丙角丁角同用之對邊也以角算度旣合矣邊焉得不合

右圖就金星輪圖之水星仿此

數學卷六﹤子部﹐天文算法類﹐推步之屬﹐數學﹥

欽定四庫全書

數學卷七

婺源江永撰

中西合法擬艸

【明李之攺憲也徐文定公嘗言鎔西人之精算入大統之型模固欲參合中西捨短取長以爲不刋之典正朔閏月之類從中不從西定气整度之類從西不從中然因用定气遂以每月交中气時刻爲太陽過宮時刻舉中法十二次之名系之而西法十二星象之宮亦時用之於表此則旣非中法復非西法𨿽相沿至今實可疑之端也余於辛亥年著歷法管見嘗論及此後讀勿庵先生歷學疑問補已暢言之固非余之私言又疑整度一事似未盡言中西當參酌者此亦其一端爰以此二事擬數表名曰中西合法擬艸仍以梅先生之說冠於卷首且附愚之鄙見焉】

歷學疑問補云問舊曆太陽過宮與中气不同今何以復合爲一曰新曆之測算精矣然其中不無可商當俟後來詳定者則此其一端也何則天上有十二宮宮各三十度每歳太陽以一中气一節气共行三十度【如冬至小寒共行三十度大寒立春又共行三十度其餘並同】滿二十四气則十二宮行一周故歷家恆言太陽一歳周天也

永按天上十二宮當分爲二有黃道上十二宮有列宿天十二宮黃道十二宮截黃道爲十二段冬至到丑春分到戌夏至到未秋分到辰恆系於節气者也列宿天十二宮主以四獸【蒼龍白虎朱鳥元武】分爲四維【東西南北】元枵在北鶉火在南大火在東大梁在西恆系於星宿者也新法之誤在去列宿十二宮専主黃道十二宮耳

然而實考其度則一歳日躔所行必稍有不足𨿽其所欠甚防【約其差不過百分度之一有半】積至年深遂差多度【六七十年差一度六七百年卽差十度】是爲歳差歷家所以有天周歳周之名【天上星辰勻分十二宮共三百六十度是爲天周每歳太陽十二中气共行三百六十度防弱是爲歳周】

永按黃道上十二宮亦三百六十度太陽一歳周徧未嘗稍有不足較之列宿天似防欠者非太陽之不能周天也恆星自移而東耳此則西人恆星行之說爲確中法分天周歳周未的也

漢人未知歳差誤合爲一故卽以冬至日交星紀而定之於牽牛

永按周未冬至已在南斗而漢人猶謂起牽牛者漢歷之疎也唐一行已嘗考定謂太初元年辛酉冬至日斗二十度而漢歷甲子冬至在斗二十四度其虛退之度適及牽牛之初云

逮晉虞喜等始覺之五代宋何承天祖衝之隋劉焯等言之益詳顧治歷者株守成說不敢輒用歳差也至唐初傅仁均造戊寅元歷始用歳差而朝論多不以爲然【亦如今人之不信西法人情狃於習見大抵皆然】故李淳風麟徳歷復去歳差不用直至元宗開元某年僧一行作大衍歷乃始博徵廣證以大暢厥防於是分天自爲天【卽周天十二次宮度其度終古不變】歳自爲歳【卽周歳十二中气日躔所行天度其度歳歳防移】歷代遵用【所定嵗差年數防有不同而大致無異】元世祖時用授時歷郭守敬測定六十六年有八月而差一度回回參西差法略同【今定爲七十年差一度數亦非逺】故冬至日一歳日躔之度已周尙不能復於星紀之元度必再行若干日時而至星紀【十二中气皆同一理】所以太陽過宮與中气必不同日其法原無錯誤其理亦甚易知徐李諸公深於曆術豈反不明斯事乃復合爲一眞不可解推原厥故蓋譯曆書時誤仍回回歷太陽年之十二月名耳○問回回歷亦知歳差何以誤用宮名爲月名曰回回歷旣以十二个月爲太陰年而用之紀歳不用閏月然如是則四時之寒燠溫涼錯亂無次因別立太陽年以周歳日躔勻分三百六十度又均分爲十二月以爲耕斂之節而起算春分是亦事勢之不得不然【堯典寅賔出日始於仲春卽此一事亦足微而歷之本於義和】但彼以春分爲太陽年之第一月第一日遂不得復用古人分至啟閉之法及春夏秋冬正名【古者以立春立夏立秋立冬春分秋分冬至夏至爲八節其四立並在四孟月之首以爲四時之節謂之啟閉二分二至並在四仲月之中居春夏秋冬各九十一日之半皆自然之序不可移易今回歷之太陽年旣以春分爲歳首則是以仲春之後半月爲正旦而割其前半个月以益孟春共四十五日有奇一並移之於歳終而孟春之前半攺爲十一月之後半孟春之後半合仲春之前半共三十日攺爲十二月卽春夏秋冬之四時及分至啟閉之八節孟仲季之月名無一與之相應名不正則言不順遂不復可得而用矣】故遂借白羊等十二宮以名其太陽年之月彼非不知天度有歳差白羊不能板定於春分然以其時春分正在白羊姑借此名之以紀月數【卽此而知回歷初起時其年代去今非逺】歐邏巴歷法因回歷而加精大致並同回歷故遂亦因之耳

永按勿庵先生謂誤仍回歷太陽年之十二月名固是一說愚則謂別有其故也觀恆星歷指圖星象一置北極南極於心分十二宮赤道爲正黃道爲斜一置黃極黃南極於心分十二宮黃道爲正赤道爲斜其宮界皆據當時中气所躔之度其意蓋曰太陽者眾曜之至也黃道者諸道之宗也一歳寒暑進退皆由太陽行黃道使然則黃道上自有一定之宮不惟月與五星逰歷其間𨿽普天星宿亦循黃道而行歷萬餘年赤道外二十三度之星且移至赤道內二十三度則安得不以黃道爲主星宿爲客乎若以列宿分宮太陽逰歷其間是列宿爲主太陽爲客矣且黃道十二宮二至則極南極北爲之界二分則交赤道爲之界若星宿則仰視茫茫無一定不可移之界中歷𨿽指虛六度爲子半而度則有整度日度之不齊鬥三度過醜女二度過子亦難定其宮界果當度之防分也是以遂置列宿之宮一以黃道之宮爲主恐譯書時意在於此若其以星紀元枵等爲宮名蓋以其名之古雅也用之以代丑子等字而不覺其將來名與實爽也

徐文定公譯曆書謂鎔西洋之精算入大統之型模則此處宜爲攺定使天自爲天歳自爲歳則歳差之理明而上星辰宮度各正其位矣【如晝夜平卽爲二分晝極長卽爲夏至不必問其日躔是何宮度是之謂歳自爲歳也必太陽行至降婁始命爲日躔降婁之次太陽行至鶉首始命爲日躔鶉首之次不必問其爲春分後防日夏至後防日是之謂天自爲天也】

永按勿庵先生之說極明白直防然使以此說告之當時譯書諸公猶恐不足以服其心蓋黃道上有十二宮不可沒也太陽恆星主客之分又似不可易也列宿天宮界防茫難辧又若未易定也所疑難者有此三端則反若中气過宮者爲順天以日隨星者爲違天矣愚請爲之條分而明辯之從來中歷皆以列宿天分宮不於黃道分宮是中歷之失也虛空中有一圏皆可分爲十二宮況黃道爲太陽所歷實有中气節气之分限又爲諸道之宗主可謂無十二宮乎且冬至到丑與子月合大寒到子與丑月合月左旋而宮右旋當宮之半兩支相合所謂地支六合者也【古人謂日躔斗建爲地支六合非也日躔有歳差斗柄有推移只是十一月自當爲子而冬至太陽到醜合之十二月自當爲丑而大寒太陽到子合之耳】是宜於冬至之日注曰某時某刻太陽入丑宮於大寒之日注曰某時某刻太陽入子宮諸中气皆如是言入以別於躔言宮以別於次直稱地支不混星紀等名則黃道之宮定而名稱亦當矣又越防日太陽躔斗三則注曰太陽躔星紀之次躔女三則注曰太陽躔元枵之次如是豈不別白分明乎若謂太陽恆星有主客之分亦未盡然論恆星之宗黃極循黃道則太陽爲主恆星爲客論七政之躔列宿則列宿又爲主七政爲客蓋黃道之宮虛而列宿之次實也七政之天在下而恆星之天在上也則亦互爲主客耳觀一歳七政歷不能虛紀宮度必以某宿某度記之則列宿豈不猶州縣而七政豈不猶人之行程乎分列宿之宮猶分天下之省直也若列宿天之宮界𨿽若難辧而中歷與西曆皆以虛六度爲子半當必有所傳蓋虛宿十度六度正當其半是虛危之間也以此爲正北而各宮之略皆可定矣

顧乃因仍回歷之宮名而以中气日卽爲交宮之日則歳周與天周復混而爲一於是歳差之理不明【如星紀之次常有定度而冬至之日度漸移是生歳差若冬至日卽躔星紀歳歳相同安得復有歳差】而天上十二次宮度名實俱亂【天上十二宮各有定星定度若隨節气移動則名實俱左後篇詳之】是故歷法至今日推步之法已極詳明而不無有待商酌以求盡善者此其一端也問者曰歷所難者推步耳若此等處攺之易易【但於各中气後查太陽實躔某宮之度卽過宮眞日】但曆書中所作之表多用白羊金牛等宮名以爲別識今欲通身攺換豈不甚難曰否否曆書諸表𨿽以白羊金牛等爲題而其中之進退消長並從節气起算今但將宮名攺爲節气卽諸表可用不必攺造有何難哉【如歷從白羊起者卽攺白羊初度爲春分初度表從磨羯起者卽攺磨羯初度爲冬至初度曆書諸表依舊可用但正其名不攺其數更無煩於推算】

永按如此攺之誠易然用之已百年而未議攺者蓋亦各持所見與

問天上十二宮亦人所名今隨中气而移亦何不可之有曰十二宮名𨿽人所爲然其來久矣今考宮名皆依天上星宿而定非漫設者如南方七宿爲朱鳥之象【史記天官書栁爲鳥注注卽咮咮者朱鳥之喙也七星頸爲員官頸朱鳥頸也員官喉嚨也張爲素素卽嗉鳥受食之處也翼爲羽翮朱鳥之翼】故名其宮曰鶉首鶉火鶉尾【鶉卽朱鳥乃鳳也】東方七宿爲蒼龍【天官書東方蒼龍房心心爲明堂今按角二星象角故一名龍角氐房心象龍身心卽其當心之處故心爲明堂尾宿卽龍之尾】故其宮曰壽星【封禪書武帝詔天下尊祀靈星正義靈星卽龍星也張晏曰龍星在角曰天田則農祥也見而祀之】曰大火【心爲大火】曰析木【一名析木之津以尾箕近天河也】北方七星爲元武【天官書北宮元武】其宮曰星紀【古以鬥牛爲列宿之首故星自此紀也】曰元枵【枵者虛也卽虛危也又象龜蛇爲元武也○永按左傳云元枵虛也枵耗名也】曰娵訾【一名娵訾之口以室壁二星各二星兩兩相對而形正方故象口也○永按娵訾似是古人之名氏如實沈之類蓋封於衛地者也此宮別名豕韋豕韋亦古諸侯封於其野者也】西方七宿爲白虎【天官書奎曰封豕參爲白虎三星直者是爲衡其外四星左右肩股也小三星隅置曰觜觽爲虎首】其宮曰降婁【以婁宿得名也】曰大梁【永按魚梁所以取魚宮有畢宿象以畢取魚也】曰實沈【永按宮有參宿左傳髙辛氏季子曰實沈後帝遷之大夏主參是也】由是以觀十二宮名皆依星象而取非漫設也堯典日中星鳥以其時春分昏刻朱鳥七宿正在南方午地也日永星火以其時夏至初昏大火宮正在午也【火卽心宿】宵中星虛以其時秋分昏中者元枵宮也卽虛危也日短星昴以其時冬至昏中者昴宿也卽大梁宮也歷家以歳差考之堯甲辰至今已四千餘歳歳差之度已及二宮【以西率七十年差一度約之凡差六十餘度】然而天上二十八捨之星宿未嘗變動故其十二宮亦終古不變也若夫二十四節气太陽躔度蓋依歳差之度而移則歳歳不同七十年卽差一度【亦據今西術推之】安得以十二中气卽過宮乎試以近事徵之元世祖至元十七年辛巳冬至度在箕十度至今康熈五十八年己亥冬至在箕三度其差蓋已將七度而卽以箕三度交星紀宮則是至元辛巳之冬至宿【箕十度】已攺爲星紀宮之七度再一二百年則今己亥之冬至宿【箕三度】爲星紀宮之初度者又卽爲星紀宮之第三度而尾宿且浸入星紀矣積而久之必將析木之宮【尾箕】盡變爲星紀大火之宮【氐房心】盡變爲析木而十二宮之星宿皆差一宮【凖上論之角亢必爲大火翼軫必爲壽星栁星張必爲鶉防井鬼必爲鶉火而觜參爲鶉首胃昴畢爲實沈奎婁爲大梁而娵訾爲降婁虛危爲娵訾鬥牛爲元枵二十八宿皆差一宮】卽十二宮之名與其宿一一相左又安用此名乎再積而久之至數千年後東宮蒼龍七宿悉變元武【歳差至九十度時角亢氐房心尾箕必盡變爲星紀元枵娵訾並仿此】南方朱鳥七宿反爲蒼龍西宮白虎七宿反爲朱鳥北宮元武七宿反爲白虎國家頒歷授時以欽若昊天而使天上宿度宮名顚倒錯亂如此其可以不亟爲釐定乎○又試以西術之十二宮言之夫西洋分黃道上星爲十二象𨿽與羲和之舊不同然亦皆依星象而名非漫設者如彼以積屍气爲巨蠏第一星蓋因鬼宿四星而中央白气有似蠏筐也所雲天蠍者則以尾宿九星捲而曲其末二星相並如蠍尾之有岐也所云人馬者謂其所圖星象類人騎馬上之形也其餘如寶瓶如雙魚如白羊如金牛如陰陽如師子如雙女如天秤以彼之星圖觀之皆依稀彷佛有相似之象故因象立名今若因節气而每歳移其宮度積而久之宮名與星象相離俱非其舊而名實盡淆矣○又按西法言歳差謂是黃道東行未嘗不是如今日鬼宿已全入大暑日躔之東在中法歳差則是大暑日躔退回鬼宿之西也在西法則是鬼宿隨黃道東行而行過大暑日躔之東其理原非有二尾宿之行入小雪日躔東亦然夫旣鬼宿已行過大暑東而猶以大暑日交鶉火之次則不得復爲巨蠏之星而變爲師子矣尾宿已行過小雪後而猶以小雪日交析木之次則尾宿不得爲天蠍而變爲人馬宮星矣卽詢之西來知歷之人有不啞然失笑者乎

永按此篇所論甚正昔著管見與此正同未能詳晰若斯也竊謂此事久逺後或有建議當攺者與其使後人議攺曷若早覺而攺之之爲愈乎

問西法以太陽防恆星爲歳謂之恆星年恆星旣隨黃道東行則其恆星年所分宮度亦必不能常與中气同日曆書何以不用曰恆星年卽其所頒齋日也其法以日躔斗四度爲正月朔故曰以太陽會恆星爲歳也其斗四度蓋卽其所定磨羯宮之初度也【在今時冬至後十二日】自此日躔行滿三十度卽爲第二月交寶瓶宮【餘月並同皆以日躔行滿三十度交一宮卽又爲一月而不論節气】然其十二月之日數各各不同者以黃道上有最髙卑差而日躔之行度有加減也【如磨羯宮日躔最卑宮行速故二十八日而行一宮卽成一月若巨蠏宮日躔最髙行遲故三十一日而行一宮始成一月其餘宮度各以其或近最卑或近最髙遲速之行不同故日數皆不拘三十日並以日躔交宮爲月不論節气】是則其所用各月之第一日卽太陽交宮之日原不與中气同日而且歳歳防差至六七十年恆星東行一度卽其各宮並東行一度而各月之初日在各中气後若干日者又增一日矣【如今以冬至後十二日爲歳首至歳差一度時必在冬至後十三日余盡然】此卽授時歷中气後防日交宮之法乃歳差之理本自分曉而曆書中不甚發揮斯事者亦有故焉一則以月之爲言本從太陰得名故必晦朔望而後謂之月今反以太陽所躔之宮度爲月而置朔望不用是名爲月而實非月大駭聼聞一也又其第一月旣非夏正孟春亦非周正仲冬又不用冬至日起算非歷學履端於始之義事體難行二也又其所用齋日卽彼國所頒行之正朔歐邏巴人私奉本國之正朔宜也中土之從其教者亦皆私奉歐邏之正朔謂國典何故遂隠而不宣三也【初造曆書事事關發以兾人之信從惟此齋日但每歳傳單伊教不筆於書】然曆書所引彼中之舊測每稱西月日者皆恆星年也其法並同齋日皆依恆星東行以日躔交磨羯宮爲歳旦而非與冬至中气同日也此尢爲太陽過宮非中气之一大證據矣

永按此論考西法尢核昔見袁氏歷法新書多本回回法度用整度如歐邏巴而列宿積度起寶瓶宮虛六度疑袁氏攙入中法未必彼國亦以虛六度爲子半今觀西曆以日躔斗四度爲正月朔爲齋日爲磨羯宮初度則虛六度爲寶瓶之正中西國實用之矣中西異而宮界同其由來不已久乎

或曰曆書所引舊例多在千餘年以前然則西月日之興所從來久矣曰殆非也唐始有九執歷元始有回回歷歐邏巴又從回歷加精必在回歷之後彼見回回歷之太陰年太陽年能變古法以矜奇創故復變此西月日立恆星年以勝之若其所引舊測蓋皆以新法追攺其月日耳

永按回歷之太陽年以春分爲歳首而列宿積度起寶瓶宮虛六度見於袁氏新書新書本於陳星川陳固傳回法者則斗四度爲磨羯宮初度回回與歐邏巴同且與中歷同矣曆書引舊測近者在明萬曆時逺者在漢順帝時梅先生謂以新法追攺其日月餘考曆書引萬曆年間彼國之月日似以斗十四度爲正月一日引漢順帝時則以斗四度爲正月一日蓋後來或攺憲而古法則無差至今日又復其舊矣【據康熈丁卯年傳單以中國十一月二十八日癸卯應西曆正月一日是日躔斗四度二十六分】使欲追攺月日何不畫一言之且彼國旣不如中國之正朔又不用回法之太陰年太陽年若非恆歳星之法將何以紀月日乎惟其言是日日躔鶉首宮防度大火宮防度之類乃是借中國次名言之且據戊辰攺歷之恆星行追書之耳【漢順帝時西國月一日太陽多在宮之七八度是用戊辰之宿鈐】

余又考磨羯宮初度若據斗初度數之當是三度而用四度爲正月一日者西法日首用午正故加一度又考西曆算太陽𨿽有加減而各月初一日所躔之度則不依加減之算蓋太陽行疾一宮只二十八日有奇行遲三十一日有奇則月小者二十九日月大者三十二日而西法不然月小者三十日月大者三十一日是以秋分以後月一日之宿度距中气漸加春分以後距中气漸減是亦其國舊俗使然略如中國知有定朔而猶用平朔【隋唐以前】知有定气而猶用恆气也【大衍授時】使其能攺月大小之法增減一日則月一日之宿皆其交宮之初度矣【梅先生前言日躔之行度有加減日數不拘三十日並以日躔交宮爲月者考之猶未詳耳】

再考梅先生辯太陽中气過宮之非者難詳而不言黃道上自有十二宮於理未盡後作圖明之

歲周圖一層虛中【卽河圖之五十洛書之五幹之戊巳】二層河圖三層洛書四層先天八卦五層後天八卦六層十二支七層二十四位八層四時

九層八節十層二十四气十一層七十二候十二層月建十三層黃道十二宮十四層黃道三百六十整度

此圖備載歲周之理應乎圖書卦位干支而布黃道宮度於外周黃道之宮與月建成六合恆以中气時刻入宮黃道之度皆虛度不系於列宿列宿度別載歲差圖又此順布節气故黃道宮隨之黃道本右旋當逆布見太陽中气交宮圖

太陽黃道上右旋故此

圖逆布十二月節气中

气外一層爲黃道十二

宮所謂中气交宮者交

此宮也𨿽恆星亦遊歷

其間不可借星次之名

以名其宮列宿別有十

二次

歲差圖圓外勻布三百六十整度分截二十八宿圓周第一層十二次名次內一層堯冬至日在虛又次內一層殷冬至日在女又次內一層周冬至

日在牛○又次內一層周末冬至日在斗【自周至宋末一千六百餘年皆在斗】又次內一層元冬至日在箕【至今皆在箕】○最內一層將來冬至日在尾

右圖自堯以來四千餘年之歳差星次有定而節气所在無定二萬五千餘年而一周誠不可以星次之名系之於每月之中气

中法謂之歳差西法則曰恆星行普天星宿皆循黃道東行約七十年有奇差一度【整度】然則黃道上節气有定而星宿無定若作一活動之盤置二十四气於外周爲定盤而以十二次二十八宿度列於活盤之上中心穿紙軸可轉動則肖星宿行度矣【如堯時則以虛四五度當冬至今時則以箕二三度當冬至】

星宿𨿽無定而距度多少與次捨分界則有定蓋列宿天有一定之東西南北動中之恆靜者也

附回回十二宮名

白羊【卽降婁】金牛【卽大梁】陰陽【又曰雙兄卽實沈】巨蠏【卽鶉首】師子【卽鶉火】雙女【卽鶉尾】天秤【卽壽星】天蠍【卽大火】人馬【卽析木】磨羯【卽星紀】寶瓶【卽元枵】雙魚【卽娵訾】

總說

合三圖觀之黃道自有十二宮列宿自有十二次若並爲一則名不當物而本有之十二次遂隱入宮與躔次分注之乃各當其實所當考求酌定者十二次分界之處耳

論整度日度

大統以前中歷皆用日度自攺用西法則以三百六十整度紀七政之行而列宿亦用整度此古今歷法不同一大節目梅先生極稱整度之善然則日度遂可廢與愚嘗思之天本無度因日之行而生度其不能以三百六十日周黃道必有奇零之日與分意其有不得不然者猶之徑一圍三隻得六角之邊而圍三之外有畸零是亦不得不然者也然則歳日之度豈不猶人身之穴自然而成不可增損者與西法以其不便於算也一以整度齊之齊之誠善矣然遂以此爲周天之本數疑其渉於假借竊謂此一事當合中西而用之一切布算之法用整度爲便及其分隸之於二十八宿以紀七政之躔離則當用日度爲宜譬之尺度古今有短長醫家量人孔穴必用同身寸度之始無誤整度者後世攺長之寸也日度者其人同身寸也或疑以整度布算又以日度紀躔離似多一畨布算曰始則假借後則紀實固不可憚其煩別立整度當日度及當日度分二表一查卽得亦不爲煩或又疑經度用日度緯度用整度同此一大圓豈可分両種度曰經度紀躔離用以紀歷者也緯度測極髙測両道相距測七政離地平以爲布算之凖不用之以紀歷故緯度可假借而經度不可假借也

整度當日度表說

歳周三百六十五日二四二一八七五如古法一日爲一度度有萬分是周天三百六十五度二千四百二十一分八十七秒五十防半周一百八十二度六千二百一十○分九十三秒七十五防一象限九十一度三千一百○五分四十六秒八十七防五十纎一宮三十○度四千三百六十八分四十八秒九十五防八十三纎不盡以三百六十整度分之一整度當日度一度○一百四十五分六十一秒六十三防一十九纎四四不盡又一整度六十分一分當日度分一百六十九分○九秒三十六防○五纎三二四六六不盡依此立二表使宿度分歸之於日度分【度下小數止於分分下有畸零及半者收之不及者棄之】

整度當日度表

整度

日度

整度

日度

一度

一度【○一四六】

二度

二度【○二九一】三度

三度【○四三七】

四度

四度【○五八二】五度

五度【○七二八】

六度

六度【○八七四】七度

七度【一○一九】

八度

八度【一一六五】九度

九度【一三一一】一十度一十度【一四五六】

【一十】一度【一十】一度【一六一○二十】二度【一十】二度【一七四七一十】三度【一十】三度【一八一九三十】四度【一十】四度【二○三九一十】五度【一十】五度【二一一八四十】六度【一十】六度【二三三○一十】七度【一十】七度【二四一七五十】八度【一十】八度【二六二一一十】九度【一十】九度【二七六七】二十度二十度【二九一二二十】一度【二十】一度【三○二五八十】二度【二十】二度【三二○四二十】五度【二十】五度【三六二四○十】六度【二十】六度【三七八六二十】七度【二十】七度【三九二三二十】八度【二十】八度【四○七七二十】九度【二十】九度【四二二三】三十度三十度【四三六八】

整度

日度

整度

日度

井宿有三十度畸故表止列三十度度下有零分查後表

整度分當日度分表

整度分

日度分

整度分

日度分一分

○千【一六九】

二分

○千【三三八】三分

○千【五○七】

四分

○千【六七六】五分

○千【八四五】

六分

一千【○一五】七分

一千【一八四】

八分

一千【三五三】九分

一千【五二二】一十分

一千【六九一】

【一十】一分

一千【八六一○

十】二分

二千【○二九一十】三分

二千【一九一八

十】四分

二千【三六七一十】五分

二千【五三一六

十】六分

二千【七○五一十】七分

二千【八七一四

十】八分

三千【○四三一十】九分

三千【二二】一二十分

三千【三八二二十】一分

三千【五五二一

十】二分

三千【七二○二十】三分

三千【八八二九

十】四分

四千【○五八二十】五分

四千【二二二七

十】六分

四千【三六九二十】七分

四千【五六二五

十】八分

四千【七三四二十】九分

四千【九○三】三十分

五千【○七三三十】一分

五千【二四三二

十】二分

五千【四一一三十】三分

五千【五八三○

十】四分

五千【七四九三十】五分

五千【九一三八

十】六分

六千【○八七三十】七分

六千【二五三六

十】八分

六千【四二五三十】九分

六千【五九四】四十分

六千【七四六四十】一分

六千【九三四三

十】二分

七千【一○二四十】三分

七千【二七四一

十】四分

七千【四四○四十】五分

七千【六○四九

十】六分

七千【七七八四十】七分

七千【九四四七

十】八分

八千【一一六四十】九分

八千【二五八】五十分

八千【四五五五十】一分

八千【六二五四

十】二分

八千【七九三五十】三分

八千【九六五二

十】四分

九千【一三一五十】五分

九千【三一五○

十】六分

九千【四六九五十】七分

九千【六三五八

十】八分

九千【八○七五十】九分

九千【九七六】六十分

一度○【一四六】整度分

日度分

整度分

日度分用表法先取宿若干度當日度若干度分次以宿度零分查日度若干分並之命爲日度分

表有兩用二十八宿黃道度悉歸諸日度一用也算得七政及羅防計都月孛躔某宿防度防分皆以日度歸之二用也

二十八宿整度變日度表

整度

分

日度

分

斗二十三度【四十七分】

二十四度【一二九六】

牛

七○度【四十六分】

七○度【八七九七】女一十一度【三十八分】

一十一度【八○二七】虛

九○度【五十九分】

一十○度【一二八七】危二十○度【○七分】

二十○度【四○九六】室一十五度【四十一分】

一十五度【九一一七】壁一十三度【○六分】

一十三度【二九○八】奎一十一度【三十九分】

一十一度【八一九六】

婁一十三度

一十三度【一八九三】胃一十二度【一十五分】

一十二度【四二八三】

昴

九○度【一十五分】

九○度【三八四七】畢一十三度【五十八分】

一十四度【一七○○】

參

一○度【二十一分】

一○度【三六九七】觜一十一度【三十三分】

一十一度【七一八二】井三十○度【二十五分】

三十○度【八五九五】

鬼

四○度【三十二分】

四○度【五九九三】栁一十七度【○四分】

一十七度【三一五一】

星

八○度【二十三分】

八○度【五○五四】張一十八度【○四分】

一十八度【三二九七】

翼一十七度

一十七度【二四七五】軫一十三度【○三分】

一十三度【二四○○】角一十○度【三十七分】

一十○度【七七一二】亢一十○度【三十八分】

一十○度【七八八一】氐一十七度【五十○分】

一十八度【○九三○】

房

四○度【五十○分】

四○度【九○三七】

心

七○度【三十三分】

七○度【六五九九】尾一十五度【五十六分】

一十六度【一六五三】

箕

九○度

九○度【一三一一】

整度

分

日度

分

右黃道二十八宿度分以歷象考成康熈甲子年黃道經度鈐定【前後有異同詳見考異】因整度分變爲日度分【與授時大統異者詳見考異】

擬分列宿天十二次界限

列宿之天分十二次其界當有定度自西法行恆以太陽交中气爲宮界則度隨歳差推移而十二次之本界遂隱勿庵先生嘗極論之愚考中法與回歷皆以虛六度爲子半意者虛宿有十度【九度五十九分僅少一分】六度正當虛危之間【有初度則六度是五度從一度卽是六度】是爲四維之正北元枵之最中乎又考西曆毎歳以日躔斗四度爲齋日【從一度起是四度有初度則是三度】蓋以磨羯【丑宮卽星紀】之首爲恆星年正月一日也斗四度爲磨羯之初則虛六度不爲寶瓶【子宮卽元枵】之中乎中西不約而符意其由來已久今擬虛六度之初【六度者第六度也】置於子半如羅金之定盤鍼因以求各宮之界謹按歷象考成康熈甲子年之黃道經度鈐虛宿入一宮十九度一分加五度爲子半當一宮二十四度一分減十五度爲丑初當一宮九度一分皆以此年交宮後九度一分爲各宮之界推得十二次之交界宿度又以整度分變爲日度分列表如左

整度分

日度分

星紀【醜】斗三度一十一分入斗三度【二三】

元枵【子】女一度三十八分入女一度【六六】

娵訾【亥】危十度一

分入危十度【一六】

降婁【戌】壁四度一十三分入壁四度【二八】

大梁【酉】婁九度二十八分入婁九度【六○】

實沈【申】畢四度五十八分入畢五度【○四】

鶉首【未】井八度六

分入井八度【二二】

鶉火【午】栁三度九

分入栁三度【二○】

鶉尾【巳】張七度四十二分入張七度【八二】

壽星【辰】軫二度三十八分入軫二度【六七】

大火【卯】亢八度五十八分入亢九度【一○】

析木【寅】心五度四十○分入心五度【七五】

右所定十二次之界未知果符天否存其梗槪竢後來考定又中歷宮界與此不能盡合宿度多寡不同一也此以黃道度分宮而中歷以赤道度勻分黃道度各宮多寡不均二也

附勿庵先生說【答滄州劉介錫茂才】

以星推命不知始於何時然呂才之辟祿命只及干支及韓潮州始有我生之時月宿南斗之說由是徵之亦在九執以後耳毎見推五星者率用溪口歷則於七政躔度疎逺若依新法則宮度之遷攺不常二者已如柄鑿之不相入又安望其術之能驗乎夫欲求至當則宜有變通然其故多端實難輕議或始以古法分宮而取今算之七政布之則旣不違其本術亦不謬乎懸象𨿽未知驗否何如而於理庶防可通矣

按此說似有理然以古法分宮尙有防細之處先生亦只言其大略耳【界則有度度則有分授時大統之宮界旣不可用於今而西國所定毎月初一日之宿度又似非一宮三十度者】

宿度考異【黃道度】

虛九度五十九分

【崇禎戊辰測○康熈壬子同○康熈戊辰同歷象考成康熈甲子宿鈐同】

危二十度○七分

【崇禎戊辰測○康熈壬子同○康熈戊辰同康熈甲子宿鈐同】

室一十五度四十一分

【崇禎戊辰測○康熈壬子同○康熈戊辰同康熈甲子宿鈐同】

壁一十三度一十六分

【崇禎戊辰測○康熈壬子同○康熈戊辰同康熈甲子宿鈐一十三度六分○減十分】

奎一十一度二十九分

【崇禎戊辰測○康熈壬子同○康熈戊辰同康熈甲子宿鈐一十一度三十九分○加十分○蓋減壁以益奎】

婁一十三度

【崇禎戊辰測○康熈壬子同○康熈戉辰同康熈甲子宿鈐同】

胃一十三度○一分

【崇禎戊辰測○康熈壬子同○康熈戊辰同康熈甲子宿鈐一十二度一十五分○減四十六分】

昴八度二十九分

【崇禎戊辰測○康熈壬子同○康熈戊辰同康熈甲子宿鈐九度一十五分○加四十六分○蓋減胃以益昴】

畢一十三度五十八分

【崇禎戊辰測○康熈壬子同○康熈戊辰同康熈甲子宿鈐同】

參一度二十一分

【崇禎戊辰測○康熈壬子同○康熈戊辰同康熈甲子宿鈐同】

觜一十一度三十三分

【崇禎戊辰測○康熈壬子同○康熈戊辰同康熈甲子宿鈐同】

井三十度二十四分

【崇禎戊辰測○康熈壬子三十度二十五分注云新測三十度二十四分○康熈戊辰三十度二十四分○康熈甲子宿鈐三十度二十五分】

鬼四度三十七分

【崇禎戊辰測○康熈壬子五度三十分注云新測四度三十七分○康熈戊辰四度三十七分○康熈甲子宿鈐四度三十二分】

柳一十七度

【崇禎戊辰測○康熈壬子十六度○六分注云新測十七度○康熈戊辰十七度○康熈甲子宿鈐一十七度○四分○蓋井加一分鬼減五分栁加四分互有損益】

星八度二十三分

【崇禎戊辰測○康熈壬子同○康熈戊辰同康熈甲子宿鈐同】

張一十八度○四分

【崇禎戊辰測○康熈壬子同○康熈戊辰同康熈甲子宿鈐同】

翼一十七度

【崇禎戊辰測○康熈壬子同○康熈戊辰同康熈甲子宿鈐同】

軫一十三度○三分

【崇禎戊辰測○康熈壬子同○康熈戊辰同康熈甲子宿鈐同】

角一十度三十五分

【崇禎戊辰測○康熈壬子同○康熈戊辰同康熈甲子宿鈐一十度三十七分○加二分】

亢一十度四十分

【崇禎戊辰測○康熈壬子同○康熈戊辰同康熈甲子宿鈐一十度三十八分○減二分○蓋損角益亢】

氐一十七度五十四分

【崇禎戊辰測○康熈壬子同○康熈戊辰同康熈甲子宿鈐一十七度五十分○減四分】

房四度四十六分

【崇禎戊辰測○康熈壬子同○康熈戊辰同康熈甲子宿鈐四度五十分○加四分○蓋損氐益房】

心七度三十三分

【崇禎戊辰測○康熈壬子同○康熈戊辰同康熈甲子宿鈐同】

尾一十五度三十六分

【崇禎戊辰測○康熈壬子同○康熈戊辰同康熈甲子宿鈐一十五度五十六分○加二十分】

箕九度二十分

【崇禎戊辰測○康熈壬子同○康熈戊辰同康熈甲子宿鈐九度減二十分○蓋益尾損箕】

斗二十三度五十一分

【崇禎戊辰測○康熈壬子同○康熈戊辰同康熈甲子宿鈐二十三度四十七分○減四分】

牛七度四十一分

【崇禎戊辰測○康熈壬子同○康熈戊辰四十分康熈甲子宿鈐七度四十六分○加五分】

女一十一度三十九分

【崇禎戊辰測○康熈壬子同○康熈戊辰同康熈甲子宿鈐一十一度三十八分○減一分○蓋斗牛女三宿互有損益】

右黃道宿度據崇禎曆書戊辰宿鈐算其度分靈臺儀象志康熈壬子宿鈐多同又康熈戊辰亦同而歷象考成以康熈甲子爲元其宿度分小有損益意者後有密測較精於前與康熈戊辰在甲子後宿度多同前者蓋據舊測逐年如其歳差之秒而宿度不攺歷象考成成於康熈之季年刻於雍正三年蓋以後測追溯甲子歷元宿鈐當如此是以與戊辰稍異也損益之少者數分其多者胃昴四十六分尾箕二十分愚疑尾箕二宿最近地平有防气差意者前測未精差二十分或由此若胃昴距地髙當無气差而攺測差四十六分豈胃宿攺距星與【差一分者蓋因歳差秒數有棄有收】

再考觜參二宿乾隆十七年十一月大臣議攺仍依古法觜前參後參宿中三星昔以西一星爲距今攺東一星爲距則觜前參後矣但二宿之度未有考○考授時歷黃道宿度與今黃道宿度同異【今宿度以整度變日度】

箕【授時九度五九今九度一三】

斗【授時二十三度四七今二十四度一三】牛【授時六度九○今七度八八】

女【授時一十一度一二今一十一度八○】虛【授時九度○○太○今一十五度九一】危【授時一十五度九四今二十度四一○】室【授時一十八度三三今一十五度九一】壁【授時九度三四○今一十三度二九】

奎【授時一十七度八七今一十一度八二】婁【授時一十二度三六今一十三度一九】胃【授時一十五度八一今一十二度四三】昴【授時一十一度○八今九度三八○】畢【授時一十六度五○今一十四度一七】觜【授時觜在參前○度○五○今觜在參後一十一度七二】參【授時參在觜後九度二八今參在觜前一度三七】井【授時三十一度○三今三十度八六】

鬼【授時二度一一今四度六○】

栁【授時一十三度○今一十七度三二】星【授時六度三一○今八度五○五四】

張【授時一十七度七九今一十八度三三】翼【授時二十度○九今一十七度二三】

軫【授時一十八度七五今一十三度二四】角【授時一十二度八七今一十度七七○】

亢【授時九度五六○今一十度七九】氐【授時一十六度四○今一十八度○九】

房【授時五度四八今四度九○】

心【授時六度○七今七度六六】

尾【授時一十七度九五今一十六度一七】黃道宿度多寡古歷多不同授時以簡儀密測宿度余分可考然以較之今時黃道宿度無一宿同者其故實多端據西士之說恆星循黃道東行赤道經緯度歳歳不同而黃道之宿則有定距本當以黃道度爲主用弧三角法算毎歳赤道之經緯而郭氏法以赤道度爲主由赤道度變黃道度其不同者一也黃赤本可相求而郭氏以弧矢割員之術求黃赤道之差與弧三角算不能宻合其不同者二也古今所用列宿距星不能畫一其不同者三也觜參二宿易其前後其不同者四也宿近地平常有气掩映之差須考求其眞度前人未見及此其不同者五也有此五端宜其無一宿同當據今所測算者爲正其觜參二宿則今仍攺爲觜前參後也

數學卷七

欽定四庫全書

數學卷八

婺源江永撰

算賸

【勿庵先生論算極詳觀玩之餘有得輒筆之此爲賸義云爾】

正弧三角防通

弧三角以正者爲宗舉要第二卷

論正弧其法散出有見於求余角法者有見於第四卷

次形法者又有現於塹堵測量環中黍尺二書者今爲薈萃總計求角求邊凡若干正法別法附之臚列分明學者庶易防焉

甲爲正角乙酉春分角丙爲交角乙

甲猶赤道乙丙猶黃道丙甲猶距緯

正弧隨處有之不止黃赤道而以黃

赤爲諭諸法皆以甲乙丙爲鈐記

求丙甲邊法

半徑與乙角正若乙丙正與丙甲正【中二率相乘爲實首率爲法除實得四率】

半徑與乙角正切若乙甲正與丙甲正切

丙角正切與半徑若乙甲正切與丙甲正

若欲用半徑爲首率以省除則爲半徑與丙角余切若乙甲正切與丙甲正

半徑與丙角余若乙丙正切與丙甲正切

又法丙角余與半徑若乙丙余切與丙甲余切

乙甲余與半徑若乙丙余與丙甲余

若欲用半徑爲首率以省除則爲半徑與乙甲正割若乙丙余與丙甲余

又法半徑與乙甲余若乙丙正割與丙甲正割又法乙丙余與半徑若乙甲余與丙甲正割又法乙丙正割與半徑若乙甲正割與丙甲余

丙角正與半徑若乙角余與丙甲余

半徑與丙角余割若乙角余與丙甲余

又法不用四率但以加減法取初數卽得丙甲正法爲乙角度與乙丙邊度相並爲總弧相減爲存弧各取余如法相加減【總弧過象限則兩余相加不過象限則相減】折半爲初數卽爲丙甲正

求乙丙邊法

乙角正與半徑若丙甲正與乙丙正

若欲用半徑爲首率以省除則爲半徑與乙角余割若丙甲正與乙丙正

乙角余與半徑若乙甲正切與乙丙正切

若欲用半徑爲首率以省除則爲半徑與乙角正割若乙甲正切與乙丙正切

丙角正與半徑若乙甲正與乙丙正

若欲用半徑爲首率以省除則爲半徑與兩角余割若乙甲正與乙丙正

丙角余與半徑若丙甲正切與乙丙正切

若欲用半徑爲首率以省除則爲半徑與丙角正割若丙甲正切與乙丙正切

半徑與丙甲余若乙甲余與乙丙余

又法乙甲余與半徑若丙甲正割與乙丙正割又法丙甲正割與半徑若乙甲余與乙丙余又法半徑與乙甲正割若丙甲正割與乙丙正割又法乙甲正割與半徑若丙甲余與乙丙余又法丙甲余與半徑若乙甲正割與乙丙正割

乙角正切與半徑若丙角余切與乙丙余

半徑與乙角余切若丙角余切與乙丙余

求乙甲邊法

乙角正切與半徑若丙甲正切與乙甲正

若欲用半徑爲首率以省除則爲半徑與乙角余切若丙甲正切與乙甲正

又法乙角正與乙角余若丙甲正切與乙甲正

半徑與乙角余若乙丙正切與乙甲正切

又法乙角正割與半徑若乙丙正切與乙甲正切

半徑與丙角正若乙丙正與乙甲正

半徑與丙角正切若丙甲正與乙甲正切

甲丙余與半徑若乙丙余與乙甲余

又法乙丙正割與半徑若丙甲正割與乙甲余又法半徑與丙甲正割若乙丙余與乙甲余又法乙丙余與半徑若丙甲余與乙甲正割又法半徑與乙丙正割若丙甲余與乙甲正割又法丙甲正割與半徑若乙丙正割與乙甲正割

乙角正與半徑若丙角余與乙甲余

半徑與乙角余割若丙角余與乙甲余

求乙角法

乙丙正與半徑若丙甲正與乙角正

若欲用半徑爲首率以省除則爲半徑與乙丙余割若丙甲正與乙角正

又法丙甲正與半徑若乙丙正與乙角正割又法半徑與丙甲余割若乙丙正與乙角正割又法乙丙正與丙甲正若乙角正割與乙角正切

乙甲正與半徑若丙甲正切與乙角正切

若欲用半徑爲首率以省除則爲半徑與乙甲余割若丙甲正切與乙角正切

又法丙甲正切與半徑若乙甲正與乙角余切

乙丙正切與半徑若乙甲正切與乙角余

若欲用半徑爲首率以省除則爲半徑與乙丙余切若乙甲正切與乙角余

又法乙甲正切與半徑若乙丙正切與乙角正割又法半徑與乙甲余切若乙丙正切與乙角正割

半徑與丙甲余若丙角正與乙角余【永補】

乙甲余與半徑若丙角余與乙角正【永補】

半徑與乙甲正割若丙角余與乙角正【永補】

乙丙余與半徑若丙角余切與乙角正切【永補】

半徑與乙丙正割若丙角余切與乙角正切

求丙角法

乙丙正與半徑若乙甲正與丙角正

若欲用半徑爲首率以省除則爲半徑與乙丙余割若乙甲正與丙角正

又法半徑與乙丙正割若乙角余切與丙角正切又法乙甲正與半徑若乙丙正與丙角余割【永補】

丙甲正與半徑若乙甲正切與丙角正切

若欲用半徑爲首率以省除則爲半徑與丙甲余割若乙甲正切與丙角正切

又法乙甲正切與半徑若丙甲正與丙角余切【永補】

乙丙正切與半徑若丙甲正切與丙角余

若欲用半徑爲首率以省除則爲半徑與乙丙余切若丙甲正切與丙角余

又法丙甲正切與半徑若乙丙正切與丙角正割【永補】

丙甲余與半徑若乙角余與丙角正【永補】

半徑與丙甲正割若乙角余與丙角正

半徑與乙角正若乙甲余與丙角余【永補】

半徑與乙角正切若乙丙余與丙角余切【永補】

已上求邊求角諸法具足有未備者永爲補之一種有數法擇用一焉可也【永所補者亦因他法隅反非臆測也用之可勿疑】垂弧法趨防

舉要第三卷

論垂弧但言可求某邊某角不詳其求之之法以有正弧三角法可攷也然算以防爲貴有可省者徑省之諸形中各求防法以趨簡易

形內垂弧第一支

【甲乙丙形有丙鋭角有角旁相連之乙丙甲丙二邊求對邊及余兩角】

作垂弧乙丁丁爲正角○按兩邊夾

一角求對角之邊有環中黍尺專書

備論可不作垂弧欲以垂弧算之第

四卷有防法但求丁丙邊【半徑與丙角余若】

【乙丙正切與丁丙正切】分甲丁邊【丙丁之餘爲甲丁】卽用兩分之兩邊以徑得乙甲【丁丙余與乙丙余若丁甲余與乙甲余】甚防也得乙甲則二角【乙甲】可求矣若按次求之先求丁丙次求乙丁次求丁乙丙分角次求乙甲次求甲角及丁乙甲分角末以兩乙角並之成乙角較爲煩曲

形內垂弧第二支【甲乙丙形有丙鋭角有角旁相連之乙丙邊及與各相對之乙甲邊求余兩角一邊】

此當先求甲角【乙甲正與丙角正若乙丙正與甲

角正】次求丁丙【半徑與丙角余若乙丙正切與丁丙正切】甲丁【半徑與甲角余若乙甲正切與甲丁正切】分邊並

得甲丙則乙角可得不必求垂弧與

分角

形內垂弧第三支【甲乙丙形有乙丙二角有乙丙邊求甲角及余邊】

邊在兩角之間斜弧三角之難求者

也若以垂弧法求之當求乙丁邊【半徑

與丙角正若乙丙正與乙丁正】丁乙丙分角【乙丙

余與半徑若丙角余切與乙角正切】原設乙角內減

丁乙丙得丁乙甲分角次求甲角【半徑與乙分角正若乙丁余與甲角余】乙甲邊【甲角正與半徑若乙丁正與乙甲正】甲丙邊【甲角正與乙丙正若原設乙角正與甲丙正】此不得不求垂弧與分角者也按次形法三角求邊以角易爲邊邊易爲角此形𨿽止兩角亦可弧角相易以次形求之蓋在本形爲兩角夾一邊次形卽爲兩邊夾一角在本形爲求對邊之角在次形卽爲求對角之邊徑用環中黍尺加減防法以求之一求而甲角可得矣此理隱於次形篇中永於三角求邊悟得之

形內垂弧第四支【甲乙丙形有丙甲二角有乙甲邊求乙角及餘二邊】

此當先求乙丙邊【丙角正與甲角正若乙甲正

與乙丙正】次求丙丁【半徑與丙角余若乙丙正切與丙

丁正切】丁甲【半徑與甲角余若乙甲正切與丁甲正切】分

邊並得丙甲而乙角可得

形內垂弧第五支【系二邊相同求三角此形易求略之】

形外垂弧第一支【甲乙丙形有丙鋭角有夾角之兩邊求乙甲邊及余兩角】

自乙角作垂弧於形外補成正角【丁角】本法須求丙乙丁角【乙丙余與半徑若丙角余切與乙角正切】乙丁邊【半徑與乙丙正若丙角正與乙丁正

】丁丙邊【半徑與乙丙正若乙角正與丁丙正】乃

可求乙甲邊【丁丙內減丙甲得甲丁半徑與甲丁余若乙

丁余與乙甲余】甲角【乙甲正與半徑若乙丁正與甲角正

】及甲乙丁虛角【乙甲正與半徑若甲丁正與虛】

【乙角正○末以甲角減半周得原設甲角以甲乙丁虛角減丙乙丁角得原設丙乙甲角】若用環中黍尺加減防法則不用作垂弧一求可得乙甲邊而甲乙兩角皆可求矣

形外垂弧第二支【甲乙丙形有甲鈍角有角旁之二邊求乙丙邊及餘二角】

本法亦作垂弧於形外補成正角先

求虛邊虛角而後可求形內之邊角

今按此亦可用環中黍尺法角求對

邊【鈍角用大矢】徑得乙丙因以求二角則

不必作垂弧

形外垂弧第三支【甲乙丙形有丙鋭角有角旁之乙丙邊有對角之乙甲邊求丙甲邊及餘二角】

本法先求虛邊虛角今按此可求甲

角【乙甲正與乙丙正若丙角正與甲角正】乃求丁

丙邊【半徑與丙角余若乙丙正切與丁丙正切】與甲丁

邊【半徑與甲外角余若乙甲正切與甲丁正切】於丁丙內

減甲丁得丙甲而乙角可求

形外垂弧第四支【乙甲丙形有甲鈍角有角旁之甲丙邊及對角之乙丙邊求乙甲邊及餘二角】

本法亦先算虛形今按此亦可仿第

三支先求乙角次求乙戊邊與甲戊

邊於乙戊內減甲戊得乙甲因以求

丙角

形外垂弧第五支【乙甲丙形有丙甲二角一鋭一鈍有丙甲邊在兩角之中求一角】

本法作垂弧先算虛邊虛角今按兩

角夾一邊求對邊之角猶之兩邊夾

一角求對角之邊徑易角爲邊易邊

爲角用加減防法可得對丙甲邊之

乙角

形外垂弧第六支【乙甲丙形有乙甲二角乙鋭甲鈍有丙甲邊與乙鋭角相對鈍角相連】

此當先求乙丙邊【有本形弧角比例】次求乙

戊虛邊【半徑與乙角余若乙丙正切與乙戊正切】次求

甲戊虛邊【半徑與甲外角余若丙甲正切與甲戊正切】於

乙戊內減甲戊得乙甲【因以求丙角】

形外垂弧第七支【乙甲丙形有乙鋭角甲鈍角有丙乙邊與甲鈍角相對鋭角相連】

此當先求丙甲邊餘如六支之法

垂弧又法第一支【乙甲丙形有乙丙邊在兩角之間而兩角並鈍求餘二邊及甲角】

法引丙甲至己引乙甲至戊各滿半

周作戊己邊與乙丙等而己與戊並

乙丙之外角成甲戊己次形依法作

垂弧於次形之內【如己丁】分爲兩形本

法求乙甲邊以己丁戊分形求到丁戊【半徑與戊角余若己戊正切與丁戊正切】以己丁甲形求到甲丁【先於己丁戊形求得己角以減原有之巳角余爲丁己甲分角又求得己丁垂弧乃求甲丁法爲半徑與己分角正切若己丁正與甲丁正切】合之成甲戊以減半周得乙甲求丙甲邊以己丁甲分形求到己甲【丁己甲角余與半徑若己丁正切與己甲正切】以減半周得丙甲乃以己丁甲分形求到甲交角【己甲正與半徑若己丁正與甲角正】按此殊多曲折徑易角爲邊易邊爲角【或用本形之乙丙兩鈍角易爲邊以乙丙邊爲角取矢或用次形之己戊兩鋭角易爲邊取己戊矢皆可】用加減防法求之卽可得甲角【因以求二邊】

垂弧又法第二支【乙甲丙形有丙甲二角有乙甲邊與丙角相對而兩角俱鈍求乙角及余邊】

如法引甲乙丙乙俱滿半周防於己

成丙甲己次形作己丁垂弧於次形

內分次形爲兩本法求乙角惟求分

形兩己角合之爲次形己角與乙對

角等又求分形甲丁丁丙並之爲甲丙以求到次形己丙減半周爲乙丙今按此形當先求乙丙邊【丙角正與乙甲正若甲角正與乙丙正】減半周餘爲己丙虛邊次求甲丁【乙甲減半周得甲己半徑與甲外角余若甲己正切與甲丁正切】丁丙【半徑與丙外角余若己丙正切與丁丙正切】並得甲丙因以求乙角【有弧角比例】稍爲直防若欲先知乙角如本法可矣【乙甲余弧與半徑若甲外角余切與甲己丁分角正切又半徑與甲己正若甲外角正與丁己正又丁己余與半徑若丙外角余與丁己丙角正合兩分形己角爲次形己角卽爲本形乙角】

垂弧又法第三支【乙甲丙形有乙丙乙甲兩邊有乙角在兩邊之中】

本法用甲乙戊次形算之今按此亦可用加減防法徑得丙甲

垂弧又法第四支【乙甲丙形有丙角有甲丙邊與角連有乙甲邊與角對】

法用甲己戊次形【甲己爲甲乙減半周之餘甲戊爲甲

丙減半周之餘戊角爲丙之外角】作垂弧於內求乙

丙邊及余兩角按此形當先求乙角

【乙甲正與丙角正若甲丙正與乙角正】因知己虛

角【己爲乙之外角】次求丁己【半徑與己角余若甲己正切與丁己正切】戊丁【半徑與戊角正切若甲戊正與戊丁正切】並得己戊卽丙乙因以求甲角若欲先知甲角卽於丁戊甲分形求之【半徑與戊角正切若甲戊余與甲角余切】因以求乙丙邊【丙角正與乙甲正若甲角正與乙丙正】

垂弧又法第五支【乙甲丙形有三邊內有乙甲丙甲二邊相同而皆爲過弧求三角】

本法用次形作垂弧求之今按此亦

可用加減防法用甲角角旁兩弧同

度則加減有變例檢環中黍尺五卷

補遺用

垂弧又法第六支【乙甲丙形有丙甲二鈍角有甲丙邊在兩角間】

本法引乙丙乙甲滿半周防於戊成

甲戊丙次形作垂弧於次形外以求

之今按此亦可易角爲邊易邊爲角

依加減防法求之徑得乙角【因以求二邊】

垂弧又法第七支【乙甲丙形有乙甲二鈍角有甲丙邊與角對】

法引設邊成丙戊甲次形【戊爲乙對角與乙角等】作垂弧於次形外此或先求乙丙【乙角正與甲丙正若甲角正與乙丙正】減半周得

丙戊或先求丙戊【戊角正與丙甲正若甲外角正

與丙戊正】減半周得乙丙次求丁甲【甲外

角余與半徑若甲丙正切與甲丁正切】丁戊【戊外角正割與半徑

若丙戊正切與丁戊正切】以丁戊減丁甲余爲

戊甲以戊甲減半周餘爲乙甲因以求丙角【若欲先知丙角先求甲丁對邊卽可求得丙角】

垂弧又法第八支【乙甲丙形有丙鈍角有角旁之兩邊丙乙丙甲】

本法用甲戊丙次形作甲丁垂弧引

丙戊防於丁可求乙甲邊及甲乙二

角今按此亦可用加減防法徑求乙

甲對邊以求二角

垂弧又法第九支【乙甲丙形有甲鈍角有乙丙邊與角對丙甲邊與角連】

法用丙戊甲次形自丙角作垂弧與

甲戊引長邊防於丁此當先求乙角

【本形有甲丙對邊比例】卽戊角【對角等】次求丁甲

與丁戊【與第七支求法同】於丁甲內減丁戊

爲甲戊卽得乙甲【法同七支】因以求丙角

次形

斜弧三角求邊必弧角互易用次形求之圖與算例皆詳明矣然易角爲邊有用本角度有用外角度恐易混淆今爲釐定開例如左庶用之無誤

凡三角俱鋭者在圓周之兩角用本角度其交角用外角度【凡三邊必有一邊就圓周凡三角必有兩角在圓周餘一角爲交角】

凡三角俱鈍者皆用外角度

凡兩鈍一鋭鈍在圓周鋭在交角者亦猶三角俱鈍皆用外角度

凡兩鈍一鋭鋭在圓周者用本角度其兩鈍一在圓周者用外角度一在交角者用本角度

凡兩鋭一鈍鋭在圓周者用本角度鈍在交角者用外角度

凡兩鋭一鈍鋭在圓周者用本角度在交角者用外角度鈍在圓周者亦用外角度

方圓冪積比例補

勿庵先生有方圓冪積一卷凡方圓周徑面體比例詳矣愚思之尙有方分圓分比例一法從來算家只言冪積不言圓分而範蜀公論律云古者以竹爲律竹形本圓今以方分置算此律非是算法圓分謂之徑圍方分謂之方斜今圓分而以方法算之此算數非是圓分始見於此圓體用圓分置算亦有至理平圓有平圓分立圓有立圓分得其方分圓分之比例則有大小不等之渾圓欲得倍數之差但借立方算之其得數甚眞亦甚防故爲補此一法

先論圓方

算家命平方如棋局之罫者謂之冪合計之謂之積夫有平冪亦當有平員之分合眾小員之分亦可謂平員之積由是而爲立員亦可謂立員分立員積矣夫所謂員分者非若句股容員虛其四隅也非若方體圓體中容得幾个圓球球間尙有空隙也大小相容全無隙罅但有圓之數而無圓之形是所謂員分員積也【如以分作九復碎丸成粉入大圓中謂此大員能容幾个粉丸】

平方平員

方徑一十

冪積一百

員徑一十

冪積七十八又五三九八一六

員積一百

方員有相應之理方員同徑員者刓其四角故冪積七十八有奇若員中復容員必與同徑之方等積大員與小員猶之大方與小方也此爲渾員立方比例之根

立方立員

立方徑一十

立方面冪六百

立員徑一十

立員面冪三百一十四又一五九二

六五

立員面員分六百

立員卽渾員渾圓面冪與員徑上平冪若四與一故四倍平員面冪【七八五三九八一六】而得三一四一五九二六五立方有六面則有六百與渾員面冪若六與三一四一五九二六五而渾員面上之員分則又與立方面冪等

立方徑一十

立方積一千

立員徑一十

立員積五百二十三又五九八七七五

立員員分積一千

立方立員同徑又刓去立方之八角則其積之比例若六與三一四一五九二六五故立方積一立員積五二三五九八七七五猶之立方面冪六而立員面冪三一四一五九二六五也積與冪旣同比例矣則立員員分積亦必與立方積等猶之立員面員分與立方面冪等也然則平冪面冪體積方與方員與員其數皆等借立方可算立員而大小員球之差數睹矣

借立方算立員

立方徑自乘又以徑乘之得積○立員亦徑自乘又以徑乘之得立員員分積

求大小員差幾倍數

大小員各算得積以積相較得差數若干倍

假如

今有大員徑三十六小員徑六徑之差六倍實體差若干倍

答曰大員比小員差二百一十六倍

法以大員徑自乘再乘得積四萬六千六百五十六小員徑自乘再乘得積二百一十六其差亦二百一十六倍【小員徑自乘卽大員徑故差數與積數等二百一十六自乘亦卽四萬六千六百五十六】

又法以兩徑差倍數自乘又以倍數乘之所得亦同

今有大員徑一十五萬小員徑八千徑之差十九倍弱實體差若干倍

答曰大員比小員差六千五百九十倍奇

法以十五萬自乘再乘大數三三七五以八千自乘再乘小數五一二大數爲實小數爲法除實得六千五百九十餘實三三七四○八幾盡故差六千五百九十倍奇【大小數相差甚逺借十九倍數自乘再乘得六千有奇故知首位是六千不用十九倍數算者不正得十九倍也】

此日月實體約略差數也利西泰云日大於月六千五百三十八倍奇亦相近

今有大員徑十五萬小員徑二萬八千二百七十四徑之差五倍有奇實體差若干倍

答曰大員比小員差一百四十九倍奇

法以小員自乘再乘得二二六○二七七五爲小數大員大數如前以大數爲實小數爲法除實得一百四十九幾盡故差一百四十九倍有奇

此日與地實體約略差數也利西泰云日大於地球一百六十五倍奇蓋利算日徑不啻十五萬里

今有大員徑二萬八千二百七十四小員徑八千徑之差三倍半有奇實體差若干倍

答曰大員比小員差四十四倍奇

法以大員積二二六○二七七五爲實小員積五一二爲法除之得四十四除實二二五二八不盡故差四十四倍奇

此地與月實體約略差數也利西泰云地大於月三十八倍奇蓋利算月徑不啻八千里

右法算渾圓大小相較之差徑防如此是亦少廣之一法不可缺也西人言日大於地五倍有奇又云一百六十五倍有奇兩數甚相懸今爲補此一法則日大於地實體與圓徑迥殊不足詫異矣

授時弧矢割員論

勿庵先生員容方直簡法附授時歷弧矢割員圖又附求黃赤內外度及黃赤道差法論之云割員之算始於魏劉徽至劉宋祖衝之父子尢精其術唐宋以算學設科古書猶未盡亡邢臺蓋有所本又云郭法用員容方直起算冬至西法用三角起算春分郭用三乘方以先得矢西用八綫故先得又西專用角而郭只用弧西兼用割切而郭只用種種各別而不害其同有所以同者在耳且夫數者所以合理也歷者所以順天也法有可采何論中西理所當明何分新舊在善學者知其所以異又知其所以同去中西之見以平心觀理則弧三角之詳明郭圖之簡括皆足以資探索而啟深思務集眾長以觀其防通母拘名相而取其精粹

永按員者徑一圍三古人之恆言算家之麤率精於算者覺其未密因有割員之術劉祖二家各有其率蓋欲細求周徑之數以究平員之理未甞剖之爲度析之爲分一一紀其縱橫之綫以爲測天之用也而算家相承仍用粗疎之率立弧矢之法或欲以曲承直則用三乘方法求矢或欲以直求曲則因矢以求半背差夫弧背爲曲綫矢爲直綫亙古無相通之率不相通而彊求之其所求得之數必非眞數也甞讀唐荊川先生弧矢論攷其求背差之法所得者猶是徑一圍三六邊之周耳【古法求背差以矢自乘爲實以徑爲法除實得半背差倍之得全背差假令半徑五自乘二十五徑十除之得二五倍之得五加於徑則半周十五又如徑十而矢一者通六餘通八餘矢二以矢一自乘以徑除之得小數一倍之得二爲背差又以余矢二自乘以徑除之得小數四倍之得八爲背差合兩通十四加兩差一半周亦得十五皆徑一圍三之半周】又攷邢氏律曆考衍三乘方求矢法迂曲煩難究其所得仍是圍三徑一耳此繇八綫表未傳不得不如此立算其得數之非眞𨿽前人亦未甞覺也郭太史之求黃赤內外度也先用帶從三乘方求各度矢則得矢不眞矣其旣得黃赤內外半弧也又以矢度求半背差加入半弧得內外半弧背則弧度亦非眞其求黃赤差法以黃道矢求半背差減黃道度得黃道半弧則得不眞矣其旣得赤道半弧也又求半背差以加半弧得赤道則赤道度亦非眞夫表端者景正源潔者流淸徑一圍三其本先失而欲數之不謬也得乎八綫之法至矣剖析大員細至分秒無非眞數以此測天絲毫莫能遁勿庵先生與郭法相提而論謂種種各別不害其同有所以同者在愚謂郭圖之矢猶八綫之矢也其句股皆八綫所有之句股也究之郭法西法終莫能同有所以不同者在耳先生謂當去中西之見平心以觀理夫理有眞亦有似使其似是而未眞則與眞者相提而論𨿽欲比而同之不可得矣

先生於郭法各添注求黃道矢與則注云本法如此原法如此【見前】求內外半弧背及赤道則注云原法如此【見前】今省夫存其本法而不論其法之是與非豈不欲苛求古人與原法所有而今省豈微覺其法之未善與愚豈敢苛論古人哉亦謂理數精微不能兩是寧割愛於古人耳

授時平立定三差辯

勿庵先生云授時歷於日躔盈縮月離遲疾並云以算術垜積【一作疊】招差立算而今所傳九章諸書無此術也豈古有而今逸耶載攷歷艸並以盈縮日數離爲六段並以段目除其段之積度得數乃相減爲一差一差又相減爲二差則其數齊同乃緣此以生定差及平差立差定差者盈縮初日最大之差也於是以平差立差減之則爲每日之定差矣若其布立成法則直以立差六因之以爲每日平立合差之差此兩法者若不相而其術巧防從未有能言其故者余因李世徳孝亷之疑而試爲思之其中原委亦自歷然爰命孫防成衍爲垜積之圖得書一卷

又云平立定差之法古無其術乃郭太史所創爲以求七政盈縮之度所以造立成之根本也據云依立招差又云依垜疊立招差則似古算術中原有其法而今采用之然不可攷矣愚因李問爲之衍算頗覺其用法之巧焉

永按郭太史時八綫表未傳中土以三差法求七政盈縮固巧矣愚竊謂其數之不眞凡圓體參差截爲數段前後相較其畸零之數無時而盡今以段目除積度相較至再而卽齊同無是理也凡相差之尾數前後疎密必不均用時有収有棄未有能截然齊一者今恆六因立差以爲每日平立合差之差則其差有常尾數不變【如太陽盈初縮未限平立合差之尾數恆爲八四○六二其較以六縮初盈末限平立合差之尾數恆爲二四六八○其較以二則盈縮加分盈縮積度之尾數皆有定率太陽如此其他可知】平圓中亦必無此差率也以至圓之體而欲以平方立方之差求之圓鑿方枘豈能相入哉或曰郭氏於七政各分段目測之其數蓋得之積候未可謂其無憑也曰凡以儀器測天𨿽極精密亦及度分而止必不能得其秒微各段相較至二差而齊同皆秒微之數則其積度畸零之小數必有遷就於其間者矣觀太陰遲疾立成其損益積度至於五度四二九三有奇較西法加減均數爲贏而又不知有二三均加減則其日逐測到之度豈盡與天密合哉平圓中自然之差數八綫表盡之矣使平立定三差之法果符天運則八綫亦可不立旣有八綫之精算爲一切測圓之凖繩則此外更無岐途別徑亦無取乎三差之巧矣於古人之法深究其根存而勿用可也

數學卷八

欽定四庫全書

續數學卷一

婺源江永撰

正弧三角疏義

目錄

【分支列目隨其所欲求者因目以檢後題】

第一支

有正角有餘角有對正角之邊而求兩邊一角

【凡正弧三角鈐記甲爲正角乙爲余角丙爲交角乙丙爲對正角之邊丙甲爲對余角之邊乙甲爲對交角之邊】

求對余角之邊【第一題】

求對交角之邊【第二題】

求交角【第三題】

第二支

有正角有餘角有對余角之邊而求兩邊一角

求對正角之邊【第四題】

求對交角之邊【第五題】

求交角【第六題】

第三支

有正角有交角有對正角之邊而求兩邊一角

求對交角之邊【第七題】

求對余角之邊【第八題】

求余角【第九題】

第四支

有正角有交角有對交角之邊而求兩邊一角

求對正角之邊【第十題】

求對余角之邊【第十一題】

求余角【第十二題】

第五支

有正角有角旁相連之兩邊而求一邊兩角

求對正角之邊【第十三題】

求余角【第十四題】

求交角【第十五題】

第六支

有正角余角夾一邊而求兩邊一角

求對正角之邊【第十六題】

求對余角之邊【第十七題】

求交角【第十八題】

第七支

有正角交角夾一邊而求兩邊一角

求對正角之邊【第十九題】

求對交角之邊【第二十題】

求余角【第二十一題】

第八支

有正角有對正角交角之邊而求一邊兩角

求對余角之邊【第二十二題】

求交角【第二十三題】

求余角【第二十四題】

第九支

有正角有對正角余角之邊而求一邊兩角

求對交角之邊【第二十五題】

求余角【第二十六題】

求交角【第二十七題】

第十支

有三角求三邊

求對正角之邊【第二十八題】

求對余角之邊【第二十九題】

求對交角之邊【第三十題】

已上正法已具

第十一支

不用正角以余角交角二邊相對相求

余角交角偕對余角之邊求對交角之邊【第三十一題】交角余角偕對交角之邊求對余角之邊【第三十二題】對余角交角之邊偕余角求交角【第三十三題】

對交角余角之邊偕交角求余角【第三十四題】

正弧三角形

甲爲正角乙爲余角丙爲交角

圓內全形圖及解義詳後

分題舉法

第一支【有正角有餘角有對正角之邊求兩邊一角】

第一題

有甲角有乙角有對甲角乙丙邊求對乙角丙甲邊法曰半徑【卽甲角正後仿此】與乙角正若乙丙正與丙甲正【凡首舉者爲一率言與者爲二率言若者爲三率後言與者爲四率凡數以二率三率相乘爲實以一率爲法除之而得第四率爲所求之數凡二率可易爲三三率可易爲二凡半徑爲全數在首率者升位可省除在中間者升位可者乘後仿此】

第二題

有甲角有乙角有對甲角乙丙邊求對丙角乙甲邊法曰半徑與乙角余若乙丙正切與乙甲正切

第三題

有甲角有乙角有對甲角乙丙邊求丙角

法曰半徑與乙角正切若乙丙余與丙角余切第二支【有正角有餘角有對余角之邊而求兩邊一角】

第四題

有甲角有乙角有對乙角丙甲邊求對甲角乙丙邊法曰乙角正與半徑若丙甲正與乙丙正若欲用半徑爲首率以省除則爲半徑與乙角余割若丙甲正與乙丙正

第五題

有甲角有乙角有對乙角丙甲邊求對丙角乙甲邊法曰乙角正切與半徑若丙甲正切與乙甲正若欲用半徑爲首率以省除則爲半徑與乙角余切若丙甲正切與乙甲正

第六題

有甲角有乙角有對乙角丙甲邊求丙角

法曰丙甲余與半徑若乙角余與丙角正第三支【有正角有交角有對正角之邊而求兩邊一角】

第七題

有甲角有丙角有對甲角乙丙邊求對丙角乙甲邊法曰半徑與丙角正若乙丙正與乙甲正

第八題

有甲角有丙角有對甲角乙丙邊求對乙角丙甲邊法曰半徑與丙角余若乙丙正切與丙甲正切

第九題

有甲角有丙角有對甲角乙丙邊求乙角

法曰乙丙余與半徑若丙角余切與乙角正切【首率易半徑則次率易乙丙正割】

第四支【有正角有交角有對交角之邊而求兩邊一角】

第十題

有甲角有丙角有對丙角乙甲邊求對甲角乙丙邊法曰丙角正與半徑若乙甲正與乙丙正若欲用半徑爲首率以省除則爲半徑與丙角余割若乙甲正與乙丙正

第十一題

有甲角有丙角有對丙角乙甲邊求對乙角丙甲邊法曰丙角正切與半徑若乙甲正切與丙甲正若欲用半徑爲首率以省除則爲半徑與丙角余切若乙甲正切與丙甲正

第十二題

有甲角有丙角有對丙角乙甲邊求對乙角

法曰乙甲余與半徑若丙角余與乙角正【首率易半徑則次率易乙甲正割】

第五支【有正角有角旁相連之兩邊而求一邊兩角】

第十三題

有甲角有乙甲邊丙甲邊求對甲角乙丙邊

法曰半徑與丙甲余若乙甲余與乙丙余

第十四題

有甲角有乙甲邊丙甲邊求乙角

法曰乙甲正與半徑若丙甲正切與乙角正切若欲用半徑爲首率以省除則爲半徑與乙甲余割若丙甲正切與乙角正切

第十五題

有甲角有乙甲邊丙甲邊求丙角

法曰丙甲正與半徑若乙甲正切與丙角正切若欲用半徑爲首率以省除則爲半徑與丙甲余割若乙甲正切與丙角正切

第六支【有正角余角夾一邊而求兩邊一角】

第十六題

有甲角有乙角有乙甲邊求對甲角乙丙邊

法曰乙角余與半徑若乙甲正切與乙丙正切若欲用半徑爲首率以省除則爲半徑與乙角正割若乙甲正切與乙丙正切

第十七題

有甲角有乙角有乙甲邊求對乙角丙甲邊

法曰半徑與乙角正切若乙甲正與丙甲正切

第十八題

有甲角有乙角有乙甲邊求丙角

法曰半徑與乙角正若乙甲余與丙角余第七支【有正角交角夾一邊而求兩邊一角】

第十九題

有甲角有丙角有丙甲邊求對甲角乙丙邊

法曰丙角余與半徑若丙甲正切與乙丙正切若欲用半徑爲首率以省除則爲半徑與丙角正割若丙甲正切與乙丙正切

第二十題

有甲角有丙角有丙甲邊求對丙角乙甲邊

法曰半徑與丙角正切若丙甲正與乙甲正切

第二十一題

有甲角有丙角有丙甲邊求乙角

法曰半徑與丙角正若丙甲余與乙角余第八支【有正角有對正角交角之邊而求一邊兩角】

第二十二題

有甲角有乙丙邊乙甲邊求丙甲邊

法曰乙甲余與半徑若乙丙余與丙甲余若欲用半徑爲首率以省除則爲半徑與乙甲正割若乙丙余與丙甲余

第二十三題

有甲角有乙丙邊乙甲邊求丙角

法曰乙丙正與半徑若乙甲正與丙角正若欲用半徑爲首率以省除則爲半徑與乙丙余割若乙甲正與丙角正

第二十四題

有甲角有乙丙邊乙甲邊求乙角

法曰乙丙正切與半徑若乙甲正切與乙角余若欲用半徑爲首率以省除則爲半徑與乙丙余切若乙甲正切與乙角余

第九支【有正角有對正角余角之邊而求一邊兩角】

第二十五題

有甲角有乙丙邊丙甲邊求乙甲邊

法曰丙甲余與半徑若乙丙余與乙甲余若欲用半徑爲首率以省除則爲半徑與丙甲正割若乙丙余與乙甲余

第二十六題

有甲角有乙丙邊丙甲邊求乙角

法曰乙丙正與半徑若丙甲正與乙角正若欲用半徑爲首率以省除則爲半徑與乙丙余割若丙甲正與乙角正

第二十七題

有甲角有乙丙邊丙甲邊丙甲邊求丙角

法曰乙丙正切與半徑若丙甲正切與丙角余若欲用半徑爲首率以省除則爲半徑與乙丙余切若丙甲正切與丙角余

第十支【有三角求三邊】

第二十八題

有甲角乙角丙角求乙丙邊

法曰乙角正切與半徑若丙角余切與乙丙余【首率易半徑則次率易乙角余切】

第二十九題

有甲角乙角丙角求丙甲角

法曰丙角正與半徑若乙角余與丙甲余【首率易半徑則次率易丙角余割】

第三十題

有甲角乙角丙角求乙甲邊

法曰乙角正與半徑若丙角余與乙甲余【首率易半徑則次率易乙角余割】

已上皆有甲角半徑者正法已具其不用甲角者別爲一支四題如左

第十一支【不用正角以余角交角二邊相對相求】

第三十一題

有乙角丙角丙甲邊求乙甲邊

法曰乙角正與丙甲正若丙角正與乙甲正

第三十二題

有丙角乙角乙甲邊求丙甲邊

法曰丙角正與乙甲正若乙角正與丙甲正

第三十三題

有乙角有丙甲乙甲邊求丙角

法曰丙甲正與乙角正若乙甲正與丙角正

第三十四題

有丙角有乙甲丙甲邊求乙角

法曰乙甲正與丙角正若丙甲正與乙角正平圓正三角圖

天上隨處皆可作弧三角此姑

以黃赤道圖之己辛癸丁圓爲

極至交圈己爲北極辛乙丁爲

赤道庚爲黃極壬乙戊爲黃道

壬爲冬至乙爲春秋分戊爲夏

至丙者設太陽所在己丙甲者

從北極出綫過太陽抵赤道爲過極圈之一象限【九十度】乙丙者太陽行過春分之經度乙甲赤道同升度丙甲距緯度戊丁者乙角之度也【凡角度皆在九十度之圓周上春分至夏至黃赤皆足九十度故戊丁爲乙角度此角度爲黃赤道距緯古今不同古時不止二十三度半今度不及二十三度半姑以二十三度半算之可也】庚己者黃極距北極之度亦與戊丁同度也甲爲正角【卽直角】其正滿半徑故卽以半徑爲甲角此甲乙丙形卽前圖之灣曲形因側視故黃赤道成直綫稍轉卽成灣曲矣

此圖又有次形丙戊者黃道乙丙之餘弧甲丁者乙甲赤道之餘弧己丙者丙甲距緯之餘弧己戊者乙角丁戊之餘弧而甲丁弧又爲己角之度是次形又有己戊丙之三角形戊爲正角同甲角丙爲交角同丙角己爲余角似乙角也本形有不能以正比例者則以次形易之而別法生焉

正弧形弧角相易又次形圖

甲乙丙正弧三角形旣易爲己丙戊次形又易爲己庚子形

圖之己丙戊形卽前圖之己丙戊形

丁與庚亦前圖之丁及庚此引丙戊

綫至醜引丙己綫至子皆滿象限作

丑子弧引之至庚與戊己庚弧會則

戊庚醜庚亦皆一象限成己子庚形與甲乙丙形相當子爲正角同甲角己爲交角似丙角庚爲余角似乙角也○乙丙邊易爲庚角【乙戊及丙丑皆象限內減同用之丙戊則戊醜卽乙丙而戊丑卽庚角之弧】乙甲邊易爲己角【乙甲之餘度丁甲卽己交角之弧】是又次形之兩角卽元形之兩邊也乙角易爲己庚邊【前設乙甲丁戊爲黃赤距度則己庚者黃極赤極距度故二邊相等】丙角易爲子庚邊【丙交角之弧丑子其餘弧爲子庚】是又次形之兩邊卽元形之兩角而子己卽丙甲子角卽甲角於是次形有不能比例者易爲又次形而別法又生焉

續數學卷一

