

緝古算經

上輯古算經表

臣孝通言﹕臣聞九疇載敍﹐紀法著於彜倫﹔六藝成功﹐數術參於造化。夫爲君上者﹐司牧黔首﹐布神道而設教﹐采能事而經綸﹐盡性窮源﹐莫重於算。昔周公制禮﹐有九數之名。竊尋九數﹐卽《九章》是也。其理幽而微﹐其形祕而約﹐重句聊用測海﹐寸木可以量天﹐非宇宙之至精﹐其孰能與於此者﹖漢代張蒼刪補殘缺﹐校其條目﹐頗與古術不同。魏朝劉徽篤好斯言﹐博綜纖隱﹐更爲之注。徽思極毫芒﹐觸類增長﹐乃造重差之法﹐列於終篇。𨿽卽未爲司南﹐然亦一時獨步。自玆厥後﹐不斷前蹤。賀循﹑徐嶽之徒﹐王彪﹑甄鸞之輩﹐會通之數無聞焉耳。但舊經殘駁﹐尙有闕漏﹐自劉已下﹐更不足言。其祖恆之《綴術》﹐時人稱之精妙﹐曾不覺方邑進行之術﹐全錯不通﹔芻亭方亭之問﹐於理未盡。臣今更作新術﹐於此附伸。臣長自閭閻﹐少小學算。鐫磨愚鈍﹐迄將皓首。鉆尋祕奧﹐曲盡無遺。代乏知音﹐終成寡和。伏蒙聖朝收拾﹐用臣爲太史丞﹐比年已來﹐奉敕校勘傅仁均歷﹐凡駁正術錯三十餘道﹐卽付太史施行。伏尋《九章﹟商功篇》有平地役功受袤之術﹐至於上寬下狹﹑前髙後卑﹐正經之內﹐闕而不論﹐致使今代之人不達深理﹐就平正之門﹐同欹邪之用。斯乃圓孔方柄﹐如何可安﹖臣晝思夜想﹐臨書浩嘆﹐恐一旦瞑目﹐將來莫睹﹐遂於平地之餘﹐續狹斜之法﹐凡二十術﹐名曰《緝古》。請訪能算之人﹐考論得失﹐如有排其一字﹐臣欲謝以千金。輕用陳聞﹐伏深戰悚。謹言。

緝古算經

假今天正十一月朔夜半﹐日在斗十度七百分度之四百八十。以章歲爲母﹐朔月行定分九千﹐朔日定小餘一萬﹐日法二萬﹐章歲七百﹐亦名行分法。今不取加時日度。問﹕天正朔夜半之時月在何處﹖﹝推朔夜半月度﹐舊術要須加時日度。自古先儒𨿽復修撰攺制﹐意見甚眾﹐並未得算妙﹐有理不盡﹐考校尢難。臣每日夜思量﹐常以此理屈滯﹐恐後代無人知者。今奉敕造歷﹐因卽攺制﹐爲此新術。舊推日度之術﹐巳得朔夜半日度﹐仍須更求加時日度﹐然知月處。臣今作新術﹐但得朔夜半日度﹐不須加時日度﹐卽知月處。此新術比於舊術﹐一年之中十二倍省功﹐使學者易知﹞

答曰﹕在斗四度七百分度之五百三十。

術曰﹝推朔夜半月度﹐新術不復加時日度﹐有定小餘乃可用之﹞﹕以章歲減朔月行定分﹐余以乘朔日定小餘﹐滿日法而一﹐爲先行分。不盡者﹐半法已上收成一﹐已下者棄之。若先行分滿日行分而一﹐爲度分﹐以減朔日夜半日所在度分﹐若度分不足減﹐加往宿度﹔其分不足減者﹐退一度爲行分而減之﹐余卽朔日夜半月行所在度及分也﹝凡入歷當月行定分﹐卽是月一日之行分。但此定分滿章歲而一﹐爲度。凡日一日行一度。然則章歲者﹐卽是日之一日行分也。今按﹕《九章﹟均輸篇》有犬追兔術﹐與此術相似。彼問﹕犬走一百走﹐兔走七十步﹐令免先走七十五步﹐犬始追之﹐問幾何步追及﹖答曰﹕二百五十步追及。彼術曰﹕以兔走減犬走﹐餘者爲法。又以犬走乘兔先走﹐爲實。實如法而一﹐卽得追及步數。此術亦然。何者﹖假令月行定分九千﹐章歲七百﹐卽是日行七百分﹐月行九千分。令日月行數相減﹐餘八千三百分者﹐是日先行之數。然月始追之﹐必用一日而相及也。令定小餘者﹐亦是日月相及之日分。假令定小餘一萬﹐卽相及定分﹐此乃無對爲數。其日法者﹐亦是相及之分。此又同數﹐爲有八千三百﹐是先行分也。斯則異矣。但用日法除之﹐卽四千一百五十﹐卽先行分。故以夜半之時日在月前﹑月在日後﹐以日月相去之數四千一百五十減日行所在度分﹐卽月夜半所在度分也﹞。

假令太史造仰觀臺﹐上廣袤少﹐下廣袤多。上下廣差二丈﹐上下袤差四丈﹐上廣袤差三丈﹐髙多上廣一十一丈﹐甲縣差一千四百一十八人﹐乙縣差三千二百二十二人﹐夏程人功常積七十五尺﹐限五日役臺畢。羨道從臺南面起﹐上廣多下廣一丈二尺﹐少袤一百四尺﹐髙多袤四丈。甲縣一十三鄕﹐乙縣四十三鄕﹐每鄕別均賦常積六千三百尺﹐限一日役羨道畢。二縣差到人共造仰觀臺﹐二縣鄕人共造羨道﹐皆從先給甲縣﹐以次與乙縣。臺自下基給髙﹐道自初登給袤。問﹕臺道廣﹑髙﹑袤及縣別給髙﹑廣﹑袤各幾何﹖

答曰﹕

臺髙一十八丈

上廣七丈﹐

下廣九丈﹐

上袤一十丈﹐

下袤一十四丈﹔

甲縣給髙四丈五尺﹐

上廣八丈五尺﹐

下廣九丈﹐

上袤一十三丈﹐

下袤一十四丈﹔

乙縣給髙一十三丈五尺﹐

上廣七丈﹐

下廣八丈五尺﹐

上袤一十丈﹐

下袤一十三丈﹔

羨道髙一十八丈﹐

上廣三丈六尺﹐

下廣二丈四尺﹐

袤一十四丈﹔

甲縣鄕人給髙九丈﹐

上廣三丈﹐

下廣二丈四尺﹐

袤七丈﹔

乙縣鄕人給髙九丈﹐

上廣三丈六尺﹐

下廣三丈﹐

袤七丈。

術曰﹕以程功尺數乘二縣人﹐又以限日乘之﹐爲臺積。又以上下袤差乘上下廣差﹐三而一﹐爲隅陽冪。以乘截髙﹐爲隅陽截積。又半上下廣差﹐乘斬上袤﹐爲隅頭冪。以乘截髙﹐爲隅頭截積。並二積﹐以減臺積﹐余爲實。以上下廣差並上下袤差﹐半之﹐爲正數﹐加截上袤﹐以乘截髙﹐所得增隅陽冪加隅頭冪﹐爲方法。又並截髙及截上袤與正數﹐爲廉法﹐從。開立方除之﹐卽得上廣。各加差﹐得臺下廣及上下袤﹑髙。

求均給積尺受廣袤﹐術曰﹕以程功尺數乘乙縣人﹐又以限日乘之﹐爲乙積。三因之﹐又以髙冪乘之﹐以上下廣差乘袤差而一﹐爲實。又以臺髙乘上廣﹐廣差而一﹐爲上廣之髙。又以臺髙乘上袤﹐袤差而一﹐爲上袤之髙。又以上廣之髙乘上袤之髙﹐三之﹐爲方法。又並兩髙﹐三之﹐二而一﹐爲廉法﹐從。開立方除之﹐卽乙髙。以減本髙﹐余卽甲髙。此是從下給臺甲髙。又以廣差乘乙髙﹐以本髙而一﹐所得加上廣﹐卽甲上廣。又以袤差乘乙髙﹐如本髙而一﹐所得加上袤﹐卽甲上袤。其上廣﹑袤卽乙下廣﹑袤﹐臺上廣﹑袤卽乙上廣﹑袤。其後求廣﹑袤﹐有增損者﹐皆放此﹝此應六因乙積﹐臺髙再乘﹐上下廣差乘袤差而一。又以臺髙乘上廣﹐廣差而一﹐爲上廣之髙。又以臺髙乘上袤﹐袤差而一﹐爲上袤之髙。以上廣之髙乘上袤之髙﹐爲小冪二。因下袤之髙﹐爲中冪一。凡下袤﹑下廣之髙﹐卽是截髙與上袤與上廣之髙相連並數。然此有中冪定有小冪一。又有上廣之髙乘截髙﹐爲冪一。又下廣之髙乘下袤之髙﹐爲大冪二。乘上袤之髙爲中冪一。其大冪之中又小冪一﹐復有上廣﹑上袤之髙各乘截髙﹐爲中冪各一。又截髙自乘﹐爲冪一。其中冪之內有小冪一。又上袤之髙乘截髙﹐爲冪一。然則截髙自相乘﹐爲冪二﹐小冪六。又上廣﹑上袤之髙各三﹐以乘截髙﹐爲冪六。令皆半之﹐故以三乘小冪。又上廣﹑上袤之髙各三﹐令但半之﹐各得一又二分之一﹐故三之﹐二而一﹐諸冪乘截髙爲積尺﹞。

求羨道廣﹑袤﹑髙﹐術曰﹕以均賦常積乘二縣五十六鄕﹐又六因﹐爲積。又以道上廣多下廣數加上廣少袤﹐爲下廣少袤。又以髙多袤加下廣少袤﹐爲下廣少髙。以乘下廣少袤﹐爲隅陽冪。又以下廣少上廣乘之﹐爲鱉隅積。以減積﹐餘三而一﹐爲實。並下廣少袤與下廣少髙﹐以下廣少上廣乘之﹐鱉從橫廉冪。三而一﹐加隅冪﹐爲方法。又以三除上廣多下廣﹐以下廣少袤﹑下廣少髙加之﹐爲廉法﹐從。開立方除之﹐卽下廣。加廣差﹐卽上廣。加袤多上廣於上廣﹐卽袤。加髙多袤﹐卽道髙。

求羨道均給積尺甲縣受廣﹑袤﹐術曰﹕以均賦常積乘甲縣上十三鄕﹐又六因﹐爲積。以袤再乘之﹐以道上下廣差乘臺髙爲法而一﹐爲實。又三因下廣﹐以袤乘之﹐如上下廣差而一﹐爲都廉﹐從。開立方除之﹐卽甲袤。以廣差乘甲袤﹐本袤而一﹐以下廣加之﹐卽甲上廣。又以臺髙乘甲袤﹐本袤除之﹐卽甲髙。

假令築堤﹐西頭上﹑下廣差六丈八尺二寸﹐東頭上﹑下廣差六尺二寸。東頭髙少於西頭髙三丈一尺﹐上廣多東頭髙四尺九寸﹐正袤多於東頭髙四百七十六尺九寸。甲縣六千七百二十四人﹐乙縣一萬六千六百七十七人﹐丙縣一萬九千四百四十八人﹐丁縣一萬二千七百八十一人。四縣每人一日穿土九石九斗二升。每人一日築常積一十一尺四寸十三分寸之六。穿方一尺得土八斗。古人負土二斗四升八合﹐平道行一百九十二步﹐一日六十二到。今隔山渡水取土﹐其平道只有一十一步﹐山斜髙三十步﹐水寬一十二步﹐上山三當四﹐下山六當五﹐水行一當二﹐平道踟躕十加一﹐載輸一十四步。減計一人作功爲均積。四縣共造﹐一日役華。今從東頭與甲﹐其次與乙﹑丙﹑丁。問﹕給斜﹑正袤與髙﹐及下廣﹐並每人一日自穿﹑運﹑築程功﹐及堤上﹑下髙﹑廣各幾何﹖

答曰﹕

一人一日自穿﹑運﹑築程功四尺九寸六分﹔

西頭髙三丈四尺一寸﹐

上廣八尺﹐

下廣七丈六尺二寸﹐

東頭髙三尺一寸﹐

上廣八尺﹐

下廣一丈四尺二寸﹐

正袤四十八丈﹐

斜袤四十八丈一尺﹔

甲縣正袤一十九丈二尺﹐

斜袤一十九丈二尺四寸﹐

下廣三丈九尺﹐

髙一丈五尺五寸﹔

乙縣正袤一十四丈四尺﹔

斜袤一十四丈四尺三寸﹐

下廣五丈七尺六寸﹐

髙二丈四尺八寸﹔

丙縣正袤九丈六尺﹐

斜袤九丈六尺二寸﹐

下廣七尺﹐

髙三丈一尺﹔

丁縣正袤四丈八尺﹐

斜袤四丈八尺一寸﹐

下廣七丈六尺二寸﹐

髙三丈四尺一寸。

求人到程功運築積尺﹐術曰﹕置上山四十步﹐下山二十五步﹐渡水二十四步﹐平道一十一步﹐踟躕之間十加一﹐載輸一十四步﹐一返計一百二十四步。以古人負土二斗四升八合﹐平道行一百九十二步﹐以乘一日六十二到﹐爲實。卻以一返步爲法。除﹐得自運土到數也。又以一到負土數乘之﹐卻以穿方一尺土數除之﹐得一人一日運動積。又以一人穿土九石九斗二升﹐以穿方一尺土數除之﹐爲法。除之﹐得穿用人數。復置運功積﹐以每人一日常積除之﹐得築用人數。並之﹐得六人。共成二十九尺七寸六分﹐以六人除之﹐卽一人程功也。

求堤上﹑下廣及髙﹑袤﹐術曰﹕一人一日程功乘總人﹐爲堤積。以髙差乘下廣差﹐六而一﹐爲鱉冪。又以髙差乘小頭廣差﹐二而一﹐爲大臥塹頭冪。又半髙差﹐乘上廣多東頭髙之數﹐爲小臥塹頭冪。並三冪﹐爲大小塹鱉率。乘正袤多小髙之數﹐以減堤積﹐余爲實。又置半髙差及半小頭廣差與上廣多小頭髙之數﹐並三差﹐以乘正袤多小頭髙之數。以加率爲方法。又並正袤多小頭髙﹑上廣多小髙及半髙差﹐兼半小頭廣差加之﹐爲廉法﹐從。開方立除之﹐卽小髙。加差﹐卽各得廣﹑袤﹑髙。又正袤自乘﹐髙差自乘﹐並﹐而開方除之﹐卽斜袤。

求甲縣髙﹑廣﹑正﹑斜袤﹐術曰﹕以程功乘甲縣人﹐以六因取積﹐又乘袤冪。以下廣差乘髙差爲法除之﹐爲實。又並小頭上下廣﹐以乘小髙﹐三因之﹐爲垣頭冪。又乘袤冪﹐如法而一﹐爲垣方。又三因小頭下廣﹐以乘正袤﹐以廣差除之﹐爲都廉﹐從。開立方除之﹐得小頭袤﹐卽甲袤。又以下廣差乘之﹐所得以正袤除之﹐所得加東頭下廣﹐卽甲廣。又以兩頭髙差乘甲袤﹐以正袤除之﹐以加東頭髙﹐卽甲髙。又以甲袤自乘﹔以堤東頭髙減甲髙﹐余自乘﹐並二位﹐以開方除之﹐卽得斜袤。若求乙﹑丙﹑丁﹐各以本縣人功積尺﹐每以前大髙﹑廣爲後小髙﹑主廉母自乘﹐爲方母。廉母乘方母﹐爲實母﹝此平堤在上﹐羨除在下。兩髙之差卽除髙。其除兩邊各一鱉腝﹐中一塹堵。今以袤再乘六因積﹐廣差乘袤差而一﹐得截鱉腝袤﹐再自乘﹐爲立方一。又塹堵袤自乘﹐爲冪一。又三因小頭下廣﹐大袤乘之﹐廣差而一﹐與冪爲髙﹐故爲廉法。又並小頭上下廣﹐又三之﹐以乘小頭髙爲頭冪﹐意同六除。然此頭冪﹐本乘截袤。又袤乘之﹐差相乘而一。今還依數乘除一頭冪﹐爲從。開立方除之﹐得截袤﹞。

求堤都積﹐術曰﹕置西頭髙﹐倍之﹐加東頭髙﹐又並西頭上下廣﹐半而乘之。又置東頭髙﹐倍之﹐加西頭髙﹐又並東頭上下廣﹐半而乘之。並二位積﹐以正袤乘之﹐六而一﹐得堤積也。

假令築龍尾堤﹐其堤從頭髙﹑上闊以次低狹至尾。上廣多﹐下廣少﹐堤頭上下廣差六尺﹐下廣少髙一丈二尺﹐少袤四丈八尺。甲縣二千三百七十五人﹐乙縣二千三百七十八人﹐丙縣五千二百四十七人。各人程功常積一尺九寸八分﹐一日役畢﹐三縣共築。今從堤尾與甲縣﹐以次與乙﹑丙。問﹕龍尾堤從頭至尾髙﹑袤﹑廣及各縣別給髙﹑袤﹑廣各多少。

答曰﹕

髙三丈﹐

上廣三丈四尺﹐

下廣一丈八尺﹐

袤六丈六尺﹔

甲縣髙一丈五尺﹐

袤三丈三尺﹐

上廣二丈一尺﹔

乙縣髙二丈一尺﹐

袤一丈三尺二寸﹐

上廣二丈二尺二寸﹔

丙縣髙三丈﹐袤一丈九尺八寸﹐

上廣二丈四尺。

求龍尾堤廣﹑袤﹑髙﹐術曰﹕以程功乘總人﹐爲堤積。又六因之﹐爲虛積。以少髙乘少袤﹐爲隅冪。以少上廣乘之﹐爲鱉隅積。以減虛積﹐余﹐三約之﹐所得爲實。並少髙﹑袤﹐以少上廣乘之﹐爲鱉從橫廉冪。三而一﹐加隅冪﹐爲方法。又三除少上廣﹐以少袤﹑少髙加之﹐爲廉法﹐從。開立方除之﹐得下廣。加差﹐卽髙﹑廣﹑袤。

求逐縣均給積尺受廣﹑袤﹐術曰﹕以程功乘當縣人﹐當積尺。各六因積尺。又乘袤冪。廣差乘髙﹐爲法。除之﹐爲實。又三因末廣﹐以袤乘之﹐廣差而一﹐爲都廉﹐從。開立方除之﹐卽甲袤。以本髙乘之﹐以本袤除之﹐卽甲髙。又以廣差乘甲袤﹐以本袤除之﹐所得加末廣﹐卽甲上廣。其甲上廣卽乙末廣﹐其甲髙卽垣髙。求實與都廉﹐如前。又並甲上下廣﹐三之﹐乘甲髙﹐又乘袤冪﹐以法除之﹐得垣方﹐從。開立方除之﹐卽乙袤。余放此﹝此龍尾猶羨除也。其塹堵一﹐鱉腝一﹐並而相連。今以袤再乘積﹐廣差乘髙而一﹐所得截鱉腝袤再自乘﹐爲立方一。又塹堵袤自乘﹐爲冪一。又三因末廣﹐以袤乘之﹐廣差而一﹐與冪爲髙﹐故爲廉法﹞。

假令穿河﹐袤一里二百七十六步﹐下廣六步一尺二寸﹔北頭深一丈八尺六寸﹐上廣十二步二尺四寸﹔南頭深二百四十一尺八寸﹔上廣八十六步四尺八寸。運土於河西岸造漘﹐北頭髙二百二十三尺二寸﹐南頭無髙﹐下廣四百六尺七寸五釐﹐袤與河同。甲郡二萬二千三百二十人﹐乙郡六萬八千七十六人﹐丙郡五萬九千九百八十五人﹐丁郡三萬七千九百四十四人。自穿﹑負﹑築﹐各人程功常積三尺七寸二分。限九十六日役﹐河漘俱了。四郡分共造漘﹐其河自北頭先給甲郡﹐以次與乙﹐合均賦積尺。問﹕逐郡各給斜﹑正袤﹐上廣及深﹐並漘上廣各多少﹖

答曰﹕

漘上廣五丈八尺二寸一分﹔

甲郡正袤一百四十四丈﹐

斜袤一百四十四丈三尺﹐

上廣二十六丈四寸﹐

深一十一丈一尺六寸﹔

乙郡正袤一百一十五丈二尺﹐

斜袤一百一十五丈四尺四寸﹐

上廣四十丈九尺二寸﹐

深一十八丈六尺﹔

丙郡正袤五十七丈六尺﹐

斜袤五十七丈七尺二寸﹐

上廣四十八丈三尺六寸﹐

深二十二丈三尺二寸﹐

丁郡正袤二十八丈八尺﹐

斜袤二十八丈八尺六寸﹐

上廣五十二丈八寸﹐

深二十四丈一尺八寸。

術曰﹕如築堤術入之﹝覆堤爲河﹐彼注甚明﹐髙深稍殊﹐程功是同﹐意可知也﹞。以程功乘甲郡人﹐又以限日乘之﹐四之﹐三而一﹐爲積。又六因﹐以乘袤冪。以上廣差乘深差﹐爲法。除之﹐爲實。又並小頭上﹑下廣﹐以乘小頭深﹐三之﹐爲垣頭冪。又乘袤冪﹐以法除之﹐爲垣方。三因小頭上廣﹐以乘正袤﹐以廣差除之﹐爲都廉﹐從。開立方除之﹐卽得小頭袤﹐爲甲袤。求深﹑廣﹐以本袤及深廣差求之。以兩頭上廣差乘甲袤﹐以本袤除之﹐所得加小頭上廣﹐卽甲上廣。以小頭深減南頭深﹐余以乘甲袤﹐以本袤除之﹐所得加小頭深﹐卽甲深。又正袤自乘﹐深差自乘﹐並﹐而開方除之﹐卽斜袤。若求乙﹑丙﹑丁﹐每以前大深﹑廣爲後小深﹑廣﹐準甲求之﹐卽得。

求漘上廣﹐術曰﹕以程功乘總人﹐又以限日乘之﹐爲積。六因之﹐爲實。以正袤除之﹐又以髙除之﹐所得以下廣減之﹐余又半之﹐卽漘上廣。

假令四郡輸粟﹐斛法二尺五寸﹐一人作功爲均。自上給甲﹐以次與乙。其甲郡輸粟三萬八千七百四十五石六斗﹐乙郡輸粟三萬四千九百五石六斗﹐丙郡輸粟﹐二萬六千二百七十石四斗﹐丁郡輸粟一萬四千七十八石四斗。四郡共穿窖﹐上袤多於上廣一丈﹐少於下袤三丈﹐多於深六丈﹐少於下廣一丈。各計粟多少﹐均出丁夫。自穿﹑負﹑築﹐冬程人功常積一十二尺﹐一日役。問﹕窖上下廣﹑袤﹑深﹐郡別出人及窖深﹑廣各多少﹖

答曰﹕

窖上廣八丈﹐

上袤九丈﹐

下廣一十丈﹐

下袤一十二丈﹐

深三丈﹔

甲郡八千七十二人﹐

深一十二尺﹐

下袤一十丈二尺﹐

廣八丈八尺﹔

乙郡七千二百七十二人﹐

深九尺﹐

下袤一十一丈一尺﹐

廣九丈四尺﹔

丙郡五千四百七十三人﹐

深六尺﹐下袤一十一丈七尺﹐

廣九丈八尺﹔

丁郡二千九百三十三人﹐

深三尺﹐

下袤一十二丈﹐

廣一十丈。

求窖深﹑廣﹑袤﹐術曰﹕以斛法乘總粟﹐爲積尺。又廣差乘袤差﹐三而一﹐爲隅陽冪。乃置塹上廣﹐半廣差加之﹐以乘塹上袤﹐爲隅頭冪。又半袤差﹐乘塹上廣﹐以隅陽冪及隅頭冪加之﹐爲方法。又置塹上袤及塹上廣﹐並之﹐爲大廣。又並廣差及袤差﹐半之﹐以加大廣﹐爲廉法﹐從。開立方除之﹐卽深。各加差﹐卽合所問。

求均給積尺受廣﹑袤﹑深﹐術曰﹕如築臺術入之。以斛法乘甲郡輸粟﹐爲積尺。又三因﹐以深冪乘之﹐以廣差乘袤差而一﹐爲實。深乘上廣﹐廣差而一﹐爲上廣之髙。深乘上袤﹐袤差而一﹐爲上袤之髙。上廣之髙乘上袤之髙﹐三之﹐爲方法。又並兩髙﹐三之﹐二而一﹐爲廉法﹐從。開立方除之﹐卽甲深。以袤差乘之﹐以本深除之﹐所加上袤﹐卽甲下袤。以廣差乘之﹐本深除之﹐所得加上廣﹐卽甲下廣。若求乙﹑丙﹑丁﹐每以前下廣﹑袤爲後上廣﹑袤﹐以次皆準此求之﹐卽得。若求人數﹐各以程功約當郡積尺。

假令亭倉上小下大﹐上下方差六尺﹐髙多上方九尺﹐容粟一百八十七石二斗。今已運出五十石四斗。問﹕倉上下方﹑髙及余粟深﹑上方各多少﹖

答曰﹕

上方三尺﹐

下方九尺﹐

髙一丈二尺﹔

余粟深﹑上方俱六尺。

求倉方﹑髙﹐術曰﹕以斛法乘容粟﹐爲積尺。又方差自乘﹐三而一﹐爲隅陽冪。以乘截髙﹐以減積﹐余爲實。又方差乘截髙﹐加隅陽冪﹐爲方法。又置方差﹐加截髙﹐爲廉法﹐從。開立方除之﹐卽上方。加差﹐卽合所問。

求余粟髙及上方﹐術曰﹕以斛法乘出粟﹐三之﹐以乘髙冪﹐令方差冪而一﹐爲實﹝此是大﹑小髙各自乘﹐各乘取髙。是大髙者﹐卽是取髙與小髙並﹞。髙乘上方﹐方差而一﹐爲小髙。令自乘﹐三之﹐爲方法。三因小髙﹐爲廉法﹐從。開立方除之﹐得取出髙。以減本髙﹐余卽殘粟髙。置出粟髙﹐又以方差乘之﹐以本髙除之﹐所得加上方﹐卽余粟上方﹝此本術曰﹕上下方相乘﹐又各自乘﹐並以髙乘之﹐三而一。今還元﹐三之﹐又髙冪乘之﹐差冪而一﹐得大小髙相乘﹐又各自乘之數。何者﹖若髙乘下方﹐方差而一﹐得大髙也。若髙乘上方﹐方差而一﹐得小髙也。然則斯本下方自乘﹐故須髙自乘乘之﹐差自乘而一﹐卽得大髙自乘之數。小髙亦然。凡大髙者﹐卽是取髙與小髙並相連。今大髙自乘爲大方。大方之內卽有取髙自乘冪一﹐隅頭小髙自乘冪一。又其兩邊各有以取髙乘小髙﹐爲冪二。又大小髙相乘﹐爲中方。中方之內卽有小髙乘取髙冪一。又小髙自乘﹐卽是小方之冪又一。則小髙乘大髙﹐又各自乘三等冪﹐皆以乘取髙爲立積。故三因小冪爲方﹐及三小髙爲廉也﹞。

假令芻甍上袤三丈﹐下袤九丈﹐廣六丈﹐髙一十二丈。有甲縣六百三十二人﹐乙縣二百四十三人。夏程人功當積三十六尺﹐限八日役。自穿築﹐二縣共造。今甲縣先到。問﹕自下給髙﹑廣﹑袤﹑各多少﹖

答曰﹕

髙四丈八尺﹐

上廣三丈六尺﹐

袤六丈六尺。

求甲縣均給積尺受廣﹑袤﹐術曰﹕以程功乘乙縣人數﹐又以限日乘之﹐爲積尺。以六因之﹐又髙冪乘之﹐又袤差乘廣而一﹐所得又半之﹐爲實。髙乘上袤﹐袤差而一﹐爲上袤之髙。三因上袤之髙﹐半之﹐爲廉法﹐從。開立方除之﹐得乙髙。以減甍髙﹐余卽甲髙。求廣﹑袤﹐依率求之﹝此乙積本倍下袤﹐上袤從之。以下廣及髙乘之﹐六而一﹐爲一甍積。今還元須六因之﹐以髙冪乘之﹐爲實。袤差乘廣而一﹐得取髙自乘以乘三上袤之髙﹐則三小髙爲廉法﹐各以取髙爲方。仍有取髙爲立方者二﹐故半之﹐爲立方一。又須半廉法﹞。

假令圓囤上小下大﹐斛法二尺五寸﹐以率徑一周三。上下周差一丈二尺﹐髙多上周一丈八尺﹐容粟七百五斛六斗。今已運出二百六十六石四斗。問﹕殘粟去口﹑上下周﹑髙各多少﹖

答曰﹕

一周一丈八尺﹐

下周三丈﹐

髙三丈六尺﹐

去口一丈八尺﹐

粟周二丈四尺。

求圓囤上下周及髙﹐術曰﹕以斛法乘容粟﹐又三十六乘之﹐三而一﹐爲方亭之積。又以周差自乘﹐三而一﹐爲隅陽冪。以乘截髙﹐以減亭積﹐余爲實。又周差乘截髙﹐加隅陽冪﹐爲方法。又以周差加截髙﹐爲廉法﹐從。開立方除之﹐得上周。加差﹐而合所問。

求粟去口﹐術曰﹕以斛法乘出斛﹐三十六乘之﹐以乘髙冪﹐如周差冪而一﹐爲實。髙乘上周﹐周差而一﹐爲小髙。令自乘﹐三之﹐爲方法。三因小髙﹐爲廉法﹐從。開立方除之﹐卽去口﹝三十六乘訖﹐卽是截方亭﹐與前方窖不別﹞。置去口﹐以周差乘之﹐以本髙除之﹐所得加上周﹐卽粟周。

假令有粟二萬三千一百二十斛七斗三升﹐欲作方倉一﹐圓窖一﹐盛各滿中而粟適盡。令髙﹑深等﹐使方面少於圓徑九寸﹐多於髙二丈九尺八寸﹐率徑七﹐周二十二。問﹕方﹑徑﹑深多少﹖

答曰﹕

倉方四丈五尺三寸﹝容粟一萬二千七百二十二斛九斗五升八合﹞﹐

窖徑四丈六尺二寸﹝容粟一萬三百九十七石七斗七升二合﹞﹐

髙與深各一丈五尺五寸。

求方﹑徑髙深﹐術曰﹕十四乘斛法﹐以乘粟數﹐二十五而一﹐爲實。又倍多加少﹐以乘少數﹐又十一乘之﹐二十五而一﹐多自乘加之﹐爲方法。又倍少數﹐十一乘之﹐二十五而一﹐又倍多加之﹐爲廉法﹐從。開立方除之﹐卽髙﹑深。各加差﹐卽方徑﹝一十四乘斛法﹐以乘粟爲積尺。前一十四餘﹐今還元﹐一十四乘。爲徑自乘者﹐是一十一﹔方自乘者﹐是一十四。故並之爲二十五。凡此方﹑圓二徑長短不同﹐二徑各自乘爲方﹐大小各別。然則此塹方二丈九尺八寸﹐塹徑三丈七寸﹐皆成方面。此應塹方自乘﹐一十四乘之﹔塹徑自乘﹐一十一乘之﹐二十五而一﹐爲隅冪﹐卽方法也。但二隅冪皆以塹數爲方面。今此術就省﹐倍小隅方﹐加差爲矩袤﹐以差乘之爲矩冪。一十一乘之﹐二十五而一。又差自乘之數﹐卽是方圓之隅同有此數﹐若二十五乘之﹐還須二十五除。直以差自乘加之﹐故不復乘除。又須倍二廉之差﹐一十一乘之﹐二十五而一﹐倍差加之﹐爲廉法﹐不復二十五乘除之也﹞。

還元﹐術曰﹕倉方自乘﹐以髙乘之﹐爲實。圓徑自乘﹐以深乘之﹐一十一乘﹐一十四而一﹐爲實。皆爲斛法除之﹐卽得容粟﹝斛法二尺五寸﹞。

假令有粟一萬六千三百四十八石八斗﹐欲作方倉四﹑圓窖三﹐令髙﹑深等﹐方面少於圓徑一丈﹐多於髙五尺﹐斛法二尺五寸﹐率徑七﹐周二十二。問﹕方﹑髙﹑徑多少﹖

答曰﹕

方一丈八尺﹐

髙深一丈三尺﹐

圓徑二丈八尺。

術曰﹕以一十四乘斛法﹐以乘粟數﹐如八十九而一﹐爲實。倍多加少﹐以乘少數﹐三十三乘之﹐八十九而一﹐多自乘加之﹐爲方法。又倍少數﹐以三十三乘之﹐八十九而一﹐倍多加之﹐爲廉法﹐從。開立方除之﹐卽髙﹑深。各加差﹐卽方徑﹝一十四乘斛法﹐以乘粟﹐爲徑自乘及方自乘數與前同。今方倉四﹐卽四因十四。圓窖三﹐卽三因十一。並之﹐爲八十九﹐而一。此塹徑一丈五尺﹐塹方五尺﹐以髙爲立方。自外意同前﹞。

假令有粟三千七十二石﹐欲作方倉一﹑圓窖一﹐令徑與方等﹐方於窖深二尺﹐少於倉髙三尺﹐盛各滿中而粟適盡﹝圓率﹑斛法並與前同﹞。問﹕方﹑徑﹑髙﹑深各多少﹖

答曰﹕

方﹑徑各一丈六尺﹐

髙一丈九尺﹐

深一丈四尺。

術曰﹕三十五乘粟﹐二十五而一﹐爲率。多自乘﹐以並多少乘之﹐以乘一十四﹐如二十五而一﹐所得以減率﹐余爲實。並多少﹐以乘多﹐倍之﹐乘一十四﹐如二十五而一﹐多自乘加之﹐爲方法。又並多少﹐以乘一十四﹐如二十五而一﹐加多加之﹐爲廉法﹐從。開立方除之﹐卽窖深。各加差﹐卽方﹑徑﹑髙﹝截髙五尺﹐塹徑及方二尺﹐以深爲立方。十四乘斛法﹐故三十五乘粟。多自乘並多少乘之﹐爲截髙隅積﹐卽二廉﹐方各二尺﹐長五尺。自外意旨皆與前同﹞。

假令有粟五千一百四十石﹐欲作方窖﹑圓窖各一﹐令口小底大﹐方面於圓徑等﹐兩深亦同﹐其深少於下方七尺﹐多於上方一丈四尺﹐盛各滿中而粟適盡﹝圓率﹑斛法並與前同﹞。問﹕方﹑徑﹑深各多少﹖

答曰﹕

上方﹑徑各七尺﹐

下方﹑徑各二丈八尺﹐

深各二丈一尺。

術曰﹕以四十二乘斛法﹐以乘粟﹐七十五而一﹐爲方亭積。令方差自乘﹐三而一﹐爲隅陽冪﹐以截多乘之﹐減積﹐余爲實。以多乘差﹐加冪﹐爲方法。多加差﹐爲廉法﹐從。開立方除之﹐卽上方。加差﹐卽合所問﹝凡方亭﹐上下方相乘﹐又各自乘﹐並以乘髙﹐爲虛。命三而一﹐爲方亭積。若圓亭上下徑相乘﹐又各自乘﹐並以乘髙﹐爲虛。又十一乘之﹐四十二而一﹐爲圓亭積。今方﹑圓二積並在一處﹐故以四十二復乘之﹐卽得圓虛十一﹐方虛十四﹐凡二十五﹐而一﹐得一虛之積。又三除虛積﹐爲方亭實。乃依方亭復問法﹐見上下方差及髙差與積求上下方髙術入之﹐故三乘﹐二十五而一﹞。

假令有粟二萬六千三百四十二石四斗﹐欲作方窖六﹑圓窖四﹐令口小底大﹐方面與圓徑等﹐其深亦同﹐令深少於下方七尺﹐多於上方一丈四尺﹐盛各滿中而粟適盡﹝圓率﹑斛法並與前同﹞。問上下方﹑深數各多少﹖

答曰﹕

方窖上方七尺﹐

下方二丈八尺﹐

深二丈一尺﹐

圓窖上下徑﹑深與方窖同。

術曰﹕以四十二乘斛法﹐以乘粟﹐三百八十四而一﹐爲方亭積尺。令方差自乘﹐三而一﹐爲隅陽冪。以多乘之﹐以減積﹐余爲實。以多乘差﹐加冪﹐爲方法。又以多加差﹐爲廉法﹐從。開立方除之﹐卽上方。加差﹐卽合所問﹝今以四十二乘。圓虛十一者四﹐方虛十四者六﹐合一百二十八虛﹐除之﹐爲一虛之積。得者仍三而一﹐爲方亭實積。乃依方亭見差復問求之﹐故三乘﹐一百二十八除之﹞。

假令有句股相乘冪七百六十五分之一﹐弦多於句三十六十分之九。問﹕三事各多少﹖

答曰﹕

句十四二十分之七﹐

股四十九五分之一﹐

弦五十一四分之一。

術曰﹕冪自乘﹐倍多數而一﹐爲實。半多數﹐爲廉法﹐從。開立方除之﹐卽句。以弦多句加之﹐卽弦。以句除冪﹐卽股﹝句股相乘冪自乘﹐與句冪乘股冪積等。故以倍句弦差而一﹐得一句與半差之共乘句冪﹐爲方。故半差爲廉法﹐從﹐開立方除之。按﹕此術原本不全﹐今依句股義擬補十三字﹞。

假令有句股相乘冪四千三十六五分之�﹐股少於弦六五分之一。問﹕弦多少﹖﹝按﹕此問原本缺二字﹐今依文補一股字﹐其股字上之�系所設分數﹐未便懸擬﹐今姑闕之﹞。

答曰﹕弦一百一十四十分之七。

術曰﹕冪自乘﹐倍少數而一﹐爲實。半少﹐爲廉法﹐從。開立方除之﹐卽股。加差﹐卽弦。

假令有句弦相乘冪一千三百三十七二十分之一﹐弦多股一﹑十分之一。問﹕股多少﹖

答曰﹕九十二五分之二。

術曰﹕冪自乘﹐倍多而一﹐爲立冪。又多再自乘﹐半之﹐減立冪﹐余爲實。又多數自乘﹐倍之﹐爲方法。又置多數﹐五之﹐二而一﹐爲廉法﹐從。開立方除之﹐卽股﹝句弦相乘冪自乘﹐卽句冪乘弦冪之積。故以倍股弦差而一﹐得一股與半差�����爲方令多再自乘半之爲隅�����橫虛二立廉�����������倍之爲從隅�����������多爲上廣卽二多���������法故五之二而一﹞。

案﹕此術脫簡旣多﹐法亦煩擾﹐宜云冪自乘﹐多數而一﹐所得四之﹐爲實。多爲廉法﹐從。立方開之﹐得減差﹐半之﹐卽股﹝冪自乘﹐與勾冪弦冪相乘積等。令勾冪變爲股弦並乘股弦差﹐故差而一﹐所得乃股弦並乘弦冪﹞。

假令有股弦相乘冪四千七百三十九五分之三﹐句少於弦五十四五分之二。問﹕股多少﹖

答曰﹕六十八。

術曰﹕冪自乘﹐倍少數而一﹐爲立冪。又少數再自乘﹐半之﹐以減立冪﹐余爲實。又少數自乘﹐倍之﹐爲方法。又置少數﹐五之﹐二而一﹐爲廉法﹐從。開立方除之﹐卽句。加差﹐卽弦。弦除冪﹐卽股。

假令有股弦相乘冪七百二十六﹐句七﹑十分之七。問﹕股多少﹖

答曰﹕股二十六五分之二。

術曰﹕冪自乘﹐爲實。句自乘﹐爲方法﹐從。開方除之﹐所得又開方﹐卽股﹝��������������數亦是股������������爲長以股������������得股冪又開�����������股北分母常……﹞

假令有股十六二分之一﹐句弦相乘冪一百六十四二十五分之十四。問﹕句多少﹖

答曰﹕句八﹑五分之四。

術曰﹕冪自乘﹐爲實。股自乘﹐爲方法﹐從。開方除之﹐所得又開方﹐卽句。

緝古算經跋

按《唐書﹟選舉志》制科之目﹐明算居一﹐其定制云﹕凡算學﹐孫子﹑五曹共限一歲﹐九章﹑海島共三歲﹐張邱建﹑夏侯陽各一歲﹐周髀﹑五經算共一歲﹐綴術四歲﹐緝古三歲﹐記遺三等數皆兼習之。竊惟數學爲六藝之一﹐唐以取士共十經。周髀家塾曾刊行之﹐余則世有不能舉其名者。扆半生求之﹐從太倉王氏得孫子﹑五曹﹑張邱建﹑夏侯陽四種﹐從章邱李氏得周髀﹑緝古二種﹐後從黃兪邰又得九章。皆元丰七年祕書省刊板﹐字書端楷﹐雕鏤精工﹐眞世之寶也。每捲後有祕書省官銜姓名一幅﹐又一幅宰輔大臣﹐自司馬相公而下俱列名於後﹐用見當時鄭重若此。因求善書者刻畫影摹﹐不爽毫末﹐什襲而藏之。但焉得海島﹑五經﹑綴術三種﹐竟成完璧﹐並得好事者刊刻流布﹐俾數學不絕於世﹐所深願也。

康熙甲子仲秋汲古後人毛扆謹識

