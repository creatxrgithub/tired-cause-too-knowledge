

欽定四庫全書

子部六

歷算全書

天文算法類一【推步之屬】提要

【臣】等謹歷算全書六十卷

國朝梅文鼎撰文鼎字定九宣城人篤志嗜古尢精歷算之學康熙四十一年大學士李光地嘗以其歷學疑問進呈防

聖祖仁皇帝南巡於徳州

召見

禦書積學參微四字賜之以年老遣歸嗣

詔修樂律曆算書下江南總督徵其孫防成入侍直

律呂正義書成復驛致

命校勘後年九十餘終於家

特命織造曹頫爲經紀其防至今傳爲稽古之至榮所著歷算諸書李光地嘗刻其七種餘多晚年纂述或已訂成帙或略具艸稿魏荔彤求得其本以屬無錫楊作枚校正作枚遂附以已說並爲補所未備而刋行之凡二十九種名之曰歷算全書然序次錯雜未得要領謹重加編次以立歷者居前而以言算者列於後首曰歷學疑問論歷學古今疏宻及中西二法與回回歷之異同卽嘗防

聖祖仁皇帝親加定者謹以冠之簡編次曰歷學疑問補亦雜論歷法綱領次曰歷學答問乃與一時公卿大夫以歷法往來問答之辭次曰弧三角舉要乃用渾象表弧三角之形式次曰環中黍尺乃弧三角以角代算之法次曰歲周地度合考乃考髙卑嵗實及西國年月地度弧角裏差次曰平立定三差說推七政贏縮之故次曰冬至考用統天大明授時三法考春秋以來冬至次曰諸方日乃以北極髙二十度至四十二度各地日按時節爲立成表次曰五星紀要總論五星行度次曰火星本法専論火星遲疾次曰七政細艸載推步日月五星法及恆星交宮過度之術次曰揆日星紀要列直江南河南陜西四省表景並三垣列宿經緯定爲立成表次曰二銘補注解仰儀銘簡儀銘次曰歷學駢枝乃所注大統歷法次曰交防管見乃以交食方位向稱南北東西者攺爲上下左右次曰交食防求乃推算法數次曰古算衍略次曰籌算次曰茟算次曰度算釋例俱爲步算之根源次曰方程論次曰勾股闡微次曰三角法舉要次曰觧割圜之根次曰方圓幕積次曰防何補編次曰少廣拾遺次曰塹堵測量皆以推闡算法或衍九章之未備或著今法之形或論中西形體之變化或釋弧矢勾股八綫之比例蓋歷算之術至是而大備矣我

國家修明律數探賾索隠集千古之大成文鼎以艸野書生乃能覃思切究洞悉源流其所論著皆足以通中西之防而折今古之中自郭守敬以來罕見其比其受

聖天子特逹之知固非偶然矣乾隆四十六年十月

恭校上

總纂官【臣】紀昀【臣】陸錫熊【臣】孫士毅

總校

官【臣】陸

費墀

壬午十月扈

駕南巡駐

蹕徳州有

防取所刻書集回奏匆遽未曽攜帶且多系經書制舉

時文應塾校之需不足塵

覽有宣城處士梅文鼎歷學疑問三卷【臣】所訂刻謹呈

求

聖誨奉

防朕畱心歷算多年此事朕能決其是非將書畱覽再

發二日後承

召面見

上云昨所呈書甚細心且議論亦公平此人用力深矣

朕帶回宮中仔細看閱【臣】因求

皇上親加禦筆批駮攺定庶艸野之士有所取裁【臣】亦

得以預聞一二不勝幸甚

上肯之越明年春

駕復南巡遂於

行在發回原書

面諭朕已細細看過中間圏塗抹及簽貼批語皆上手筆也臣復請此書疵繆所在

上云無疵繆但算法未備蓋梅書原未完成

聖諭遂及之竊惟自古懷抱道業之士承詔有所述作者無論已若乃私家蔵錄率多塵埋瓿覆至歷象天官之奧尢世儒所謂專門絕學者蓋自好事耽奇之徒往往不能竟篇而罷曷能上煩

乙夜之觀句譚字議相酬酢如師弟子梅子之遇可謂

千載一時方今

宸翰流行天下獨未有裁自

聖手之書蓄於人間者豈特若洛下之是非堅定而子云遺編所謂遭遇時君度越諸子者亦無待乎桓譚之屢嘆矣旣以書歸之梅子而爲敍其時月因起俾梅寶奉焉甲申五月壬戌【臣】李光地恭記

序

歷學疑問梅子定九之所著也先生於是學覃思博考四十年餘凡所撰述滿家自專門者不能殫覽也余謂先生宜撮其指要束文伸義章縫之士得措心焉夫列代史誌掀及律曆則幾而不視況一家之書哉先生肯餘言以受館之暇爲之論百十篇而托之疑者或曰子之彊梅子以成書也於學者信乎當務歟曰疇人星官之所專司不急可也夫梅子之作辧於理也理可不知乎乾坤父母也繼志述事者不離乎動靜居息色笑之間故書始歷象詩詠時物禮分方設官春秋以時紀事易觀於陰陽而立卦合乎嵗閏以生蓍其所謂秩敍命討好惡美刺治教兵刑朝防摟伐建侯遷國之大涉川畜牝之細根而本之則始於太乙而殽於陰陽日星以爲紀月以爲量四時以爲柄鬼神以爲徒故曰思知人不可以不知天仰則觀於天文窮理之事也此則儒者所宜盡心也聖之多才藝而精創作必稱周公自大司徒土圭之法周髀蓋天之制後世少有知者漢唐而下最著者數家率推一時一處以爲定論其有四出測逾數千里則已度越古今而未能包八極以立說海外之士乘之眞謂吾書之所未有微言旣逺冺冺棼棼可勝詰哉梅子閔焉稽近不遺矣而源之務索其言之成則援

熙朝之歷以合於軒姬虞夏洙泗閩洛冺然也此固我皇上膺歷在躬妙極道數故艸野之下亦篤生異士見知而與聞之而梅子用心之勤不憚探賾表微以歸於至當一書之中述聖尊王兼而有焉昔劉歆三統文具漢志子云太平子以爲漢家得嵗二百年之書也彼劉揚烏知天皆據洛下一家法而傅防以經義云爾今先生之論羅罔千載明

皇歷之得天卽象見理綜數歸道異日蘭臺編次必有取焉七政三統殆不足儗而書體簡實平易不爲枝離佶屈吾知其說亦大行於經生家非如太之覆醤瓿者

而終不顯矣先生之歸也謂余敍之餘不足以知歷姑敍其大意以質知先生者先生續且爲之圖表數術以繼斯捲余猶得竟學而觀厥成焉淸溪李光地書

欽定四庫全書

歷算全書卷一

宣城梅文鼎撰

歷學疑問一

論歷學古疏今密

問三代典制厄於秦火故儒者之論謂古歷宜有一定不變之法而不可復考後之人因屢變其法以求之蓋至於今日之宻合而庶幾克復古聖人之舊非古疏而今密也曰聖人言治歷明時蓋取於革故治歷者當順天以求合不當爲合以驗天若預爲一定之法而不隨時修攺以求無獘是爲合以驗天矣又何以取於革乎且吾嘗徴之天道矣日有朝有禺有中有昃有夜有晨此歷一日而可知者也月有朔有生明有有望有生魄有下有晦此歷一月而可知者也時有春夏秋冬晝夜有永短中星有推移此歷一嵗而可知者也乃若熒惑之周天則歷二年嵗星則十二年土星則二十九年【皆約整數】夫至於十二年二十九年而一周已不若前數者之易見矣又其毎周之間必有過不及之餘分所差甚防非歷多周豈能灼見乃若嵗差之行六七十年始差一度歷二萬五千餘年而始得一周𨿽有期頤上壽所見之差不過一二度亦安從辧之迨其歷年旣久差數愈多然後共見而差法立焉此非前人之智不若後人也前人不能預見後來之差數而後人則能盡考前代之度分理愈久而愈明法愈修而愈密勢則然耳問者曰若是則聖人之智有所窮歟曰使聖人爲一定之法則窮矣惟聖人深知天載之無窮而不爲一定之法必使隨時修攺以求合天是則合天下萬世之聰明以爲其耳目聖人之所以不窮也然則歷至今日而愈密者皆聖人之法之所該矣

論中西二法之同

問者曰天道以久而明歷法以修而密今新曆入而盡變其法以從之則前此之積舉不足用乎曰今之用新曆也乃兼用其長以補舊法之未備非盡廢古法而従新術也夫西曆之同乎中法者不止一端其言日五星之髙加減也卽中法之盈縮歷也在太陰則遲疾歷也其言五星之嵗輪也卽中法之段目也【遲畱逆伏】其言恆星東行也卽中法之嵗差也其言節气之以日躔過宮也卽中法之定气也其言各省直節气不同也卽中法之裏差也但中法言盈縮遲疾而西說以最髙最卑明其故中法言段目而西說以嵗輪明其故中法言嵗差而西說以恆星東行明其故是則中歷所著者當然之運而西曆所推者其所以然之源此其可取者也若夫定气裏差中歷原有其法但不以注歷耳非古無而今始有也西曆始有者則五星之緯度是也中歷言緯度惟太陽太陰有之【太陽出入於赤道其緯二十四度太陰出入於黃道其緯六度】而五星則未有及之者今西曆之五星有交防有緯行亦如太陽太陰之詳明是則中歷缺陷之大端得西法以補其未備矣夫於中法之同者旣有以明其所以然之故而於中法之未備者又有以補其缺於是吾之積者得彼說而益信而彼說之若難信者亦因吾之積而有以知其不誣𨿽聖人復起亦在所兼收而亟取矣

論中西之異

問今純用西法矣若子之言但兼用其長耳豈西法亦有大異於中而不可全用抑吾之用之者猶有未盡歟曰西法亦有必不可用者則正朔是也中法以夏正爲嵗首此萬世通行而無獘者也西之正朔則以太陽防恆星爲嵗其正月一日定於太陽躔斗四度之日而恆星旣東行以生嵗差則其正月一日亦屢變無定故在今時之正月一日定於冬至後十一日溯而上之可七百年則其正月一日在冬至日矣又溯而上之七百年又在冬至前十日矣由今日順推至後七百年則又在冬至後二十日矣如是不定安可以通行乎此徐文定公造曆書之時棄之不用而亦略不言及也然則自正朔外其餘盡同乎曰正朔其大者也余不同者尙多試略舉之中法步月離始於朔而西法始於望一也中法論日始子半而西法始午中二也中法立閏月而西法不立閏月惟立閏日三也黃道十二象與二十八捨不同四也余星四十八象與中法星名無一同者五也中法紀日以甲子六十日而周西法紀日以七曜凡七日而周六也中法紀嵗以甲子六十年而周西法紀年以以總積六千餘年爲數七也中法節气起冬至而西法起春分八也以上數端皆今歷所未用徐文定公所謂鎔西算以入大綂之型模蓋謂此也【就中推閏日用之於恆表積數而不廢閏月猶弗用也其總積之年曆指中偶一舉之而不以紀嵗】

論今法於西曆有去取之故

問者曰皆西法也而有所棄取何也曰凡所以必用西法者以其測算之精而己非好其異也故凡髙卑加減黃道經緯之屬皆其測算之根而不得不用者也若夫測算之而旣合矣則紀日於午何若紀於子之善也紀月於朢何若紀於朔之善也四十八象十二象之星名與三垣二十八宿𨿽離合不同而其星之大小逺近在天無異也又安用此紛紛乎此則無闗於測算之用者也乃若正朔之頒爲國家禮樂刑政之所出聖人之所定萬世之所遵行此則其必不可用而不用者也又何惑焉

論回回歷與西洋同異

問回回亦西域也何以不用其歷而用西洋之歷曰回回歷與歐羅巴【卽西洋歷】同源異派而疏宻殊故回回歷亦有七政之髙以爲加減之根又皆以小輪心爲平行其命度也亦起春分其命日也亦起午正其算太陰亦有第一加減第二加減算交食三差亦有九十度限亦有影徑分之大小亦以三百六十整度爲周天亦以九十六刻爲日亦以六十分爲度六十秒爲分而逓析之以至於防亦有閏日而無閏月亦有五星緯度及交道亦以七矅紀日而不用干支其立象也亦以東方地平爲命宮其黃道上星亦有白羊金牛等十二象而無二十八宿是種種者無一不與西洋同故曰同源也然七政有加減之小輪而無均輪太陰有倍離之經差加減而無交均之緯差故愚嘗謂西曆之於回回猶授時之於紀元統天其疏密固較然也然在洪武間未嘗不密其西域大師馬哈麻馬沙亦黒頗能精於其術但深自祕惜又不著立表之根後之學者失其本法之用反借大統春分前定气之日以爲立算之基何怪其久而不效耶然其法之善者種種與西法同今用西法卽用回回矣豈有所取舎於其間哉【按回回古稱西域自明鄭和奉使入洋以其非一國槪稱之曰西洋厥後歐羅巴入中國自稱大西洋謂又在回回西也今曆書題曰西洋新法蓋回回歷卽西洋舊法耳論中舉新法皆曰歐羅巴不敢混稱西洋所以別之也】

論回回歷歷元用截法與授時同

問論者謂回回歷元在千餘年之前故久而不可用其說然歟曰回回曆書以隋開皇己未爲元謂之阿刺必年然以法求之實用洪武甲子爲元而托之於開皇己未耳何以知之蓋回回歷有太陽年太陰年自洪武甲子逆溯開皇己未距算七百八十六此太陽年也而回回歷立成所用者太陰年也回回歷太陰年至第一月一日與春分同日之年則加一嵗約爲三十二三年而積閏月十二所謂應加次數也然則洪武甲子以前距算七百八十六年當有應加閏月之年二十四次而今不然卽用距算查表至八百一十七算之時始加頭一次然則此二十四个閏年之月日將何所歸乎故知其卽以洪武甲子爲元也惟其然也故其總年立成皆截從距開皇六百年起其前皆缺蓋皆不用之數也然則何以不竟用七百八十算爲立成起處而用六百年曰所以塗人之耳目也又最髙行分自六百六十算而變以前則漸減以後則漸增其減也自十度以至初度其增也又自初度而漸加此法中歷所無故存此以見意也【初度者蓋指巨蠏初防惟六百六十算之年最髙與此防合以嵗計之當在洪武甲子年前一百二十六算其前漸減者蓋是未到巨蠏之度故漸減也】由是言之其算宮分𨿽以開皇己未爲元而其查立成之根則在己未元後二十四年【卽立成所謂一年】旣退下二十四年故此二十四次應加之數可以不加自此以後則皆以春分所入月日挨求亦可不必細論惟至閏滿十二个月之年乃加一次此其巧防之法也然則其不用積年而截取現在爲元者固與授時同法矣

論天地人三元非回回本法

問治回回歷者謂其有天地人三元之法天元謂之大元地元謂之中元人元謂之小元而以己未爲元其簡法耳以子言觀之其說非歟曰天地人三元分算乃吳郡人陳壤所立之率非回回法也【陳星川名壤袁了凡師也嘉靖間曽上疏攺歷而格不行】其說謂天地人三元各二千四百一十九萬二千年今嘉靖甲子在人元己歷四百五十六萬六千八百四十算所以爲此迂逺之數者欲以求太乙數之周紀也【按太史王肯堂筆廛云太乙多不能算歷故以歷法求太乙多不合惟陳星川之太乙與歷法合】然其立法皆截去萬以上數不用故各種立成皆止於千其爲虛立無用之數可知矣夫三式之有太乙不過占家一種之書初無闗於歷算乂其立法以六十年爲紀七十二年爲元五元則三百六十年謂之周紀純以干支爲主而西域之法不用干支安得有三元之法乎今天地人三元之數現在歷法新書初未嘗言其出於回回也蓋明之知回回歷者莫精於唐荊川順之陳星川壤兩公而取唐之說以成書者爲周云淵述學述陳之學以爲書者爲袁了凡黃然云淵歷宗通議中所述荊川精語外別無發眀【有歷宗中經余未見】而荊川亦不知最髙爲何物【唐荊川曰要求盈縮何故減那最髙行度只爲嵗差積久年年欠下盈縮分數以此補之云云是未明厥故也】若云淵則直以毎日日中之晷景當髙尢爲臆說矣了凡新書通回回之立成於大統可謂苦心然竟削去最髙之算又直用大統之嵗余而棄授時之消長將逆推數百年亦已不效況數千萬年之久乎人惟見了凡之書多用回回法遂誤以爲西域土盤本法耳又若薛儀甫鳳祚亦近日西學名家也其言回回歷乃謂以己未前五年甲寅爲元此皆求其說不得而彊爲之解也總之回回歷以太陰年列立成而又以太陽年查距算巧藏其根故𨿽其專門之裔且不能知無論他人矣【查開皇甲寅乃回教中所彼國聖人辭世之年故用以紀嵗非歷元也薛儀甫蓋以此而誤】

論回回歷正朔之異

問回回歷有太陽年又有太陰年其國之紀年以何爲定乎曰回回國太陰年謂之動的月其法三十年閏十一日而無閏月惟以十二个月爲一年【無閏則三百五十四日有閏則三百五十五日】故遇中國有閏月之年則其正月移早一月【如首年春分在第一月遇閏則春分在第二月而移其春分之前月爲第一月】故曰動的月其太陽年則謂之不動的月其法以一百二十八年而閏三十一日皆以太陽行三十度爲一月卽中歷之定气其白羊初卽爲第一月一日嵗嵗爲常故曰不動的月也然其紀嵗則以太陰年而不用太陽年此其異於中歷而並異於歐羅巴之一大端也然又有異者其毎嵗齋月又不在第一月而在第九月滿此齋月至第十月一日則相賀如正旦焉不特此也其所謂月一日者又不在朔不在朢而在哉生明之後一日其附近各國皆然瀛涯勝覽諸書可考而知也

馬歡瀛涯勝覽曰占城國無閏月但十二月爲一年晝夜分爲十更用鼓打記又曰阿丹國無閏月气溫和常如八九月惟以十二个月爲一年月之大小若頭夜見新月明日卽月一也又曰榜葛刺國亦無閏月以十二个月爲一年按馬歡自稱防稽山樵曽従鄭和下西洋故書其所見如此蓋其國俱近天方故風俗並同其言月一者卽月之第一日在朔後故不言朔厥後張升攺其文曰以月出定月之大小夜見月明日又爲一月也文句亦通然非月一字義也又按一統志天方國古筠衝之地舊名天堂又名西域有回回歷與中國前後差三日蓋以見新月之明日爲月之一日故差三日○又按素問云一晝一夜五分之隋志云晝有朝有禺有中有晡有夕夜有甲乙丙丁戊則晝夜十更之法中法舊有之○又熊防石島夷志曰舶舟視旁羅之鍼羅羅處甚幽密惟開小扄直舵門燈長燃不分晝夜夜五更晝五更合晝夜十二辰爲十更其鍼路悉有譜按此以十更記程而百刻勻分不論冬夏長短與記裏鼓之意略同若素問隋志所云則以日出入爲斷而晝夜有長短更法因之而變兩法防別占城用鼔打記不知若何要不出此二法

論夏時爲堯舜之道

問古有三正而三王疊用之則正朔原無定也安在用太陰年用恆星年之爲非是乎曰古聖人之作歷也以敬授民時而已天之气始於春盛於夏斂於秋伏藏於冬而萬物之生長收藏因之民事之耕耘收獲因之故聖人作歷以授民時而一切政務皆順時以出令凡郊社禘嘗之禮五祀之祭搜苗狝狩之節行慶施惠決獄治兵之典朝聘之期飲射讀法勸耕省斂土功之事洪纎具舉皆於是乎在故天子以頒諸侯諸侯受而藏諸祖廟以毎月告朔而行之歷之重蓋如是也而顧使其遊移無定何以示人遵守乎如回回歷則毎二三年而其月不同是春可爲夏夏可爲冬也如歐羅巴則毎七十年而差一日積之至久四時亦可互爲矣是故惟行夏之時斯爲堯舜之道大中至正而不可易也然則又何以有三正曰三正𨿽殊而以春爲民事之始則一也故建丑者二陽之月也建子者一陽之月也先王之於民事也必先時而戒事猶之日出而作而又曰雞鳴而起中夜以興雲爾豈若毎嵗遷徙如是其紛紛者哉𨿽其各國之風俗相沿而不自覺然以數者相較而孰爲正大孰爲煩碎則必有辧矣

論語行夏之時古注云據見萬物之生以爲四時之始取其易知

論西曆亦古疏今宻

問中歷古疏今密實由積固己西曆則謂自古及今一無攺作意者其有神授歟曰殆非也西法亦由積而漸至精密耳隋以前西曆未入中國其見於史者在唐爲九執歷在元爲萬年曆在明爲回回歷在

本朝爲西洋歷新法然九執歷課旣疏逺

唐大衍歷旣成而一行卒瞿曇怨不得與攺歷事訟於朝謂大衍寫九執歷未盡其法詔歷官比驗則九執歷課最防

萬年曆用亦不久

元太祖庚辰西徵西域歷人奏五月朢月當蝕耶律楚材曰否卒不蝕明年十月楚材言月當蝕西域人曰不蝕至期果蝕八分

世祖至元四年西域札瑪魯丹撰進萬年曆世祖稍頒行之至十八年攺用授時歷

回回歷明用之三百年後亦漸防

明洪武初設回回司天臺於雨花臺尋罷回回司天監設回回科欽天監毎年西域官生依其本法奏進日月交蝕及五星淩犯等歷

歐羅巴最後出而稱最精豈非後勝於前之明驗歟諸如曆書所述多祿某之法至歌白泥而有所攺訂歌白泥之法至地谷而大有變更至於地谷法略備矣而逺鏡之制又出其後則其爲累測益精大略亦如中法安有所謂神授之法而一成不易者哉是故天有層數西法也而其說或以爲九重或以爲十二重今則以金水太陽共爲一重矣又且以火星衝日之時比日更近而在太陽天之下則九重相裹如蔥頭之說不復可用矣太陽大於地西說也而其初說日徑大於地徑一百六十五倍奇今只算爲五倍奇兩數相懸不啻霄壤矣太陽最髙卑嵗嵗東移西法也然先定二至後九度後攺定爲六度今復移進半度爲七度奇矣又何一非後來居上而謂有神授不由積驗乎

渾蓋通憲定奧日在巨蠏九度卽最髙也其時爲萬曆丁未在戊辰歷元前二十年是利西泰所定厥後曆書定戊辰年最髙衝度在冬至後五度五十九分五十九秒以較萬曆丁未所定之奧日凡攺退三度有奇是徐文定公及湯羅諸西士所定今康熙永年曆法重定康熙戊午髙衝在冬至後七度○四分○四秒以較曆書二百恆年表原定戊午髙衝六度三十七分二十九秒凡移進二十六分三十五秒其書成於曆書戊辰元後五十年是治理歷法南懷仁所定

論地圎可信

問西人言水地合一圓球而四面居人其地度經緯正對者兩處之人以足版相抵而立其說可信歟曰以渾天之理徴之則地之正圓無疑也是故南行二百五十里則南星多見一度而北極低一度北行二百五十里則北極髙一度而南星少見一度若地非正圎何以能然至於水之爲物其性就下四皆天則地居中央爲最下水以海爲壑而海以地爲根水之附地又何疑焉所疑者地旣渾圎則人居地上不能平立也然吾以近事徴之江南北極髙三十二度浙江髙三十度相去二度則其所戴之天頂卽差二度【江南天頂去北極五十八度浙江天頂去北極六十度】各以所居之方爲正則遙防異地皆成斜立又況京師極髙四十度瓊海極髙二十度【京師以去北極五十度之星爲天頂瓊海以去北極七十度之星爲天頂】若自京師而觀瓊海其人立處皆當傾跌【瓊海望京師亦復相同】而今不然豈非首戴皆天足履皆地初無欹側不憂環立歟然則南行而過赤道之表北逰而至戴極之下亦若是已矣是故大戴禮則有曽子之說

大戴禮單居離問於曽子曰天圓而地方誠有之乎曽子曰如誠天圓而地方則是四角之不揜也參嘗聞之夫子曰天道曰圓地道曰方

內經則有岐伯之說

內經黃帝曰地之爲下否乎岐伯曰地爲人之下太虛之中也曰憑乎曰大气舉之也素問又曰立於子而面午立於午而面子皆曰北面立於午而負子立於子而負午皆曰南靣釋之者曰常以天中爲北故對之者皆南也

宋則有邵子之說

邵子觀物篇曰天何依曰依地地何附曰附天曰天地何所依附曰自相依附

程子之說

程明道語錄曰天地之中理必相直則四邊當有空闕處地之下豈無天今所謂地者特於天中一物爾又曰極須爲天下之中天地之中理必相直今人所定天體只是且以眼定視所極處不見遂以爲盡然向曽有於海上見南極下有大星數十則今所見天體蓋未定以土圭之法驗之日月升降不過三萬里中然而中國只到鄯善莎車已是一萬五千里就彼觀日尙只是三萬里中也

地圓之說固不自歐邏西域始也

元西域札瑪魯丹造西域儀像有所謂庫哩葉阿喇斯漢言地裏志也其制以木爲圓毬七分爲水其色緑三分爲土地其色白畫江河湖海貫串於其中畫作小方井以計幅員之廣袤道裏之逺近此卽西說之祖

論蓋天周髀

問有圓地之說則裏差益明而渾天之理益著矣古乃有蓋天之說殆不知而作者歟曰自揚子云諸人主渾天排蓋天而蓋說遂詘由今以觀固可並存且其說實相成而不相悖也何也渾天𨿽立兩極以言天體之圓而不言地圎直謂其正平焉耳若蓋天之說具於周髀其說以天象蓋笠地法覆槃極下地髙滂沲四隤而下則地非正平而有圓象明矣故其言晝夜也曰日行極北北方日中南方夜半日行極東東方日中西方夜半日行極南南方日中北方夜半日行極西西方日中東方夜半凡此四方者晝夜易處加四時相及此卽西曆地有經度以論時刻早晚之法也其言七衡也曰北極之下不生萬物北極左右夏有不釋之冰中衡左右冬有不死之艸五穀一嵗再熟凡北極之左右物有朝生暮獲【趙君卿注曰北極之下從春分至秋分爲晝從秋分至春分爲夜】卽西曆以地緯度分寒暖五帶晝夜長短各處不同之法也使非天地同爲渾圎何以能成此算周髀本文謂周公受於商髙𨿽其詳莫攷而其說固有所本矣然則何以不言南極曰古人著書皆詳於其可見而略於所不見卽如中髙四下之說旣以北極爲中矣而又曰天如倚蓋是亦卽中國之所見擬諸形容耳安得以辭害意哉故寫天地以圓器則蓋之度不違於渾圖星象於平楮則渾之形可存於蓋唐一行善言渾天者也而有作蓋天圗法元郭太史有異方渾蓋圗今西曆有平渾儀皆深得其意者也故渾蓋之用至今日而合渾蓋之說亦至今日而合渾蓋之說亦至今日而益明元札馬魯丁西域儀象有兀速都兒刺不定漢言晝夜時刻之器其制以銅如圓鏡而可掛面刻十二辰位晝夜時刻上加銅條綴其中可以圓轉銅條兩端各屈其首爲二竅以對望晝則視日影夜則窺星辰以定時刻以則休咎背嵌鏡片二面刻其圗凡七以辧東西南北日影長短之不同星辰向背之有異故各異其圖以盡天地之變焉按此卽今渾蓋通憲之制也以平詮渾此爲著

論周髀儀器

問若是則渾蓋通憲卽蓋天之遺制歟抑僅平度均布如唐一行之所云耶曰皆不可考矣周髀但言笠以寫天天靑黒地黃赤天數之爲笠也赤黒爲表丹黃爲裏以象天地之位此蓋寫天之器也今𨿽不以意度之當是圓形如笠而圖度數星象於內其勢與仰觀不殊以視平圗渾象轉爲親切何也星圗彊渾爲平則距度之防密攺觀渾象圖星於外則星形之左右易位若寫天於笠則其圓勢屈而向內星之經緯距皆成弧度與測算脗合勝平圗矣又其星形必在內面則星之上下左右各正其位勝渾象矣

論歷元

問造歷者必先立元元正然後定日法法立然後度周天古歷數十家皆同此術至授時獨不用積年日法何歟曰造歷者必有起算之端是謂歷元然歷元之法有二其一逺溯初古爲七曜齊元之元自漢太初至金重修大明歷各所用之積年是也其一爲截算之元自元授時不用積年日法直以至元辛巳爲元而今西法亦以崇禎戊辰爲元是也二者不同然以是爲起算之端一而已矣則二者無優劣乎曰授時優夫所謂七曜齊元者謂上古之時嵗月日時皆防甲子而又日月如合璧五星如連珠故取以爲造歷之根數也使其果然𨿽萬世遵用可矣乃今卄一史中所載諸家歷元無一同者是其積年之久近皆非有所受之於前直以巧算取之而已然謂其一無所據而出於胸臆則又非也當其立法之初亦皆有所驗於近事然後本其時之所實測以旁證於書之所約其合者旣有數端遂援之以立術於是溯而上之至於數千萬年之逺庶幾各率可以齊同積年之法所由立也然旣欲其上合歷元又欲其不違近測畸零分秒之數必不能齊勢不能不稍爲整頓以求巧合其始也據近測以求積年其旣也且將因積年而攺近測矣又安得以爲定法乎授時歷知其然故一以實測爲憑而不用積年虛率上考下求卽以至元十八年辛巳嵗前天正冬至爲元其見卓矣按唐建中時術者曺士蔿始變古法以顯慶五年爲上元雨水爲嵗首號符天歷行於民間謂之小歷又五代石晉髙祖時司天監馬重績造調元歷以唐天寶十四載乙未爲上元用正月水爲气首此二者亦皆截算之法授時歷蓋采用之耳然曺馬二歷未嘗密測逺徴不過因時歷之率截取近用若郭太史則制器極精四海測驗者二十七所又上考春秋以來至於近代然後立術非捨難而就易也又按孟子千嵗日至趙注只云日至可知其日孫奭疏則直云千嵗以後之日至可坐而定初不言立元

論西法積年

問歷元之難定以嵗月日時皆防甲子也若西曆者初不知有甲子何難溯古上元而亦截自戊辰歟曰西人言開辟至今止六千餘年是卽其所用積年也然曆書不用爲元者何也旣無干支則不能合於中法一也又其法起春分與中法起冬至不同以求上古積年畢世不能相合二也且西書所不一其積年之說先有參差三也故截自戊辰爲元亦鎔西算入中法之一事蓋立法之善𨿽巧算不能違矣

天地儀書自開辟至崇禎庚辰凡五千六百三十餘年聖經直解開辟至崇禎庚辰凡六千八百三十六年

通雅按諸太西云自開辟至崇禎甲申六千八百四十年依所制稽古定儀推之止五千七百三十四年月離歷指曰崇禎戊辰爲總期之六千三百四十一年

天文實用雲開辟初時適當春分又雲中西皆以角爲宿首因開辟首日昬時角爲中星也今以恆星本行逆推約角宿退九十度必爲中星計年則七千矣與聖經紀年合

開辟至洪水天地儀書云一千六百五十餘年聖經直解則云二千二百四十二年相差五百九十二年洪水至漢哀帝元壽二年庚申天主降生天地儀書云二千三百四十餘年聖經直解則云二千九百五十四年相差六百一十四年遺詮又云二千九百四十六年比聖經直解又少八年

論日法

問上古積年荒忽無憑去之誠是也至於日法則現在入用之數也而古歷皆有日法授時何以獨無曰日法與歷元相因而立者也不用積年自可不用日法矣蓋古歷气朔皆定大小餘大餘者日也小餘者時刻也凡七曜之行度不能正當時刻之初而或在其中半難分之處非以時刻剖析爲若干分秒則不能命算此日法所由立也自日法而析之則有辰法刻法分法秒法自日法而積之則有气防法朔實法嵗實法旬周法與日日法同用者則有度法宿次法周天法又有章法蔀法紀法元法一切諸法莫不以日法爲之綱古歷首定日法而皆有畸零蓋以此也惟日法有畸零故諸率從之而各有畸零之數矣夫古歷豈故爲此繁難以自困哉欲以上合於所立之歷元而爲七曜之通率有不得不然者也【如古法以九百四十分爲日法其四分之一則爲二百三十五所以然者以十九年一章有二百三十五月也又古法月行十九分度之七是以十九分爲度法亦以十九年一章有七閏也他皆類此】今授時旣不用積年卽章蔀紀元悉置不用而一以天驗爲徴故可不用畸零之日法而竟以萬分爲日日有百刻刻有百分故一萬也自此再析則分有百秒秒有百微皆以十百爲等而遞進退焉數簡而明易於布算法之極善者也是故授時非無日法也但不用畸零之日法耳用畸零之日法乘除旣繁而其勢又有所阻故分以下復用秒母焉用萬分之日可以析之屢析至於無窮【日躔之用有秒則日爲百萬月離之用有防則日爲億萬】而乘除之間轉覺其易是小餘之細未有過於授時者也而又便於用豈非法之無可以萬世遵行者哉

按宋蔡季通欲以十二萬九千六百爲日法而當時歷家不以爲然畏其細也然以較授時猶未及其秒數而不便於用者有畸零也有畸零而又於七曜之行率無闗何怪歷家之不用乎若回回泰西則皆以六十遞析𨿽未嘗別立日法而秒防以下必用通分頗多紆折若非逐項立表則其繁難不啻數倍授時矣薛儀甫著天學防通以六十分攺爲百分誠有見也

歷算全書卷一

欽定四庫全書

歷算全書卷二

宣城梅文鼎撰

歷學疑問二

論嵗實【閏餘】

問歲實有一定之數而何以有閏餘曰惟歲實有一定之數所以生閏餘也凡紀歲之防有二自今年冬至至來年冬至凡三百六十五日二十四刻二十五分而太陽行天一周是爲一嵗二十四莭气之日【據授時大統之數或自今年立春至來年立春亦同】

周禮太史注中數曰歲朔數曰年自今年冬至至明年冬至歲也自今年正月朔至明年正月朔年也古有此語要之歲與年固無大別而中數朔數之不齊則气盈朔虛之所由生

自正月元旦至臘月除夕凡三百五十四日三十六刻七十一分一十六秒而太陰防太陽於十二次一周是爲一歲十二月之日【亦據授時平朔言之】兩數相較則莭气之日多於十二月者一十日八十七刻五十三分八十四秒是爲一歲之通閏積至三年共多三十二日六十二刻六十一分五十二秒而成一閏月仍多三日零九刻五十五分五十九秒積至五年有半共多五十九日八十一刻四十六分一十二秒而成兩閏月仍多七十五刻三十四分二十六秒古云三歲一閏五歲再閏者此也然則何以不竟用莭气紀歳則閏月可免矣曰晦朔望易見者也莭气過宮難見者也敬授人時則莫如用其易見之事而但爲之閏月以通之則四時可以不忒堯命羲和以閏月定四時成歳此堯舜之道萬世不可易也若回回歷有太陰年爲動的月有太陽年爲不動的月夫旣謂之月安得不用晦朔望而反用莭气乎故回回歷𨿽有太陽年之算而天方諸國不以紀歳也沈存中欲以莭气紀歳而天經或問亦有是言此未明古聖人之意者矣

論歳余消長

問歳實旣有一定之數授時何以有消長之法曰此非授時新法而宋綂天之法然亦非綂天億創之法而合古今累代之法而爲之者也蓋古歷周天三百六十五度四分度之一一歳之日亦如之故四年而增一日【今西曆永年表亦同】其後漸覺後天皆以爲斗分太彊因稍損之【古歷起斗終斗故四分之一皆寄斗度謂之斗分】自漢而晉而唐而宋毎次攺歷必有所減以合當時實測之數故用前代之歷以順推後代必至後天以斗分彊也【斗分卽嵗余】若用後代之歷據近測以逆溯往代亦必後天以斗分弱也【前推後而歳余彊則所推者過於後之實測矣後推前而嵗余弱則所推者不及於前之實測矣故皆後天】綂天歷見其然故爲之法以通之於歳實平行之中加一古多今少之率則於前代諸歷不相戾而又不違於今之實測此其用法之巧也然綂天歷蔵其數於法之中而未嘗明言消長授時則明言之今遂以爲授時之法耳郭太史自述創法五端初未及此也然則大綂歷何以不用消長曰此則元綂之失也當時李徳芳固巳上疏爭之矣然在洪武時去授時立法不過百年所減不過一分積之不過一刻故𨿽不用消長無甚差殊也崇禎曆書謂元綂得之測驗竊不謂然何也元綂與徳芳辧但自言未變舊法不言測驗有差又其所著通軌𨿽便初學殊昧根宗間有更張輒違經防【如月食時差旣內分等俱妄攺背理】豈能於冬至加時後先一刻之間而測得眞數乎然則消長必不可廢乎曰上古則不可知矣若春秋之日南至固可考據而唐宋諸家之實測有據者史冊亦具存也今以消長之法求之其數皆合若以大綂法求之則皆後天而於春秋且差三日矣安可廢乎然則綂天授時之法同乎曰亦不同也綂天歷逐年逓差而授時消長之分以百年爲限則授時之法又不如綂天矣夫必百年而消長一分未嘗不是乃以乘距算其數驟變殊覺不倫鄭世子黃鐘歷法所以有所酌攺也【假如康熙辛酉年距元四百算該消四分而其先一年庚申距算三百九十九隻消三分是庚申年嵗餘二十四刻二十二分而辛酉年歳餘二十四刻二十一分也以此所消之一分乘距算得四百分則辛酉嵗前冬至忽早四刻而次年又只平運以實數計之庚申年反只三百六十五日二十刻二十二分辛酉年則又是三百六十五日二十四刻二十一分其法舛矣】

論嵗實消長之所以然

問嵗實消長之法旣通於古亦宜合於今乃今實測之家又以爲消極而長其說安在豈亦有所以然之故歟曰授時𨿽承統天之法而用消長但以推之舊曆而合耳初未嘗深言其故也惟曆書則爲之說曰嵗實漸消者由日輪之轂漸近地心也余嘗竊疑其說今具論之夫西法以日天與地不同心疏盈縮加減之理其所謂加減皆加減於周天三百六十度之中非有所增損於其外也如最髙則視行見小而有所減最卑則視行見大而有所加加度則減時矣減度則加時矣然皆以最卑之所減補最髙之所加及其加減旣周則其總數適合平行略無餘欠也若果日輪之轂漸近地心不過其加減之數漸平耳加之數漸平則減之數亦漸平其爲遲速相補而歸於平行一也豈有日輪心逺地心之時則加之數多而減之數少日輪心近地心時則減之數少而加之數多乎必不然矣又考日躔永表彼固原未有消長之說日躔歷指言平嵗用授時消分定嵗則用最髙差及查恆年表之用則又只用平率是其說未有所決也又曆書言日輪漸近地心數千年後將合爲一若前之漸消由於兩心之漸近則今之消極而長兩心亦將由近極而逺數千年後又安能合爲一乎彼蓋見授時消分有據而姑爲此說非能極論夫消長之故者也然則將何以求其故曰授時以前之漸消旣徴之經史而信矣而今現行歷之嵗實又稍大於授時其爲復長亦似有據竊考西曆髙卑今定於二至後七度依永年曆毎年行一分有奇則授時立法之時最髙卑正與二至同度而前此則在至前過此則在至後豈非髙衝漸近冬至而嵗余漸消及其過冬至而東又復漸長乎余觀七政歷於康熙庚申年移攺最髙半度弱而其年歳實驟增一刻半彊此亦一徴也存此以竢後之知歷者【巳未年最髙在夏至後六度三十九分庚申年最髙在夏至後七度七分除本行外計新移二十七分己未年冬至庚戌日亥正一刻四分庚申年冬至丙辰日寅正二刻二分實計三百六十五日二十四刻十三分前後各年俱三百六十五日二十三刻四分或五分以較庚申年嵗實驟增一刻九分】王寅旭曰嵗實消長其說不一謂由日輪之轂漸近地心其數寖消者非也日輪漸近則兩心差及所生均數亦異以論定嵗誠有損益若平嵗嵗實尙未及均數則消長之源與兩心差何與乎識者欲以黃赤極相距逺近求嵗差朓朒與星嵗相較爲節嵗消長終始循環之法夫距度旣殊則分至諸限亦宜隨易用求差數其理始全然必有平嵗之嵗差而後有朓朒之嵗差有一定之嵗實而後有消長之嵗實以有定者紀其常以無定者通其變始可以永久而無獘

按寅旭此論是欲據黃赤之漸近以爲嵗實漸消之根蓋見西測黃赤之緯古大今小今又覺稍贏故斷以爲消極復長之故然黃赤逺近其差在緯嵗實消長其差在經似非一根又西測距緯復贏者彼固自疑其前測最小數之末眞則亦難爲確據愚則以中歷嵗實起冬至而消極之時髙衝與冬至同度髙衝離至而嵗實亦增以經度求經差似較親切愚與寅旭生同時而不相聞及其卒也乃稍稍見其書今安得起斯人於九原而相與極論以質所疑乎

論恆星東移有據

問古以恆星卽一日一周之天而七曜行其上今則以恆星與七曜同法而別立宗動是一日一周者與恆星又分兩重求之古歷亦可通歟曰天一日一周自東而西七曜在天遲速不同皆自西而東此中西所同也然西法謂恆星東行比於七曜今考其度蓋卽古歷嵗差之法耳嵗差法昉於虞喜而暢於何承天祖衝之劉焯唐一行歷代因之講求加密然皆謂恆星不動而黃道西移故曰天漸差而東嵗漸差而西所謂天卽恆星所謂嵗卽黃道分至也西法則以黃道終古不動而恆星東行假如至元十八年冬至在箕十度至康熙辛未歷四百十一年而冬至在箕三度半在古法謂是冬至之度自箕十度西移六度半而箕宿如故也在西法則是箕星十度東行過冬至限六度半而冬至如故也其差數本同所以致差者則不同耳然則何以知其必爲星行乎曰西法以經緯度恆星則普天星度俱有嵗差不止冬至一處此蓋得之實測非臆斷也然則普天之星度差古之測星者何以皆不知耶曰亦嘗求之於古矣蓋有三事可以相證其一唐一行以銅渾儀二十八捨其去極之度皆與舊經異今以歳差考之一行銅儀成於開元七年其時冬至在斗十度而自牽牛至東井十四宿去極之度皆小於舊經是在冬至以後歷春分而夏至之半周其星自南而北南緯增則北緯減故去北極之度漸差而少也自輿鬼至南斗十四宿去極之度皆大於舊經是在夏至以後歷秋分而冬至之半周其星自北而南南緯減則北緯增故去北極之度漸差而多也【星度詳後】向使非恆星移動何以在冬至後者漸北在夏至後漸南乎【恆星循黃道行實只東移無所謂南北之行也而自赤緯觀之則有南北之差蓋橫斜之勢使然】其一古測極星卽不動處齊梁間測得離不動處一度彊【祖暅所測】至宋熈寧測得離三度彊【沈存中測詳夢溪筆談】至元世祖至元中測得離三度有半【郭太史極儀徑七度終夜見極星循行環內切邊而行是也】向使恆星不動則極星何以離次乎其一二十八宿之距度古今六測不同【詳元史】故郭太史疑其動移此蓋星旣循黃道東行而古測皆依赤道黃赤斜交勾異視所以度有伸縮正由距有橫斜耳不則豈其前人所測皆不足慿哉故僅以冬至言差則中西之理本同而合普天之星以求經緯則恆星之東移有據何以言之近兩至處恆星之差在經度故可言星東移者亦可言嵗西遷近二分處恆星之差竟在緯度故惟星實東移始得有差若只兩至西移諸星經緯不應有變也如此則恆星之東移信矣恆星旣東移不得不與七曜同法矣恆星東移旣與七曜同法卽不得不更有天挈之西行此宗動所由立也

唐一行所測去極度與舊不同者列後

舊經

唐測

牽牛【去極】百六度

牽牛【去極】百四度須女百

度【有脫字】須女百

一度

虛

百四度

虛

百一度

危

九十七度【有誤字】危

九十七度

營室八十五度

營室八十三度

東壁八十六度

東壁八十四度

奎

七十六度

奎

七十三度

婁

八十度

婁

七十七度

胃昴七十四度

胃昴七十二度

畢

七十八度

畢七十六度

觜觹八十四度

觜觹八十二度

參

九十四度

參

九十三度

東井七十度

東井六十八度

以上十四宿去極之度皆古測大而唐測小是所測去極之度少於古測爲其星自南而北也又按唐開元冬至在斗十度則此十四宿爲自冬至後歷春分而夏至之半周

舊經

唐測

輿鬼六十八度

輿鬼六十八度

栁

七十七度

栁

八十度半

七星九十一度

七星九十三度半張

九十七度

張

百度

翼

九十七度

翼

百三度

軫

九十八度

軫

百度

角

九十一度【正當赤道】角

九十三度半【在赤道南二度半】亢

八十九度

亢

九十一度半氐

九十四度

氐

九十八度

房

百八度

房

百一十度半心

百八度

心

百一十度

尾

百二十度

尾

百二十四度箕

百一十八度

箕

百二十度

南斗百一十六度

南斗百一十九度以上十四宿去極之度皆古測小而唐測大是所測去極之度多於古測爲其星自北而南也以冬至斗十度言之則此十四宿爲自夏至後歷秋分而冬至之半周

論七政髙下

問言日月星辰系焉而今謂七政各有一天何據曰屈子天問圜則九重孰營度之則古有其語矣七政運行各一其法此其說不始西人也但古以天如棊局不動而七政錯行如碁子之推移西人之說則謂日月五星各麗一天而有髙下其天動故日月五星動非七政之自動也其所麗之天表裏通徹故但見七政之動耳不然則將如彗孛之類旁行斜出安得有一定之運行而可以施吾籌防乎且旣各麗一天則皆天也𨿽有髙下而總一渾灝之體於中庸所謂擊焉者初無抵牾也然則何以知其有髙下曰此亦古所有但言之未詳耳古今歷家皆言月在太陽之下故月體能蔽日光而日爲之食是日髙月下日逺月近之證也又步日食者以交道表裏而論其食分隨地所見深淺各異故此方見食旣者越數千里而僅虧其半古人立法謂之東西南北差是則日之下月之上相距甚逺之證也又月與五星皆能掩食恆星是恆星最在上而於地最逺也月又能掩食五星是月最在下而於地最近也五星又能互相掩是五星在恆星之下月之上而其所居又各有髙下於地各有逺近也向使七政同在一規而無髙下之距則相遇之時必相觸擊何以能相掩食而過乎是故居七政之上最近大圜最逺於地者爲恆星恆星之下次爲土星又次爲木星次爲火星次爲太陽爲金爲水最近於地者爲月以視差言之與人目逺者視差防近則視差大故恆星之視差最防以次漸增至月而差極大也以行度言之近大圜者爲動天所掣故左旋速而右移之度遲漸近地心則與動天漸逺而左旋漸遲卽右移之度反速故左旋之勢恆星最速以次漸遲至月而爲最遲也右移之度恆星最遲以次漸速至月而反最速也是二者宛轉相求其數巧合髙下之理可無復疑【夢溪筆談以月盈虧明日月之形如丸可謂明悉而又以問者之疑其如丸則相遇而相礙故輙漫應之曰日月气也有形無質故相值而無礙此則未明視差之理爲智者千慮之失】

論無星之天

問古以恆星不動七曜常移故有蟻行磨上之諭今恆星東移旣與七曜同法則恆星亦是蟻而非磨故𨿽宗動無星可信其有也然西法又謂動天之外有靜天何以知之曰此亦可以理信者也凡物之動者必有不動者以爲之根動而不息者莫如天則必有常不動者以爲之根矣天之有兩極也亦如磑之有臍戶之有樞也樞不動故戶能開闔臍不動故磑能運旋若樞與臍動則開闔運旋之用息矣然樞能制戶臍能運磑而此二者又誰制之而能不動哉則以其所麗者常靜也【如戶之樞附於屋而屋仍有基基卽地也臍植於磑之下半而磑安於架架仍在地也人但知樞之於戶臍之於磑能以至小爲至大之君而不知此至小者之根又實連於大地之體】惟天亦然動天之周系於兩極而此兩極者必有所麗其所麗者又必常靜故能終古凝然而爲動天之樞也使其不然極且自動而何以爲動天之所宗乎或曰天不可以戶磑擬也戶磑物也天則一气旋轉而已豈必有所附著而後其樞不動哉曰天之異於物者大小也若以不動爲動之根無異理也且試以實測徴之自古言北極出地三十六度而陽城之測至今未攺也元史測大都北極之髙四十度半今以西測徴之亦無分寸之移故言嵗差者不及焉【如黃赤古逺今近日輪轂漸近地心之類皆有今昔之差惟北極出地之度不變】使天惟兀然浮空而又常爲動而不息之物北極髙下亦將攺易而何以髙度常有定測乎朱子嘗欲先論太虛之度然後次及天行太虛者靜天之謂也

【朱子曰而今若就天裏看時只是行得三百六十五度四分度之一若把天外來說則是一日過了一度蔡季通嘗言論日月則在天裏論天則在太虛空裏若在太虛空裏觀那天自是日日裏得不在舊時處又曰歷法蔡季通說當先論天行次及七政此亦未善要當先論太虛以見三百六十五度四分度之一一一定位然後論天行以見天度加損虛度之嵗分嵗分旣定然後七政乃可齊耳】

【臨川吳氏曰天與七政八者皆動今人只將天做硬盤卻以七政之動在天盤上行今當以太虛中作一空盤卻以八者之行較其遲速】

論無星之天【其二】

問靜天爲兩極所麗卽朱子所言太虛是已然西法又設東西嵗差南北嵗差二重之天其說何居曰西人像數之學各有授受師說故其法亦多不同此兩嵗差之天利西泰言之徐文定公作曆書時湯羅諸西士棄不復用厥後穆氏著天步眞原北海薛氏本之著天學防通則又用之故知其授受非一家也今卽其說推之則穆與利又似不同何也西人測驗謂黃赤之距漸近此亦可名南北差若東西嵗差則恆星之東移是已而恆星旣爲一重天不應復有東西嵗差之天則西泰所言不知何指也至於穆薛之說則又不正言南北東西兩嵗差而別有加算謂之黃道差春分差其法皆作小圏於心而大圏之心循之而轉若干年在前若干年在後其年皆以千計有圖有數有法且謂作曆書時棄之非是也然於西泰初說亦不知同異何如耳然則何以斷其有無曰天動物也但動而有常耳常則久久則不能無秒忽之差差在秒忽固無損於有常之大較而要之其差亦自有常也善步者以數合差而得其衰序則儼然有形可說有象可圖焉如小輪之類皆是物也要之爲圖爲說總以得其差數而止其數旣明其差旣得又何必執其形象以生聚訟哉

論天重數

問七政旣有髙下恆星又復東移動天一日一周靜天萬古常定則天之重數豈不截然可數歟曰此亦據可見之度可推之數而知其必有重數耳若以此盡天體之無窮則有所不能卽以西說言之有以天爲九重者則以七曜各居其天並恆星宗動而九也有以天爲十二重者則以宗動之外復有南北嵗差東西嵗差並永靜之天十二也有以天爲層層相裹如蔥頭之皮密密相切略無虛隙者利氏之初說也又有以天𨿽各重而其行度能相割能相入以是爲天能之無盡者則以火星有時在日天之下金星有時在日天之上而爲此言曆書之說也又有以金水二星繞日旋轉爲太陽之輪故二星獨不經天是金水太陽合爲一重而九重之數又減二重共爲七重也然又謂五星皆以太陽爲本天之心蓋如是則可以免火星之下割日天是又將以五星與太陽並爲一天而只成四重也【一月天二太陽五星共爲一天三恆星天四宗動天】其說之不同如此而莫不持之有故其可以爲定議乎嘗試論之天一而已以言其渾淪之體則𨿽不動之地可指爲大圜之心而地以上卽天地之中亦天不容有二若由其蒼蒼之無所至極以徴其體勢之髙厚則𨿽恆星同在一天而或亦有髙下之殊儒者之言天也當取其明確可徴之辭而略其荒無稽之事是故有可見之象則可以知其有附麗之天有可求之差則可以知其有髙下之等【如恆星七政皆有象有差】有一種之行度知其有一樞紐【如動天無象可見而有行度】此皆實測之而有據者也而有常動者以爲之運行知其必有常靜者以爲之根柢【靜天與地相應故地亦天根】此則以理斷之而不疑者也若夫七政恆星相距之間天宇遼闊或空澄而精湛或絪緼而彌綸無星可測無數可稽固思議之所窮亦敬授之所緩矣

論天重數二

問重數旣難爲定則無重數之說長矣曰重數𨿽難定而必以有重數爲長何也以七政之行非赤道也臨川掲氏曰天無層數七政皆能動轉試以水注圓噐而急旋之則見其中沙土諸物近心者凝而不動近邊者隨水而旋又且遲速洄漩以成防逆諸行矣又試以丸置於圜盤而輙轉其盤則其丸旣爲圜盤所掣與盤並行而丸之體圎亦能自轉而與盤相逆以成小輪之象矣此兩逾明切諸家所未及然以七政能自動而廢重數之說猶未能無滯礙也何也謂天如盤七政如丸盤之與丸同在一平面故丸無附麗而能與盤同行又能自動也若天則渾圓而非平圓又天體自行赤道而七政皆行黃道平斜之勢甚相差違若無本天以帶之而但如丸之在盤則七政之行必總防於動天之腰圍闊處皆行赤道而不能斜交赤道之內外以行黃道故曰以有重數爲長也曰天旣有重數則當如西人初說七政在天如木節在板而不能自動矣曰七政各居其天原非如木節之在板也各有小輪皆能自動但其動只在本所略如人之目睛未嘗不左右頋盼而不離睂睫之間也若如板之有節則小輪之法又將安施卽西說不能自通矣故惟七政各有本天以爲之帶動斯能常行於黃道而不失其恆惟七政之在本天又能自動於本所斯可以施諸小輪而不礙掲說與西說固可並存而不廢者也

論左旋

問天左旋日月五星右旋中西兩家所同也自橫渠張子有俱左旋之說而朱子蔡氏因之近者臨川掲氏建寕遊氏又以槽丸盆水譬之此孰是而孰非曰皆是也七曜右旋自是實測而所以成此右旋之度則因其左旋而有動移耳何以言之七曜在天每日皆有相差之度歷家累計其每日差度積成周天中西新舊之法莫不皆然夫此相差之度實自西而東故可以名之右旋然七曜每日皆東升西降故又可以名之左旋西曆謂七曜皆有東西兩動而並出於一時蓋以此也夫旣云動矣動必有所向而一時兩動其勢不能古人所以有蟻行磨上之諭而近代諸家又有人行舟中之比也【七曜如人天如舟舟揚帆而西人在舟中向舟尾而東行岸上望之則見人與舟並西行矣】又天之東升西沒自是赤道七曜之東移於天自是黃道兩道相差南北四十七度【自短規至長規合之得此數】𨿽欲爲槽丸盆水之諭而平面之行與斜轉之勢終成疑義安可以遽廢右旋之實測而從左轉之虛理哉然吾終謂朱子之言不易者則以天有重數耳曰天有重數何以能防其爲左旋曰天𨿽有層次以居七曜而合之總一渾體故同爲西行也同爲西行矣而仍有層次以生微差層次之髙下各殊則所差之多寡亦異故七曜各有東移之率也然使七曜所差只在東西順逆遲速之間則槽丸盆水之譬亦已足矣無如七曜東移皆循黃道而不由赤道則其與動天異行者不徒有東西之相違而且有南北之異向以此推知七曜在各重之天皆有定所而其各天又皆順黃道之勢以黃道爲其腰圍中廣而與赤道爲斜交非僅如丸之在槽沙之在水皆與其噐平行而但生退逆也【丸在槽與其盤爲平面沙在水與其噐爲平面故丸與盤同運而生退逆水與沙並旋而生退逆其順逆兩象皆在一平面】蓋惟其天有重數故能動移惟其天之動移皆順黃道斯七曜東移皆在黃道矣是故左旋之理得重數之說而益明曰謂右旋之度因左旋而成何也曰天旣有重數矣而惟恆星天近動天故西行最速防與動天相若【六七十年始東移一度】自土星以內其動漸殺以及於地球是爲不動之處則是制動之權全在動天而恆星以內皆隨行也使非動天西行則且無動無動卽無差又何以成此右旋之算哉其勢如陶家之有鈞盤運其邊則全盤皆轉又如運重者之用飛輪其運動也亦以邊制中假令有小盤小輪附於大鈞盤大飛輪之上而別爲之樞則𨿽同爲左旋而因其制動者在大輪其小者附而隨行必相差而成動移以生逆度又因其樞之不同也𨿽有動移必與本樞相應而成斜轉之象焉【此之斜轉亦在平面非正諭其平斜但聊以明制動之勢】夫其退逆而右也因其兩輪相疊其退轉而斜行也因於各有本樞而其所以能退逆而斜轉者則以其隨大輪之行而生此動移也若使大者停而不行則小者之逆行亦止而斜轉之勢亦不可見矣朱子旣因舊說釋詩又極取張子左旋之說蓋右旋者已然之故而左旋者則所以然之理也西人知此則不必言一時兩動矣故掲氏以丸諭七曜只可施於平面而朱子以輪載日月之諭兼可施諸黃赤與西說之言層次者實相通貫理至者數不能違此心此理之同洵不以東海西海而異也【朱子語類問經星左旋緯星與日月右旋是否曰今諸家是如此說橫渠說天左旋日月亦左旋看來橫渠之說極是只恐人不曉所以詩只載舊說或曰此亦易見如以一大輪在外一小輪載日月在內大輪轉急小輪轉慢𨿽都是左轉只有急冇慢便覺日月是右轉了曰然但如此則歷家逆字皆著攺做順字退字皆著攺做進字】

論黃道有極

問古者但言北辰渾天家則因北極而推其有南極今西法乃復立黃道之南北極一天而有四極何也曰求經緯之度不得不然也蓋古人治歷以赤道爲主而黃道從之故周天三百六十五度皆從赤道分其度一一與赤道十字相交引而長之以防於兩極若黃道之度𨿽亦勻分周天【三百六十五】而有經度無緯度則所分者只黃道之一綫初不據以分宮故授時十二宮惟赤道勻分各得三十度奇黃道則近二至者一宮或只二十八度近二分者一宮多至三十二度【皆約整數】若是其濶狹懸殊者何哉過宮𨿽在黃道而分宮仍依赤道赤道之勻度抵黃道而成斜交勢有橫斜遂生濶狹故曰以赤道爲主而黃道從之也向使歷家只步日躔此法已足無如月五星皆依黃道行而又有出入其行度之舒亟轉變爲法多端皆以所當黃道及其距黃之逺近內外爲根故必先求黃道之經緯西曆之法一切以黃道爲主其法勻分黃道周天度爲十二宮其分宮分度之經度綫皆一一與黃道十字相交自此引之各成經度大圏以周於天體則其各圏相交以爲各度輳心之處者不在赤道南北極而別有其心是爲黃道之南北極自黃道兩極出綫至黃道【卽黃道上分宮分度之綫引而成大圏以輳心者也心卽黃極故亦可雲從極出綫】其緯各得九十度而均【極距黃道四面皆均故分宮分度綫上之緯度皆均】以此各綫之緯聮爲圏綫皆與黃道平行自黃道上相離一度起逐度作圏但其圏漸小以至九十度則成一而防於黃極是爲緯圏【一名距等圈】曰黃道旣有經緯則必有所宗之極測算所需固巳然則爲測算家所立歟抑眞有是以爲運轉之樞耶曰以恆星東移言之則眞有是矣何則古法嵗差亦只在黃道之一綫今以恆星移則普天星斗盡有古今之差惟黃道極終古不動豈非眞有黃極以爲運轉之樞哉曰然則北辰非黃極也今曰惟黃極不動豈北辰亦動與曰以毎日之周轉言則周天星度皆東升西沒惟北辰不動以恆星東移之差言則𨿽北辰亦有動移而惟黃極不動蓋動天西旋以赤道之極爲樞而恆星東移以黃道之極爲樞皆本實測各有至理也【古今測極星離不動處漸逺具見前篇】

論歷以日躔爲主中西同法

問天方等國以太陰年紀嵗【卽回回法】歐邏巴國以恆星年紀嵗【卽西洋本法】若是其殊意者起算之端亦將與中土大異而何以皆用日躔爲主歟曰其紀嵗之不同者人也其起算之必首日躔者天也夫天有日如國有君史以紀國事歷以紀天行而史之綱在帝紀歷之綱在日躔其義一也是故太陰之行度多端無以凖之凖於日也【太陰有周天有防望有遲疾入轉有交道表裏皆以所歷若干日而知其行度之率】五星之行度多端無以凖之凖於日也【五星亦有周天有防望有盈縮入歷有交道表裏略同太陰亦皆以日數爲率】恆星之行度甚遲無以凖之亦凖於日也【恆星東移是生嵗差亦以日度知之而得其行率】不先求日躔且不能知其何年何日而又何以施其測驗推步哉且夫天下之事必先得其著而後可以察其防必先得其易而後可以及其難必先得其常而後可以盡其變故以測驗言之日最著也以推步言之日最易也以經緯之度言之日最有常也懸象常明而無伏見是爲最著【若月與星則有晦伏】立術步算道簡不繁是爲最易【步月五星之法皆繁於日】恆星東移而分至不易是爲經度之有常月五星出入黃道而日行黃道中綫是爲緯度之有常古之聖人以賓餞永短定治歷之大法萬世遵行所謂易簡而天下之理得也愚故曰今日之歷愈宻皆聖人之法所該此其一徴矣

論黃道

問黃道斜交赤道而差至四十七度何以徴之曰此中西之公論要亦以日軌之髙下知之也今以表測日景則夏至之景短以其日近天頂而光從直下也冬至之景長以其日不近天頂而光從橫過也夫日近天頂則離地逺而地上之度髙日不近天頂則離地近而地上之度低測算家以法求之則夏至之日度髙與冬至之日度髙相較四十七度半之則二十三度半爲日在赤道南北相距之度也然此相較四十七度者非倐然而髙頓然而下也逐日測之則自冬至而春而夏其景由長漸短日度由低漸髙至夏至乃極自夏至而秋而冬其景由短漸長日度由髙漸低至冬至乃極其進退也有序其舒亟也有恆而又非平差之率故知其另有一圏與赤道相交出其內外也曰日行黃道固無可疑月與五星樊然不齊未嘗正由黃道也今曰七曜皆由黃道何也曰黃道者光道也【古�字從炗從日炗字卽古光字】日爲三光之主故獨行黃道而月五星從之𨿽不得正由黃道而不能逺離故皆出入於黃道左右要不過數度止耳古歷言月入陰陽曆離黃道逺處六度西曆測止五度奇又測五星出入黃道惟金星最逺能至八度其餘緯度乃更少於太陰是皆以黃道爲宗故也故月離黃道五度奇合計內外之差共只十度奇若其離赤道也則有逺至二十八度半【以黃道距赤道二十三度半加月道五度奇得之】合計內外之差則有相差五十七度奇【以月在赤道內二十八度半在外亦如之並之得此數】金星離黃道八度奇合計內外之差共只十六度奇若其離赤道也則有逺至三十一度奇【以黃赤之距加星距黃道】合計內外之差則有相差六十二度奇【以星距赤道內外各三十一度得之】是月五星之出入黃道最逺者於赤道能爲更逺豈非不宗赤道而皆宗黃道哉

論經緯度【黃赤】

問黃道有極以分經緯然則經緯之度惟黃道有之乎曰天地之間蓋無在無經緯耳約略言之則有有形之經緯有無形之經緯而又各分兩條曷言乎無形之經緯凡經緯之與地相應者其位置𨿽在地而實在無形之天朱子所謂先論太虛一一定位者此也曷言乎有形之經緯凡經緯之在天者𨿽去人甚逺而有象可徴卽黃赤道也是故黃道有經緯赤道亦有經緯兩道之經度皆與本道十字相交引而成大圏【經度皆三百六十兩度相對者連而成大圏故大圏皆一百八十】其圏相防交必皆防於其極兩道之緯圏皆與本道平行而逐度漸小以至於本極而成一此經緯之度兩道同法也然而兩道之相差二十三度半故其極亦相差二十三度半而兩道緯圏之差數如之矣【以黃緯爲主則赤緯之斜二十三度半以赤緯爲主而觀黃緯則其差亦然】若其經度則兩道之相同者惟有一圈【惟磨羯巨蟹之初度初分聫而爲一圏此圏能過黃赤兩極】其餘則皆有相差之度而其差又不等【惟一圏能過兩極則黃赤兩經圏合而爲一圏以黃赤兩極同居磨羯巨蟹之初也此外則黃道經圏只能過黃極而不過赤極赤道經圏亦只過赤極而不過黃極離磨羯巨蟹初度益逺其勢益斜其差益多故逐度不等】此其勢如以兩重罾冒於圎球則网目交加縱橫錯午而各循其頂以求之條理井然至而不可亂故曰在天之經緯有形而又分黃赤兩條也

論經緯度二【地平】

問經緯之與地相應者一而已矣何以亦分兩條曰黃赤之分兩條者有斜有正也地度之分兩條者有橫有立也今以地平分三百六十經度【三十度爲一宮共十二宮再剖之則二十四向】四面八方皆與地平圏爲十字而引長之成曲綫以輳於天頂皆相遇成一故天頂者地平經度之極也【其經度下逹而輳於地心亦然】又將此曲綫各勻分九十緯度【卽地平上髙度又謂之漸升度】而逐度聮之作橫圏與地面平行而漸髙則漸小防於天頂則成一卽地平緯圏也【其地平下作緯圏至地心亦然如太陽朦影十八度而盡太陰十二度而見之類皆用此度也】此地平經緯之度爲測驗所首重其實與太虛之定位相應者也然此特直立之經緯耳【其經緯以天頂地心爲兩極是直立也其地平卽腰圍廣處而緯圏與地平平行漸小而至天頂亦成直上之形矣】又有橫偃之經緯焉其法以卯酉圏勻分三百六十度【亦三十度爲一宮此圏上過天頂下過地心而正交地平於卯酉之中卽地平經圈之一也其三百六十度亦卽經圈上所分緯度但今所用只圈上分度之一防而不更作與地平平行之緯圈】從此度分作十字相交之綫引而成大圏【其圏一百八十半在地平之上半在其下其地平上半圏皆具半周天度勢皆自正北趨正南穹隆之勢與天相際度間所容中闊而兩末鋭略如剖其兩鋭在南北其中濶在卯酉】大圏相遇相交皆防於正子午而正切地平卽子午規與地平規相交之一【在地平直立經緯原用子午規卯酉規爲經圏地平規爲圍之緯圏今則以卯酉規爲圍而子午規與地平規則同爲經度圈】此一卽爲經度之極而經度宗焉【立象學安十二宮用此度也】又自卯酉規向南向北逐度各作半圈如虹橋狀而皆與卯酉規平行【地平下半圏亦然合之則各成全圏】但離卯酉規漸逺亦卽漸小以防於其極【卽地平規之正子午一】是其緯圏也【測算家以立晷取倒影定時用此度也】此一種經緯則爲橫偃之度【其經度以地平之子午爲兩極而以卯酉規爲其圍是橫偃之勢】一直立一橫偃其度皆與太虛之定位相應故曰無形之經緯亦分兩條也不但此也凡此無形之經緯皆以人所居之地平起算所居相距不過二百五十里卽差一度【此以南北之里數言也若東西則有不二百五十里而差一度者矣何也地圎故也】而所當之天頂地平俱變矣地平移則髙天頂易則方向殊跬步違離輾轉異視殆千變而未有所窮故曰天地之間無在無經緯也

地平經緯有適與天度合者如人正居兩極之下則以一極爲天頂一極爲地心而地平直立之經緯卽赤道之經緯矣若正居赤道之下則平視兩極一切地平之子一切地平之午而地平橫偃之經緯亦卽赤道之經緯矣

論經緯相連之用及十二宮

問經緯度之交錯如此得無益增測算之難乎曰凡事求之詳斯用之易惟經緯之詳此歷學所以易明也何也凡經緯度之法其數皆相待而成如鱗之相次网之在綱衰序秩然而不相淩越根株合散交互旁通有全則有分有正則有對卽顯見隠舉二知三故可以經度求緯亦可以緯度求經有地平之經緯卽可以求黃赤有黃赤之經緯亦可以知地平而且以黃之經求赤之經亦可以黃之緯求赤之經以黃之緯求赤之緯亦可以黃之經求赤之緯用赤求黃亦復皆然宛轉相求莫不脗合施於用從衡變化而不失其常求其源渾行無窮而莫得其隙夫是以布之於算而能窮差變筆之於圖而能肖星躔制之於噐而不違懸象此其道如棊方罫之間固善奕者之所當盡也曰經緯之度旣然以爲十二宮則何如曰十二宮者經緯中之一法耳渾圓之體析之則爲周天經緯之度周天之度合之成一渾圜而十二分之則十二宮矣然有直十二宮焉有衡十二宮焉有斜十二宮焉又有百遊之十二宮焉以天頂爲極依地平經度而分者直十二宮也其位自子至卯左旋周十二辰辧方正位於是焉用之以子午之在地平者爲極而以地平子午二規爲界界各三宮者衡十二宮也其位自東地平爲第一宮起右旋至地心又至西地平而歷午規以復於東立象安命於是乎取之赤道十二宮從赤道極而分極出地有髙下而成斜立是斜十二宮也加時之法於是乎取之則其定也西行之度於是乎紀之則其遊也黃道十二宮從黃道極而分黃道極繞赤道之極而左旋而黃道之在地上者從之轉側不惟日異而且時移晷刻之間周流遷轉正邪升降之度於是乎取之故曰百遊十二宮也然亦有定有遊定者分至之限遊者恆星嵗差之行也知此數種十二宮而俯仰之間縷如掌紋矣然猶經度也未及其緯故曰經緯中之一法也

論周天度

問古歷三百六十五度四分之一而今定爲三百六十何也豈天度亦可增損歟曰天度何可增減蓋亦人所命耳有布帛於此以周尺度之則於度有餘以漢尺度之則適足尺有長短耳於布帛豈有增損哉曰天無度以日所行爲度毎嵗之日旣三百六十五日又四之一矣古法據此以紀天度宜爲不易柰何攺之曰古法以太陽一日所行命之爲度然所謂四之一者訖無定率故古今公論以四分曆最爲疎闊而歷代斗分諸家互異至授時而有減嵗余增天周之法則日行與天度較然分矣又況有冬盈夏縮之異終嵗之間固未有數日平行者哉故與其爲畸零之度而初不能合於日行卽不如以天爲整度而用爲起數之宗固推步之善法矣【周天者數所從起而先有畸零故析之而爲半周天有象限爲十二宮爲二十四气七十二莫不先有畸零而日行之盈縮不與焉故推步稍難今以周天爲整數而但求盈縮是以整禦零爲法倍易】且所謂度生於日者經度耳而歷家所難尢在緯度今以三百六十命度則經緯通爲一法【若以嵗周命度則經度旣有畸零凖之以爲緯度畸零之算愈多若爲兩種度法則將變率相從益多糾葛】故黃赤𨿽有正斜而度分可以互求七曜之天𨿽有內外大小而比例可以相較以其爲三百六十者同也半之則一百八十四分之則九十而八綫之法緣之以生故以制測噐則度數易分以測七曜則度分易得以算三角則理法易明吾取其適於用而已矣可以其出於回回泰西而棄之哉【三百六十立算實本回回至歐羅巴乃發眀之耳】況七曜之順逆諸行進退損益全在小輪爲推步之要眇然而小輪之與大輪比例懸殊若鎰與銖而黍累不失者以其度皆三百六十也以至太陰之防望轉交五星之嵗輪無一不以三百六十爲法而地球亦然故以日躔紀度但可施於黃道之經而整度之用該括萬殊斜側縱橫周通環應可謂執簡禦棼法之最善者矣

歷算全書卷二

欽定四庫全書

歷算全書卷三

宣城梅文鼎撰

歷學疑問三

論盈縮髙卑

問日有髙卑加減始於西法歟曰古歷有之且詳言之矣但不言卑髙而謂之盈縮耳曰日何以有盈縮曰此古人積而得之者也秦火以還典章廢闕漢晉諸家皆以太陽日行一度故一歳一周天自北齊張子信積合加時始覺日行有入气之差而立爲損益之率又有趙道嚴者復凖晷景長短定日行進退更造盈縮以求虧食至隋劉焯立躔度與四序升降爲法加詳厥後皆相祖述以爲步日躔之凖蓋太陽行天三百六十五日惟只兩日能合平行【一在春分前三日一在秋分後三日一年之內能合平行者惟此二日】此外日行皆有盈縮而夏至縮之極毎日不及平行二十分之一冬至盈之極又過於平行二十分之一兩者相較爲十分之一以此爲盈縮之宗而過此皆以漸而進退焉此盈縮之法所由立也曰日躔旣毎日有盈縮則歳周何以有常度曰日行毎日不齊而積盈積縮之度前後自相除補故歳周得有常度也【細考之古今歳周亦有防差此只論其大較則實有常度】今以授時之法論之冬至日行甚速毎日行一度有奇歷八十八日九十一刻當春分前三日而行天一象限【古法周天四之一爲九十一度三十分奇下同】謂之盈初歷此後則毎日不及一度其盈日損歷九十三日七十一刻當夏至之日復行天一象限謂之盈末歷夫盈末之行毎日不及一度而得爲盈歷者以其前此之積盈未經除盡總度尙過於平行故仍謂之盈若其毎日細行固悉同縮初此盈末縮初可爲一法也試以積數計之盈初日數少而行度多其較爲二度四十分盈末日數多而行度少其較亦二度四十分以盈末之所少消盈初之所多則以半歳周之日【共一百八十二日六十二刻奇】行半周天之度【一百八十二度六十二分奇】而無餘度矣夏至日行甚遲毎日不及一度歷九十三日七十一刻當秋分後三日而行天一象限謂之縮初歷此後則每日行一度有奇其縮日損歷八十八日九十一刻復當冬至之日而行天一象限謂之縮末歷夫縮末之行每日一度有奇而亦得爲縮歷者以其前此之積縮未能補完總度尙後於平行故仍謂之縮若其毎日細行則悉同盈初此縮末盈初可爲一法也試以積數計之縮初日數多而行度少其較爲二度四十分縮末日數少而行度多其較亦二度四十分以縮末之所多補縮初之所少則亦以半歳周之日行半周天之度而無欠度矣夫盈歷縮歷旣皆以前後自相除補而無餘欠則分之而以半歳周行半周天者合之卽以一歳周行一周天安得以盈縮之故疑歳周之無常度哉

再論盈縮髙卑

問日有盈縮是矣然何以又謂之髙卑曰此則回回泰西之說也其說曰太陽在天終古平行原無盈縮人視之有盈縮耳夫旣終古平行視之何以得有盈縮哉蓋太陽自居本天而人所測其行度者則爲黃道黃道之度外應太虛之定位【卽天元黃道與靜天相應者也】其度勻剖而以地爲心太陽本天度亦勻剖而其天不以地爲心於是有兩心之差而髙卑判矣是故夏至前後之行度未嘗遲也以其在本天之髙半故去黃道近而離地遠遠則見其度小【謂太陽本天之度】而人自地上視之遲於平行矣【縮初盈末半周是太陽本天髙處故在本天行一度者在黃道不能占一度而過黃道遲】是則行度之所以有縮也冬至前後之行度未嘗速也以其在本天之低半故去黃道遠而離地近近則見其度大【亦謂本天之勻度】而人自地上視之速於平行矣【盈初縮末半周是太陽本天低處故在本天行一度者在黃道占一度有餘而過黃道速】是則行度之所以有盈也且夫行度有盈縮而且日日不同則不可以籌防禦而今以圜法解之不同心之理通之在髙度不得不遲在卑度不得不速髙極而降遲者不得不漸以速卑極而升速者不得不漸以遲遲速之損益循圜周行與算數相防是則盈縮之徵於實測者皆一一能得其所以然之故此髙卑之說深足爲治歷明時之助者矣

太陽之平行者在本天太陽之不平行者在黃道平行之在本天者終古自如不平行之在黃道者晷刻易率惟其終古平行知其有本天惟其有本天斯有髙卑以生盈縮不平行之率以平行而生者也惟其盈縮多變知其有髙卑惟其盈縮生於髙卑驗其在本天平行平行之理又以不平行而信者也夫不平行之與平行道相反矣而求諸圜率適以相成是蓋七曜之所同然而在太陽尢爲明白而易見者也【月五星多諸小輪加減故本天不同心之理惟太陽最明】

論最髙行

問以髙卑疏盈縮確矣然又有最髙之行何耶曰最髙非他卽盈縮起算之端也盈縮之算旣生於本天之髙卑則其極縮處卽爲最髙如古法縮歷之起夏至也極盈處卽爲最卑如古法盈歷之起冬至也【亦謂之最髙衝或省曰髙衝】然古法起二至者以二至卽爲盈縮之端也西法則極盈極縮不必定於二至之度而在其前後又各年不同故最髙有行率也其說曰上古最髙在夏至前今行過夏至後毎年東移四十五秒【今又定爲一年行一分一秒十防】何以徵之曰凡最髙爲極縮之限則自最髙以後九十度及相近最髙以前九十度其距最髙度等則其所縮等何也以視度之小於平度者並同也【古法以盈末縮初通爲一限亦是此意】髙衡爲極盈之限則自髙衝以後九十度及相近髙衝以前九十度其距髙衝度等則其所盈亦等何也以視度之大於平度者並同也【古法以縮末盈初通爲一限亦是此意】今據實測則自定气春分至夏至一象限【卽古盈末限】之日數與自夏至後至定气秋分一象限【卽古縮初限】之日數皆多寡不同又自定气秋分至冬至一象限【卽古縮末限】之日數與自冬至後至定气春分一象限【卽古盈初限】之日數亦多寡不同由是觀之則極盈極縮不在二至明矣曰若是則古之實測皆非歟曰是何言也言盈縮者始於張子信而後之歷家又謂其損益之未得其正由今以觀則子信時有其時盈縮之限後之歷家又各有其時盈縮之限測驗者各據其時之盈縮爲主則追論前術覺其未盡矣此豈非最髙之有動移乎又古之盈縮皆以二十四气爲限至郭太史始加宻算立爲毎日毎度之盈縮加分與其積度由今考之則郭太史時最髙卑與二至最相近【自歷元戊辰逆溯至元辛巳三百四十八年而最髙卑過二至六度以今率毎年最髙行一分一秒十防計之其時最髙約與夏至同度以西又舊率毎年髙行四十五秒計之其時最髙已行過夏至一度三十餘分其距度亦不爲甚逺也】故盈縮起二至初無謬誤測算𨿽宻秪能明其盈縮細分若最髙距至之差無緣可得非考驗之不精也

論髙行周天

問最髙有行能周於天乎抑只在二至前後數十度中東行而復西轉乎曰以理徴之亦可有周天之行也曰然則何以不徴諸實測曰無可據也歷法西傳曰古西士去今一千八百年以三角形測日軌記最髙在申宮五度三十五分今以年計之當在漢文帝七年戊辰【自漢文帝戊辰順數至歷元戊辰積一千八百算外】此時西曆尙在權輿越三百餘年至多祿某而諸法漸備然則所謂古西士之測算或非精率然而西史之所據止此矣又況自此而逆溯於前將益荒遠而髙行之周天以二萬餘年爲率亦何從而得其起算之端乎是故以實測而知其最髙之有移動者只在此千數百年之內其度之東移者亦只在二至前後一宮之間若其周天則但以理斷而已曰以理斷其周天亦有說歟曰最髙之法非特太陽有之而月五星皆然其加減平行之度者亦中西兩家所同也故中歷太陽五星皆有盈縮太陰則有遲疾在西法則皆曰髙卑視差而已然則月孛者太陰最髙之度也而月孛旣有周天之度矣太陽之最髙何獨不然故曰以理徴之最髙得有周天之行也

論小輪

問以最髙疏盈縮其義已足何以又立小輪曰小輪卽髙卑也但言髙卑則當爲不同心之天以居日月小輪之法則日月本天皆與地同心特其本天之周又有小輪爲日月所居是故本天爲大輪負小輪之心向東而移日月在小輪之周【卽邊也】向西而行大輪移一度日月在小輪上亦行一度大輪滿一周小輪亦滿一周而盈縮之度與髙卑之距皆不謀而合回回歷以七政平行爲中心行度益謂此也

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷三﹥

凡日月在小輪上半順動天西行故其右移之度遲於平行爲減在小輪下半逆動天而東故其右旋之度速於平行爲加【五星同理】若在上下交接之時小輪之度直下不見其行謂之畱際畱際者不東行不西行無減無加與平行等此小輪上逐度之加減以上下而分者也【用第一圖自辛畱際過戊最髙至已爲上半皆西行自已畱過際庚最卑至辛爲下半皆東行巳辛兩畱際循小輪之旁不見其動】

若以入表則分四限小輪上半折半取中爲最髙小輪下半折半取中則爲最卑最卑最髙之防皆對小輪心與地心而成直綫七政居此卽與平行同度故爲起算之端假如七政起最髙在小輪上西行能減東移之度半象限後西行漸緩所減漸少至一象限而及畱際不復更西卽無所復減然積減之多反在畱際何也七政至此其視度距小輪心之西爲大也在古法則爲縮初【用第一圖自戊至巳一象限其減度最大爲己甲小輪半徑】旣過畱際而下轉而東行本爲加度因前有積減僅足相補其視行仍在平行之西至一象限而及最卑積減之數始能補足而復於平行是爲縮末【用第一圗自巳畱際至庚最卑一象限】

又如七政至最卑在小輪下東行能加東移之度半象限後東行漸緩所加漸少至一限象而又及畱際不復更東亦無所復加然積加之多亦在畱際何也七政至此其視度距小輪心之東爲大也在古法則爲盈初【第一圗自庚最卑至辛畱際一象限加度最大爲甲辛小輪半徑】過畱際而上復轉西行卽爲減度然因前有積加僅足相消其視行仍在平行之東至一象限而復及最髙積加之度始能消盡而復於平行是爲盈末【第一圖自辛防際至戊最髙一象限】此則表中入算加減從小輪之左右而分者也

再論小輪及不同心輪

小輪之用有二其一爲遲速之行在古歷則爲日五星之盈縮月之遲疾西法則總謂之加減卽前所疏者是也其一爲髙卑之距卽回回歷影徑諸差是也凡七政之居小輪最髙其去人逺故其體爲之見小焉其在最卑去人則近故其體爲之加大焉驗之於日月交食尢爲著明【別條詳之】是故所謂平行者小輪之心而所謂遲速者小輪之邊與其心前後之差【卽東西】所謂髙卑者小輪之邊與其心上下之距也知有小輪而進退加減之行度逺近大小之視差靡所不貫矣

然則何以又有不同心之算曰不同心之法生於小輪者也試以第二圖明之甲乙丙丁圏七政之本天卽小輪心所行之道也以子爲心卽地心也假如小輪心在甲則七政在戊爲小輪最髙小輪心自甲東移一象限至乙七政之在小輪亦從戊西行一象限至巳爲畱際小輪心東移滿半周至丙七政在小輪亦行半周至庚爲最卑由是小輪心東移滿二百七十度至丁七政亦行小輪二百七十度至畱際辛小輪心東移滿一周復至甲七政行小輪上亦行滿一周復至最髙戊若以小輪上七政所行之戊巳庚辛諸聫之卽成大圏此圏不以地心爲心而別有其心故曰不同心圈也如圖地心在子不同心圈之心在丑醜子兩心之差與小輪之半徑等故可以小輪立算者亦可以不同心立算而行度之加減與視徑之大小亦皆得數相符也

論小輪不同心輪孰爲本法

問二者之算悉符果孰爲本法曰晶宇寥廓天載無垠吾不能飛形禦气翺步乎日月之表小輪之在天不知其有焉否耶然而以求朓朒之行則旣有其度矣以量髙卑之距則又有其差矣𨿽謂之有焉可也至不同心之算則小輪實巳該之何也健行之體外實中虛自地以上至於月天大气所空洞無物故各重之天𨿽有髙卑而髙卑兩際只在本天【七政各重之天相去甚逺其間甚厚故可以容小輪而其最髙最卑皆不越本重之內】非別有一不同之心繞地而轉也【不同心之天旣同動天西運則其心亦將繞地而旋】況七政兩心之差各一其率若使其不同之心皆繞地環行亦甚渙而無統矣愚故曰不同心之算生於小輪而小輪實已該之觀回回歷但言小輪可知其爲本法而地谷於西術最後出其所立諸圗悉仍用小輪爲說亦足以徴矣

論小輪不同心輪各有所用

問小輪與不同心輪旣異名而同理擇用其一不亦可乎曰論相因之理則不同心之算從小輪而生論測算之用則小輪之徑亦從不同心而得故推朒朓之度於小輪特親【小輪心卽平行度也從最髙過輪心作綫至地心爲平行指綫剖小輪爲二則小輪右半在平行綫西爲朒左半在平行綫東爲朓觀圖易了】而求最髙之行以不同心立算最切然則其理互通其用相輔並存其說亦足以見圜行之無方而且可爲參稽之借矣

最髙在天不可以目視不可以噐測惟據朓朒之度以不同心之法測之而得其兩心之差是卽爲小輪之半徑於以作圗立算而朓朒之故益復犁然是故不同心者卽測小輪之法也

論小輪心之行及小輪上七政之行皆非自動

問小輪心逆動天而右旋日月五星之在小輪也又逆本天而順動天以左旋何若是其交錯歟意者七政各有能動之性而其動也又恆以逆爲順歟今夫魚溯川而遊順鱗鬐也鳥逆風而翔便羽毛也夫七政之行亦將若是而已矣曰子以小輪心自爲一物而不與本天相連乎曰非也小輪心常在本天之周殆相連耳曰七政居小輪之周豈不若小輪心之在本天乎曰然曰然則小輪心在本天七政在小輪體皆相連其非若魚之川泳鳥之雲飛也審矣然則何爲而有動移曰小輪心非能自動也小輪之動本天之動也七政亦非自動也七政之動小輪之動也其故何也蓋小輪之心旣與本天相連必有定處因本天爲動天所轉與之偕西而不及其速以生退度故小輪心亦有退度焉歷家紀此退度以爲平行【回回歷所謂中心行度】故曰小輪之動本天之動也然則小輪心者小輪之樞也樞連於本天不動故輪能動而七政者又相連於小輪之周者也小輪動則七政動矣故曰七政之動小輪之動也七政𨿽動不離小輪輪心𨿽移不離本天又恆爲周動而有定法豈若遊鱗徵鳥之於波瀾風霄而莫限所屆哉

再論小輪上七政之行

問本天移故小輪心移小輪動故七政動是則然矣然何以七政在小輪上西行不與輪心同勢豈非七政自有行法歟曰七政之居小輪也有一定之向本天挈小輪心東移而七政在小輪上常向最髙殆其精气有以攝之也故輪心東移一度小輪上七政亦西遷一度以向最髙譬之羅金小輪者其盤也小輪心者置鍼之處也七政所居則鍼所指之午位也試爲大圓周分三百六十度【以法周天】別爲大圏加其上使與大圓同心而可運【以法同心輪】乃置羅金於大圏之正午而依鍼以定盤則鍼之午卽盤之午【此如小輪在最髙而七政居其頂與最髙同處也】於是運大圏東轉使羅金離午而東【此如本天挈小輪而東移也】則盤鍼之指午者必且西移而向丁向未【因正午所定之盤不復更置則此時之丁之未實爲鍼之午此如小輪從本天東移而七政西遷居小輪之旁以向最髙之方】盤東移一度鍼亦西移一度盤東移一宮鍼亦西移一宮盤東行半周至大圓子位則鍼在盤上亦西移半周而反指盤之子【此時盤之子實鍼之午此如小輪心行至最髙衝而七政居小輪之底在小輪爲最卑而所向者最髙之方也】盤東移三百六十度而復至午鍼亦西移一周而復其故矣是何也鍼自向午不以盤之東移而攺其度自盤上觀之見爲西移耳七政之常向最髙何以異是【七政在小輪上常向最髙之方觀第二圖可見】

論小輪非一

問小輪有防曰小輪以算視行視行非一故小輪亦非一也凢算視行有二法或用不同心輪則惟月五星有小輪而日則否何也以盈縮髙卑卽於不同心之輪可得其度故不以小輪加減而小輪之用已蔵其中也或用同心輪負小輪則日有一小輪月五星有兩小輪其一是髙卑小輪爲日五星之盈縮月之遲疾卽不同心之算七政所同也其一是合望小輪在月爲倍離【卽晦朔望】在五星爲嵗輪【卽遲防逆伏】皆以距日之逺近而生故太陽獨無也若用小均輪則太陽有二小輪其一爲平髙卑二爲定髙卑而月五星則有三小輪其一二爲平髙卑定髙卑與太陽同其三爲太陰倍離五星嵗輪與太陽異也凡此皆以齊視行之不齊有不得不然者然小輪之用不同而名亦易相亂【如月離以髙卑輪爲自行輪又稱本輪又曰古稱小輪其定髙卑輪五星稱小均輪月離稱均輪或稱又次輪至於距日而生之輪月離稱次輪五星或稱次輪或稱年嵗輪然亦曰古稱小輪】今約以三者別之一曰本輪七政之平髙卑是也一曰均輪七政平髙卑之輪上又有小輪以加減之爲定髙卑此兩小輪相須爲用二而一者也一曰次輪月五星距日有逺近而生異行故曰次輪而五星次輪則直稱之嵗輪也

論七政兩種視行【七政從天月五星又從日】

問小輪有三又或爲二何也曰小輪舊只用二【一本輪一次輪】新法用三【一本輪一均輪一次輪】然而均輪者所以消息乎本輪爲本輪防細之用故曰二而一者也是則輪𨿽有三實則兩事而已何謂兩曰七政皆從天以生本輪而月五星又從乎日以生次輪天西行故七政之本輪皆從天而西轉其行皆向最髙也【日月五星之在本輪俱向本天最髙其本輪心離最髙一度本輪周亦行一度似爲所攝】日天東移故月五星之合望次輪皆從日而東運其行皆向日也【月五星離日若干次輪度亦行若干是爲日所攝】惟本輪從天於是有最髙卑之加減而其行度必始於最髙【本輪行始於本天最髙而均輪卽始於本輪之最髙卑故本輪均輪至最髙卑皆無加減爲起算之端】惟次輪從日於是有離日之加減而其行度必始於防日【月次輪行始於朔望星次輪始於合伏故月至朔望五星合日衝日皆無次輪加減】是故七政皆以半周天之宿度行縮歷半周天之宿度行盈歷歷宿度三百六十而本輪一周起最髙終最髙也【因最髙有行分故視周天稍贏然大致不變月之遲疾亦然】次輪則月以歷黃道一周而又過之凡三百八十九度奇而行二周起朔望終朔望也五星嵗輪【卽次輪】則土以行黃道十二度奇木以三十三度奇火以四百○八度奇金以五百七十五度奇水以一百十四度奇而皆一周起合伏終合伏也治歷者用三小輪以求七政之視行惟此二者故曰兩事也【金水二星防日後皆行黃道宿一周又復過之然後再與日防】

論天行遲速之原

問天有重數則在外者周徑大而其度亦大故土木之行遲在內者周徑小而其度亦小故金水月之行速七政之行勢略同特其度有大小而分遲速耳以是爲右旋之徴不亦可乎曰此必七政另爲一物以行於本天之上故可以度之大小爲遲速也今七政旣與天同體而非另爲一物則七政之東升西沒卽其本天之東升西沒也且使各天之行各自爲政則其性豈無緩急而自外至內舒亟之次如是其有等乎蓋惟七政之天𨿽有重數而總爲一天制動之權全在動天故近動天者不得不速近地而逺動天者不得不遲固自然之理勢也曰若是則周徑大小可勿論矣曰在外者爲動天所掣而西行速故其東移之差數遲又以其周徑大而分度闊則其差又遲是故恆星六七十年而始差一度近動天也然以周徑之大小準之此所差之一度以視月天將以周計矣在內者逺於動天而西行遲故其東移之差速又以其周徑小而分度狹則其差又速是故月天一日東移十三四度者近地而逺動天也然以周徑計之此所差之十三四度以視日天尙不能成一度矣然則周徑之大小但可兼論以考其差而非所以遲速之原也左旋之說可以無疑

論中分較分

問中分較分何也曰較分者是五星在最卑【本輪】時逐度【嵗輪周】次均之增數也凡算次均皆設嵗輪心在本輪最髙而逐度【嵗輪周】定其均數【或視差在輪心東爲加西爲減以生遲防逆防諸行】列之於表命曰次均再設心在最卑亦逐度定其均數所得必大於最髙法以先所得最髙時逐度之均數【卽次均】減之其餘爲較分若曰此嵗輪上逐度視差在最卑時應多此數也所以者何視差之理逺則見小近則見大嵗輪之在最卑去地爲近比在最髙必大故也

然則又何以有中分曰較分者次均之較而中分者又較分之較也使歳輪心常在最髙與最卑則只用次均與較分亦已足矣無如自最髙至最卑中間一百八十度嵗輪皆得逓居則次均之較各異【歳輪心行於本輪離最髙而下以漸近地則星在嵗輪周逐度所生之次均必皆漸大於在最髙時而心離最髙時時不等卽次均之所增亦必不等而較分悉變】勢不能一一爲表故以中分括之其法以本輪之度分爲主若嵗輪各度在本輪最卑時較分若干今在本輪他度則較分只應若干也故以最卑之較分命其比例爲六十分【卽中分之全分】而其餘自離最卑一度起各有所減減至最髙而無中分則亦無較分只用次均本數矣是故較分於次均恆爲加而以中分求較分則於較分恆爲減【表所列較分皆輪心在最卑之數各以中分乘之六十除之變爲輪心未至最卑之較分視在最卑皆爲小數】其比例爲嵗輪心在某度之較分與在最卑之較分若中分與六十分也故曰中分者較分之較也

再論中分

問中分之率旣皆以較分爲六十分之比例則皆以本輪度距最卑之逺近而得中分之多寡乃五星之中分各有異率何歟曰中分之率生於距地之逺近而五星各有其本天半徑之比例則其平行之距地逺近懸殊而兩心差亦各不同則又有本輪半徑與其本天半徑之比例矣至於嵗輪之大小復參錯而不齊如土木本天大而嵗輪小金星本天小而嵗輪大而火星在水星之上則火星本天大而嵗輪反大水星本天小而嵗輪反小積此數端而較分之進退紓亟攸分此五星之中分所以各一其率也要其以最卑爲較分之大差當中分之六十一而已矣

論回回歷五星自行度

問諸家多以五星自行度爲距日度然乎曰自行度生於距日逺近然非距日之度何也星在黃道有順有逆有疾有遲其距太陽無一平行而自行度終古平行故但可謂之距合伏之行而非距日之度也此在中土舊法則爲叚目其法合計前後兩合伏日數以爲周率周率析之爲疾行遲行退行及畱而不行諸叚之目疾與遲皆有順行度數退則有逆行度數其度皆黃道上實度也回歷不然其法則以前合伏至後合伏成一小輪小輪之心行於黃道而星體所行非黃道也乃行於小輪之周耳近合伏前後行輪上半順輪心東行而見其疾衝日前後行輪下半則逆輪心西行而見其遲畱且退其實星在輪周環轉自平行也故以輪周勻分三百六十度爲實前合伏至後合伏日率爲法除之得輪周毎日星行之平度是之謂自行度也若以距太陽言則順輪心而見疾距日之度必少逆輪心而遲退距日之度必多安所得平行之率哉故曰自行者星距合伏之行而非距日之行也

論回回歷五星自行度二

曰自行度旣非距日度又謂其生於距日何也曰星旣在輪周行矣而輪之心實行於黃道與太陽同爲右旋而有遲速當合伏時星與輪心與太陽皆同一度【星在輪之頂作直綫過輪心至太陽直射地心皆在黃道上同度如月之合朔】然不過晷刻之間而巳自是以後太陽離輪心而東輪心亦隨太陽而東太陽速輪心遲輪心所到必在太陽之後以遲減速而得輪心每日不及太陽之恆率是則爲距日行也【卽平行距日】然而輪心隨太陽東行星在輪周亦向太陽而東行太陽離輪心相距一度【黃道上度】星在輪周從合伏處【輪頂】東行亦離一度【小輪上度】太陽離輪心一象限【如月上】星在輪周亦離合伏一象限乃至太陽離輪心半周與輪心衝星在輪周亦離合伏半周居輪之底復與輪心同度而衝太陽【自輪頂合伏度作綫過輪心至星之體又過地心以至太陽黃道上躔度皆成一直綫如月之望】再積其度太陽離輪心之衝度而東輪心亦自太陽之衝度而東然過此以往太陽反在輪心之後假如輪心不及太陽積至三象限則太陽在輪心後只一象限【因其環行故太陽之行速在前者半周以後太陽反在輪心之後若追輪心未及者然○如月下】星在輪周亦然【自輪底行一象限則離輪頂合伏爲三象限而將復及合伏尙差一象限】逮太陽離輪心之度滿一全周而輪心與太陽復爲同度則星在輪周亦復至合伏之度而自行一周矣【星輪心太陽三者皆復同爲一直綫以直射地心如月第二合朔】凡此星行輪周之度無一不與輪心距日之度相應【主日而言則爲太陽離輪心之度主星而言則爲輪心不及太陽之距度其義一也】故曰自行之度生於距日然是輪心距日非星距日也

論回回歷五星自行度三

問輪心距日與星距日何以不同乎曰輪心距日平行星距日不平行惟其不平行是與自行度之平行者判然爲二故斷其非距日度也惟其平行是與自行度相應故又知其生於距日也

然則自行度不得爲星距日度獨不得爲輪心距日度乎曰輪心距日𨿽與自行相應能生其度然其度不同輪心是隨日東行倒算其不及於日之度星在輪周環行是順數其行過合伏之度不同一也又輪心距日是黃道度七政所同星離合伏自行是小輪周度小於黃道度又各星異率【小輪小於黃道而小輪周亦勻分三百六十度其度必小於黃道度而各星之小輪周徑各異度亦從之而異】不同二也若但以自行之初與日同度自行半周毎與日衝而徑以距日與自行混而爲一豈不毫釐千里哉

論新圖五星皆以日爲心

問五星天皆以日爲心然乎曰西人舊說以七政天各重相裹厥後測得金星有望之形故新圖皆以日爲心但上三星輪大而能包地金水輪小不能包地故有經天不經天之殊然以實數考之惟金水抱日爲輪確然可信若木火土亦以日爲心者乃其次輪上星行距日之迹非眞形也

凡上三星合伏后必在太陽之西而晨見於是自嵗輪最逺處東行而漸向下及距日之西漸逺至一象限內外星在嵗輪行至下半爲遲畱之界再下而退行衝日則居嵗輪之底此合伏至衝日在日西半周也衝日以後轉在日東而夕見又自輪底行而向上過遲畱之界而復與日合矣此衝日至合伏在日東半周也

故嵗輪上星行髙下本是在嵗輪上下而自太陽之相距觀之卽成大圎而爲圍日之形以日爲心矣其理與本輪行度成不同心天者同也

但如此則上三星之圎周左旋與金水異

夫七政本輪皆行天一周而髙卑之數以畢𨿽有最髙之行所差無防故可以本輪言者亦可以不同心天言也若嵗輪則不然如土星嵗輪一周其輪心行天不過十二度奇木星則三十三度奇上下旋轉止在此經度內不得另有天周之行知爲距日之虛迹也

又如金星嵗輪一周其輪心平行五百七十餘度則大於天周二百餘度水星嵗輪一周輪心平行一百一十五度奇則居天度三之一皆不可以天周言

惟火星嵗輪之周其平行四百餘度與天周差四十度數略相近故歷指竟云以太陽爲心而要之總是借虛率以求眞度非實義也

歷算全書卷三﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

欽定四庫全書

歷算全書卷四

宣城梅文鼎撰

歷學疑問補上

論西曆源流本出中土卽周髀之學

問自漢太初以來歷法七十餘家屢攺益精

本朝時憲歷集其大成兼采西術而斟酌盡善昭示來玆爲萬世不刋之典顧經生家或猶有中西同異之見何以徴信而使之勿疑曰歷以稽天有晝夜永短表景中星可攷有日月薄五星畱逆伏見淩犯可驗乃實測有慿之事旣有合於天卽當采用又何擇乎中西且吾嘗徴諸古籍矣周髀算經漢趙君卿所注也其時未有言西法者【唐開元始有九執歷直至元明始有回回歷】今攷西洋歷所言寒暖五帶之說與周髀七衡脗合豈非舊有其法歟且夫北極之下以半年爲晝半年爲夜赤道之下五穀一嵗再熟必非慿臆鑿空而能爲此言夫有所受之矣然而習者旣希所又略讀周髀者亦祗與山海經穆天子傳十洲記諸書同類並觀聊備奇聞存而不論已耳今有歐邏巴實測之算與之相應然後知所述周公受學商髙其說亦非無本而惜其殘缺不詳然猶幸存梗槪足爲今日之徴信豈非古聖人制作之精神有嘿爲呵防者哉

論蓋天與渾天同異

問西術旣同周髀是蓋天之學也然古歷皆用渾天渾天與蓋天原爲兩家豈得同歟曰蓋天卽渾天也其云兩家者傳聞誤耳天體渾圓故惟渾天儀爲能惟肖然欲詳求其測算之事必寫記於平面是爲蓋天故渾天如塑像蓋天如繪像總一天也總一周天之度也豈得有二法哉然而渾天之器渾員其度勻分其理易見而造之亦易蓋天寫渾度於平面則正視與斜望殊觀仰測與旁闚異法度有疏宻形有垤坳非深思造微者不能明其理亦不能制其器不能盡其用是則蓋天之學原卽渾天而微有精麄難易無二法也夫蓋天理旣精深傳者遂尠而或者不察但泥倚蓋覆槃之語妄擬蓋天之形竟非渾體天有北極無南極倚地斜轉出沒水中而其周不合荒誕違理宜乎揚雄蔡邕輩之辭而辟之矣蓋漢承秦後書器散亡惟洛下閎始爲渾天儀而他無攷據然世猶蓋天之名說者承訛遂區分之爲兩而不知其非也載攷容成作蓋天首作算數在黃帝時顓頊作渾天在後夫黃帝神靈首出又得良相如容城首皆神聖之人測天之法宜莫不備極精微顓頊蓋本其意而制爲渾員之器以發明之使天下共知非謂黃帝容成但知蓋天不知渾天而作此以釐正之也知蓋天與渾天原非兩家則知西曆與古歷同出一源矣【元史載仰儀銘以蓋天與安防宣夜等並稱六天而殊渾於蓋猶沿舊說續讀姚牧庵集有所攺定則已知渾蓋之非二法實爲先得我心詳見鼎所著二儀銘注】

論中土歷法得傳入西國之由

問歐羅巴在數萬里外古歷法何以得流通至彼曰太史公言幽厲之時疇人子弟分散或在諸夏或在四裔蓋避亂逃咎不憚逺涉殊方固有挾其書器而長徵者矣【如魯論載少師陽撃磬襄入於海鼔方叔入於河播鞀武入於漢故外域亦有律呂音樂之歷官遐遁而曆術逺亦如此爾又如言夏衰不窋失官而自竄於戎翟之間厥後公劉遷邠太王遷岐文王遷丰漸徙內地而孟子猶稱文王爲西夷之人夫不窋爲后稷乃農官也夏之衰而遂失官竄於戎翟然則羲和之苖裔屢經夏商之喪亂而流離播遷當亦有之太史公獨舉幽厲蓋言其甚者耳】然逺國之能言曆術者多在西域則亦有故堯典言乃命羲和欽若昊天歷象日月星辰敬授人時此天子日官在都城者蓋其伯也又命其仲叔分宅四方以測二分二至之日景卽測裏差之法也羲仲宅嵎夷曰暘谷卽今登萊海隅之地羲叔宅南交則交趾國也此東南二處皆濵大海故以爲限又和叔宅朔方曰幽都今口外朔方地也地極冷冬至於此測日短之景不可更北故卽以爲限獨和仲宅西曰昩谷但言西而不限以地者其地旣無大海之阻又自東而西气略同內地無極北嚴凝之畏當是時唐虞之聲教四訖和仲旣奉帝命測驗可以西則更西逺人慕徳景從或有得其一言之指授一事之畱傳亦卽有以開其知覺之路而彼中頴出之人從而擬議之以成其變化固宜有之考史誌唐開元中有九執歷元世祖時有札瑪魯丹測器有西域萬年曆明洪武初有瑪沙伊克瑪哈齊譯回回歷皆西國人也而東南北諸國無聞焉可以想見其涯略矣

論周髀中卽有地圓之理

問西曆以地心地面爲測算根本則地形渾圓可信而周髀不言地圓恐古人猶未知也曰周髀算經𨿽未明言地圓而其理其算已具其中矣試略舉之周髀言北極之下以春分至秋分爲晝秋分至春分爲夜蓋惟地體渾圓故近赤道則晝夜之長短漸平近北極則晝夜長短之差漸大推而至北極之下遂能以半年爲晝半年爲夜矣若地爲平面則南北晝夜皆同安得有長短之差隨北極髙下而異乎一也周髀又言日行極北北方日中南方夜半日行極東東方日中西方夜半日行極南南方日中北方夜半日行極西西方日中東方夜半蓋惟地體渾圓與天體相似太陽隨天左旋繞地環行各以其所到之方正照而爲日中正午其對衝之方在地影最深之處而卽爲夜半子時矣假令地爲平面東西一望皆平則日一出地而萬國皆曉日一入地而八表同昏安得有時刻先後之差而且有此方日中彼爲夜半者乎二也周髀又言北極之下不生萬物北極左右夏有不釋之冰物有朝耕暮獲中衡左右冬有不死之艸五穀一嵗再熟蓋惟地與天同爲渾圓故易地殊觀而寒暑迥別北極下地卽以北極爲天頂而太陽周轉近於地平陽光希微不能解凍萬物不生矣其左右猶能生物而以春分至秋分爲晝故朝耕而暮獲也若中衡左右在赤道下以赤道爲天頂春分時日在赤道其出正夘入正酉並同赤道正午時日在天頂其熱如火卽其方之夏春分以後日軌漸離赤道而北至夏至而極其出入並在正夘酉之北二十三度半有奇正午時亦離天頂北二十三度半奇其熱稍減而涼气以生爲此方之秋冬矣自此以後又漸向赤道行至秋分日復在赤道出入正夘酉而正過天頂一如春分熱之甚亦如之則又爲其方之夏矣秋分後漸離赤道而南直至冬至又離赤道南二十三度半奇而出入在正夘酉南正午亦離天頂南並二十三度半奇气復得稍涼又爲秋冬是故冬有不死之艸而五穀一嵗再熱也又其方日軌每日左旋之圏度並與赤道平行而終嵗晝夜皆平上條言地近赤道而晝夜之差漸平以此故也赤道旣在天頂則北極南極俱在地平可見然但言北極不言南極者中土九州在赤道北聖人治歷祗據所見之北極出地而精其測算卽南極可以類推然又言北極下地髙旁陀四隤而下卽地圓之大致可見非不知地之圓也卽如日月交常在朔望則日食時日月同度爲月所掩赤易知之事而春秋小雅但云日有食之古聖人祗舉其可見者爲言皆如是也

論渾蓋通憲卽古蓋天遺法

問蓋天必自有儀器今西洋歷仍用渾儀渾象何以斷其爲蓋天曰蓋天以平寫渾其器𨿽平其度則渾非不用渾天儀之測驗也是故用渾儀以測天星疇人子弟多能之而用平儀以稽渾度非精於其理者不能也今爲西學者多能制小渾儀小渾象至所渾蓋通憲者則能制者尠以此故也夫渾蓋平儀置北極於中心其度最宻次晝長規又次赤道規以漸而疏此其事易知又次爲晝短規在赤道規外其距赤道度與晝長規等理宜収小而今爲平儀所限不得不反展而大其經緯視赤道更濶以疏然以稽天度則七政之躔離可知以攷時刻則方位之加臨不爽若是者何哉其立法之意置身南極以望北極故近人目者其度加寛逺人目者其度加窄視法之理宜然而分秒忽微一一與勾股割圜之切綫相應非深思造微者必不能知也至於長規以外度必更寛更濶而平儀中不能容不得不割而棄之淺見者或遂疑蓋天之形其周不合矣是故渾蓋通憲卽古蓋天之遺制無疑也

論渾蓋通憲卽蓋天遺法二

問利氏始傳渾蓋儀而前此如回回歷並未言及何以明其爲古蓋天之器曰渾蓋𨿽利氏所然非利氏所創吾嘗徴之於史矣元史載札瑪魯丹西域儀象有所謂烏蘓都爾喇卜垣者其制以銅如圓鏡而可掛面刻十二辰位晝夜時刻此卽渾蓋之型模也又云上加銅條綴其中可以圓轉銅條兩端各屈其首爲二竅以對望晝則視日影夜則窺星辰以定時刻以占休咎此卽渾蓋上所用之闚筩指尺也又言皆嵌鏡片二面刻其圖凡七以辧東西南北日影長短之不同星辰向背之有異故各異其圖以盡天地之變此卽渾蓋上所嵌圓片依北極出地之圖而各一其圖凖天頂地平以知各方辰刻之不同與夫日出入地晝夜之長短及七政躔離所到之方位及其髙度也其圓片有七而兩面刻之則十四矣西洋𨿽不言占法然有其立象之學隨地隨時分十二宮與推命星家立命宮之法略同故又曰以占休咎也𨿽作史者未能深悉厥故而語焉不詳今以渾蓋徴之而一一脗合故曰渾蓋𨿽利氏所傳而非其所創也且利氏此器初不別立佳稱而名之曰渾蓋通憲固已明示其指矣然則何以不直言蓋天曰蓋天之學人屏絕之久矣驟舉之必駭而不信且夫殊蓋於渾乃治渾天者之沿謬而精於蓋天者原視爲一事未嘗區而別之也夫渾天儀必設於觀臺必如法安置而始可用渾蓋則懸而可掛輕便利於行逺爲行測之所需所以逺國得存其制而流至今也

論渾蓋之器與周髀同異

問渾蓋通憲豈卽周髀所用歟曰周髀書殘缺不完不可得攷據所言天象蓋笠地法覆槃又云笠以寫天而其制弗詳今以理揆之旣地如覆槃卽有圓突隆起之形則天如蓋笠必爲圓坳曲抱之象其制或當爲半渾圓而空其中略如仰儀之制則於髙明下覆之形體相似矣乃於其中按經緯度數以寫周天星宿皆宛轉而曲肖矣是則必以北極爲中心赤道爲邊際其赤道以外漸斂漸窄必別有法以相佐或亦是半渾圓內空之形而仍以赤道爲邊其赤道以南星宿並取其距赤道逺近求其經緯度數而圖之至於南距赤道甚逺不可見星之處亦遂可空之不用於是兩器相合卽周天可見之星象俱全備而無遺矣以故不知者因其極南無星遂妄謂其周不合而無南極也

又或寫天之笠竟展而平而以北極爲心赤道爲邊用割圓切綫之法以攷其經緯度數則周天之星象可一一寫其形容其赤道南之星亦展而平而以赤道爲邊查星距赤道起數亦用切綫度定其經緯則近赤道者距疏離赤道向南者漸宻而一一惟肖其不見之星亦遂可空之是𨿽不言南極而南極已在其中今西洋所作星圖自赤道中分爲兩卽此制也所異者西洋人浮海來賔行赤道以南之海道得見南極左右之星而補成南極星圖與古人但圖可見之星者不同然其理則一是故西洋分畫星圖亦卽古蓋天之遺法也

周髀云笠以寫天當不出坳平二制至若渾蓋之器乃能於赤道外展濶平邊以得其經緯遂能依各方之北極出地度而求其天頂所在及地平邊際卽晝夜長短之極差可見於是地平之經緯與天度之經緯相與錯綜參伍而如指諸掌非容成首諸聖人不能作也而於周髀之所言一一相應然則卽斷其爲周髀蓋天之器亦無不可矣夫法傳而久豈無微有損益要皆踵事而增其根本固不殊也利氏名之曰渾蓋通憲蓋其人彊記博聞故有以得其源流而不敢沒其實亦足以徴其人之賢矣

論簡平儀亦蓋天法而八綫割圓亦古所有

問西法有簡平儀亦以平測渾之器豈亦與周髀相應歟曰凡測天之器圓者必爲渾平者卽爲蓋【唐一行以平圖寫星象亦謂之蓋天所異者只用平度不曽以切綫分渾球上之經緯疏宻耳】簡平儀以平圓測渾圓是亦蓋天中之一器也今攷其法亦可以知一嵗中日道發南斂北之行可以知寒暑進退之節可以知晝夜永短之故可以用太陽髙度測各地北極之出地卽可用北極出地求各地逐日太陽之髙度推極其變而置赤道爲天頂卽知其地方之一年兩度寒暑而三百六旬中晝夜皆平若北極爲天頂卽知其地之能以半年爲晝半年爲夜而物有朝生暮獲凡周髀中所言皆可知之故曰亦蓋天中一器也但周髀云笠以寫天似與渾蓋較爲親切耳夫蓋天以平寫渾必將以渾圓之度按而平之渾蓋之器如剖渾球而空其中乃仰置几案以通明如玻瓈之片平掩其口則圓球內面之經緯度分映浮平面一一可數而變爲平矣然其度必中宻而外疏故用切綫【此如人在天中則渾天之內面乃正視也故寘北極於中心】簡平之器則如渾球嵌於立屏之內僅可見其半球而以玻瓈片懸於屏風前正切其球四面距屏風皆如球半徑而無欹側則球面之經緯度分皆可寫記而抑突爲平矣然其度必中濶而旁促故用正【此如置身天外以測渾天之外面故以極至交圏爲邊兩極皆安於外周以考其出入地之度乃旁視也】由是言之渾蓋與簡平異制而並得爲蓋天遺制審矣而一則用切綫一則用正非是則不能成器矣因是而知三角八綫之法並皆古人所有而西人能用之非其所創也伏讀

禦制三角形論謂眾角輳心以算弧度必古歷所有而流傳西土此反失傳彼則守之不失且踵事加詳至哉

聖人之言可以爲治歷之金科玉律矣

論周髀所之說必在唐虞以前

問周髀言周公受學於商髙商髙之學何所受之曰必在唐虞以前何以知之蓋周髀所言東方日中西方夜半云云者皆相距六時其相去之地皆一百八十度【地與天應其周度皆三百六十則其相對必一百八十】此東西差之極大者也細攷之則日在極東而東方爲日中午時則其地在極南者必見日初出地而爲卯時在極北者必見日初入地而

爲酉時故又云此四方者晝夜易處加四時相及【自南方卯至東方午爲四時自東方日中午至北方酉亦四時故每加四時則相及矣若以度計之實相距九十】又細分之則東西相距三十度必早晚差一時【如日在極南爲午時其西距三十度之地必見其爲已時而其東距三十度之地必見爲未時其餘地準此推之並同】相距十五度必相差四刻堯分命羲仲寅賔出日和仲寅餞內日者測此東西裏差也【寅賔寅餞互文見意非羲仲但朝測和仲但暮測也】又周髀所言北極下半年爲晝中衡下五穀一嵗再熟云云者其距緯皆相去九十度乃南北差之極大者也細考之北極髙一度則地面差數百十里【屢代所測微有不同今定爲二百五十里】而寒暑宻移晝夜之長短各異和叔羲叔分處南北以測此南北裏差也故曰此法之傳必在唐虞以前也夫東西差測之稍難若南北之永短因太陽之髙下而變日軌髙下又依北極之髙下而殊經商逺遊之輩稍知歷象卽能覺之羲和二叔奉帝堯之命考測日景一往極北一往極南相距七八千里之逺其逐地之極星髙下晝夜永短身所經歷乃瞢然不知何以爲羲和也哉是知地面之非平而永短以南北而差早晚以東西而異必皆羲和所悉知而敬授人時祗據內地幅員立爲常法其推測步算必有專書而亡於秦焰周髀其千百中之十一耳又何疑焉

論地實圓體而有背面

問地體渾圓旣無可疑然豈無背面曰中土聖人所產卽其面也何以言之五倫之教天所敍也自黃帝堯舜以來世有升降而司徒之五教人人與知若西方之佛教及天教𨿽其所言心性之理極其精微救度之願極其廣大而於君臣父子之大倫反輕此一徴也語言惟中土爲順若佛經語皆倒如雲到彼岸則必云彼岸到之類歐邏巴𨿽與五印度等國不同語言而其字之倒用亦同日本國賣酒招牌必云酒賣彼人亦讀中土書則皆於句中用筆挑剔作記而倒讀之北邊塞外及南徼諸國大略皆倒用其字此又一徴也往聞西士之言謂行數萬里來賔所歷之國多矣其土地幅員亦有大於中土者若其衣冠文物則未有過焉此又一徴也是知地體渾圓而中土爲其面故篤生神聖帝王以繼天建極垂世立教亦如人身之有面爲一身之精神所聚五藏之精並開竅於五官此亦自然之理也

論蓋天之學流西土不止歐邏巴

問佛經亦有四大州之說與周髀同乎曰佛書言須彌山爲天地之中日月星辰繞之環轉西牛賀州南瞻部州東勝神州北具盧州居其四面此則亦以日所到之方爲正中而日環行不入地下與周髀所言略同然佛經所言則其下爲華藏海而世界生其中須彌之頂爲諸天而通明故夜能見星此則不知有南北二極而謂地起海中上連天頂始如圓墖圓柱之形其說難通而彼且謂天外有天令人莫可窮詰故婆羅門等【婆羅門卽回回】皆爲所籠絡事之惟謹【唐書載回紇諸國多事佛回紇卽回回也】然回回國人能從事歷法漸以知其說之不足慿故遂自立門庭別立淸眞之教西洋人初亦同回回事佛【唐有波斯國人在此立大秦寺今所景教碑者其人皆自署曰僧】回回旣與佛教分而西洋人精於算復從回歷加精故又別立耶蘇之教以別於回回【觀今天教中七日一齋等事並略同回教其歷法中小輪心等算法亦出於回歷】要皆蓋天周髀之學流傳西土而得之有全有缺治之者有精有粗然其根則一也

論逺國所用正朔不同之故

問回歷及西洋歷旣皆本於蓋天何以二教所頒齋日其每年正朔如是不同曰天方國以十二个月爲年【卽回回國】歐邏巴以太陽過宮爲年月依嵗差而變此皆自信其歷法之善有以接古蓋天之道又見秦人蔑棄古三正而以己意立十月爲嵗首【今西南諸國猶有用秦朔者】故遂亦別立法程以新人耳目誇示四鄰【今海外諸國多有以十二个月爲年遵回歷也】蓋回國以歷法測驗疑佛說之非故謂天有主宰無影無形不宜以降生之人爲主其說近正【所異於古聖人者其所立拜念之規耳】厥後歐邏巴又於回歷研精故又自立教典奉耶蘇爲天主以別於回回然所稱一體三身降生諸靈怪反又近於佛教而大聲辟佛動則雲中國人錯了夫中土人倫之教本於帝王𨿽間有事佛者不過千百中之一二又何錯之云

今但攷其歷法則回回泰西大同小異而皆本於蓋天然惟利氏初入欲人之從其說故多方闡明其立法之意而於渾蓋通憲直露渾蓋之名爲今日所徴信蓋彼中之英賢也厥後曆書全部又得徐文定及此地諸文人爲之廣其畨譯爲歷家所取資實有功於歷學其他可以勿論若回回歷𨿽亦有所持之圓地球及平面似渾蓋之器而若露若藏不宣其義洪武時吳伯宗李翀奉詔翻譯亦但紀其數不詳厥防至數之後𨿽其本科亦莫稽測算之根所云烏蘓都爾喇卜垣之器竟無言及之者蓋失已久殊可惜耳

尢可深惜者回回泰西之歷旣皆本於蓋天而其所用正朔乃各自翻新出奇欲以自異其實皆非夫古者帝王欽若昊天順春夏秋冬之序以敬授人時出於自然何其正大何其易簡萬世所不能易也顧乃恃其巧算私立正朔以變亂之亦見其惑矣徐文定公之譯曆書也云鎔西洋之巧算入大統之型模非獨以尊大統也揆之事理固有不得不然者爾

測算以求天驗不難兼西術之長以資推步頒朔以授人時自當遵古聖之規以經久逺虛心以折其衷博考以求其當有志歷學者尙其念諸【余詳後論】

歷算全書卷四

欽定四庫全書

歷算全書卷五

宣城梅文鼎撰

歷學疑問補下

論太陽過宮

問舊曆太陽過宮與中气不同今何以復合爲一曰新曆之測算精矣然其中不無可商當俟後來詳定者則此其一端也何則天上有十二宮宮各三十度每嵗太陽以一中气一節气共行三十度【如冬至小寒共行三十度大寒立春又共行三十度其餘並同】滿二十四气則十二宮行一周故歷家恆言太陽一嵗周天也然而實考其度則一嵗日躔所行必稍有不足𨿽其所欠甚微【約其差不過百分度之一有半】積至年深遂差多度【六七十年差一度六七百年卽差十度】是爲嵗差歷家所以有天周嵗周之名【天上星辰勻分十二宮共三百六十度是爲天周每嵗太陽十二中气共行三百六十度防弱是爲嵗周】漢人未知嵗差誤合爲一故卽以冬至日交星紀而定之於牽牛逮晉虞喜等始覺之五代宋何承天祖衝之隋劉焯等言之益詳顧治歷者株守成說不敢輒用嵗差也至唐初傅仁均造戊寅元歷始用嵗差而朝論多不以爲然【亦如今人之不信西法人情狃於習見大扺皆然】故李淳風麟徳歷復去嵗差不用直至宗開元某年僧一行作大衍歷乃始博徴廣證以大暢厥防於是分天自爲天【卽周天十二次宮度其度終古不變】嵗自爲嵗【卽周嵗十二中气日躔所行天度其度嵗嵗微移】歷代遵用【所定嵗差年數微有不同而大致無異】元世祖時用授時歷郭守敬測定六十六年有八月而差一度回回泰西差法略同【今定爲七十年差一度數亦非逺】故冬至日一嵗日躔之度已周尙不能復於星紀之元度必再行若干日時而至星紀【十二中气皆同一理】所以太陽過宮與中气必不同日其法原無錯誤其理亦甚易知徐李諸公深於曆術豈反不明斯事乃復合爲一眞不可解推原厥故蓋譯曆書時誤仍回回歷太陽年之十二月名耳

問回回歷亦知嵗差何以誤用宮名爲月名曰回回歷旣以十二个月爲太陰年而用之紀嵗不用閏月然如是則四時之寒燠溫涼錯亂無紀因別立太陽年以周嵗日躔勻分三百六十度又勻分爲十二月以爲耕斂之節而起算春分是亦事勢之不得不然【堯典寅賔出日始於仲春卽此一事亦足徴西曆之本於羲和】但彼以春分爲太陽年之第一月第一日遂不得復用古人分至啟閉之法及春夏秋冬正名【古者以立春立夏立秋立冬春分秋分冬至夏至爲八節其四立並在四孟月之首以爲四時之節謂之啟閉二分二至並在四仲月之中居春夏秋冬各九十一日之半皆自然之序不可移易今回歷之太陽年旣以春分爲嵗首則是以仲春之後半月爲正旦而割其前半个月以益孟春共四十五日奇遂一並移之於嵗終而孟春之前半攺爲十一月之後半孟春之後半合仲春之前半共三十日攺爲十二月卽春夏秋冬之四時及分至啟閉之八節孟仲季之月名無一與之相應名不正則言不順遂不復可得而用矣】故遂借白羊等十二宮以名其太陽年之月彼非不知天度有嵗差白羊不能板定於春分然以其時春分正在白羊姑借此名之以紀月數【卽此而知回歷初起時其年代去今非逺】歐邏巴歷法因回歷而加精大致並同回歷故遂亦因之耳徐文定公譯曆書謂鎔西洋之精算入大統之型模則此處宜爲攺定使天自爲天嵗自爲嵗則嵗差之理明而天上星辰宮度各正其位矣【如晝夜平卽爲二分晝極長卽爲夏至不必問其日躔是何宮度是之謂嵗自爲嵗也必太陽行至降婁始命爲日躔降婁之次大陽行至鶉首始命爲日躔鶉首之次不必問其爲春分後幾日夏至後幾日是之謂天自爲天也】顧乃因仍回歷之宮名而以中气日卽爲交宮之日則嵗周與天周復混而爲一於是嵗差之理不明【如星紀之次常有定度而冬至之日度漸移是生嵗差若冬至日卽躔星紀嵗嵗相同安得復有嵗差】而天上十二次宮度名實俱亂【天上十二宮各有定星定度若隨節气移動則名實俱左後篇詳之】是故歷法至今日推步之法已極詳明而不無有待商酌以求盡善者此其一端也問者曰歷所難者推步耳若此等處攺之易易【但於各中气後查太陽實躔某宮之度卽過宮眞日】但曆書中所作諸表多用白羊金牛等宮名以爲別識今欲通身攺換豈不甚難曰否否曆書諸表𨿽以白羊金牛等爲題而其中之進退消長並從節气起算今但將宮名攺爲節气卽諸表可用不必攺造有何難哉【如歷從白羊起者卽攺白羊初度爲春分初度表從磨羯起者卽攺磨羯初度爲冬至初度曆書諸表依舊可用但正其名不攺其數更無煩於推算】

論周天十二宮並以星象得名不可移動

問天上十二宮亦人所名今隨中气而移亦何不可之有曰十二宮名𨿽人所爲然其來久矣今攷宮名皆依天上星宿而定非漫說者如南方七宿爲朱鳥之象【史記天官書栁爲鳥注注卽咮咮者朱鳥之喙也七星頸爲員官頸朱鳥頸也員官嚨防也張爲素素卽嗉鳥受食之處也翼爲羽翮朱鳥之翼】故名其宮曰鶉首鶉火鶉尾【鶉卽朱鳥乃鳳也】東方七宿爲蒼龍【天官書東宮蒼龍房心心爲明堂今按角二星象角故一名龍角氐房心象龍身心卽其當心之處故心爲明堂尾宿卽龍之尾】故其宮曰壽星【封禪書武帝詔天下尊祀靈星正義靈星卽龍星也張晏曰龍星左角曰天田則農祥也見而祀之】曰大火【心爲大火】曰析木【一名析木之津以尾箕近天河也】北方七宿爲武【天官書北宮武】其宮曰星紀【古以鬥牛爲列宿之首故星自此紀也】曰枵【枵者虛也卽虛危也又象龜蛇爲武也】曰娵訾【一名娵訾之口以室壁二宿各二星兩兩相對而形正方故象口也】西方七宿爲白虎【天官書奎曰封豕參爲白虎三星直者是爲衡其外四星左右肩股也小三星隅置曰觜觽爲虎首】其宮曰降婁【以婁宿得名也】曰大梁曰實沈由是以觀十二宮名皆依星象而取非漫設也堯典日中星鳥以其時春分昏刻朱鳥七宿正在南方午地也日永星火以其時夏至初昏大火宮在正午也【火卽心宿】宵中星虛以其時秋分昏中者枵宮也卽虛危也日短星昴以其時冬至昏中者昴宿也卽大梁宮也歷家以嵗差攷之堯甲辰至今已四千餘嵗嵗差之度已及二宮【以西率七十年差一度約之凡差六十餘度】然而天上二十八舎之星宿未嘗變動故其十二宮亦終古不變也若夫二十四節气太陽躔度盡依嵗差之度而移則嵗嵗不同七十年卽差一度【亦據今西術推之】安得以十二中气卽過宮乎試以近事徴之元世祖至元十七年辛巳冬至度在箕十度至今康熙五十八年己亥冬至在箕三度其差蓋已將七度而卽以箕三度交星紀宮則是至元辛巳之冬至宿【箕十度】已攺爲星紀宮之七度再一二百年則今己亥之冬至宿【箕三度】爲星紀宮之初度者又卽爲星紀宮之第三度而尾宿且浸入星紀矣積而久之必將析木之宮【尾箕】盡變爲星紀大火之宮【氏房心】盡變爲析木而十二宮之星宿皆差一宮【凖上論之角亢必爲大火翼軫必爲壽星柳星張必爲鶉尾井鬼必爲鶉火而觜參爲鶉首胃昴畢爲實沈奎婁爲大梁而娵訾爲降婁虛危爲娵訾鬥牛爲枵二十八宿皆差一宮】卽十二宮之名與其宿一一相左又安用此名乎再積而久之至數千年後東宮蒼龍七宿悉變武【嵗差至九十度時角亢氐尾心房箕必盡變爲星紀枵娵訾並仿此】南宮朱鳥七宿反爲蒼龍西宮白虎七宿反爲朱鳥北宮武七宿反爲白虎國家頒歷授時以欽若昊天而使天上宿度宮名顚倒錯亂如此其可以不亟爲釐定乎

又試以西術之十二宮言之夫西洋分黃道上星爲十二象𨿽與羲和之舊不同然亦皆依星象而名非漫設者如彼以積屍气爲巨蠏第一星蓋因鬼宿四星而中央白气有似蠏筐也所雲天蠍者則以尾宿九星捲而曲其末二星相並如蠍尾之有岐也所云人馬者謂其所圖星象類人騎馬上之形也其餘如寶瓶如雙魚如白羊如金牛如陰陽如獅子如雙女如天秤以彼之星圖觀之皆依稀彷佛有相似之象故因象立名今若因節气而每嵗移其宮度積而久之宮名與星象相離俱非其舊而名實盡淆矣

又按西法言嵗差謂是黃道東行未嘗不是如今日鬼宿已全入大暑日躔之東在中法嵗差則是大暑日躔退回鬼宿之西也在西法則是鬼宿隨黃道東行而行過大暑日躔之東其理原非有二尾宿之行入小雪日躔東亦然夫旣鬼宿已行過大暑東而猶以大暑日交鶉火之次則不得復爲巨蠏之星而變爲師子矣尾宿已行過小雪後而猶以小雪日交析木之次則尾宿不得爲天蠍而變爲人馬宮星矣卽詢之西來知歷之人有不啞然失笑者乎

論西法恆星嵗卽西月日亦卽其齋日並以太陽過宮爲用而不與中气同日

問西法以太陽防恆星爲嵗謂之恆星年恆星旣隨黃道東行則其恆星年所分宮度亦必不能常與中气同日曆書何以不用曰恆星年卽其所頒齋日也其法以日躔斗四度爲正月朔故曰以太陽防恆星爲嵗也其斗四度蓋卽其所定磨羯宮之初度也【在今時冬至後十二日】自此日躔行滿三十度卽爲第二月交寶瓶宮【餘月並同皆以日躔行滿三十度交一宮卽又爲一月而不論節气】然其十二月之日數各各不同者以黃道上有最髙卑差而日躔之行度有加減也【如磨羯宮日躔最卑行速故二十八日而行一宮卽成一月若巨蠏宮日躔最髙行遲故三十一日而行一宮始成一月其餘宮度各以其或近最卑或近最髙遲速之行不同故日數皆不拘三十日並以日躔交宮爲月不論節气】是則其所用各月之第一日卽太陽交宮之日原不與中气同日而且嵗嵗微差至六七十年恆星東行一度卽其各宮並東行一度而各月之初日在各中气後若干日者又增一日矣【如今以冬至後十二日爲嵗首至嵗差一度時必在冬至後十三日余盡然】此卽授時歷中气後幾日交宮之法乃嵗差之理本自分曉而曆書中不甚發揮斯事者亦有故焉一則以月之爲言本從太陰得名故必晦朔望周而後謂之月今反以太陽所躔之宮度爲月而置朔望不用是名爲月而實非月大駭聽聞一也又其第一月旣非夏正孟春亦非周正仲冬又不用冬至日起算非歷學履端於始之義事體難行二也又其所用齋日卽彼國所頒行之正朔歐邏巴人私奉本國之正朔宜也中土之從其教者亦皆私奉歐邏之正朔謂國典何故遂隠而不宣三也【初造曆書事事闡發以冀人之信從惟此齋日但每嵗單伊教不筆於書】然曆書所引彼中之舊測每稱西月日者皆恆星年也其法並同齋日皆依恆星東行以日躔交磨羯宮爲嵗旦而非與冬至中气同日也此尢爲太陽過宮非中气之一大證據矣

或曰曆書所引舊測多在千餘年以前然則西月日之興所從來久矣曰殆非也唐始有九執歷元始有回回歷歐邏巴又從回歷加精必在回歷之後彼見回回歷之太陰年太陽年能變古法以矜奇創故復變此西月日立恆星年以勝之若其所引舊測蓋皆以新法追攺其月日耳

論恆气定气

問舊法節气之日數皆平分今則有長短何也曰節气日數平分者古法謂之恆气【以嵗周三百六十五日二十四刻奇平分爲二十四气各得一十五日二十一刻八十四分奇】其日數有多寡者謂之定气【冬至前後有十四日奇爲一气夏至前後有十六日爲一气其餘節气各各不同並以日行盈歷而其日數減行縮歷而其數增】二者之算古歷皆有之然各有所用唐一行大衍歷議曰以恆气注歷以定气算日月交食是則舊法原知有定气但不以之注歷耳譯西法者未加詳考輒謂舊法春秋二分並差兩日則厚誣古人矣夫授時歷所注二分日各距二至九十一日奇乃恆气也【歷經歷艸皆明言恆气】其所注晝夜各五十刻者必在春分前兩日奇及秋分後兩日奇則定气也定气二分與恆气二分原相差兩日授時旣遵大衍歷議以恆气二分注歷不得復用定气故但於晝夜平分之日紀其刻數則定气可以互見非不知也且授時果不知有定气平分之日又何以能知其日之爲晝夜平分乎夫不知定气是不知太陽之有盈縮也又何以能算交食何以能算定朔乎【經朔猶恆气定朔猶定气望與上下亦然】夫西法以最髙卑防盈縮其理原精初不必爲此過當之言良由譯書者並從西法入手遂無暇參稽古歷之原流而其時亦未有能眞知授時立法之意者爲之援據古義以相與虛公論定故遂有此等偏說以來後人之疑議不可不知也

其所以爲此說者無非欲以定气注歷使春秋二分各居晝夜平分之日以見授時古法之差兩日以自顯其長殊不知授時是用恆气原未嘗不知定气不得爲差而西法之長於授時者亦不在此以定气注歷不足爲奇而徒失古人置閏之法欲以自暴其長反見短矣故此處宜酌攺也後條詳之

再論恆气定气

問授時旣知有定气何爲不以注歷曰古者注歷只用恆气爲置閏地也春秋傳曰先王之正時也履端於始舉正於中歸邪於終【邪與餘同謂余分也】履端於始序則不愆舉正於中民則不惑歸邪於終事則不悖蓋謂推步者必以十一月朔日冬至爲起算之端故曰履端於始而序不愆也又十二月之中气必在其月如月內有冬至斯爲仲冬十一月月內有雨水斯爲孟春正月月內有春分斯爲仲春二月餘月並同皆以本月之中气正在本月三十日之中而後可名之爲此月故曰舉正於中民則不惑也若一月之內只有一節气而無中气則不能名之爲何月斯則余分之所積而爲閏月矣閏卽余也前此余分累積歸於此月而成閏月有此閏月以爲余分之所歸則不致春之月入於夏且不致今冬之月入於明春故曰歸邪於終事則不悖也然惟以恆气注歷則置閏之理易明何則恆气之日數皆平分故其每月之內各有一節气一中气【假如冬至在十一月朔則必有小寒在其月望後若冬至在十一月晦則必冇大雪節气在其月望前餘月並然】此兩气策之日合之共三十日四十三刻奇以較每月常數三十日多四十三刻奇謂之气盈又太陰自合朔至第二合朔實止二十九日五十三刻奇以較每月三十日又少四十六刻奇謂之朔虛合气盈朔虛計之共餘九十刻奇謂之月閏乃每月朔策與兩气策相較之差也【假如十一月經朔與冬至同時刻則大寒中气必在十二月經朔後九十刻而雨水中气必在次年正月經朔後一日又八十刻奇其餘月並準此求之】積此月閏至三十三个月間【卽二年零九个月】其餘分必滿月策而生閏月矣閏月之法其前月中气必在其晦後月中气必在其朔則閏月只有一節气而無中气然後名之爲閏月【假如閏十一月則冬至必在十一月之晦大寒必在十二月之朔而閏月只有小寒節气更無中气則不可謂之爲十一月亦不可謂之爲十二月卽不得不名之爲閏月矣】斯乃自然而然天造地設無可疑惑者也一年十二个月俱有兩節气惟此一个月只一節气望而知其爲閏月今以定气注歷則節气之日數多寡不齊故遂有一月內三節气之時又或有原非閏月而一月內反只有一中气之時其所置閏月𨿽亦以余分所積而置閏之理不明民乃惑矣然非西法之咎乃譯書者之疏略耳何則西法原只有閏日而無閏月其仍用閏月者遵舊法也亦徐文定公所謂鎔西洋之巧算入大統之型模也按堯典云以閏月定四時成嵗乃帝堯所以命羲和萬世不刋之典也今旣遵堯典而用閏月卽當遵用其置閏之法而乃不用恆气用定气以滋人惑亦昧於先王正時之理矣是故測算𨿽精而有當酌攺者此亦一端也

今但依古法以恆气注歷亦仍用西法最髙卑之差以分晝夜長短進退之序而分注於定气日之下卽置閏之理昭然眾著而定气之用亦並存而不廢矣

又按恆气在西法爲太陽本天之平行定气在西法爲黃道上視行平行度與視行度之積差有二度半弱西法與古法略同所異者最髙衝有行分耳古法恆气注歷卽是用太陽本天平行度數分節气

論七政之行並有周有轉有交

問月五星之行並有周天有盈縮遲疾有出入黃道之交防共三事也太陽亦然乎曰並同也太陽終古行黃道則無出入黃道之交然而黃道出入於赤道亦可名交是故春秋二分卽其交亦如月離之有正交中交也因此而日躔有南陸北陸之行古者謂之發斂【行南陸爲發行北陸爲斂並以其離北極之逺近言之】於是而四時之寒燠以分晝夜刻之永短有序皆交道之所生以成嵗周是故嵗周者卽太陽之交道也與月離之交終同也然以嵗差之故【西法謂之黃道東行】故每嵗三百六十五日二十四刻奇【此以授時古率言之】已滿嵗周矣又必加一刻有半【亦依古率約之】始能復躔冬至元度【假如本年冬至日躔箕宿三度八十分次年冬至必在箕宿三度七十分奇是嵗序已周而元度未復故必於三百六十五日二十四刻奇之外復加一刻有半始能復躔於箕三度八十分】是爲太陽之周天與月行之周天同也月行周天與交終原非一事是故太陽之周天與嵗周原爲兩事也然太陽之行有半年盈歷半年縮歷卽恆气定气之所由分【古法起二至西法起最髙衝尢爲親切】亦如月離之轉終是又爲一事合之前兩者【嵗周與周天】共爲三事乃七政之所同也

按月離交終以二十七日二十一刻奇而陰曆陽曆之度一周在月周天前以較周天度爲有欠度也轉終以二十七日五十五刻奇而遲歷疾歷之度一周在月周天后以較周天度爲有餘度也月周天之日數在二者之間亦二十七日又若干刻而周𨿽同大餘不同小餘當其起算之初所差不過數度【如交終與轉終相差三十四刻奇卽其差度爲四五度】積至一年卽差多度【太陰每年行天十三周半卽相差六十餘度】故其差易見日躔嵗周以二十四節气一周爲限因有恆星東行之嵗差故其度在周天前以較周天度爲有欠分也【約爲七十分度之一】日躔盈縮以盈初縮末縮初盈末一周爲限因最髙有行分故其度在周天后以較周天度爲有餘分也【亦約爲七十分度之一】以一嵗言之三者並同大餘卽小餘亦不甚逺【嵗周三百六十五日二十四刻奇增一刻半卽周天又增一刻半卽盈縮歷周但差刻不差時】積其差至七十年卽各差一度【嵗周不及周天七十年差一度卽恆星東行之嵗差而盈縮歷至七十年又過於周天一度卽最髙之行於是嵗周與盈縮歷周共相差二度並至七十年而後知之也】故其差難見【七十年只差一度故難見也】然𨿽難見其理則同【以周天之度爲主則嵗周之差度退行亦如太陰交終差度之毎交逆退也而盈縮入歷之差度於周天爲順行亦如太陰之轉終差度毎轉順行也而周天度則常不動】但以太陰之交轉周比例之則判然三事不相淩雜矣

問歷法中所設交差轉差卽此事乎曰亦微有不同蓋交差轉差是以交終轉終與朔策相較【或言其日或言其度並同】玆所論者是以交終轉終與周天相較故其數不同也其數不同而歷法中未言者何也緣歷家所言在交食故於定朔言之綦詳而月之周天反略惟陳星川【壤】袁了凡【黃】所撰歷法新書明立太陰周天日數謂之月周與交終轉終並列爲三實有禆於歷學而人或未知故特著之

又徴之五星亦皆有周天有歷周【卽盈縮如月之入轉】有正交中交是故此三事者日月五星之所同也知斯三者於歷學思過半矣【外此則月有朔望五星有叚目並以距日之逺近而生故大陽所與月五星同者惟此三事】

論月建非專言斗柄

問行夏之時謂以斗柄初昏建寅之月爲嵗首議者以冬至旣有嵗差則斗柄亦從之攺度今時正月不當仍爲建寅其說然乎曰不然也孟春正月自是建寅非闗斗柄其以初昏斗柄建寅者注釋家未深攷也何則自大撓作甲子以十日爲天干【自甲至癸】十二子爲地支【自子至亥】天道圓故以甲乙居東丙丁居南庚辛居西壬癸居北戊巳居中參同契所謂靑赤白黒各居一方皆稟中央戊巳之功也十干以配五行圓轉周流故曰天干也地道方故以寅夘辰列東巳午未列南申酉戍列西亥子丑列北易大傳所謂帝出乎震齊乎防相見乎離致役乎坤說言乎兌戰乎乾勞乎坎成言乎艮自東而南而西而北其道左旋周而復始也是十二支以配四時十二月靜而有常故曰地支也天干與地支相加成六十甲子以紀嵗紀日紀時而皆凖於月以嵗有十二月也此乃自然而然之序不可增減不可動移是故孟春自是寅月何嘗以斗柄指寅而後謂之寅月哉如必以斗柄指寅而謂之寅月則亦有寅年寅月寅時豈亦以斗柄指寅而後得以謂之寅乎是故堯典命羲仲宅嵎夷平秩東作以殷仲春次命羲叔宅南交平秩南訛以正仲夏次命和仲宅西平秩西成以殷仲秋次命和叔宅朔方平在朔易以正仲冬此四時分配四方而以春爲嵗首之證也夫旣有四仲月以居夘午酉子之四正則自各有孟月季月以居四隅仲春旣正東爲夘月其孟春必在東之北而爲寅月何必待斗柄指寅乎故日中星鳥日永星火宵中星虛日短星昴並祗以晝夜刻之永短爲慿以昏中之星爲斷未嘗一言及於斗柄也又攷孔子去堯時已及千五百嵗嵗差之度已二十餘度若堯時斗柄指寅孔子時必在寅前二十度而指醜矣豈待今日而後知乎然孔子但言行夏之時蓋以孟春爲嵗首於時爲正非以斗柄指寅而謂之寅月也又攷嵗差之法古𨿽未言然而月令昏中之星已不同於堯典則實測當時之星度也然堯典祗舉昏中星而月令兼言旦中又舉其日躔所在又於堯典四仲月之外兼舉十二月而備言之可謂詳矣然未嘗一語言斗杓指寅爲孟春

又攷史記律書以十律配十二月之所建地支而疏其義兼八風二十八舎以爲之說而並不言斗建惟天官書略言之其言曰杓擕龍角衡殷南斗魁枕參首用昏建者杓夜半建者衡平旦建者魁是則衡亦可言建魁亦可言建而非僅斗杓夜半亦有建平旦亦有建而非止初昏其言甚圓以是而知正月之爲寅二月之爲卯皆一定不可移而斗之星直之卽謂建固非以初昏斗柄所指而命之爲何月也然則謂行夏之時是以斗柄建寅之月爲嵗首者蓋注釋家所據一家之說而未詳厥故也今乃遂據其說而欲攺正月之建寅可乎不可乎

再論斗建

問說者又以各月斗柄皆指其辰惟閏月則斗柄指兩辰之間由今以觀其說亦非歟曰非也周天之度以十二分之各得三十度奇【在西法爲三十度】凡各月中气皆在其三十度之中半各月節气皆居其三十度之首尾今依其說斗柄所指各在其月之辰則交節气日斗柄所指必在兩辰之間矣【假如立春爲正月節則立春前一日斗柄所指在醜立春後一日斗柄指寅而立春本日斗柄所指必在丑與寅之間餘月皆然】十二節气日皆指兩辰之間又何以別其爲閏月乎若夫閏月則只有節气無中气其節气之日固指兩辰之間矣然惟此一日而已其前半月後半月並非兩辰之間也【假如閏正月則雨水中气在正月晦春分中气在二月朔而閏月只有驚蟄節在月望則其前半月必指寅後半月必指卯惟驚蟄日指寅與卯之交界縫中可謂之兩辰間閏在餘月亦然】地盤周圍分爲十二辰首尾鱗次如環無端又何處設此三十度於兩辰間以爲閏月三十日之所指乎凡若此等習說並由未經實測而但知斗杓所指爲月建遂岐中生岐成此似是而非之解天下事每壊於一知半解之人往往然也

又按斗柄之星距北極只二十餘度必以北極爲天頂而後可以定其所指之方今中土所處在斗杓之南仰而觀之斗杓與辰極並在天頂之北其斗杓所指之方位原難淸楚故古人祗言中星不言斗杓蓋以此也【如淮南子等書言招揺東指而天下皆春不過大槪言之原非以此定月】

又按言營室之中土功其始火之初見期於司裏又言水昏正而栽日至而畢詩亦言定之方中作於楚宮又言七月流火九月授衣古之人以星象授人時如此者不一而足也若以嵗差攷之則於今日並相差一二旬矣然而當其時各據其時之星象爲之著令所以使民易知也而終未有言斗杓指何方而作何事者則以其方位之難定也十二月建之非闗斗柄明矣是故斗柄𨿽因嵗差而所指不同正月之建寅不可易也

論古頒朔

問論語子貢欲去告朔之餼羊孔子不然其說曰我愛其禮不知周制頒歷其式如何曰頒朔大典也蓋王政在其中矣古者天子常以冬月頒來嵗十二月之朔於諸侯諸侯受而藏諸祖廟月朔則以特羊告廟請而行之如是其隆重者何也蓋旣曰請而行之則每月內各有當行之政令頒於天子而諸侯奉行惟謹焉故告朔之後卽有視朔聽朔之禮所以申命百官有司以及黎庶相與恪遵以奉一王之大法此之謂奉正朔也是故大之有朝覲防同之期有鄰國聘問之節有天子巡狩朝於方嶽之時【此等大禮皆以年計而必冇定期如虞書東巡狩必於仲春南巡狩必於仲夏之類】其於宗廟也有禴祠烝嘗四時之祭有畊籍田夫人親蠶以預備粢盛衣服之需其於羣神也有山川社稷祈谷報嵗八蠟五祀之典其於黌序也有上丁釋菜冬夏詩書春秋羽籥之制其於農事也有田畯勸農播種収獲溝洫隄防築場納稼之務有飲射讀法遒人徇鐸之事其於軍政也有搜苖狝狩振旅治兵之政其於土功也有公旬三日之限其於刑罰也有宥過釋滯折獄致刑之月又如藏冰用冰出火內火仲夏斬陽木仲冬斬陰木獺祭魚然後漁人入澤梁豺祭獸然後田獵之類凡若此者皆順四時之序以爲之典章先王之所以奉若天道也而一代之典制旣藏之太府恪守無斁矣又毎嵗頒示諸侯以申命之諸侯又於每月之朔告於祖廟請而奉行之天子本天以出治無一事敢違天時諸侯奉天子以治其國無一事不遵王命以上順天時唐虞三代所以國無異俗家無異教道徳一而風俗同蓋以此也故曰頒朔告朔實爲大典而王政因之以行也周旣東遷矣王政不行魯不吿朔他國可知蓋視爲弁髦久矣厥後遂有司曆再失閏之愆而大夫陪臣之僭亂紛紛矣以秉禮之國而棄王朝大典何怪其羣相效尢是故夫子曰我愛其禮蓋庶幾因此羊而念及先王之典也如謂頒朔祗以識月之大小辧朔望生明死魄之干支何取乎每月告廟之繁文也哉由是以觀則三代時所頒之歷可知己矣

論歷中宜忌

問歷法中宜忌之說古有之乎曰無之也蓋起近代耳堯之命羲和也曰敬授人時曰東作西成曰允釐百工庶績咸熙歷之大用蓋如此也何嘗有選擇之事乎司馬遷曰閱陰陽之書使人拘而多畏其說蓋起於戰國之時夫箕子陳洪範其七曰稽疑古者有大政旣斷之於主心又謀及卿士謀及庶人矣然必謀及卜筮古聖人不敢自專自用而必協謀於神人蓋其愼也戰國力爭此義不明太卜筮人之官廢疑事無所決陰陽家言乃紛然以出矣隋唐之季其說愈多故呂才援引古義著論以非之可謂深切著明矣然而教化不行吉凶福禍之說深中於人心黠者乘之各立異說以恫喝聾俗愈出愈攴六十干支而選擇之書乃有九十餘家同此一日而此以爲大吉彼以爲大凶令人無所適從誣民惑世莫此爲甚今官歷宜忌本於選擇曆書不知其爲元時所定明初所定然攷史誌歷代言歷者初無一字及於選擇又如羅計四餘郭守敬歷經所無而大統增入之然則此等不經之說並元統郭伯玉等所爲耳原其初意或亦欲假此以定民之趨然官歷𨿽頒宜忌而民間偏惑通書通書旣非一種而術者私書更多𨿽戶說以渺論不能止也今若能一切刪去只載宜行政事及南北耕耘収獲之節則唐虞三代敬天勤民之至意復覩今日豈不快哉

洪武中解大紳庖西封事曰治歷明時授民作事但申播植之宜何用建除之謬方向煞神事甚無謂孤虛宜忌亦且不經東行西行之論天徳月徳之云臣料唐虞之歷必無此等之文所宜著者日月之行星辰之次仰觀俯察事合逆順七政之齊正此類也按此說甚正惜當時不能用然實爲定論聖人所不易也

論治歷當先正其大其分秒微差可無深論

問歷法至今日可謂詳且宻矣然徴諸交食亦或有微差之刻何歟曰此可以不必深論者也攷漢時不知定朔故日食或不在朔或差而前則食於晦差而後則食於初二日直至唐李淳風麟徳歷始用定朔於是蝕必在朔無差日矣然尙有差時厥後大衍歷所推益宻宣明歷又立气刻時三差至宋統天歷紀元歷又加詳焉迨元授時歷遂無差時但有差刻今西曆言東西南北差以黃道九十度限爲宗其理益明其法益善然而亦或有時而差刻分者何也今夫盆盎之中可以照物池沼澄淸則岸上之人物花鳥山陵樹木畢現其中然而其邊際所域必有所攺易兩鏡相照則多鏡層現於一時而六層以上必有所窮況乎以八尺之璣衡測大圓之宮度其大小之比例道裏之遼濶不可以億計而因積之多用算之巧遂致交食應期復應東西南北方向胥符而但有晷刻之後先分秒之同異卽謂之不差可矣國家治歷所重者順天出治以敬授人時日食之類所重在於修省至於時刻小差原非所重但當令司曆者細加測詳紀其所差之數以待後來修歷者使有所據依以益精其推步而已斷不可因小節之微差而輒更成法也漢唐宋歷法屢攺而多不效元明三四百年守一授時法而交食不效只數事而已況今新曆又加精於授時何必復加更變乎或謂歷算之差由於尾數予謂此一端耳尾數有丟収無闗大數所難者乃根數耳盈縮遲疾之根𨿽有離朱無所施其目並由年深日久然後知之又如最髙之行利氏所定與今所用不同皆根之差歷所以取象於革也

歷算全書卷五

欽定四庫全書

歷算全書卷六

宣城梅文鼎撰

歷學答問

答祠部李古愚先生

歷算之學散見經史固儒者所當知然其事旣不易明而又不切於日用故學者置焉博覽之士稍渉大端自謂已足欲如絳縣老人能自言其生之四百四十四甲子者固已鮮矣況能探討其義類乎明公夙夜在公日懋勤於職業而心閒若水孜孜好學用其心於人所不用之處眞不易得鼎𨿽疎淺無似敢不勉竭鄙思以仰答下問之勤乎謹條於左

問授時大統二歷歷元並嵗實積日日法諸數

按歷元云者歷家起算之端也然授時歷元之法與古不同請先言古法古人治歷必先立元元正然後定日法法立然後度周天其法皆據當時實測以驗諸前史所傳又推而上之至於初古之時取其嵗月日時皆防甲子又在朔旦而日月五星皆同一度以此爲起算之端是謂歷元自歷元順數至今造歷之時凡歷幾何嵗月是爲積年旣有積年卽有積日而此積日若用整數則遇﨑零難以入算而不能使歷元無餘分故必析此一日爲若干分使七曜可以通行而上可以合歷元下不違於實測是爲日法卽一日之細分也用此細分自一日積之至於二百六十五日又四分日之一弱使一嵗之日盡化爲分是爲嵗實古歷太陽每日行一度則日法卽度法於是仍用此細分自一度積之至於三百六十五度又四分度之一弱使其度亦盡化爲分是爲周天數者相因乃作歷之根本自漢太初歷以後歷晉唐五代宋遼金諸家歷法代有攺憲然其規模次第皆大同而小異耳

右古法歷元等項

惟元授時歷不然其說以爲作歷當憑實測而必逆推上古虛立積年必將遷就其畸零之數以求密合旣有遷就久則易差故不用積年之法而斷自至元十七年辛巳嵗前天正冬至爲元上考往古下驗將來皆自此起算棄虛立之元用實測之度順天求合一無遷就可謂開拓萬古之心胸者矣至於大統則以洪武十七年甲子爲元然特易其名而已一切步算皆本授時名𨿽洪武甲子實用至元辛巳也

右授時大統歷元

惟授時不用積年故日法亦可不立而徑以萬分爲日萬分者日有百刻刻有百分故一萬也古諸家歷法𨿽皆百刻而刻非百分其日法皆有畸零授時以萬分爲日竟是整數故曰不用日法然卽此是其日法矣

右授時日法大統同

授時旣以萬分爲日故其嵗實三百六十五萬二千四百二十五分其數自辛巳嵗前天正冬至【卽庚辰年十一月中气】積至次年壬午嵗前天正冬至【卽辛巳本年十一月中气】共得三百六十五日二十四刻二十五分也若逆推前一年亦是如此【如是庚辰年十一月冬至逆推至巳卯年十一月冬至亦是三百六十五日二十四刻二十五分】此嵗實之數大統與授時並同

然授時原有消長之法是其新意其法自辛巳元順推至一百年則嵗實當消一分【依法推至洪武十四年辛酉滿一百年其嵗實消一分爲三百六十五日二十四刻二十四分】若自辛巳元逆推至一百年則嵗實當長一分【依法推至宋孝宗淳熙八年辛丑滿一百年嵗實長一分爲三百六十五日二十四刻二十六分】每相距增一百年則嵗實消長各增一分以是爲上考下求之準

大統諸法悉遵授時獨不用消長之法上考下求總定爲三百六十五日二十四刻二十五分此其異也

右授時大統嵗實

嵗實卽一年之日數也自一年以至十年百年共積若干是爲積日亦謂之中積分【上考下求皆距至元辛巳立算】

假如今康熈庚午嵗相距四百零九算【自辛巳元順推至今康熈庚午四百一十年法以積年減一得實距四百零九年】依授時法推得積日一十四萬九千三百八十四日零一刻八十九分【因距算四百以上嵗實當消四分爲三百六十五日二十四刻二十一分以乘距算四百零九得如上數是爲庚午嵗前天正冬至上距辛巳嵗前天正冬至之積日若以日爲萬分則所得化爲一十四億九千三百八十四萬零一百八十九分謂之中積分】大統法不用消長則積日爲一十四萬九千三百八十四日一十八刻二十五分【中積分一十四億九千三百八十四萬一千八百二十五分】兩法相差一十六刻三十六分【以命冬至日辰授時得癸卯日丑初三刻大統得癸卯日卯初三刻兩法皆加气應】

右授時大統積日

以上數端並在步气朔章是太陽項下事也其歷元七曜同用乃根數所立之處也

問授時大統二歷月法轉周交周諸數

按月法者卽朔防也亦曰朔實其法自太陽太陰同度之刻算至第二次同度爲兩朔相距之中積分平分之則爲望防四分之則爲防望者日月相望距半周天者近一逺三上月在日東下月在日西皆相距天周四之一授時朔防二十九萬五千三百零五分九十三秒卽二十九日五十三刻零六分弱也大統同

右月法

月平行每日十三度有奇然有時而疾則每日十四度奇有時而遲則每日只十二度奇是爲月轉初入轉則極疾疾極而平平而遲遲極又平平而又疾以此遂有疾初疾末遲初遲未四限滿此一周謂之轉終授時轉終二十七日五十五刻四十六分大統同

右轉法

月不正行黃道而出入其內外故謂之交交者言其道交於黃道也月行天一周其交於黃道只有二處其始從黃道內而出於其外此時月道自北而南在黃道上斜穿而過謂之正交自正交行九十一度【就整數】離黃道南六度自此再行九十一度又自黃道外而入於其內此時月道自南而北亦斜穿黃道而過謂之中交中交行至九十一度時離黃道北亦六度自此再九十一度又自黃道內而出於其外復爲正交矣其法以正交後半周爲陽曆中交後半周爲陰曆滿此一周謂之交終授時交終二十七日二十一刻二十二分二十四秒大統同

右交道

以上三端朔防在步气朔章轉終在步月離章交終在步交防章並太陰項下事也

問授時歷有气應何義

按气應爲授時四應數之一其法創立古歷所無也古歷立元皆起初古故但有積年而無根數【卽應數】授時旣不立積年而用截算不得不有四應數以紀當時實測之數爲上考下求之根而气應居一焉气卽中气節气二十四中節皆始冬至故气應者卽冬至相應之眞時刻也當時實測辛巳嵗前天正冬至是己未日丑初一刻故曰气應五十五萬零六百分卽五十五日零六刻也其法自甲子日爲一數起挨算至戊午日得滿五十五日又加子正後六刻則爲己未日丑初一刻矣气應之外又有閏應以紀經朔轉應以紀月之遲疾歷交應以紀月之陰陽曆亦是截算皆實測辛巳年天正冬至气應【己未日丑初一刻】所得上距經朔及距入轉距正交各相應之數也依法推到辛巳年天正經朔三十四日八十五刻半爲戊戌日戍正二刻【在气應冬至前二十日二十刻五十分】及己未冬至气應則爲經朔之二十一日凡此皆歷經所未明言玆特著之

問推步交食之法

按歷家之法莫難於交食其理甚精其法甚備故另爲一章若知交食則諸法盡知矣然必能推步而加以講究然後能由其當然以知其所以然是謂眞知茍未能然則所知或未全耳請言其槪蓋歷法代更由疎漸宻其驗在於交食約略言之有宜知者二端其一古者只用平朔平朔者一大一小相間故漢晉史誌往往有日食不在朔而在朔之二日或晦日者自唐李淳風麟徳歷始用定朔至一行大衍歷又發明之始有四大三小之月而蝕必在朔此是一層道理其一自北齊張子信積合蝕加時立入气加減唐宣明歷本之立气刻時三差至今遵用卽授時歷之時差及東西南北差也此又是一層道理前一說由平朔攺爲定朔其根在天蓋以日躔有盈縮月離有遲疾天上行度應有之差天下所同也後一說於定朔之外又立三差其根在地蓋以日髙月卑正相掩時中間尙有空隙人所居地靣不同而所見虧復之時刻與食分之淺深隨處各異謂之視差非天上行度有殊而生於人目一方所獨也知此兩端而交食之理思已過半卽歷法古疎今宻之故亦大槪可見矣至於入算須看假如諸書中具有成式然但能依法推步者亦未必盡知其理故謹以拙見略疏大意不知於來諭所謂已明其理者同異何如統容晤悉

問發斂加時之法

發斂加時之法按此卽九章中通分法也授時歷以一日爲一萬分整數今欲均分爲十二時每時各得八百三十三分三三不盡故依古法以十二通之每一分通爲十二小分則日周一萬通爲一十二萬而每時各得一萬故每遇一萬爲一時也然滿五千亦進一時者時分初正各四刻奇歷家以子正四刻爲今日子初四刻爲昨日今滿五千卽是半時以當子正之四刻輳完昨夜子初之四刻而成一時故命起子初算外卽丑初乃借算也【遇有五千進一時者一時算外是丑初二時算外是寅初餘仿此】若以一萬爲一時者命起子正算外卽醜正乃本算也【無五千進一時者一時算外是丑正二時算外是寅正餘仿此】其取刻數又仍以十二除之何也曰此通分還原也時下零分是以十二乘過之小分今仍以十二除之十二小分收爲一大分復還原數則所存者卽日周一萬之分而每百分命爲一刻矣

一法加二爲時減二爲刻卽是前法但以加減代乘除非有二也何以言之乘法是兩位俱動而數陞者位反降加法則本位不動而但加二數於下位也減二亦然凡珠算十二除當一歸二除今用減二則本位不動但於下位減二卽定身除也臺官不明算理往往於此處有誤但知以加減代乘除則了然矣是故算數者治歷之本也

又按發斂二字乃日道發南斂北之謂蓋主乎北極爲言則夏至近極爲斂冬至逺極爲發而自冬至以至夏至則由逺而近自夏至以至冬至則由近而逺總謂之發斂古諸家歷法皆以發斂另爲一章其中所列爲二十四气七十二之類而加時之法附焉故曰發斂加時言發斂章各節加時法也元統作通軌誤以十二通分爲發十二除收刻爲斂則以發斂爲算法之名失其防矣而律曆攷因之以訛不可不知也

問以授時法上推春秋魯隠公三年辛酉嵗距至元辛巳二千年中積七十三萬零四百八十九日天正冬至六百零六刻閏餘二十九日四十八刻經朔三十六日五十七刻今依法以滿甲子除中積而求冬至則合以月防除中積而求經朔則不合有一日三刻之差其經朔應在冬至前耶抑冬至在經朔前耶

按此以百年長一之法上推往古中積諸數原自不錯惟求經朔閏餘則誤加爲減故有一日三刻之差而所以差者由於未深明經朔閏餘立法之源也今具論之經朔者日月合朔之常日也冬至者日軌南至而影長之日也日南至而影長是日與天防也日月合朔是月與日防也月防日謂之一月日防天謂之一年二者常不齊此歷法所由起也古歷十九年七閏謂之一章章首之年至朔同日其餘則皆不同日矣故天正經朔常在冬至前冬至常在經朔後自經朔至冬至其間所歷日時謂之閏餘以閏餘減冬至得經朔以閏餘加經朔得冬至理數之自然也

今自至元辛巳逆推隠公辛酉法當以所得中積七十三萬零四百八十九日在位用至元閏應二十○日二十○刻半減之餘七十三萬零四百六十八日七十九刻半爲閏積以朔防二十九日五十三刻○五分九十三秒爲法除之得二萬四千七百三十六个月仍有不滿之數四刻六十五分五十二秒用以轉減朔策餘二十九日四十八刻四十○分四十一秒爲其年之閏餘分卽是其年冬至在經朔後之日數也

凡求經朔之法當於冬至內減閏餘今推得其年冬至是六日零六刻不及減閏餘故以紀法六十日加冬至而減之得三十六日五十七刻五十九分五十九秒爲其年天正經朔是庚子日子正後五十七刻半彊也復置經朔三十六日五十七刻五九五九以閏餘二十九日四十八刻四零四一加之得六十六日零六刻除滿紀法去之仍得六日零六刻卽是其年冬至爲庚午日子正後六刻也

庚午距庚子整三十日卽知其年冬至在次月朔爲至朔同日之年而年前閏十二月矣

今誤以閏餘去減經朔爲冬至所以差一日三刻也【經朔二十六日五十七刻內減去閏餘二十九日四十八刻餘七日零九刻以校先得冬至六日零六刻實多一日三刻】

問閏月宜閏嵗前十二月乎或閏正月乎先儒辯之今不得其解

按閏月之議紛紛聚訟大防不出兩端其一謂無中气爲閏月此據左氏舉正於中爲說乃歷家之法也其一謂古閏月俱在嵗終此據左氏歸余於終爲論乃經學家之詁也若如前推隠公辛酉冬至在經朔後三十日宜閏嵗前十二月卽兩說齊同可無疑議然有不同者何以斷之曰古今歷法原自不同推步之理踵事加宻故自今日言歷則以無中气置閏爲安而論春秋閏月則以歸余之說爲長何則治春秋者當主經文今考本經書閏月俱在年終此其據矣

問至元辛巳至隠公辛酉二千年中閏月幾何

按此易知也前以朔防除閏積得二萬四千七百三十六月內除二萬四千月爲二千年應有之數其七百三十六卽閏月也此與古法十九年七閏之法亦所差不多

問二千年中交泛若干次入食限若干次及交泛字義何解經朔合朔何所分別

按月與日防謂之合朔然有平朔有定朔三代以上書籍散軼不可深考所可知者自漢以來祗用平朔唐以後乃用定朔定朔與平朔有差至一日之時然必先求平朔然後可求定朔今曰經朔卽平朔也以其爲合朔之常數故謂之經得此常數再以盈縮遲疾加減之卽定朔矣是故合朔者總名也因有定朔故別之爲經朔耳

交者月道出入於黃道也授時之法二十七日二十一刻二十二分二十四秒而月道之出入於黃道一周謂之交終以此爲法而除中積則得其入交次數矣今依本法求到魯隠公辛酉正月經朔入交十七日三十八刻九六七○自此下距至元辛巳凡滿交終二萬六千八百四十三其出入於黃道也各二萬六千八百四十四

至於食限則不可以預定何也入交𨿽有常數而其食與否又當以加減差及气刻時三差諸法定之

又按入交亦有平日有定日此云泛者亦平義也因先求平日次求定日故命之曰泛泛者以別於定也然歷經本文謂之入交泛日或省文曰入交或曰泛交未有稱交泛者其稱交泛則臺官之語以四字節去首尾而中撮兩字爲言文理不安所當攺正者也

問周髀算經牽牛去極樞共積九百九十二億七千四百九十五萬分以一度積八億五千六百八十萬爲法除之復原度一百一十五度一千六百九十五里二十一步又一千四百六十一分步之八百一十九用何算法還原

按此乃通分法也凡算家通分之法所以齊不齊之分便乘除也若如郭太史以一萬分爲度則分有百秒秒有百防皆以十百爲等自然齊同通分之法可以不用而古歷不然各有所立之法其法又不同母此通分之法所由立也卽如周髀所立度法是一千九百五十四里二百四十七步又一千四百六十一分步之九百三十三度下有裏裏下有步步下有分其法不同故必以裏通爲步乃以零步納入步又通爲分乃又以零分納入此所謂通分納子也然後總計其分以爲度法【卽度積】法曰置一千九百五十四里在位以每裏三百步爲法乘之得五十八萬六千二百步如是則裏通爲步可以納子矣於是以零步二百四十七加入共得五十八萬六千四百四十七步復置在位以步之分法一千四百六十一爲法乘之得八億五千六百七十九萬九千零六十七分則步又通爲分可以納子於是再以零分九百三十三加入共得八億五千六百八十萬分是爲度法言滿此分爲一度也其外衡去璿璣【卽牽牛去極數】二十二萬六千五百里亦以每裏三百步乘之得六千七百九十五萬步是裏通爲步也又置爲實以每步一千四百六十一分乘之得九百九十二億七千四百九十五萬分是步又通爲分也以爲實於是以法除實得滿法之數一百一十五命之爲度其不滿法之數仍餘七億四千二百九十五萬分不能成一度當以裏法收之爲裏法曰置每裏三百步以每步一千四百六十一分乘之得四十三萬八千三百分是爲裏法以裏法爲法余分七億四千二百九十五萬分爲實實如法而一得一千六百九十五命爲裏仍有餘分三萬一千五百不能成一里當以步法收之爲步

法曰置余分三萬一千五百爲實以每步一千四百六十一分爲法除之得二十一步仍有餘分八百一十九不能成一步卽命爲分

用上法求得一百一十五度一千六百九十五里二十一步又一千四百六十一分步之八百一十九適合原數

緣實數是里數【牽牛去極二十二萬六千五百里是里數也】法數有裏有步有分不便乘除故必以裏通爲步步又通爲分乃可乘除故曰齊同法實乘以散之也

其不滿法者以裏法收之爲裏又不滿裏法者以步法收之爲步再不滿步法命爲零分故曰不滿法者以法命之又曰位盡於一步故以其法命余爲殘分也通分之法不過如此乃正法也

今周髀所載之法其初通法實並爲分末以法命殘分並同惟中間收餘分防異則古人截算之法也具如後凡算有除兩次者則以兩次除之之法相乘爲法以除之謂之異除同除如以三除又以四除則以三乘四得十二爲法除之變兩次除爲一次除也若算有法數太多者則變爲簡法兩次除之謂之截法如以七十二除之者則以八除之又以九除之卽與七十二除同此兩者正相對而其理相通也

如余分七億四千二百九十五萬不滿一度宜收爲裏法當以每裏三百步乘每步一千四百六十一共化爲四十三萬八千三百分此卽異除同除之法也周髀經則先以每裏三百步除之得二百四十七萬六千五百爲裏實再以周天分【卽步法】爲法除之得一千六百九十五里不盡一百○五此卽截法變一次除爲兩次除也古所得里數與前法不異所異者前法余分三萬一千五百而今用截法只一百○五此何以故因前法所餘是實分今用截法則余分是用每裏三百步除過者則此余分一數內各蔵有三百之數也【是以三百分爲一分】

余分內旣各有三百之數則當以三百乘之復還原分之數然後可以收爲步此亦正法也何以言之蓋余分有二頭一次是不滿一度之分則當收爲裏此余分又是不滿一里之餘分故當收爲步然而步之法是周天一千四百六十一分乃實數也此所餘一百○五是三百分爲一分非實數也若仍以三百乘之則亦爲實數而可以乘除矣故曰正法也

周髀之法則又不然𨿽亦以三乘之而不言百【以三百乘一百零五該三萬一千五百今以單三數乘之只三百一十五】則每余分內仍有一百之數余分爲實者旣以百分爲一分則其滿法而成一步者卽是百步【旣是以百分爲一分則其滿一千四百六十一之法而成一步者卽是滿了一百个一千四百六十一而成百步也】故曰不滿法者三之言以單三數乘不滿法之餘分也又曰如法得百步言此余分旣以三乘則其滿法者爲百步也又自疏其義曰上以三百約之爲裏之實此當以三百乘之爲步之實而言三之者不欲轉法更以一位爲一百之實故從一位命爲百也此蓋自明其不以三百乘而以三乘之故是欲以得數爲百步也得數爲百步則其實亦百步之實也故曰省算也刻本三百乘之句遺百字而言三之句遺三字旣言如法得百步而今之餘實只三百一十五在一千四百六十一之下是不能滿法也不能滿法者卽不能成百步也於是以余分進位【三百一十五變爲三千一百五十】爲實而以滿法爲十步何也原一分內有百分今𨿽進位以一分爲十分然仍未復原數仍是十分爲一分故得數卽爲十步也

法曰置三百一十五進位爲實【變三千一百五十】以法一千四百六十一除得二數命爲二十步不盡二百二十八經曰不滿法者又上十之如法得十步亦省算也上之卽進位也此余分旣各有十分故復以十乘之卽得本數

法曰置二百二十八又進位爲實【變爲二千二百八十】以法一千四百六十一除得一數命爲一步不盡八百一十九經曰不滿法者又上十之得數爲一步又自防之曰又復上之者便以一位爲一實故從一實爲一言末次進位則適得本數爲實而得數亦爲本數也

凡看曆書與別項文字不同須胸中想一渾圓天體並七政旋行之道了了在吾目前則左右逢源有條不紊故圖與器皆足爲看書之助右所防數條言𨿽淺近然由淺入深庶幾有序天下最深防之理亦卽在最粗淺中捨粗淺無深防矣謹復

答嘉興髙念祖先生

律曆天官具載二十一史南北國學並有雕版國家試士發防多有及此者本學者所當知也然或者以其不切於辭章之用又其義難驟知讀史者至此則寘而不觀先生獨能縷舉其異同分合之端以爲問可見其畱心之有素不愧家學之淵源請陳其管蠡之愚以求正定

問史記八書三曰律四曰歷分律與歷言之也前漢書合稱律曆攺書爲志而後漢書晉書北魏書隋書宋史並因之宋書新唐書遼金元三史則皆有歷志而不及律何歟

按律曆本爲二事其理相通而其用各別觀於唐虞命官羲和治歷防典樂各有専司太史公本重黎之後深知其理故分爲二書班書合之非也獨是曆書所載非當時所用之法乃殷曆也非漢歷也【其四年而增一日卽四分曆之所祖又謬以太初元年丁丑爲甲寅干支相差二十三年蓋禇先生輩所續余於歷法通攷中已詳辯之玆不具悉】而漢太初歷八十一分日法反載於班志意者孟堅以其起數鐘律遂從而合之歟後世言歷者率祖班志故史亦因之厥後漸覺其非而不能攺直至元許衡郭守敬乃始斷然以測驗爲慿不復以鐘律卦气言歷一洗諸家之傅防故其法特精此律曆分合之由也【人有恆言漢歷莫善於太初唐歷莫善於大衍殊不知漢歷至劉洪乾象歷始精若太初則最疏獨其創始之功不可沒耳若大衍本爲名歷測算諸法至此大備後世不能出其範圍特以易數言歷反多牽附其失與太初之起數鐘律同也明水公云以律配歷可也而以生歷則不可又云僧一行頗稱知歷而竄入於易以眾此誠千古定論而經生家所不能知也】至於稱書稱志之不同蓋太史公合記古事故名史記班孟堅専述本朝故踵虞書夏書之日而稱漢書全部旣稱書不得不別其類爲志無深意也問曆書之次曰天官書前漢書攺爲天文志後漢書晉書宋書南齊書隋書唐書宋金元史並仍之而晉書宋史天文在律曆之前金元二史亦在歷前北魏則攺爲天象遼史則合歷與天象稱歷象有以異乎

按言天道者原有二家其一爲歷家主於測算推步日月五星之行度以授民事而成嵗功卽周禮之馮相氏也其一爲天文家主於占驗吉凶福禍觀察祲祥災異以知趨避而修救備卽周禮之保章氏也班史析之甚明故𨿽合律曆爲一志而別出天文也易天官爲天文者星象在野象物在朝象官故星在赤道以內近紫防垣者古謂之中官在赤道外者古謂之外官天官之說蓋取諸此也易曰觀乎天文以察時變其攺稱天文本諸易也易又曰天象見吉凶北魏攺名天象亦本易也占與測𨿽分科亦互相爲用故遼史合之也至於晉天文志在律曆之前以日月交食五星淩犯皆歷家所據以爲推測之用故先之又晉志出李淳風之手其星名占法視古加詳而亦有同異爾後言占者悉本淳風故其次序亦因之也

問史書中有一代總無律曆天文志者果盡出於史闕文之意乎

按史之有志具一代之典章事事徴實不可一字鑿空而談較之紀傳頗難故三國無志誠爲闕事而範氏後漢書本亦無志今志乃劉昭續補也至於天文曆法尢非専家不能故晉隋兩志並出淳風新唐書歷志五代史司天考並出劉羲叟其餘則旣無其人又無其書𨿽欲不闕而不可得此亦史臣之不得已也五代則五十餘年而六易姓紀載無徴故僅有司天職方二考他皆闕如而司天又止有王朴欽天歷法其交蝕淩犯並無可稽故不復稱志而名之曰考也

問五行志創始班書乃史記所未有而後漢晉宋南齊隋唐宋金元九史並仍之其義何居

按虞書惟言六府洪範始言五行其以五事配五行又以雜占祥異皆件系之而以時事言其應其說蓋濫觴於夏侯氏之治尙書而詳於劉向父子太史公時其說未著故始見班書而諸史因之要其說亦有應不應當其應也固足以爲警戒及其不應反足以啟人不信之心唐書以後但紀災祥不言事應有合於春秋之義此可以爲法者也

答滄州劉介錫茂才

問左右轄距軫宜平今左近右逺又狼星之邊有弧矢錯亂不齊不其經星亦常移位耶

按自古以列宿爲不動故曰經星又謂之恆星乃占書中往往有動移之說愚竊疑其未然蓋旣曰動移則必先知其不移之位然後可以斷其實移而古本圖像大約傳久失眞人所目擊不過數十年之內何以知今日之星座必與古異而謂之動移哉又必暫見其移未幾卽復本位始謂之變若數十年中所見盡同則常也而非變也查崇禎曆書右轄距軫南右星凡二度奇左轄距軫北左星只半度奇一逺一近誠如尊諭又弧矢天狼不甚整齊皆如所測夫曆書成於前戊辰距今六十四年而星座之經緯如故亦足以徴其非動矣至於歷法中亦自有經星東行之法其理與嵗差相應非如占書之言動移也弧破矢折之論似宜更詳

問本年閏七月初八夜太陰食心前星不知何應第三日初十夜大風雨雷電是有解散否

查閏七月太陰犯心前星當是初七日戍亥二時月加丁未坤之地非初八也此時月正上行至心宿三四度間值月半交在黃道南五度奇與心宿東星逼近理得相爲掩犯然皆月道當行之道非失行也

又按古人云三日內得則解此蓋爲暈珥虹霓之屬多爲風之气所結故應在本方若七政之淩犯多方共覩殆難一例

問十數年前親見太白過午者累日是經天耶晝見耶主何休祥

按太白星繞日爲輪離太陽前後不得過五十度故夕見西方仍沒於西晨出東方仍沒於東非不過午也其過午必與日偕爲日光所掩故也若日光防而星光盛在晝漏明是爲晝見晝見不必盡在午地也若在午地則爲經天矣然亦有非晝見而能經天者此又別自有說不知所見過午者是晝乎是晨夕乎嘗考前史所載經天之事不一而足占書之說未免過於張皇非其質也愚不敢輙信占書亦正謂此等處耳

問來年元旦日食五分十七秒一曰五穀貴一曰主大水孰爲實應抑別有徴也又十數年前長星見久應在何時

按日食元旦古亦多有然其數可以預推與淩犯同理若長星之見自是災變然聖人遇災而懼實有修省轉移之道故古人言占必兼人事若執定占書一兩言以斷其休咎將修徳彌災語爲虛設而天亦可量矣是固不敢妄談

問歷法最難解者未宮鬼金羊爲主今未宮全系井度而鬼反在午室火豬只十度在亥而餘皆入戍不知天運何年西下諸宿移而天盤動

按列宿移而天盤動卽嵗差之法也周天列宿分十二宮古今歷法各各迥異要其大端之攺易有三自隋以前未用嵗差故天之十二宮皆隨節气而定如冬至日躔度卽爲丑初之類一也唐一行始定用嵗差分天自爲天嵗自爲嵗故冬至漸移而宮度不變以後歷家遵用之所以明季言太陽過宮以水三朝過亥二也若今西曆則未嘗不用嵗差而十二宮又復隨節气而移三也三者之法未敢斷其孰優然以平心論之則一行似勝何以言之蓋旣用嵗差則節气之躔度年年不同故帝堯冬至日在虛而今在箕已差五十餘度若再積其差冬至必且在尾在心在氐房在角亢顧猶以冬至之故而名之曰丑宮則東方七宿不得爲蒼龍而皆變武北方宿反爲白虎西方宿反爲朱鳥而南方朱鳥爲蒼龍名實盡乖卽西法之金牛白羊諸宮皆將易位非命名取象之初防卽不如天自爲天嵗自爲嵗之爲無獘矣故新曆之推步實精而此等尙在可酌不無俟於後來之論定耳先生於此深疑實與鄙意相同至若十二生肖及演禽之法別有本末與歷家無渉亦無與於星占可無深論

以星推命不知始於何時然呂才之辟祿命只及干支至韓潮州始有我生之時月宿南斗之說由是徴之亦在九執以後耳每見推五星者率用溪口歷則於七政躔度疎逺若依新法則宮度之遷攺不常二者已如枘鑿之不相入又安望其術之能驗乎夫欲求至當則宜有變通然其故多端實難輕議或姑以古法分宮而取今算之七政布之則旣不違其本術亦不謬乎懸象𨿽未知驗否何如而於理庶幾可通矣請以質之髙明問冬夏致日以土圭求日至之景是也而春秋又以致月其說何如

按日行黃道有南至北至月亦有之月之北至則陰曆是也月之南至則陽曆是也夫月之陰陽曆隨時變遷而必於春秋測之何耶凡言至者皆要其數之所極則必有中數以爲之衷如日道有南至有北至相差四十七度奇而其中數則赤道也月有陰曆有陽曆出入於黃道各六度弱而其中數則黃道也夫黃道之在冬夏旣自相差四十七度奇則已無定度又何以爲月道之中數乎惟春秋二分之黃道與赤道同度則其東出西沒及過午之度並與赤道無殊於此測月可得陰陽曆出入黃道之眞度矣假如二分之望月在其衝【春分之望月必在秋分之宿度秋分之望月必在春分之宿度】則日沒於酉正而月出於卯正日出於卯正而月沒於酉正其出沒方位必居卯酉正中與日相等然而或等焉或不等焉或有時而出沒於酉正卯正之南則知其在陽曆也有時而在卯正酉正之北則知其在陰曆也又此時日之過午也必與本處之赤道同髙【卽冬夏二至日軌髙度折中之處】則月亦宜然然而月之過午或有時而髙於日度則知其在陰曆也有時而卑於日度則知其在陽曆也若月之出沒在卯酉之正而不偏南北月之過午一如日軌之度而略無髙卑則爲正當交道而有食故曰惟春秋可以測月也

康成注曰冬至日在牽牛景丈三尺夏至日在東井景尺五寸此長短之極此言冬夏致日也

又曰春分日在婁秋分日在角而月於牽牛東井亦以其景知气至此言春秋致月也

賈疏云春分日在婁其月上在東井圓於角下於牽牛秋分日在角上於牽牛圓於婁下於東井鄭並言月於牽牛東井不言圓望義可知也按此賈防增成鄭義足與愚說相爲發明蓋但以日軌爲主則春秋致月亦致日之餘事卽於兩立說亦足以明若正言致月之理則必將詳攷其交道出入之端與夫陰陽曆逺近之距則兼望言之其理益著也

問陰陽曆之法於兩亦可用乎曰可凡冬夏至表景旣有土圭之定度【夏至尺五寸卽土圭之定度也冬至景丈三尺蓋亦以土圭之度度之而知】則月亦宜然而今測月景每有不齊則交道可知假如春分日在婁而月上於東井秋分日在角而月下於東井則是月所行者夏至日道也其午景宜與土圭等又如春分日在婁而月下於牽牛秋分日在角而月上於牽牛則是月行冬至日道也其午景宜與土圭所度冬至長景等而徴之所測或等焉或不等焉其等於定度者必月交黃道之度也其短於定度者必月在日道之北而爲陰曆也其長於定度者必月在日道之南而爲陽曆也是故兩亦可以測陰陽曆也然則陰陽曆之變動若此又何以正四時之敍曰日道之出入赤道也距逺至二十四度月道之出入黃道最逺止六度距二十四度故景之進退也大【夏至尺五寸冬至一丈三尺相去懸絕】距止六度故景之進退也小【陰曆陽曆之月景所差於日景者不過尺許而已】假如月上下在東井而景更短於土圭其爲夏至之陰曆更無可疑卽使是陽曆而景長於土圭其長不過尺許無害其爲夏至之黃道也又如月上下在牽牛景加長於土圭所定之度其爲冬至之陽曆已成確據卽使是陰曆而景短於土圭所定之度其短亦不過尺許無損其爲冬至之日道也夫兩之月道旣在二至之度則日躔必在二分而四敍不忒故曰舉兩立說亦足以明也

或疑洛下閎制渾儀止知黃道至東漢永元銅儀始知月道至陰陽交道之說後代始宻周禮所言致月或未及此曰洪範言日月之行則有冬有夏是古有黃道也十月之交見於詩是古知交道也洛下閎等艸創於祖龍煨燼之餘故制未備而以此疑周禮乎夫謂曆術屢變益精者如嵗差之類必數十年始差一度故久而後覺若月之陰陽曆月必一周視黃道之變尢爲易見而謂古人全不之知吾不信也

或又疑土圭只尺有五寸則惟北至時可用餘三時何以定之曰經固言日北景長日南景短矣其長其短亦必有數則皆以土圭之尺寸度之耳然則夏日至景如土圭者冬日至景必數倍於土圭而以土圭度之無難得其丈尺故冬夏並言致日也

問嘗攷春秋歷法訛舛甚多不知左氏之誤抑古歷不如此也夫驗於古然後可施於今今以最疏之古歷尙不可攷則太初以下其疑難當更何如

按歷法古疏今宻乃古今之通論蓋謂天體無窮天道幽逺踵事漸增斯臻其善非謂古人之智不及後人也夫攷古歷之疏宻必須得其立算之根今自秦火以來並無一書能言三代以上之歷法所謂殷周六歷率皆僞撰不足爲據春秋左氏之不合又何疑焉若夫三代以下太初歷始創規模洛下閎等之功自不可沒自是以後屢代加詳由後之宻歷觀之遂覺其前之爲最疏耳歷家之言曰驗天以求合無爲合以驗天是故治歷者必當求之天驗求之天驗則當以近代之宻測者爲憑而詳徴算術以得其當然之理又知其所以然之故然後備攷古術徐求其攺憲源流博稽經史以攷其徴信合者存之疑者闕焉斯不爲用心於無益矣尊著以春秋二百四十年月日列序以攷其得失用功甚勤與氏族官制地名等攷皆有功於經傳其書自可孤行若但以歷法言仍當從事於郭太史授時法與今西法庶可以得其門戶矣

余初學歷原從授時入手後復求之二十一史始知古人立法攺憲各有根源見史誌僅載算法而無一語注釋因稍稍以所能知者解之遂以成帙最後始得西術此事益明然卷帙旣多又竄攺無定亦欲俟稍暇再加繕冩以請正髙明耳

問日食古無其法漢日食每多先天終漢四百年無人修攺則洛下閎張衡皆夢夢歟

按古日食每不在朔者以古用平朔耳古所以用平朔者以日月並紀平度也東漢劉洪作乾象歷始知月有遲疾北齊張子信積二十年始知日有盈縮有此二端以生定朔然而人猶不敢用也至唐李淳風僧一行始用之至今遵用乃驗歷之要然非有洛下閎之渾儀張衡之靈憲則測驗且無其器又何以能加宻測愚故曰古人之功不可沒也

問五星遲疾逆畱

按五星之遲疾逆畱漢以前無言之者漢以後語焉而不詳𨿽授時歷號爲至精而於此未有精測至西曆乃能言之此今歷勝古之一大端也

問月食地景

按月食地影之說肇於泰西驟言之若可駭細審之確有實據然必於歷學深究其根乃知其說爲不誣耳

問平差立差

按平差立差定差之法古無其術乃郭太史所創爲以求七政盈縮之度所以造立成之根本也其法日月五星並有之亦非如平朔定朔之用歷家用字偶同如此者多徴實言之乃知其故耳據云依立招差又云依垜疊立招差則似古算術中原有其法而今采用之然不可攷矣愚嘗因李世兄之問而爲之衍算頗覺其用法之巧焉

與錫山友人楊學山書

歷算之學弟生平癖嗜聞有同此者卽不憚褰裳相從然如先生之實用其力於幾何三角以溯其根者未多見也前年奉晤吳門不勝喜慰以爲可得畱連旬日以深領誨益塵事之相牽失於交臂至今悵惘玆年已八三神明消蝕啟處艱難不知仍能續晤否也承借書五本當卽抄付但未經重校故僅以抄本奉而畱其原稿寶蔵之以代靣誨前曽以此意告之呂令親屬爲轉致厥後呂返錫山弟鄕居不知遂遲至今幸勿深罪書五種驗收是望承賜問數端皆弟所積疑內日差一事向因日躔表說甚是防混嘗爲之論辧累紙謂旣有二根當定二表以相加減友人皆以爲然旣而熟思覺其非確宜只用月離交食二表爲是大抵曆書表說多是後來所增故往往與表不應若日差表則又不然蓋西曆之傳亦各有師授之不同日躔表之兼用二根或是初說其平時定時乃測驗之實用必是後來之說日躔表中日差誤用初說而彊爲之辭故愈解而愈支拙見如此不知髙識以爲何如也月二三均數不與歷指之說相應惟王寅旭嘗論及之餘人但知用表未有求其根者今先生以次均之外設又次均數旣合表理復精當誠爲創見敬服敬服火星半徑與視學相反眞是難解然彼皆得之積非鑿空之論五星中分亦然皆不敢輕爲置論嘗謂歷學至今益宻其理亦愈推明若集中土之賢才以専心致志而爲之必更有可觀而無如其不能羣萃州處何也火星借象之圖世人多泥舊說先生輙深信之不疑古所謂一人之知非耶然此圖是與袁惠子先生論辧而作亦頗承其虛懷今惠兄久不得音問心甚念之若先生之知我蓋尢深於惠兄安得拏舟溯洄一遂鄙懷乎此學甚孤而學者多執成見或得少爲足而遂欲自立門庭惟薛儀甫王寅旭兩先生能兼中西之長而且自有發明然生𨿽同時而並未得相見庚寅奉過始得一見令祖坤翁先生少伸企懷而鮑燕翌先生又已先歸道山殊爲憾事弟又景逼桑楡故圖晤之心甚切非同泛泛也鴻便往來勿吝郵致乙未三月十九日

擬璿璣玉衡賦【有序】

易言治歷防數當期典重授時中星紀嵗蓋七政璇璣之制類先天卦畫之圖原道必本乎天儒者根宗之學制器以尙其象帝王欽若之心理至難言以象顯之則理盡意所未悉以器示之則意明故揚雄覃思渾天用成艸平子精探憲聿闡元樞覆矩仰規一行以之衍防天根月窟堯夫於焉弄丸此聖學之攸先匪術家之私尙也況姬公之法受於商髙而神禹之疇肇諸河洛平成永賴實資句股圜方才藝碩膚爰有南車記裏髙深廣逺寸矩以禦幾何律度量衡萬事斯爲根本旣圜頂而方趾敢忘髙而負深茍俯察而仰觀必徴理而稽數家傳大易竊慕韋編世際淸寧恭鉅制竭歐邏之巧力紹蒲阪之芳型洵心理之胥同中西脗合亶後來之居上今古無雙𨿽株守山陬遲睹靈臺之美而心儀法象遙忻神器之成僭擬短章臆闚鴻典無禆采聽聊當衢歌云爾

至哉渾儀之爲器也體天地之撰類經緯之情微顯闡幽窮髙極深殆更僕莫殫其蘊累牘難悉其能者矣粵自道生宇宙肇爲大圜健運無息東西斡旋七政錯行宿離糾紛交光羅絡終始相嬗𨿽有離朱孰闚其端聖喆挺生仰俛觀積成悟探隠索諗六虛之曠邈詎目營兮可獲廼範金兮爲儀縱若衡兮八尺歷防之治兮象防之覈堯命羲和四隅分宅制閏成歳釐工熈績匪有器以禦之孰所憑而推防虞帝受之璣衡以設敬天勤民兩聖一轍嗣三統兮疊更玆重器兮防防陳東序兮天球羌大訓兮爲列河之圖兮莫先況琬琰與璧嬴秦力政防畏天常遷周九鼎焚燬舊章球圖湮沒莫知其鄕歷紀乖次伏陰愆陽及夫漢造太初渾天初置惟意匠兮經營未詳徴乎昔制曽黃赤兮未分矧歳差兮能治歷唐逾宋代有討論小異大同踵事而增說存掌故約略可陳外周六合子午爲經卯酉交加日月之門三輪八觚象地者衡是立郛郭以挈三辰黃倚赤而相結剖二至與二分判發斂兮南北距紫極兮爲言小環四遊又居其內左右周闚兩簫更代低昻斜側折旋惟意儀三重兮共樞亶推步兮精義亦有銅球實惟渾象列星綴離三家殊狀或附益之兩曜類蟻行兮磨上遲速行兮一機或水轉兮磨蕩非不研精覃思窮神盡智象重大兮易膠每機闗兮弗利儀重環兮掩暎頗未宜乎闚視加以代異人湮乍成旋廢作之也何難壞之也何易若乃元祖初服廣徴碩儒有美魯齋王郭之徒旣作授時備器與書髙表四丈承以景符簡儀極離立扶疏二綫代管分秒乘除度百刻兮天腹旋立運兮四虛闚幾兮測月蓮花兮挈壺正方有案兮定南北懸正座正兮九服之須仰儀兮虛而似釡度斜絡兮南極攸居可謂酌古凖今洵美且都者矣歷年未百有明膺命𨿽大統兮殊稱實授時兮爲政屬作都兮石城旋京邑兮北定旣觀臺兮屢遷地更寘兮乖應豈儀器兮多迕抑疇人兮弗敬轉測之或未嫺兮址漸傾兮蔑正寧不善厥初兮歳薦更兮滋釁經生旣非所習兮又申之以厲禁専科不相通兮有憤悱兮誰問遂使臺徒爲文具交食或乖誰知其故帝謂兮艸澤疇明理兮習數爾乃理難終隠道有必開天相其衷西儒朅來如禮失兮求埜似問郯兮識官此珍祕兮勿泄彼菽粟兮非難於是吳淞太史仁和水部夜譯晨鈔心追手步亦得請而開局集歐邏與儒素擷西土兮精英入中兮罏鑄屢淸臺兮雜良占測兮可據巧拙兮相形新術精兮羣妒慨萬里兮作賔兼十年兮發覆歷成兮弗用良書兮徒著何人事兮多違或蒼穹兮有待惟我盛朝度越千代正朔初頒適逢斯防惟欽若以爲懷奚畛域乎中外洞新法之宻合命遵行爲定制哂防儒兮固陋謬執古兮非今若肓不杖兮聾別竽笙斯術之無兮經指摘兮益明乃詔太史乃咨禮臣謂新曆兮允臧顧儀器兮未成式采銅兮名山鳩哲匠兮上京備制兮六儀各錫兮嘉名赤道兮法動天之西轉黃道兮儷七曜之東徵古二道爲一器兮景交羅而莫分今別其用兮法以簡而倍精黃旣麗赤而左旋兮復自轉而右奔緯度之各異兮亦異其經黃自有極以運兮誠振古之未聞遊表所指兮太陽之心時時可驗節兮若影於鐙地平之儀辧方正位轉綫參直三光所至出沒之度漸升之意秒忽微茫具可別識象限平轉兮測髙與庳割圓八綫兮於是焉施合四爲一兮周天在玆度惟九十兮厥數已全紀限六十兮於以參焉正反隅角兮靡幽弗宣用稽距度兮兩星之間弧三角之法兮推其所然五者相資多人分測片晷之餘各盡目力假變行之迅速無須臾之或失別有渾球全賦星躔循黃之極碁罫珠聯列曜逺近南北八度小輪之限凖斯無捂亦依赤極出地有恆或正升兮斜降或正降兮斜升晰伏見之先後諳裏差之所因黃緯之列兮百世無攺宮分迆差兮恆星東滙以度計年兮六十六載下設旋輪兮水激自動刻漏防僭兮機發於踵爰有髙弧繋之天頂地平經緯玆焉互審或象限兮平觀或紀限兮斜距或黃赤儀之所窺絜之球而參遇爛若軒轅之寶鏡兮縮圜形而周布眾儀得其散兮球徴其聚正求兮反暎宛轉兮廻互測量有書兮或不能句摩娑斯器兮曠如揭霧更旋宮兮十二隨道裏兮攸殊際地之極南北兮以爲之樞子午及平環兮以限四隅隅各三宮兮東方爲初次第右環兮大權以區三合六合之照兮凶吉分途惟斯球而可暏兮攷步笇之宻疏致用萬端未克枚舉洵天府之奇珍永作則乎來者若其鎔金有法棄滓取精磨礲砥礪光輝熒熒旋之中規直之中繩擘劃勻細度萬其分寘儀衡重測重求心力相扶兮防偏積歳年兮弗傾趺交之以銅龍兮或海獸以相承爲水凖與螺柱兮常消息焉取平天矯兮騰踔攫拏兮猙獰詎美觀兮一時永奠定兮千春乃至崇臺百步迥出闤闠周以儲胥纎埃攸避上列六臺方圓式異相依兮交讓旋觀兮罔閡施窺筒之奇巧眄千里兮如對晝兮日靣之星夜占兮句已之態折照浮光兮气水水气淸蒙厚薄兮地心相配交食淺深兮起虧進退地景厚薄兮靑綠明昧視差有多少兮命天九重月有望兮太白攸同抱日爲輪兮互入相容超西法之舊兮信天能之弗窮登斯臺也軒豁洞逹耳目開通揮斥兮八極廣攬兮無終意气兮飛揚淩虛兮禦風習其器也陸離瀟灑繽紛磊砢燦爛兮朝霞孔明兮朱火照曜兮焜煌周流兮軒翥戄對越兮於穆遊吾心兮太古帝載之虛無兮陟降其所垓埏之遼絕兮斂之一黍匪重黎之誕降兮曷其臻乎要眇邈祈姚之不作兮疇則探斯奧窔伊崇效而卑法兮協至徳於太灝定百代之猶豫兮踵危微於帝道畢逺臣之精思兮備前王之所少璿璣玉衡之不傳兮乃今而獲聖人之大寶亂曰巍巍穹窿帝所則兮父乾母坤不敢不及兮寫以良金如塑像兮朝斯夕斯期勿忘兮子之於父視無形兮瞻玆肖貌曷敢以寧兮兢兢業業承天休兮奉若不違升大猷兮祈天永命從玆始兮億萬斯年昊天其子兮

學歷說

或有問於梅子曰歷學固儒者事乎曰然吾聞之通天地人斯曰儒而戴焉不知其髙可乎曰儒者知天知其理而已矣安用歷曰歷也者數也數外無理理外無數數也者理之分限節次也數不可以臆說理或可以影談於是有牽合傅防以惑民聽而亂天常皆以不得理數之眞蔑由徴實耳且夫能知其理莫堯舜若矣堯典一書命羲和居半舜格文祖首在璇璣玉衡以齊七政豈非以敬天授時固帝王之大經大法而精一之理卽於此寓哉曰然則律何以禁私習曰律所禁者天文也非歷也曰二者異乎曰以日月暈抱珥虹蜺彗孛飛流芒角動揺預斷未來之吉凶者天文家也本躔離之行度中星之次以察發斂進退敬授民事者歷家也漢藝文志天文二十一家四百四十五卷歷譜十八家六百六卷固判然二矣且夫私習之禁亦禁夫妄言禍福惑世誣民耳若夫日月星辰有目者所共睹古者率作興事皆用爲又何禁焉楚邱之詩曰定之方中作於楚宮夏令曰修而場功偫而畚挶營室之中土功其始火之初見期於司裏春秋傳曰凡土功龍見而戒事火見而致用水昏正而栽日至而畢此版築之也豳風之詩曰七月流火九月授衣此裘之也申丰曰古者日北陸而蔵冰西陸朝覿而出之火出而畢賦則蔵冰用冰之也龍見而雩則雩也農祥晨正則畊也三星在天則防也單襄公曰辰角見而雨畢天根見而水涸本見而艸木節解駟見而隕霜火見而淸風戒寒雨畢除道水涸成梁艸木節解而備蔵隕霜而冬裘具淸風至而修城郭宮室是故有一則有一之星有一之星則有一之政令田夫紅女皆知之矣又何禁焉自梓愼禆竈之徒以星气言事應乃始有災祥之占而其說亦有驗有不驗有星孛於大辰禆竈曰宋衛陳鄭將同日火若我用瓘斝玉瓚則不火子產弗與已而火作竈曰不用吾言鄭又將火子產曰天道逺人道邇竈焉知天道是亦多言矣豈不或信卒不與鄭亦不火梓愼以日食占水昭子曰旱也已而果旱愼言不效是故惟子產昭子深明乎理數之實乃有以折服矯誣之論𨿽挾術如愼竈而不爲所動故歷學大著則禨祥小數無所依托而自不得行其於政教不無小補與律禁私習之指固殊塗而同歸矣曰世皆謂天文曆數能前事而知以豫爲趨避而子謂歷學明則占家無所容其欺妄言之徒不待禁而戢其說可得聞乎曰有說也蓋古之爲歷也疎久而漸宻其勢然也惟其疏也歷所步或多不效於是乎求其說焉不得而占家得以附防於其間是故日月之遇交則食以實防視防爲斷有常度也而古歷未精於是有當食不食不當食而食之占日之食必於朔也而古用平朔於是有食在晦二之占月之行有遲疾日之行有盈縮皆有一定之數故可以小輪爲法也而古惟平度於是占家曰晦而月見西方謂之朓朓則王其舒朔而月見東方謂之仄慝仄慝則侯王其肅月行陰陽曆以不足二十年而周其交也則於黃道其交之半也則出入於黃道之南北五度有奇皆有常也而古歷未知於是占家曰天有三門猶房四表房中央曰天街南間曰陽環北間曰陰環月由天街則天下和平由陽道則主防由陰道則主水夫黃道且有歳差而況月道出入於黃道時時不同而欲定之於房中央不已謬乎月出入黃道旣有南北而其與黃道同升也又有正升斜降斜升正降之不同惟其然也故月之始生有平有偃而古歷未知也則爲之占曰月始生正西仰天下有兵又曰月初生而偃有兵兵罷無兵兵起月於黃道有南北一因也正升斜降二因也盈縮遲疾三因也人所居南北有裏差則見月有蚤晚四因也是故月之初見有初二日初三日之殊極其變則有在朔日初四日之異而古歷未知則爲之占曰當見不見又曰不當見而見魄質成蚤也食日者月也不闗雲气而占者之說曰未食之前數日日已有謫日大月小日髙月卑卑則近髙則逺逺者見小近者見大故人所見之日月大小略等者乃其逺近爲之而非其本形也然日月之行各有最髙卑而影徑爲之異故有時月正掩日而四靣露光如金環也此皆有可攷之數而占者則以金環食爲陽徳盛五星有遲疾畱逆而古法惟知順行於是占者以逆行爲災而又爲之例曰未當居而居當去不去當居不居未當去而去皆變行也以占其國之災福五星之出入黃道亦如日月故所犯星座可以預求也而古法無緯度於是占者以爲失行而爲之例曰淩曰犯曰鬭曰食曰掩曰合曰句已曰圍繞夫句已淩犯占可也以爲失行非也五星離黃道不過八度則中官紫微及外官距逺之星必無犯理而占書皆有之近世有著賢相通占者刪去古占黃道極逺之星亦旣知其非是矣至於恆星有定數亦有定距終古不變而世之占者旣無儀器以知其度又不知星座之出入地平有蒙气之差或以橫斜之勢而目視偶乖遂妄謂其移動於是爲占曰王良防馬車騎滿野天鉤直則地維坼泰階平人主有福中州以北去北極度近則老人星逺而近濁不常見也於是古占曰老人星見王者多壽以二分日之若江以南則老人星甚髙三時盡見而疇人子弟猶歳以二分占老人星宻防貢諛此其仍訛習欺尢大彰明者矣故歷學不明而徒爲之禁以嚴之終不能禁也或以禁之故而私相傳習矜爲祕授以售其詐若歷學旣明則人人曉然於其故𨿽有異說而自無所容余所以數十年從事於斯而且欲與天下共明之也且子不徴之功令乎經史語孟士之本業也而魯論言辰居星拱行夏之時孟子言千歳日至可坐而致易言治歷明時大傳言五歳再閏三百有六十當期之日堯典中星分測驗之地璣衡之制爲萬世法辰弗集房載於夏書詩稱十月之交朔日辛卯春秋紀日食三十六禮載月令大戴禮述夏小正皆詳日所在宿及恆星伏見昏旦之中與其方向低昻之狀用爲月節以布政教而成百事又自漢太初以來造歷者數十家皆具其說於史若是者旣刋布其書使學者誦習之矣三年而試之程式發防往往有及於律曆者其於律之禁寧相背乎是故律禁私習妄言而未嘗禁士之習經史也而顧諉之爲星翁卜師之事而漫不加察反令術士者流得挾其不經之說以相炫誘而不能斷其惑是亦儒者之過也故人之言天以占驗爲奇吾之言歷以能辯惑爲正曰然則占驗可廢乎將天變不足畏邪曰惡是何言也吾所謂辯惑者辯其誣也若夫王者遇災而懼側身修省以答天戒固欽若之精意也又可廢乎古者日食修徳月食修刑夫徳與刑固不以日月之食而始修也遇其變加警惕焉此則理之當然未敢以數之有常而或懈也此又學歷者所當知

歷學源流論

梅子殫心歷學數十年而嘆心之神明無有窮盡𨿽以天之髙星辰之逺有遲之數千百年始見端緒而人輙知之輙有新法以追其變故世愈降歷愈以宻而要其大法則定於唐虞之時今夫歷所步有四曰恆星曰日曰月曰五星治歷之具有三曰數曰圖像曰測驗之器由是三者以得前四者躔離朓朒盈縮交蝕遲畱伏逆掩犯之度古今作歷者七十餘家疏宻代殊制作各異其法具在可攷而知然大約三者盡之矣堯命羲和歷象日月星辰舜在璇璣玉衡以齊七政歷者數也象者圖也渾象也璿璣玉衡測驗之器也故曰定於唐虞之世也然歷之最難知者有二其一里差其一歳差是二差者有微有著非積差而至於著𨿽聖人不能知而非其距之甚逺則所差甚微非目力可至不能入故古未有知歳差者自晉虞喜宋何承天祖衝之隋劉焯唐一行始覺之或以百年差一度或以五十年或以七十五年或以八十三年未有定說元郭守敬定爲六十六年有八月回回泰西差法略似而守敬又有上攷下求增減歳余天周之法則古之差遲而今之差速是謂歳差之差可謂精到若夫日月星辰之行度不變而人所居有東南西北正視側視之殊則所見各異謂之裏差亦曰視差自漢及晉未有知之者也北齊張子信始測交道有表裏此方不見食者人在月外必反見食宣明歷本之爲气刻時三差而大衍歷有九服測食定晷漏法元人四海測驗二十七所而近世歐邏巴航海數萬里以身所經山海之程測北極爲南北差測月食爲東西差裏差之說至是而確是蓋合數千年之積測以定歳差合數萬里之實驗以定裏差距數逾逺差積逾多而曉然易辧且其爲法旣推之數千年數萬里而凖則施之近用可以無惑歷至今日屢變益精以此然余亦謂定於唐虞之時何也不能預知者差之數萬世不易者求差之法古之聖人以日之所在不可以目視而器窺也故爲之中星以紀之鳥火虛昴此萬世求歳差之根數也又以日之出入發斂不可以一方之所見爲定也故爲之嵎夷昧谷南交朔方之宅以分之此萬世求裏差之定法也嗚呼至矣學者知合數千年數萬里之心思耳目以治歷而後能精宻又知合數千年數萬里之心思耳目以爲之精宻者適以成古聖人未竟之緒則當思羲和以後凡有能出一新智立一防法之至今者皆有其所以立法之故及其久而必變也又皆有所以變之說於是焉反覆推論必使理解冰釋無纎毫疑似於吾之心則吾之心卽古聖人之心亦卽天之心而古今中外之見可以不設而要於至是夫如是則古人之精意可使常存不致湮沒於耑已守殘之士而過此以往或有差變之微出於今法之外亦可本其常然以深求其變而徐爲之修攺以衷於無則是善於治歷者也

歷算全書卷六﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

序

歷家所憑全恃測驗昔者蔡邕上書願匍匐渾儀之下按度考數著於篇章以成一代盛典古人之用心蓋可想見然則儒者端居斗室足不履觀臺目不睹渾象安所得測驗之事而親之而安從學之曰所恃者有測驗之法之理在則句股是也遭秦之厄天官書器散亡漢落下閎鮮於妄人等追尋墜緒歷代相承攷訂加詳至於今日厥理大著則句股之用於渾圓是也今夫測量之法方易而圓難古用徑一圍三聊舉成數非有所不知也自劉徽祖衝之各爲圓率逮元趙友欽定爲徑一則圍三一四一五九二與今西術略同皆割圓以得之非句股奚借焉【西法割圓比例以直角三邊形爲主卽句股也但異其名不異其實】然用句股測平圓猶易用句股測渾圓更難歷家所測皆渾圓也非平圓也古有黃赤道相準之率大約於渾器比量僅得梗槪未能彰諸笇術近代諸家以相減相乘推變其差損益有序稍爲近之而未親也惟元郭太史守敬始以弧矢命笇有平視側視諸圖推步立成諸數黃赤相求斯有定率視古爲密由今觀之皆句股也但其立法必先求矢又用三乘方取數不易故但能列其一象限中度率不復能求其細分之數曆書之法則先求角旣因弧以知角復因角以知弧而句股之形能預定其比例又佐之八綫互用以通其窮其法以三弧度相交輒成三角則此三弧度者各有其相應之弧與弧相割卽與相遇而句股生焉茍熟其法則正反斜側八綫犁然各相得而成句股【八綫比例以半徑全數爲正余爲句爲股又以割綫爲切綫與半徑全數爲其句股表中所列句股形凡五千四百】於是乎黃可變赤赤可變黃可以經度知緯可以緯度知經羅絡鉤連旁通曲暢分秒忽微臚陳笇位求諸中心可無纎芥之疑告諸同學亦如指掌之晰卽不必匍匐渾儀之下可以不窺牖而見天道賴有此具也全部曆書皆弧三角之理卽皆句股之理顧未嘗正言其爲句股使人望洋無際【彼云直角三邊形此云句股乃西國方言譯書時不知此理遂生分別】又譯書者識有偏全筆有工拙語有淺深詳略所載圖說不無滲漏之端影似之談與臆參之見學者病之玆稍爲摘其肯綮從而防剔訂補以直截發明其所以然竊爲一言以蔽之曰析渾圓防句股而已蓋於是而知古聖人立法之精𨿽弧三角之巧豈能出句股範圍然句股之用亦必至是而庶無餘蘊爾歷法之深防奧衍不啻五花八門其章句之詰曲離奇不啻羊腸絙度而由是以啟其扃鑰庶將掉臂遊行若揭日月而騁康莊矣文𨿽不多實爲此道中開辟塗徑蓋積數十年之探索而後能防通簡易故亟欲與同志者共之餘老矣禹服九州之大歷代聖人教澤所漸被必有好學深思其人所冀大爲闡發俾古人之意晦而復昭一綫之傳引而弗替則生平之志願畢矣豈必身擅其名然後爲得哉余拭目竢之康熙二十三年上元甲子長至之吉勿庵梅文鼎書於柏梘山中

欽定四庫全書

歷算全書卷七

宣城梅文鼎撰

弧三角舉要卷一

弧三角體勢

弧三角與平異理故先體勢知體勢然後可以用算而算莫先於正弧猶平三角之有句股形也故以爲弧度之宗正弧形之之角取法於黃赤交角則有定度而余角取法於過極圏交黃道之角則隨度而移互用之其理益顯故有求余角法弧三角以一角對一邊而比例等與平三角同而其理別故有弧角比例法斜弧無相對之弧角則比例之法窮故有垂弧法三角求邊則垂弧之法又窮故有次形法垂弧與次形合用則有捷法弧與角各有八綫而可以互視故有相當法【余詳環中尺及塹堵測量】

弧度與天相應

弧三角之法以測渾員渾員之大者莫如天員之至者亦莫如天故弧三角之度皆天度也

以平測員其難百倍以員測員其簡百倍而得數且眞是故測天者必以弧度而論弧度者必以天爲法測弧度必以大圏

渾球上弧度有極大之圏乃腰圍之一綫也如赤道帶天之紘原止一綫如黃道如子午規如地平規盡然又如測得兩星相距之逺近亦爲大圏之分【若以此兩星之距弧引而長之必匝於渾員之體而成大圏不論從衡斜側皆同一法】

球上大圏必相等

所以必用大圏者以其相等也渾球上從衡斜側皆可爲大圏而其大必相等者以俱在腰圍之一綫也如黃道赤道及子午規地平規俱系大圏必皆相等不相等卽非大圏故惟大圏可相爲比例【任測兩星之距不必當黃赤道而能與二道相比例者以其皆大圏也】

球上兩大圏無平行者

大圏在渾球旣爲腰圍之一綫則必無兩圏平行之法若平行卽非大圏【如黃赤道並止一綫而無廣卽無地可容平行綫也子午規地平規亦然】球上圏能與大圏平行者皆小圏謂之距等圏

離大圏左右作平行圏皆曰距等圏謂其四圍與大圏相距皆等【如於黃道內外作緯圏其與黃道相距或近則四靣皆近或逺則四面亦皆逺無毫忽之不同平行故也赤道緯圏地平髙度並同】而其自相距亦等故曰距等也【如黃道內外或近或逺處處可作距等圏而皆與黃道平行卽其圏亦自相平行故並爲等距】距等圏皆小於大圏【如黃道內外緯圏但離數分其圍卽小於黃道其距益逺其圏益小小之極至一防而止諸緯圏並然】不能與大圏爲比例【大圏惟一距等圏無數無一同者無法可爲比例】故爲比例者必大圏也

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷七﹥

如圖甲乙爲大圏大圏只一丙丁及戊庚等皆小圏小圏無數漸近圎頂己卽其圏愈小而成一防大小懸殊故不可以相爲比例

大圏之比例以度不拘丈尺

凡圏皆可分三百六十度【每圏平分之成半周四平分之成像限象限又各平分之爲九十度成三百六十度】而球大者其大圏大球小者其大圏小皆以本球之圍徑自爲比例不拘丈尺【盡本球之圍分爲全周之度其球上之度卽皆以此爲準但在本球上爲最大故謂之大圏非以丈尺言其大小】古人以八尺渾儀準周天蓋以此也又如古渾儀原有三重其在內之環周必小於外而其度皆能相應者在內環周𨿽小而在內之渾員以此爲大圏卽在內之各度並以此爲準故也

大圏之度爲公度

凡球上距等圏亦可平公三百六十度而其圈皆小於本球之大圏又大小不倫則其所分之細度亦皆小於大圈而大小不倫矣惟本球腰圍大圏上所分之度得爲公度故凡言度者必大圏也

如圖甲乙爲大圏一象限丙丁及戊庚各爲距等小圏一象限象限𨿽同而大小迥異又如甲辛爲大圈三十度丙壬及戊癸亦各爲小圏之三十度其爲三十度𨿽同而大小亦異再細攷之至一度或至一分亦大小異也故惟大圏之度爲公度

大圏卽本球外周其度卽外周之度而橫直皆相等

平員有徑有周渾員亦有徑有周立渾員於前則外周可見卽腰圍之大圏也旋而視之皆可爲外周故大圏之橫直皆等【皆以外周度爲其度故等】

如圖子午規爲渾儀外周其度三百六十乃橫度也地平爲腰圍度亦三百六十乃橫度也橫度直度皆得爲外周故其度相等若依北極論之則赤道又爲腰圍而亦卽外周也推是言之渾球上大圏從衡斜側皆相等何則旋而視之皆得爲腰圍卽皆得爲外周故也大圏上相遇有相割無相切大圏相割各成兩半分

球上從衡斜側旣皆成大圏則能相割矣而皆爲渾員之外周則必無相切之理【若相切者必在外周之內爲距等小圈】

如圖甲丙乙爲大圏半周能割大圏於甲於乙而不能相切丙丁成小圈則能切大圏於丙於丁

如圖甲庚辛乙爲大圏半周割外圏於甲於乙則甲己乙乙子甲亦各成半周若壬癸距等圏割大圏於庚於辛而庚辛非半周

球上兩大圏相割必有二處此二處必相距一百八十度而各成兩平分如黃赤二道相交於春分必復相交於秋分卽二分之距必皆半周一百八十度而黃道成兩半分赤道亦兩平分也若距等圏與大圏相割必不能成兩平方

兩大圏相遇則成角

球上大圏旣不平行則其相遇必相交相割而成角弧三角之法所由以立也角有正有斜斜角又有銳鈍共三種而角兩旁皆弧綫與直綫角異

如圖己午戊子爲子午規辛午乙子爲地平規兩大圏正相交於南地平之午北地平之子則皆正角而四角皆等並九十度角也【正角一名直角一名十字角一名正方角】

如圖午辛子爲地平規丁辛癸爲赤道規兩大圏斜相交於辛則丁辛子鈍角大於九十度丁辛午銳角小於九十度兩角相並一百八十度減銳角其外角必鈍若減鈍角亦得鋭角也故有內角卽知外角又兩銳角相對兩鈍角相對其度分必等故有此角卽知對角凡此數端並與平三角同然而實有不同者以角兩旁之爲弧綫也

弧綫之作角必兩

直綫剖平員作角形如分餅角旁兩綫皆半徑至周而止弧綫剖渾冪作角形如剖角旁兩弧綫皆半周必復相交作角而等【如黃赤道交於二分其角相等】

角有大小量之以對角之弧其角旁兩弧必皆九十度

弧綫角旣如瓣則其相距必兩端狹而中濶其最濶處必離角九十度此處離兩角各均卽球上腰圍大圏也故其度卽爲角度【如黃赤道之二分交角二十三度半卽二至時距度此時黃赤道離二分各九十度乃腰圍最濶處也】

大圈有極

大圏能分渾員之面冪爲兩則各有最中之處而相對是爲兩極兩極距大圏四靣各九十度

如圖甲辛乙爲赤道大圈己爲北極己爲南極甲己丁己等弧綫距北極各九十度距南極亦然若己爲天頂甲辛乙爲地平大圏亦同如甲正北辛正東乙正南丁東北丙東南所在不同而甲乙等髙弧距天頂各九十度皆等

大圏上作十字弧綫引長之必過兩極兩極出弧綫至大圏必皆十字正交

如赤道上經圏皆與赤道正交爲十字角則其圏必上過北極下過南極也然則從兩極出弧綫過赤道必十字正交矣

大圏之極爲眾角所輳

如赤道上逐度經圏皆過兩極則極心一防爲眾角之宗【經圏之弧在赤道上成十字者本皆平行漸逺漸狹至兩極則成角形之銳尖】角無論大小皆輳於極而合成一防離此一防外卽成銳鈍之形而皆與赤道度相應所謂量角以對弧度而角兩旁皆九十度以此

如圖己爲北極卽眾角之頂鋭其所當赤道之度如乙丙等則己角爲鋭角如丙庚等則己角爲鈍角若己爲天頂外圏爲地平亦然

角度與角旁兩弧之度並用本球之大圏度故量角度者以角爲極

有弧綫角不知其度亦不知角旁弧之度法當先求本球之九十度【其法以角旁二弧各引長之使復作角乃中分其弧卽成本弧之九十度而角旁弧之度可知】以角爲心九十度爲界作大圏【與角旁兩弧並本球大圏而其分度等】乃視角所當之弧【卽角旁兩九十度弧所界】於大圏上得若干度分卽角度也故曰以角爲極

三大圏相遇則成三角三邊

此所謂弧三角形也如黃道赤道旣相交於二分又有赤道經圏截兩道而過之則成乙丙甲弧三角形

知圖己爲北極戊辛爲赤道丁庚爲黃道二道相交於春分成乙角又己壬爲過極經圏自北極己出弧綫截黃道於丙得丙乙邊爲黃道之一弧亦截赤道於甲成甲乙邊爲赤道之一弧而過極經圏爲二道所截成丙甲邊爲經圏之一弧是爲三邊卽又成丙角甲角合乙角爲三角

弧三角不同於平三角之理

弧三角形有三角三邊共六件以先有之三件求餘三件與平三角同所不同者平三角形之三角並之皆一百八十度弧三角不然其三角最小者比一百八十度必盈【三邊在一度以下可借平三角立算因其差甚微然其角度視半周必有微盈】但不得滿五百四十度【角之極大者合之以比三半周必不能及】

平三角之邊小僅咫尺大則千百萬里弧三角邊必在半周以下【不得滿一百八十度】合三邊不得滿三百六十度【如滿全周卽成全員而不得成三角】

平三角有兩角卽知余角弧三角非算不知

平三角有一正角餘二角必銳弧三角則否【有三正角兩正角者其餘角有鈍有鋭或兩鋭兩鈍或一鋭一鈍不等】

平三角有一鈍角餘二角必銳弧三角則否【其餘角或鋭或正或鈍甚有三鈍角者】

平三角以不同邊而同角爲相似形同邊又同角爲相等形弧三角則但有相等之形而無相似之形以同角者必同邊也

平三角但可以三邊求角不可以三角求邊弧三角則可以三角求邊【弧三角之邊皆員度也初無丈尺可言故三角可以求邊若干三角邊各有丈尺則必有先得之邊以爲之例所以不同前條言有相等之形無相似之形亦謂其所得之度相等非謂其丈尺等也】

弧三角用八綫之理

平三角用八綫惟用於角弧三角用八綫並用於邊平三角以角之八綫與邊相比弧三角是以角之八綫與邊之八綫相比平三角有正角卽爲句股若正弧三角形實非句股而以其八綫輳成句股

平三角以角求邊是用弧綫求直綫也【有角卽有弧】以邊求角是用直綫求弧綫也然角以八綫爲用仍是以直綫求直綫也句股法也弧三角以邊求角以角求邊並是以弧綫求弧綫也而角與邊並用八綫仍是以直綫求直綫也亦句股法也【蓋惟直綫可成句股】所不同者平三角所成句股形卽在平靣而弧三角所成句股不在弧靣而在其內外

弧三角之防綫面體

測量家有防綫面體弧三角備有之其所測之角卽防也但其防俱在弧靣【如於渾球任指一星爲所測之防卽角度從玆起如太陽太陰角度並從其中心一防論之】

弧三角之邊卽綫也但其綫皆弧綫【如渾球上任指兩星卽有距綫或於一星出兩弧綫與他星相距卽成角而角旁兩綫皆弧綫也】

弧三角之形卽靣也但其靣皆渾球上面冪之分形弧三角之所麗卽渾體也剖渾員至心卽成錐體而並以弧三角之形爲底【詳塹堵測量】

渾員內防綫面體與弧三角相應

前條防綫面體俱在球面可以目視器測但皆弧綫難相比例【比例必用句股句股必直綫故也】賴有相應之防綫面惟在渾體內歷員可指𨿽不可以目視而可以算得弧三角之法所以的確不易也如渾球中剖則成平員卽靣也於是以球面之各防【卽弧三角之各角】依視法移於平員面卽渾員內相應之防也又以弧與角之八綫移至平面成句股以相比例是渾員內相應之綫也又如弧三角之三邊各引長之成大圏各依大圏以剖渾員卽各成平員面是亦渾員內相應之面也二平員面相割成瓣之體三平員面相割成三楞錐體若又依八綫橫割之卽成塹堵諸體是渾員體內相應之分體也此皆與弧面相離在渾員之內非剖渾員卽不可見而可以算得卽不啻目視而器測矣

大圏與渾員同心

球上大圏之心卽渾員之心【若依各大圏剖渾員成平員面其平員心卽渾員之心】若距等小圏則但以渾員之軸爲心而不能以渾員心爲心同心者亦同徑【大圏以渾貟徑爲徑若距等圏則但以通爲徑】渾體內諸綫能與弧三角相應者以此【渾員體內諸綫皆宗其徑弧三角旣以大圏相割而成必宗大圏之徑徑同故內外相應】弧三角之邊不用小圏亦以此也【距等圏旣與大圏異徑則其度不齊不能成邊而所作之角必非眞角無從考其度分也】

弧三角視法

弧三角非圖不明然圖弧綫於平面必用視法變渾爲平

平置渾儀從北極下視則惟赤道爲外周不變而黃道斜立卽成撱形其分至各經圏本穹然半員今以正視皆成員徑是變弧綫爲直綫也

立置渾儀使北極居上而從二分平視之則惟極至交圏爲外周不變其赤道黃道俱變直綫爲員徑而成輳心之角【卽大距度平面角】是變弧綫角爲直綫角也【又距等圏亦變橫綫而成各度正與員徑平行】其赤道上逐度經圏之過黃赤道者𨿽變撱形而其正不變且歷算可見如在平面而與平面上之大距度正同角成大小句股比例是弧面各綫皆可移於平面也故視法不但作圖之用卽步算之法已在其中

以上謂之正視【以黃赤道爲式若於六合儀取天頂地平諸綫亦同他可類推】

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷七﹥

以上謂之旁視【渾員上有垜疊諸綫從旁側視之庶幾可見𨿽不能按度肖形而大意不失以顯弧三角之理爲用亦多】

角之矢

如圖甲丙乙丁半渾員以甲戊乙弧界之則其弧面分兩角爲一鋭一鈍以視法移此弧度於相應之平面亦一鋭一鈍卽分員徑爲大小二矢而戊丙正矢爲戊甲丙鋭角之度【戊乙丙亦同】戊丁大矢爲戊甲丁鈍角之度【戊乙丁亦同】故得矢卽得角

角之八綫

如前圖丙戊弧爲甲銳角之度與丙庚等則丙戊之在平面者變爲直綫卽爲甲鋭角之矢而戊巳爲角之餘戊庚爲角之正丙辛爲角之切綫己辛爲角之割綫皆與平面丙庚弧之八綫等

丁巳戊過弧爲甲鈍角之度與丁乙庚過弧等則丁戊在平面者變爲鈍角之大矢而戊巳余戊庚正丙辛切綫己辛割綫並與鋭角同【平面鈍角之八綫與外角同用弧三角亦然】正弧斜弧之角與邊分爲各類

凡三角內有一正角謂之正弧三角形三角內並無正角謂之斜弧三角形

正弧三角形之角有三正角者有二正角一鋭角者有二正角一鈍角者【以上種種不須用算】又有一正角兩鋭角者【內分二種一種兩銳角同度一種兩銳角不同度】有一正角兩鈍角者【內分二種一種兩鈍角同度一種兩鈍角不同度】有一正角一銳角一鈍角者【內分二種一種銳鈍角角合之成半周一種合銳鈍兩角不能成半周】計正弧之角九種而用算者六也

正弧三角形之邊有三邊並足者【足謂足九十度】有二邊足一邊小者【在象限以下爲小】有二邊足一邊大者【過象限以上爲大○以上三種可不用算】有三邊並小者【內分二種一種二邊等一種二邊不等】有二邊大而一小者【內分三種一種二大邊等一種二大邊不等一種小邊爲一大邊減半周之餘】計正弧之邊八種而用算者五也

二邊俱小則余邊必不能大故無二小一大之形二邊俱大則余邊亦不能大故無三邊並大之形一邊若足則余邊亦有一足故無一邊足之形

正弧三角形圖一【計三種】

正弧三角形圖二【訃三種】

以上正弧形三種有同度之邊與角謂之二等邊形內有己形𨿽無同等之邊角而有共爲半周之邊角度𨿽不同而所用之正則同卽同度也

凡邊等者角亦等後仿此

正弧三角形圖三【計三種】

以上正弧形三種邊角與丁戊巳三種無異但無同度之邊凡正弧三角形共九種

斜弧三角形之角有三角並鋭者【內分三種一種有二角相等一種三角不相等一種三角俱等】有二角銳而一鈍者【內分四種一種二銳角相等一種二銳角不相等一種鈍角爲一銳角減半周之餘一種二銳角相等而又並爲鈍角減半周之餘】有二角鈍而一銳者【內分四種一種二鈍角相等一種二鈍角不相等一種銳角爲一鈍角減半周之餘一種二鈍角相等而又並爲銳角減半周之餘】有三角並鈍者【內分三種一種有二角相等一種三角不相等一種三角相等】計斜弧之角十有四種

斜弧三角形之邊有一邊足二邊小者【內分二種一種二小邊相等一種二小邊不等】有一邊足二邊大者【內分二種一種二大邊等一種二大邊不等】有一邊足一邊小一邊大者【內分二種一種大小二邊合之成半周一種合二邊不能成半周】有三邊並小者【內分三種一種三邊不等一種二邊等一種三邊俱等】有二邊大而一小者【內分四種一種二大邊等一種二大邊不等一種小邊爲一大邊減半周之餘一種二大邊等而又並爲小邊減半周之餘】有二邊小而一大者【內分四種一種二小邊等一種二小邊不等一種大邊爲一小邊減半周之餘一種二小邊等而又並爲大邊減半周之餘】有三邊並大者【內分三種一種三邊不等一種二邊等一種三邊俱等】計斜弧之邊二十種

斜弧三角形圖一【計四種】

以上斜弧形四種並三角三邊同度謂之三等邊形內有二等邊者其一邊爲等邊減半周之餘與三等邊同法【以同用正故】

斜弧三角形圖二【計十二種】

以上斜弧三角形十二種並二等邊形內有四種以大小二邊度成半周與二等邊同法【小邊爲大邊減半周之餘則同用一正】

斜弧三角形圖三【計十種曆書只九種遺一鋭二鈍形】

以上斜弧三角形十種並三邊不等【用算只四種】

凡斜弧三角形共二十六種

通共弧三角形三十五種【內除正弧三種不須用算實三十二種】

乙丁寅爲赤道乙丙癸爲黃道乙與寅爲春秋分癸爲夏至午癸丁辰爲極至交圏午與辰爲南北極午丙甲爲過極經圈

丙乙爲黃道距二分之度甲乙爲赤道距二分之度【卯同升度】丙甲爲黃赤距緯成丙乙甲三角弧形甲爲正角乙春秋分角與渾員心卯角相應

癸丁弧爲黃赤大距【卽乙角之弧亦爲夘角之弧】癸巳爲乙角正卯巳其餘戊丁爲乙角切綫戊卯其割綫卯癸及夘丁皆半徑成癸巳夘及戊丁夘兩句股形

又午夘半徑庚午爲乙角余切庚夘爲乙角余割成午夘庚倒句股形

丙辛爲丙甲距度正丙壬爲丙乙黃道正作辛壬綫與丁卯平行成丙辛壬句股形

子甲爲丙甲距度切綫甲醜爲甲乙赤道正作子丑綫與丙壬平行成子甲丑句股形

酉乙爲丙乙黃道切綫未乙爲甲乙赤道切綫作酉未綫與子甲平行成酉未乙句股形

前二句股形在癸丁大距弧內外【癸巳邜用正余在弧內戊丁夘用割切綫出弧外】後三句股形在丙乙甲三角內外【丙辛壬在丙角用兩正在渾員內子甲丑在甲角兼用正切綫半在內半在外酉未乙用兩切綫在渾員外】

論曰此五句股形皆相似故其比例等何也赤道平安從乙視之則丁乙象限與丁夘半徑視之成一綫而辛壬聨綫甲丑正未乙切綫皆在此綫之上矣以其綫皆平安皆在赤道平面與赤道半徑平行故也【是爲句綫】赤道平安則黃道之斜倚亦平其癸乙象限與癸夘半徑從乙視之亦成一綫而丙壬正子丑聨綫酉乙切綫皆在此綫之上矣以其綫皆斜倚皆在黃道平面與黃道半徑平行故也【是爲綫】

黃赤道相交成乙角而赤道旣平安則從乙窺夘卯乙半徑竟成一防而乙丑壬夘角合成一角矣

諸句股形旣同角而其句綫皆同赤道之平安其綫皆同黃道之斜倚則其股綫皆與赤道半徑爲十字正角而平行矣是故形相似而比例皆等也【其夘午庚倒句股形爲相當之用與諸句股形亦相似而比例等】

又論曰丙辛壬形兩正【丙辛丙壬】俱在渾體之內其理易明子甲醜形甲醜正在渾體內子甲切綫在渾體之外已足詫矣酉未乙形兩切綫【酉乙未乙】俱在渾體之外𨿽習其術者未免自疑曆書置而不言蓋以此耶今爲補說詳明欲令學者了然心目庶以用之不疑

用法

假如有丙乙黃道距春分之度求其距緯丙甲法爲半徑癸夘與乙角之正癸巳若丙乙黃道之正丙壬與丙甲距緯之正丙辛也

一半徑全數癸夘

二乙角正癸巳股

三黃道正丙壬

四距緯正丙辛股

若先有丙甲距度而求丙乙黃道距二分之度則反用之爲乙角之正癸巳與半徑癸夘【若欲用半徑爲一率以省除則爲半徑午夘與乙角之餘割庚夘其比例亦同】若丙甲距緯之正丙辛與丙乙黃道之正丙壬也

一乙角正癸巳

半徑全數午夘股二半徑全數癸夘

乙角余割庚夘

三距緯正丙辛

股

四黃道正丙壬



右丙辛壬形用法

假如有甲乙赤道同升度求距緯丙甲法爲半徑夘丁與乙角之切綫丁戊若甲乙赤道之正甲醜與丙甲距緯之切綫子甲也

一半徑全數卯丁句

二乙角正切丁戊股

三赤道正甲醜句

四距緯正切子甲股

若先有丙甲距緯而求甲乙赤道則反用之爲乙角之切綫戊丁與半徑丁夘【或用半徑爲一率則爲半徑夘午與乙角之餘切午庚】若丙甲距緯之切綫子甲與甲乙赤道之正甲醜也一乙角正切戊丁半徑全數卯午股二半徑全數丁夘乙角余切午庚句

三距緯正切子甲

股

四赤道正甲醜

句

右子甲醜形用法

論曰以上四法曆書所有但於圖增一夘午庚句股形則互視之理更明

假如有丙乙黃道距二分之度徑求甲乙赤道同升度法爲半徑夘癸與乙角之餘夘巳若丙乙黃道之切綫酉乙與甲乙赤道之切綫未乙也

一半徑全數夘癸

二乙角余卯巳句

三黃道正切酉乙

四赤道正切未乙句

若先有甲乙赤道而求其所當黃道丙乙法爲半徑丁夘與乙角之割綫戊夘若甲乙赤道之切綫未乙與丙乙黃道之切綫酉乙也

一半徑全數丁夘句

二乙角正割戊夘

三赤道正切未乙句

四黃道正切酉乙

論曰以上兩條酉未乙形用法予所補也有此二法黃赤道可以自相求而正角弧形之用始備矣外此仍有三弧割綫余之用具如別紙

十餘年前曽作弧三角所成句股書一冊稿存兒輩行笈中覓之不可得也庚辰年乃復作此至辛己夏復得舊稿爲之惘然然其理固先後一揆而說有詳略可以互明不妨並存以徵予學之進退因思古人畢生平之力而成一事良自不易世有子云或不以覆瓿置之乎康熙辛己七夕前兩日勿庵梅文鼎識是日也爲立秋之辰好雨生涼炎歊頓失稍簡殘帙殊散人懷

甲乙丙正弧三角形卽測量全義第七卷

原圖稍爲酌定又增一酉未乙形

測員之用甚博非止黃赤也然黃道赤道南北極二分二至諸名皆人所習聞故仍借用其號以便識別案圖中句股形凡五皆形相似

其一癸巳夘形

以癸卯半徑爲【卽黃道半徑】癸巳正爲股【卽黃赤大距弧之正】巳夘余爲句【卽黃赤大距弧之餘】

其二戊丁夘形

以戊夘割綫爲【卽黃赤大距弧之正割綫】戊丁切綫爲股【卽黃赤大距弧之正切綫】丁夘半徑爲句【卽赤道半徑】

以上二句股形生於黃赤道之大距度乃總法也兩句股形一在渾體之內一出其外同用夘角【卽黃道心亦卽春分角】

其三丙辛壬形

以丙壬正爲【卽黃經乙丙弧之正以丙夘黃道半徑爲其全數而夘壬其餘】丙辛正爲股【卽黃赤距緯丙甲弧之正亦以丙夘黃道半徑爲其全數而辛夘其餘】辛壬橫綫爲句

法於赤道平面上作橫綫聨兩余成夘壬辛平句股形此形以距緯余【夘辛】爲黃經余【夘壬】爲股而辛壬其句也此辛壬綫旣爲兩余平句股形之句亦卽能爲兩正立句股形之句矣曆書以辛壬爲丙辛之餘誤也然則當命爲何綫曰此非八綫中所有乃立三角體之楞綫也

其四子甲醜形

以子丑斜綫爲【此亦立三角體之楞綫也非八綫中之綫】子甲切綫爲股【卽黃赤距緯弧之正切綫以赤道半徑甲夘爲其全數而子夘其割綫也】甲醜正爲句【卽赤經乙甲弧之正亦以赤道半徑甲夘爲其全數而醜夘其餘也】

其五酉未乙形

以酉乙切綫爲【卽黃經丙乙弧之正切綫以黃赤半徑夘乙爲其全數而酉夘其割綫也】酉未立綫爲股【此亦立三角之楞綫非八綫中之綫】未乙切綫爲句【卽赤經乙甲弧之正切綫亦以黃赤半徑夘乙爲其全數而未夘其割綫也】

以上三句股形生於設弧之度第三形在渾體之內第四形半在渾體之內而出其外第五形全在渾體之外

問旣在體外其狀何如曰設渾圓在立方之內而以兩極居立方底蓋之心以乙春分居立方立面之心則黃赤兩經之切綫酉乙未乙皆在方體之立面而未乙必爲句酉乙必爲於是作立綫聨之卽成酉未乙句股形矣此一形曆書遺之予所補也【詳塹堵測量】

論曰此五句股形皆同角故其比例等然與弧三角眞同者乙角也

第一【癸巳夘形】第二【戊丁夘形】兩形皆乙角原有之八綫卽春秋分角也其度則兩至之大距也

或先有角以求邊則以此兩形中綫例他形中綫得綫則得邊矣

或先有邊以求角則以他形中綫例此兩形中綫得綫則亦得角矣【蓋夘角卽乙角也○若欲求丙角則以丙角當乙角如法求之】

第三形【丙辛壬形】以黃經之正【丙壬】黃赤距度之正【丙辛】爲與股是以黃經與距緯相求

或先有乙角有黃經以求距緯【用乙角實用壬角下同】

或先有乙角有距緯以求黃經

或先有黃經距緯可求乙角亦可求丙角

第四形【子甲醜形】以黃赤距緯之切綫【子甲】赤經之正【甲醜】爲股與句是以距緯與赤經相求

或先有乙角有赤經以求距緯【用乙角實用醜角下同】

或先有乙角有距緯以求赤經

或先有赤經距緯可求乙角亦可丙角

第五形【酉未乙形】以赤經之正切【未乙】黃經之正切【酉乙】爲句與是黃赤經度相求

或先有乙角有黃經以求赤道同升度

或先有乙角有赤道同升以求黃經

或先有黃赤二經度可求乙角亦可求丙角

又論曰諸句股形所用之夘壬醜乙四角實皆乙角何也側望則弧度皆變正而體心夘作直綫至乙爲夘壬丑乙綫卽半徑也今以側望之故此半徑直綫化爲一防則乙角卽夘角亦卽壬角亦卽醜角矣

癸丁爲乙角之度【卽黃赤大距二至緯度】癸乙爲黃道半徑丁乙爲赤道半徑戊丁爲乙角切綫癸巳爲乙角正戊乙爲乙角割綫已乙爲乙角余癸巳乙戊丁乙皆句股形其乙角卽夘角

丙甲爲設弧距度其正丙辛其切綫子甲

丙乙爲所設黃道度其正丙壬【因側望弧度正成一綫】偕距度正丙辛成句股形其乙角卽壬角

甲乙爲所設赤道同升度其正甲醜【因側望弧度正成一綫】偕距度切綫子甲成句股形其乙角卽醜角

酉乙爲所設黃經切綫未乙爲赤道同升度切綫此兩綫成一酉未乙句股形在體外眞用乙角

正弧三角形求余角法

凡弧三角有三邊三角先得三件可知余件與平三角同理前論正弧形以黃赤道爲例而但詳乙角者因春分角有一定之度人所易知故先詳之或疑求乙角之法不可施於丙角玆復爲之條析如左【仍以黃道上過極經圏之交角爲例】

假如有乙丙黃道度有乙甲赤道同升度而求丙交角則爲乙丙之正與乙甲之正若半徑與丙角之正也

假如有丙甲距度及乙甲同升度而求丙交角則爲丙甲之正與乙甲之切綫若半徑與丙角之切綫

假如有丙甲距度及乙丙黃道度而求丙交角則爲乙丙之切綫與丙甲之切綫若半徑與丙角之餘

又如有丙交角有乙丙交道度而求乙甲同升度則爲半徑與丙角之正若乙丙之正與乙甲之正

或先有乙甲同升度而求乙丙黃道度則以前率更之爲丙角之正與半徑若乙甲之正與乙丙之正

又如有丙交角有乙甲同升度而求丙甲距度則爲丙角之切綫與半徑若乙甲之切綫與丙甲之正

或先有丙甲距度而求乙甲同升度則以前率更之爲半徑與丙角切綫若丙甲正與乙甲切綫

又如有丙交角有乙丙黃道度求丙甲距度則爲半徑與丙角余若乙丙切綫與丙甲切綫

或先有丙甲距度而求乙丙黃道則以前率更之爲丙角余與半徑若丙甲切綫與乙丙切綫

論曰求丙角之法一一皆同乙角更之而用丙角求余邊亦如其用乙角也所異者乙角定爲春分角則其度不變丙角爲過極經圏交黃道之角隨度而移【交角近大距則甚大類十字角近春分只六十六度半弱中間交角度度不同他亦然皆逐度變丙角】有時大於乙角有時小於乙角【乙角不及半象限則丙角大乙角過半象限則丙角有時小】故必求而得之又論曰丙交角旣隨度移而甲角常爲正角何也凡球上大圏相交成十字者必過其極今過極經圏乃赤道之經綫惟二至時則此圏能過黃赤兩極其餘則但過赤道極而不能過黃道極故其交黃道也常爲斜角【卽丙角】交赤道則常爲正角【卽甲角】

又論曰丙角與乙角共此三邊【一乙丙黃道一乙甲赤道一丙甲距度】其所用比例者亦共此三邊之八綫【三邊各有正亦各有切綫】而所成句股形遂分兩種可互觀也

乙角所成諸句股皆以戊丁夘爲例

內角所成諸句股皆以亥辰夘爲例

並如後圖

如圖丙角第一層句股兌乙心形卽乙角之壬丙辛也在乙角兩正交於丙在丙角兩正交於乙皆與股之比例而同不同股【乙角丙角並以乙丙黃道正爲而乙角所用之股爲丙甲正丙角所用則乙甲正皆正也而同股別】

丙角第二層句股女甲亢形卽乙角之子甲丑也乙角丙角並以一正一切綫交於甲爲句與股之比例而所用相反【乙角於乙甲用正於丙甲用切綫丙角則於乙甲用切綫於丙甲用正皆乙甲丙甲兩弧之正切綫而所用迥別】

丙角第三層句股艮丙氐形卽乙角之酉乙未也在乙角以兩切綫聨於乙在丙角以兩切綫交於丙皆與句之比例而同不同句【乙丙兩角並以乙丙切綫爲而乙角以乙甲切綫爲句丙角以丙甲切綫爲句皆切綫也而同句別】

球面弧三角形弧角同比例解

第一題

正弧三角形以一角對一邊則各角正與對邊之正皆爲同理之比例

如圖乙甲丙弧三角形【甲爲正角】法爲半徑與乙角之正若乙丙之正與丙甲之正更之則乙角之正角與對邊丙甲之正若半徑與乙丙之正也又丙角之正與其對邊乙甲之正亦若半徑與乙丙之正也合之則乙角之正與其對邊丙甲之正亦若丙角之正與其對邊乙甲之正

論曰乙丙兩角與其對邊之正旣並以半徑與乙丙爲比例則其比例亦自相等而兩角與兩對邊其正皆爲同比例

又論曰甲爲正角其度九十而乙丙者甲正角所對之邊也半徑者卽九十度之正也以半徑比乙丙之正卽是以甲角之正比對邊之正故以三角對三邊皆爲同比例

第二題

凡四率比例二宗內有二率三率之數相同則兩理之首末二率爲互視之同比例【卽斜弧比例之所以然故先論之】

假如有甲乙丙丁四率甲【四】與乙【八】若丙【六】與丁【十二】皆加倍之比例也

又有戊乙丙辛四率戊【二】與乙【八】若丙【六】與辛【二十四】皆四倍之比例也

此兩比例原不同理特以兩理之第二第三同爲乙【八】丙【六】故兩理之第一第四能互用爲同理之比例【先理之第一甲四與次理之第四辛二十四若次理之第一戊二與先理之四丁十二皆六倍之比例也】

論曰凡二率三率相乘爲實首率爲法得四率今兩理所用之實皆乙【八】丙【六】相乘【四十八】之實惟甲【四】爲法則得十二若戊【二】爲法則得二十四矣法大者得數小法小者得數大而所用之實本同故互用之卽爲同理之比例也

試以先理之四率更爲首率其理亦同【丁與辛若戊與甲皆加倍比例】若反之令兩四率並爲首率亦同【甲與戊若辛與丁皆折半比例】並如後圖

第三題

斜弧三角形以各角對各邊其正皆爲同比例

乙丙丁斜弧三角形任從乙角作乙甲垂弧至對邊分元形爲兩正角形甲爲正角

依前正角形論各對邊之正與所對角之正比例皆等

乙甲丁形丁角正與乙角正若半徑【卽甲角正】與丁乙正是一理也

乙甲丙形丙角正與乙甲正若半徑與乙丙正是又一理也

兩理之第二同爲乙甲第三同爲半徑則兩理之首末二率爲互視之同比例故丁角之正與乙丙之正若丙角之正與丁乙之正也

又如法從丁角作丁戊垂弧至對邊分兩形而戊爲正角則乙角正與丁丙正亦若丙角正與乙丁正又從丙作垂弧分兩形而壬爲正角則乙角與丁丙亦若丁角與乙丙

一丁角正

丙角正

乙丙丁斜弧三角形丁爲鈍角法從乙角作乙甲垂弧於形外亦引丙丁弧防於甲成乙甲丁虛形亦湊成乙甲丙虛實合形甲爲正角

乙甲丁形丁角之正與乙甲邊若半徑與乙丁邊正一理也乙甲丙形丙角之正與乙甲邊若半徑與乙丙正又一理也準前論兩理之第二第三旣同則丁角正與乙丙正若丙角正與乙丁正也

論曰丁角在虛形是本形之外角也何以用爲內角曰凡鈍角之正與外角之正同數故用外角如本形角也

若用乙角與丁丙邊則作丙庚弧於形外取庚正角其理同上或作丁戊垂弧於形內取戊正角分兩形則如前法並同

用法

凡弧三角形【不論正角斜角】但有一角及其對角之一弧則其餘有一角者可以知對角之弧而有一弧者亦可以知對弧之角皆以其正用三率比例求之

假如乙丁丙三角形先有丁角及相對之乙丙弧則其餘但有丙角可以知乙丁弧有乙角可以知丁丙弧此爲角求弧也若有乙丁弧亦可求丙角有丁丙弧亦可求乙角此爲弧求角也

一丁角正

一乙丙正

二乙丙正

二丁角正

三丙角正乙角正三

乙丁正丁丙正四乙丁正丁丙正四

丙角正乙角正

歷算全書卷七﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

欽定四庫全書

歷算全書卷八

宣城梅文鼎撰

弧三角舉要卷三

斜弧三角形作垂弧說

正弧形有正角如平三角之有句股形也斜弧形無正角如平三角之有銳鈍形也平三角銳鈍二形並以虛綫成句股故斜弧形亦以垂弧成正角也正弧形以正等綫立算句股法也斜弧形仍以正角立算亦句股法也

斜弧三角用垂弧法

垂弧之法有三其一作垂弧於形內則分本形爲兩正角形其二作垂弧於形外則補成正角形其三作垂弧於次形

總法曰三角俱銳垂弧在形內一鈍二鋭或在形內或在形外【自鈍角作垂弧則在形內自銳角作垂弧則在形外】兩鈍一銳或三角俱鈍則用次形其所作垂弧在次形之內之外【次形無鈍角垂弧在其內有鈍角垂弧在其外若破鈍角亦可在內】

第一法垂弧在形內成兩正角【內分五支】

設甲乙丙形有丙鋭角有角旁相連之乙丙甲丙二邊求對邊及余兩角

法於乙角【在先有乙丙邊之端乃不知之角】作垂弧【如乙丁】至甲丙邊分甲丙邊爲兩卽分本形爲兩而皆正角【凡垂弧之所到必正角也角不正卽非垂弧故所分兩角皆正後仿此】一乙丁丙形此形有丁正角丙角乙丙邊爲兩角一邊可求丁丙邊【乃丙甲之分】乙丁邊【卽垂弧】及丁乙丙角【卽乙分角】次乙丁甲形有丁正角甲丁邊【甲丙內減丁丙其餘丁甲】乙丁邊爲一角兩邊可求乙甲邊甲角及丁乙甲分角末以兩乙角並之成乙角

或如上圖丁甲角端作垂弧至乙丙邊分乙丙爲兩亦同

右一角二邊而先有者皆角旁之邊爲形內垂弧之第一支【此所得分形丁丙邊必小於元設邊卽垂弧在形內而甲爲鋭角】

設甲乙丙形有丙銳角有角旁相連之丙乙邊及與角相對之乙甲邊求余兩角一邊

法於不知之乙角【在先有二邊之中】作乙丁垂弧分兩正角形一乙丙丁形此形有丁正角有丙角有乙邊邊可求乙丁分綫及所分丁丙邊及丁乙丙分角次乙甲丁形此形有丁正角有乙丁邊有乙甲邊可求甲角及丁乙甲分角丁甲邊末以兩分角【丁乙丙及丁乙甲】並之成乙角以兩分邊【丁丙及丁甲】並之成甲丙邊

右一角二邊而先有對角之邊爲形內垂弧之第二支

設甲乙丙形有乙丙二角有乙丙邊【在兩角之間】求甲角及余邊

法於乙角作垂弧分兩形並如前【但欲用乙丙邊故破乙角存丙角】一乙丙丁形有丁正角丙角乙丙邊可求乙丁邊丁丙邊丁乙丙分角次乙丁甲形有乙丁邊丁正角丁乙甲分角【原設乙角內減丁乙丙得丁乙甲】可求乙甲邊甲角及甲丁邊末以甲丁並丁丙得甲丙邊

或於丙角作垂弧亦同

若角一鈍一鋭卽破鈍角作垂綫其法並同

右二角一邊而邊在兩角之間不與角對爲形內垂弧之第三支【此必未知之角爲銳角則垂弧在形內】

設甲乙丙形有丙甲二角有乙甲邊【與丙角相對與甲角相連】求乙角及餘二邊

法於乙角【爲未知之角】作垂弧分爲兩形而皆正角一乙丁甲形有丁正角甲角乙甲邊可求甲丁邊乙丁邊丁乙甲分角次丁乙丙形有丁正角乙丁邊丙角可求乙丙邊丁丙邊丁乙丙分角末以甲丁丁丙並之成甲丙邊以兩分角【丁乙甲丁乙丙】並之成乙角

右二角一邊而先有對角之邊爲形內垂弧之第四支【此先有二角必俱銳則垂弧在內】

設乙甲丙形有三邊而內有【乙甲乙丙】二邊相同求三角

法從乙角【在相同二邊之間】作垂弧至丙甲邊【乃不同之一邊】分兩正角形【其形必相等而甲丙綫必兩平分】乙丙丁形有丁正角乙丙邊丁丙邊【卽甲丙之半】可求丙角乙分角【乃乙角之半】倍之成乙角而甲角卽同丙角【不須再求】

右三邊求角而內有相同之邊故可平分是爲形內垂弧之第五支【此必乙丙乙甲二邊並小在九十度內若九十度外甲丙二角必俱鈍當用次形詳第三又法】

第二法垂弧在形外補成正角【內分七支】

設甲乙丙形有丙銳角有夾角之兩邊【乙丙甲丙】求乙甲邊及余兩角

法自乙角【在先有邊之一端】作垂弧【乙丁】於形外引丙甲邊至丁補成正角形二【一丙乙丁半虛半實形二甲乙丁虛形】先算丙乙丁形此形有乙丙邊丙角有丁正角可求丙乙丁角【半虛半實】乙丁邊【形外垂弧】丁丙邊【丙甲引長邊】次甲乙丁虛形有丁正角有乙丁邊甲丁邊【丁丙內減內甲得甲丁】可求乙甲邊甲角及甲乙丁虛角末以甲角減半周得原設甲角以甲乙丁虛角減丙乙丁角得原設丙乙甲角右一角二邊角在二邊之中而爲銳角是爲形外垂弧之第一支【此所得丁丙必大於原設邊卽垂弧在形外而甲爲鈍角】

設乙甲丙形有甲鈍角有角旁之【丙甲乙甲】二邊求乙丙邊及餘二角

法於乙角作垂弧【乙丁】引丙甲至丁補成正角先算乙丁甲虛形此形有丁正角甲角【卽原設甲角減半周之餘亦曰外角】有乙甲邊可求甲丁邊乙丁邊丁乙甲虛角次丁乙丙形有乙丁邊丁丙邊【甲丙加丁甲得之】丁正角可求乙丙邊丙角丙乙丁角末於丙乙丁內減丁乙甲虛角得原設乙角

或從丙作垂弧至戊引乙甲邊至戊補成正角亦同

右一角二邊角在二邊之中而爲鈍角乃形外垂弧之第二支

設乙甲丙形有丙銳角有角旁之乙丙邊有對角之乙甲邊求丙甲邊及餘二角

法從乙角作垂弧至丁成正角【亦引丙甲至丁】先算丙乙丁形有丁正角丙角乙丙邊可求諸數【乙丁邊丁丙邊丙乙丁角】次丁乙甲虛形有丁正角乙丁乙甲二邊可求諸數【乙甲丁角甲乙丁角甲丁邊】末以所得虛形甲角減半周得原設甲鈍角於丙乙丁內減虛乙角得原設乙角於丁丙內減甲丁得原設丙甲

右一角二邊角有所對之邊而爲銳角乃形外垂弧之第三支【此必甲爲鈍角故垂弧在外】

設乙甲丙形有甲鈍角有角旁之甲丙邊及對角之乙丙邊求乙甲邊及餘二角

法於丙角作垂弧至戊補成正角先算虛形【甲丙戊】有戊正角甲角【甲鈍角減半周之餘】甲丙邊可求諸數【丙戊邊甲戊邊丙虛角】次虛實合形【乙丙戊】有戊正角丙戊邊乙丙邊可求原

設乙角及諸數【乙丙戊角乙戊邊】末以先得虛形數減之得原設數【丙角內減丙虛角得原設丙角乙戊內減甲戊虛引邊得原設乙甲邊】

右一角二邊角有所對之邊而爲鈍角乃形外垂弧之第四支【此先得鈍角垂綫必在外】

設乙甲丙形有丙甲二角【一銳一鈍】有丙甲邊在兩角之中

法於丙銳角作垂弧至丁【在甲鈍角外】補成正角丁丙甲虛形有丁正角甲外角丙甲邊可求諸數【丙丁邊甲丁邊丙虛角】次乙丙丁形【半虛實】有丁正角丙丁邊丙角【以丙虛角補原設丙】

【角得丁丙乙角】可求原設乙丙邊乙角及乙甲邊【求得乙丁邊內減虛形之甲丁邊得原設甲乙邊】

右二角一邊邊在兩角間爲形外垂弧之第五支【此亦可於甲鈍角作垂弧則在形內法在第一法之第三支】

設乙甲丙形有乙甲二角【乙銳甲鈍】有丙甲邊與乙銳角相對【鈍角相連】

法於丙銳角作垂弧至戊【在丙甲邊外】補成正角甲戊丙虛形有戊正角有丙甲邊甲角【原設形之外角】可求諸數【丙戊甲戊二邊丙虛角】次乙丙戊形有戊正角乙角丙戊邊可求丙角【求得乙丙戊角內減丙虛角得元設丙角】乙丙邊乙甲邊【求到乙戊邊內減甲戊得乙甲】右二角一邊而邊對鋭角爲形外垂弧之第六支

設乙甲丙形有乙銳角甲鈍角有丙乙邊與甲鈍角相對【銳角相連】

法於丙銳角作垂弧至戊【在甲鈍角外】補成正角乙丙戊形有戊正角乙角乙丙邊可求諸數【丙戊乙戊二邊乙丙戊角】次甲丙戊虛形有戊正角甲外角丙戊邊可求原設丙甲邊甲乙邊【求到戊甲虛邊以減乙戊得原設乙甲】丙角【求到丙虛角以減乙丙戊角得原設丙角】

右兩角一邊而邊對鈍角爲形外垂弧之第七支

第三垂弧又法用次形【內分九支】

設乙甲丙形有乙丙二角有乙丙邊在兩角間而兩角並鈍求餘二邊及甲角

法引丙甲至己引乙甲至戊各滿半周作戊己邊與乙丙等而己與戊並乙丙之外角成甲戊己次形依法作垂弧於次形之內【如己丁】分爲兩形【一己丁戊一己丁甲】可求乙甲邊【以己丁戊分形求到丁戊以己丁甲形求到甲丁合之成甲戊以減半周卽得乙甲】丙甲邊【以己丁甲分形求到己甲以減半周卽得丙甲】甲角【以己丁甲分形求到甲交角】

右二角一邊邊在角間而用次形爲垂弧又法之第一支

論曰舊說弧三角形以大邊爲底底旁兩角同類垂弧在形內異類垂弧在形外由今考之殆不盡然蓋形內垂弧分底弧爲兩成兩正角形所用者銳角也【底旁原有兩銳角分兩正角形則各有兩銳角】形外垂弧補成正角形所用者亦銳角也【底旁原有一銳角補成正角形則虛實兩形各有兩銳角】故惟三銳角形作垂弧於形內一鈍兩銳則垂弧或在形內或在形外若兩鈍一鋭則形內形外俱不可以作垂弧【垂弧𨿽有內外而其用算時並爲一正角兩銳角之比例若形有兩鈍角則𨿽作垂弧只能成一正一鈍一銳之形無比例可求則垂弧爲徒設矣】故必以次形通之而所作垂弧卽在次形不得謂之形內然則同類之說止可施於兩銳【若兩鈍𨿽亦同類而不可於形內作垂弧】異類之說止可施於一鈍兩銳【若兩鈍一銳而底弧之旁一鈍一銳𨿽亦異類然不可於形外作垂弧】非通法矣【兩鈍角不用次形垂弧之法己窮況三鈍角乎】

又論曰以垂弧之法徵之則大邊爲底之說理亦未盡蓋鈍角所對邊必大旣有形外立垂綫垂弧之法則鈍角有時在下而所對之邊在上矣不知何術能常令大邊爲防乎此尢易見

設乙甲丙形有丙甲二角有乙甲邊與丙角相對而兩角俱鈍求乙角及余邊

如法引甲乙丙乙俱滿半周防於己成丙甲己次形作己丁垂弧於次形內分次形爲兩可求乙角【依法求到分形兩己角合之爲次形己角與乙對角等】甲丙邊【求到分形甲丁及丁丙並之卽甲丙】乙丙邊【求到次形己丙以減半周得之】

右二角一邊邊與角對而用次形爲垂弧又法之第二支此三角俱鈍也或乙爲鋭角亦同

設乙甲丙形有乙丙乙甲兩邊有乙角在兩邊之中

法用甲乙戊次形【有乙甲邊有乙戊邊爲乙丙減半周之餘有乙外角】作甲丁垂弧分爲兩形可求丙甲邊及余兩角【以乙甲丁分形求到丁乙及甲分角人以甲戊丁形求到甲戊以減半周爲丙甲又得甲分角並先所得成甲角卽甲外角又得戊角卽丙對角】右二邊一角角在二邊之中而用次形爲垂弧又法之第三支

或丙爲鈍角則於次形戊角作垂弧法同上條

設乙甲丙形有丙角有甲丙邊與角連有乙甲邊與角對

法用甲己戊次形【甲己爲甲乙減半周之餘甲戊爲甲丙減半周之餘戊角爲丙之外角】作垂弧【甲丁】於內分爲兩形可求丙乙邊及余兩角【以甲丁戊分形求丁戊及甲分角又以甲丁己形求得丁己以並丁戊成己戊卽丙乙也又得分角以並先得分角卽甲交角也又得己角卽乙外角也】

右二邊一角角與邊對而用次形爲垂弧又法之第四支若甲爲鈍角亦同

論曰先得丙鈍角宜作垂弧於外而乙亦鈍角不可作垂弧故用次形

設乙甲丙形有三邊內有【乙甲丙甲】二邊相同而皆爲過弧求三角

法引相同之二邊各滿半周作弧綫聨之成戊甲己次形如法作甲丁垂弧分次形爲兩【其形相等】可求相同之二角【任以甲丁戊分形求到戊角以減半周得乙角亦卽丙角】及甲角【求到甲半角倍之成甲角】右三邊求角內有相同兩大邊爲垂弧又法之第五支若甲爲鋭角亦同

以上垂弧並作於次形之內

設乙甲丙形有丙甲二鈍角有甲丙邊在兩角間

法引乙丙乙甲滿半周防於戊成甲戊丙次形自甲作垂弧與丙戊引長弧防於丁補成正角可求乙甲邊乙丙邊乙角【先求丙甲丁形諸數次求甲戊丁得甲戊以減半周爲甲乙又以丁戊減先得丁丙得丙戊以減半周爲乙丙又求得戊虛角減半周爲戊角卽乙對角】

右兩鈍角一邊邊在角間而於次形外作垂弧爲又法之第六支

或自丙角作垂弧亦同

設乙甲丙形有乙甲二鈍角有甲丙邊與角對

法引設邊成丙戊甲次形【有甲外角有戊鈍角爲乙對角有丙甲邊】如上法作丙丁垂弧引次形邊防於丁可求乙丙邊【先求甲丁丙形諸數次丙丁戊虛形求到丙戊以減半周爲乙丙】乙甲邊【先求到丁甲以虛綫丁戊減之得戊甲卽得乙甲】丙角【先求到甲丙丁角內減丙虛角得丙外角卽得元設丙角】

右二角一邊邊與角對垂弧在次形外爲又法之第七支

設乙甲丙形有丙鈍角有角旁之兩邊【丙乙丙甲】

法用甲戊丙次形作甲丁垂弧引丙戊防於丁可求乙甲邊及甲乙二角【先以甲丁丙形求到諸數再以甲丁戊虛形求甲戊卽得乙甲又甲虛角減先得甲角成甲外角又戊虛角卽乙外角】

右二邊一角角在二邊之中垂弧在次形外爲又法之第八支

設乙甲丙形有甲鈍角有一邊與角對【乙丙】一邊與角連【丙甲】

法用丙戊甲次形自丙作垂弧與甲戊引長邊防於丁可求乙甲邊及余兩角【依法求到甲戊卽得乙甲求戊角卽乙角以丙虛角減先得丙角卽丙外角】

右二邊一角角有對邊垂弧在次形外爲又法之第九支

以上垂弧並作於次形之外

論曰三角俱鈍則任以一邊爲底其兩端之角皆同類矣今以次形之法求之而垂弧尙有在次形之外者益可與前論相發也

弧三角舉要卷四

弧三角用次形法

次形之用有二

正弧三角斜弧三角並有次形法而其用各有二其一易大形爲小形則大邊成小邊鈍角成銳角其一易角爲弧易弧爲角則三角可以求邊亦二邊可求一邊

第一正弧三角形易大爲小用次形

如圖戊己甲乙半渾圜以【戊丙甲己丙乙】兩半周綫分爲弧三角形四【一戊丙乙二己丙戊三己丙甲並大四乙丙甲爲最小】今可盡易爲小形一戊丙乙形易爲乙甲丙形【戊丙減半周餘丙甲又戊乙減半周餘乙甲而乙丙爲同用之弧則三邊之正同也乙丙甲角爲戊丙乙外角甲乙丙爲戊乙丙外角戊角又同甲角則三角之正同也故算甲丙乙卽得戊丙乙】

二己丙戊形易爲乙甲丙形【乙甲己及甲己戊並半周內各減己甲則乙甲同己戊而乙丙於己丙及甲丙於戊丙皆半周之餘又甲戊並正角丙爲交角而乙角又爲己角之外角故算乙丙甲得己丙戊】

三己丙甲形易爲乙丙甲形【乙甲爲己甲減半周之餘乙丙爲丙己減半周之餘而同用甲丙又次形丙角爲元形之外角乙角同己角甲同爲正角故算乙丙甲得己丙甲】

用法

凡正弧三角內有大邊及鈍角者皆以次形立算但於得數後以次形之邊與角減半周卽得元形之大邊及鈍角【其元形內原有小邊及銳角與次形同者徑用得數命之不必復減半周】斜弧同以上易大形爲小形而大邊成小邊鈍角成鋭角爲正弧三角次形之第一用【大邊易小鈍角易鋭則用算畫一算理易明其算例並詳第二用】

第二正弧三角形弧角相易用次形【內分四支】

一乙甲丙形易爲丁丙庚次形

解曰丁如北極戊己壬甲如赤道圈己庚乙如黃道半周辛丁壬如極至交圈【壬如夏至辛如冬至】戊丁甲如所設過極經圈乙如春分己如秋分並以庚壬大距爲其度丙如所設某星黃道度丙乙如黃道距春分度其餘丙庚卽黃道距夏至爲次形之一邊丙甲如黃赤距度其餘丙丁卽丙在黃道距北極度爲次形又一邊庚丁如夏至黃道距北極而爲乙角余度是角易爲邊也【壬庚爲乙角度其餘庚丁】是爲次形之三邊

又丙交角如黃道上交角庚正角如黃道夏至甲乙如赤道同升度其餘壬甲如赤道距夏至卽丁角之弧是邊易爲角也則次形又有三角

用法

假如有丙交角乙春分角而求諸數是三角求邊也【乙丙兩角幷甲正角而三】法爲丙角之正與乙角之餘若半徑與丙甲之餘得丙甲邊可求余邊

一丙角正

丙角正

二乙角余

丙角正

三半徑【甲角

在次形】半徑【庚角】

四甲丙余

丁丙正

右以三角求邊也若三邊求角反此用之

若先有乙丙邊乙甲邊而求甲丙邊則爲乙甲余【卽次形丁角正】與乙丙余【卽庚丙正】若半徑【甲角卽次形庚角】與甲丙余【卽丁丙正】

或先有乙丙邊甲丙邊而求乙甲邊則爲甲丙余【卽丁丙正】與乙丙余【卽庚丙正】若半徑【甲角卽庚角】與乙甲余【卽丁角正】

或先有乙甲邊甲丙邊而求乙丙邊則爲半徑【甲角卽庚角】與甲丙余【卽丁丙正】若乙甲余【卽丁角正】與乙丙余【卽庚丙正】

右皆以兩弧求一弧而不用角也

以上爲乙甲丙形用次形之法本形三邊皆小一正角偕兩銳角次形亦然所以必用次形者爲三角求邊之用也是爲正弧三角次形第二用之第一支

二己丙甲形【甲正角餘二角丙鈍己銳丙甲邊小餘二邊並大】易爲丁丙庚次形

法曰截己甲於壬截己丙於庚使己壬己庚皆滿九十度作壬庚丁象限弧又引丙甲邊至丁亦滿象限而成丁丙庚次形此形有丁丙邊爲丙甲之餘有庚丙邊爲己丙之餘【凡過弧內去象限其餘度正卽過弧之餘故己丙內減己庚而庚丙爲其餘弧】有庚丁邊爲己角之餘乃角易爲邊也【庚與壬皆象限卽庚壬爲己角之度而丁庚爲其餘】又有丙銳角爲元形丙鈍角之外角有庚正角與元形甲角等【壬庚旣爲己角之弧則壬與庚必皆正角】有丁角爲己甲邊之餘【己甲過弧以壬甲爲余度說見上文】乃邊易爲角也

用法

假如有甲正角己銳角丙鈍角而求丙甲邊法爲丙鈍角之正【卽次形丙銳角正蓋外角內角正同用也】與己角之餘【卽次形丁庚邊之正】若半徑【卽次形庚正角之正】與丙甲邊之餘【卽次形丁丙邊】

旣得丙甲可求己丙邊法爲半徑與丙角余若甲丙余切【次形爲丁丙正切】與己丙余切【次形爲庚丙正切】得數以減半周爲己丙下同【凡以八綫取弧角度者若系大邊鈍角皆以得數與半周相減命度後仿此】求己甲邊法爲己角之餘【卽庚丁正】與丙角之正若己丙之餘【卽庚丙正】與己甲之餘【卽丁角正其弧壬甲】

右三角求邊

又如有己甲己丙兩大邊求丙甲邊法爲己甲余【卽丁角正】與己丙余【卽庚丙正】若半徑與丙甲余【卽丁丙正】

或有己甲丙甲兩邊求己丙大邊法爲半徑與丙甲余【卽丁丙正】若己甲余【卽丁角正】與己丙余【卽庚丙正得數減半周爲己丙下同】

或有丙甲己二邊求己甲大邊法爲丙甲余與半徑若己丙余與己甲余【卽上法之反理】

右二邊求一邊

以上己丙甲形用次形之法本形有兩大邊一鈍角次形則邊小角銳而且以本形之邊易爲次形之角本形之角易爲次形之邊【後二形並同】是爲正弧三角次形第二用之第二支

三己丙戊形【戊正角己鈍角丙銳角己丙與戊丙並大邊】易爲丁丙庚次形

法曰以象限截己丙於庚其餘庚丙截戊丙於丁其餘丁丙爲次形之二邊作丁庚弧其度爲己角之餘【己鈍角與外銳角同以壬庚之度取正其餘丁庚爲己外角之餘亦卽爲己鈍角之餘】角易邊也次形又爲元形之截形同用丙角又庚正角與戊角等而丁角卽己戊邊之餘度【試引己戊至辛成像限則戊辛等壬甲皆丁角之度而又爲己戊之餘】邊易角也

用法

假如有丙銳角己鈍角偕戊正角求戊丙邊法爲丙角正與己角余【卽庚丁正】若半徑與戊丙余【卽丁丙正】得數減半周爲戊丙【下同】

旣得戊丙可求己丙法爲半徑與丙角余若戊丙余切【卽丁丙正切】與己丙余切【卽庚丙正切】

求己戊邊法爲戊丙余【卽丁丙正】與半徑若己丙余【卽庚丙正】與己戊余【卽丁角正】

以上己丙戊形三角求邊爲正弧三角次形第二用之第三支

四乙丙戊形【戊正角乙丙並鈍角戊乙戊丙並大邊乙丙小邊】易爲丁丙庚次形

法曰引乙丙邊至庚滿象限得次形丙庚邊【卽乙丙之餘】於丙戊截戊丁象限得次形丁丙邊【爲戊丙之餘】而丁卽爲戊乙弧之極【戊正角至丁九十度故知之】從丁作弧至庚成次形庚丁邊爲乙角之餘是角易爲邊也【試引庚丁至辛則辛丁亦象限而辛爲正角庚亦正角乙庚乙辛皆象限弧是庚丁辛卽乙鈍角之弧度內截丁辛象限而丁庚爲乙鈍角之餘度矣】又庚正角與戊等丙爲外角丁角爲乙戊邊之餘是邊易爲角也【乙戊丙截乙辛象限其餘戊辛卽丁交角之弧】

用法

假如三角求邊以丙角正爲一率乙角余爲二率半徑爲三率求得戊丙余爲四率以得數減半周爲戊丙余並同前

以上乙丙戊形三角求邊爲正弧三角次形第二用之第四支

論曰曆書用次形止有乙甲丙形一例若正角形有鈍角及大邊者未之及也故特詳其法

又論曰依第一用法大邊可易爲小鈍角可易爲銳則第二三四支皆可用第一支之法而次形如又次形矣【己丙甲形己丙戊形乙丙戊形皆易爲乙甲丙形而乙甲丙又易爲丁丙庚是又次形也】

正弧形弧角相易又法用又次形

甲乙丙正弧三角形易爲丁丙庚次形再易爲丁戊壬形

法曰依前法引乙丙邊甲乙邊各滿象限至庚至己作庚己弧引長之至丁亦引甲丙防於丁亦各滿象限成丁丙庚次形

又引丙庚至辛引丙丁至戊亦滿象限作辛戊弧引之至壬亦引庚丁防於壬則辛壬庚壬亦皆象限成丁戊壬又次形此形與甲乙丙形相當

論曰乙丙邊易爲壬角【乙庚及丙辛皆象限內減同用之丙庚則辛庚卽乙丙而辛庚卽壬角之弧】乙甲邊易爲丁角【乙甲之餘度己甲卽丁交角之弧】是次形之兩角卽元形之兩邊也乙角易爲丁壬邊【丁己及庚壬俱象限內減同用之庚丁則丁壬卽己庚而爲元形乙角之弧】丙角易爲戊壬邊【丙交之弧弧辛戊其餘爲次形戊壬】是次形之兩邊卽元形之兩角而次形戊丁邊卽元形丙甲次形戊角卽元形甲角

用法

若原形有三角則次形有戊直角有戊壬丁壬二邊可求乙甲邊法爲乙角之正【卽丁壬正】與半徑若丙角之餘【卽戊壬正】與乙甲之餘【卽丁角正】

求乙丙邊法爲乙角之切綫【卽丁壬切綫】與丙角之餘切【卽戊壬正切】若半徑與丙乙之餘【卽壬角余】旣得兩邊可求余邊

以上又次形三角求邊爲正弧三角第二用之又法

論曰用次形止一弧一角相易今用又次形則兩弧並易爲角兩角並易爲弧故於前四支並峙而爲又一法也

第三斜弧三角易大爲小用次形【內分二支】

一甲乙丙二等邊形三角皆鈍

如法先引乙丙邊成全圖又引甲丙甲乙兩邊出圜周外防於丁又引兩邊各至圜周【如戊如己】成乙丁丙及戊甲己兩小形皆相似而等卽各與元形相當而大形易爲小形

論曰次形【甲戊甲己】二邊爲元形邊減半周之餘則同一正次形【己戊】二角爲元形之外角亦同一正【甲乙戊爲甲乙丙外角而與次形己角等甲丙己爲甲丙乙外角亦與次形戊角等】而次形甲角原與元形爲交角戊己邊又等乙丙邊【戊乙丙及己戊乙並半周各減乙戊則戊己等乙丙】故算小形與大形同法惟於得數後以減半周卽得大邊及鈍角之度【置半周減戊甲得甲丙減己甲亦得甲乙又置半周減己銳角得元形乙鈍角減戊鋭角亦得元形丙鈍角其交角甲及相等之戊己邊只得數便是並不用減】

論曰凡兩大圈相交皆半周故丁丙與丁乙亦元形減半周之餘又同用乙丙而乙與丙皆外角丁爲對角故乙丙丁形與戊甲己次形等邊等角而並與元形甲乙丙相當

右二邊等形易大爲小爲斜弧次形第一用之第一支

二甲乙丙三邊不等形角一鈍二銳

如法引乙丙作圜又引餘二邊【甲乙甲丙】至圜周【己戊】得相當次形己甲戊【算戊甲得甲丙算己甲得甲乙算己戊得乙丙】其角亦一鈍二銳【算戊鈍角得丙銳角算己鋭角得乙鈍角而甲交角一算得之】

又戊甲乙形角一鈍二鋭如法引戊乙作圜又引乙甲至圜周【己】成次形己甲戊與元形相當【算己甲得甲乙算己戊得戊乙又同用戊甲邊故相當算甲銳角得甲鈍角算戊鈍角得戊鋭角算己角卽乙角】

又甲己丙形三角俱鈍如上法引丙己作圜又引丙甲至戊成次形己甲戊與元形相當【元形甲丙與戊甲元形己丙與己戊並減半周之餘又同用己甲又丙鈍角卽戊鈍角甲己兩銳角並元形之外角】

右三邊不等形易大爲小爲斜弧次形第一用之第二支

第四斜弧三角形弧角互易用次形【內分三支】

一乙甲丙形【三角俱鈍】易爲丑癸寅形【一鈍二銳】

法曰引乙甲作圜次引乙丙至酉引甲丙至未並半周次以甲爲心作丁辛癸寅弧乙爲心作戊醜癸壬弧丙爲心作丑子午寅弧三弧交處別成一丑癸寅形與元形相當而元形之角盡易爲邊邊盡易爲角

論曰甲角之弧丁辛與次形癸寅等則甲角易爲癸寅邊【丁癸及辛寅皆象限減同用之辛癸則癸寅同丁辛】乙角之弧己壬與次形醜癸等則乙角易爲丑癸邊【癸己及丑壬皆象限減同用之癸壬卽丑癸同壬己】丙外角之弧午申【引丑午寅至申取亥申與庚子等成午申】與次形寅丑等則丙外角易爲寅丑弧【丑午及寅申皆象限各加同用之午寅卽午申等丑寅】是元形有三角卽次形有三邊也又甲乙邊之度易爲癸外角【乙己及甲辰皆象限內減同用之甲己則乙甲同己辰爲癸外角弧】甲丙邊易爲寅角【甲辛及丙子皆象限內減同用之丙辛則甲丙等辛子而同爲寅角之弧】乙丙邊易爲醜角【乙壬及午丙皆象限內減同用之丙壬則乙丙等午壬而同爲醜角之弧】是元形有三邊卽次形有三角也

又論曰有此法則三角可以求邊【旣以三角易爲次形之三邊再用三邊求角法求得次形三角卽反爲元形之三邊三邊求角法詳別捲】

又論曰引丙甲出圜外至申亦引庚亥弧出圜外防於申則庚亥與子申並半周內各減子亥卽子庚同亥申而子寅旣象弧則寅申亦象弧矣以寅申象弧加午寅與以丑午象限【午壬爲醜角之弧故丑午亦象限】加午寅必等而申午者丙外角之度丑寅者次形之邊也故丙角能爲次形之邊也

又論曰凡引弧綫出圜外者其弧綫不離渾圜面冪因平視故爲周綫所掩稍轉其渾形卽見之矣但所引出之綫原爲半周之餘見此余綫時卽當別用一圈爲外周而先見者反有所掩如見亥申卽不能見子庚故其度分恆必相當亦自然之理也

又論曰依第三用法之第二支丙未酉形及丙未乙形丙酉甲形並可易爲甲乙丙則又皆以癸丑寅爲又次形矣

右三角俱銳形弧角相易爲斜弧次形第二用之第一支

二未丙酉形【三角俱鈍】易爲丑癸寅形【一鈍二銳】

法曰引酉未弧作圜又引兩邊至圜周【如乙如甲】乃以未爲心作丁辛癸寅辰弧以酉爲心作戊醜癸壬己弧以丙爲心作庚子丑寅午申弧亦引丙甲出圜外防於申三弧相交成丑癸寅形此形與元形相當而角盡易爲弧弧盡易爲角

論曰未外角之弧丁辛成次形癸寅弧【癸丁及寅辛皆象限內減同用之癸辛則癸寅卽丁辛】酉外角之弧壬己成次形丑癸弧【壬丑及癸己皆象限各減癸壬則丑癸卽壬己】丙外角之弧申午成次形寅丑弧【準前論庚亥及子申並半周則申亥等子庚而申寅爲象限與午丑象限各減午寅卽寅丑同申午】是三角盡易爲邊也酉未邊成癸外角【酉戊及未丁皆象限各減未戊則丁戊卽酉未而爲癸外角之弧若以丁戊減戊乙己半周其餘丁乙己過弧亦卽爲癸交角之弧】未丙邊減半周其餘甲丙成寅角【甲辛及子丙皆象限各減辛丙則辛子卽甲丙而爲寅角之弧】酉丙邊減半周其餘乙丙成醜角【午丙及壬乙皆象限各減丙壬則壬午卽乙丙而爲醜角之弧】是三邊盡易爲角也【寅角醜角並原邊減半周則原邊卽兩外角弧與酉未成癸外角等】故三角減半周得次形三邊算得次形三角減半周得原設三邊

右三角俱鈍形弧角相易爲斜弧次形第二用之第二支

論曰若所設爲乙未丙形則未角易爲次形癸寅邊【徑用丁辛子形內以當癸寅不須言外角】乙外角爲丑癸邊【亦以己壬當丑癸與用酉外角同理】丙角爲丑寅邊【徑以丙交角之弧甲午當丑寅不言外角】若所設爲甲酉丙形則酉角易爲丑癸邊【己壬徑當丑癸不言外角】甲外角爲寅癸邊【用丁辛當癸寅卽甲外角】丙角爲丑寅邊【亦申午當丑寅不言外角】

又論曰此皆大邊徑易次形不必復言又次

三甲乙丙形【一鈍角兩銳角】易爲丑癸寅形

如法引甲乙邊作全圜引餘二邊各滿半周又以甲爲心作丁壬癸丑辰半周以乙爲心作戊庚辛癸寅亥弧以丙爲心作己午子丑寅夘弧三弧綫相交成丑癸寅次形與元形相當而角爲弧弧爲角

論曰易甲角爲次形醜癸邊【於癸丁象限減壬癸成丁壬爲甲角之弧於醜壬象限亦減壬癸卽成癸丑邊其數相等】乙外角爲次形癸寅邊【於癸戊象限減癸辛成辛戊爲乙外角之弧於寅辛象限亦減癸辛卽成癸寅邊其數相等】丙角爲次形丑寅邊【於丑午象限減丑子成午子爲丙角之弧於寅子象限亦減丑子卽成丑寅邊其數相等】則角盡爲邊又甲乙邊爲癸角【於甲丁象限乙戊象限各減乙丁則戊丁等甲乙而癸角角之弧】乙丙邊成寅角【於乙辛及子丙兩象限各減丙辛則辛子等乙丙而爲寅角之弧】甲丙邊爲醜外角【於甲壬及午丙兩象限各減丙壬則午壬等甲丙而爲醜外角之弧】則邊盡爲角

右一鈍角兩銳角形弧角相易爲斜弧次形第二用之第三支

論曰若所設爲甲丙酉形【三角俱鈍而有兩大邊】則以甲外角爲次形丑癸邊酉外角爲癸寅邊丙外角爲丑寅邊又以三邊爲次形三外角【並與第二支未丙酉形三鈍角同理】若所設爲丙未酉形乙未丙形【並一鈍二銳而有兩大邊】皆依上法可徑易爲丑癸寅次形觀圖自明

甲乙丙形【三邊並大三角並鈍】易爲次形

法以本形三外角之度爲次形三邊【午己爲乙外角之度而與癸壬等丑辛爲甲外角之度而與癸寅等申亥爲丙外角之度而與寅壬等】以本形三邊減半周之餘爲次形三角【甲乙減半周其餘戊乙或子甲而並與辰丁等卽癸角之度甲丙減半周其餘戊丙而與丑庚等卽寅角之度乙丙減半周其餘子丙而與午亥等卽壬角之度】並同前術論曰此卽歷學防通所謂別算一三角其邊爲此角一百八十度之餘者也然惟三鈍角或兩鈍角則然其餘則兼用本角之度不皆外角

右三角俱鈍形弧角相易同第二支【惟三邊俱大】

子戊丙形【一大邊二小邊一鈍角二銳角】

其法亦以次形【癸壬癸寅】二邊爲本形【子戊】二角之度寅壬邊爲丙外角之度次形【寅壬】二角爲本形二小邊之度癸角爲大邊減半周之度

論曰此所用次形與前同而用外角度者惟丙角其子角戊角只用本度爲次形之邊非一百八十度之減余也若設戊丙乙形子丙甲形並同【戊丙乙形惟次形癸寅邊爲戊外角其餘癸壬邊之度爲乙角寅壬邊之度爲丙角則皆本度子丙甲形惟次形癸壬邊爲子外角其餘寅壬邊之度爲丙角癸寅邊之度爲甲角則皆本度】

右一鈍角二銳角與第三支同【惟爲邊一大一小】

第五斜弧正弧以弧角互易【內分二支】

一甲乙丙形【甲乙邊適足九十度餘二邊一大一小角一鈍二銳】易爲丑癸寅正弧形【癸正角余銳三邊並小】

法曰引乙丙小邊成半周【於乙引至夘補成丙乙夘象限又於丙引至午成丙辛午象限卽成半周】作夘亥庚丑寅午以丙爲心之半周【截丙甲大邊於庚使丙庚與丙乙夘等乃作庚夘弧爲丙角之度卽庚與夘皆正角依此引至午亦得正角而成半周以丙爲心】作甲醜癸辛戊以乙爲心之半周【引甲乙象限至戊成半周於甲於戊各作正角聨之卽又成半周而截乙辛成像限與乙戊等卽辛戊爲乙外角度而此半周以乙爲心】作乙壬癸寅弧以甲爲心【甲戊半周折半於癸成兩象限從癸作十字正角弧一端至寅一端至乙成癸乙象限其所截甲壬亦象限卽乙壬爲甲角之弧而甲爲其心】三弧綫相交成一丑癸寅次形與本形弧角相易而有正角

論曰次形丑寅邊卽本形丙角之度【丑夘及寅庚皆象限各減丑庚則丑寅卽庚夘而爲丙角之弧】癸寅邊卽甲角之度【寅壬及癸乙皆象限各減癸壬則癸寅卽壬乙而爲甲角之弧】癸丑邊卽乙外角之度【醜辛及癸戊皆象限各減癸辛則丑癸卽辛戊而爲乙外角之弧】是角盡易邊也又寅角爲甲丙邊所成【庚丙及壬戊皆象限各減丙壬則寅角之弧庚壬與甲丙減半周之丙戊等】醜角爲乙丙邊所成【午丙及辛乙皆象限各減辛丙則醜角之弧午辛與乙丙邊等】癸正角爲甲乙邊所成【癸正角內外並九十度而甲乙象限爲癸外角弧若減半周則乙戊象限爲癸交角弧】是邊盡爲角而有正角也

又辰戊丙形【辰戊邊象限余並同前】易爲正弧形【並同前法觀圖自明】

乙丙戊形【乙戊邊足一象限余並小】易爲正角形則丑寅度卽丙外角醜癸度卽乙角寅癸度卽戊角是角爲邊也又寅角生於丙戊醜角生於乙丙癸正角生於乙戊是邊爲角

辰甲丙形【辰甲象弧餘二邊大三角並鈍】易爲正角形則丑寅邊爲丙外角丑癸邊爲辰外角寅癸邊爲甲外角角爲邊也又寅角生於甲丙醜角生於辰丙而癸正角生於辰甲【並準前條諸論推變】是邊爲角而且有正角也

右本形有象限弧卽次形有正角而斜弧變正弧爲弧角互易之第一支

丙乙甲形【丙正角余兩銳角相等邊三小相等者二】易爲己癸壬次形【角一鈍二銳銳相等】

法以甲爲心作寅己丑半周則甲角之度【子寅弧】成次形一邊【己壬】以乙爲心作夘己午半周則乙角之度【夘辰弧】成次形又一邊【己癸】此所成二邊相等以丙爲心作亥癸壬未半周則丙角之度【癸壬象限】卽爲次形第三邊依法平分次形以己壬酉形求壬角得原設甲丙邊【壬角之度癸子與甲丙等】乙丙邊【壬癸兩銳角原同度而癸角之度辰壬與乙丙等故一得兼得也】求半己角倍之成己角以減半周得原設乙甲邊【己外角之度午寅或丑夘並與乙甲等】

論曰本形有正角次形無正角而有象限弧得次形之象限弧得本形之正角矣

若設丙戊丁形【丙正角兩鈍角同度二大邊同度一邊小】易爲己癸壬次形與上同法惟丁戊用外角

若設甲丙戊形【丙正角餘一銳一鈍而銳角鈍角合成半周邊二大一小而小邊與一大邊合成一半周】易爲己癸壬次形亦同上法惟甲用外角戊用本角而同度所得次形之邊亦同度【甲外角之度子寅成次形巳壬邊戊本角乏度辰夘成次形己癸邊而四者皆同度】其轉求本形也用次形之壬角得甲丙以減半周卽得丙戊【或乙丙丁形亦同】

右本形有正角而次形無正角爲弧角互易之第二支

或三角形無相同之邊角而有正角【其次形必有象限邊】或無正角而有相同之邊角【其次形亦有等邊等角】準此論之

次形法補遺【角一銳一鈍邊二大一小】

附算例三角求邊三邊求角

甲乙丙形【甲角一百二十度乙角一百一十度丙角八十五度爲一銳二鈍】三角求邊

如法易爲丑寅癸次形【癸寅邊六十度當甲角醜癸邊七十度當乙角寅丑邊當丙角並以角度減半周得之】

求甲乙邊【卽次形癸外角】法以【甲乙】兩角正相乘半徑除之得數【八一三八○】爲一率半徑【一○○○○○】爲二率【甲乙】兩角相較【十度】之矢與丙角減半周【九十五度】大矢相較得數【一○七一九七】爲三率求得四率【一三一七二四】爲次形癸角大矢內減半徑成余【三一七二四】撿表得癸外角【七十一度三十分】爲甲乙邊【本宜求癸角以減半周得甲乙今用省法亦同】

論曰三角求邊而用次形實卽三邊求角也故其求甲乙邊實求次形癸角得癸角得甲乙邊矣然則兩角正仍用本度者何也凡減半周之餘度與其本度同一正也【甲角一百二十度之正八六六○三卽次形癸寅邊六十度之正乙角一百一十度之正九三九六九卽次形醜癸邊七十度正】獨丙角用余度大矢何也正可同用而矢不可以同用也【丙以外角易爲次形丑寅邊九十五度其大矢一○八七一六而丙角本八十五度是銳角當用正矢故不可以通用】然則兩角較矢又何以仍用本度曰兩余度之較與本度同故也【甲角乙角之較十度所易次形之癸寅邊丑癸邊其較亦十度】所得四率爲大矢而甲乙邊小何也曰余度故也【甲乙邊易爲癸外角而四率所得者癸內角也故爲甲乙減半周之餘度】用余度宜減半周命度矣今何以不減曰省算也𨿽不減猶之減矣【四率系大矢必先得癸外角七十一度半以減半周得癸內角一百○八度半再以癸內角減半周仍得七十一度半爲甲乙邊今徑以先得癸外角之度爲甲乙邊其理無二】

求甲丙邊如上法以邊左右兩角正【甲八六六○三丙九九六一九】相乘半徑除之得數【八六二七三】爲一率半徑【一○○○○○】爲二率【甲丙】兩角相較【三十五度】矢【一八○八五】與乙外角【七十度】矢【六五七九八】相較得數【四七七一三】爲三率求得甲丙邊半周餘度之矢【五五三○四】爲四率【撿表得六十三度二十七分】以減半周得甲丙邊【一百一十六度三十三分】

論曰此亦用次形三邊求寅角也【以甲角所易癸寅邊丙角所易寅丑邊爲角旁二邊以乙角所易丑癸邊爲對角之邊求得寅角之度辛子與酉丙等卽甲丙減半周餘度】求乙丙邊如法以邊左右兩角正【丙九九六一九乙九三九六九】相乘半徑除之得數【九三六一二】爲一率半徑【一○○○○○】爲二率【丙乙】兩角較【二十五度】矢【○九三六九】與甲外角【六十度】矢相較【四○六三一】爲三率求得余度矢【四三四○三】爲四率【撿表得五十五度三十二分】以減半周得乙丙邊【一百廿四度廿八分】

論曰此用次形三邊求醜角也【丙角易寅丑邊乙角易丑癸邊爲角旁二邊甲角易癸寅爲對邊求得醜角度午壬與未丙等卽乙丙邊減半周餘度】又論曰此所用次形之三邊三角皆本形減半周之餘度【甲乙同己辰卽癸外角度則次形癸角爲甲乙邊之半周餘度也寅角之度子辛與酉丙等甲丙邊之餘度也醜角之度午壬與未丙等乙丙邊之餘度也是次形三角皆本形三邊減半周之餘度矣其次形三邊爲本形三角減半周之餘己詳前注】故所得四率爲角之大小矢者皆必減半周然後可以命度若他形則不盡然必須詳審

如甲未丙形【甲角六十度丙角九十五未角一百一十】易丑寅癸次形則其角易爲邊用本度者二【甲角弧丁辛六十度易次形癸寅邊丙角弧申午九十五度易次形寅丑邊】用余度者一【未角弧壬戊一百一十度其半周餘度己壬七十度易次形醜癸邊】而其邊易爲角用本度者二【未丙邊五十五度三十二分與午壬等成次形醜角甲未邊余度未酉七十一度三十分與丁戊等成癸外角則次形癸角一百○八度三十分爲甲未邊本度】用餘者者一【甲丙邊一百十六度三十三分其餘度酉丙六十三度二十七分與辛子等成次形寅角】若一槪用余度算次豈不大謬

又如乙丙酉形【乙角七○丙角九五酉角一二○】用【癸寅丑】次形【前圖】求丙酉邊

如法以邊左右兩角正【丙九九六一九酉八六六○三】相乘去末五位得數【八六二七三】爲一率半徑【一○○○○○】爲二率以【酉外角丙角】相差【三十五度】矢【一八○八五】與乙角矢【六五七九八】相較【四七七一三】爲三率求得正矢【五五三○四】爲四率【次形寅角之矢】撿表得六十三度二十七分爲丙酉邊

論曰此所用四率與前條求甲丙邊之數同而邊之大小迥異一爲余度一爲本度也【前條爲余度之矢故甲丙邊大此條爲本度之矢故丙酉邊小】又所用矢較亦以不同而成其同【前條以兩角相差此則以酉外角與丙角相差不同也而相差三十五度則同前條用乙外角之矢此條用乙本角又不同也而矢數六五七九八則同】其理皆出次形也

求酉乙邊如法以兩角正【乙九三九六九酉八六六○三】相乘去末五位【得八一三八○】爲一率半徑爲二率【酉外角乙角】相差【十度】之矢與丙角【九十五度】之矢相較【得一○六一九七】爲三率求得大矢【次形癸角之矢】爲四率【一三一七二四】撿表【得一百○八度三十分】爲酉乙邊【此與前條求甲乙邊參防卽見次形用法不同之理如前所論】

求乙丙邊與前條同法【因丙乙兩內角之正及差度並與兩外角同而酉角又同甲角故也】

論曰三角求邊必用次形而次形之用數得數並有用求度余度之異卽此數條可知其槪

又論曰在本形爲三角求邊者在次形爲三邊求角故此數條卽三邊求角之例也【余詳環中黍尺】

垂弧捷法【作垂弧而不用其數故稱捷法】亦爲次形雙法【用兩次形故稱雙法】設亥甲丁形有甲亥邊亥丁邊亥角【在二邊之中】求甲丁邊【對角之邊】

本法作垂弧分兩形先求甲已邊次求亥已邊分丁巳邊再用甲巳丁巳二邊求甲丁邊

今捷法不求甲已邊但求亥已邊分丁已邊卽用兩分形之兩次形以徑得甲丁

一亥已余卽次形亥戊正

二亥甲余卽次形亥丙正

三已丁余卽次形辛丁正

四甲丁余卽次形庚丁正

法引甲亥邊至丙引甲丁邊至庚引甲已垂弧至乙皆滿象限又引分形邊亥已至戊引丁已至辛亦滿象限末作辛庚乙丙戊半周與亥已遇於戊與丁已遇於辛成亥丙戊次形與甲已亥分形相當丁亥辛次形與甲已丁分形相當而此兩次形又自相當【戊角辛角同以己乙爲其度則兩角等丙與庚又同爲正角則其正之比例皆等】

論曰半徑與戊角之正若戊亥之正與亥丙之正又半徑與辛角【卽戊角】之正若辛丁之正與丁庚之正合之則戊亥正與亥丙正亦若辛丁正與丁庚正

又論曰辛丁已亥戊如黃道半周辛庚乙丙戊如赤道半周甲如北極辛如春分戊如秋分已乙如黃赤大距卽夏至之緯乃二分同用之角度【卽戊角辛角之度】亥丙及丁庚皆赤緯甲亥及甲丁皆距北極之度【卽赤緯之度】

一戊亥正黃經

戊亥爲未到秋分之度辛二亥丙正赤緯

丁爲已過春分之度似有三辛丁正黃經

不同而二分之角度旣同四丁庚正赤緯

故其比例等

一亥已余

卽亥戊正

二亥甲余

卽亥丙正

三已丁余

卽戊丁正

四甲丁余

卽庚丁正

論曰此理在前論中蓋以同用戊角故比例同也又論曰乙庚丙戊如赤道已丁亥戊如黃道皆象弧戊角如秋分其弧己乙如夏至距緯【此兩黃經並在夏至後秋分前其理易見】或先有者是丁鈍角甲丁丁亥二邊則先求丁巳綫【亦用前圖】一丁已余

卽戊丁正

二甲丁余

卽丁庚正

三亥已余

卽亥戊正

四亥甲余

卽亥丙正

又論曰假如星在甲求其黃赤經緯則亥丁如兩極之距亥角若爲黃經則丁角爲赤經而亥甲黃緯丁甲赤緯也若丁角爲黃經則亥角爲赤經而丁甲黃緯亥甲赤緯也【弧三角之理隨處可施故舉此以發其例】

弧三角舉要卷五

八綫相當法引

弧三角有以相當立法者何也以四率皆八綫也弧三角四率何以皆八綫而不用他綫【八綫但論度他綫則有丈尺】渾體故也【弧三角皆在渾員之面】渾體異平而禦渾者必以平是故八綫之數生於平員而八綫之用專於渾員也曷言乎專爲渾員曰平三角之角之邊皆直綫也同在一平面而可以相爲比例故𨿽用八綫而四率中必兼他綫焉【以八綫例他綫則用角可以求邊以他綫例八綫則用邊可以求角皆兼用兩種綫】弧三角之角之邊皆弧度曲綫也不同在平面故非八綫不能爲比例而四率中無他綫焉旣皆以八綫相比例則同宗半徑【有角之八綫有邊之八綫各角各邊俱非平面而可以相求者同一半徑也】相當互視之法所由以立也錯舉似紛實則有條不紊故爲論列使有倫次云

八綫相當法詳衍

總曰相當分之則有二曰相當曰互視互視又分爲二曰本弧曰兩弧

但曰相當者皆本弧也又分爲二曰三率連比例者以全數爲中率也其目有三曰四率斷比例者中有全數也其目有六凡相當之目九

互視者亦相當也皆爲斷比例而不用全數若以四率之一與四相乘二與三相乘則皆與全數之自乘等也本弧之互視其目有三兩弧之互視其目有九凡互

視之目十二

總名之皆曰相當其目共二十一內三率連比例三更之則六四率斷比例十有八更之反之錯而綜之則百四十有四共百有五十

相當共九

一曰正與全數若全數與余割

二曰余與全數若全數與正割

三曰正切與全數若全數與余切

以上三法皆本弧皆三率連比例而以全數爲中率

四曰正與余若全數與余切

五曰余與正若全數與正切

六曰正割與正切若全數與正

七曰余割與余切若全數與余

八曰正割與余割若全數與余切

九曰余割與正割若全數與正切

以上六法亦皆本法而皆四率斷比例四率之內有一率爲全數

互視共十二

一曰正與正切若余切與余割

二曰余與余切若正切與正割

三曰正與余若正割與余割

以上三法亦皆本弧皆四率斷比例而不用全數然以四率之一與四二與三相乘則其兩矩內形皆各與全數自乘之方形等

四曰此弧之正與他弧正若他弧之餘割與此弧余割五曰此弧之正與他弧余若他弧之正割與此弧余割六曰此弧之正與他弧正切若他弧之餘切與此弧余割七曰此弧之餘與他弧余若他弧之正割與此弧正割八曰此弧之餘與他弧正若他弧之餘割與此弧正割九曰此弧之餘與他弧余切若他弧之正切與此弧正割十曰此弧之正切與他弧正切若他弧之餘切與此弧余切十一曰此弧之正切與他弧正若他弧之餘割與此弧余切十二曰此弧之正切與他弧余若他弧之正割與此弧余切以上九法皆兩弧相當率也其爲四率斷比例而不用全數則同若以四率之一與四二與三相乘其矩內形亦各與全數自乘之方形等

相當法錯綜之理

此三率連比例也首率與中率之比例若中率與末率故以首率末率相乘卽與中率自乘之積等

假如三十度之正【○五○○○○】與全數【一○○○○○】之比例若全數【一○○○○○】與三十度之餘割【二○○○○○】其比例皆爲加例也更之則余割【二○○○○○】與全數【一○○○○○】若全數【一○○○○○】與正【○五○○○○】其比例爲折半也

又如三十度之餘【○八六六○三】與全數【一○○○○○】若全數【一○○○○○】與三十度之正割【一一五四七○】更之則正割【一一五四七○】與全數【一○○○○○】若全數【一○○○○○】與余【○八六六○三】也

又如三十度之正切【○五七七三五】與全數【一○○○○○】若全數【一○○○○○】與三十度之餘切【一七三二○五】更之則余切【一七三二○五】與全數【一○○○○○】若全數【一○○○○○】與正切【○五七七三五】也

用法

凡三率連比例有當用首率與中率者攺爲中率與末率假如有四率其一三十度正其二全數攺用全數爲一率三十度余割爲二率其比例同

凡四率之前後兩率矩內形與中兩率矩形等故一與四二與三可互居也

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷八﹥

右四率斷比例也一率與二率之比例若三率與四率假如三十度之正【○五○○○○】與其餘【○八六六○三】若全數【一○○○○○】與其餘切【一七三二○五】更之則余切【一七三二○五】與全數【一○○○○○】若余【○八六六○三】與正【○五○○○○】也【第四法】又如三十度之正割【一一五四七○】與其正切【○五七七三○】若全數【一○○○○○】與其正【○五○○○○】更之則全數【一○○○○○】與正割【一一五四七○】若正【○五○○○○】與正切【○五七七三五】也【第六法】又如三十度之餘割【二○○○○○】與其正割【一一五四七○】若全數【一○○○○○】與其正切【○五七七三五】更之則正切【○五七七三五】與正割【一一五四七○】若全數【一○○○○○】與余割【二○○○○○】也【第九法餘仿此】用法

凡四率斷比例當用前兩率者可以後兩率代之假如有四率其一正其二餘攺用全數爲一率余切爲二率其比例同互視

此本弧中互相視之率也其第一與第四相乘矩第二與第三相乘矩皆與全數自乘方等故其邊爲互相視之邊而相與爲比例皆等

假如三十度之正【○五○○○○】與其餘割【二○○○○○】相乘【一○○○○○○○○○○】其餘【○八六六○三】與其正割【一一五四七○】相乘【一○○○○○○○○弱】皆與全數自乘之方等故以正爲一率余爲二率正割爲三率余割爲四率則正【○五○○○○】與余【○八六六○三】若正割【一一五四七○】與余割【二○○○○○】也【第三法】又如三十度之正切【○五七七三五】與其餘切【一七三二○五】相乘【一○○○○○○○○弱】亦與全數之方等故以正爲一率余切爲二率正切爲三率余割爲四率則正【○五○○○○】與正切【○五七七三五】若余切【一七三二○五】與余割【二○○○○○】也【第一法】或以余爲一率余切爲二率正切爲三率正割爲四率則余【○八六六○三】與余切【一七三二○五】若正切【○五七七三五】與正割【一一五四七○】也【第二法】

用法

此亦四法斷比例故當用前兩率者可以後兩率代之假如有四率當以正與正切爲一率二率者攺用余切爲一率余割爲二率以乘除之其比例亦同餘仿此本弧諸綫相當約法

其一爲與股之比例

反之則如股與全正割余切余割全

余正切正正正切余全

余割余切正割全其二爲與句之比例

反之則如句與全

余割正切正割全

正余切余余余切正全

正割正切余割全其三爲句與股之比例

反之則如股與句全

余余割余切全

正割正正切正切正正割全

余切余割余全右括本弧七十八法

如圖甲丙甲乙甲丁皆半徑全數乙丙爲正弧乙丁爲余弧乙戊爲正庚丙爲正切綫庚甲爲正割綫乙己爲余辛丁爲余切綫辛甲爲余割綫

此皆一定比例觀圖自明

外有餘切余非與股之比例則借第二比例更之

一甲乙全數【卽甲丁】

辛丁余切

四辛丁余切

甲丁全數

全數與余若余割與余切更之而余切與余若余割與全數也余割與全數旣爲與股則余切與余亦如與股矣

正切正非與句之比例則借第一比例更之一甲乙全數【卽甲丙】

庚丙正切

四庚丙正切

甲丙全數

全數與正若正割與正切更之而正切與正若正割與全數也正割與全數旣爲與句則正切與正亦如與句矣

余割正割非句與股之比例則仍借第一比例更之

一餘割辛甲

余割辛甲

二全數甲丁【卽甲丙】

正割庚甲

三正割庚甲

全數甲丙

四正切庚丙

正切庚丙

余割與全數若正割與正切更之而余割與正割若全數與正切也全數與正切旣爲句與股則余割與正割亦如句與股矣

【互視自此而分以前爲本弧所用共大法三更之則二十有四合相當法則七十有八而總以三率連比例三大法爲根】

【以後爲兩弧所用共大法九更之七十有二而仍以本弧之三率連比例爲根】

九法

十二法

【以上大法三更之二十有四是以本弧之正切余切與他弧互視】

此皆兩弧中互相視之率也本弧有兩率相乘矩與全數之方等他弧亦有兩率相乘矩與前數之方等則此四率爲互相視之邊互相視者此有一率贏於彼之一率若干倍則此之又一率必朒於彼之又一率亦若干倍而其比例皆相等故以此弧之兩率爲一與四則以他弧之兩率爲二與三

假如有角三十度邊四十度此兩弧也角之正【○五○○○○】與其餘割【二○○○○○】相乘【一○○○○○○○○○】與全數自乘等邊之正【○六四二七九】與其餘割【一五五五七二】相乘【一○○○○○○○○弱】亦與全數自乘等則此四率爲互相視之邊互相視者言角之正【○五○○○○】與邊之正【○六四二七九】若邊之餘割【一五五五七二】與角之餘割【二○○○○○】也【第四法】

又如有二邊大邊五十度小邊三十度大邊之正【○七六六○四】余割【一三○五四一】相乘與全數自乘等小邊之正切【○五七七三五】余切【一七三二○五】相乘亦與全數自乘等則此四者互相視互相視者言大邊之正【○七六六○四】與小邊之正切【○五七七三五】若小邊之餘切【一七三二○五】與大邊之餘割【一三○五四一】也【第六法】

又如有兩角甲角三十度乙角五十度此亦兩弧也甲角之正切【○五七七三五】余切【一七三二○五】相乘與全數自乘等乙角之正切【一一九一七五】余切【○八三九一○】相乘亦與全數自乘等則此率爲互相視之邊互相視者言甲角之正切【○五七七三五】與乙角之正切【一一九一七五】若乙角之餘切【○八三九一○】與甲角之餘切【一七三二○五】也【第十法】

用法

假如別有四率以五十度正爲第一三十度正切爲第二今攺用三十度余切第一五十度余割第二其比例同﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷八﹥如圖壬丙爲本弧乙丙爲他弧他弧小於本弧而並在半象限以內

本弧【正壬癸余壬丑正切庚丙余割未甲正割庚甲余切未丁】

他弧【正乙戊余乙巳正切辛丙余割酉申正割辛甲余切酉丁】

論曰甲丙甲丁皆半徑乃本弧他弧所共也半徑自乘之方冪爲甲丙夘丁而本弧中以正乘余割以余乘正割以正切乘余切所作矩形旣各與半徑方冪等則他弧亦然故可以互相視而成相當之率

如上圖壬丙本弧在半象限內巳丙他弧在半象限外亦同

如上圖壬丙本弧小於乙丙他弧而並在半象限外並同

歷算全書卷八﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

小引

環中黍尺者所以明平儀弧角正形乃天外觀天之法而渾天之畫影也天圜而動無晷刻停而六合以內經緯歷然亙萬古而不變此卽常靜之體也人惟囿於其中不惟常動者不能得其端倪卽常靜之體所爲經緯歷然者亦無能擬諸形容惟置身天外以平觀大圜之立體則周天三百六十經緯之度擘劃分明皆能變渾體爲平面而寫諸片楮按度攷之若以玻璃水晶通明之質琢成渾象而陳之几案也又若有鏤空玲瓏之渾儀取影於燭而惟肖也故可以算法證儀亦可以量法代算可以獨諭可以眾曉平儀弧角之用斯其妙矣庚辰中秋鼎偶霑寒疾諸務屏絕展轉牀褥間斗室虛明心閒無寄秋光入戶秋夜彌長平時測算之緒來我胸臆積思所通引伸觸類乃知曆書中斜弧三角矢綫加減之圖特以推明算理故爲斜望之形其弧綫與平面相離聊足以彷佛意象啟人疑悟而不可以實度比量固不如平儀之經緯皆爲實度弧角悉歸正形可以算卽可以量爲的確而簡易也病間錄枕上之所得輙成小帙然思之所引無方而筆之所追未能什一庶存大致竢同志之講求耳【此第一卷

原序也余詳目錄】

康熈三十有九年重九前七日勿庵力疾書時年六十有八

欽定四庫全書

歷算全書卷九

宣城梅文鼎撰

環中黍尺卷一之二

總論

有垂弧及次形而斜弧三角可算乃若三邊求角則未有以處也環中黍尺之法則可以三邊求角【如有黃赤兩緯度可求其經】可以徑求對角之邊【如有黃道經緯可徑求赤道之緯】立術超妙而取徑遙深非專書備論難諳厥故矣書成於康熈庚辰非一時之筆故與舉要各自爲首尾

凡測算必有圖而圖弧角者必以正形厥理斯顯於是以測渾圓則衡縮欹衺環應無窮殆不翅累黍定尺也本書命名蓋取諸此

用八綫至弧度而奇然理本平實以八綫量弧度至用矢而簡然義益多通要亦惟平儀正形與之相應一卷之先數後數所爲直探其根以發其藏也

平儀以視法變渾爲平而可算者亦可量卽眎度皆實度矣二卷之平儀論所以博其趣而三極通幾其用法也【黍尺名書於玆益著】

矢度之用已詳首卷而余之用亦可參觀故又有三卷之初數次數也初數次數本用乘除亦可以加減代之故有加減法以疏厥義【自三卷以後非非一時所撰今以類相附而仍各爲之捲】

四卷之甲乙數卽初數次數之變也而彼以乘除此以加減則繁簡殊矣

五卷之法亦加減也而特爲省徑故稱防焉【用初數不用次數用矢度不用余以視甲乙數又省其半】然不可不知其變故又有補遺之術也

恆星歷指之法別成規式而以加減法相提而論固異名而同實是以命之又法也

【以上環中黍尺之法約之有六用乘除者二其一先數後數其一初數次數也用加減者四初數次數也甲乙數也捷法也又法也本書中具此六術然而加減捷法其尢爲善之善者歟】

外有不系三邊求角之正用並可通之以加減之法者是爲加減通法蓋術之約者其理必精數之確者爲用斯博並附數則於五卷之末以發其例

弧三角用平儀正形之理

作圖之法有二一爲借象一爲正形以平寫渾不得已而爲側睨遙望之形以曲狀其變然多借象而非正形玆一準平儀法度寘二極於上下而從旁平視之【如置身大員之表以觀大員】則渾球上凸面之經緯弧角一一可寫於平面而悉爲正形於是測望之法步算之源皆不煩箋疏而解

平儀用實度之理

斜視之圖無實度可紀【弧角之形聊足相擬其實度非算不知】玆者平儀旣歸正形則度皆實度循圖可得卽量法與算法通爲一術【以橫徑查角度以距緯查弧度並詳二卷】

平儀用矢綫之理

八綫中有矢他用甚稀乃若三邊求角則矢綫之用爲多而又特爲簡易信古人以弧矢測渾員其法不易然亦惟平儀正形能著其理【下文詳之】

矢綫之用有二

一矢綫爲角度之限鈍角用大矢鋭角用小矢【小矢卽正矢也從半徑言之爲正矢從全徑言之爲小矢】法曰置角度於平儀之周則平員全徑爲角綫所分而一爲小矢一爲大矢【平儀橫徑卽渾員之腰圍故大矢卽鈍角度小矢卽鋭角度】

如圖渾球上甲戊甲丁甲丙三小弧與甲已同度故同用甲已爲正矢丁乙戊乙丙乙三過弧與已乙同度故同用已乙爲大矢

一矢較爲弧度之差大弧用大矢【弧度過象限爲大弧故大矢亦大於半徑】小弧用小矢【弧度不及象限爲小弧故正矢小於半徑】較弧與對弧並同法曰置較弧對弧於員周【角旁兩弧之較爲較弧亦曰存弧對角之弧爲對弧亦曰底弧】則各有矢綫而同軸可得其差謂之兩矢較也較弧對弧並小則爲兩正矢之較【兩弧俱象限以下故俱用正矢】較弧小對弧大爲正矢大矢之較【較弧在象限以下用正矢對弧過象限用大矢】

較弧對弧並大爲兩大矢之較【兩弧俱過象限故俱用大矢】

凡較弧必小於對弧則較弧矢亦小於對弧矢故無以較弧大矢較對弧正矢之事法所以恆用加也【若較弧用大矢則對弧必更大】

如圖醜乙弧之正矢辛乙【庚乙寅乙

二弧同用】子乙弧之正矢壬乙【癸乙夘乙

同用】則辛壬爲兩矢之較卽爲【癸乙

寅乙】兩弧度之較也【或丑乙與子乙或庚乙與

癸乙或寅乙與卯乙並同】又如戊乙弧之

大矢已乙與丑乙弧之正矢辛乙相較得較已辛或子乙弧之正矢壬乙與丙乙弧之大矢已乙相較得較巳壬皆大矢與正矢較也又如甲醜弧之大矢辛甲與甲夘弧之大矢壬甲相較得較辛壬則兩大矢較也約法

凡求對角之弧並以角之矢爲比例【鈍角用大矢鋭角用正矢】求得兩矢較【半徑方一率正矩一率角之矢三率兩矢較四率】以加較弧之矢【較弧大用大矢較弧小用正矢】得對弧矢加滿半徑以上爲大矢其對弧小【遇象限】加不滿半徑爲小矢其對弧小【不過象限】此不論角之鋭鈍邊之同異通爲一法

凡三邊求角並以兩矢較爲比例求角之矢【半徑方一率余割矩二率兩矢較三率角之矢四率】得數大於半徑爲大矢其角則鈍得數小於半徑爲正矢其角則鋭亦不論邊之同異通爲一法

問用矢用余異乎曰矢余相待而成者也可以矢算者亦可用余立算但加減尙須詳審若矢綫則一例用加尢爲簡妙

先數後數法

【此以平儀弧角正形解渾球上斜弧三角用矢度矢較爲比例之根也】

【先得數者正上距等圈矢也與角之矢相比後得數者而矢較也與較弧矢相加】

設丙乙丁斜三角形有乙鋭角有丙乙弧小於象

限丁乙弧大於象限【是爲角旁

之兩弧不同類】求丁丙爲對角

之弧用較弧【角旁兩弧相減】及

對弧兩正矢之較爲加差

法以大小兩邊各引長之

滿半周遇於戊作戊甲乙

圜徑又於圜徑折半處【巳】命爲渾圜心又自己心作橫半徑【如巳寅辛】則寅辛卽乙角之弧亦卽爲乙角之矢【平視之爲矢度實卽角度之弧躋縮而成】而寅已卽乙角之餘弧亦卽爲乙角余【因視法能令余弧躋縮成余】又自丁作橫半徑【巳辛】之平行綫【如壬丁甲】此平行綫卽乙丁大邊之正【因平視故乙丁小於乙壬其實乙丁弧之度與乙壬同大今壬甲旣爲戊壬及乙壬之正亦卽爲乙丁之正矣】而此正【壬甲】又卽爲距等圈之半徑也【想戊巳乙爲半渾圜之中剖國面側立形乃自壬丁甲橫切之則壬甲爲其橫切之半徑】則其丁壬分綫亦爲距等圈上丁壬弧之矢綫矣【有距等圈半徑卽有其弧】而此大小兩矢綫各與其半徑之比例皆等【己辛大圜之半徑大故寅辛矢亦大甲壬距等圈之半徑小故壬丁矢亦小然其度皆乙角故比例一也距等𨿽用戊角而戊角卽乙角有兩弧綫限之故也】法爲已辛與甲壬若寅辛與壬丁

一率半徑已辛

二率【大弧正】壬甲【卯距等圈之半徑】

三率【乙角矢】寅辛

四率【先得數】壬丁【卽距等圏之正矢】

次從丙向已心作丙巳半徑此綫爲加減之主綫【以較弧對弧俱用爲半徑而生矢度】又從壬作壬夘爲壬丙較弧之正【壬乙旣同丁乙則丁乙弧之大於丙乙其較爲壬丙】又從丁作癸丁午綫爲丁丙對弧之正【因平視故丁丙弧小於癸丙其實丁丙弧與癸丙同大癸午旣爲癸丙正亦卽丁丙之正矣】因兩正平行又同抵巳丙半徑爲十字正方角故比例生焉此立算之根本又從丁作丁子綫與午夘平行而等【以有對弧較弧兩正爲之限也】成壬丁子句股形又從丙作丙辰綫爲乙丙小邊之正成已丙辰句股形此大小兩句股形相似【巳丙辰與卯已奎小形相似則亦與壬丁子形相似等角等勢故也】法爲丙已與辰丙若壬丁與丁子

一率半徑丙已

二率【小弧正】辰丙股

三率【先得數】壬丁小

四率【兩矢較】丁子小股

省算法用合理

【因上兩宗內各冇先得數而一爲三率一爲四率故對去不用】

乃以後得數爲矢較加較弧矢【以午夘加夘丙也】成對弧矢【午丙】末以對弧矢【午丙】減半徑【巳丙】成對弧余【午已】檢表得對弧【丁丙】之度

又法以後得數減較弧余【以午夘減夘已】成對弧余【午己】檢表得對弧【丁丙】度亦同【兩正矢之較卽兩余較也故加之得矢者減之卽得余】

若先有三邊而求乙鈍角則反用其率【因前四率反之以首率爲次率三率爲四率】

以乙角矢【寅辛】減半徑【辛巳】得余【寅巳】檢表得乙角之度右銳角以二邊求對邊及三邊求角並以兩矢較爲加差【以差加較弧矢得對弧大三邊求角則爲三率】亦爲兩余較【依又法以差減較弧余爲對弧余三邊求角則兩余弧相減爲三率】角旁弧異類對邊小

設亥乙丁斜弧三角形有乙鈍角有亥乙小弧丁乙大弧求亥丁【對角弧】用較弧正矢與對弧大矢之較爲加差

戊乙徑爲取角度之

根亢寅角度及房甲

與亥虛兩正皆依

之以立

大矢卽鈍角之弧度

小矢卽鋭角之弧度

亥斗徑爲加減之根

房氐及危心兩正

依之以立有兩正卽有兩余及大小矢而加減之用生焉

法以大小兩邊各引長之滿半周遇於戊又依小邊半周【乙亥戊】補其餘半周【戊辛乙】成全圓又從戊至乙作圓徑又作亢辛橫徑兩徑相交於已卽圓心則寅辛爲乙角之小矢而寅亢爲乙角之大矢【寅已亢卽乙鈍角之弧度平視之成大矢】若自寅點作直綫與戊乙平行取距戊乙之度加象限卽角度又從丁作房丁壬橫綫與亢辛橫徑平行此綫卽丁乙大邊正之倍數【房丁壬與亢辛平行則房乙卽丁乙也因平視故丁乙小於房乙耳而房甲旣爲房乙之正亦卽丁乙正也房甲旣爲正房壬則倍正矣倍正卽通】而此【房壬】倍正又卽爲距等圏之全徑【想全體渾圓從壬丁房橫切之成距等圈而房壬其全徑】則房丁分綫亦卽爲距等圏上丁甲房弧之大矢【有距等圈全徑卽有其全圏而房甲丁其切弧】而此兩大矢綫各與其全徑之比例皆等【亢辛全徑大故寅亢大矢亦大房壬距等圏之全徑小故房丁大矢亦小然其度皆乙角之度在乙丁戊及乙房戊兩弧綫之中故各與其全圓之比例等而其大矢亦各與其全徑之比例等】卽各與其半徑之比例亦等【若以甲爲心壬爲界作半圓於房壬綫上則距等之弧度見矣】法爲亢辛【全徑】與房壬【距等全徑卽倍正】若寅亢【鈍角大矢】與房丁【先得數亦距等大矢】而亢已【半徑】與房甲【乙丁正亦距等半徑】亦若寅亢與房丁

一率亢巳【半徑】

二率房甲【大邊之正亦距等半徑】

三率寅亢【鈍角大矢】

四率房丁【先得數亦距等大矢】

次從亥過巳心作亥已斗全徑爲加減主綫【較弧對弧之俱過此全徑而生大小矢】又從房作房氐綫爲房亥較弧之正【準前論房乙同丁乙則丁乙之大於亥乙其較房亥】又從丁作心丁婁綫與房氐正平行而交亥斗徑於危如十字則此綫爲亥丁對弧之倍正【因視法心亥弧大於亥丁其實卽亥丁也亥丁爲平視躋縮之形心亥爲正形而心危者心亥弧之正也是卽亥丁弧之正而心丁婁其倍矣】又從丁作丁女綫與鬥亥徑平行亦引房氐較弧之正爲通而與丁女綫遇於女成丁女房句股形又從亥作亥虛綫與亢辛橫徑及大邊之正房甲俱平行成亥虛已句股形此大小兩句股形相似【亥巳卽徑綫與丁女平行亥虛與房甲丁平行則大形之丁角與小形之亥角等而女與虛並正角則爲等角而相似】法爲已亥【半徑】與亥虛【小邊正】若房丁【先得數而距等大矢】與丁女【後得數亦卽氐危爲較弧正矢氐亥及對弧大矢危亥之較】

一率半徑已亥

二率【小邊正】亥虛句

三率【先得數】房丁大

四率【後得數】丁女大句

乃以省算法平之

乃以後得數加較弧正矢【以氐危加氐亥成危亥】爲對弧大矢內減半徑得對弧余檢表得度以減半周爲對弧之度又法於後得數內減去較弧余成對弧余【於氐危內減氐巳其餘危巳卽對弧余】乃以余檢表得度以減半周爲對弧之度大矢與小矢之較卽兩余並也內減去一餘卽得一餘矣觀圖自明前用鋭角是於較余內減得數爲對弧余此用鈍角是於得數內減較弧余爲對弧余

若有三邊而求角度者則反用其率

一半徑上方

一兩正矩

半徑上方

二兩正矩

二半徑上方

兩余割相乘矩三鈍角大矢寅亢

三兩余並氐危【卽較弧正矢與對弧大矢之較】四兩余並丁女【卽氏危】四鈍角大矢寅亢

乃於所得大矢內減去半徑成余以余檢表得度用減半周爲鈍角之度

右鈍角求對邊及三邊求鈍角並用兩矢之較爲加差【以差加較弧正矢得對弧大矢又爲三邊求角之三率】亦爲兩余並【依又法減較弧余得對弧余三邊求角卽並兩余爲三率】其鈍角旁兩弧異類對弧大

設丁辛乙斜弧三角形

有辛丁邊【五十度一十分】丁乙對角

邊【六十度】辛乙邊【八十度】三邊並

小求辛鋭角

法先爲戊亢辛全員作戊

辛員徑又作亢巳橫員徑

【兩徑十字相交於巳心此綫上有角度】

次於戊辛徑左右任取自辛數至丁如所設角旁小邊【五十度一十分】之數截丁辛爲小邊又從丁過巳作徑綫【此綫上有加減度】爲較弧對角弧兩正所依仍自辛過丁數至房如所設大邊【八十度】之數截房丁爲大小兩邊之較弧又自丁過房數至心如所設對邊【六十度】之數截心丁與乙丁等仍自丁過辛截婁丁度如心丁乃作婁心直綫聨之爲心丁對弧之倍正又從房作房甲橫綫與亢巳橫徑平行此爲乙辛大邊之正【因視法房辛卽乙辛詳後】次視婁心倍與房甲正兩綫相遇於乙命爲斜弧形之角乃從乙角向辛作乙辛弧【此弧亦八十度與房辛同大】是所設角旁之大邊【理在平儀視法房辛是眞度乙辛是視凸爲平躋縮之形想平儀原系渾體從房乙甲橫切之則自房至甲爲距等圈之九十度從此綫上度度作弧至辛極並八十度不惟乙辛與房辛同大卽甲辛亦與房心同大也他仿此】又從乙向丁作乙丁弧【此弧亦六十度與心丁同大】是所設對角之邊【切渾角以心婁距等圈而以丁爲極則危丁亦六十度與心丁同大矣乙丁同大不言可知】遂成乙辛丁斜弧三角在球上之形與所設等又從乙引乙辛弧綫至戊成心乙戊半周側立形此綫截亢巳半徑於寅則亢寅爲辛角矢度而寅己其餘次從丁作丁虛橫綫與房甲正平行是爲辛丁小邊之正又從房作房夘綫與心危婁平行則此綫爲房丁較弧之正其心危則乙丁對弧之正又從乙作乙女綫與夘危平行而等【綫在兩正平行綫之中而赤平行不得不等】是爲較弧與對弧兩正矢之較【房夘爲較弧正則夘已爲余而夘丁其矢又心危爲對弧正則危巳爲余而危丁其矢此兩正矢之較爲危卯而乙女與之等則乙女亦兩矢之較矣】

法曰巳丁虛句股形與房乙女句股形相似【房乙與丁虛平行乙女與巳丁平行則所作之大形丁角小形乙角必等而大形之虛小形之女並正角則兩形相似】故丁虛【小邊正】與丁巳【半徑】若乙女【卽夘危較弧余與對弧余之較】與乙房【先得數】

又房甲正之分爲乙房猶亢巳之分爲寅亢其全與分之比例皆相似【從房甲綫切渾員成距等圏而房甲爲其半徑猶渾員之有亢巳爲半徑也兩半徑同爲戊寅辛弧綫所分則乙房爲距等圏半徑之矢度猶寅亢爲大員半徑之矢度也其比例俱相似】故房甲【大邊正卽距等圏半徑】與亢巳【大員之半徑】若乙房【先得數卽距等圏之矢】與寅亢【後得數卽角之矢綫】

以省算法平之卽異乘同乘異除同除

較弧【二十九度五十分】余【八六七四八】正矢【一三二五二】其較三六七四八

對弧【六十度

五○○

五○○○○

○○】

一半徑方一○○○○○○○○○○【首率除宜去十尾乃先於二率】二餘割矩一三二二三二三四○八九【去五位故得數隻去五位卽如】

三兩矢較

三六七四八【共去十位也】

四銳角矢

四八五九二【用減半徑得辛角余五一四○八】檢表得五十九度四分爲辛角之度【此與曆書所算五十八度五十三分只差十一分】又法徑求余法曰房甲之分爲乙房而其餘乙甲猶亢已之分爲亢寅而其餘寅已也故其全與分余之比例亦相似法爲房甲【正】與亢己【半徑】若乙甲【正分綫之餘】與寅已【半徑截矢之餘卽角之餘】

準前論小邊之正虛丁【句】與半徑丁巳【】若較弧對弧兩矢之較乙女【小句】與大邊正之分綫乙房【小】也先求乙房爲先得數以轉減大邊正房甲得分余綫乙甲

一小邊【五十度一○】正

丁虛七六七九一

二半徑

丁巳一○○○○○三【較弧二十九度五○對弧六十度○○】兩正矢較乙女三六七四八

四先得數【大邊正之分綫】

乙房四七八五四以先得數減大邊八十度正房甲九八四八一得大邊正內乙房分綫之餘乙甲五○六二七未以分余綫爲三率

一大邊正

房甲九八四四一

二半徑

亢已一○○○○○

三分余綫

乙甲五○六二七

四角之餘

寅已五一四○七【檢表得五十九度○四分與先算合】附曆書斜弧三角圖【稍爲校正】

丙乙丁弧三角形

乙丙角旁小弧壬乙同丁

乙角旁大弧壬丙爲較弧

癸丙同丁丙爲對角之弧

甲壬爲大弧正辰丙

爲小弧正壬夘爲較弧

正癸午爲對弧正寅辛爲乙角之弧庚辛爲乙角之矢夘丙爲較弧之矢午丙爲對弧之矢午夘爲兩矢較酉壬爲先得數酉子同午夘亦

兩矢之較

法爲全數【己辛】與大弧正【甲壬】若角之矢【庚辛】與先得數【酉壬】又全數【巳丙】與小弧正【辰丙】若先得數【酉壬】與兩矢較【酉子】也一率全之方二率兩正矩三率角之矢四率得兩矢較以兩矢較加較弧之矢爲對弧之矢

論曰此因欲顯酉壬爲甲壬距等半圈之矢度故特爲斜望之形其實丁點原在酉寅點原在庚丁壬弧卽酉壬綫寅辛弧卽庚辛綫乙寅丁戊弧原卽爲乙庚酉戊弧也故以平儀圖之則皆歸正位矣所以者何平儀上惟經度有弧綫之形其距等圈緯度皆成直綫而寅庚爲角度之正直立下垂從其頂視之成一點矣丁酉者大弧正甲壬上所作距等圈之正也從頂視之而成一點與寅庚一也其寅已半徑勢成斜倚從上眎之與已庚余同爲一綫甲丁與甲酉亦然此皆平面正形可以算亦可以量非同斜望比也愚故謂惟平儀爲正形也

若乙角爲鈍角成亥乙丁三角形則當用房亥較弧之正矢【牛亥】與同丁亥對弧之心亥弧大矢危亥相減成兩矢之較【牛危卽女酉】以較加較弧正矢爲對弧大矢【法詳前例但前例鈍角旁小弧不同乙丙故此圖以相同者論之更見其理之不易】

乙爲鈍角用大矢之圖

【此用平儀正形故丁與酉同爲一點】

設角之一邊適足九十度一邊大用銳角【余角一鈍一鋭】法爲半徑與大邊之正若角之矢與兩矢較也亦若角之餘與對弧之餘

乙丁丙斜三角形丙丁邊適

足九十度乙丁邊大於九十度

丁鋭角求對邊丙乙法先作

平員分十字從丁數丁壬及丁丑

並如乙丁度作距等綫聫之【壬醜】又於壬醜綫上取乙點【法以壬巳爲度巳爲心作半員】

【分勻度而自壬取角度得乙防】作庚乙癸直綫爲對弧之正又取壬丙爲較弧作壬夘正較弧之矢夘丙對弧之矢癸丙其較夘癸與壬乙等壬已正又卽距等圈半徑而爲丁乙戊弧所分則壬乙如矢乙已如余與角之丙子矢子甲余同比例

一半徑丙甲

一半徑丙甲

二【大邊正】壬已

二【大邊正】壬已

三【角之矢】子丙

三【角之餘】子甲

四【兩矢較】壬乙【卽夘癸】四

【對弧余】乙已【卽癸甲】

若丁爲鈍角用大矢

法爲半徑與大邊之正若角之大矢與兩矢較也亦若鈍角之餘與對弧之餘

借前圖作乙辛爲對角之弧成乙丁辛三角形【三角俱鈍】作丑午爲較弧丑辛正【以醜丁同乙丁故】其庚癸爲對弧乙辛之正【以庚辛卽乙辛故】較弧之正矢午辛對弧之大矢癸辛其較癸午與丑乙等依前論壬乙爲距等圈小矢則乙丑爲大矢壬醜爲距等圏全徑與其大矢乙丑之比例若丙辛全徑與鈍角之大矢子辛則已丑爲距等半徑與其大矢醜乙亦若甲辛半徑與鈍角之大矢子辛也而丑已原爲乙丁大邊之正【醜乙原與癸午等】故法爲半徑【甲辛】與鈍角之大矢【子辛】若大邊之正【已醜】與兩矢較【丑乙或癸午】也

一半徑甲辛

一半徑甲辛

二【大邊正】丑巳

二【大邊正】醜已

三【鈍角大矢】子辛

三【鈍角余】子甲

四【兩矢較】癸午

四【對邊余】乙已【用余入表得度以減半周得對邊之度】一系距等圏上弧度所分之矢與余與大矢與其半徑或全徑並與大圏上諸數比例俱等

又按前法亦可以算一邊小於象限之三角

於前圖取乙戊丙斜弧三角形用戊鋭角【余角一鈍一鋭】有丙戊大邊足九十度有乙戊邊小於九十度求對戊角之乙丙邊

法從乙作壬已綫爲小邊乙戊之正【以壬戊卽乙戊故】又從乙作庚癸爲對弧乙丙之正【以庚丙卽乙丙故】於是較弧之矢爲夘丙對弧之矢爲癸丙而得兩矢之較爲癸夘則又引戊乙小邊之弧過半徑於子而合大圏於丁分子丙爲戊角之矢子甲爲角之餘法曰丙甲【半徑】與壬已【小邊】若子丙【戊角之矢】與乙壬【兩矢較】也得乙壬卽得癸夘

捷法不用較弧但作壬已爲小弧乙戊之正作庚癸爲乙丙對弧之正其餘癸中又引小邊戊乙分半徑於子得子甲爲戊角之餘

法曰丙甲【半徑】與壬已【小邊正】若子甲【戊角余】與乙巳【對邊余】得乙己得癸甲矣

又於前圖取辛戊乙三角形用戊鈍角【余角並鋭】有戊辛大邊九十度有戊乙邊小於九十度求對戊鈍角之辛乙邊

用防法於乙作壬丑爲乙戊小邊之通作庚癸爲乙辛對弧之正其餘甲癸又引戊乙小邊割丙辛全徑於子分子辛爲鈍角大矢子甲爲鈍角余

法爲甲辛與丑已若子甲與乙巳得乙巳卽得癸甲一半徑甲辛【卽丙辛全徑之半】

二【小邊王】醜已【卽壬醜通之半】

三【鈍角余】子甲

四【對邊余】癸甲【卽乙巳】

若先有三邊而求角則反用其率

一半徑

二小邊余割

三對邊余

四角之餘

一系凡斜弧三角形有一邊足九十度其餘一邊不拘小大通爲一法皆以半徑與正若角之矢與兩矢較也亦若角之餘與對邊之餘

若置大小邊於員周其算亦同

乙丁丙斜弧三角形乙丁

邊適足九十度丁丙邊小

於九十度有丁銳角求

對邊丙乙法於平員邊取

丙丁度作丙已爲小邊之正

又自丙作丙甲過心綫

又作壬夘綫爲丙壬較弧

之正又作庚乙癸綫爲對弧乙丙之正【庚丙卽乙丙故】乙壬爲丁角之矢乙甲爲丁角之餘癸丙爲對弧之矢癸甲爲余夘丙爲較弧之矢夘甲爲余對弧較弧兩矢之較夘癸【亦卽乙辰】

法曰甲丙已壬乙辰乙甲癸三句股相似故甲丙【半徑】與丙已【小邊正】若壬乙【角之矢】與乙辰【兩矢較】亦若乙甲【角之餘】與甲癸【對弧余】

三邊未角法

一半徑壬甲【卽甲丙】二

【小邊余割】甲甲

三【對弧余】癸甲

四【角之餘】乙壬

又於前圖取乙戊丙三角形用戊鋭角【余角一鈍一鋭】有乙戊邊九十度有戊丙大邊求對戊角之丙乙邊用防法自丙作丙已爲丙戊大邊之正卽從丙作丙甲半徑乃於乙點作庚癸爲丙乙對弧之正其餘癸甲而戊乙弧原分乙甲爲戊角之餘法曰甲丙巳句股與乙甲癸相似故甲丙【半徑】與丙巳若乙甲【角之餘】與甲癸【對邊余】

若丁爲鈍角【余角並鋭】用大矢

借前圖作醜乙爲對角之弧

成醜丁乙三角【丁爲鈍角】作

丑甲寅徑又作辛丑較之

正辛午【以辛丁同丁乙故】作

醜乙對弧之正子酉引過

乙至亥成通又作辛未

綫與酉午平行而等較弧之正矢午丑對弧之大矢酉丑相較得酉午【亦卽未辛】乙辛與丁鈍角大矢乙甲爲鈍角余

法曰甲丑已乙辛未乙甲酉三句股相似故甲醜【半徑】與醜已【小邊正】若乙辛【角大矢】與未辛【兩矢較】亦若乙甲【角之餘】與甲酉【對弧余】

又於前圖取乙戊醜形用戊鈍角【三角俱鈍】有乙戊邊九十度有醜戊大邊求對鈍角之醜乙邊

用防法自醜作醜已爲醜戊大邊之正又自丑作醜甲寅全徑又自乙作亥酉爲對邊丑乙之正【以亥丑卽乙丑故】其餘酉甲而乙甲原爲戊鈍角之餘法曰甲醜己句股形與乙甲酉相似故甲醜【半徑】與醜已【大邊正】若乙甲【鈍角余】與甲酉【對邊余】

又設丙乙丁三角形乙爲鈍角【餘一鈍一鋭】乙丙邊小丁乙邊大對邊丁丙大於象限較弧壬丙亦大

於象限

惟對邊較弧俱大於象限故

所得爲兩大矢之較

其正比例仍用小矢以角

爲鋭角也

壬丙較弧之大矢夘丙加後得數午夘爲對弧丁丙之大矢【丁丙卽癸丙故】大矢午丙內減半徑已丙得午已爲余以檢表得庚癸之度以減半周得癸丙之度卽對弧丁丙之度

又法以得數午夘加較弧之餘夘巳得午已爲對弧余【以兩大矢較卽兩余較也餘同上】

若於前圖取丁乙庚三角形則角旁兩邊俱大於象限而對邊小於象限較弧亦小於象限乙爲鈍角【三角俱鈍】有庚乙與丁乙兩大邊而較弧醜庚小故所得爲兩小矢之較其正比例則用大矢以乙爲鈍角故也醜庚爲較弧其正丑亥余亥已對弧庚丁卽庚酉其正酉午餘午已【兩矢較亥午卽余較】

又設丙乙丁三角形

乙爲鋭角【餘一鈍一鋭】

乙丙邊小丁乙邊大對

弧丁丙大於象限較弧壬

丙小於象限所得爲對弧

大矢與較弧小矢之較

其正比例仍用小矢以乙

鋭角故

兩余並卽大矢與小矢之較也

法以得數午夘加較弧之正矢夘丙成午丙爲對弧之大矢午丙內減去半徑已丙得午巳余乃以余檢表得度以減半周得對弧丁丙之度

若於得數內減較弧余弧夘己亦卽得午己余餘如上

又於前圖取丁乙庚三角形乙爲鈍角【三角俱饒】角旁兩邊俱大於象限惟對邊小故用兩正矢較其正比例仍用大矢以鈍角故乙丁弧之通醜壬爲乙丁弧所割成醜丁亦割其戌辛全徑於寅成寅戌爲鈍角大矢而比例等又醜庚爲較弧其正丑亥其矢亥庚對弧庚丁之通酉癸其矢午庚兩矢之較爲亥午

以兩矢較亥午加丑庚較弧之矢庚亥成午庚爲對弧丁庚之矢【以矢減半徑庚已得對弧之餘午巳檢表得丁庚度】

論曰先得數何以能爲句股比例也曰先得數卽距等圏徑之分綫也其勢旣與全徑平行又其綫爲弧綫所分其分之一端必與對弧相防【蓋對弧亦從此分也】其又一端必與較弧相防是此分綫在較弧對弧兩正平行綫之中斜交兩綫作角而爲則兩正距綫必爲此綫之句矣而兩矢之較卽從兩正之距而生故不論大矢小矢其義一也

然則正上所作句股何以能與先得數之句股相似邪曰兩全徑相交於員心則成角各正又皆爲各全徑之十字橫綫則其相交亦必成角而橫綫所作之角必與其徑綫輳心之角等角等則比例等矣大邊小邊之正皆全徑之十字橫綫也較弧對弧之正皆又一全徑之十字橫綫也此兩十字之各綫相交而成種種句股其角皆等

仍於前圖取丁戊庚三角形戊鈍角【余並鋭】三邊俱小於象限戊丁弧之通醜壬正甲壬又引戊丁弧過全徑於寅防於乙則寅戌爲戊鈍角之大矢亦割醜壬通於丁則丑丁與通若寅戌大矢與全徑也又戊庚弧之正庚申爲句則已庚半徑爲其其比例若丑未爲句而丑丁爲也又醜庚爲較弧其正丑亥其餘亥已其矢亥庚對弧庚丁之通酉癸正癸午餘午已其矢午庚兩矢之較爲亥午【對弧小故用兩小矢之較戊鈍角故以角之大矢爲比例並同上條】

兩法並用鈍角其度同所求之庚丁弧又同故其法並同卽此可明三角之理

仍於前圖取丁丙戊三角形有丁丙及戊丙二大邊有丙鋭角【餘一鈍一鋭】求丁戊對邊法引丁丙及戊丙二弧防於庚作庚丙徑作已亢及已戊兩半徑作癸午爲丁丙邊正而丁丙弧割癸午正於丁亦割亢已半徑丁心則亢已之分爲心亢猶癸午之分癸丁也又作戊井爲戊丙弧之正成戊已井勾股形又從丁作壬甲爲對弧戊丁之正其矢甲戊又取癸戊爲較弧【以癸丙同丁丙故】作癸氐爲較弧正其矢氐戊兩矢之較爲氐甲又從丁作斗丁與氐甲平行而等成丁斗癸小句股形與戊已井形相似則已戊與井戊句若癸丁與鬥丁句也【此因對弧小故所得爲小矢之較而用丙鋭角故只用角之正矢爲比例又此因用丙角求戊丁邊故另爲比例若用戊角求丁丙弧則與第一條之法同矣】

以甲氐加較弧之矢氐戊成甲戊爲對弧之矢如法取其度得丁戊

右例以一圖而成四種三角形皆可以入算而諸綫錯綜有條不紊可見理之眞者如取影於燈宛折惟肖也【又丁丙戊三角形亦可以戊角立算餘三角並然丁乙丙形可用丙角庚戊丁形庚乙丁形俱可用庚角】計開

一圖中三角形凡四

一丁乙丙形一丁戊丙形一丁乙庚形一丁戊庚形

全徑凡二

一戊乙徑一庚丙徑

算例凡八

右前四例皆以乙戊徑爲主綫丙庚徑爲加減綫後四例皆以丙庚徑爲主綫乙戊徑爲加減綫

一系凡三角形以一邊就全員則此一邊之兩端皆可作綫過心爲全員之徑而一爲主綫一爲加減綫皆視其所用之角

凡所用角在徑綫之端則此徑爲主綫餘一徑爲加減綫

幾用銳角則主綫在形外用鈍角則主綫在形內凡角旁兩弧綫引長之各成半周必復相防而作角其角必與原角等

凡主綫皆連於所用角之銳端或在形內或在形外並同其引長之對角亦必連於主綫之又一端也若主綫在形內破鈍角端者其引長之鈍角亦然

一系凡兩徑綫必與兩弧相應如角旁弧引長成半周其首尾皆至主綫之端是主綫卽爲此弧之徑也如對角弧引長成半周首尾皆至加減綫之端是加減綫卽爲對弧之徑也主綫旣爲引長角旁一弧之徑又原爲全員之徑而角旁又一弧之引長綫卽全員也故角旁兩弧皆以主綫爲之徑加減綫旣爲對弧之徑而較弧在員周其端亦與加減綫相連又加減綫原爲全員徑故較弧對弧皆以加減綫爲徑

一系凡全徑必有其十字過心之橫徑而正皆與之平行皆以十字交於全徑引之卽成通

主綫旣爲角旁兩弧之徑故角旁兩弧之正通皆以十字交於主綫之上而其餘其矢皆在主綫加減綫旣爲對弧較弧之徑故對弧較弧之正皆以十字交於加減綫而其餘其矢皆在加減綫

一系凡角旁之弧引長之必過橫徑分爲角之矢角之餘若鈍角則分大矢

角旁引長之弧過橫徑者亦過正通故其全與分之比例皆與角之大小矢及余之比例等平儀論論以量代算之理

以橫綫截弧度以直綫

取角度並與外周相應

如艮已弧距極三十度

爲申未橫綫所截故其

度與外周未已相應坎

乙應戌乙亦同又幹乙

弧距極六十度爲醜夘橫綫所截故其度與外周丑乙相應巽已應午已亦同

又如戊已辛角有未戊辰直綫爲之限知其爲六十度角以與外周未午辛之度相應也癸乙子三十度角應子丑度亦然又庚已子鈍角有午夘庚直綫爲之限知其爲百五十度角以與外周午未已申寅子弧度相應也壬乙辛百二十度角應戌乙辰夘辛弧亦然

論曰平儀有實度有視度有直綫有弧綫直綫在平面皆實度也弧綫在平面則惟外周爲實度其餘皆視度也實度有正形故可以量視度無正形故不可以量然而亦可量者以有外周之實度與之相應也何以言之曰平儀者渾體之晝影也置渾球於案自其頂視之則惟外周三百六十度無攺觀也其近內之弧度漸以側立而其綫漸縮而短離邊愈逺其側立之勢益髙其躋縮愈甚至於正中且變爲直綫而與員徑齊觀矣此躋縮之狀隨度之髙下而遷其數無紀故曰不可以量也然而以法量之則有不得而遁者以有距等圈之緯度爲之限也試橫置渾球於案任依一緯度直切之則成側立之距等圈矣此距等圈與中腰之大圈平行其相距之緯度等故曰距等也其距旣等則其圈踓小於大圈而其爲三百六十度者不殊也從此距等圈上逐度作經度之弧其距極亦皆等特以側立之故各度之視度躋縮不同而皆小於邊之眞度其實與邊度並同無小大也特外周則眠體而內綫立體耳故曰不可量而可量者以有外周之度與之相應也此量弧度之法也弧度者緯度也【量法詳後】然則其量角度也柰何曰角度者乃經度也經度之數皆在腰圍之夫圈此大圈者在平儀則變爲直綫不可以量然而亦可以量者亦以外周之度與之相應也試於平儀內任作一弧角

如乙已丙平員內作已丙戊角欲知其度則引此弧綫過橫徑於戊而防於乙則已戊弧卽丙銳角之度戊壬弧卽而

鈍角之度也然已戊壬兩弧皆以視法變爲平綫又何以量其度法於戊防作庚辛直綫與乙丙直徑平行則已庚弧之度卽戊巳弧之度亦卽丙銳角之度矣其餘庚乙壬之度卽戊丁壬弧之度亦卽丙鈍角之度矣故曰不可量而實可量者以有外周之度與之相應也然此法惟角旁弧度適足九十度如戊丙則其數明晣若角旁之弧或不足九十度又何以量之曰凡言弧角者必有三邊如上所疏旣以一邊就外周眞度其餘二邊必與此一邊之兩端相遇於外周而成角此相遇之兩防卽余兩弧起處法卽從此起數借外周以求其度而各循其度作距等橫綫乃視兩距等綫交處而得餘一角之所在遂補作余兩弧而弧三角之形宛在平面再以法量之則所求之角可得其度矣此量角度之法也

今設乙丁丙弧三角形丁丙邊五十○度乙丙邊五十五度乙丁邊六十○度而未知其角

法先作戊巳庚丙平員

又作巳丙及戊庚縱橫

兩徑任以丁丙邊之度

自直綫之左從丙量至

丁得五十○度爲丁丙

邊又自丙左右各數五

十五度如辛丙及子丙皆如乙丙之度乃作辛子綫聯之爲五十五度之距等圈又自丁作夘丁徑綫自丁左右各數六十○度爲癸丁及丑丁皆如乙丁之數亦作醜癸綫聨之爲六十○度之距等圈此兩距等綫相交於乙則乙防卽爲乙丙及乙丁兩邊相遇之處而又爲一角也乃自乙角作乙丙及乙丁兩弧則乙丙丁三角弧形宛然平面矣再以法量之則丁丙兩角亦俱可知欲知丙角卽用辛子距等綫以半綫午子爲度以午爲心作子酉辛半員句分一百八十度此辛子徑上距等圈之眞形也乃自乙防作直綫與午丙徑平行截半員於酉乃從酉數至子得酉子若干度此卽乙丙丁銳角之度以減半周得酉辛若於度亦卽乙丙辛鈍角之度也欲知丁角亦卽用醜癸距等綫以半綫辰癸爲度辰爲心作丑亥癸半員分一百八十度此亦醜癸徑上距等圈之正形也乃自乙防作直綫與辰夘徑平行截半員於亥卽從亥數至癸得亥癸若干度此卽乙丁丙鈍角之度以減半周得亥丑若干度又卽乙丁丑鈍角之度也

計開

丙角七十八度稍弱【以算考之得七十七度五十五分】丁角六十七度三分度之二【以算考之得六十七度三十九分】

右量角度以圖代算【欲得零分須再以算法考之卽知無誤】

又設乙丙丁弧三角形有六十○度丙角有乙丙邊一百○○度有丁丙邊一百二十○度求丁乙邊【對角之邊】法先爲巳戊丙庚大圈作巳丙及庚戊十字徑乃自丙數至辛如所設丁丙邊一百二十○度自丙至子亦知

之作辛十子綫爲一百

二十○度之距等圈

又以距等之半綫辛午

爲度午爲心作辛酉子

半圈勻分一百八十度

乃自辛數至酉如所設

丙角六十度而自酉作酉丁直綫與已甲徑平行至丁遂如法作丁丙邊又自丙數至乙如所設乙丙邊一百○○度又從乙過甲心至夘作大圈徑亦作寅壬橫徑乃補作丁乙邊【乙丙丁三角弧形宛然在目】又自丁作丑丁癸距等綫與寅壬平行未自乙數至癸得若干度卽乙丁之度

計開

丁乙綫五十九度彊【以算考之得五十九度○七分】

右量弧度以圖代算【若用規尺可免逐圈勻分之度有例在後條】

又若先有乙丁對角邊丁丙角旁邊有丙角而求乙丙角旁之邊【仍借前圏】

法先作己戊丙員及十字徑綫又以丁丙邊之度取丙辛及丙子作辛子距等綫又作子酉辛半員取辛酉角度作酉丁直綫遂從丁作丁丙邊皆如前次以所設丁乙邊五十九度倍之作一百十八度少於夲員周取其通【卽距等綫癸丑之度】乃以通綫就丁防遷就遊移使合於外周而不離丁防成丑丁癸綫卽有所乘醜乙癸弧乃以弧度折半於乙則乙丙外周之度卽所求乙丙邊於是補作乙丁綫成三角之象

又法以丁乙倍度之通【醜癸】半之於辰乃從辰作夘甲辰過心徑綫卽割大員周於乙而乙癸及乙丑之弧度以平分而等皆如乙丁度亦遂得乙丙度餘如上又若先有乙丙兩角及乙丙邊在兩角之中【亦仍借前圖】法先作己戊丙員及十字徑綫皆如前乃自丙數至乙截乙丙爲所設之邊次作丙角法於戊庚橫徑如前法求庚亥如所設丙角之度遂從亥防作弧【如丙亥己】則丙角成矣次作乙角法於乙防作乙甲夘徑亦作壬寅橫徑乃自寅至未如前法求寅未如所設乙角之度遂從未防作弧【如夘未乙】則乙鈍角亦成矣兩弧綫交於丁角乃補作丑癸及辛子兩距等綫則弧度皆得【案此兩弧綫必以雞子形作之方凖若丁防離兩橫徑不逺則所差亦不多也】

再論平儀

凡平儀上弧綫皆經度而直綫皆緯度

惟外周經度亦可當緯度又最中長徑緯度亦爲經度平儀上弧綫皆在渾靣而直綫皆在平靣

試以渾球從兩極中半濶處直切之【如用極至交圏爲度以剖渾儀】則成平靣矣以此平面覆置於案而從中腰橫切之【如赤道半圏】則成橫徑於平面矣【如赤道之徑】又以此橫徑爲主離其上下作平行綫而橫切之則皆成距等圏之徑綫於平面矣大橫徑各距極九十度逐度皆可作距等圏卽皆有距等徑綫在平面故曰皆緯度也此綫旣爲距等圏之徑則其徑上所乘之距等圏距極皆等卽任指一防作弧度其去極度皆等故以爲緯度之限也

若又別指一處爲極【如赤道極外又有黃道極又如天頂亦爲極】則其對度亦一極也亦可如前橫切作橫徑【如黃道之徑】於平面其橫徑上下亦皆有九十度之距等圏與其徑綫矣【如黃道亦有緯度】故直綫有相交之用也

凖此觀之渾球之外圏隨處可指爲極卽有對度之極兩極相對則皆有直綫爲之軸軸上作橫徑橫徑上下卽皆有九十度之距等徑綫而相交相錯其象千變而句股之形成比例之用生加減之法出矣【如黃赤兩極外又有天頂地心之極而天頂地心隨北極之髙下而變】又此所用外周特渾球上經圏之一耳若凖上法於球上各經圏皆平切之皆爲大圏則亦可隨處爲極以生諸距等緯綫而相交相錯之用乃不可以億計矣【如天頂地心旣隨極出地度而異其南北亦可因各地經度而異其東西】由是推之渾球上無一處不可爲極故所求之防卽極也何以言之凡於球上任指一防卽能於此防之上作十字直綫以防於所對之防而十字所分之角皆九十度卽逐度可作綫以防於對防而他綫之極此防上綫皆能與之防故曰所求之防卽極也

又論平儀

凡平儀上弧綫皆經度也而弧有長短者則緯度也是故弧綫爲經度而卽能載緯度蓋載緯度者必以經度也若無經度則亦無緯度矣

平儀上直綫皆緯度也而綫有大小者則經度也是故直綫爲緯度而卽能載經度蓋載經度者必以緯度也若無緯度則亦無經度矣【所云直綫指橫徑及其上下之距等徑而言】弧綫能載緯度卽又能分緯度之大小直綫能載經度卽又能分經度之長短

假如平面作一弧引長之其兩端皆至外周則分此外周爲兩半員而各得百八十度卽所作之弧亦百八十度矣此百八十者皆緯度故曰能載緯度也而此平面上所乘之半渾員其經度亦百八十而皆紀於腰圍之緯圏若於腰圍緯圏上任指一經度作弧綫必會於兩極而因此弧綫割緯圏以成角度故又曰能分緯度也不但此也若從此弧綫之百八十度上任取一度作平行距等緯圏其距等圏上所分之緯必小於腰圍之緯圏而其所載距等圏之經度皆與角度等卽近極最小之緯圏亦然何以能然曰緯圏小則其度從之而小而爲兩弧綫所限角度不變也故緯圏之大小弧度分之也

然弧綫之長短又皆以緯圏截之而成而緯圏必有徑在平面上與圏相應故曰直綫能載經度卽又能分經度之長短也

復論平儀

平儀上直綫弧綫皆正形也問前論直綫有正形弧綫躋縮無正形玆何以云皆正形曰躋縮者球上度也然其在平靣則亦正形矣有中剖之半渾球於此覆而觀之任於其緯度直切至平面則皆直綫也而其切處則皆距等圏之半員卽皆載有經度一百八十也從此半員上任指一經度作直綫下垂至平面直立如縣鍼則距等圏度之正也若引此經度作弧以防於兩極則此弧度上所載之緯度一百八十每度皆可作距等圏卽每度皆可作距等圏之正矣由是觀之此弧上一百八十緯度旣各帶有距等圏之正卽皆能正立於平面而平面上亦有弧形矣夫以弧之在球面言之別以側立之故而視爲躋縮而平面上弧形非躋縮也故曰皆正形也惟其爲正形故可以量法禦之也

又

問平儀經緯之度近心濶而近邊狹何也曰渾員之形從其外而觀之則成中凸之形其中心隆起處近目而見大四周逺目而見小此視法一理也又中心之經緯度平鋪而其度舒故見大四周之經緯側立而其度垜壘故見小此又視法一理也若以量法言之則近內之經緯無均平之數數皆紀之於外周外周之度皆以距等綫爲限而近中綫之距等綫以兩旁所用之弧度皆直過與橫直綫所荖少故其間闊近兩極之距等綫則其兩旁之弧度皆斜過與橫直綫縣殊故其間窄此量法之理也固不能彊而齊一之矣夫惟不能彊而齊故正之數以生八綫由斯以出尺算比例之法由斯可以量代算而測算之用遂可以坐天之內觀天之外巳

取角度

又法

設如巳戊丙庚員有子

辛距等緯綫有所分丁

辛小緯綫求其所載經

度以命所求之角【丙角】本法取距等半徑【辛午】作

子酉辛半員從丁作酉

丁綫乃紀酉辛之度爲丁辛之度

今用防法徑於丁防作女丁壬綫與巳甲徑平行再用距等半徑【午辛】爲度從甲心作虛半員截女壬綫於亢卽從此引甲亢綫至癸則數大圈庚癸之度爲丁辛角度【卽丙角也】

解曰試作氐亢房半員其亢甲牛徑旣與午辛等則氐亢房半員與辛酉子等而氐亢房半員又與大員同甲心則庚癸之度與氐亢等卽亦與酉辛等矣

又如先有丙角之度及辛子距等綫而求丁防所在以作丙丁弧

法從大圈庚數至癸令庚癸如丙角之度卽從癸向甲心作癸甲綫【半徑】次以距等之半徑辛午爲度從甲心作半員截癸甲【半徑】於亢乃自亢作亢丁壬綫截辛午於丁卽得丁防

用規尺法

設如乙丁辛弧三角形有乙丁邊六十度有丁辛邊五十度一十分有乙辛邊八十度求辛鋭角

如法依三邊各作圖法以十字剖平員自主綫端辛數

所設丁辛五十度奇至丁乃自

丁作徑綫過已心又依所設丁

乙六十度自丁左數至婁右數

至丙皆六十度作丙婁綫爲距

等圈之徑又自辛依所設辛乙

八十度至房亦左至壬作房壬

距等徑綫此兩距等綫交於乙乃作乙丁及辛乙丙綫則三角形宛然在目今以量法求辛角

法曰房甲距等半徑與乙甲分綫若亢已半徑與辛角之餘寅已

法以比例尺正綫用規器取圖中房甲之度於半徑九十度定尺再取乙甲度於本綫求正等度得角之餘度乃以所得余度轉減象限命爲辛角之度

依法得余三十一度弱卽得辛角爲五十九度彊又法以房甲爲度甲爲心作房癸壬距等半圈又作乙癸正與已辛平行如前以房甲度於正九十度定尺再以乙癸度取正度命爲辛角度

又法作房癸綫用分員綫取房甲度於六十度定尺再取房癸綫於分員綫求等度得數命爲辛角之度更防論曰旣以房甲爲半徑則乙癸卽正乙甲卽余房癸卽分員皆距等圏上比例也其取角度與分半周度而數房癸之度並同然量法較防

又求丁鈍角

法以丙危爲度危爲心作婁醜丙半員又作醜乙綫當角之正則乙危當余

乃取距等半徑丙危度於正綫九十度定尺再取乙危度求得正綫等度命爲鈍角之餘以所得加九十度爲丁鈍角度

依法得余十二度太卽得丁鈍角一百○二度太或取醜乙綫求正綫上度命爲鈍角之正以所得減半周度余爲丁鈍角度【兩法互用相考更確】

又法作婁丑分員綫取丙危半徑於分員綫六十度定尺而求婁丑分員之度分爲丁鈍角【亦可與正法參考】

論曰兼用兩法分員綫一法以相考理明數確然比半周度之工尙爲省力是故量防於算而尺更防矣若兼作丙丑分員以所得度減半周亦同如此則分員綫亦有兩法合之正成四法矣

又論曰此條三邊求角前條有二邊一角求弧可互明也故用圖亦可以求角用尺亦可以求弧智者通之可也

三極通幾

平員則有心渾員則有極如赤道以北辰爲極而黃道亦有黃極人所居又以天頂爲極故曰三極也極云者經緯度之所宗如赤道經緯悉宗北極而黃道經緯自宗黃極地平上經緯又宗天頂亦如屋之有極爲楹桷宇梠楶棁之所宗也旣有三極卽有三種之經緯於是有相交相割而成角度角之鋭端卽兩綫相交之防任指一防而皆有三種經緯之度與之相應焉故可以黃道之經緯求赤道之經緯亦可以赤道之經緯求地平上之經緯以地平求赤道以赤道求黃道亦然舉例如後以黃道經緯求赤道經緯已辰庚斜弧三角形

巳丁乙丙爲極至交圈

巳爲北極丙甲丁爲赤

道庚爲黃極壬甲寅

爲黃道星在辰辰庚

爲黃極距星之緯辰庚

酉角爲黃道經度今求赤道經緯法自辰作黃道距等緯圈【酉辛】又自辰作赤道距等緯圈【戊午】卽知此星【辰】在赤道之北其距緯戊丙【或午丁】次以赤道距等半徑戊夘爲度夘爲心作午未戊半員又作未辰直綫與已甲平行則未戊弧卽爲赤道經度【卽戊巳辰角】

若先有赤道經緯而求黃道經緯亦同

以赤道經緯求地平經緯

巳子戊三角形【三角皆鋭】

戊壬庚辛爲子午規壬

辛爲地平戊爲天頂

巳爲北極丁丙爲赤道

星在子子巳爲星距

北極巳角爲星距午規

經度【卽緯圈上丑子之距】求地平

上經緯法自子作寅亥綫與辛壬地平平行卽知地平上星之髙度亥辛【或壬寅】次作寅酉亥半員【以亥寅半綫亥午爲度午爲心】又從子作酉子直綫與戊甲天頂垂綫平行卽子寅爲星距午方之度爲子戊寅角數酉至寅之弧卽得星在午左或午右之方位是爲地平上之經度【按此圖爲星在夘酉綫之北數酉辰若干度卽知其星距夘酉綫若干度也】若先得地平上經緯【髙度爲緯方位爲經】而求赤道經緯【星距赤道爲緯距午綫時刻爲經】其理亦同

以兩緯度求經度

巳子戊斜弧三角形

假如北極髙三十度【巳辛髙】戊寅壬爲午規太陽

在子距赤道北十度【其距醜丁

或卯丙緯度】子丑爲太陽距

午綫加時經度【卽子巳醜角】寅壬爲太陽髙度【卽亥辛】

求大陽所在之方法以太陽髙度【亥辛或寅壬】作亥寅地平髙度緯綫又以太陽距赤道緯【丑丁卯丙】作丑卯赤道北緯綫兩綫相交於子乃以亥午爲度午爲心作亥酉寅半員【分百八十度】又自子作酉子直綫與戊甲平行截半員於酉則酉至寅之度卽太陽所到方位離午正之度【卽子戊寅外角】若求加時以北極赤緯綫準此求之用子巳戊角

求北極出地簡法【可以出洋知其國土所當經緯西北廣野亦然與地度弧角可以參用】不拘何日何時刻但有地平眞髙度及眞方位卽可得之

法曰先以所測髙度及方

位如法作圖取作平儀上

太陽所在之防【卽地平經緯交處】次查本日太陽在之道南

北緯度用作半徑於儀心

作一小員末自太陽所在

防作橫綫切小員而過引長之至邊此卽赤緯通也乃平分通作十字全徑過儀心卽兩極之軸數其度得出地度

假如測得太陽在辰髙三十四度方位在正卯南三度彊而不知本地極髙但知本日太陽赤緯十九度今求北極度

如法作圖安太陽於辰【詳下文】先作丙丁綫爲地平髙度次用法自正東卯數正度至辰得近南三度爲地平經度【或以丙卯爲半徑作半規取直應度分亦同】次依本日太陽赤緯十九度【以員半徑取庚甲十九度正】爲小員半徑作子庚小員末自太陽辰作橫綫戊壬切小員於庚乃自庚向甲心作大員徑綫已午則已卽北極【數己丑之度爲極出地度】依法求得本地極髙四十度

論曰此法最簡最眞然必得正方案之法以測地平經度始無錯誤

歷算全書卷九

欽定四庫全書

歷算全書卷十

宣城梅文鼎撰

環中黍尺卷三之四

初數次數法【加減代乘除之法從初數次數而生故先論之】

【上卷之法用角旁兩正相乘今則兼用兩余故別之爲初數次數其法有二其一次數與對弧余相加其一相減也相加又有二一鋭角一鈍角也相減有四或余內減次數或次數內減余而又各分銳角鈍角也】

約法三邊求角

角求對邊

余次數相加例【銳角法鈍角法各一】

丁乙丙形有三邊求乙銳角角旁大弧丁巳【正辛戊余巳戊】小弧丙乙【正丙癸余巳癸】兩正相乘全數除之成初得數戊庚又以兩余相乘全數除之成次得數戊丑【卽卯巳】乃以次得數卯巳加對弧之餘已戌成卯戌【卽申戊】

一初得數

戊庚

二【次得數與對弧余相並】申戊

三半徑

亥已

四角之餘已幹

【以余檢表得乙銳角之度】

若先有角求對邊則反之

一半徑

亥巳

二角之餘巳幹

三初得數

戊庚

四【次得數與對弧余相並】申戊【以次得數戊醜減之得對弧余丑申卽巳戌】

論曰辛戊正與亥巳半徑同爲乙丁弧所分則辛戊全與丁戊分若亥巳全與幹巳分也而辛戊與丁戊小又若戊庚句與申戊小句也故戊庚與申戊必若亥巳與幹巳

若用丁甲丙形其算並同何以明之甲丁者乙丁半周之餘甲丙者乙丙半周之餘其所用正並同又同用丁丙爲對角之弧甲角又同乙角皆以干已爲余故也

右系對邊小於象限角旁弧異類故其法用加而爲銳角

仍用前圖取丁甲寅三角形有三邊求甲鈍角角兩旁弧同類對角邊大爲寅丁其正酉戌余戌已旁弧丁甲其正辛戊余已戊又旁弧寅甲其正寅壬余壬已初得數戊庚【半徑除兩正矩】次得數卯巳【半徑除兩余矩】

所用三率與前銳角形並同亦以卯已加已戌成申戊爲三率所得四率幹已亦爲甲角之餘【末以余檢表得度以減半周餘爲甲鈍角之度】

若先有甲鈍角求對邊丁寅則反用其率一半徑亥已二甲角余幹已三初數戊庚四申庚末以次數戊醜去減得數甲戊余丑申爲對弧余

論曰對弧寅丁系過弧與銳角形對弧丁丙相與爲半周之正余度同用酉戌爲正戌已爲余角旁弧丁甲卽乙丁半周之餘度同用辛戊爲正戊已爲余甲寅弧又與乙丙弧等度其正壬寅同癸丙余壬巳同癸巳故加減數並同所異者對弧大而兩旁弧又同類故爲鈍角

若用寅乙丁形其算並同以同用丁寅對弧而兩弧在角旁者寅乙爲寅甲半周之餘丁乙爲丁甲半周之餘所用之正余並同故也甲角同乙角皆以干已余度轉減半周爲其度

右系對邊大於象限而角旁兩弧同類故其法用加而爲鈍角

正余交變例

若角旁兩邊以象限相加減而用其餘弧則正余之名互易而所得初數次數不變三率之用亦不變解曰弧小以減象限得余弧弧大以象限減之而用其餘亦余弧也其故何也凡過弧與其減半周之餘度同用一正故過弧內減象限之餘卽反爲過弧之餘弧亦曰剰弧而此剰弧之正卽過弧之餘也

若兩弧內一用余度則其初數次數皆爲正乘余半徑除之之數然其數不變何也一弧旣用余度則本弧之正變爲余弧之餘而其又一弧仍系本度則正不變然則先所用兩正相乘爲初數者今不變而爲余乘正乎次數仿此

試仍以前圖明之丁乙丙形任以乙角旁之乙丁弧【卽辛乙】內減去亥乙象弧其剰弧亥辛之正戊已卽乙辛過弧之餘也又亥辛之餘辛戊卽過弧乙辛之正也然則先以辛戊正乘丙癸正者今不變爲辛戊余乘丙癸正乎然但變其名爲余乘正而辛戊之數不變則其所得之初數戊庚亦不變也次數仿論【按此法卽測星時第二法所用】

若角旁兩弧俱攺用余弧則初數變爲兩余相乘次數變爲兩正相乘蓋以正變余余變正而所得之初數次數不變

試仍以前圖明之丁乙丙形乙角旁兩弧乙丁攺用辛亥【義見前】乙丙攺用丙亥皆余弧也則丙癸辛戊兩正皆變余【丙癸爲丙亥弧余辛戊爲辛亥弧余】癸已戊已兩余皆變正【癸已爲丙亥弧正戊巳爲辛亥弧正】然則先以兩正相乘者今爲兩余然𨿽變兩余而其爲丙癸與辛戊者不變故其所得之初數戊庚亦不變也次數仿論

總例

凡弧度與半周相減之餘則所用之正同余亦同

凡弧度與象限相減之餘則所用之正變余余變正

余內減次數例【鈍角法銳角法各一】

丁乙丙弧三角形有三邊

求乙鈍角丙乙小弧其

正丙辰余辰巳丁

乙大弧其正癸甲余

甲已是爲角旁之兩弧

不同類癸幹初得數【兩正】

【乘半徑除之數】午已次得數【兩余乘半徑除之數】丁丙對邊大其正壬卯余卯已對邊大於象限而角旁弧不同類宜相減對弧余大於次數法當於余卯巳內減去次得數午已余午卯【卽艮丁】爲二率

一初得數癸幹

二【次得數減余】艮丁

三半徑

辛已

四角余寅已

對邊大角旁弧異類而次數小減對弧余其角爲鈍宜以四率寅已撿余表得度以減半周度其餘卽爲乙鈍角之度【卽寅酉大矢之度】

若先有乙鈍角求對弧則反用其率

一半徑

辛巳

二角余寅已

三初得數癸幹

四【次得數減余】艮丁

旣得艮丁乃以次數加之成卯已余檢表得度以減半周得丁丙對邊之度

凡過弧與其減半周之餘度同用一餘故以余檢表得度以減半周卽得過弧

仍用前圖取銳角

丁戊庚三角形【系銳角○此形有三銳角】有三邊求戊角戊庚小邊其正庚丑余醜巳丁戊次小邊其正癸甲余甲巳是爲角旁弧同類初得數癸幹【半徑除兩正矩】次得數午已【半徑除兩余矩】丁庚對邊小其正壬卯余卯巳對邊小於象限而角旁弧同類宜相減次數午已小於對弧余卯已以午已去減卯已余

卯午【卽艮丁】

一初得數癸幹

二【次得數減余】艮丁

三半徑

辛已

四角余寅已

對邊小角旁弧同類而次數小去減余其角爲銳宜以四率寅已檢余表得戊銳角之度

若先有戊銳角度求對邊丁度則反用其度

一半徑

辛巳

二角余寅已

三初得數癸幹

四【次得數減余】艮丁

以所得艮丁加次數午已檢余表得丁庚對邊之度因銳角角旁弧同類次數小於余得數後宜加次數爲對邊余

論曰丁戊庚形與丁乙丙形爲相易之形故丁戊爲丁乙減半周之餘戊庚等乙丙此兩弧所用之正余並同則初數次數亦同矣而丁庚對弧亦丁丙對弧減半周之餘則所用余邊又同加減安得不同

次數內轉減余例【銳角法鈍角法各一】

丁乙丙形三邊求乙角【系銳角】丙乙小邊正辰丙余辰已丁乙大邊正癸甲余甲已是爲角旁之兩邊不同類初得數甲幹【半徑除兩正矩】次得數午

已【半徑除兩余矩】丁丙對邊

大正壬卯余卯已

對邊大而角旁弧不同類

宜相減次數午已大於

對弧余卯已法當於午

己內減卯巳余午卯【卽甲艮】

爲二率

一初得數

甲幹

二【余減次數之餘】甲艮

三半徑

辛巳

四角余

寅已

對邊大角旁弧異類而次數大受對弧余之減其角爲銳宜以四率寅已檢余表得乙鋭角之度【卽寅辛矢度】若先有乙角而求對邊丁丙則反用其率

一半徑

辛巳

二角余

寅己

三初得數

甲幹

四【余減次數之餘】甲艮

末以所得甲艮轉減次數午已得對弧余卯巳檢表得度以減半周爲對弧丁丙度

前圖取鈍角

丁戊庚形三邊求戊角【系銳角】戊庚小邊正醜庚余丑巳丁戊次小邊正癸甲余甲巳是爲角旁兩弧同類初數甲幹【半徑除兩正矩】次數午已【半徑除兩余矩】丁庚對邊小正壬卯余卯巳對邊小而角旁兩弧同類宜相減次數午巳大於對邊余卯巳當於午巳內減卯已余午卯【卽甲艮】

一初得數

甲幹

二【余減次數之餘】甲艮

三半徑

辛巳

四角余

寅已

對邊小角旁弧同類而次數大內減去余其角爲鈍宜以四率寅巳檢余表得度以減半周得戊鈍角之度

若先有戊鈍角而求對邊丁庚則反用其率

一半徑

辛已

二角余

寅巳

三初得數

甲幹

四【余減次數之餘】甲艮

末以所得甲艮轉減次數午巳得對弧余卯已檢表得對弧丁庚之度

一系半渾員面所成斜三角形左右皆相對如左銳角者右必鈍也對邊左小者右必大也角旁之邊左爲同類者右必異類也【角旁兩弧一居員周一居圓面此員面弧綫左右所同用也而員周之弧左右有大小故同於左者不同於右】

加減法【以代乘除】

初數次數並以乘除而得今以總弧存弧之餘相加減而半之卽與乘除之所得脗合法簡而妙而甲數乙數之用亦從此生矣

總法曰凡兩弧相並爲總弧相減爲存弧【存弧一曰較弧】總弧存弧各取其餘以相加減成初數次數法曰視總弧過弧限則總存兩余相加總弧不過象限則相減皆折半爲初數【卽原設兩弧之正相乘半徑除之之數】以初數轉減存弧余卽爲次數【卽原設兩弧之餘相乘半徑除之之數】又法【總弧過象限兩余相減不過象限則相加並折半爲次數】又法【初數以相加成者以總弧余減初數以相減成者以總弧余加並加減初數爲次數亦同】

又取總弧存弧之正相加減成甲數乙數法曰以總存兩正相加折半爲甲數【卽原設大弧正乘小弧余半徑除之之數】總存兩正相減折半爲乙數【卽原設小弧正乘大弧余半徑除之之數】又法【以存弧正減甲數其餘爲乙數亦同】又法【以甲數減總弧正卽得乙數】

總弧在象限內兩余相減

大弧丙寅小弧辰丙【卽丑丙】二弧相加爲總弧辰寅相減得存弧丑寅丑寅存弧之餘醜癸【亦卽丁乙】

辰寅總弧之餘卯辰【卽癸子亦卽乙午】兩余相減【醜癸內減

子癸存丑子或乙丁內減乙午存午丁】其餘

半之【丑子半之於壬成壬丑卽亥丁】爲【丙寅

辰丙】二弧兩正相乘半徑

除之之數卽初得數也

以初得數轉減存弧之餘

【以壬醜減醜癸其餘癸壬亦卽亥乙】其餘

爲大小二弧兩余相乘半徑除之之數卽次得數也論曰丙辛大弧之正也醜戊小之正也以句股形相似之故乙丙半徑【】與丙辛正【股】若醜戊正【小】與醜壬初得數也【小股】其半而得者何也曰辰戊同丑戊則戊巳亦同丑壬而壬子卽已戊則子丑者初得數【壬醜】之倍數故半之卽得辛乙大弧之餘也戊乙小弧之餘也乙丙半徑【】與辛乙余【句】若戊乙余【小】與亥乙次得數也【小句】又以存弧余內兼有初得次得兩數故減初得次也【醜癸余內有醜壬初數癸壬次數故減醜壬卽得癸壬也或於乙丁內減亥丁得亥乙並同】

以上用總存兩余加減

又丑寅存弧之正丑丁【卽午子或癸乙】辰寅總弧之正辰午【卽卯乙】兩正相加半之爲大弧正乘小弧余半徑除之之數卽甲數也以甲數轉減總弧之正【以午已減辰午其餘巳辰亦卽卯未】是爲大弧余乘小弧正半徑除之之數卽乙數也

論曰乙辛大弧之餘也辰戊小弧之正也以兩句股形同比例之故丙乙半徑【】與乙辛余【句】若辰戊正【小】與辰已乙數也【小句】

又丙辛大弧之正也戊乙小弧之餘也而丙乙半徑【】與丙辛正【股】若戊乙余【小】與戊亥甲數【小句】也又以總弧正內兼有甲乙兩數故減乙得甲減甲亦得乙矣【辰午正內有辰巳乙數巳午甲數故減辰巳得巳午若減巳午亦必得辰巳】

以上用總存兩正加減

若以酉丙爲大弧丙醜爲小弧則其總弧酉丑【正醜丁余丑癸】其存弧辰酉【正辰午餘卯辰】但互易存總之名其他並同論曰凡過象限之弧與其減半周之餘弧同用一正如丙酉過弧以減半周得丙寅所用正【丙辛】余【辛乙】皆丙酉弧與丙寅弧之所同也故但易總存之名而正余加減之用不變又法凡過象限之弧卽截去象限用其餘度如法加減但以總弧爲存弧存弧爲總弧而總存之餘爲正正爲余如酉丙過弧截去酉甲象限只用丙甲爲大弧與丙醜小弧相加減則醜甲爲總弧其正醜癸余丑丁而辰甲爲存弧其正卯辰余辰午是總存正余名皆互易也法以總存兩正相減而其餘折半爲甲數【丑癸內減卯辰余丑子半之得丑壬爲甲數】仍以甲數轉減總弧正【甲數醜壬轉減醜癸其餘癸壬卽乙數】是其名𨿽易而其實不易也但橫易爲直

論曰去過弧之象限而用之則過弧之正爲余余爲正矣故加減而得之數皆兩弧之正乘余余乘正之數而非復正乘正余乘余之數也何也過弧之正余互易而小弧之正餘如故也

如丙酉過弧去象限爲丙甲則其正丙庚卽過弧之餘也【丙庚卽辛乙故】其餘庚乙卽過弧之正也【庚乙卽丙辛故】而小弧丙醜之正醜戊余戊乙皆如舊故先得之醜壬爲大弧余丙辛乘小弧正醜戊而丙乙半徑除之也非兩正相乘也乙數轉減正而得之亥乙【卽癸壬亦卽戊未】爲大弧正辛乙乘小弧余戊乙而半徑除之也非兩余相乘也

又論曰又法卽測夜時篇中測星距午之第二法也加減代乘除只此一例而絕不與七卷八卷之乘除求初數次數者相𨿽有學者何從悟入乎愚故爲之詳說以發其覆

又論曰元法依圖直看直者正橫者余又法正余互易則圖當橫看變立體爲眠體本以總存兩余加減者變爲兩正加減然其數並同

又論曰又法是用大之餘度而小弧則用元度何以言之測星條用星之赤緯卽去極之餘度也其用赤道髙則極去天頂之元度也然而赤緯在南者則是於星去極度截去象限之數也何以亦爲余度曰過弧旣與其減半周之餘度同一正則此減半周之餘度亦卽正弧也然則此截去象限而餘者非卽正弧之餘度乎大弧過象限若干度與不及象限若干度其正並同故加減可通爲一法【此又測星條用法之意】

約法

兩弧俱用本度或俱用余度相加減以取總存二弧是兩正或兩余也則用總存兩余加減法取初得數惟視總存二弧俱在一象限則相減或分跨兩象限則相加皆以初數減存弧之餘爲次得數

若兩弧內有一過弧則總弧之正小於存弧而余反大當以初數減總弧之餘爲次數

若一弧用本度一弧用余度相加減以取總存之弧是一正一餘也則用總存兩正加減法其加減皆眎兩正原法或加或減取甲數卽以甲數減總弧正余爲乙數

若過弧節去象限而用其剰度與余度同法【凡余度是以本度減象限而得名今反以象限減過弧故別之曰剰】

若兩俱剰弧與兩余弧同法

若只一剰弧與一正一餘同法

論曰過弧用剰度爲余弧其法甚簡快凡過弧皆當用之可不用本度矣【算普天星經緯歲差宜此】

又按凡存弧之餘內兼有兩正相乘兩余相乘兩數卽初次兩得數也凡總弧之正內兼有此正乘彼余彼正乘此余之數卽甲乙兩數也故易其名以別之也

大弧寅丙正丙辛余

辛乙小弧辰丙【卽丑丙】正

辰戊【卽丑戊】余戊乙

二弧相加爲總弧辰寅正

辰午餘午乙相減

爲存弧丑寅正丑丁余

丁乙存總兩余【午乙丁乙】相並成午丁半之於亥成亥丁卽初得數大小二弧兩正【丙辛辰戊】相乘半徑除之之數也以初得數亥丁轉減存弧之餘丁乙余亥乙卽次得數大小二弧兩余【辛乙戊乙】相乘半徑除之之數也

論曰以句股形相似之故丙乙半徑與丙辛正若戊醜正與初數丑壬【卽亥丁】也皆比股也

又丙乙半徑與辛乙余若戊乙余與次數亥乙也皆比句也

以上用總存兩余加減因總弧跨過象限故相加

又存弧正醜丁與總弧正辰午相加成辰幹【以午干等丁艮亦卽丑丁也】折半得巳午【卽戊亥辰子折半爲巳子子幹折半爲午子合之成巳午】爲甲數大弧正丙辛乘小弧余戊乙半徑丙乙除之也

以甲數已午轉減總弧正辰午餘辰巳爲乙數大弧余辛乙乘小弧正辰戊半徑丙乙除之也

以上用總存兩正加減

若用酉丙過弧爲大弧丙醜爲小弧則其總弧酉丑存弧酉辰但互易存總之名其它並同以過弧酉丙所用之正丙辛余辛乙卽丙寅弧所同用故也

又法

於酉丙過弧內截去象限酉甲只用其剰弧甲丙則甲丙反爲小弧丙醜反爲大弧【說見前條】

圖式三

總弧在象限內兩余相

減乙丙小弧其正丙

辰余辰已丁乙稍大

弧其正丁甲余甲巳

戊壬初得數【兩正相乘半徑除】

【也卽庚甲或戊卯】午戊次得數

【兩余相乘半徑除也卽巳癸】今攺用加減以省乘除以二弧相加成總弧丁丙其正子丁余子巳又二弧相較成存弧壬丙其正壬辛【卽午巳】余辛巳【卽壬午】

於存弧之餘辛巳內減去總之餘巳子存子辛半之於癸得子癸及辛癸皆初得數也亦卽戊壬也【或於壬午丙減午卯半之於戊得卯戊及戊壬亦同亦卽庚甲也】又於存弧余辛已內仍減去初得數辛癸存癸已卽次得數也【壬午內減戊壬存午戊亦同】

此因總弧在象限內故以總弧余減存弧余求初數是初數小於次數

解曰以句股形相似之故己丙半徑【】與丙辰正【句】若丁甲正【】與甲庚初數也又壬甲等甲丁故庚甲亦等戊壬而戊卯卽庚甲故可以半而得之也

又已丙半徑【】與辰已余【股】若甲已余【】與巳癸次數【股】也

右系總存兩余用法

又丁庚爲甲數【丁甲大弧正乘辰巳小弧余半徑除之也亦卽庚卯卽甲戊】子庚爲乙數【辰丙小弧正乘甲巳大弧余半徑除之也卽癸甲】

今攺用加減法以存弧正子卯【卽辛壬】加總弧正子丁成卯丁而半之於庚得丁庚爲甲數【亦卽庚卯卽戊甲】仍於總弧正丁子內減去甲數丁庚存子庚【卽癸甲】爲乙數

此亦總弧在象限內亦總存兩正相加求甲數是甲數大於乙數

解曰以句股形相似之故已丙半徑與辰巳小弧余若丁甲大弧正與甲數丁庚皆與股之比例也又丁甲等壬甲故戊甲亦等丁庚而戊甲卽庚卯故可以半而得之也

又巳丙半徑與丙辰小弧正若甲已大弧余與乙數甲癸【卽子庚】皆與句之比例也

右系總存兩正用法

一系凡兩弧內無過弧則存弧之餘大故其中有初次兩數而總弧則正大故其中有甲乙兩數𨿽兩數相加能令總弧跨過象限此理不變余仍系存弧大正仍系總弧大

總弧過象限兩余相加

乙丙小弧正辰丙余

辰已乙丁過弧正

丁甲余甲已初得數

戊丁【半徑除兩正矩卽子癸亦卽癸辛亦卽

庚甲】次得數癸巳【半徑除兩余矩】

今用加減代乘除以二弧相加成總弧丁丙正丁子余子已又二弧相較成存弧壬丙正壬辛余辛巳乃以總存兩余相加成子辛【子巳加辛巳】而半之於癸得子癸及癸辛【亦卽丁戊卽庚甲】初得數也又以初數子癸轉減總弧之餘子已余癸巳次得數也【此因總弧跨過象限故兩余相加求初數是初數大於次數】

解曰以句股形相似故半徑已丙與正丙辰若正丁甲與初數丁戊皆與股之比例也又半徑丙已與余辰已若余甲巳與次數癸已皆與句之比例也又壬甲等丁甲則庚甲亦等戊丁而辛癸亦等子癸故半而得

右用總存兩余加減

又甲數醜甲小弧余辰已乘過弧正丁甲半徑除之也乙數癸甲小弧正辰丙乘過弧余甲巳半徑除之也

今用加減總存兩正相加成醜戊【癸戊與正丁子等丑癸與正辛壬等故以相加卽成醜戊】半之於甲得醜甲【亦卽甲戊】爲甲數仍以甲數醜甲轉減存弧正醜癸余癸甲爲乙數【或以總弧正癸戊減甲數甲戊亦卽得乙數癸甲】

此亦總弧跨象限外仍系總存兩正相加求甲數【甲數仍大於乙數】

解曰半徑丙已與小弧余辰已若大弧正丁甲與甲數醜甲皆以比句也又半徑丙已與小弧正辰丙若大弧余甲巳與乙數癸甲皆以比股也又壬甲等丁甲則甲戊亦等壬庚而壬庚卽醜甲故半之而得

右用總存兩正加減

一系凡兩弧內有過弧者總弧之餘反大故初次兩數皆在總弧余內而總弧之正反小故甲乙兩數皆在存弧正內也【此必原有一過弧始用此例非謂總弧過象限也觀圖自明】

甲數乙數用法【黃赤道經緯相求】

黃赤二道經緯相求用斜弧三角形以星距黃極爲一邊星距北極爲一邊並兩極之距爲三邊此本法也今不用距極度而用其餘度【距極度本爲緯度之餘今用三角形以距極度爲邊故緯度皆爲余度】徑取黃緯爲一邊【此先有黃緯而求赤緯也若先有赤道而求黃道卽用赤緯爲邊】二至之黃赤大距爲一邊【黃赤大距原與兩極之距等】而取二邊之總存兩正爲用以加減省乘除故在本法爲初數次數者別之爲甲乙數焉甲數乙數不止爲求黃赤而舉此爲式其理特著故命之曰甲數乙數用法實黃赤相求簡法矣

第一圖黃緯小於黃赤大距甲數大乙數小

甲丙亢危大圈爲過

兩極之經圈【卽二至經圈】心乙亢軸卽黃道

二分經綫丙乙室

爲黃道心爲黃極

寅乙危爲赤道

甲爲北極辰胃婁

爲黃道北緯【卽丙辰之度】丑尾奎爲黃道南緯【卽丙醜之度】星在箕箕心爲星距黃極緯度箕女爲星距黃道緯【卽丙辰之度】甲心箕銳角爲黃道經度其餘女乙甲心爲兩極相距【二十三度三十一分半】寅丙爲夏至距緯【同甲心之度】

今求甲箕爲星距北極緯度其餘弧箕翌爲星距赤道緯【卽氐危之度】

用甲心箕三角形有心角【黃道經】有心箕弧【星距黃極緯】有甲心弧【爲兩極之距】而求對角弧甲箕【星赤道北極緯】

依加減代乘除攺用寅丙夏至距【卽心甲】辰丙黃道緯【卽心箕之餘箕女又卽丙丑度】寅丙辰丙相加爲總弧辰寅其正辰午又相減爲較弧丑寅其正丑丁【亦卽丁井亦卽午昴亦卽子午】以丑丁正【卽午昴】加辰午正成辰昴折半得巳午

甲數【巳子爲辰子之半子午爲子昴之半合之成巳午】甲數【巳午】轉減正【辰午】余【巳辰】爲乙數

或以醜丁正【卽子午】減辰午正余辰子折半得辰巳爲乙數以乙數轉減總弧正辰午得已午爲甲數亦同

法爲黃道半徑【丙乙】與心角之餘【女乙】若甲數【巳午】與四率【斗未】也

一黃道半徑丙乙

二心角余女乙

三甲數

巳午【卽戊酉】

四【減過乙數之赤緯正】斗未【卽虛栁】

論曰丙乙半徑與女乙余原若辰胃與箕胃【辰胃者箕心黃緯之正卽距等圏半徑因箕心角綫過箕至女分辰胃正於箕亦分丙乙半徑於女故丙乙與女乙若辰胃與箕胃皆全與分比例】而辰胃同戊乙箕胃同斗乙皆也【戊酉乙大句股以戊乙爲戊酉爲句斗未乙小句股以斗乙爲斗未爲句】戊酉【同巳午】斗未皆句也則其比例等故丙乙與女乙能若戊乙與鬥乙亦卽若已午與鬥未

以乙數【辰巳卽箕虛】加四率【斗未卽虛栁】成箕栁卽所求赤道緯度正檢表得赤緯在北【卽箕翌亦卽氐危】

若先有赤緯黃緯而求黃經則互用其率以三四爲一二法爲甲數【戊酉】與赤緯正內減乙數之斗未若黃道半徑【丙乙】與心角黃經度之餘【女乙】也

一甲數

戊酉【卽午巳】

二【乙數箕虛減赤緯正】半未【卽虛栁】

三黃道半徑丙乙

四心角余女乙

檢余表得心角之度假如前圖星在尾爲黃道南緯則所用之甲數乙數並同所得之四率亦無不同而赤緯迥異

何以言之曰心不在箕而在尾則心

甲弧【兩極距度】心角【黃道經度】皆不變惟尾心

弧大於箕心故甲心箕三角形變爲

甲心尾三角而所求對角之甲尾弧

亦大於甲箕故赤緯異也

然則所用之甲數乙數又同何也曰尾心爲過弧則用在女尾【尾心內減去女心象限】女尾爲黃道南緯與箕女北緯同度亦卽同正則相加爲總弧相減爲較弧亦同而甲乙數不得不同矣而三率算法亦必同矣但所得四率在北緯則用加在南緯則用減緯度迥異理勢自然也一黃道半徑丙乙

二心角余女乙以乙數【辰巳】減四率斗未減盡三甲數

已午無餘爲星在赤道無緯度四【加過乙數之赤緯正】斗未

論曰此因乙數與四率同大故減盡也減盡則甲尾正九十度而星在赤道無緯也

亦有四率小於乙數者則當以四率轉減乙數用其餘爲緯度正在赤道南

又論曰星在箕爲黃道北在尾爲黃道南然所得赤緯皆在北者以箕尾經度皆在夏至前後兩象限中也故所得四率在赤道北而加乙數則北緯大減乙數則北緯小皆北緯也惟四率轉減乙數則變爲南緯【此亦惟黃南緯星又近二分則𨿽在夏至前後象限中而有南緯】

亦有無四率者心角必九十度其星必在黃道二分經度無角度余爲次率故亦無第四率可求但以乙數爲用視星在南北卽以乙數命爲南北緯度之正假如前圖中有星在胃是在北也卽以乙數胃張【卽辰巳】命爲赤道北緯之正若星在房是在南也卽以乙數乙癸【亦卽辰巳】命爲赤道南緯之正

又有所得四率北反用減南反用加者心角必爲鈍角其星必在冬至前後兩象限其角度余必爲大矢內減儀象限之餘則所得第四率在赤道之外【外卽南也】而加減後所得皆赤道之南緯也故加減皆反【求北緯以加而南緯必減者星在北也求北緯以減而南緯必加者星在南也蓋所得第四率原系在北在南兩星緯度之中數星在北在南皆主黃道言】假如前圖中有星在兌爲黃道北而甲心兌三角形心

爲鈍角其餘艮乙爲艮丙大矢內

減象限之餘故所得第四率未斗在

赤道之外爲赤道南緯【此南緯是黃道軸距赤道

軸】而兌星在黃道之北則其南緯正

小於未斗故必以乙數牛斗【卽辰己亦卽奎巳】減之其餘牛未【同兌庚】卽兌星赤道南緯之正

若星在巽亦同用心鈍角爲甲心巽三角形艮乙余四率未斗在赤道外並同但巽星又在黃道之南則其南緯大於未斗四率故必以乙數虛巽【卽辰巳亦卽牛斗】加之成巽栁卽巽星南緯之正

亦有四率小於乙數者則以四率轉減乙數用其餘爲緯度在赤道北

又論曰星在兌爲黃道北在巽爲黃道南然所得赤緯皆在南者以兌巽經度皆在冬至前後兩象限中也故所得四率在赤道南而以乙數減則南緯小以乙數加則南緯大皆南緯也惟四率轉減乙數者則變爲北緯【此亦必黃北緯星又近二分故𨿽在冬至前後象限中而仍有北緯凡以乙數及四率相加減成緯度者並主緯度之正而言後仿此】

總論曰凡乙數皆南北兩赤緯度相減折半之數甲數則兩緯度之中數也【如箕女與女尾兩黃緯同度而不能以女庚爲兩赤緯之中數者弧度有斜正故也】而所得四率卽所求星南北兩緯正中數故與甲數爲比例

凡所得四率星在夏至前後兩象限四率在赤道北星在冬至前後兩象限四率在赤道南

凡總弧正內兼有甲數乙數【不論黃南黃北並同一法】但視黃緯之大小若黃緯小於黃赤大距則以總存兩正相並而半之爲甲數若黃緯大於黃赤大距則以總存兩正相減而半之爲甲數並以甲數轉減總弧正爲乙數又法

黃緯小於黃赤大距以總存兩正相減而半之則先得乙數黃緯大於黃赤大距以總存兩正相並而半之亦先得乙數並以乙數轉減總弧正爲甲數求赤緯約法

凡星有黃緯之南北有黃經之南北【黃經南北卽南六宮北六宮星在夏至前後先得之黃經爲鋭角是經在北也星在冬至前後先得之黃經爲鈍角是經在南也】若星之黃緯南北與黃經同者其赤緯南北亦與黃緯同法用四率乙數相加爲緯度正加惟一法

星在黃道北又系夏至前後兩象限先得黃經鋭角是經緯同在北則赤緯亦在北星在黃道南又系冬至前後兩象限先得黃經鈍角是經緯同在南則赤緯亦在南

若星之黃緯南北與黃經異者赤緯有同有異皆四率乙數相減爲赤緯正減有二法

但視乙數大受四率轉減者赤緯之南北與黃緯同如星在黃道北而在冬至前後兩象限黃經角鈍是緯北而經南也而乙數大受四率轉減則赤緯仍在北星在黃道南而在夏至前後兩象限黃經角鋭是緯南而經北也而乙數大受四率轉減則赤緯仍在南若乙數小去減四率者赤緯之南北與黃緯異如星在黃道北而在冬至前後黃經角鈍爲緯北經南而乙數又小去減四率則赤緯變而南星在黃道南而在夏至前後黃經角鋭爲緯南經北而乙數又小去減四率則赤緯變而北

若星在黃道軸綫是正當二分經度也其角必九十度無餘亦無四率但以乙數爲用星在北卽以乙數命爲赤道北緯之正星在南卽以乙數命爲南緯之正

若遇乙數四率相減至盡者其星正當赤道無緯度第二圖黃緯大於黃赤大距甲數小乙數反大【有黃道經緯求赤緯】

甲北極心黃極

甲心爲兩極之距

丙室黃道寅危赤

道寅丙爲夏至大

距【同甲心】乙爲二分

以上並與前圖無

二所異者黃緯丙

丑【卽丙辰】大於寅丙故

乙數亦大於甲數寅丙之正丙辛余辛乙丙丑之正辰戊【或戊醜】余戊乙

甲數戊酉乃寅丙正乘丙醜余半徑除之也法爲丙乙半徑與正丙辛若戊乙余與甲數戊酉乙數辰巳【或巳子或戊壬】乃辛乙余乘辰戊正半徑除之也法爲丙乙半徑與余辛乙若辰戊正與乙數辰巳

假如星在箕爲在黃道北箕心爲距黃極之度其餘箕女黃道北緯也有箕心甲心【兩極距】二邊有心銳角【黃經】用甲心箕三銳角弧形求赤緯甲箕爲對角之弧

依加減代乘除攺用寅丙辰丙二弧相加爲總弧辰寅其正辰午又相減成較弧寅丑其正丑丁【卽午子】以丑丁正加辰午正成辰子折半於巳爲乙數【辰巳及巳子】乙數辰已轉減總弧正辰午得已午爲甲數【卽戊酉】

本法以丑丁減辰午折半得已午爲甲數甲數巳午轉減辰午得辰巳爲乙數

法爲黃道半徑丙乙與余女乙若甲數戊酉與四率斗未也【理見前式論見】

一黃道半徑丙乙

旣得斗未以乙數箕

二心角余女乙

虛加之成箕栁爲赤

三甲數

戊酉

緯正查表得箕翌四【以乙數減赤緯正】斗未【卽虛栁】赤緯度在赤道北右系黃緯在北而心爲銳角黃經亦在北故法用加而赤緯仍在北

若先有黃赤緯度而求黃經則互用其率亦同前式一甲數

戊酉

二【乙數減赤緯正】斗未

三黃道半徑丙乙

四心角余女乙

查余表得心角之度假如前圖星在尾爲在黃道南則所用之甲數乙數及所得之四率並同惟赤緯異

論曰星不在箕而在尾則甲心箕三

銳角形變爲甲心尾三角形而心尾

弧大於心箕故所求對角之甲尾弧

亦大於甲箕而赤緯大異

心尾大於心箕而甲數乙數悉同者因用余弧則女尾南緯與女箕北緯同度故也

一黃道半徑丙乙

旣得斗未以轉減乙數斗二心角余女乙

牛得余未牛【卽尾申】爲赤緯三甲數

戊酉

正查表得尾卯緯度在四【乙數內減赤緯正】斗未

赤道南

論曰此系乙數跨赤道故乙數內兼有赤緯及四率之數而減赤緯得四率以四率轉減亦得赤緯

右系黃緯在南而心爲銳角是緯南而經北法當用減而乙數大受四率反減故赤緯仍在南

假如前圖星在巽則所用之甲數乙數亦同惟四率異【因巽艮黃緯卽室奎之度與丙醜同故甲數酉戊與戊酉同大而乙數鬥牛兌乾並同辰巳】

又巽星在黃道南而心爲鈍角星在

秋分後春分前黃經亦在南則赤緯

亦在南法當用加

一黃道半徑

丙乙【卽室乙】

二【鈍角余卽大矢減半徑之餘】艮乙【艮丙爲心鈍角大矢內減丙乙得艮乙】

三甲數

酉戊

四【赤緯正內減乙數】

未斗

旣得未斗以乙數鬥牛【卽辰巳】加之成未牛爲赤緯正【卽栁巽】查表得震巽緯度在赤道南

假如前圖星在兌爲黃道北所用之

甲數乙數四率並同惟赤緯異【兌艮北緯

與巽艮南緯並同丙醜之度故甲數乙數同甲心巽與甲心兌兩鈍角形

同用心鈍角故四率亦同惟心兌弧小於心巽故所求對角弧甲兌亦小】

【於甲巽而赤緯異】

一黃道半徑丙乙

旣得未斗以轉減乙數二鈍角余艮乙

兌乾得余兌離爲赤緯三甲數

酉戊

正查表得兌坎緯度四【乙數內減赤緯正】未斗【卽離乾】在赤道北

右系黃緯在北而心爲鈍角是秋分後春分前爲緯北而經南法當用減而乙數大受四率轉減故赤緯仍在北

第三圖赤緯大於二極距甲數小乙數大

心甲箕三鋭角形星在箕有黃極緯心箕有北極

赤緯甲箕有黃赤極

距心甲【卽室危】求甲角

爲赤經辰危赤緯

大於危室大距【卽心甲】與前圖略同故乙數

亦大於甲數所異

者此求赤經故諸數

皆生於赤緯謂總弧

較弧皆用赤緯也而加減正反在黃道矣

室危兩極距之正室辛余辛乙

辰危赤緯【卽箕女爲甲箕距比極之餘】之正辰酉余酉乙甲數戊酉法爲半徑室乙與辛室正若酉乙余與甲數戊酉也

乙數辰已法爲半徑室乙與辛乙余若辰酉正與乙數辰已【或婁酉正與乙數酉壬】也

依加減代乘除攺用辰危室危相加爲總弧辰室其正辰午又相減爲較弧婁室其正婁丁【卽午昴】

又以較弧正午昴減總弧正辰午餘數半之得已午爲甲數【卽戊酉也法於辰午內截減辰坤如午昴其餘坤午半之於已卽得已午】

甲數已午轉減辰午正余辰巳爲乙數【或以甲數已午加較午昴成巳昴乙數亦同】箕虛及未牛並同【皆乙數也】

又以箕翼黃緯之正箕柳與乙數箕虛相減得虛柳【卽未斗】以爲次率【因箕栁黃緯大乙數箕虛小故於黃緯正內減乙數得未斗】

法爲甲數戊酉與未鬥若酉乙與未乙亦卽若危乙半徑與甲角之餘女乙也

一甲數

戊酉

二【黃緯正內減去乙數】未斗

三赤道半徑

危乙

四甲角余

女乙

論曰赤道經度春分至秋分【北六宮】爲鈍角秋分至春分【南六宮】爲銳角其角與黃經正相反此條星在箕是赤緯在北也而黃緯亦北兩緯同向宜相減成次率而乙數小於黃緯必以乙數減黃緯而得未斗乙數減黃緯而緯在北赤經必南六宮爲銳角查表得度爲甲角度卽赤經也在秋分後以所得減三象限在冬至後以所得加三象限皆命爲其星距春分赤道經度

若星在尾用甲心尾三角形則以黃

緯正反減乙數爲次率【未牛乙數大於黃緯

鬥牛故以鬥牛反減未牛得未斗】余率並同

論曰此條星在尾是赤緯在南也而黃緯亦並在南兩緯同向宜相減而成次率而乙數大於黃緯宜於乙數內轉減去黃緯成未斗也乙數大受黃緯轉減而緯在南赤經必亦在南六宮爲銳角

一甲數

戊酉

二【乙數內減黃緯】

未斗

三赤道半徑

危乙

四甲角余

女乙

假如前圖星在兌用心甲兌三角形

有心兌邊【星距黃極】有甲兌邊【星距北極】有心

甲邊【兩極距】求甲鈍角爲赤道經度

因赤緯同故甲數乙數同

星在兌赤緯在北黃緯亦在北緯同向北宜相減而成次率而乙數大以黃緯減之得斗未【乙數兌乾內減去黃緯兌離余離乾卽斗未】

乙數大受黃緯轉減而赤緯在北必赤經亦在北六宮爲鈍角

一甲數

酉戊

二【乙數內減去黃緯】斗未

三赤道半徑寅乙

四甲角余艮乙

以艮乙查余表得度用減半周爲甲鈍角卽赤經也在春分後以象限減鈍角度在夏至後以鈍角度與三象限相減皆命爲星距春分赤道經度

假如星在巽用心甲巽三角形有心巽邊【距黃極】有甲巽邊【距北極】有甲心邊【兩極距】求甲鈍角爲赤經

甲數乙數並同

惟心在巽是赤緯南也黃緯亦南也兩緯並南宜相減

成次率乙數小黃緯大故以乙數

減黃緯得斗未【鬥牛黃緯卽栁巽也內減乙數未牛余卽

斗未矣】乙數小去減黃緯而赤緯在

南赤經必在北六宮爲鈍角

一甲數

酉戊

二【黃緯內減乙數】

斗未

三赤道半徑寅乙

四甲角余艮乙

以艮乙余查度春分後用余度減象限夏至後加象限皆命爲距春分赤經

第四圖赤緯小於二極距甲數大乙數小

假如星在箕用心甲

箕鈍角形有心箕過

【距黃極對角邊也其餘箕翼卽黃緯】有

甲箕邊【距北極卽辰危之餘】有

心甲邊【兩極距寅丙及危室並同】求甲鈍角赤道經

兩極距危室之正

危辛余辛乙赤緯危辰之正辰戊余戊乙甲數戊酉【爲半徑危乙與二極距之正危辛若赤緯余戊乙與甲數戊酉也】

乙數辰巳【或戊壬爲半徑危乙與二極距之餘辛乙若赤緯正辰戊與乙數辰巳也】依加減代乘除以辰危危室兩弧相加爲總弧辰室其正辰午

又相減爲較弧婁室其正婁丁【或丁井卽午昴】

以總弧正辰午加較弧正午昴成辰昴而半之爲甲數巳午【巳坤爲辰坤之半坤午爲坤昴之半合之爲巳午】卽戊酉

又以甲數己午轉減正辰午得辰巳爲乙數【亦卽戊壬】星在箕爲赤緯北而黃緯亦在北兩緯同向宜相減而成次率而乙數大當以黃緯轉減之成斗未【牛未乙數內減牛斗黃緯余斗未】

乙數大受黃緯反減而緯在北赤經在北六宮爲鈍角一甲數

酉戊

以艮乙余查度春分後二【乙數內減黃緯正】斗未

用減象限夏至後加象限三赤道半徑寅乙

命爲距春分經度

四甲角余艮乙

若星在尾用心甲尾三角形則爲南緯而黃緯亦南兩

緯同向宜相減成次率而乙數小於

黃緯故以乙數減黃緯成斗未【虛尾黃緯

內減乙數氐尾余虛氐卽斗未】其甲數乙數等算

並同乙數小去減黃緯而緯在南

赤經必在北六宮爲鈍角

一甲數

酉戊

二【黃緯正內減乙數】斗未

三赤道半徑寅乙

四甲角余艮乙

若星在兌用心甲兌三角形兌爲北緯而黃緯亦北兩

緯同向宜相減成次率而乙數小於

黃緯故以乙數減黃緯成未斗【兌乾黃緯

內減乙數兌離余余離乾卽未斗】甲數乙數並同

乙數小去減黃緯而緯在北赤經反

在南六宮爲銳角

一甲數

戊酉

以女乙余度秋分後減二【黃緯正內減乙數】未斗

三象限冬至後加三象限三赤道半徑危乙

命爲距春分赤經【下同】四甲角余女乙

若星在巽用心甲巽三角形赤緯南黃緯亦南兩緯同向宜相減成次率而乙數大以黃緯轉減之成未斗【未牛乙數內減黃緯鬥牛卽栁巽其餘卽未斗】

乙數大受黃緯轉減而緯在南赤經

卽在南六宮爲銳角

一甲數

戊酉

二【乙數內減黃緯正】未斗

三赤道半徑危乙

四甲角余女乙

第五圖赤緯小於二極距甲數大乙數小

黃緯乙數相加成次

率【黃緯在南角鋭鈍黃緯在北角】星在巽用心甲巽三

角形有心甲邊【二極距】有巽甲邊【距北極度爲過弧其

赤緯女巽在南】有巽心邊【距黃

極度其餘巽爲黃緯在北】求對

巽心弧之甲角心甲兩極距卽危室【或寅丙】其正危辛余辛乙女巽赤緯卽危婁【或辰危卽丑寅】其正辰戊余戊乙

甲數戊酉【兩極距正危辛乘赤緯余戊乙半徑危乙除之之數也法爲危乙與危辛若戊乙與戊酉】乙數辰巳【兩極距余辛乙乘赤緯正辰戊半徑危乙除之之數也法爲危乙與辛乙若辰戊與辰巳】依加減代乘除攺用辰危危室相加爲總弧辰室其正辰午又相減爲較弧婁室其正婁丁【卽午昴及丁井】以總較兩正相加成辰昴折半得巳午爲甲數卽戊酉【巳坤爲辰坤之半坤午爲坤昴之半合之成己午】

甲數巳午轉減總弧正辰午得辰巳爲乙數卽戊壬黃緯巽氐在北赤緯女巽在南兩緯異向宜以乙數與黃緯正相加成次率【以同黃緯正巽栁之牛斗加同乙數戊壬之未牛成未斗】乙數黃緯正相加而黃緯在北其赤經必在南六宮爲銳角法爲甲數戊酉與未鬥若戊乙與未乙亦卽若危乙與女乙

一甲數

戊酉

以女乙查余表得度二【乙數加黃緯正】未斗

秋分後減冬至後加皆與三赤道半徑危乙

三象限相加減命爲其星四甲角余女乙

距春分赤道經度

又如星在箕用心甲箕三角形有心甲邊【二極距】有箕甲邊【距北極度其餘箕艮赤緯在北】有箕心邊【距黃極度爲過弧其黃緯翼箕在南】求對箕心弧之甲角

甲數乙數同上

惟黃緯翼箕在南赤緯箕艮在北兩緯異向宜以乙數

與黃緯正相加成次率【以黃緯正箕張相

同之牛斗加乙數辰巳相同之牛未成斗未】

乙數與黃緯相加而黃緯在南其

赤經必在北六宮爲鈍角法爲甲數

酉戊與鬥未若戊乙與未乙亦卽若寅乙與艮乙一甲數

戊酉

以艮乙查余表得度春二【乙數加黃緯正】斗未

分後減夏至後加皆加減三赤道半徑寅乙

象限命爲其星距春分赤四甲角余艮乙

赤道經度

求赤道經度約法

用三邊求角【兩極距爲一邊距北極爲一邊此二邊爲角兩旁之弧距黃極爲一邊此爲對角之弧】以求到鈍角赤道經度在北六宮銳角赤道經度在南六宮

法爲甲數與次率若赤道半徑與所求角之餘其樞紐在次率也

凡黃緯南北與赤緯同向者並以乙數與黃緯相減而成次率減有二法

凡黃緯南北與赤緯異向者並以乙數與黃緯相加而成次率

加惟一法

歷算全書卷十﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

欽定四庫全書

歷算全書卷十一

宣城梅文鼎撰

環中黍尺卷五之六

加減捷法

用加減則乘除省矣今惟用初數則次數亦省又耑求矢度省余則角之銳鈍得矢自知邊之大小加較卽顯無諸擬議之煩故稱捷法

如法角旁兩弧度相加爲總相減爲存視總弧過象限以總存兩余相加不過象限則相減並折半爲初數

若總弧過兩象限與過象限法同【其餘仍相加】過三象限與在象限內同【其餘仍相減】若存弧亦過象限則反其加減【總弧過象限或過半周宜相加今反以相減若總弧過於三象限宜相減今反以相加】並以兩余同在一半徑相減不然則加也

總存兩余同在一半徑當相減折半圖

乙丁丙三角形

丁爲鈍角

丙卯爲總弧其正卯

戊余戊己庚丙爲

存弧其正庚壬余壬巳兩余同在丙已半徑宜相減【壬巳余內減戊巳成戊壬】折半爲初數醜壬【卽甲庚亦卽未酉】總存兩余分在兩半徑當相加折半圖

乙丁丙形丁爲銳角

庚丙爲總弧其正弧庚

壬余壬巳卯丙爲

存弧其正卯戊余

戊已徑兩余分在丙巳子巳兩半徑宜相加【以戊巳加壬巳成壬戊】折半爲初數醜戊【卽甲酉亦卽未卯】

三邊求角初數恆爲法以兩矢較乘半徑爲實法爲初數與兩矢較若半徑與角之矢也

一初數【卽角旁兩正相乘半徑除之之數今以加減得之】

二兩矢較【或兩俱正矢或兩俱大矢或存弧用正矢對弧用大矢】

三半徑

四角之矢【正矢角銳大矢角鈍】

角求對邊則以初數乘角之矢爲實半徑爲法法爲半徑與角之矢若初數與兩矢較也

一半徑

二角之矢【或正矢或大矢】

三初數

四兩矢較【並以較加存弧矢爲對弧矢加滿半徑以上爲大矢其對弧大不滿半徑爲正矢其對弧小】

乙丁丙形三邊求丁角

小邊乙丁【正卯辛】大邊丙丁【正壬丙】初數卯癸【兩正相乘半徑除之也】

今攺用加減

兩余相減【余房戊】折半得

醜戊卽初數卯癸【與先所得同】

一系總弧過半周而存弧亦過象限則余相減法爲卯癸初數與兩矢較牛乙若卯辛正【距等半徑】與乙庚【距等大矢】亦卽若寅巳半徑與角之大矢酉子

一初數

卯癸【卽丑戊】

二兩矢較牛乙【卽房甲】

三半徑

寅巳

四角之大矢酉子

若先有丁鈍角而求乙丙對邊則反用其率

一半徑

寅巳

二角之大矢酉子

三初數

卯癸

四兩矢較牛乙

以所得兩矢較加存弧大矢房丙得大矢甲丙

乙丁丙形

三邊求丁角

小邊乙丁【正乙辛】大邊丙丁【正戊壬】

初數戊癸

今用加減

兩余相減【余辰甲】折半得辰

醜卽初數戊癸

對弧【乙丙】大矢斗乙

存弧大矢甲乙【兩矢較斗甲】

法爲初數戊癸與兩矢較斗甲若戊壬正【距等半徑】與丙庚【距等大矢】亦卽若寅巳半徑與角之大矢酉子

一初數戊癸【卽丑甲】

二兩矢較斗甲

三半徑

寅巳

四角之大矢酉子

論曰此移小邊於外周如法求之所得並同其故何也先有之角及角旁二邊並同則諸數悉同矣然則句股之形不同何也曰前圖是用乙丁小弧之正爲徑分大矢之比例則所用句股是丁丙大弧之正此圖是用丁丙大弧正爲徑分大矢比例則所用句股是乙丁小弧正故句股形異也然句股形旣異而所得初數何以復同曰此三率之精意也初數原爲兩正相乘半徑除之之數前圖用大弧正偕半徑爲句與而小弧正用爲大矢分徑之比例是以大弧正爲二率而小弧正爲三率也今攺用小弧爲二率大弧爲三率而首率之半徑不變則四率所得之初數亦不變也又何疑焉

一系角旁二弧可任以一弧之正爲全徑上分大小矢之比例其餘一弧之正卽用爲句股比例不拘大小同異其所得初數並同

又論曰以句股比例言之則戊庚通爲【卽距等圏全徑】戊女倍初數爲句【卽總存兩余相加減之數】一也戊壬正爲則戊癸初數爲句二也丙庚爲【通之大分卽距等大矢】則斗甲兩矢較爲句【卽丙房】三也丙壬爲【正之分綫卽距等餘】則斗醜爲句【對弧余內減次數丑巳得斗丑亦卽丙牛】四也戊丙爲【正之分綫卽距等小矢】則午戊爲句五也

以全與分之比例言之則戊庚爲距等全徑與寅子全徑相當一也戊壬正爲距等半徑當寅巳半徑二也丙庚如距等大矢當酉子大矢三也丙壬如距等餘當酉巳余四也戊丙如距等小矢當寅酉正矢五也一系初數恆與角旁一弧之正爲句股比例其正恆爲初數恆爲句而其全與分之比例俱等又卽與員半徑上全與分之比例俱等若倍初數卽與全員徑上大小矢之比例等

一系角旁兩弧任以一弧之正爲徑上全與分之比例初數皆能與之等

若先有丁鈍角求對邊乙丙則更其率

一半徑

巳子

二丁角大矢酉子

三初數

醜甲

四兩矢較斗甲

以四率斗甲加存弧大矢乙甲成斗乙爲對弧大矢內減巳乙半徑得斗巳爲對弧余撿表得未丙弧度以減半周得對弧丙乙度

乙丁丙形三邊求丁角

乙丁邊【九十五度】丁丙邊【一百一十二度】乙丙對弧【一百一十九度】總弧丙未二百○七度余辛巳八九一○一存弧丙戊一十七度

余壬巳九五六三○兩余相加辛壬一八四七三一

初數卯亥【卽半辛壬丑辛】九二三六五

對弧大矢癸丙一四八四八一

存弧正矢壬丙

四三七○

兩矢較癸壬一四四一一一

法曰卯亥【卽丑辛】與癸壬若

未亥與乙戊亦必若庚巳

與甲子

一初數卯亥

九二三六五

二兩矢較癸壬

一四四一一一

三半徑庚巳

一○○○○○

四角之矢申子

一五六○二二

四率大於半徑爲大矢其角鈍法當以半徑一○○○○○減之餘五六○二二爲鈍角余撿表得余度五十五度五十六分以減半周爲丁角度

依法求到丁鈍角一百二十四度○四分

論曰試作辰戊綫與倍初數辛壬平行而等又引未辛【總弧正】至辰成未辰戊句股形又引牛乙癸【對弧正】至寅作亥丑綫引至斗各成句股形而相似則其比例等一未辰戊大句股以辰戊倍初數爲句未戊通爲一乙寅戊次句股以寅戊兩矢較爲句乙戊【距等大矢】爲一【未卯亥亥斗戊】兩小句股並以【卯亥斗戊】初數爲句【未亥亥戊】正爲辰戊倍初數與寅戊兩矢較若未戊通與乙戊距等大矢是以大句股比小句股也

卯亥初數與癸壬兩矢較若未亥正與乙戊距等大矢是以小句股比大句股也用亥斗戊形比乙寅戊其理更著

又未戊通上全與分之比例原與全員徑上全與分之比例等故三者之比例可通爲一也

【一大句股截數種小句股故又爲全與分之比例】

仍用全圖取乙丁女形求丁鋭角

乙丁邊【九十五度】女丁邊【六十八度】女乙對弧【六十一度】

總弧女戊【一百六十三度】余【壬巳】九五六三○

存弧女未【二十七度】余【辛巳】八九一○一

兩余並【辛壬】一八四七三一初數卯亥九二三五六

一初數卯亥九二三六五

二兩矢較癸辛四○六二○

三半徑巳庚一○○○○○

四角之矢申庚四三九七七【以減半徑得丁角余入表得丁角度】

依法求得丁鋭角五十五度五十六分

辛丁乙形

三邊求丁角

辛丁邊五十度一十分乙丁邊六十

總弧卯辛一百一十度一十分

余庚丙二四四七五

存弧戊辛九度五十分

余子丙九八五三一

余並子庚一三三○○六

初數子午【卽戊癸】六六五○三

辛乙對弧八十度

對弧矢辛酉八二六三五

存弧矢辛子一四六九

兩矢較子酉八一一六六

一初數

子午六六五○三

二兩矢較子酉八一一六六

三半徑

壬丙一○○○○○

四丁角大矢壬甲一二二○五○【用余入表得丁外角減半周得丁角度】

依法求到丁鈍角一百○二度四十四分

論曰此如以日髙度求其地平上所加方位也乙爲太陽乙甲其髙度其餘度丁乙日距天頂也亥乙赤道北緯辛乙爲距緯之餘卽去極緯度也辛壬爲極出地度其餘辛丁極距天頂也所求丁鈍角百○二度太距正北壬之度外角七十七度少距正南巳之度也算得太陽在正東方過正卯位一十二度太

乙丙辛形有【辛丙三十三度辛乙百卅二度】對弧乙丙【百八度】求辛角

總弧【丙壬】一百六十五度

余【己戊】九六五九三

存弧【丙庚】九十九度

余【己甲】一五六四三兩余相減余【戊甲】八○九五○

初數甲醜四○四七五對弧大矢酉丙一三○九○二

存弧大矢甲丙一一五六四三

兩矢較甲酉一五二五九

一初數甲醜四○四七五

二兩矢較甲酉一五二五九

三半徑申巳一○○○○○

四角之矢未申三五三五二

得辛鋭角四十九度二十八分

恆星歲差算例

老人星黃道鶉首宮九度三十五分二十七秒爲庚角【康熈

甲申年距歷元戊辰七十七算毎年星行五十一秒

訃行一度○五分二十七秒以加戊辰年經度鶉首

八度三十分得今數】

黃道南緯七十五度距

黃極一百六十五度爲庚

辛邊用巳庚乙三角形

【一角二邊】求對弧巳乙【赤緯】

余較丁甲二○六六一

初數甲戊一○三三○

庚角正矢申酉一三九八

一半徑

申丙一○○○○○

大矢內減半徑二庚角矢申酉

一三九八

取余檢表得三初數

甲戊一○三三○

三十八度廿三四兩矢較甲醜

一四四分半以減半周加存弧大矢巳甲一七八二三四得星距北極一百得對弧大矢巳丑一七八三七八四十一度三十六

分半爲對弧巳乙

求到甲申年老人星赤緯在赤道南五十一度三十六分半【以校歷元戊辰年緯五十一度三十三分及儀象志康熈壬子年緯五十一度三十五分可以略見恆星赤緯歲差之理】

求巳角【赤經】

巳庚角旁弧二十三度三

十一分半

巳乙角旁弧一百四十一

度三十六分半

庚乙對弧一百六十五度

三邊求角

余較子斗四九五七七

初數午斗二四七八八

對弧大矢庚亥一九六五九三

存弧大矢庚斗一四七○七六

兩矢較亥斗四九五一七

一初數午斗二四七八八大矢內減半徑得二兩矢較亥斗四九五一七餘檢表得度以三半徑丙氐一○○○○○減半周得已角度四角大矢亢氐一九九七六一

一百七十六度○二分置三象限以已角度減之得星距春分九十三度五十八分

求到甲申年老人星赤道經度在鶉首宮三度五十八分【以校戊辰年赤經九十三度三十九分及儀象志壬子年赤經九十三度五十一分可以見恆星赤經東移之理】

加減防法補遺

防法以兩余相加減以兩矢較偹四率其用巳簡然有闕余無可加減闕矢度無可較者𨿽非恆用而時或遇之亦布算者所當知也

一加減變例

凡余必小於半徑常法也然或捴弧適足半周則余極大卽用半徑爲捴弧余法以存弧余加減半徑折半爲初數【視存弧不過象限則相加存弧過象限則相減】又若角旁兩弧同數則無存弧而余反大卽用半徑爲存弧余法以捴弧余加減半徑折半爲初數【視捴過象限或過半周則相加捴弧在象限內或過三象限則相減】

以上用半徑爲余者六

凡加減取初數必用兩余常法也然或總弧適足一象限或三象限或存弧適足一象限皆無餘法卽用一餘折半爲初數不湏加減【總弧無餘卽單用存弧余存弧無餘卽單用總弧余】

又或捴弧【適足象限或三象限】無餘而兩弧又同數【準前論卽以半徑爲存弧余】或存弧【適足象限】無餘而總弧又適足半周【卽以半徑爲總弧余】

二者並以半徑之半爲初數不湏加減

以上無加減者六

一兩矢較變例

凡兩矢相較常法也然或其弧滿象限則卽以半徑爲矢【對弧滿象限則以半徑爲對弧矢與存弧矢相較存弧滿象限亦然亦卽以半徑與對弧矢相較】防法視對弧存弧但有一弧滿象限卽命其又一弧之餘爲兩矢較不更求矢【對弧滿象限卽用存弧余存弧滿象限卽用對弧余並卽命爲兩矢較與上法同】

凡以矢較加存弧矢成對弧矢【正矢則對弧小大矢則對弧大】常法也然或有相加後適足半徑者其對弧必足象限又有四率中無兩矢較者以無存弧矢故也【凖前論角旁兩弧同度無存弧則亦無存弧矢之可較】法卽以對弧矢爲用不必更求矢較若角求對邊其所得第四率卽對弧矢若三邊求角其所用苐三率亦對弧矢【余詳後例】

設角旁兩弧同度總弧在象限以內求對角之邊丙乙丁形

乙角一百一十度余三四二○二乙丙乙丁並三十度

兩余相減五○○○○

丙庚

半之爲初數二五○○○

丙癸

一半徑寅已一○○○○○

二初數丙癸

二五○○○

三【乙角大矢】寅午一三四二○二

四【對弧矢】丙甲

三三五五○【四率本爲兩矢較因無存弧矢故卽爲對弧之矢

對弧余】甲巳

六六四五○

求到對弧丁丙四十八度二十二分

論曰以半徑爲存弧余何也弧大者余小弧小者余大今存弧旣相減而至於無則小之至也故其餘亦大之至而成半徑也四率卽爲對弧矢何也弧大矢亦大弧小矢亦小旣無存弧則亦無矢矣無矢則無可較故四率卽對弧矢也然則其比例柰何曰半徑寅已與大矢寅午若正子丙與距等大矢丁丙亦卽若初數丙癸與對弧矢丙甲

若三邊求角則反其率

一初數

二半徑

三對弧矢

四乙角矢

若捴弧過三象限其法亦同

前圖丁丑丙形

醜角同乙角

其所用四率以得對弧丁丙並同上法

若三邊求角則反其率

一初數

二半徑

三對弧矢

四醜角矢

一系兩邊同度無存弧矢則徑以對弧矢當兩矢較之用設總弧滿半周而較弧亦過象限求對角之邊前圖卯丑丁形

醜角

七十度余三四二○二午已丑丁一百五十度

丑卯

三十度

相減五○○○○庚丙

初數二五○○○庚癸

存弧大矢一五○○○○庚卯

醜角矢六五七九八午酉

一半徑

酉巳

一○○○○○二初數

丙癸【卽庚癸】

二五○○○

三醜角矢

午酉

六五七九八

四兩矢較

庚甲

一六四四九

加存弧大矢庚卯

一五○○○○

得對弧大矢甲卯

一六六四四九

求到對弧卯丁一百三十一度三十八分

設三小邊同數

求角

丙乙丁形

三邊並三十度

求乙角

相減五○○○○丙庚

初數二五○○○丙癸

對弧【丁丙】三十度余八六六○三甲巳

矢一三三九七丙甲

一初數丙癸

二五○○○

二半徑寅己一○○○○○

三對弧矢丙甲

一三三九七

四乙角矢寅午

五三五八八

余午巳

四六四一二

求到乙角六十二度二十分丁丙二角同

論曰此亦因存弧無矢故以對弧矢爲三率也其比例爲初數丙癸與對弧矢丙甲若乙丙正丙辰與丙丁距等矢則亦若寅巳半徑與乙角矢寅午

一系凡三邊等者三角亦等

前圖丁丑丙形二大邊同度一小邊爲大邊減半周之餘三邊求角

其對弧丁丙亦三十度所用四率並同上法所得醜角六十二度二十分亦同乙角惟餘兩角【丁丙】並一百一十七度四十分皆爲醜角減半周之餘

若先有角求對邊則反其率

又於前圖取丁丑戊形

醜丁

一百五十度

醜戊

三十度

其對弧戊丁【一百五十度】爲醜戊【三十度】減半周之餘故所用四率亦同但所得矢度爲醜外角之矢當以其度減半周得醜角【一百一十七度四十分】戊角同醜角丁角【六十二度二十分】卽醜外角一系凡二邊同度其餘一邊又爲減半周之餘與三邊同度者同法但知一角卽知余角其一角不同者亦爲相同兩角之外角

設角旁兩弧同數而捴弧

足一象限求對角之邊

子乙丙形

乙角一百度余一七

三六五

初數五○○○○

丙辛【卽半徑之半】

一半徑

壬巳一○○○○○

二初數

丙辛

五○○○○

三乙角大矢壬醜一

一七三六五

四對弧矢丙癸

五八六八二

余癸巳

四一三一八

求到對弧子丙六十五度三十六分

論曰半半徑爲初數何也凖前論半徑卽存弧余而捴弧無餘無可相減故卽半之爲初數問捴弧何以無餘曰弧大者余小捴弧滿象限則大之極也故無餘其比例可得言乎曰壬巳與壬丑若丙甲與丙子則亦若丙辛與丙癸若所設爲子戊丙形戊角同乙角一百度

【戊子戊丙】同爲一百三十五度捴二百七十度【滿三象限】亦

無餘亦如上法以半半徑爲初數依上四率求到對戊角之子丙弧六十五度三十六分

若三邊求角則反其率

一初數

二半徑

三對弧矢

四角之矢

設角旁兩弧之捴滿半周而存弧亦滿象限求對角之弧用前圖子戊卯形

戊角

八十○度余一七三六五

子戊一百三十五度

卯戊

四十五度

余無減半半徑爲初數五○○○○己辛卽庚甲存弧滿象限半徑爲正矢一○○○○○卽卯巳半徑

一半徑辰巳一○○○○○

二初數己辛

五○○○○

三戊角矢辰丑

八二六三五

四兩矢較己癸

四一三一七卽對弧卯子余對弧大矢卯癸一四一三一七【以兩矢較加存弧矢得對弧大矢】求到對弧卯子一百一十四度二十四分

論曰捴弧以半徑爲余何也凡過弧大者余大過弧滿半周則大之至也故其餘亦最大而卽爲半徑也然則存弧又能以半徑爲矢何也弧大者矢大存弧旣滿象限故其矢亦滿半徑矣

問兩矢較巳癸卽對弧之餘也何以又得爲兩矢較曰他存弧之矢有大小而不得正爲半徑故其與對弧矢相較亦有大小而不得正爲余今矢旣爲半徑較必余矣

若三邊求角則反其率

一初數巳辛

其比例爲巳辛與巳癸若丁甲二半徑辰巳

與丁子則亦若辰巳與辰丑三兩矢較己癸

四戊角矢辰丑

設對弧滿象限三邊求角

乙丙甲形

對弧乙甲九十度無餘

求丙角

相加辰癸一三五六二一

初數午癸

六七八一○

對弧滿象限矢卽半徑已甲一○○○○○

用防法卽以存弧余癸已爲矢較

一初數

午癸

六七八一○

二半徑

巳戊一○○○○○

三矢較

巳癸

四二二六二卽存弧余四丙角矢庚戊

六二九○四

求到丙角六十八度一十四分

其比例爲初數午癸與余巳癸若正壬辛與距等矢乙辛也亦必若半徑己戊與角之矢庚戊

若先有丙角求對弧則反其率

一半徑【戊巳】二初數【午癸】三丙角矢【戊庚】四兩矢較【巳癸】以所得四率與存弧矢甲癸【五七七三八】相加適足半徑【成巳甲】命對弧乙甲適足九十度防法視所得四率矢較與存弧余同數卽知對弧爲象限不必更問存弧之矢

設角旁兩弧同數捴弧過象限

求對角之弧

辛乙丙形

乙角七十三度余二九二三七

相加折半爲初數八二一三九癸丙

一半徑己戊一○○○○○

二初數癸丙八二一三九

三乙角矢甲戊七○七六三

四對弧矢丁丙五八一二四

余丁巳四一八七六

求到對弧辛丙六十五度一十五分

若三邊求角則反其率

一初數【癸丙】二半徑【巳戊】三對弧矢【丁丙】四乙角矢【甲戊】

設角旁弧同數捴弧過半周其算並同

前圖辛丑丙形

辛丑丙丑並一百十五度

捴弧丙醜壬二百三十度余六四二七九庚巳醜角同乙角

其所用四率求對弧及三邊求角並如上法

設捴弧滿半周而存弧不過象限求對弧

前圖辛乙卯形

乙角

一百○七度余二九二三七甲巳乙卯

一百十五度

乙辛

六十五度

相加半之爲初數八二一三九癸庚卽子辰

一半徑

寅巳一○○○○○

二初數

庚癸

八二三一九

三乙角大矢寅甲一二九二三七

四兩矢較庚丁一○六一五三卽辛未加存弧正矢庚卯

三五七二一

得對弧大矢丁卯一四一八七四

求到對弧卯辛一百一十四度四十五分

加減又法【解恆星曆指第四題三率法與加減防法同理】

弧三角有一角及角旁二邊求對角之弧

法曰以角旁大弧之餘度與小弧相加求其止爲先得次以角旁兩弧相加視其度若適足九十度卽半先得爲次得【此大弧之餘弧與小弧等】

若角旁兩弧捴大於象限【此大弧之餘弧小於小弧】則以大弧之餘弧減小弧而求其以加先得然後半之爲次得若兩弧捴不及象限【此大弧之餘弧大於小弧】則以小弧減大弧之餘弧而求其以減先得然後半之爲次得又以角之矢爲後得

以後得乘次得爲實半徑爲法除之得數爲他一率全數

二率次得【卽初數】

三率後得【卽角之矢】

四率他【卽兩矢較】

並以他與先得相減爲所求對角弧之餘若他大於先得卽以先得減他【不問何但以小減大右法不載測量全義而附見歷指人自江南來得小兒以燕家信以此爲問謂與環中黍尺有合也乃爲摘錄以疏其義】

論曰此亦加減代乘除之一種也加減法以捴弧存弧之餘相加減以取初數此則不用存弧而用存弧之餘度【以余度取正卽存弧之餘故也】又不正用存弧之餘度而用大弧之餘度【以大弧之餘度加小弧卽存弧之餘度故也】至其加減又不用捴弧而用大弧余度與小弧相減之較弧【以此較弧之正卽捴弧之餘故也】取徑迂回而理數脗合非兩法相提並論不足以明其立法之意也舉例如後

乙丙丁形【有乙角及角旁二邊】求對弧丁丙【以加減防法求得諸數與恆星歷指法相參論之

乙丙小弧乙丁大弧】正【甲丙辰庚】

【捴存】弧【戊丙庚丙】余【壬巳癸巳】

【余並癸壬初數癸甲卽辰寅】

【丁丙對庚丙存弧】正矢【卯丙癸丙】

【兩矢較卯癸一半徑

酉巳】

【二角之矢酉午三初數

甲癸卽辰寅

四兩矢較

卯癸卽丁子末以卯癸加癸丙得卯丙爲對

弧矢乃查其度得對弧丁丙】

右加減法也

今攺用恆星歷指之法先以酉庚爲角旁大弧【乙丁】之餘弧【乙庚同乙丁大弧度也乙酉同乙午皆象限也乙酉象限內減乙庚猶之乙午內減乙丁也故庚酉卽乙丁之餘】又以牛酉當角旁小弧乙丙【乙酉與牛丙皆象限內減同用之丙酉同乙丙】二者相加成牛庚取其正戊庚是爲先得次視角旁兩弧【乙丙乙丁】之捴【丙戊】大於象限【丙辛】法當以大弧余度去減小弧得較【於同小弧之午酉內減同大弧余度之氐酉其較牛氐與牛房等】而取其【牛氐較與牛房等則氐井與房井等而卽與危戍等是危戌卽牛氐較之也】以加先得【以危戍加戌庚成危庚】然後半之【危庚半之於未成未庚】爲次得

又以乙角之矢【午酉】爲後得與次得【未庚】相乘爲實半徑爲法除之得他【亥庚】

未以他【亥庚】減先得【戌庚】其餘亥戌爲對弧【丁丙】之餘【查表得對弧】

論曰牛庚之正戍庚與癸巳平行而等卽存弧之餘也【牛庚爲小弧與大弧余度之並實卽存弧丙庚之餘度故戌庚卽同癸巳】次得未庚與甲癸平行而等卽初數也【以危戍加戌庚而成危庚猶捴存兩余相加成癸壬也危庚旣同癸壬則其半未庚亦同甲癸】他庚亥與卯癸平行而等卽兩矢較也末以他與先得相減而得對弧余猶以兩矢較與存弧之矢相加而得對弧之矢也【兩矢較卽兩余較也故加之得矢者減之卽得余】然則此兩法者固異名而同實矣又論曰加減本法用大弧小弧之捴與較取其餘以相加減今此法則用大弧余度與小弧之捴與較而取其正以相加減【如牛庚是大弧余度與小弧之捴牛氐是大弧余度與小弧之較】用若相反而得數並同者何也曰余弧與正弧互爲消長其數相待是故大弧之餘度大於小弧則捴弧不及象限矣大弧之餘度小於小弧則捴弧過象限矣捴弧過象限宜相加此條是也捴弧不及象限宜相減後條是也宜加宜減之數無一不同得數安得而不同【得數謂初數也在此法則爲次得】

又論曰此法之於加減法猶甲數乙數之於初數次數也初數次數用余甲數乙數用正加減法用余此法用正所以然者皆以角旁之弧半用余度也【甲數乙數法內一弧用本度一弧用余度此法小弧用本度大弧用余度】一加減法乃有四用其省乘除並同而繁簡殊矣

乙丙丁形

有乙角及角旁二邊

求對弧丁丙

【乙丙小弧乙丁大弧】正【申丙辰庚】

【捴存】弧【戊丙庚丙】余【壬巳癸巳】

【余較壬癸初數癸甲】

【丁丙對弧庚丙存弧】正矢【卯丙癸丙】

【兩矢較卯癸一

半徑酉巳】

【二角大矢酉午三

初數甲癸】

【四兩矢較卯癸】

【末以卯癸加癸丙成卯丙爲對弧矢查其餘得對弧丁丙】

右加減法也

今依恆星法攺用大弧之餘度【庚酉卽午丁】與小弧【牛酉卽乙丙】相加【成牛庚卽存弧丙庚之餘度】求其正爲先得【戍庚同巳癸卽存弧之餘】次視兩弧之捴【戊丙】不及象限法當以小弧減大弧余度【取氐酉如酉庚以牛酉減之】得較【氐牛與牛房等】取其正【女房卽女氐亦卽戍危】以減先得【戍危減戌庚余危庚與癸壬等】然後半之【危庚半之於虛成庚虛與甲癸等】爲次得又以【乙】鈍角大矢【午酉】爲後得與次得相乘爲實半徑爲法除之得他【亢庚與卯癸等】末以他【亢庚】減先得【戍庚】其餘戍亢【卽卯巳】爲對弧余查表得對弧丁丙

一率半徑酉巳

二率次得庚虛【卽初數甲癸】

三率後得午酉【卽角大矢】

四率他亢庚【卽兩矢較卯癸】

乙丙丁形【有丙角及角旁二邊】求對弧丁乙

法以【丁丙】大弧之餘【午丁卽酉甲】與小弧【乙丙卽戊酉】相加【成甲戊】求

其正【庚甲】爲先得次視兩弧

之總【醜乙】適足象限卽半先得

爲次得【癸甲或癸庚】又以角之大矢【午酉】爲

後得乘之【午酉乘癸甲】半徑【酉巳】除之

得他【卯甲卽壬未】以減先得【甲庚】得

對弧余【卯庚卽壬巳】查表度得對弧【丁乙】

解曰此因大弧之餘酉甲與小弧戊酉同數則無加減故卽半先得爲次得也在加減法則爲總弧無餘而卽半存弧余爲初數

丙戊丁形【有戊角及角旁二邊】求對弧丁丙

如法以大邊【丙戊】之餘【卯丙卽癸庚】與小弧【丁戊卽癸辛】相加【成辛庚】取

其正【庚乙】爲先得次眎角

旁兩弧之捴【辰丁】大於象限法

當以癸庚減癸辛得較子辛

【卽辛井】而取其正【子斗卽井斗亦卽乙】

【甲】以加先得【乙庚】而半之【甲庚之半爲甲醜】爲次得又以角之大矢【卯癸】爲後得以乘次得爲實半徑爲法除之得他【牛庚】末以他【牛庚】與先得【庚乙】相減得【牛乙卽壬巳】爲對弧之餘查余度以減半周得對弧丁丙

解曰此爲他大於先得故反減也在加減法則所得爲對弧大矢與存弧小矢之較而兩矢較卽兩余並也故減存弧余得對弧余

補求經度法

法用角旁兩弧【大弧用余度小弧用本度】相加得數取正爲先得又相減得較取正以與先得相加減【角旁兩弧大於象限則相加若小於象限則相減】而半之爲次得【若角旁兩弧並之足一象限則徑以先得半之爲次得不須加減】用爲首率次以對角弧之餘與先得相加減得他爲次率【對弧大於象限相加小於象限則相減】半徑爲三率求得角之矢爲四率【正矢爲鋭角大矢爲鈍角】

假如丙戊丁形有三邊求戊角【借用前圖】

一次得甲醜【乃先得甲庚之半】卽庚醜

二他

壬酉【卽牛庚乃對弧余加先得因對弧大故相加】

三半徑

巳癸

四鈍角大矢卯癸【卯癸大矢內減巳癸半徑爲余查表得度以減半同爲戊鈍角之度】論曰角求對邊者求緯度也三邊求角者求經度也二者之分祗在四率中互換無他繆巧歷指注云求緯用正求經用切綫殊不可曉及查其後條用例亦無用切綫之法殆有缺誤曆書中如此者甚多故在善讀耳加減通法

加減代乘除之法以算三邊求角及二邊一角求對角之邊皆斜弧三角之難者也其算最難而其法益簡故凡算例中兩正相乘者卽可以加減代之則𨿽正弧諸法實多所通故謂之通法

法曰凡四率中有以兩正相乘爲實半徑爲法者皆可以初數取之有以兩余相乘爲實半徑爲法者皆可以次數取之有以余與正相乘爲實半徑爲法者皆可以甲乙數取之

假如正弧形有角有角旁弧而求對角之弧【此如有春分角有黃道而求距度】本法當以角之正與角旁弧之正相乘爲實半徑爲法除之也今以初數取之卽命爲所求度正

設黃道三十度求黃赤距度

【春分角二十三度三十一分半黃道三十○度】

【捴弧五十三度三十一分半存弧

六度二十八分半】余【五九四四七九九三六二】用初數爲正檢表得度【相減三九九一五折半一九九五七卽初數】

求到黃赤距度一十一度三十○分四十二秒

又設黃道七十五度求黃赤距度

【春分角二十三度三十一分半黃道七十五度】

【捴存】弧【九十八度三十一分半五十一度二十八分半】余【一四八二四六二二八五】用初數爲正檢表得度

【相加七七一○九折半三八五五四】

求到黃赤距度二十二度四十分三十九秒

又如句股方錐法有大距有黃道而求距緯本以大距正黃道余相乘半徑除之也今以甲數取之設黃道六十度求距緯【句股方錐黃道以距二至起算下同】

【黃赤大距二十三度三十一分半黃道

六十○度】

【捴弧

八十三度三十一分半存弧

三十六度二十八分半】正【九九三六二五五四四七】用甲數爲正檢表得度

【相減三九九一五半之一九九五七爲甲數】

求到距緯一十一度三十○分四十二秒

設黃道一十五度求距緯

【黃赤大距二十三度三十一分半黃道

一十五度】

【捴存】弧

【三十八度三十一分半八度三十一分半】正【六二二八五一四八二四】用甲數爲正查表得度【相加七七一○九半之三八五五四爲甲數】

求得距緯二十二度四十分三十九秒

又如次形法本以一正與一餘相乘半徑除之得所求之餘今以初數取之

設甲丙乙形有甲正角有丙角及甲丙邊而求乙角本法爲半徑與丙角正若甲丙余與乙角余今以初數卽命爲乙角余【丙角度甲丙余度】相【並減】爲【捴存】弧各取其

余如法相加減而半之成初數卽命爲乙角余本法用正與余相乘而亦以初數取之何也曰甲丙余實次形丁丙正也故仍用初數

假如斜弧形作垂弧法本爲半徑與角之正若角旁弧之正與垂弧之正也今以初數卽命爲垂弧正設丁乙丙形有乙鋭角有丁乙邊求作丁甲垂弧【乙角度乙丁弧】相【並減】爲【捴存】弧而取其餘如法相加減而半之成初數卽命爲丁甲垂

弧正

設丁乙丙形乙爲鈍角而先有丁乙邊其法亦同【乙外角丁乙邊】相【並減】爲【捴存】弧而各取其餘如上法取初數命爲甲丁垂弧正

又如弧角比例法本爲角之正與對角邊之正若又一角之正與其對邊之正今以初數進五位卽爲兩正相乘之實可以省乘

設乙甲丙形有丙角甲角有乙甲邊求乙丙邊本以甲角正與乙甲正相乘爲實丙角正爲法除之得乙丙正今以甲角度與乙甲弧相並減爲捴存弧如法取初數進五位爲實以丙角正除之亦得乙丙正【若有乙丙邊求丙角則以乙丙邊正爲法除之卽得丙角之正】

又如垂弧防法本以兩余相乘爲實又以余爲法除之而得所求之餘今以次數進五位爲兩余相乘之實卽可省乘

設甲丁亥鈍角形有亥甲邊有亥丁邊有引長之丁巳邊而求甲丁邊本法爲亥巳邊之餘與亥甲邊之餘若丁巳邊之餘與甲丁邊之餘也今以次數代乘

【亥甲丁巳】二弧相並爲捴弧相減爲存弧

而各取其餘如法相加減而半之

爲次數下加五○卽同亥甲與丁巳

兩余相乘之實但以亥巳邊之餘

爲法除之卽得甲丁邊之餘

進五○何也曰初數者兩正相乘半徑除之之數故必進五位卽同兩正相乘之實矣次數進位之理仿此論之

補加減防法

設壬丙甲弧三角形

甲壬邊適足九十度丙甲邊八十三度對弧壬丙五十九度

求甲角

法曰角旁有一邊

適足九十度則總

存兩余同數當

以余卽命爲初

數依法求得五

十八度四十四分

爲甲角

存矢申丙

七四五

矢較戊申四七七五一

一初數九九二五五已申

二矢較四七七五一戊申

三半徑一○○○○○己癸查表得五十八度四十四分四【角之矢】四八一○九壬癸

余五一八九一壬巳

論曰此卽算帶食法也凡算帶食其差角必在地平壬甲九十度卽髙弧全數丙甲八十三度月距北極也癸丙七度黃赤距度也壬丙對弧極距天頂也其餘己戊卽極出地正所求甲角月出地平時地經赤道差也

防法以黃赤距度余與極出地正相減余進五位爲實仍以距度余除之得差角矢

解防法曰極出地正卽對弧余黃赤距度余卽存弧余兩余之較卽矢較也

又解曰巳乙卽己申亦卽未丙並小弧甲丙正也【卽存弧癸丙之餘】未丙與戌丙若己癸與壬癸全與分之比例也又解曰初數是兩正相乘半徑除之之數今甲壬邊之正卽半徑故省乘除竟以甲丙正爲初數又設壬甲辛鈍角形【卽用前圖】壬甲邊適足九十度辛甲邊九十七度對邊辛壬一百二十一度求甲角依法求得甲鈍角一百二十一度一十六分

對弧辛壬一百卄一度余巳戊

五一五○四對弧大矢戊辛

一五一五○四存弧矢

癸乙同酉辛

七四五【亦同丁庚】兩矢較

戊酉同辰辛一五○七五九【亦同丁壬】

一

初數【丁巳同午辛】九九二五五

二

矢較【丁壬同辰辛】一五○七五九

三

半徑己庚一○○○○○

四角大矢壬庚一五一八九○

余己壬五一八九○

查表得五十八度四十四分以去減半周得甲角一百二十一度一十六分

論曰縂弧過象限及過半周宜以余相加折半成初數今兩余相同而徑用爲初數亦折半之理也向作加減法補遺自謂巳盡其變不知仍有此法故特記之

因算帶食得此其用防法更奇甚矣學問之無窮也壬甲丙鋭角形壬甲邊適足九十度丙甲邊六十七度對弧壬丙五十度求甲角

依法求得甲角四十五度四十二分

○五【卽爲初數】

壬丙對弧五十○度余六

四二七九巳戊

對弧矢三五七二一戊丙

存弧矢

七九五○乙癸【卽申丙】

矢較二七七七一申戊

一初數

九二○五

申巳

二矢較

二七七一

申戊

三半徑一○○○○○己癸

四角之矢三○一六九壬癸

余

六九八三一壬巳

查表得四十五度四十二分

因前圖丙癸度小故復作此以明之

算甲余角

又於本圖取辛甲壬鈍角形壬甲九十度辛甲一百一十三度壬丙五十度求甲鈍角依法求到甲鈍角度一百三十四度一十八分

壬辛對弧一百三十○度余巳戊六四二七九

大矢辛戊一六四二七九

存弧矢申丙【卽乙癸】七九五○【亦卽酉辛】矢較酉戊一五六三二九

一初數九二○五○酉巳【卽丁巳】二矢較一五【六三二九】酉戊三半徑一○○○○○庚巳

四【角大矢】一六【九八三○】庚壬

余六九【八三○】

查表得四十五度四十二分以減半周得甲鈍角一百三十四度一十八分

論曰試作庚亥綫與辛丙徑平行又引對弧坎戊正至亥成庚亥壬句股形卽庚幹巳亦同角之小句股形而庚亥同酉戊兩矢較也庚幹同酉巳初數也則初數【庚幹小股】與兩矢較【庚亥大股】若半徑【庚巳小】與角之大矢【庚壬大】凡角旁弧適足九十度則縂存兩余弧同數法卽以余命爲初數

日月食帶食出入地平用此算其地經赤道差甚防

補甲數乙數法

丁辛乙斜弧三角形

辛丁弧五十度一十分

辛乙弧八十度

丁乙

對弧六十度

又若辛乙弧八十度

求辛角

辛丁【余弧】三十九度【五十】分

辛乙【余弧】一十度

縂弧一百十九度【五十】分辛丁弧五十度一十分

較弧四十度一十分

兩正總【一五一二四九】半之爲甲數【七五六二四】兩正較【二二二四七】半之爲乙數【一一一二三】丁乙對弧余【五○○○○】內減乙數余【三八

八七七】爲二率

一甲數七五六二四

二

三八八七七

三半徑一○○○○○

四【辛角余】五一四○八

查表得五十九度○四分爲辛角

若前形有辛角而求丁乙對弧

一半徑一○○○○○

二【辛角余】五一四○八

三甲數七五六二四

四

三八八七七

以加乙數一一一二三

成對弧余五○○○○

查表得六十度

此因角旁余弧小於正弧故乙數亦小於甲數而以所得四率加乙數爲對弧余

丙乙丁形乙鈍角一百一十度【乙丙乙丁】二弧並三十度求丁丙對弧

乙丙余弧六十度

乙丁弧三十度

縂弧

九十度正一○○○○○

較弧

三十度正五○○○○

相加

一五○○○○

半之爲乙數七五○○○

相減

五○○○○

半之爲甲數二五○○○

一半徑一○○○○○

二【乙角余】三四二○二

三甲數二五○○○

四

八五五○

以減乙數七五○○○

得對弧余六六四五○

查表得四十八度二十一分

此因角旁乙丙余弧大於乙丁正弧故乙數大於甲數而以所得四率反減乙數爲對弧余

前例轉求乙鈍角【乙丙乙丁】二弧並三十度丁丙對弧四十八度二十一分

求乙角

一甲數二五○○○二【對弧余減乙數之餘】八五五○三半徑一○○○○○四鈍角余三四二○二查表得七十度以減半周得一百一十度爲乙角

縂論曰甲數乙數原以角旁兩弧之正錯乘而得今攺用加減故角旁兩弧一用正一用余然有時余弧大於正弧者角旁兩弧之合數必過象限也有時余弧小於正弧者角旁兩弧之合必不及象限也若角旁兩弧之合適足象限則余弧必與正弧等而無較弧

又設子乙丙形乙鈍角一百度【乙丙乙子】二弧並四十五度

求對角

乙丙余弧四十五度

乙子弧四十五度

【半之爲甲數】五○○○○

則無可加亦【亦爲乙數】五○○○○

無可減故皆

用縂弧正

折半爲甲數

亦爲乙數

一半徑一○○○○○

二【鈍角余】一七三六五

三甲數五○○○○

四

八六八二

加乙數共五八六八二【命爲對弧矢】

得對弧【余】四一三一八

查表得對弧子丙六十五度三十六分

若前例三邊求乙角

乃置對弧六十五度三十六分之餘四一三一八求其矢得五八六八二

丙減乙數五○○○○

仍餘八六八二爲二率

一甲數五○○○○

二

八六八二

三半徑一○○○○○

四【鈍角余】一七三六四

查表得八十度以減半周得一百度爲乙角之度補先數後數法

前式丙乙丁形乙角一百一十度【乙丙乙丁】並三十度求丁丙對弧

一半徑方一○○○○○○○○○○

二正方

二五○○○○○○○○

三乙角【大矢】一三四二○二

四兩矢較

三三五五○

對弧余

六六四五○

查表亦得四十八度二十一分

此因角旁兩弧同度則無較弧之矢故徑以所得矢較命爲對弧之矢

前式子乙丙形乙角一百度【乙丙乙子】二弧並四十五度求對弧

一半徑方一○○○○○○○○○○

二正方

五○○○○○○○○○

三角大矢一一七三六五

四矢較

五八六八二【因無較弧矢故卽爲對弧矢】對弧余

四一三一八

查表亦得對弧子丙六十五度三十六分

若先有對弧子丙而求乙角

一正方

五○○○○○○○○○

二半徑方一○○○○○○○○○○

三對弧矢

五八六八二【因無較弧矢故卽以對弧矢爲矢較】四角大矢一一七三六五

余

一七三六五

查表得八十度以減半周得乙鈍角一百度

又設乙角六十度

角旁【乙丙乙子】二弧並四十五度求子丙對弧

一半徑方一○○○○○○○○○○二正方五○○○○○○○○○三鋭角矢五○○○○

四

矢較二五○○○【無較弧卽用爲對弧矢】對弧余七五○○○

查表得對弧五十三度○八分

歷算全書卷十一

欽定四庫全書

歷算全書卷十二

宣城梅文鼎撰

歳周地度合攷

攷最髙行及歳余

古歷不知太陽有最髙之行郭太史時最髙卑正在二至難於窺測西曆自多祿某以來世有積測定最髙防每年東行四十五秒每太陽平行一度髙行七防半約八十年行天一度康熙庚申又攺測每年行一分○一秒十防最髙防進移二十八分故辛酉天正冬至最髙在未宮七度○七分○七秒每太陽平行一度髙行十防一○四計五十八年十个月○六日奇行天一度此永年表之新率也但最髙之度旣攺而又自有行動則每年歳實小餘之數必不均齊夫治歷首務太陽而太陽重在盈縮爰舉歷年髙行及四正相距時日前後互核以驗歳實之消長髙行之遲速列爲一卷亦可爲後來攷測之資云

己未年

最髙過夏至六度三十九分

春分甲戌日申正二刻六分

中距九十三日十二刻十二分

夏至丁未日戌初三刻三分

中距九十三日六十一刻

秋分辛巳日午初初刻三分距本年【春分一百八十六日七十

三刻十二分】

中積八十九日四十五刻一分

冬至庚戌日亥正一刻四分距本年【夏至一百八十三日一十

刻一分】

中積八十九日○八分

按最髙行爲盈縮立差之主其行有序今己未最髙在夏至後六度三十九分而次年庚申卽行至七度七分一年之內驟行二十八分必另有新測矣

庚申年

最髙過夏至七度七分【按永年表所載者年前冬至之數七政歷所載本年夏至之數度分同】

春分己卯日亥正一刻十二分距【己未秋分百七十八日四十五刻】

中積九十三日十一刻

【九分己未春分三

百六十五日卄三刻六分】

夏至癸丑日丑初初刻十二分距【己未夏至三百六十五日卄一刻九分】

中積九十三日六十一刻七分

秋分丙戌日申正三刻四分

距【本年春分百八十六日七十三刻七分】中積八十九日四十六刻【十三】分【己未秋分三百六十五日二十三刻六分】

冬至丙辰日寅正二刻二分

距【巳未冬至三百六十五日卄四刻十三分

本年夏至一百八十三日一十三刻六分】

按最髙進移則夏至差而早冬至差而遲意者新測之冬至遲於先測耶

又按歳餘二十四刻十三分於授時法得二千五百九十分必無是理其爲攺測無疑

據向後數冬至距冬至春分距春分俱合得三百六十五日二十三刻四分【或五分三分】以較庚申歳實多一刻○九分必爲攺測矣

壬戌年

最髙過夏至七度九分

春分庚寅日巳正初刻六分

中距九十三日十刻一十二分

夏至癸亥日午正三刻三分距【庚申夏至七百三十日四十六刻】

中距九十三日六十二刻九分

秋分丁酉日寅正一刻【六分】分距【十二本年春分一百八十六日七十】

中距八十九日四十七刻

冬至丙寅日申正初刻【三刻】分距【六分十二庚申冬至七百三十日】中距八十八日【四十六刻十分】分

【九十四刻十二本年夏至一百八】

癸亥年

最髙過夏至七度十分

春分乙未日申初三刻九分距【十三日十三刻九分壬戌春分三百】中距九十三日【六十五日】分

【二十三刻三分十刻十二壬戌秋分一】

夏至戊辰日酉正二刻六分距【壬戌夏至三百六十五日二十三刻】中距九十三日【三分六十】九分

【二刻壬戌冬至一百八十二日九】

秋分壬寅日己正一刻

距【刻○九分本年春分一百八十六日】中距八十九日【七十三刻】一分

【六分四十七刻壬戌秋分三百六十】

冬至辛未日亥正初刻一分距【五日二十三刻三分壬戌冬至三百】中距八十八日【六十五日二十】分

【三刻四分九十四刻十二本年夏至】

甲子年

最髙過夏至七度十一分

春分庚午日亥初二刻【一百】分距【八十三日一十三刻十分十三癸亥秋】中距九十三日【分一】十一分

【百七十八日四十五刻十三分十刻】

夏至甲戌日子正一刻九分距【癸亥春分三百六十五日二十三刻四】中距九十三日【分癸亥夏】十分

【至三百六十五日二十三刻○三】

秋分丁未日申正初刻四分距【分六十二刻癸亥冬至一百八十二】中距八十九日【日九刻○】一分

【八分本年春分一百八十六日七十】

冬至丁丑日寅初三刻五分距【三刻六分四十七刻癸亥秋分三百】中距八十八日【六十五日二十】分

【三刻四分癸亥冬至三百六十五日】

乙丑年

最髙過夏至七度十二分

春分丙午日寅初二刻二分距【甲子秋分一百七十八日四十五刻十】中距九十三日十刻九分

【三分甲子春分三百六十五日二十】

夏至己卯日卯正初刻【三刻】分距【四分十一甲子夏至三百六十五日】中距九十三日【二十三刻二分】分

【六十二刻十二冬至一百】

秋分壬子日亥初三刻八分距【八十二日九刻六分本年春分一百】

中距八十九日【八十六日】二分

冬至壬午日巳初二刻十分距【七十三刻六分四十七刻甲子冬至】中距八十八日【三百六十五日】分

【二十三刻五分九十四刻十一本年】

丙寅年

最髙過夏至七度十三分

春分辛亥日巳初一刻六分距【夏至一百八十三日十三刻十四分乙】中距九十三日十刻八分

【丑秋分一百七十八日四十五】

夏至甲申日午初三刻【刻十】分距【三分春分三百六十五日二十三刻】中距九十三日【四分十四乙丑】分

【夏至三百六十五日二十】

秋分戊午日寅初二刻【十一】分距【本年春分一百八十六日七十三刻五分】

中距八十九日【四十七刻】四分

冬至丁亥日申初二刻

距【乙丑冬至三百六十五日二十三刻六分】中積八十八日【九十四刻】十分

【本年夏至一百八十三日十四刻一分】

按日行盈縮細攷之則春分距夏至夏至距秋分𨿽皆縮歷而其縮亦不同秋分距冬至冬至距春分𨿽皆盈歷而其盈亦不同又且年年不同細求之則節節不同又細求之且日日不同矣其故何也蓋最髙一防不在夏至而在其後數度又且年年移此太陽盈縮之根而歲實所以有消長也

甲子年

春分庚子日亥初二刻十三分距癸亥年秋分【一百七十八日四十五刻十三】分距癸亥年春分【三百六十五日二十三刻四分】

秋分丁未日申正初刻四分距春分一百八十

六日七十三刻六分

乙丑年

春分丙午日寅初二刻二分距甲子年秋分【一百七十八日四十五刻十三】分距甲子年春分【三百六十五日二十三刻四分】

秋分壬子日亥初三刻八分距本年春分【一百八十六日七十三刻】六分距甲子年秋分【三百六十五日二十三刻四分】

丙寅年

春分辛亥日巳初一刻六分距乙丑年秋分【一百七十八日四十五刻十三】分距乙丑年春分【三百六十五日二十三刻四分】

秋分戊午日寅初二刻十一分距本年春分【一百八十六日七十三刻】五分距乙丑年秋分【三百六十五日二十三刻三分】

以上二分定气之距皆相同其春分至秋分日行最髙爲縮歷多八日二十七刻八分惟丙寅年秋分早到一分只多八日二十七刻七分約之爲八日二十七刻半

按最髙半周多八日奇者非多八日也以較最卑半周故多八日奇若其本數隻多四日有奇耳因最卑亦少四日奇故合之爲八日奇熊防石乃謂本數多八日則所誤多矣

假如乙丑秋分至丙寅秋分共三百六十五日卄三刻三分半之該一百八十二日五十九刻九分而丙寅春分至秋分得一百八十六日七十三刻五分則多四日一十三刻十一分丙寅春分前距乙丑秋分得一百七十八日四十五刻十三分又少四日一十三刻十一分合計之則爲八日二十七刻七分

半周均各一百八十二日奇者謂之恆气半周有盈縮者謂之定气相差八日奇者乃兩半周定气相較之數非一半周定气與其恆气自相較之數也

甲子年

春分庚子日亥初二刻十三分距癸亥春分三

百六十五日二十三刻四分

冬至丁丑日寅初三刻五分距癸亥冬至三百

六十五日二十三刻四分

乙丑年

春分丙午日寅初二刻二分距前春分三百六

十五日二十三刻四分

冬至壬午日巳初二刻十分距前冬至三百六

十五日二十三刻五分

丙寅年

春分辛亥日己初一刻六分距前春分三百六

十五日二十三刻四分

冬至丁亥日申初二刻距前冬至三百六十五

日二十三刻五分

右冬至之小餘皆卄三刻五分【或四分】春分之小餘皆卄三刻四分差一分

以冬至論歳余得授時萬分日法之二千四百三十○半分大於消分八分

法以小餘五分爲實刻十五分爲法除之得三之一以從刻共得二十三刻又三之一爲實九十六刻爲法除之得○二四三○五進四位得二千四百三十分彊【進四位者以萬乘也】若以春分論歳余得授時萬分日法之二千四百二十三分六亦大於消分一分六

法以卄三刻化三百四十五分並入四分得三百四十九分爲實日法一千四百四十分爲法除之得○二四二三六進四位得二千四百二十三分半彊

按授時消分爲不易之法今復有長者何耶西法最髙之防在兩至後數度歳歳東移故𨿽冬至亦有加減不得以恆爲定也此是兩法中一大節目其法自回回歷卽有之然了凡先生頗采用回回法而不知此熊防石先生親與西儒論歷而亦不言及何耶

丁卯年

髙衝過冬至七度十四分

春分丙辰日申初初刻十分距【丙寅秋分一百七十八日四十五刻十】中積九十三日十刻七分

【四分春分三百六十五日二十】

夏至己丑日酉初三刻二分距【三刻四分丙寅夏至三百六十五日】中積九十三日【二十三刻三分】分

【六十二刻十三冬至一百】

秋分癸亥日己初二刻

距【八十二日九刻二分本年春分一百】中積八十九日四【八十六日】分

【七十三刻五分十七刻四丙寅秋分】

冬至壬辰日亥初一刻四分距【三百六十五日二十三刻四分丙寅】中積八十八日九【冬至三百】分

【六十五日二十三刻四分十四刻】

戊辰年

髙衝過冬至七度十五分

春分辛酉日戍正三刻【十本】分距【年夏至一百八十三日十四刻二分十】中積九十三日十刻六分

【四丁卯秋分一百七十八日四】

夏至甲午日夜子初【十五】五分距【刻十四分春分三百六十五日二十】中積九十三日【三刻四分二刻】分

【丁卯夏至三百六十五日】

秋分戊辰日申初一刻四分距【二十三刻三分六十二刻十四冬至】中積八十九日四【十七刻六】分

【丁卯秋分三百六十五日二十三刻】

冬至戊戌日寅初初刻十分距【四分丁卯冬至三百六十五日二十】中積八十八日【三刻六分】七分

【九十四刻本年夏至一百八十三】

己巳年

髙衝過冬至七度十六分

春分丁卯日丑正三刻二分距【日十四刻五分戊辰秋分一百七十八】中距九十三日十刻六分

【日四十五刻十三分春分三百】

夏至庚子日卯初一刻八分距【六十五日二十三刻三分戊辰夏至】中積九十三日六十三刻

【三百六十五日二十三刻三】

秋分癸酉日亥初初刻八分距【分冬至一百八十二日八刻十三分】中積八十九日【本年春分】六分

【一百八十六日七十三刻六分四十】

冬至癸卯日辰正三刻【七刻】分距【戊辰秋分三百六十五日二十三刻】中積八十八日【四分十四】八分

【戊辰冬至三百六十五日二十三】

庚午年

髙衝過冬至七度十七分

春分壬申日辰正【刻四】七分距己巳【分九十四刻本年夏至一百八十三】

中積九十三日【十刻】四分

【春分三百六十五日卄三刻】

夏至乙巳日午初初刻【五分十】距己巳【一分夏至三百六十五日二十三刻】

中積九十三日六十【三

分三冬至一百八

十二刻日八】

秋分己卯日丑正三刻【刻十二】距本年【分十一分春分一百八十六日七十】

中積八十九日【三刻四

分四十七己巳秋分二百六

十刻七分五日】

冬至戊申日未正三【廿三】分距己巳【刻三分刻三冬至三百六十】

中積八十八日【五日廿

三刻四分九十四本年夏至

一百八十刻七】

辛未年

髙衝過冬至七度十八分

春分丁丑日未正一刻【分三】距【日十四刻七分十分庚午秋分一百】中積九十三日【七十】三分

【八日四十五刻十四十刻分春】

夏至庚戌日申正三【分三百】分距【六十五日廿三刻三分刻十三庚午】中積九十三日【夏至三

百六十五日二十三刻二

分六十三】

秋分甲申日辰正三刻

距【冬至一百八十二日刻二分八刻十】中積八十九日【分本年

春分一百八十六日七十

三刻五分四十】

冬至癸丑日戌正二【七庚】分距【午秋分二百六十刻七分五日廿

本年夏至一百八十三日十四刻九分】

按庚申年夏至至冬至一百八十三日十三刻六分辛未年夏至至冬至一百八十三日十四刻九分十二年中共長一刻○三分【中積只十一年】

壬戌年冬至至次年夏至一百八十二日九刻九分庚午年冬至至次年夏至一百八十二日八刻十分九年中共消十四分【中積共只八年】

又合計癸亥夏至前半周一百八十二日九刻九分冬至前半周一百八十三日十三刻十分相較一日○四刻【一分】辛未夏至前半周一百八十二日八刻十分冬至前半周一百八十三日十四刻九分相較一日○五刻十四分八年中較數增一刻十三分然二分之相距則無甚差何也蓋最髙移而東則夏至後多占最髙之度而減度加時之數益多故益長髙衝移而東則冬至後多占最卑之度而加度減時之數益多故益消其近二至處皆爲加減差最大之處故消長之較已極也

乃若二分與中距𨿽亦歳移而中距皆爲平度不系加減其最髙前後視行小之度固全在春分後半周最髙衝前後視行大之度亦全在春分後半周毫無動移故無甚消長也

西國月日攷

攷回國聖人辭世年月

回國聖人辭世年月據西域齋期【江寕至鴻堂刻單】以康熙庚午五月初三日起是彼中第九月一日謂之勒墨藏一名阿咱而月也至六月初三日開齋是彼中第十月一日謂之紹哇勒一名答亦月是爲大節再過一百日至九月十三日爲彼中第一月第十日謂之穆哈蘭一名法而幹而丁月其日爲阿叔喇濟貧之期謂之小節鼎嘗以回回歷法推算本年白羊一日入第六月之第八日與此正合

又據齋期云本年庚午聖人辭世共計一千○九十六年【此太陽年】攷本單開聖人生死二忌在本年十一月十四日在彼爲第三月謂之勒必歐勒傲勿勒又名虎而達查西域阿刺必年是開皇己未距今康熙爲一千○九十二算減一爲一千○九十一乃開皇己未春分至今康熙庚午春分之積年

又查己未年春分在彼中爲太陰年之第十二月初五日以距算一千○九十一減聖人辭世千○九十六相差五年逆推之得開皇十四年甲寅爲聖人辭世之年

約計甲寅至己未此五年中節气與月分差閏五十五日甲寅春分當在彼中第十月之初

聖人辭世旣是第三月則在春分月前七个月爲處暑月卽今七月也

自開皇甲寅七月十四日聖人辭世至今康熈庚午七月十四日正得一千○九十六年故曰共計一千○九十六年也

據此則開皇甲寅是彼中聖人辭世之年薛儀甫謂爲回回歷蓋以此而誤

又按聖人以第三月辭世而其年春分則在第十月今彼以第十月一日爲大節蓋爲此也

攷泰西天主降生年月

據天地儀書耶蘇降生至崇禎庚辰一千六百四十年算至康熈庚午一千六百九十年

查康熙戊辰年瞻禮單誕辰在冬至後四日日躔箕宿七度逆推漢哀帝庚申約差卝四度則是當時冬至在斗宿之末約計耶蘇降生在冬至前二十餘日爲小雪後四五日也

自哀帝庚申十月算至隋開皇甲寅七月望回回教聖人馬哈木徳辭世實計五百九十四年不足兩个多月攷曆書所紀西國年月

萬曆十二年甲申西九月十五日日躔壽星二度又十三年乙酉西九月卄八日日躔壽星十五度半萬曆十四年丙戌西十月【闕】日日躔壽星二十九度又十五年丁亥西十月卝六日日躔大火十二度太

萬曆十六年戊子西十一月初八日日躔大火二十六度太又十七年己丑西十一月卝二日日躔析木十一度弱

萬曆十八年庚寅西十二月初六日日躔析木卄五度又十九年辛卯西十二月卄一日日躔星紀九度

萬曆二十三年乙未西正月三十日日躔枵卄一度萬曆三十五年丁未西七月初九日日躔鶉首廿六度五三又三十七年己酉西七月廿一日日躔鶉火八度半

萬曆三十八年庚戍西八月初二日日躔鶉火二十度又三十九年辛亥西八月十五日日躔鶉尾二度按此所紀皆是以日躔星紀二十度爲正月初一日析木二十度【或十九度】爲十二月朔大火【十九】度【或二十度】爲【十一】月朔壽星十八度爲十月朔鶉尾十八度爲九月朔鶉火十九度【或十八度】爲八月朔鶉尾十八度爲七月朔【此亦約略之算細求之尙有太陽盈縮】

又正徳九年甲戌西五月初五日子正前日躔大梁二十二度四十分是以大梁十九度爲五月朔【所測在子正前西曆紀日月午正故曰十九度】

正徳十五年庚辰西四月三十日日躔大梁十七度四八是以降婁十九度爲四月朔

又本年七月十三日日躔鶉火初度是以鶉首十八度爲七月朔

嘉靖二年癸未西十一月卄九日日躔析木十五度五四是以大火十八度爲十一月朔

嘉靖六年丁亥西十月初十日日躔壽星卄七度是以壽星十八度爲十月朔

嘉靖八年己丑西二月初一日日躔枵廿一度是以廿一度爲二月朔

萬曆十年壬午西二月廿六日申初二刻日躔娵訾十七度四十九分四二是以枵廿二度爲二月朔萬曆十一年癸未西九月初六日日躔鶉尾廿三度是以鶉尾十八度爲九月朔

萬曆十四年丙戌西十二月廿六日申初二刻太陽在星紀宮十四度五十一分五三是以析木十九度爲十二月朔

萬曆十六年戊子西十二月十五日巳初刻太陽在星紀三度五十三分是以析本十九度爲十二月朔萬曆十八年庚寅西二月初八日午正後三十四刻太陽視行在娵訾初四十秒是以枵廿三度爲二月朔又本年九月初七日子正日躔鶉尾二十四度據此初一日鶉尾十八度

萬曆廿一年癸巳西八月初十日日躔鶉火廿七度是以鶉火十八度爲八月朔

又漢順帝永建二年丁卯西三月廿六日酉正太陽在降婁一度十三分是以娵訾七度爲三月朔

順帝陽嘉二年癸酉西六月初三日申正太陽在實沈九度四十分是以實沈七度爲六月朔

順帝永和元年丙子西七月初八日午正太陽在鶉首十四度十四分是以鶉首七度爲七月朔

又本年西八月三十一日九月初一太陽在鶉尾七度順帝永和二年丁丑西十月初八日太陽在壽星十四度是以壽星七度爲十月朔

順帝永和三年戊寅西十二月廿二日子正前四時日躔析木九度十五分據此初一日是大火八度當是十一月非十二月

順帝陽嘉二年癸酉西五月十七十八日太陽在大梁二十三度據此五月朔大梁七度

按自漢順帝永建丁卯爲總積四千八百四十年至明萬曆十二年甲申爲總積六千二百九十七年相距一千四百五十七年相差十二三度卽歳差

之行也

漢時月朔俱在各宮七八度之間萬曆間月朔俱在各宮之十八九度或卄一二度

據此論之則西曆太陽年用恆星有定度其恆星節气𨿽從歳差西行而每月之日次則以太陽到恆星某度爲定千古不變也想西古歷法只是候中星每年某星到正中卽是某月

又按此法於歳差之理甚明但欲敬授民時則不如用節气爲妥天經或問欲以冬至日爲第一月第一日可以免閏又可授時謂本於方無可先生然沈氏筆談已先有其說矣

今查瞻禮單

康熙丁卯年正月十八丁酉日應西曆三月初一日

【亥宮十度

危十一度二十六分

二三】

二月二十戊辰日應西曆四月初一日

【戌宮十一度十三分】

壁六度二三

二月二十戊戌日應西曆五月初一日

【酉宮十度二十九分】

婁十度五三

四月廿二己巳日應西曆六月初一日

【申一十度十五分】

畢六度九分

五月廿二己亥日應西曆七月初一日

【未八度四十九分】

井七度五一

六月廿四庚午日應西曆八月初一日

【午八度二十一分】

柳二度二二

七月廿五辛丑日應西曆九月初一日

【巳八度一十分】

張六度四八

八月廿五辛未日應西曆十月初一日

【辰七度三十○分】

軫一度○四

九月廿七壬寅日應西曆十一月初一日

【卯八度二十二分】

亢八度一八

十月卄七壬申日應西曆十二月初一日

寅八度【四二】

心五度一八

十一月【卄八】癸卯日應西曆正月初一日

【醜十度二十分】

斗四度二六

十二月【三十】甲戌日應西曆二月初一日

【子十一度五十六分】

女四度三○

據此則西國歷日是以建子之月爲正月也其法不論太陰之晦朔只以太陽爲主然又不論節气但以太陽到斗宿四度爲正月一日耳

又其數與新法曆書所載不同豈彼國亦有攺憲耶按西曆以午正紀日則以上宿度宜各加三十分依此推之歐羅巴之正月一日在斗宿五度

新法曆書萬曆二十三年乙未西正月三十日太陽在枵卄一度於時日行盈歷逆推初一日是星紀卄一度以歳差攷之萬曆乙未至今丁卯距九十二年計差一度半弱其時星紀卄一度是斗十四度二法相較差十度必是攺憲抑彼有多國各一其法耶

又按今之斗四度是星紀十度逆推前此六百六十餘年則正是冬至日太陽所躔之度也當此北宋之初瞻禮單必是此時所定

若曆書所載斗十四度則又在其前六百六十年距今丁卯共有一千三百二十餘年當在漢時蓋其時冬至日躔斗十四度故以爲歳首意者曆書所載故是古法而瞻禮單所定乃是新率耶由是觀之則耶蘇新教之起必不大逺

又按西法以白羊宮初度爲測算之端而紀月又首磨羯何耶曰測算論節气是以太陽之緯度爲主紀月論恆星是以太陽之經度爲主故也

地度弧角

地度求斜距法

有兩處北極髙度又有兩處相距之經度而求兩地相距之里數

甲乙丙爲赤道象弧丁爲極【丁角之度爲甲乙】戊

甲距四十五度甲乙十度半【卽經度之距亦卽丁角】巳乙距四十度求戊巳之距法作戊庚丙

象弧斜交於赤先求庚乙距以減巳乙得

庚巳邊又求戊庚邊求庚角成戊庚巳小三角弧算戊庚巳小三角先有一角【庚】兩邊【一戊庚邊一已庚邊】而求已戊邊法先作已辛垂弧截出戊辛邊並求戊角因得巳戊邊乃以度變成裏此所得卽大度若距赤同度則但以距赤道余求其比例得里數

一率全

二率距赤余三率大度里數【二百五十里】四率緯圈里數如距赤四十五度依法算得離赤道四十五度之地每一度該一百七十六里二百八十步如東西相距二十七度該四千七百七十二里三百五十步弱

論曰地有距赤緯度又有東西經度經度如句緯度相減之餘如股兩地斜距如

旣有句有股可以求而不可以句股法求者地圓故也又論曰此爲一角兩邊而角在兩邊之中法當用斜弧三角法求其對角一邊之度變爲裏卽里數也或用垂綫分形法並同補論曰已防或在庚上或在其下其用庚角並同但在下則當於庚乙內減巳乙而得己庚

以里數求經度法

或先有兩地相距之里數而不知經度

法先求兩處北極髙度乃以兩髙度之餘爲兩邊及相距里數變成度【用二百五十里大度】又爲一邊成弧三角形乃以三邊求角法求其對里數邊之一角卽經度也論曰凡地經度原以月食時取其時刻差以爲東西相距然月食歳不數見又必多人兩地同測始能得之況月天最近有气刻時三差及朦影之攺變髙度非精於測者不易得凖今以里數求之較有把握得此法與月食法相參伍庶幾無誤凡以里數論差當取徑直若遇山林水澤峻嶺回谷則以測量法求其折算之數而取直焉

不但左右不宜旋繞曲折斯謂之直卽髙下若干亦須用法取平

若兩地極髙同度則但以距赤道余【卽極髙度正】求其比例得經度

一率距赤度余

二率全數

三率里數所變之度【用二百五十里爲度】

四率相應之經度【緯圏經度也與赤道大圏相應但里數小耳】

論曰北極髙度𨿽有凖則然近在數十里內所爭在分秒之間亦無大差今以里數凖之則當以正東西爲主如自東至西之路合羅金卯酉中綫斯爲正度若稍偏側亦當以斜度攺平然後算之視極髙度反似的確裏差攷

時憲歷各省太陽出入晝夜時刻

京師三十【九度五十五分】夏至晝五十九刻【七分】夜三十六刻【八分】盛京四十【二天問度略無】六十刻四分三【十五】刻十【一分】山西三十八度

五十八刻【八分】三十七刻【七分】山東朝鮮【三十六度】

五十七【刻十三分】三十八刻【二分】河南陜西【三十四度奇】五十七刻【一分】三十八【刻十四分】江南三十二度半

五十六刻【六分】三十九刻【九分】湖廣三十一度

五十六刻【二分】三十九【刻十三分】四川三

十度

五十【五刻】十【一分】四十刻四分浙江廿

九度

江西二十九度

五十五刻【七分】四十刻八分福建廣西【二十七度】

五十四【刻十二分】四十一刻【三分】貴州二十五度

五十四刻【四分】四十一【刻十一分】雲南二十四度

五十四刻

四十二刻廣東二十三度半

五十三【刻十一分】四十二刻【四分】此據壬申年曆日數也其刻數與天問略同者京師江南湖廣浙江江西雲南廣東也刻分同則極髙確矣

山西天問略長五十八刻六分今八分是所差不多或字畫誤也其極髙三十八度應亦無訛

山東天問略長五十八刻四分今只五十七刻十三分是極髙原測三十七度後攺測三十六度也

時憲歷各省節气時刻

以京師爲主在東者加在西者減毎加減四分爲經度一度

朝鮮

加二刻十分

盛京

加二刻

浙江

福建

加十二分

江南

加八分

山東

加五分

以上地在京師之東皆加

江西

減十分

河南

湖廣

減一刻

廣東

山西

減一刻五分

廣西

陜西

減二刻四分

貴州

減二刻八分

四川

減三刻七分

雲南

減四刻八分

以上地皆在京師之西皆減

天象同時並見而在東者早見日故其刻分加在西者遲見日故其刻分減假如京師正午時太陽在午綫而居東者已見其過午矣故加居西者方見其將午到而猶未正午也故減

陜西天問略長五十七刻十三分今只五十七刻一分是極髙原測三十六度後攺測三十四度奇也河南天問略長五十七刻七分今只五十七刻一分是極髙原測三十五度後攺測三十四奇也

褔建天問略長五十四刻八分今有五十四刻十二分是極髙原測二十六度後攺測二十七度也廣西天問略長五十四刻四分今亦五十四刻十二分是極髙原測二十五度後攺測二十七度也貴州天問略長五十四刻今有五十四刻四分是極髙原測二十四度半後攺測二十五度也

天問略四川極髙二十九度半江西二十九度

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十二﹥

南北緯度以北極髙下定東西經度以月食時刻定地在東一度則見食早其差爲十五分刻之四節朔同地在北則晝夜差多南則漸平

仰規覆矩以裏差赤緯爲用

一查地平經度爲日出入方位

一查赤道經度爲日出入時刻

約法

求每日出入地平廣度【春分至秋分在正卯酉北秋分至春分在正卯酉南】一率大員半徑

二率極髙度割綫

三率赤道緯度正

四率日出入卯酉正【地平經度】

求每日晝刻長短【春分至秋分加秋分至春分減】皆加減半晝二十四刻爲半晝刻

一率大員半徑

二率極髙度切綫

三率赤道緯度切綫

四率日出入加減度正【赤道經度】以變時刻爲加減之用

求二至日出地廣度圖【廣者地平經度距正卯酉也卽日出入方位舉二至爲例餘日皆以赤緯定之】

已丙極髙度卽甲角之

弧【亦卽乙甲丁之餘弧】乙丁爲夏

至日距赤道之緯卽壬

辛【其正弧辰乙卽卯甲】今求乙甲

爲夏至日出地平之廣【冬至

同廣但夏至在卯酉北冬至在正卯酉南逐日赤緯

皆可以此法求之得逐日出地之廣】用甲乙

丁弧三角形法爲丙戊正與丙甲半徑若乙丁之正乙辰與乙甲也【乙甲卽正丙戊正卽北極髙度之餘庚甲也以丙甲戊角卽巳甲丙之餘角】或用乙甲卯句股形則爲庚甲余【巳甲丙角之餘】與巳甲半徑若壬辛之正卯甲與乙甲也末皆以乙甲查正表得弧爲出地之廣【壬辛之正壬未與乙辰卯甲同大卽知乙丁與壬辛亦同大而卯甲之弧亦與壬辛同大而今以直視竟成正】

捷法以比例尺取丙甲半徑於正綫之九十度定尺乃以乙甲正取對度得弧命爲出地之廣

法曰半徑與北極出地之割綫若赤道緯度正與地平出入經度距正卯酉之正也

此圖已爲南極甲乙爲冬至日出入之廣卯乙爲冬至日軌所減於半晝之度與前圖同理

量法從乙作直立綫【與午

甲平行】至戌得戌午弧卽

乙星出入地平距正卯

酉經度【大圈卽子午規側望之形故午

甲綫卽正卯酉】

求時刻法若欲知卯乙在距等圏之度法以卯爲心癸若壬爲界作半圏次從卯心出半徑直綫至幹平分半員成像限末於乙出綫與卯幹半徑平行至象限弧止爲乙坎則其所分坎乾之弧卽卯乙在距等圏之度此度與甲丁赤道度相應可以知所歷時刻矣

或用比例尺以癸卯【卽赤緯余】爲距等半徑加正綫九十度定尺乃以卯乙取對度得弧

又算法求時刻加減度【謂逐日時刻所加減於半晝二十四刻之數春分後加秋分後減皆以度變時】用前圖巳甲乙斜弧三角形有甲角【極出地度】有巳甲邊九十度有巳乙邊赤緯之餘【按用斜弧法曆書未有】求巳角【其弧甲丁】赤道經度用查時刻

法爲半徑丙甲與甲角之切綫酉丙

若已乙之餘切亥丁【乙丁爲巳乙之餘故也實卽

赤緯之正切也】與已角之正甲丁【甲丁卽弧卽正

以直視故弧綫變爲直綫用法以甲丁查正表得角度】

右卽夏至卯酉前後日行地平上之赤道度以距等圏上之卯乙卽赤道上之甲丁以甲丁度化時卽得本地卯正前酉正後所多之刻冬至日卯後酉前所減之度及其時刻並同【逐日求之可列表】

求乙甲邊【地平經度查日出方位】此爲求出地平之廣與前算法並同但用斜弧形故其名頓易法爲半徑丙甲與極出地甲角之割綫酉甲若已乙之餘乙辰與乙甲邊【乙甲亦卽邊卽正】末以乙甲邊查正表得乙甲邊之度

歷算全書卷十二

自序

授時歷於日躔盈縮月離遲疾並云以算術垜積招差立算而今所傳九章諸書無此術也豈古有而今逸耶載攷歷艸並以盈縮日數離爲六段各以段日除其叚之積度得數乃相減爲一差一差乂相減爲二差則其數齊同乃緣此以生定差及平差立差定差者盈縮初日最大之差也於是以平差立差減之則爲毎日之定差矣若其布立成法則直以立差六者因之以爲毎日平立合差之差此兩法者若不相而其術巧防從未有能言其故者余因李世徳孝廉之疑而試爲思之其中原委亦自曉然爰命孫【瑴成】衍爲垜積之圖得書一卷

欽定四庫全書

歷算全書卷十三

宣城梅文鼎撰

授時平立定三差詳說

太陽行天有盈有縮立成以八十八日九十一刻就整爲限者【據盈歷言之】此由測驗而得之也蓋自定气冬至至定气春分太陽行天一象限【依古法以九十一度三一奇爲象限】該歷九十一日三十一刻有奇而今則不然毎於冬至後八十八日九十一刻而太陽已到春分宿度故盈歷以此爲限也

夫八十八日九十一刻而行天一象限則於平行之外多行二度四十分奇也是爲盈歷之大積差若縮歷卽其不及之數必行至九十三日奇而後滿一象限也故縮歷之限多於盈歷日數其積差極數亦與盈歷同但此盈縮之差絕非平派或自多而漸少或由少而漸多何以能得其毎日參差之數郭太史立爲平立定三差法以齊其不齊可得毎日細差及積差其理則出於垜積招差之法也

定差者何曰所測盈縮初日最大之差也凡盈縮末日卽同平行其盈縮之最多必在初日今欲求逐日之差必先求初日最大之差以爲之凖則故曰定差也旣有此最大之差卽可以求逐日之差而逐日之差皆以漸而少法當用減故又有平差立差皆減法也然何以謂之平差曰平者平方也其差之增有類平方故以名之也差何以能若平方曰初日以後其盈縮漸減以至於平以常法論之數宜平派卽用差分法足矣而合之測驗所得則又非平派也其近初日也所減甚少其近末日也所減驟多假如一日減平差一則二日宜減二而今則二日之平差增爲四又初日平差一二日平差四則三日宜爲七四日宜爲十而今則三日之平差增爲九四日增爲十六故非平方垜積之加法不足以列其衰序也

然則又何以爲立差曰立者立方也差何以又若立方曰以平差合之測驗猶爲未足故復設此以益之假如初日減平差一又帶減立差一至二日則平差四而所帶之立差非四也乃八也三限平差九而立差非九也乃二十七也蓋必如此而後與所測之盈縮相應其分爲六段何也曰此求差之法也一二日間𨿽各有盈縮之差然差少則難辧積至半次其差始多而可見矣故各就其盈縮之日勻分之一年二十四定气分四象限各有六气故其分亦以六也

旣勻分六段矣又以後段連前段何也曰此所謂招差也𨿽勻分六段其差積仍難細分故惟於初段用本數以其盈縮多而易見也【如盈歷初段積盈七千分是最多而易見也】若末段必帶前段以其盈縮少而難眞也【如盈歷末段積差與第五段相減則其本段中只共盈七百四十九分數少難分故連前段論之】借彼易見之差以顯難眞之數此立法之意也【以太陽盈差爲例他仿此】

然則各段平差不幾混乎曰無慮也凡前多後少之積差合總數而勻分之卽得最中之率如第六段之平差卽第四十四日之盈加分【以八十八日九二折半得四十四日四六卽最中之處其本段平差二百七十餘分與之相應下仿此】第五段之平差卽第三十七日之盈加分第四段之平差卽二十九日之盈加分第三段之平差卽第二十二日之盈加分第二段之平差卽第十四日八二之盈加分第一段之平差卽第七日四一之盈加分其數各有歸著𨿽連前段原無牽混也然則又何以有一差二差曰一差者差之較也二差者較之較也曷言乎差之較曰各段平差是盈縮於平行之數也其數初段多而末段少各段一差是相鄰兩限盈縮之較也其數初段少而末段反多然則二者若是其相反歟曰非相反也乃相成也蓋惟其盈縮於平行之數旣以漸而減則其盈縮自相差之數必以漸而增其法於前限平差內減次限平差卽知前限之盈縮多於後限若干矣而此一差之數原非平派故初限次限之較最少而次限三限之較漸多三限四限之較又多四限五限更多至五限六限則多之極矣其多之極者何也盈縮之數近末限則驟減也此一差之前少後多正所以爲盈縮之前多後少也

然則二差又何以有齊數曰不齊者物之情也而不齊之中有所以不齊焉得其所以不齊斯可以齊其不齊矣今各限之一差不齊而前後兩一差相減則仍有齊數爲二差是其不齊者差之較而其無不齊者較之較也較之較旣爲齊數則較數之不齊皆有倫而有脊矣故遂可據之以求定差也

泛平積卽用第一段平差何也曰今推定差初日之數也前所推第一段平差則第七日之數也故總第一段言之可曰平差而自初日言之但成泛積泛者對定之辭言必再有加減而後爲定率也

二差折半何也曰以分平差立差之實也蓋泛平積差旣爲初日盈加分多於七日之較則皆此七日中平差立差所積而成之者也而平差之數大立差之數小泛平積之大數皆平差所成而其中有六十九秒【卽半二差】則立差所成故分出此數以便各求其數也

平差除一次立差除兩次何也曰此平立之分也除一次者段日本數爲法也除兩次者段日自乘爲法也於是再以段日乘之則本數者如平方之自乘自乘者如立方之再乘矣

平立合差何也曰次限少於初限之差也內有兩平差六立差之共數故謂之合差【如盈歷以二分四十六秒爲平差三十一微爲立差今倍平差得四分九十二秒加入加分立差一秒八十六微共得四分九十三秒八十六微爲平立合差是有兩平差六立差之數蓋加分立差原是六个立差也】

定差內又減一平差一立差爲初日加分何也曰此初日加分之積少於定差之數也旣以定差爲初日加分矣而積又減此何也曰以定差爲初日加分者乃初日最初之率也積滿一日則平差立差各有所減而特其減甚微故各祗一數如平方立方之起數以一也是故此一平差一立差者卽初日平立合差也

初日之平立合差何獨少耶曰準於平方立方之加法正相應也蓋平方冪積以自乘之積爲等【其數一四九十六二十五三十六四九六四八一也】立方體積以再乘之積爲等【其數一八二十七六四百二十五二一六三四三五一二也】而平立合差之數亦如之

是故初日之盈縮積是於定差內減一平差一立差如平方立方之根一者積亦一也

次日之盈縮積是於二定差內減四平差八立差如方根二者平積必四立積必八也

三日之盈縮積是於三定差內減九平差二十七立差如方根三者平積必九立積二十七也

四日之盈縮積是於四定差內減十六平差六十四立差如方根四者平積必十六立積必六十四也

向後各限並同此推合而言之卽皆逐日之平立合差也然則以一平差一立差較次日之四平差八立差固爲小矣而以四平差八立差較三日之九平差二十七立差不更小乎何況以三較四則爲九平差二十七立差與十六平差六十四立差其相差不更懸絕乎問次日之平立合差只兩平差六立差而今又云四平差八立差三日以後之平立合差只遞增六立差【逐日遞增加分立差一秒八十六微是六个立差之數】而今所云者三日有平差九立差二十七其說之不同如此必有一誤矣曰差之積類於平方立方者是總計其所減之數而毎加加分立差者是分論其逐日所減之數也欲明此理仍當求諸少廣【少廣者開方法也】

今夫平方以一四九十六二十五等爲序者其冪積也若分而言之以一三五七九爲序者其廉隅也【以相挨兩平冪相減卽得廉隅如一與四相減得三四與九相減得五九與十六相減得七十六與二十五相減得九是也】廉隅卽較也而遞增以二數者較之較也【一三五七九皆遞增以二】今夫立方以一八二七六四一二五爲序者其體積也若分而言之以七十九三七六一爲序者其廉隅也【亦以相挨兩體積相減得之如一減八得七八減廿七得十九廿七減六十四得三十七六十四減一百二十五得六十一是也】廉隅卽較也而遞增以六者較之較也【一增六得七七增二六得十九十九增三六得三十七三十七增四六得六一】是故平立差之總積是初日以來所積之差也亦如平立方之冪積體積也平立差之加法是逐日遞增之較也亦如平立方之廉隅也

合初日以來之加分【卽盈縮積度】與定差較則其差如平立方之冪積體積也【平差之序一四九十六二十五立差之序一八二十七六四一二十五】若以本日之加分與定差較則其差如平立方之廉隅也【平差之序一三五七九立差之序七十九三十七六十一】

若以本日之平立合差與初日較如平立方之廉積【平差之增二四六八立差之增六十八三十六六十】若以相近兩日之平立合差自相較如平立方之廉積相較【平差之遞增皆二立差之遞增以六而再增十二爲二六再增十八爲三六再增二十四爲四六也】於定差內減平差立差各一爲初日加分

又於初日加分內減去二平差六立差是共減平差四【本日實減三合初日所減之一則四】立差八【本日實減七合初日所減之一則八】而爲次日加分也

又於次日平立合差內加入六立差爲平立合差【共二平差十二立差】以減次日加分是共減去平差九【本日實減平差五合前兩日所減四共九】立差二十七【本日實減立差十九合前日所減之八則二十七】而爲三日加分也

又於三日之平立合差內加六立差爲平立合差【共二平差十八立差】以減三日加分是共減去平差十六【本日實減平差七合前三日所減之九則十六】立差六十四【本日實減立差三十七合前三日所減之二十七則六十四】而爲四日加分也

故曰合初日以來之加分與定差較其差如平立方之冪積體積而以本日之加分【卽本日實減數】與定差較則如廉隅也

若論布立成法則不言定差但以初日加分爲根以平立合差減初日加分爲次日加分是於初日加分內減二平差六立差也

又以六立差倂入平立合差以減次日加分爲三日加分是於次日加分內又減二平差十二立差於初日加分則爲減四平差十八立差也

又如上法再增六立差以減三日加分爲四日加分是於三日加分內又減二平差十八立差於初日加分內則爲減六平差三十六立差也

故曰以平立合差與初日較若平立方之廉積而以相近兩日自相較如平立方之廉積相較也

平方二廉故相加以二立方六廉故相加以六此倍平差六因立差爲平立合差之理也平方之相加以二者始終不變立方之相加以六者毎限遞增此向後立差遞增六數之理也

盈縮招差圖說

盈縮招差本爲各一象限之法【如盈歷則以八十八日九十一刻爲象限縮歷則以九十三日七十一刻爲象限】今只作九限者舉此爲例也其空格九行定差本數爲實也其斜綫以上平差立差之數爲法也斜綫以下空格之定差乃餘實也

假如定差爲一萬平差爲一百立差爲單一今求九限法以九限乘平差得九百又以九限乘立差二次得八十一並兩數九百八十一爲法定差一萬爲實法減實余實九千○一十九卽九限末位所書之定差也於是再以九限爲法乘余實得八萬一千一百七十一爲九限積數

本法以九限乘定差得九萬爲實另置平差以九限乘二次得八千一百置立差以九限乘三次得七百二十九並兩數得八千八百二十九爲法以減實九萬得八萬一千一百七十一爲九限積與前所得同

本法是先乘後減用法是先減後乘其理一也

初日減平差一庚也次日又減平差二甲也實減三並甲庚也合廉隅矣並計初日共減四合平方冪矣第三日又多減平差二乙也實減五並二甲二乙一庚也合廉隅矣並計前兩日共減九合平方冪矣第四日以後仿此推之

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十三﹥

中心甲一爲初限所減立差卽垜積形之頂

加外圍六乙共七爲次限所減立差平廉長廉各三隅一也並上層甲共八成根二之體積是爲垜積形之第二層

又加外圍丙十二共十九爲三限所減立差三平廉共十二三長廉共六隅一也並上兩層共二十七合根三之體積是爲垜積形之第三層

又加外圍丁十八共三十七爲四限所減立差三平廉共二十七三長廉共九隅一也並上三層共六十四合根四體積是爲垜積形之第四層

又加外圍戊二十四共六十一爲五限所減立差三平廉共四十八三長廉十二隅一也並上三層共一百二十五合根五之體積是爲垜積之第五層

又加巳三十共九十一爲六限立差其七十五爲三平廉其十五爲三長廉其一隅也並上層共二百一十六成體積是爲垜積之第六層

又加庚三十六共一百二十七爲七限立差其百○八爲三平廉其十八爲三長廉其一隅也並上層成體積三百四十三是爲垜積之第七層

又加辛四十二共一百六十九爲八限立差其百四十七爲三平廉其二十一爲三長廉其一隅也並上層共五百一十二如體積是爲垜積之第八層

此姑以八層爲式向後仿此推之因從甲頂平視故類六角平面其實如六角錐也立方廉隅而圖以錐形六角者以表其垜積招差之理也甲恆爲隅朱書者長廉余則平廉立方之平廉長廉各三離居三方則成六角六觚形以六抱一毎層增六與立方加法同所異者六觚平面而立方必並其積故以堆垜象之若算六角堆垜但取其底之一面自乘再乘見積與立方同

以斜立面觀之最上甲一次乙二次丙三丁四戊五己六庚七辛八其底之數各如其層之數【如堆只三層則以三丙爲底四層則四丁爲底毎多一層其各面之底必多一數若辛下再加一層爲壬必九數也】

實計其毎面六觚之數則甲一乙七丙十九丁三十七戊六十一己九十一庚一百二十七辛一百六十九【前平視之圖乙爲甲掩故但見外圍之六丙爲乙掩故但見外圍十二餘皆若是也觀者當置身於髙處從甲頂俯視卽得其理】皆以外圍之數爲下層多於上層之數

合計其堆垜之積則甲一乙八丙二十七丁六十四戊一百二十五己二百一十六庚三百四十三辛五百一十二【乙七並甲一成八丙十九並乙七甲一成二十七餘皆若是】其堆垜之積皆如其層數之立方【以底之一面余乘又以層數乘之也】

問平差之根是以段日除積差而得則毎日適得一平差今所減平差甚多殆非實數曰泛平積差是初日多於第七日之數【亦據盈歷言之】而平差之數旣如段日則於日數爲加倍【盈歷段日十四日奇以此分積差爲毎日平差則平差共數亦十四奇於七日爲加倍】今倍減平差正合積差原數豈患其多

曰若然又何以能合平方曰以本日實減之數與定差較但取其銷盡積差已足【如第七日實減十三平差第八日實減十五平差七日有奇在其中半積差必當減盡】故其法若平方之廉隅若合計初日以來減過平差與初日以來定差相較則所減之積皆如平方自乘觀圖自明【如七日共數得四十九八日共數得六十四之類】

又如立差以段日自乘除泛立積差而得故其數亦略如段日之自乘而毎日實減亦如立方之廉隅聊足以銷去積差【本日尙有餘秒後一日奇減盡】若合計初日以來共數則亦如立方再乘之積矣

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十三﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十三﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十三﹥

右圖以九限爲例【九限以後仿論】定差設十萬平差設一千立差設單一如法以本日加法並之爲平立合差【如圖平差立差各有加法故當並用】以平立合差減先日加分得本日加分合計從前加分爲本日盈縮積【或以本日加分加先日盈縮積得本日盈縮積亦同】

又簡法

置定差內減平差立差各一爲初日加分【又卽爲第一日盈縮積】別置平差倍之加入六立差爲初日平立合差以後毎於平立合差內加入六立差爲次日平立合差【餘同上】

用定差法

以日數乘立差得數加入平差再以日數乘之得數乃置定差以得數減之用其餘爲實復以日數乘之得本日盈縮積

置相近兩盈縮積相減得加分又置相近兩加分相減得平立合差亦同

定差本法

置定差以日數乘之得數爲實又以日數自乘用乘平差得數以日數再自乘用乘立差得數平立兩得數並之爲法法減實得盈縮積【餘同上】

歷算全書卷十三﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

序

歷元起冬至其來舊矣易復卦傳曰先王以至日閉闗商旅不行後不省方孟子曰天之髙也星辰之逺也茍求其故千嵗之日至可坐而致故古來治歷者其立算並起冬至夫有所受之也欲驗將來必推已往所謂求其故也秦炬以前古術難徵惟春秋左氏傳僖公五年春王正月辛亥朔日南至公旣視朔遂登觀臺以望而書此冬至之有日名灼然可據者自漢以後漸講於測景之法然測景最難眞確載在史書可信者不過數十條故元時許衡王恂郭守敬等造授時歷據之以考歷法之疎密也古今歷法七十餘家皆由疎以至密必取其最密者以相參考而其說始定是故唐歷莫善於大衍其次莫善於宣明宋歷莫善於紀元尢莫善於統天金歷莫善於趙知微而授時歷集其大成故以此六家互相稽考也今依其本法求之則合於當時者或戾於古合於古者又不效於今惟授時統天能上考下求而多所合由是觀之歷學之古疎今密約略可見而嵗起冬至則嵗實之古大今小較然不誣卽統天授時上考下求百年消長之法亦自有據並可以深思而得其故矣【按百年消長之法統天曆術中已暗藏其數至授時乃發明之郭太史自言創法五端原未及此】元史歷議已具錄六歷所得日名離合之端然未詳算法玆特各依其本法詳衍使學歷者攷焉宣城梅文鼎

欽定四庫全書

歷算全書卷十四

宣城梅文鼎撰

冬至攷

唐宋金元六家算冬至本術

唐開元大衍歷【僧一行造】演紀上元閼逢困惇之歳距開元十二年甲子積九千六百九十六萬一千七百四十算

通法三千○四十

策實百一十一萬○三百四十三

策餘萬五千九百四十三

策實乘積算曰中積分盈通法而一爲積日爻數去之餘起甲子算外得天正中气

辰法七百六十【卽半辰法】

刻法三百○四

凡發斂加時各置其小餘以六爻乘之辰法而一爲半辰之數不盡進位六約爲分分滿刻法爲刻命辰起子半算外

唐宣明歷【徐昻造】通法曰統法策實曰章歳策余曰通餘爻數曰紀法通紀法爲分曰旬周章歳乘年曰通積分演紀上元甲子至長慶二年壬寅積七百○七萬○一百三十八算外

統法八千四百

章嵗三百○六萬八千○五十五

通餘四萬四千○五十五

刻法八十四

辰法七百

半辰法三百五十

宋崇寧紀元歷演紀上元上章執徐之歳距元符三年庚辰嵗積二千八百六十一萬三千四百六十算至崇寧五年丙戌歳積二千八百六十一萬三千四百六十六算

日法七千二百九十

辰法一千二百一十五

半辰法六百○七半刻法七百二十九

期實二百六十六萬二千六百二十六

歳周三百六十五日餘一千七百七十六

旬周四十三萬七千四百

紀法六十

置積年期實乘之爲气積分滿旬周去之不滿日法而一爲大餘命己卯卽所求天正冬至日辰及余其小餘倍之辰法而一爲辰數不滿五因刻法而一爲刻數

勿庵法小餘進一位刻法收之爲刻不盡爲刻分刻加二退位得時

金趙知微重修大明歷演紀上元甲子距大定二十年庚子八千八百六十三萬九千六百五十六年【大定庚子卽宋孝宗淳熈七年距元至元辛巳一百一年】

日法五千二百三十分

歳實一百九十一萬○二百二十四

通餘二萬七千四百二十四

旬周三十一萬三千八百

紀法六十

歳實乘積年爲通積分旬周去之不滿日法約之爲大餘命甲子

辰法二千六百一十五半辰法一千三百○七半刻法三百一十三秒八十

凡小餘六因之辰法除之不盡刻法除之爲刻

宋統天歷演紀上元甲子歳距紹熈五年甲寅積三千八百三十【至慶元己未歳積三千八百三十五至至元辛巳歳積三千九百一十七】策法一萬二千

歳分四百三十八萬二千九百一十餘六萬二九一气差二十三萬七千八百一十一【法通得一十九日八一七五】斗分差一百二十七

紀實七十二萬

歳分乘積算气差減之爲气泛積

積算距算相減爲距差斗分差乘之萬約【萬約者萬分爲分萬秒爲秒也半以上收爲秒半以下則棄之矣】爲躔差【小分半以上從秒一】復以距差乘之【秒半以上從分一】以減泛積爲气定積滿紀實去之餘如策法而一爲大餘【如其年無躔差及距差乘躔差不滿秒以上者以泛爲定】鼎按此卽授時歷加減嵗余法也積算減距算爲距差者距紹熈甲寅爲算也斗分差乘距差爲躔差者百年加減一分也授時毎百年加減一分統天則一分零六秒弱復以距差乘躔差者百年加減一分奇而又以其距年乘之也假如百年授時加減積百分統天則百有六分弱減泛積爲定者授時不立元明以當時所測截算爲主故有上考下求之別而加減亦明統天則𨿽以當時所測截算爲主而又立元故只用減所求在距算以後減之則冬至差而早早則其嵗實減矣所求在距算以前減之則冬至益早早則其嵗實加矣減之而歳實減人知之減之而嵗實加人不知之此算家轉換之法也若距差乘躔差不滿秒半以上者是所求正在紹熈前後百年內其嵗實平故無加減而以泛爲定

元授時歷【許衡王恂郭守敬造】不用積年據實測至元十八年辛巳嵗前天正冬至爲元上考下求皆距此起算

日法一萬分

紀法六十萬

嵗實三百六十五萬二四二五【上考者毎百年長一分下求者毎百年消一分】气應五十五萬六百分

距算乘嵗實爲中積加气應爲通積滿紀法去之得數爲天正冬至上考者以气應減中積爲通積滿紀法去之餘以減紀法得數爲冬至【並起甲子算外命其日辰】小餘以十二乘之滿萬爲一時命起子正滿五千又進一時命起子初算外得時不滿者以一千二百除之爲刻

春秋以來冬至日名六歷異同詳衍

【按春秋以來冬至多矣而所攷只此者以其測驗之可據也歷議原載四十八事今攷獻公在春秋前無信史可徴故刪之而以左傳僖公一條爲首實四十七事也】

魯僖公五年丙寅歳正月辛亥朔旦冬至

大衍歷【積算九千六百九十六萬○三百六十二】中積分【一百○七兆六千五百九十二億五千九百二十二萬四千一百六十六】冬至【大餘四十七日小餘二千八百八十六】辛亥日【九十四刻太彊】亥正三刻

宣明歷【積算七百○六萬八千六百六十二】通積分【二十一兆六千八百七十○億四千三百七十九萬二千四百一十】冬至【大餘四十七日小餘五千六百一十】

辛亥日【六十六刻太彊】申正初刻

紀元歷【積算二千八百六十一萬一千七百○六】气積分【七十六兆一千八百二十二億七千二百二十九萬九千九百五十六】冬至【大餘三十三日小餘六千一百八十六】壬子日【八十四刻太彊】戌正一刻

統天歷【積算一千九百八十二】距差【一千八百四十分】躔差【二十三八五】減分【四萬三千四百二十八】气泛積【八十六億八千六百六十八萬九千八百○九】气定積【八十六億八千六百六十四萬六千三百七十一】冬至【大餘四十七日小餘二千三百七十一】

辛亥日【一十九刻太彊】寅正三刻

重修大明歷【積算八千八百六十三萬七千八百二十二】通積分【一百六十九兆三千一百八十○億九千四百八十九萬二千一百二十八】冬至【大餘四十八日小餘四千六百八十八】

壬子日【八十九刻半彊】亥初二刻

授時歷【距算一千九百三十五】歳余【二四四四】中積分【七十○億六千七百四十七萬九一四○】通積分【七十○億六千六百九十二萬八五四○】冬至【四十七萬一四六○】

辛亥日【一十四刻半彊】寅初二刻

魯昭公二十年己夘歳正月己丑朔旦冬至

大衍歷【積算九千六百九十六萬○四百九十四】中積分【一百○七兆六千五百九十四億○六百八十九萬九千七百八十五】冬至【大餘二十五日小餘一千三百八十五】己丑日【四十五刻半彊】已正三刻

宣明歷【積算七百○六萬八千七百九十四】通積分【二十一兆六千八百七十四億五千一百八十四萬三千七百二十五】冬至【大餘二十五日小餘一千七百二十五】己丑日【二十刻半彊】寅正三刻

紀元歷【積算二千八百六十一萬一千八百三十八】气積分【七十六兆一千八百二十六億二千六百四十二萬九千二百一十四】冬至【大餘一十一日小餘一千八百二十四】庚寅日【二十五刻少弱】卯正初刻

統天歷【積算二千一百一十五】距差【一千七百一十五】躔差【二十一分八】減分【三萬七千三百八十七】气泛積【九十二億六千九百六十一萬六千八百三十九】气定積【九十二億六千九百五十七萬九千四百五十二】冬至【大餘二十四日小餘一萬一千四百五十二】

戊子日【九十五刻半弱】亥正三刻

重修大明歷【積算八千八百六十三萬七千九百五十五】通積分【一百六十九兆三千一百八十三億四千八百九十五萬一千九百二十】冬至【大餘二十六日小餘一千五百四十】

庚寅日【二十九刻半弱】辰初初刻

授時歷【距算一千八百○二】歳余【二四四三】中積分【六十五億八千一百七十○萬二二八六】通積分【六十五億八千一百一十五萬一六八六】冬至【二十四萬八三一四】戊子日【八十三刻彊】戌初三刻

劉宋文帝元嘉十二年乙亥歳十一月十五日戊辰景長

大衍歷【積算九千六百九十六萬一千四百五十二】中積分【一百○七兆六千六百○四億六千九百四十九萬八千○三十六】冬至【大餘四日小餘一千○七十六】

戊辰日【三十五刻少彊】辰正二刻

宣明歷【積算七百○六萬九千七百五十二】通積分【二十一兆六千九百○二億八千七百九十七萬二千三百六十】冬至【大餘四日小餘二千七百六十】

戊辰日【三十二刻太彊】辰初三刻

紀元歷【積算二千八百六十一萬二千七百九十六】气積分【七十六兆一千八百五十一億七千四百五十六萬二千二百九十六】冬至【大餘四十九日小餘二千八百八十六】戊辰日【三十九刻半彊】巳初二刻

統天歷【積算三千○七十二】距差【七百五十八】躔差【九分六】減分【七千二百七十七】气泛積【一百三十四億六千四百○六萬一千七百○九】气定積【一百三十四億六千四百○五萬四千四百三十二】冬至【大餘四日小餘六千四百三十二】戊辰日【五十三刻半彊】午正三刻

重修大明歷【積算八千八百六十三萬八千九百一十二】通積分【一百六十九兆三千二百○一億七千七百○三萬六千二百八十八】冬至【大餘四日小餘二千一百六十八】

戊辰日【四十一刻半弱】巳初三刻

授時歷【距算八百四十五】歳余【二四三三】中積分【三十○億八千六百三十○萬五八八五】通積分【三十○億八千五百七十五萬五二八五】冬至【四萬四七一五】戊辰日【四十七刻彊】午初一刻

元嘉十三年丙子歳十一月二十六日甲戌景長大衍歷【積算九千六百九十六萬一千四百五十三】中積分【一百○七兆六千六百○四億七千○六十○萬八千三百七十九】冬至【大餘九日小餘一千八百一十九】癸酉日【五十九刻太彊】未正一刻

宣明歷【積算七百○六萬九千七百五十三】通積分【二十一兆六千九百○三億九千一百○四萬○四百一十五】冬至【大餘九日小餘四千八百一十五】

癸酉日【五十七刻少彊】未初三刻

紀元歷【積算二千八百六十一萬二千七百九十七】气積分【七十六兆一千八百五十一億七千七百二十二萬四千九百二十二】冬至【大餘五十四日小餘四千六百六十二】癸酉日【六十四刻弱】申初一刻

統天歷【積算三千○七十三】距差【七百五十七】躔差【九分六】減分【七千二百六十七】气泛積【一百三十四億六千八百四十四萬四千六百一十九】气定積【一百三十四億六千八百四十三萬七千三百五十二】冬至【大餘九日小餘九千三百五十二】

癸酉日【七十七刻太彊】酉正二刻

重修大明歷【積算八千八百六十三萬八千九百一十三】通積分【一百六十九兆三千二百○一億七千八百九十四萬六千五百一十二】冬至【大餘九日小餘三千四百四十二】

癸酉日【六十五刻太彊】申初三刻

授時歷【距算八百四十四】歳余【二四三三】中積分【三十○億八千二百六十五萬三四五二】通積分【三十○億八千二百一十○萬二八五二】冬至【九萬七一四八】癸酉日【七十一刻半弱】酉初初刻先一日

元嘉十五年戊寅歳十一月十八日甲申景長

大衍歷【積算九千六百九十六萬一千四百五十五】中積分【一百○七兆六千六百○四億七千二百八十二萬九千○六十五】冬至【大餘二十日小餘二百六十五】

甲申日【八刻太弱】醜正初刻

宣明歷【積算七百○六萬九千七百五十五】通積分【二十一兆六千九百○三億九千七百一十七萬六千五百二十五】冬至【大餘二十日小餘五百二十五】

甲申日【六刻少】丑初二刻

紀元歷【積算二千八百六十一萬二千七百九十九】气積分【七十六兆一千八百五十一億八千二百五十五萬○一百七十四】冬至【大餘五日小餘九百二十四】

甲申日【一十二刻半彊】寅初初刻

統天歷【積算三千○七十五】距差【七百五十五】躔差【九分六】減分【七千二百四十八】气泛積【一百三十四億七千七百二十一萬○四百三十九】气定積【一百三十四億七千七百二十○萬三千一百九十一】冬至【大餘二十日小餘三千一百九十一】甲申日【二十六刻半彊】卯正一刻

重修大明歷【積算八千八百六十三萬八千九百一十五】通積分【一百六十九兆三千二百○一億八千二百七十六萬六千九百六十】冬至【大餘二十日小餘七百六十】甲申日【一十四刻半彊】寅初二刻

授時歷【距算八百四十二】歳余【二四三三】中積分【三十○億七千五百三十四萬八五八六】通積分【三十○億七千四百七十九萬七九八六】冬至【二十○萬二○一四】甲申日【二十刻彊】寅正三刻

元嘉十六年己卯嵗十一月二十九日己丑景長大衍歷【積算九千六百九十六萬一千四百五十六】中積分【一百○七兆六千六百○四億七千三百九十三萬九千四百○八】冬至【大餘二十五日小餘一千○○八】己丑日【三十三刻彊】辰初三刻

宣明歷【積算七百○六萬九千七百五十六】通積分【二十一兆六千九百○四億○○二十四萬四千五百八十】冬至【大餘二十五日小餘二千五百八十】

己丑日【三十刻太弱】辰初一刻

紀元歷【積算二千八百六十一萬二千八百】气積分【七十六兆一千八百五十一億八千五百二十一萬二千八百】冬至【大餘一十日小餘二千七百】

己丑日【三十七刻彊】辰正三刻

統天歷【積算三千○七十六】距差【七百五十四】躔差【九分六】減分【七千二百三十八】气泛積【一百三十四億八千一百五十九萬三千三百四十九】气定積【一百三十四億八千一百五十八萬六千一百一十一】冬至【大餘二十五日小餘六千一百一十一】

己丑日【五十刻太彊】午正初刻

重修大明歷【積算八千八百六十三萬八千九百一十六】通積分【一百六十九兆三千二百○一億八千四百六十七萬七千一百八十四】冬至【大餘二十五日小餘二千○三十四】

己丑日【三十八刻太彊】巳初一刻

授時歷【距算八百四十一】歳余【二四三三】中積分【三十○億七千一百六十九萬六一五三】通積分【三十○億七千一百一十四萬五五五三】冬至【二十五萬四四四七】己丑日【四十四刻半弱】巳正二刻

元嘉十七年庚辰歳十一月初十日甲午景長

大衍歷【積算九千六百九十六萬一千四百五十七】中積分【一百○七兆六千六百○四億七千五百○四萬九千七百五十一】冬至【大餘三十日小餘一千七百五十一】甲午日【五十七刻半彊】未初三刻

宣明歷【積算七百○六萬九千七百五十七】通積分【二十一兆六千九百○四億○三百三十一萬二千六百三十五】冬至【大餘三十日小餘四千六百三十五】

甲午日【五十五刻少弱】未初初刻

紀元歷【積算二千八百六十一萬二千八百○一】气積分【七十六兆一千八百五十一億八千七百八十七萬五千四百二十六】冬至【大餘一十五日小餘四千四百七十六】甲午日【六十一刻半弱】未正三刻

統天歷【積算三千○七十七】距差【七百五十三】躔差【九分六】減分【七千二百二十九】气泛積【一百三十四億八千五百九十七萬六千二百五十九】气定積【一百三十四億八千五百九十六萬九千○三十○】冬至【大餘三十日小餘九千○三十○】甲午日【七十五刻少】酉正初刻

重修大明歷【積算八千八百六十三萬八千九百一十七】通積分【一百六十九兆三千二百○一億八千六百五十八萬七千四百○八】冬至【大餘三十日小餘三千三百○八】

甲午日【六十三刻少】申初初刻

授時歷【距算八百四十】歳余【二四三三】中積分【三十○億六千八百○四萬三七二○】通積分【三十○億六千七百四十九萬三千一百二十○】冬至【三十○萬六八八○】

甲午日【六十八刻太彊】申正二刻

元嘉十八年辛巳嵗十一月二十一日己亥景長大衍歷【積算九千六百九十六萬一千四百五十九】中積分【一百○七兆六千六百○四億七千六百一十六萬○○九十四】冬至【大餘三十五日小餘二千四百九十四】己亥日【八十二刻彊】戌初二刻

宣明歷【積算七百○六萬九千七百五十八】通積分【二十一兆六千九百○四億○六百三十八萬○六百九十】冬至【大餘三十五日小餘六千六百九十】

己亥日【七十九刻少弱】酉正四刻

紀元歷【積算二千八百六十一萬二千八百○二】气積分【七十六兆一千八百五十一億九千○五十三萬八千○五十二】冬至【大餘二十日小餘六千二百五十二】

己亥日【八十五刻太彊】戌正二刻

統天歷【積算三千○七十八】距差【七百五十二】躔差【九分六】減分【七千二百一十九】气泛積【一百三十四億九千○三十五萬九千一百六十九】气定積【一百三十四億九千○三十五萬一千九百五十○】冬至【大餘三十五日小餘一萬一千九百五十○】

己亥日【九十九刻半彊】夜子初三刻

重修大明歷【積算八千八百六十三萬八千九百一十八】通積分【一百六十九兆三千二百○一億八千八百四十九萬七千六百三十二】冬至【大餘三十五日小餘四千五百八十二】

己亥日【八十七刻半彊】亥初初刻

授時歷【距算八百三十九】歳余【二四三三】中積分【三十○億六千四百三十九萬一千二百八七】通積分【三十○億六千三百八十四萬○六八七】冬至【三十五萬九三一三】

己亥日【九十三刻彊】亥正一刻

元嘉十九年壬午歳十一月初三日乙巳景長

大衍歷【積算九千六百九十六萬一千四百五十九】中積分【一百○七兆六千六百○四億七千七百二十七萬○四百三十七】冬至【大餘四十一日小餘一百九十七】乙巳日【六刻半弱】丑初二刻

宣明歷【積算七百○六萬九千七百五十九】通積分【二十一兆六千九百○四億○九百四十四萬八千七百四十五】冬至【大餘四十一日小餘三百四十五】

乙巳日【四刻彊】子正四刻

紀元歷【積算二千八百六十一萬二千八百○三】气積分【七十六兆一千八百五十一億九千三百二十○萬○六百七十八】冬至【大餘二十六日小餘七百三十八】

乙巳日【一十刻彊】醜正一刻

統天歷【積算三千○七十九】距差【七百五十一】躔差【九分五】減分【七千一百三十四】气泛積【一百三十四億九千四百七十四萬二千○七十九】气定積【一百三十四億九千四百七十三萬四千九百四十五】冬至【大餘四十一日小餘二千九百四十五】

乙巳日【二十四刻半弱】卯初三刻

重修大明歷【積算八千八百六十三萬八千九百一十九】通積分【一百六十九兆三千二百○一億九千○四十○萬七千八百五十六】冬至【大餘四十一日小餘六百二十六】

乙巳日【一十二刻弱】醜正三刻

授時歷【距算八百三十八】歳余【二四三三】中積分【三十○億六千○七十三萬八千八百五十四】通積分【三十○億六千○一十八萬八二五四】冬至【四十一萬一七四六】

乙巳日【一十七刻半弱】寅正初刻

孝武帝大明五年辛丑嵗十一月乙酉冬至

大衍歷【積算九千六百九十六萬一千四百七十八】中積分【一百○七兆六千六百○四億九千八百三十六萬六千九百五十四】冬至【大餘二十日小餘二千一百五十四】甲申日【七十刻太彊】申正四刻

宣明歷【積算七百○六萬九千七百七十八】通積分【二十一兆六千九百○四億六千七百七十四萬一千七百九十】冬至【大餘二十日小餘五千七百九十】

甲申日【六十九刻弱】申正二刻

紀元歷【積算二千八百六十一萬二千八百二十二】气積分【七十六兆一千八百五十二億四千三百七十九萬○五百七十二】冬至【大餘五日小餘五千三百二十二】甲申日【七十三刻彊】酉初二刻

統天歷【積算三千○九十八】距差【七百三十二】躔差【九分三】減分【七千八百○八】气泛積【一百三十五億七千八百○一萬七千三百六十九】气定積【一百三十五億七千八百○○萬九千五百六十一】冬至【大餘二十日小餘九千五百六十一】甲申日【七十九刻太弱】戌初初刻

重修大明歷【積算八千八百六十三萬八千九百三十八】通積分【一百六十九兆三千二百○二億二千六百七十○萬二千一百一十二】冬至【大餘二十日小餘三千九百一十二】

甲申日【七十四刻太彊】酉正一刻

授時歷【距算八百一十九】嵗余【二四三三】中積分【二十九億九千一百三十四萬二千六百二七】通積分【二十九億九千○七十九萬二○二七】冬至【二十○萬七九七三】

甲申日【七十九刻太弱】戌初初刻先一日

陳文帝天嘉六年乙酉嵗十一月庚寅景長

大衍歷【積算九千六百九十六萬一千五百八十二】中積分【一百○七兆六千六百○六億一千三百八十四萬二千六百二十六】冬至【大餘二十六日小餘三百八十六】庚寅日【一十二刻太弱】寅初初刻

宣明歷【積算七百○六萬九千八百八十二】通積分【二十一兆六千九百○七億八千六百八十一萬九千五百一十】冬至【大餘二十六日小餘一千一百一十】

庚寅日【一十三刻少弱】寅初初刻

紀元歷【積算二千八百六十一萬二千九百二十六】气積分【七十六兆一千八百五十五億二千○七十○萬三千六百七十六】冬至【大餘一十一日小餘四百八十六】庚寅日【六刻太弱】丑初二刻

統天歷【積算三千二百○二】距差【六百二十八】躔差【八分】減分【五千○二十四】气泛積【一百四十○億三千三百八十四萬○○○九】气定積【一百四十○億三千三百八十三萬四千九百八十五】冬至【大餘二十六日小餘二千九百八十五】庚寅日【二十四刻太彊】卯初四刻

重修大明歷【積算八千八百六十三萬九千○四十二】通積分【一百六十九兆三千二百○四億二千五百三十六萬五千四百○八】冬至【大餘二十六日小餘四百二十八】庚寅日【八刻少弱】丑初四刻

授時歷【距算七百一十五】歳余【二四三二】中積分【二十六億一千一百四十八萬八千八百八十】通積分【二十六億一千○九十三萬八千二百八十】冬至【二十六萬一七二○】

庚寅日【一十七刻彊】寅正初刻

臨海王光大二年戊子嵗十一月乙巳景長

大衍歷【積算九千六百九十六萬一千五百八十五】中積分【一百○七兆六千六百○六億一千七百一十七萬三千六百五十五】冬至【大餘四十一日小餘二千六百一十五】乙巳日【八十六刻彊】戍正二刻

宣明歷【積算七百○六萬九千八百八十五】通積分【二十一兆六千九百○七億九千六百○二萬三千六百七十五】冬至【大餘四十一日小餘七千二百七十五】

乙巳日【八十六刻半彊】戌正三刻

紀元歷【積算二千八百六十一萬二千九百二十九】气積分【七十六兆一千八百五十五億二千八百六十九萬一千五百五十四】冬至【大餘二十六日小餘五千八百一十四】乙巳日【七十九刻太彊】戍初初刻

統天歷【積算三千二百○五】距差【六百二十五】躔差【七分九】減分【四千九百三十八】气泛積【一百四十○億四千六百九十八萬八千七百三十九】气定積【一百四十○億四千六百九十八萬三千八百○一】冬至【大餘四十一日小餘一萬一千八百○一】

乙巳日【九十八刻少彊】夜子初二刻

重修大明歷【積算八千八百六十三萬九千○四十五】通積分【一百六十九兆三千二百○四億三千一百○九萬六千○八十】冬至【大餘四十一日小餘四千二百五十】乙巳日【八十一刻少彊】戌初二刻

授時歷【距算七百一十二】歳余【二四三二】中積分【二十六億○○五十三萬一千五百八四】通積分【二十五億九千九百九十八萬○九百八十有四】冬至【四十一萬九○一六】

乙巳日【九十刻彊】戌初二刻

宣帝太建四年壬辰嵗十一月二十九日丁卯景長大衍歷【積算九千六百九十六萬一千五百八十九】中積分【一百○七兆六千六百○六億二千一百六十一萬五千○二十七】冬至【大餘二日小餘二千五百四十七】丙寅日【八十三刻太彊】戌正初刻

宣明歷【積算七百○六萬九千八百八十九】通積分【二十一兆六千九百○八億○八百二十九萬五千八百九十五】冬至【大餘二日小餘七千○九十五】

丙寅日【八十四刻半弱】戌正一刻

紀元歷【積算二千八百六十一萬二千九百三十三】气積分【七十六兆一千八百五十五億三千九百三十四萬二千○五十八】冬至【大餘四十七日小餘五千六百二十八】丙寅日【七十七刻少弱】酉正二刻

統天歷【積算三千二百○九】距差【六百二十一】躔差【七分九】減分【四千九百○六】气泛積【一百四十○億六千四百五十二萬○三百七十九】气定積【一百四十○億六千四百五十一萬五千四百七十三】冬至【大餘二日小餘一萬一千四百七十三】丙寅日【九十五刻半彊】亥正三刻

重修大明歷【積算八千八百六十三萬九千○四十九】通積分【一百六十九兆三千二百○四億三千八百七十三萬六千九百七十六】冬至【大餘二日小餘四千一百一十六】丙寅日【七十八刻太弱】酉正三刻

授時歷【距算七百○八】歳余【二四三二】中積分【二十五億八千五百九十二萬一八五六】通積分【二十五億八千五百三十七萬一二五六】冬至【二萬八七四四】丙寅日【八十七刻半弱】戌正四刻先一日

太建六年甲午嵗十一月二十日丁丑景長

大衍歷【積算九千六百九十六萬一千五百九十一】中積分【一百○七兆六千六百○六億二千三百八十三萬五千七百一十三】冬至【大餘一十三日小餘九百九十三】丁丑日【三十二刻半彊】辰初三刻

宣明歷【積算七百○六萬九千八百九十一】通積分【二十一兆六千九百○八億一千四百四十三萬二千○○五】冬至【大餘一十三日小餘二千八百○五】

丁丑日【三十三刻少彊】辰正初刻

紀元歷【積算二千八百六十一萬二千九百三十五】气積分【七十六兆一千八百五十五億四千四百六十六萬七千三百一十】冬至【大餘五十八日小餘一千六百九十】丁丑日【二十三刻少弱】卯初二刻

統天歷【積算三千二百一十一】距差【六百一十九】躔差【七分九】減分【四千八百九十○】气泛積【一百四十○億七千三百二十八萬六千一百九十九】气定積【一百四十○億七千三百二十八萬一千三百○九】冬至【大餘一十三日小餘五千三百○九】

丁丑日【四十四刻少弱】巳正二刻

重修大明歷【積算八千八百六十三萬九千○五十一】通積分【一百六十九兆三千二百○四億四千二百五十五萬七千四百二十四】冬至【大餘一十三日小餘一千四百三十四】

丁丑日【二十七刻半弱】卯正二刻

授時歷【距算七百○六】嵗余【二四三二】中積分【二十五億七千八百六十一萬六九九二】通積分【二十五億七千八百○六萬六三九二】冬至【一十三萬三六○八】丁丑日【三十六刻彊】辰正四刻

太建九年丁酉嵗十一月二十三日壬辰景長

大衍歷【積算九千六百九十六萬一千五百九十四】中積分【一百○七兆六千六百○六億二千七百一十六萬六千七百四十二】冬至【大餘二十九日小餘一百八十二】癸巳日【六刻弱】丑初一刻

宣明歷【積算七百○六萬九千八百九十四】通積分【二十一兆六千九百○八億二千三百六十三萬六千一百七十】冬至【大餘二十九日小餘五百七十】

癸巳日【六刻太彊】丑初二刻

紀元歷【積算二千八百六十一萬二千九百三十八】气積分【七十六兆一千八百五十五億五千二百六十五萬五千一百八十八】冬至【大餘一十三日小餘七千二百一十八】壬辰日【九十九刻彊】夜子初三刻

統天歷【積算三千二百一十四】距差【六百一十六】躔差【七分八】減分【四千八百○五】气泛積【一百四十○億八千六百四十三萬四千九百二十九】气定積【一百四十○億八千六百四十三萬○一百二十四】冬至【大餘二十九日小餘二千一百二十四】

癸巳日【一十七刻太弱】寅正一刻

重修大明歷【積算八千八百六十三萬九千○五十四】通積分【一百六十九兆三千二百○四億四千八百二十八萬八千○九十六】冬至【大餘二十九日小餘二十六】癸巳日【半刻弱】子正初刻

授時歷【距算七百○三】歳余【二四三二】中積分【二十五億六千七百六十五萬九六九六】通積分【二十五億六千七百一十○萬九○九六】冬至【二十九萬○九○四】癸巳日【九刻彊】醜正初刻後一日

太建十年戊戌歳十一月五日戊戌景長

大衍歷【積算九千六百九十六萬一千五百九十五】中積分【一百○七兆六千六百○六億二千八百二十七萬七千○八十五】冬至【大餘三十四日小餘九百二十五】戊戌日【三十刻半弱】辰初一刻

宣明歷【積算七百○六萬九千八百九十五】通積分【二十一兆六千九百○八億二千六百七十○萬四千二百二十五】冬至【大餘三十四日小餘二千六百二十五】

戊戌日【三十一刻少】辰初二刻

紀元歷【積算二千八百六十一萬二千九百三十九】气積分【七十六兆一千八百五十五億五千五百三十一萬七千八百一十四】冬至【大餘一十九日小餘一千七百○四】戊戌日【二十三刻少彊】卯初二刻

統天歷【積算三千二百一十五】距差【六百一十五】躔差【七分八】減分【四千七百九十七】气泛積【一百四十○億九千○八十一萬七千八百三十九】气定積【一百四十○億九千○八十一萬三千○四十二】冬至【大餘三十四日小餘五千○四十二】戊戌日【四十二刻彊】巳正初刻

重修大明歷【積算八千八百六十三萬九千○五十五】通積分【一百六十九兆三千二百○四億五千○一十九萬八千三百二十】冬至【大餘三十四日小餘一千三百】戊戌日【二十四刻太彊】卯初四刻

授時歷【距算七百○二】歳余【二四三二】中積分【二十五億六千四百○○萬七二六四】通積分【二十五億六千三百四十五萬六六六四】冬至【三十四萬三三三六】戊戌日【三十三刻少彊】辰正初刻

隋文帝開皇四年甲辰歳十一月十一日己巳景長大衍歷【積算九千六百九十六萬一千六百○一】中積分【一百○七兆六千六百○六億三千四百九十三萬九千一百四十三】冬至【大餘五日小餘二千三百四十三】己巳日【七十七刻彊】酉正二刻

宣明歷【積算七百○六萬九千九百○一】通積分【二十一兆六千九百○八億四千五百一十一萬二千五百四十五】冬至【大餘五日小餘六千五百四十五】

己巳日【七十八刻弱】酉正三刻

紀元歷【積算二千八百六十一萬二千九百四十五】气積分【七十六兆一千八百五十五億七千一百二十九萬三千五百七十】冬至【大餘五十日小餘七千○七十】

己巳日【九十七刻弱】夜子初一刻

統天歷【積算三千二百二十一】距差【六百○九】躔差【七分七】減分【四千六百八十九】气泛積【一百四十一億一千七百一十一萬五千二百九十九】气定積【一百四十一億一千七百一十一萬○六百一十】冬至【大餘五日小餘一萬○六百一十】己巳日【八十八刻半弱】戌初初刻

重修大明歷【積算八千八百六十三萬九千○六十一】通積分【一百六十九兆三千二百○四億六千一百六十五萬九千六百六十四】冬至【大餘五日小餘三千七百一十四】己巳日【七十一刻彊】酉初初刻

授時歷【距算六百九十六】嵗余【二四三一】中積分【二十五億四千二百六十九萬一九七六】通積分【二十五億四千二百一十四萬一三七六】冬至【五萬八六二四】己巳日【八十六刻少】戌正二刻

開皇五年乙巳嵗十一月二十二日乙亥景長

大衍歷【積算九千六百九十六萬一千六百○二】中積分【一百○七兆六千六百○六億三千六百○四萬九千四百八十六】冬至【大餘一十一日小餘四十六】

乙亥日【一刻半彊】子正一刻

宣明歷【積算七百○六萬九千九百○二】通積分【二十一兆六千九百○八億四千八百一十八萬○六百一十】冬至【大餘一十一日小餘二百一十】

乙亥日【二刻半】子正二刻

紀元歷【積算二千八百六十一萬二千九百四十六】气積分【七十六兆一千八百五十五億七千三百九十五萬六千一百九十六】冬至【大餘五十五日小餘六千八百四十六】甲戌日【九十四刻弱】亥正二刻

統天歷【積算三千二百二十二】距差【六百○八】躔差【七分七】減分【四千六百八十二】气泛積【一百四十一億二千一百四十九萬八千二百○九】气定積【一百四十一億二千一百四十九萬三千五百二十七】冬至【大餘一十一日小餘一千五百二十七】

乙亥日【一十二刻太弱】寅初初刻

重修大明歷【積算八千八百六十三萬九千○六十二】通積分【一百六十九兆三千二百○四億六千三百五十六萬九千八百八十八】冬至【大餘一十日小餘四千九百八十八】甲戌日【九十五刻少彊】戌正三刻

授時歷【距算六百九十五】歳余【二四三一】中積分【二十五億三千九百○三萬九五四五】通積分【二十五億三千八百四十八萬八九四五】冬至【一十一萬一○五五】乙亥日【十刻半彊】醜正二刻

開皇六年丙午歳十一月三日庚辰景長

大衍歷【積算九千六百九十六萬一千六百○三】中積分【一百○七兆六千六百○六億三千七百一十五萬九千八百二十九】冬至【大餘一十六日小餘七百八十九】庚辰日【二十六刻弱】卯正初刻

宣明歷【積算七百○六萬九千九百○三】通積分【二十一兆六千九百○八億五千一百二十四萬八千六百六十五】冬至【大餘一十六日小餘二千二百六十五】

庚辰日【二十七刻弱】卯正一刻

紀元歷【積算二千八百六十一萬二千九百四十七】气積分【七十六兆一千八百五十五億七千六百六十一萬八千八百二十二】冬至【大餘一日小餘一千三百三十二】庚辰日【一十八刻少彊】寅正一刻

統天歷【積算三千二百二十三】距差【六百○七】躔差【七分七】減分【四千六百七十四】气泛積【一百四十一億二千五百八十八萬一千一百一十九】气定積【一百四十一億二千五百八十七萬六千四百四十五】冬至【大餘一十六日小餘四千四百四十五】

庚辰日【三十七刻彊】辰正三刻

重修大明歷【積算八千八百六十三萬九千○六十三】通積分【一百六十九兆三千二百○四億六千五百四十八萬○一百一十二】冬至【大餘一十六日小餘一千○三十二】庚辰日【一十九刻太弱】寅正三刻

授時歷【距算六百九十四】歳余【二四三一】中積分【二十五億三千五百三十八萬七一一四】通積分【二十五億三千四百八十三萬六五一四】冬至【一十六萬三四八六】庚辰日【三十四刻太彊】辰正一刻

開皇七年丁未歳十一月十四日乙酉景長

大衍歷【積算九千六百九十六萬一千六百○四】中積分【一百○七兆六千六百○六億三千八百二十七萬○一百七十二】冬至【大餘二十一日小餘一千五百三十二】乙酉日【五十刻少彊】午正初刻

宣明歷【積算七百○六萬九千九百○四】通積分【二十一兆六千九百○八億五千四百三十一萬六千七百二十】冬至【大餘二十一日小餘四千三百二十】

乙酉日【五十一刻半弱】午正一刻

紀元歷【積算二千八百六十一萬二千九百四十八】气積分【七十六兆一千八百五十五億七千九百二十八萬一千四百四十八】冬至【大餘六日小餘三千一百○八】乙酉日【四十二刻半彊】巳正初刻

統天歷【積算三千二百二十四】距差【六百○六】躔差【七分七】減分【四千六百六十六】气泛積【一百四十一億三千○二十六萬四千○二十九】气定積【一百四十一億三千○二十五萬九千二百六十三】冬至【大餘二十一日小餘七千三百六十三】乙酉日【六十一刻少彊】未正三刻

重修大明歷【積算八千八百六十三萬九千○六十四】通積分【一百六十九兆三千二百○四億六千七百三十九萬○三百三十六】冬至【大餘二十一日小餘二千三百○六】乙酉日【四十四刻彊】巳正二刻

授時歷【距算六百九十三】嵗余【二四三一】中積分【二十五億三千一百七十三萬四六八三】通積分【二十五億三千一百一十八萬四○八三】冬至【二十一萬五九一七】乙酉日【五十九刻彊】未正初刻

開皇十一年辛亥歳十一月二十八日丙午景長大衍歷【積算九千六百九十六萬一千六百○八】中積分【一百○七兆六千六百○六億四千二百七十一萬一千五百四十四】冬至【大餘四十二日小餘一千四百六十四】丙午日【四十八刻彊】午初二刻

宣明歷【積算七百○六萬九千九百○八】通積分【二十一兆六千九百○八億六千六百五十八萬八千九百四十】冬至【大餘四十二日小餘四千一百四十】

丙午日【四十九刻少彊】午初三刻

紀元歷【積算二千八百六十一萬二千九百五十二】气積分【七十六兆一千八百五十五億八千九百九十三萬一千九百五十二】冬至【大餘二十七日小餘二千九百二十二】丙午日【四十刻彊】巳初二刻

統天歷【積算三千二百二十八】距差【六百○二】躔差【七分六】減分【四千五百七十五】气泛積【一百四十一億四千七百七十九萬五千六百六十九】气定積【一百四十一億四千七百七十九萬一千○九十四】冬至【大餘四十二日小餘七千○九十四】丙午日【五十九刻彊】未正初刻

重修大明歷【積算八千八百六十三萬九千○六十八】通積分【一百六十九兆三千二百○四億七千五百○三萬一千二百三十二】冬至【大餘四十二日小餘二千一百七十二】

丙午日【四十一刻半彊】巳初四刻

授時歷【距算六百八十九】歳余【二四三一】中積分【二十五億一千七百一十二萬四九五九】通積分【二十五億一千六百五十七萬四三五九】冬至【四十二萬五六四一】丙午日【五十六刻半弱】未初二刻

開皇十四年甲寅歳十一月辛酉朔旦冬至

大衍歷【積算九千六百九十六萬一千六百一十一】中積分【一百○七兆六千六百○六億四千六百○四萬二千五百七十三】冬至【大餘五十八日小餘六百五十三】壬戌日【二十一刻半弱】卯初初刻

宣明歷【積算七百○六萬九千九百一十一】通積分【二十一兆六千九百○八億七千五百七十九萬三千一百○五】冬至【大餘五十八日小餘一千九百○五】

壬戌日【二十三刻弱】卯初二刻

紀元歷【積算二千八百六十一萬二千九百五十五】气積分【七十六兆一千八百五十五億九千七百九十一萬九千八百三十】冬至【大餘四十三日小餘九百六十】

壬戌日【一十三刻少弱】寅初初刻

統天歷【積算三千二百三十一】距差【五百九十九】躔差【七分六】減分【四千五百五十二】气泛積【一百四十一億六千○九十四萬四千三百九十九】气定積【一百四十一億六千○九十三萬九千八百四十七】冬至【大餘五十八日小餘三千八百四十七】

壬戌日【三十二刻彊】辰初二刻

重修大明歷【積算八千八百六十三萬九千○七十一】通積分【一百六十九兆三千二百○四億八千○七十六萬一千九百○四】冬至【大餘五十八日小餘七百六十四】壬戌日【一十四刻半彊】寅初二刻

授時歷【距算六百八十六】嵗余【二四三一】中積分【二十五億○六百一十六萬七六六六】通積分【二十五億○五百六十一萬七○六六】冬至【五十八萬二九三四】壬戌日【二十九刻少彊】辰初初刻

唐太宗貞觀十八年甲辰嵗十一月乙酉景長

大衍歷【積算九千六百九十六萬一千六百六十一】中積分【一百○七兆六千六百○七億○一百五十五萬九千七百二十三】冬至【大餘二十日小餘一千三百二十三】甲申日【四十三刻半彊】巳正一刻

宣明歷【積算七百○六萬九千九百六十一】通積分【二十一兆六千九百一十○億二千九百一十九萬五千八百五十五】冬至【大餘二十日小餘三千八百五十五】

甲申日【四十五刻太彊】午初初刻

紀元歷【積算二千八百六十一萬三千○○一】气積分【七十六兆一千八百五十七億三千一百○五萬一千一百三十】冬至【大餘五日小餘二千二百八十】

甲申日【三十一刻少彊】辰初二刻

統天歷【積算三千二百八十一】距差【五百四十九】躔差【七分】減分【三千八百四十三】气泛積【一百四十三億八千○○八萬九千八百九十九】气定積【一百四十三億八千○○八萬六千○五十六】冬至【大餘二十日小餘六千○五十六】甲申日【五十刻彊】午正初刻

重修大明歷【積算八千八百六十三萬九千一百二十一】通積分【一百六十九兆三千二百○五億七千六百二十七萬三千一百○四】冬至【大餘二十日小餘一千七百○四】

甲申日【三十二刻半彊】辰初三刻

授時歷【距算六百三十六】歳余【二四三一】中積分【二十三億二千三百五十四萬六一一六】通積分【二十三億二千二百九十九萬五五一六】冬至【二十○萬四四八四】甲申日【四十四刻太彊】巳正三刻

貞觀二十三年己酉歳十一月辛亥景長

大衍歷【積算九千六百九十六萬一千六百六十六】中積分【一百○七兆六千六百○七億○七百一十一萬一千四百三十八】冬至【大餘四十六日小餘一千九百九十八】庚戌日【六十五刻太弱】申初二刻

宣明歷【積算七百○六萬九千九百六十六】通積分【二十一兆六千九百一十○億四千四百五十三萬六千一百三十】冬至【大餘四十六日小餘五千七百三十】

庚戌日【六十八刻少弱】申正一刻

紀元歷【積算二千八百六十一萬三千○一十】气積分【七十六兆一千八百五十七億四千四百三十六萬四千二百六十】冬至【大餘三十一日小餘三千八百七十】

庚戌日【五十三刻彊】午正三刻

統天歷【積算三千二百八十六】距差【五百四十四】躔差【六分九】減分【三千七百五十四】气泛積【一百四十四億○二百○○萬四千四百四十九】气定積【一百四十四億○二百○○萬○六百九十五】冬至【大餘四十六日小餘八千六百九十五】庚戌日【七十二刻半弱】酉初一刻

重修大明歷【積算八千八百六十三萬九千一百二十六】通積分【一百六十九兆三千二百○五億八千五百八十二萬四千二百二十四】冬至【大餘四十六日小餘二千八百四十四】

庚戌日【五十四刻少彊】未初初刻

授時歷【距算六百三十一】嵗余【二四三一】中積分【二十三億○五百二十八萬三九六一】通積分【二十三億○四百七十三萬三三六一】冬至【四十六萬六六三九】庚戌日【六十六刻少彊】申初三刻

髙宗龍朔二年壬戌嵗十一月四日己未至戊午景長大衍歷【積算九千六百九十六萬一千六百七十九】中積分【一百○七兆六千六百○七億二千一百五十四萬五千八百九十七】冬至【大餘五十四日小餘二千五百三十七】戊午日【八十三刻半弱】戌正初刻

宣明歷【積算七百○六萬九千九百七十九】通積分【二十一兆六千九百一十○億八千四百四十二萬○八百四十五】戌正二刻

紀元歷【積算二千八百六十一萬三千○二十三】气積分【七十六兆一千八百五十七億七千八百九十七萬八千三百九十八】冬至【大餘三十九日小餘五千○八十八】戊午日【六十九刻太彊】申正三刻

統天歷【積算三千二百九十九】距差【五百三十一】躔差【六分七】減分【三千五百五十八】气泛積【一百四十四億五千八百九十八萬二千二百七十九】气定積【一百四十四億五千八百九十七萬八千七百二十一】冬至【大餘五十四日小餘一萬○七百二十一】

戊午日【八十九刻少彊】戌正初刻

重修大明歷【積算八千八百六十三萬九千一百三十九】通積分【一百六十九兆三千二百○六億一千○六十五萬七千一百三十六】冬至【大餘五十四日小餘三千七百一十六】

戊午日【七十一刻彊】酉初初刻

授時歷【距算六百一十八】歳余【二四三一】中積分【二十二億五千七百八十○萬二三五八】通積分【二十二億五千七百二十五萬一七五八】冬至【五十四萬八二四二】戊午日【八十二刻半弱】戌初三刻

髙宗儀鳯元年丙子嵗十一月壬申景長

大衍歷【積算九千六百九十六萬一千六百九十三】中積分【一百○七兆六千六百○七億三千七百○九萬○六百九十九】冬至【大餘八日小餘七百七十九】

壬申日【二十五刻半彊】卯正初刻

宣明歷【積算七百○六萬九千九百九十三】通積分【二十一兆六千九百一十一億二千七百三十七萬三千六百一十五】冬至【大餘八日小餘二千四百一十五】

壬申日【二十八刻太】卯正三刻

紀元歷【積算二千八百六十一萬三千○三十七】气積分【七十六兆一千八百五十八億一千六百二十五萬五千一百六十二】冬至【大餘五十三日小餘七百九十二】壬申日【一十刻太彊】醜正二刻

統天歷【積算三千三百一十三】距差【五百一十七】躔差【六分六】減分【三千四百一十二】气泛積【一百四十五億二千○三十四萬三千○一十九】气定積【一百四十五億二千○三十三萬九千六百○七】冬至【大餘八日小餘三千六百○七】壬申日【三十刻彊】辰初初刻

重修大明歷【積算八千八百六十三萬九千一百五十三】通積分【一百六十九兆三千二百○六億三千七百四十○萬○二百七十二】冬至【大餘八日小餘六百三十二】壬申日【一十二刻彊】丑初三刻

授時歷【距算六百○四】歳余【二四三一】中積分【二十二億○六百○十六萬八三二四】通積分【二十二億○五百五十一萬七七二四】冬至【八萬二二七六】壬申日【二十二刻太彊】卯初一刻

髙宗永淳元年壬午歳十一月癸卯景長

大衍歷【積算九千六百九十六萬一千六百九十九】中積分【一百○七兆六千六百○七億四千三百七十五萬二千七百五十七】冬至【大餘三十九日小餘二千一百九十七】癸卯日【七十二刻少彊】酉初一刻

宣明歷【積算七百○六萬九千九百九十九】通積分【二十一兆六千九百一十一億四千五百七十八萬一千九百四十五】冬至【大餘三十九日小餘六千三百四十五】癸卯日【七十五刻半彊】酉正初刻

紀元歷【積算二千八百六十一萬三千○四十三】气積分【七十六兆一千八百五十八億三千二百二十三萬○九百一十八】冬至【大餘二十四日小餘四千一百五十八】癸卯日【五十七刻彊】未初二刻

統天歷【積算三千三百一十九】距差【五百一十一】躔差【六分五】減分【三千三百二十一】气泛積【一百四十五億四千六百六十四萬○四百七十九】气定積【一百四十五億四千六百六十三萬七千一百五十八】冬至【大餘三十九日小餘九千一百五十八】

癸卯日【七十六刻少彊】酉正一刻

重修大明歷【積算八千八百六十三萬九千一百九十九】通積分【一百六十九兆三千二百○六億四千八百八十六萬一千六百一十六】冬至【大餘三十九日小餘三千○四十六】

癸卯日【五十八刻少弱】未初四刻

授時歷【距算五百九十八】嵗余【二四三○】中積分【二十一億八千四百一十五萬三一四○】通積分【二十一億八千三百六十○萬二五四○】冬至【三十九萬七四六○】癸卯日【七十四刻半彊】酉初三刻

明皇開元十年壬戌歳十一月癸酉景長

大衍歷【積算九千六百九十六萬一千七百三十九】中積分【一百○七兆六千六百○七億八千八百一十六萬六千四百七十七】冬至【大餘九日小餘一千五百一十七】癸酉日【五十刻弱】午初四刻

宣明歷【積算七百○七萬○○三十九】通積分【二十一兆六千九百一十二億六千八百五十○萬四千一百四十五】冬至【大餘九日小餘四千五百四十五】

癸酉日【五十四刻彊】午正四刻

紀元歷【積算二千八百六十一萬三千○八十三】气積分【七十六兆一千八百五十九億三千八百七十三萬五千九百五十八】冬至【大餘五十四日小餘二千二百九十八】癸酉日【三十一刻半彊】辰初二刻

統天歷【積算三千三百五十九】距差【四百七十一】躔差【六分】減分【二千八百二十六】气泛積【一百四十七億二千一百九十五萬六千八百七十九】气定積【一百四十七億二千一百九十五萬四千○五十三】冬至【大餘九日小餘六千○五十三】癸酉日【五十刻彊】午正初刻

重修大明歷【積算八千八百六十三萬九千一百九十九】通積分【一百六十九兆三千二百○七億二千五百二十七萬○五百七十六】冬至【大餘九日小餘一千七百○六】癸酉日【三十二刻半彊】辰初三刻

授時歷【距算五百五十八】歳余【二四三○】中積分【二十○億三千八百○五萬五九四○】通積分【二十○億三千七百五十○萬五三四○】冬至【九萬四六六○】癸酉日【四十六刻半彊】午初初刻

開元十一年癸亥嵗十一月戊寅景長

大衍歷【積算九千六百九十六萬一千七百四十】中積分【一百○七兆六千六百○七億八千九百二十七萬六千八百二十】冬至【大餘一十四日小餘二千二百六十】

戊寅日【七十四刻少彊】酉初三刻

宣明歷【積算七百○七萬○○四十】通積分【二十一兆六千九百一十二億七千一百五十七萬二千二百】冬至【大餘一十四日小餘六千六百】

戊寅日【七十八刻半彊】酉正三刻

紀元歷【積算二千八百六十一萬三千○八十四】气積分【七十六兆一千八百五十九億四千一百三十九萬八千五百八十四】冬至【大餘五十九日小餘四千一百七十四】戊寅日【五十七刻少彊】未初三刻

統天歷【積算三千三百六十】距差【四百七十】躔差【六分】減分【二千八百二十○】气泛積【一百四十七億二千六百三十三萬九千七百八十九】气定積【一百四十七億二千六百三十三萬六千九百六十九】冬至【大餘一十四日小餘八千九百六十九】戊寅日【七十四刻太弱】酉初三刻

重修大明歷【積算八千八百六十三萬九千二百】通積分【一百六十九兆三千二百○七億二千七百一十八萬○八百】冬至【大餘一十四日小餘二千九百八十】戊寅日【五十七刻弱】未初二刻

授時歷【距算五百五十七】嵗余【二四三○】中積分【二十○億三千四百四十○萬三五一○】通積分【二十○億三千三百八十五萬二九一○】冬至【一十四萬七○九○】戊寅日【七十刻太彊】酉初初刻

開元十二年甲子歳十一月癸未冬至

大衍歷【積算九千六百九十六萬一千七百四十一】中積分【一百○七兆六千六百○七億九千○三十八萬七千一百六十三】冬至【大餘一十九日小餘三千○○三】癸未日【九十八刻太彊】夜子初二刻

宣明歷【積算七百○七萬○○四十一】通積分【二十一兆六千九百一十二億七千四百六十四萬○二百五十五】冬至【大餘二十日小餘二百五十五】

甲申日【三刻彊】子正三刻

紀元歷【積算二千八百六十一萬三千○八十五】气積分【七十六兆一千八百五十九億四千四百○六萬一千二百一十】冬至【大餘四日小餘五千八百五十】

癸未日【八十刻少弱】戌初一刻

統天歷【積算三千三百六十一】距差【四百六十九】躔差【六分】減分【二千八百一十四】气泛積【一百四十七億三千○七十二萬二千六百九十九】气定積【一百四十七億三千○七十一萬九千八百八十五】冬至【大餘一十九日小餘一萬一千八百八十五】

癸未日【九十九刻彊】夜子初三刻

重修大明歷【積算八千八百六十三萬九千二百○一】通積分【一百六十九兆三千二百○七億二千九百○九萬一千○二十四】冬至【大餘一十九日小餘四千二百五十四】癸未日【八十一刻少彊】戌初二刻

授時歷【距算五百五十六】歳余【二四三○】中積分【二十○億三千○七十五萬一○八○】通積分【二十○億三千○二十○萬○四八○】冬至【一十九萬九五二○】癸未日【九十五刻少弱】亥正三刻

宋眞宗景徳四年丁未歳十一月戊辰日南至

大衍歷【積算九千六百九十六萬二千○二十四】中積分【一百○七兆六千六百一十一億○四百六十一萬四千三百三十二】冬至【大餘四日小餘四百七十二】

戊辰日【一十五刻半彊】寅初三刻

宣明歷【積算七百○七萬○三百二十四】通積分【二十一兆六千九百二十一億四千二百八十九萬九千八百二十】冬至【大餘四日小餘二千二百二十】

戊辰日【二十六刻半弱】卯正一刻

紀元歷【積算二千八百六十一萬三千三百六十八】气積分【七十六兆一千八百六十六億九千七百五十八萬四千三百六十八】冬至【大餘四十八日小餘五千四百四十八】丁卯日【七十四刻太弱】酉初三刻

統天歷【積算三千六百四十四】距差【一百八十六】躔差【二分三】減分【四百二十八】气泛積【一百五十九億七千一百○八萬六千二百二十九】气定積【一百五十九億七千一百○八萬五千八百○一】冬至【大餘三日小餘九千八百○一】丁卯日【八十一刻太弱】戌初一刻

重修大明歷【積算八千八百六十三萬九千四百八十四】通積分【一百六十九兆三千二百一十二億六千九百六十八萬四千四百一十六】冬至【大餘三日小餘三千九百二十六】

丁卯日【七十五刻】酉正初刻

授時歷【距算二百七十三】歳余【二四二七】中積分【九億九千七百一十一萬二五七一】通積分【九億九千六百五十六萬一九七一】冬至【三萬八○二九】

丁卯日【八十刻少彊】戌初一刻

仁宗皇祐二年庚寅歳十一月三十日癸丑景長大衍歷【積算九千六百九十六萬二千○六十七】中積分【一百○七兆六千六百一十一億五千二百三十五萬八千九百八十一】冬至【大餘四十九日小餘二千○二十一】癸丑日【六十六刻半弱】申初二刻

宣明歷【積算七百○七萬○三百六十七】通積分【二十一兆六千九百二十二億七千四百八十二萬六千一百八十五】冬至【大餘四十九日小餘六千五百八十五】癸丑日【七十八刻半弱】酉正三刻

紀元歷【積算二千八百六十一萬三千四百一十一】气積分【七十六兆一千八百六十八億一千二百○七萬七千二百八十六】冬至【大餘三十四日小餘一千六百二十六】癸丑日【二十二刻少彊】卯初一刻

統天歷【積算三千六百八十七】距差【一百四十三】躔差【一分八】減分【二百五十七】气泛積【一百六十一億五千九百五十五萬一千三百五十九】气定積【一百六十一億五千九百五十五萬一千一百○二】冬至【大餘四十九日小餘三千一百○二】癸丑日【二十五刻太彊】卯初初刻

重修大明歷【積算八千八百六十三萬九千五百二十七】通積分【一百六十九兆三千二百一十三億五千一百八十二萬四千○四十八】冬至【大餘四十九日小餘一千一百七十八】

癸丑日【二十二刻半彊】卯初一刻

授時歷【距算二百三十】歳余【二四二七】中積分【八億四千○○五萬八二一○】通積分【八億三千九百五十○萬七六一○】冬至【四十九萬二三九○】

癸丑日【二十三刻太彊】卯初三刻

神宗元丰六年癸亥歳十一月丙午景長

大衍歷【積算九千六百九十六萬二千一百】中積分【一百○七兆六千六百一十一億八千九百○○萬○三百】冬至【大餘四十二日小餘二千二百二十】

丙午日【七十三刻彊】酉初二刻

宣明歷【積算七百○七萬○四百】通積分【二十一兆六千九百二十三億七千六百○七萬二千】冬至【大餘四十二日小餘七千二百】

丙午日【八十五刻太弱】戌正二刻

紀元歷【積算二千八百六十一萬三千四百四十四】气積分【七十六兆一千八百六十八億九千九百九十四萬三千九百四十四】冬至【大餘二十七日小餘一千九百一十四】丙午日【二十六刻少彊】卯正一刻

統天歷【積算三千七百二十】距差【一百一十】躔差【一分四】減分【一百五十四】气泛積【一百六十三億○四百一十八萬七千三百八十九】气定積【一百六十三億○四百一十八萬七千三百三十五】冬至【大餘四十二日小餘三千二百三十五】丙午日【二十七刻弱】卯正一刻

重修大明歷【積算八千八百六十三萬九千五百六十】通積分【一百六十九兆三千二百一十四億一千四百八十六萬一千四百四十】冬至【大餘四十二日小餘一千三百八十】丙午日【二十六刻少彊】卯正一刻

授時歷【距算一百九十七】歳余【二四二六】中積分【七億一千九百五十二萬七九二二】通積分【七億一千八百九十七萬七三二二】冬至【四十二萬二六七八】丙午日【二十六刻太彊】卯正一刻

元丰七年甲子歳十一月辛亥景長

大衍歷【積算九千六百九十六萬二千一百○一】中積分【一百○七兆六千六百一十一億九千○一十一萬○六百四十三】冬至【大餘四十七日小餘二千九百六十三】辛亥日【九十七刻半弱】夜子初一刻

宣明歷【積算七百○七萬○四百○一】通積分【二十一兆六千九百二十三億七千九百一十四萬○○五十五】冬至【大餘四十八日小餘八百五十五】

壬子日【一十刻彊】醜正一刻

紀元歷【積算二千八百六十一萬三千四百四十五】气積分【七十六兆一千八百六十九億○二百六十○萬六千五百七十】冬至【大餘三十二日小餘三千六百九十】辛亥日【五十刻半彊】午正初刻

統天歷【積算三千七百二十一】距差【一百○九】躔差【一分四】減分【一百五十三】气泛積【一百六十三億○八百五十七萬○二百九十九】气定積【一百六十三億○八百五十七萬○一百四十六】冬至【大餘四十七日小餘六千一百四十六】辛亥日【五十一刻少弱】午正一刻

重修大明歷【積算八千八百六十三萬九千五百六十一】通積分【一百六十九兆三千二百一十四億一千六百七十七萬一千六百六十四】冬至【大餘四十七日小餘二千六百五十四】

辛亥日【五十刻太弱】午正初刻

授時歷【距算一百九十六】歳余【二四二六】中積分【七億一千五百八十七萬五四九六】通積分【七億一千五百三十二萬四八九六】冬至【四十七萬五一○四】辛亥日【五十一刻彊】午正一刻

哲宗元祐三年戊辰歳十一月壬申景長

大衍歷【積算九千六百九十六萬二千一百○五】中積分【一百○七兆六千六百一十一億九千四百五十五萬二千○一十五】冬至【大餘八日小餘二千八百九十五】壬申日【九十五刻少弱】亥正三刻

宣明歷【積算七百○七萬○四百○五】通積分【二十一兆六千九百二十三億九千一百四十一萬二千二百七十五】冬至【大餘九日小餘六百七十五】

癸酉日【八刻彊】丑初二刻

紀元歷【積算二千八百六十一萬三千四百四十九】气積分【七十六兆一千八百六十九億一千三百二十五萬七千○七十四】冬至【大餘五十三日小餘三千五百○四】壬申日【四十八刻彊】午初二刻

統天歷【積算三千七百二十五】距差【一百○五】躔差【一分三】減分【一百三十七】气泛積【一百六十三億二千六百一十○萬一千九百三十九】气定積【一百六十三億二千六百一十○萬一千八百○二】冬至【大餘八日小餘五千八百○二】壬申日【四十八刻少彊】午初二刻

重修大明歷【積算八千八百六十三萬九千五百六十五】通積分【一百六十九兆三千二百一十四億二千四百四十一萬二千五百六十】冬至【大餘八日小餘二千五百二十】壬申日【四十八刻少弱】午初二刻

授時歷【距算一百九十二】歳余【二四二六】中積分【七億○千一百二十六萬五七九二】通積分【七億○千○百七十一萬五一九二】冬至【八萬四八○八】

壬申日【四十八刻彊】午初二刻

元祐四年己巳歳十一月丁丑景長

大衍歷【積算九千六百九十六萬二千一百○六】中積分【一百○七兆六千六百一十一億九千五百六十六萬二千三百五十八】冬至【大餘一十四日小餘五百九十八】戊寅日【一十九刻半彊】寅正二刻

宣明歷【積算七百○七萬○四百○六】通積分【二十一兆六千九百二十三億九千四百四十八萬○三百三十】冬至【大餘一十四日小餘二千七百三十】

戊寅日【三十二刻半】辰初三刻

紀元歷【積算二千八百六十一萬三千四百五十】气積分【七十六兆一千八百六十九億一千五百九十一萬九千七百】冬至【大餘五十八日小餘五千二百八十】

丁丑日【七十二刻半彊】酉初一刻

統天歷【積算三千七百二十六】距差【一百○四】躔差【一分三】減分【一百三十五】气泛積【一百六十三億三千○四十八萬四千八百四十九】气定積【一百六十三億三千○四十八萬四千七百一十四】冬至【大餘一十三日小餘八千七百一十四】丁丑日【七十二刻半彊】酉初一刻

重修大明歷【積算八千八百六十三萬九千五百六十六】通積分【一百六十九兆三千二百一十四億二千六百三十二萬二千七百八十四】冬至【大餘一十三日小餘三千七百九十四】

丁丑日【七十二刻半彊】酉初一刻

授時歷【積算一百九十一】歳余【二四二六】中積分【六億九千七百六十一萬三三六六】通積分【六億九千七百○十六萬二七六六】冬至【一十三萬七二三四】丁丑日【七十二刻少彊】酉初一刻

元祐五年庚午歳十一月壬午冬至

大衍歷【積算九千六百九十六萬二千一百○七】中積分【一百○七兆六千六百一十一億九千六百七十七萬二千七百○一】冬至【大餘一十九日小餘一千三百四十一】癸未日【四十四刻彊】巳正二刻

宣明歷【積算七百○七萬○四百○七】通積分【二十一兆六千九百二十三億九千七百五十四萬八千三百八十五】冬至【大餘一十九日小餘四千七百八十五】

癸未日【五十七刻弱】未初二刻

紀元歷【積算二千八百六十一萬三千四百五十一】气積分【七十六兆一千八百六十九億一千八百五十八萬二千三百二十六】冬至【大餘三日小餘七千○五十六】壬午日【九十六刻太彊】夜子初初刻

統天歷【積算三千七百二十七】距差【一百○三】躔差【一分三】減分【一百三十四】气泛積【一百六十三億三千四百八十六萬七千七百五十九】气定積【一百六十三億三千四百八十六萬七千六百二十五】冬至【大餘一十八日小餘一萬一千六百二十五】

壬午日【九十六刻太彊】夜子初一刻

重修大明歷【積算八千八百六十三萬九千五百六十七】通積分【一百六十九兆三千二百一十四億二千八百二十三萬三千○○八】冬至【大餘一十八日小餘五千○六十八】

壬午日【九十七刻弱】夜子初一刻

授時歷【距算一百九十】嵗余【二四二六】中積分【六億九千三百九十六萬○九四○】通積分【六億九千三百四十一萬○三四○】冬至【一十八萬九六六○】

壬午日【九十六刻半彊】夜子初初刻

元祐七年壬申歳十一月癸巳冬至

大衍歷【積算九千六百九十六萬二千一百○九】中積分【一百○七兆六千六百一十一億九千八百九十九萬三千三百八十七】冬至【大餘二十九日小餘二千八百二十七】癸巳日【九十三刻弱】亥正一刻

宣明歷【積算七百○七萬○四百○九】通積分【二十一兆六千九百二十四億○三百六十八萬四千四百九十五】冬至【大餘三十日小餘四百九十五】

甲午日【六刻弱】丑初一刻

紀元歷【積算二千八百六十一萬三千四百五十三】气積分【七十六兆一千八百六十九億二千三百九十萬七千五百七十八】冬至【大餘一十四日小餘三千三百一十八】癸巳日【四十五刻半彊】巳正三刻

統天歷【積算三千七百二十九】距差【一百○一】躔差【一分三】減分【一百三十一】气泛積【一百六十三億四千三百六十三萬三千五百七十九】气定積【一百六十三億四千三百六十三萬三千四百四十八】冬至【大餘二十九日小餘五千四百四十八】

癸巳日【四十五刻半弱】巳正三刻

重修大明歷【積算八千八百六十三萬九千五百六十九】通積分【一百六十九兆三千二百一十四億三千二百○五萬三千四百五十六】冬至【大餘二十九日小餘二千三百八十六】

癸巳日【四十五刻半彊】巳正三刻

授時歷【距算一百八十八】嵗余【二四二六】中積分【六億八千六百六十五萬六○八八】通積分【六億八千六百一十○萬五四八八】冬至【二十九萬四五一二】癸巳日【四十五刻彊】巳正三刻

哲宗元符元年戊寅歳十一月甲子冬至

大衍歷【積算九千六百九十六萬二千一百一十五】中積分【一百○七兆六千六百一十二億○五百六十五萬五千四百四十五】冬至【大餘一日小餘一千二百○五】乙丑日【三十九刻半彊】巳初二刻

宣明歷【積算七百○七萬○四百一十五】通積分【二十一兆六千九百二十四億二千二百○九萬三千八百二十五】冬至【大餘一日小餘四千四百二十五】

乙丑日【五十二刻太弱】午正二刻

紀元歷【積算二千八百六十十萬三千四百五十九】气積分【七十六兆一千八百六十九億三千九百八十八萬三千三百三十四】冬至【大餘四十五日小餘六千六百八十四】甲子日【九十一刻太弱】亥正初刻

統天歷【積算三千七百三十五】距差【九十五】躔差【一分二】減分【一百一十四】气泛積【一百六十三億六千九百九十三萬一千○三十九】气定積【一百六十三億六千九百九十三萬○九百二十五】冬至【大餘○日小餘一萬○九百二十五】甲子日【九十一刻彊】亥初三刻

重修大明歷【積算八千八百六十三萬九千五百七十五】通積分【一百六十九兆三千二百一十四億四千三百五十一萬四千八百】冬至【大餘日空小餘四千八百】甲子日【九十一刻太彊】亥正初刻

授時歷【距算一百八十二】歳余【二四二六】中積分【六億六千四百七十四萬一五三二】通積分【六億六千四百一十九萬○九三二】冬至【○萬九○六八】

甲子日【九十刻彊】亥初三刻

徽宗崇寧三年甲申歳十一月丙申冬至

大衍歷【積算九千六百九十六萬二千一百二十一】中積分【一百○七兆六千六百一十二億一千二百三十一萬七千五百○三】冬至【大餘三十二日小餘二千六百二十三】丙申日【八十六刻少彊】戌正二刻

宣明歷【積算七百○七萬○四百二十一】通積分【二十一兆六千九百二十四億四千○五十○萬一千一百五十五】冬至【大餘三十二日小餘八千三百五十五】

丙申日【九十九刻半弱】夜子初三刻

紀元歷【積算二千八百六十一萬三千四百六十五】气積分【七十六兆一千八百六十九億五千五百八十五萬九千○九十】冬至【大餘一十七日小餘二千七百六十】丙申日【三十七刻太彊】巳初初刻

統天歷【積算三千七百四十一】距差【八十九】躔差【一分一】減分【九十八】气泛積【一百六十三億九千六百二十二萬八千四百九十九】气定積【一百六十三億九千六百二十二萬八千四百○一】冬至【大餘三十二日小餘四千四百一】丙申日【三十六刻半彊】辰正三刻

重修大明歷【積算八千八百六十三萬九千五百八十一】通積分【一百六十九兆三千二百一十四億五千四百九十七萬六千一百三十四】冬至【大餘三十二日小餘一千九百七十四】

丙申日【三十七刻太弱】巳初初刻

授時歷【距算一百七十六】嵗余【二四二六】中積分【六億四千二百八十二萬六九七六】通積分【六億四千二百二十七萬六三七六】冬至【三十二萬三六二四】丙申日【三十六刻少弱】辰正二刻

光宗紹熈二年辛亥歳十一月壬申冬至

大衍歷【積算九千六百九十六萬二千二百○八】中積分【一百○七兆六千六百一十三億○八百九十一萬七千三百四十四】冬至【大餘九日小餘三百八十四】

癸酉日【一十二刻半彊】寅初初刻

宣明歷【積算七百○七萬○五百○八】通積分【二十一兆六千九百二十七億○七百四十二萬一千九百四十】冬至【大餘九日小餘二千三百四十】

癸酉日【二十七刻太彊】卯正二刻

紀元歷【積算二千八百六十一萬三千五百五十二】气積分【七十六兆一千八百七十一億八千七百五十○萬七千五百五十二】冬至【大餘五十三日小餘四千一百八十二】壬申日【五十七刻少彊】未初三刻

統天歷【積算三千八百二十八】距差【二】躔差減分【並無】气泛積【一百六十七億七千七百五十四萬一千六百六十九】气定積【因無減分以泛爲定】冬至【大餘八日小餘五千六百六十九】

壬申日【四十七刻少弱】午初一刻

重修大明歷【積算八千八百六十三萬九千六百六十八】通積分【一百六十九兆三千二百一十六億二千一百一十六萬五千六百三十二】冬至【大餘八日小餘二千九百九十二】

壬申日【五十七刻少弱】未初三刻

授時歷【距算八十九】歳余【二四二五】中積分【三億二千五百○六萬五八二五】通積分【三億二千四百五十一萬五二二五】冬至【八萬四七七五】

壬申日【四十七刻太】午初一刻

寧宗慶元三年丁巳嵗十一月癸卯日南至

大衍歷【積算九千六百九十六萬二千二百一十四】中積分【一百○七兆六千六百一十三億一千五百五十七萬九千四百○二】冬至【大餘四十日小餘一千八百○二】甲辰日【五十九刻少彊】未正初刻

宣明歷【積算七百○七萬○五百一十四】通積分【二十一兆六千九百二十七億二千五百八十三萬○二百七十】冬至【大餘四十日小餘六千二百七十】

甲辰日【七十四刻太弱】酉初三刻

紀元歷【積算二千八百六十一萬三千五百五十八】气積分【七十六兆一千八百七十二億○三百四十八萬三千三百○八】冬至【大餘二十五日小餘二百五十八】甲辰日【三刻半彊】子正三刻

統天歷【積算三千八百三十四】距差【四】躔差【○分一】減分【無】气泛積【一百六十八億○三百八十三萬九千一百二十九】气定積【距差乘躔差不滿秒半以泛爲定】冬至【大餘三十九日小餘一萬一千一百二十九】

癸卯日【九十二刻太弱】亥正一刻

重修大明歷【積算八千八百六十三萬九千六百七十四】通積分【一百六十九兆三千二百一十六億三千二百六十二萬六千九百七十六】冬至【大餘四十日小餘一百七十六】

甲辰日【三刻少彊】子正三刻

授時歷【距算八十三】歳余【二四二五】中積分【三億○千三百一十五萬一二七五】通積分【三億○千二百六十○萬○六七五】冬至【三十九萬九三二五】

癸卯日【九十三刻少】亥正一刻

寧宗嘉泰三年癸亥嵗十一月甲戌日南至

大衍歷【積算九千六百九十六萬二千二百二十】中積分【一百○士兆六千六百一十三億二千二百二十四萬一千四百六十】冬至【大餘一十二日小餘一百八十】

丙子日【六刻弱】醜正一刻

宣明歷【積算七百○七萬○五百二十】通積分【二十一兆六千九百二十七億四千四百二十三萬八千六百】冬至【大餘一十二日小餘一千八百】

丙子日【二十一刻半弱】卯初初刻

紀元歷【積算二千八百六十一萬三千五百六十四】气積分【七十六兆一千八百七十二億一千九百四十五萬九千○六十四】冬至【大餘五十六日小餘三千六百二十四】乙亥日【四十九刻太弱】午初三刻

統天歷【積算三千八百四十】距差【一十】躔差【○分一】減分【一】气泛積【一百六十八億三千○一十三萬六千五百八十九】气定積【一百六十八億三千○一十三萬六千五百八十八】冬至【大餘一十一日小餘四千五百八十八】

乙亥日【三十八刻少弱】巳初初刻

重修大明歷【積算八千八百六十三萬九千六百八十】通積分【一百六十九兆三千二百一十六億四千四百○八萬八千三百二十】冬至【大餘一十一日小餘二千五百九十】乙亥日【四十九刻半彊】午初三刻

授時歷【距算七十七】歳余【二四二五】中積分【二億八千一百二十三萬六七二五】通積分【二億八千○百六十八萬六一二五】冬至【一十一萬三八七五】

乙亥日【三十八刻太】巳初一刻

寧宗嘉定五年壬申歳十一月壬戌日南至

大衍歷【積算九千六百九十六萬二千二百二十九】中積分【一百○七兆六千六百一十三億二千二百二十三萬四千五百四十七】冬至【大餘五十九日小餘七百八十七】癸亥日【二十五刻太彊】卯正初刻

宣明歷【積算七百○七萬○五百二十九】通積分【二十一兆六千九百二十七億七千一百八十五萬一千○九十五】冬至【大餘五十九日小餘三千四百九十五】

癸亥日【四十一刻半彊】巳初四刻

紀元歷【積算二千八百六十一萬三千五百七十三】气積分【七十六兆一千八百七十二億四千三百四十二萬二千六百九十八】冬至【大餘四十三日小餘五千○二十八】壬戌日【六十九刻弱】申正二刻

統天歷【積算三千九百四十九】距差【一十九】躔差【○分二】減分【四】气泛積【一百六十八億六千九百五十八萬二千七百七十九】气定積【一百六十八億六千九百五十八萬二千七百七十五】冬至【大餘五十八日小餘六千七百七十五】壬戌日【五十六刻半弱】未初二刻

重修大明歷【積算八千八百六十三萬九千六百八十九】通積分【一百六十九兆三千二百一十六億六千一百二十八萬○三百三十六】冬至【大餘五十八日小餘三千五百九十六】

壬戌日【六十八刻太彊】申正初刻

授時歷【距算六十八】歳余【二四二五】中積分【二億四千八百三十六萬四九○○】通積分【二億四千七百八十一萬四三○○】冬至【五十八萬五七○○】

壬戌日【五十七刻】未初二刻

理宗紹定三年庚寅歳十一月丙申日南至

大衍歷【積算九千六百九十六萬二千二百四十七】中積分【一百○七兆六千六百一十三億五千二百二十二萬○七百二十一】冬至【大餘三十三日小餘二千○○一】丁酉日【六十五刻少弱】申初二刻

宣明歷【積算七百○七萬○五百四十七】通積分【二十一兆六千九百二十八億二千七百○七萬六千○八十五】冬至【大餘三十三日小餘六千八百八十五】

丁酉日【八十二刻弱】戌初二刻

紀元歷【積算二千八百六十一萬三千五百九十一】气積分【七十六兆一千八百七十二億九千一百三十四萬九千九百六十六】冬至【大餘一十八日小餘五百四十六】丁酉日【七刻半弱】丑初三刻

統天歷【積算三千八百六十七】距差【三十七】躔差【○分五】減分【一十九】气泛積【一百六十九億四千八百四十七萬五千一百五十九】气定積【一百六十九億四千八百四十七萬五千一百四十○】冬至【大餘三十二日小餘一萬一千一百四十○】

丙申日【九十二刻太彊】亥正一刻

重修大明歷【積算八千八百六十三萬九千七百○七】通積分【一百六十九兆三千二百一十六億九千五百六十六萬四千三百六十八】冬至【大餘三十三日小餘三百七十八】丁酉日【七刻少弱】丑初三刻

授時歷【距算五十】歳余【二四二五】中積分【一億八千二百六十二萬一二五○】通積分【一億八千二百○十七萬○六五○】冬至【三十二萬九三五○】

丙申日【九十三刻半】亥正一刻

理宗淳祐十年庚戌嵗十一月辛巳日南至

大衍歷【積算九千六百九十六萬二千二百六十七】中積分【一百○七兆六千六百一十三億七千四百四十二萬七千五百八十一】冬至【大餘一十八日小餘一千六百六十一】壬午日【五十四刻半彊】未初初刻

宣明歷【積算七百○七萬○五百六十七】通積分【二十一兆六千九百二十八億八千八百四十三萬七千一百八十五】冬至【大餘一十八日小餘五千九百八十五】壬午日【七十一刻少】酉初初刻

紀元歷【積算二千八百六十一萬三千六百一十一】气積分【七十六兆一千八百七十三億四千四百六十○萬二千四百八十六】冬至【大餘二日小餘六千九百○六】辛巳日【九十四刻太弱】亥正三刻

統天歷【積算三千八百八十七】距差【五十七】躔差【○分七】減分【四十】气泛積【一百七十○億三千六百一十三萬三千三百五九】气定積【一百七十○億三千六百一十三萬三千三百一九】冬至【大餘一十七日小餘九千三百一十九】

辛巳日【七十七刻太弱】酉正二刻

重修大明歷【積算八千八百六十三萬九千七百二十七】通積分【一百六十九兆三千二百一十七億三千三百八十六萬八千七百九十八】冬至【大餘一十七日小餘四千八百八十八】

辛巳日【九十三刻半彊】亥正一刻

授時歷【距算三十】嵗余【二四二五】中積分【一億千九百五十七萬二七五】通積分【一億千九百十二萬二一五】冬至【一十七萬七八五】

辛巳日【七十八刻半】酉正三刻

元世祖至元十七年庚辰歳十一月己未夜半後六刻冬至

大衍歷【積算九千六百九十六萬二千二百九十七】中積分【一百○七兆六千六百一十四億○七百七十三萬七千八百七十一】冬至【大餘五十五日小餘二千六百七十一】己未日【八十七刻太彊】亥初初刻

宣明歷【積算七百○七萬○五百九十七】通積分【二十一兆六千九百二十九億八千○四十七萬八千八百三十五】冬至【大餘五十六日小餘四百三十五】

庚申日【五刻彊】丑初一刻

紀元歷【積算二千八百六十一萬三千六百四十一】气積分【七十六兆一千八百七十四億二千四百四十八萬一千二百六十六】冬至【大餘四十日小餘一千八百六十六】己未日【二十五刻半彊】卯初初刻

統天歷【積算三千九百一十七】距差【八十七】躔差【一分一】減分【九十六】气泛積【一百七十一億六千七百六十二萬○六百五十九】气定積【一百七十一億六千七百六十二萬○五百六十三】冬至【大餘五十五日小餘○萬○五百六十三】己未日【四刻半彊】丑初初刻

重修大明歷【積算八千八百六十三萬九千七百五十七】通積分【一百六十九兆三千二百一十七億九千一百一十七萬五千五百六十八】冬至【大餘五十五日小餘一千三百一十八】

己未日【二十五刻彊】卯正初刻

授時歷【據當時日晷推定無距算無中積分上考下求用爲元數】

【實測得冬至气應五十五日○六百分】

己未日【六刻】丑初一刻

右日名五歷合宣明後一日刻惟授時合統天先一刻餘皆後天大衍至八十餘刻

以上自魯僖公以來冬至日名共四十七並至元辛巳有刻爲四十八事授時法合者三十八不合者昭公己卯劉宋元嘉丙子大明辛丑陳太建壬辰丁酉隋開皇甲寅唐貞觀甲辰己酉宋景徳丁未嘉泰癸亥共十統天歷同

據歷議統天不合者惟獻公戊寅與授時不同今以宋史所載曆術躔差用秒法求之無不同也算式如後

魯獻公十五年戊寅歳正月甲寅朔旦冬至

統天歷【積算一千七百五十四】距差【二千○七十六】躔差【二十六分四】減分【五萬四千八百○六】气泛積【七十六億八千七百三十八萬六千三百二十九】气定積【七十六億八千七百三十三萬一千五百二十三】冬至【大餘五十日小餘一萬一千五百二十三】

甲寅日【九十六刻彊】夜子初初刻

躔差三位得之

大餘【五十一日】小餘【三百五十三】乙卯日【二刻太彊】子正二刻躔差二位得此

若躔差只用二位正得乙卯與授時歷議合然非其本法也何以知之按統天曆術步气朔章曰躔差小分半以上從秒一距差乘躔差秒半以上從分一如躔差只用分安得有秒距差乘後又安得有分以下之數乎故三位爲是

魯獻公距算考【附】

史記武王九年東伐至盟津周公輔行十一年伐紂至牧野周公佐武王作牧誓克殷二年周公作金縢其後武王崩成王少在𦇤褓之中成王七年作洛七年後還政成王北面就臣位

周公卒子伯禽固前已受封是爲魯公【皇甫謐云伯禽以成王元年封四十六年康王十六年卒】伯禽卒子考公酋立四年卒弟煬公熈立六年卒子幽公宰立十四年弟防弒之自立爲魏公五十年卒子厲公擢立三十七年卒魯人立其弟具是爲獻公獻公三十二年卒子眞公濞立眞公十四年周厲王奔彘二十九年周宣行政三十年眞公卒弟武公敖立武公九年朝周歸而卒少子戲立是爲懿公懿公九年兄括之子伯禦殺懿公自立十一年周宣王伐魯殺伯禦立懿公弟稱爲孝公孝公二十五年犬戎弒幽王二十七年孝公卒子惠公弗皇立四十六年卒隱公攝當國【又史記三代世表魯獻公在夷王燮時十二諸侯年表起魯眞公濞十五年庚申一云十四年】按自元至元十八年辛巳上距周武王己卯通二千四百單三年據歷議春秋獻公以來二千一百六十餘年而首列獻公十五年爲戊寅是在武王后二百四十年也今世家自伯禽至獻公卒通一百八十九年而已歷議不知何據存之再考

歷算全書卷十四﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十五﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十五﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十五﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十五﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十五﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十五﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十五﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十五﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十五﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十五﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十五﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十五﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十五﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十五﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十五﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十五﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十五﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十五﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十五﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十五﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十五﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十五﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十五﹥

歷算全書卷十五﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

欽定四庫全書

歷算全書卷十六

宣城梅文鼎撰

五星紀要

論五星嵗輪

五星與日皆東岀而西沒宗動天之所運也土木火三星在太陽上而近宗動故其左旋速於日毎日有所差之分卽嵗輪心之平行也

五星與太陽有定距嵗輪心旣爲宗動所掣漸離太陽而西則星不得不自嵗輪之中綫【卽平行度】漸移而東以就日而星旣在日之上亦卽不得不自嵗輪之頂漸移而下以就日也旣漸移而東又漸移而下則不能平轉而成環行嵗輪之圓象成矣

嵗輪心正在太陽之上星又在嵗輪之頂作直綫過嵗輪心以過太陽之心而指地心是爲合伏合伏以後星在嵗輪上東移有類平轉故其東移速【古謂之疾段】嵗輪心離日漸逺星在嵗輪離合伏之度亦漸逺而向下行則東移之度漸遲【古謂之遲段】嵗輪心離日至一象限星在嵗輪直向下行人自地觀之不見其動【古爲畱】過此畱輪心距太陽益逺將至半周星行嵗輪之底轉成向西行【是爲退叚】輪心與日衝星正居輪底自輪心作綫過星以過地心而直射太陽之心亦爲一直綫是爲退衝

未至日衝皆爲晨見衝日以後則爲夕見夕見者西與日近東與日逺輪心反在日後而西行追日日在西星在東星不得不自輪底西移而就日【故仍爲退】輪心西距日益近則星漸西而亦漸上行以就其距日之定距星旣在輪邊與輪心亦有定距則其西移過半象限不得不轉而上行矣

至於西距日一象限上行之勢又直人自地觀之亦不見動【古亦謂畱】

過此而輪心距日益近則星亦在輪上漸向東行以就合伏之度以就其距日之常度於是又見其東移之速而至於合伏【古亦謂疾】是爲嵗輪之周

論上三星圍日之行左旋

問古以七政右旋宋儒以七政周天左旋今以七政恆星皆爲一日一周之天所掣而西發明宋說謂右旋之度因左旋而成可謂無疑義矣玆論七政新圖以太陽爲心而復謂上三星左旋與金水異何居曰左旋有二前所論七政左旋以地爲心者也今上三星左旋以太陽爲心者也五星旣爲動天所轉而成左旋【一日繞地一周之行】又依嵗輪而右旋【以本輪上定度爲心】此五緯之所同也然嵗輪上實行之度與太陽相直有定距則仍以太陽爲心又成圍繞太陽之行矣金水二星卽以太陽爲嵗輪【或伏見輪】之心故嵗輪卽圍日之行嵗輪右旋故其圍日之行亦右旋也上三星則嵗輪不以太陽爲心但其距日有定度而又成圍日之形以嵗輪上度言之仍是右旋與金水同以圍日之形言之則是左旋與金水異矣

五星與日皆爲動天所轉繞地左旋但上三星之左旋速於日故合伏之後卽在日西【以右旋言爲星不及日以左旋言爲星過於日】衝日之後乃在日東【以右旋言爲日逐星以左旋言則爲星逐日】是不特其平行繞地者爲左旋而其距日有常以成圍日之形者亦左旋也

金水之左旋與日等故合伏之後在日東退合之後在日西則是平行繞地者均爲左旋而其圍日之行則右旋也故曰上三星左旋與金水異者主乎圍日以爲言者也

然則嵗輪之度又何以同爲右旋乎曰視行之法逺則見遲近則見疾上三星之左旋𨿽速於日而在嵗輪上半則見過日之度稍遲下半則見過日之度加速矣金水之左旋𨿽與日等而在嵗輪上半較日距地爲逺則見左旋遲於日下半距地近則見右旋速於日夫上半左旋遲則右移反速下半左旋速則右移反遲而成畱退此所以嵗輪上度五星皆爲右旋也

然五星嵗輪所以有在上在下之分者則以與太陽有定距也因其與日有定距所以能成嵗輪上周轉之行因其在嵗輪上周轉而行所以與日有定距

楊學山曰上金水左旋右旋之論猶仍曆書之說以伏見輪同嵗輪後言伏見輪乃繞日圓象金水另有其嵗輪乃勿庵晚年新說耳

論五星以日爲心之圖

法曰上三星其圍日之圏左旋下二星其輪右旋皆以從宗動而西運之行爲主【論左旋則星之退行乃其行速】假如上三星合伏時在太陽之上及其毎日左旋一周則星行過日若干分而在日西然其旋也距地則漸近其所以低者以就太陽也自此左旋之周益多則其離日而西之度亦漸逺而益旋益低比至在日西滿半周而衝日則其旋益近地所以然者因在日衝故必下行嵗輪之底以就日也衝日以後其左旋之行轉在日東隨日之後而向日行其旋亦自衝日卑處漸向於髙離衝日若干分則其旋漸髙亦若干分自此在日後左旋追日而益近之以復至合伏則其旋益髙而復在太陽之上矣是故上三星之能爲圍日之圏者以左旋言也

惟以左旋言之則無論沖合之在恆星何度亦無問各星之沖合各有周率經歷之時日幾何而其以日爲心悉同一法也

其下二星以嵗輪圍日其理易明然亦是與太陽同爲一日一周之左旋而星之左旋遲於日故合伏時在太陽上毎左旋一周則星不及日若干分度而在日東其行亦漸降至於夕畱之後又復漸速而追日其度益降至退合伏而極乃復離日而西度亦漸升而復於合伏矣

地谷曰日之攝五星若磁石之引鐵故其距日有定距也惟其然也故日在本天行一周而星之升降之迹亦成一圓相歷家因取而名之曰嵗輪也是故上三星嵗輪約略皆與太陽天同大而今其徑有大小者各以其本天半徑爲十萬之比例也

地谷新圖其理如此不知者遂以圍日爲本天則是嵗輪心而非星體失之逺矣

宗動天左旋星與太陽皆從之左旋而有遲速以其所居有髙下離動天有逺近也

上三星在日天之上近於動天故其毎日左旋比日爲速𨿽不能與恆星同復故處而所差甚防【土星只二分奇木星只五六分火星只半度】不能若太陽之毎差一度也

論五星本天以地爲心

問五星之法至西曆而詳明然其舊說五星各一重天大小相函而皆以地爲心其新說五星天𨿽亦大小相函而以日爲心若是其不同何也曰無不同也西人九重天之說第一重宗動天次則恆星又次土星次木星次火星次太陽次金次水次太陰是皆以其行度之遲速而知其距地有逺近因以知其天周有大小理之可信者也星之天有大小旣皆以距地之逺近而知則皆以地心爲心矣是故土木火三星距地心甚逺故其天皆大於太陽之天而包於外金水二星距地心漸近故其天皆小於太陽之天而在其內爲太陽天所包是其本天皆以地爲心無可疑者惟是五星之行各有嵗輪嵗輪亦圓象五星各以其本天載嵗輪嵗輪心行於本天之周星之體則行於嵗輪之周以成遲疾畱逆【嵗輪心行於本天周皆平行也星行於嵗輪之周亦平行也人自地測之則有合有衝有疾有遲有畱有逆自然之理也】若以嵗輪上星行之度聨之亦成圓象而以太陽爲心西洋新說謂五星皆以日爲心蓋以此耳然此圍日圓象原是嵗輪周行度所成而嵗輪之心又行於本天之周本天原以地爲心三者相待而成原非兩法故曰無不同也【上三星在嵗輪上右旋金水在嵗輪上左旋皆挨度平行】

夫圍日圓象旣爲嵗輪周星行之迹則遲畱逆伏之度兩輪皆有之故以嵗輪立算可以得其遲畱逆伏之度以圍日圓輪立算所得不殊立法者溯本窮源用法者從簡便算如曆書上三星用嵗輪金水二星用伏見輪皆可以求次均立算𨿽殊其歸一也或者不察遂謂五星之天眞以日爲心失其指矣

夫太陽去地亦甚逺矣五星本天旣以地爲心而又能以日爲心將日與地竟合爲一乎必不然矣

歷指又嘗言火星天獨以日爲心不與四星同予嘗斷其非是作圖以推明地谷立法之根原以地爲本天之心其說甚明其金水二星歷指之說多淆亦久疑其非今得門人劉允恭悟得金水二星之有嵗輪其理的確而不可易可謂發前人之未發矣

論伏見輪非嵗輪

問金水二星之求次均也【卽遲疾畱逆】用伏見輪歷指謂其卽嵗輪其說非歟曰非也伏見輪之法起於回歷而歐邏因之若果卽嵗輪何爲別立此名乎由今以觀蓋卽嵗輪上星行繞日之圓象耳【王寅旭書亦云伏見輪非嵗輪】

然則伏見輪旣爲圍日之迹上三星宜皆有之何以不用而獨用之金水曰以其便用也蓋五星行於嵗輪起合伏終合伏皆從距日而生故五星之嵗輪並與日天同大而嵗輪之心原在本天周故其圍日象又並與本天同大上三星之本天包太陽外其大無倫又其行皆左旋【所以左旋之故詳其後論】頗費觧說故只用嵗輪也至於金水本天在太陽天內伏見輪旣與之同大又其度順行故用伏見輪【亦卽繞日圎象】若用嵗輪則金水之嵗輪反大於本天【以嵗輪與日天同大故皆大於本天】故不用嵗輪非無嵗輪也承用者未能深考立法之根輙謂伏見輪卽嵗輪其說似是而非不可不知也伏見亦起合伏終合伏有似嵗輪然嵗輪之心行於本天之周而伏見輪以太陽爲心故遂以太陽之平行爲平行皆相因而誤者也

論五星平行

然則金水旣非以太陽之平行爲平行又何以求其平行曰嵗輪之心行於本天是爲平行乃實度也實度者周度也【以本天分三百六十度而以各星周率平分之則得其毎日平行如土星二十九年奇而行本天一周則二十九日而行一度毎日平行二十九分度之一是爲最遲木星十二年周天毎日平行約爲十二分度之一火星二年周天約爲毎日平行半度金星二百二十餘日周天約毎日平行一度半彊水星八十八日奇而周天約毎日平行四度皆平行實度】若嵗輪及伏見輪𨿽亦各分三百六十度亦各有其平行然而非實度也【旣非本天上平行之度又非從地心實測之平行度】乃各星之離度耳因此離度【下文詳之】用三角法從地心測之則得其遲畱伏逆之狀亦爲實度矣【此實度不平行與本天之平行實度不同】

本天之度平行實度也嵗輪及伏見乃離度也離度爲虛數故皆以半徑之大小爲大小

伏見輪上行度與嵗輪同所不同者半徑也伏見之半徑皆同本天嵗輪之半徑皆同日天

論離度有順有逆

問何以謂之離度曰於星平行內減去太陽之平行故曰離度乃離日之行也以太陰譬之其毎日平行十三度奇者太陰平行實度毎日十二度奇者太陰之離度也【於太陰平行內減太陽平行】是故金星毎日行大半度奇水星毎日約行三度皆於星平行內減太陽之平行因金水行速其離度在太陽之前乃星離於日之度故其度右旋順行與太陰同法也

若上三星則當於太陽平行內減去星行是爲離度蓋以上三星行遲在太陽之後乃星不及於日之度其度左旋而成逆行與太陰相反然其爲離日之行度一而已矣【王寅旭五星行度觧謂上三星左旋蓋謂此也然竟以此爲本天則終非了義】

論平行有二用而必以本天之度爲宗

平行者對實行而言也然實行有二一是本天最髙卑之行亦曰實行一是黃道上遲畱逆伏實測亦曰視行是二者皆必以本天之平行爲宗

若金水獨以太陽之平行爲平行是廢本天之平行矣又何以求最髙卑乎

圍日之輪【卽伏見輪】起合伏終合伏是卽古法之合率也本天之行則古法之周率也最髙卑則古法之歷率也又有正交中交以定緯度卽如古法之太陰交率也【此一法是西法勝中法之一大端】是數者皆必以本天取之故不得以圍日之輪爲本天

歷指言金星正交定於最髙前十六度水星正交與最髙同度其所指皆本天之度非伏見行之度則伏見輪不得爲本天明矣

今以七政歷徵之不惟最髙卑之盈縮有定度卽其交南北亦有定度故金星恆以二百二十餘日而南北之交一終水星則八十八日奇而交終此皆論本天實度原不論伏見行是尢其較著者矣

論金水交行非徧交黃道

問周云淵言金水徧交黃道不論何宮今日交有定度何也曰云淵之說蓋因回回歷緯表而誤者也何以言之回回歷以自行度小輪心度立表而定其交黃道之度非以黃道度爲主而求其交處也故其所謂宮度者皆小輪之宮度也非黃道之宮度也若謂黃道之宮度而可以徧交將正交之度亦無定在矣又安得謂金星正交在最髙前十六度及水星正交定於最髙同度乎必不然矣【正交定度𨿽出曆書然與回歷原是大同小異】

今以七政歷攷之金星水星之交周皆有定期【金星以二百二十餘日水星以八十八日奇】但嵗輪心行至正交卽無緯度不論其爲合伏爲衝退爲疾爲遲或畱也以此而斷其必有本天有嵗輪可以勿疑

論金水伏見輪

伏見輪卽繞日圓象也其半徑與本天等本天上嵗輪心所行之周半在黃道北半在黃道南其勢斜立如太陰之出入黃道爲陰陽曆也而星體行伏見輪周其勢

亦斜立與之相應故其交角

等

嵗輪心在正交或中交則星無緯度

故伏見輪上亦有正交中交嵗輪

心行過正交漸生北緯至離正交九十

度則北緯極大如太陰之陰曆半交

也【古法正交後陽曆中交後陰曆西法則反用其號然其用不殊】

嵗輪心行過北大距【離正交九十度至一百七十九度】北緯漸小至中交而復無緯此如太陰之陰曆半周也嵗輪心行本天陰曆半周卽星在伏見輪上亦行北半周而其緯在北緯有大小無不與之相似

嵗輪心行過中交漸生南緯至離中交九十度南緯極大如太陰之陽曆半交也嵗輪心行過南大距南緯漸小復至正交而無緯如太陰之陽曆半周也卽星在伏見輪亦行南半周而南緯之大小一一與本天相似聨正交中交成一綫此綫在本天必過地心以本天圓面與黃道面斜交相割而成也而在伏見輪亦必過日心以伏見輪之繞日圓象亦與黃道面斜交而半在黃南半在黃北圓面相割成綫也以此綫爲橫綫而均剖之作十字橫綫則上下兩端所指並半交大距度矣此伏見輪上十字綫之理也

伏見輪心卽太陽太陽行黃道三百六十度伏見輪亦隨之行一百六十度而十字之形不變此正視之形也又正視圖不能見交角故必以旁視明之伏見輪事事與本天等故以本天明之

如圖甲丙乙壬爲本

天渾員之體【因旁視卽爲本天渾

體】甲心乙卽本天之星

道【因旁視故前平視之外周躋縮成一直綫

也】心卽地心【在伏見輪卽爲太陽】又

卽爲正交中交【因旁視正交中

交過心橫綫竟防成一點】丁心癸卽本

天上黃道圈【本天小於黃道然其度一一與黃道相應而成一圈亦因旁視防成】

【一直綫】兩直綫相交於心卽成緯度角【兩直綫相交卽兩圈】

【相交也亦卽爲兩圓靣相切兩圓面者一爲星道一爲黃道在渾體皆成面】甲心丁角在黃道北其弧甲丁其正甲庚北大距之緯度也【甲丁弧𨿽在本天然卽外應黃道緯】乙心癸角在黃道南其弧乙癸其正乙辛南大距之緯度也【乙癸弧在本天外應黃道與甲丁同】

問何以分南北也曰甲丁與乙癸兩大距弧各引長之成一全圈在本天渾體卽外與黃道上過極經圈相應而北心南直綫爲之軸北卽北極南卽南極亦與黃道之南北極相應矣甲心綫在黃道北卽生北緯乙心綫在黃道南卽生南緯又何疑哉【甲心半徑也以旁視故正交後北半周一百八十弧度並躋縮成直綫與半徑等乙心之在南亦然】

然何以謂之大距曰甲丁緯弧與甲心丁角相應爲北大緯乙癸弧與乙心癸角相應爲南大緯甲乙並居半交故其緯最大其未及半交及已過半交其緯並小南北並同也

問緯度卽角度也角同而緯有大小何也曰角𨿽同而邊不同也大距度以半徑爲全數其餘各度並皆以正當全數

假如任舉一度如過正交三十度爲戊【未至中交三十度亦同】其正戊心法爲甲心全數與甲丁大距之正甲庚若戊心正與戊子弧之正戊巳也【戊心巳句股形與甲心庚形相似同用心角而戊心邊正得甲心之半則戊巳亦甲庚之半而戊子弧亦必爲甲丁之半矣他皆仿此】以上所論皆本天之事然伏見輪之理並無有二故此一圖卽可作伏見輪觀其旁視之交角甚明也

論伏見輪十字綫

伏見輪旣爲繞日員象而生於本天之嵗輪故其面與本天等徑而其斜交黃道之勢亦與本天等夫本天之斜交黃道也半在北半在南惟正交中交二與黃道合聨此二過心是爲交綫卽兩員面相切所成也從交綫上中分之作過心十字直綫至本天周卽大距綫也何則黃道面上原有十字綫正視之兩綫合爲一直旁視之則本天直綫斜穿而成交角故此直綫在本天卽爲大距綫也此直綫所指本天之度正在二交折半之中其距最大故卽爲大距綫然則此十字綫者固本天所原有而伏見輪之斜交黃道旣與本天等則其十字綫亦無不等矣

伏見輪卽爲繞日之員象則太陽卽輪心太陽行於黃道故伏見心釘於黃道也然其心𨿽釘於黃道而其面則半在北半在南一定不易任輪心在黃道之何度而其斜交之面總與本天爲平行故其交綫皆不變其十字大距綫亦不變也

由是觀之伏見輪亦有二面何則伏見輪之面旣斜交黃道與本天之面爲平行則其相當之黃道亦卽有與伏見輪相應之一圏與黃道面平行而與伏見輪斜交亦如本天之與黃道斜交矣

如是則伏見輪之交綫常與本天之交綫平行不論在黃道上何度分也而伏見輪上之從心所出之十字大距綫及所相當黃道上從太陽心卽輪心所出之十字綫亦與本天心黃道之十字綫平行而兩十字綫正視之成一直綫旁視之一直一斜而成大距之交角亦一一與本天交黃道之角分寸不爽故用伏見卽如本天也

論伏見輪之所以然

伏見輪半在日天外半在日天內其半徑與本天等卽星體所行也【黃道半徑與金星本天之比例約爲十與七二有奇】伏見輪以日爲心繞日環行與本天周上嵗輪心行度相應故其大相等本天半在黃道北半在其南伏見輪亦然【門人劉著云譬如人放紙鳶人在下環行而紙鳶亦在空際環行蓋以紙鳶爲風所舉不能下而又爲綫所引不能不環行可謂善於形容】故惟本天之度爲實度不惟伏見輪爲星繞日行之虛迹卽嵗輪周上星行之度亦虛設之員周非硬圏有形質也譬如浮屠髙尖有珠如日人持長竿竿上端有微小之珠【如金星】浮屠之中腰有圓圏梯道斜繞之【如金星本天之斜立】人行其上【如嵗輪心之行於本天周】其珠竿直立指天其長也如浮屠尖至其腰圍之心【如星在嵗輪周至嵗輪心之徑與日天半徑等】兩珠相望有繩系之其繩常引直而有定距與腰圍斜繞之磴道等【如金星繞日有定距與本天半徑相等】持竿者循斜梯繞浮屠旋轉平行之則竿上珠自然亦繞尖上大珠旋轉成員象矣【此如伏見輪爲繞日之員象】

由是言之可以免嵗輪大小之疑何則嵗輪之心行於本天之周而本天旣有髙卑嵗輪心行於髙度則金星在伏見輪者離地逺矣嵗輪心行低度則星在伏見輪者離地近矣近則覺嵗輪之半徑小矣逺則覺嵗輪之半徑大矣若嵗輪爲堅靭之物何以能伸屈如此乎更以視法徴之何以在最髙反大在最卑反小乎必不然矣

嵗輪之大小又因於太陽髙卑伏見輪旣以日爲心則太陽行最髙時伏見輪從之亦髙而星去地逺太陽行最卑則伏見輪從之卑而去地近亦遂疑嵗輪之有大小而與視法反若知嵗輪亦非眞有輪則羣疑盡釋矣

求伏見輪交角

伏見輪斜交黃道旣一一與本天等則伏見輪交角與本天交角亦必相等

假如本天大距緯度之正欲變爲伏見輪上大距之正法爲黃道半徑與本天大距之正【卽本天交角】若伏見輪半徑【亦卽本天半徑】與伏見輪之大距正也

金星本天交角定爲三度二十九分水星六度分一黃道半徑【全數】

一○○○○○

二本天交角【正】

○六○七六

二伏見輪半徑

七二二五一

四伏見輪大距緯【正】○四三八九

王寅旭中緯準分是○四三九○蓋以得數九九七收作一數故也

其餘各度並先以全數爲一率交角正爲二率各度正爲三率得四率爲各度緯

再以全數爲一率各度緯爲二率伏見半徑爲三率求得四率爲各度變率之本緯

簡法置交角正以各度正乘之去末五位又以伏見輪半徑乘之去末五位卽徑得各度變率本緯又防法黃道半徑爲一率大距正變率爲二率各度正爲三率得各度本緯爲四率

假如伏見輪上距交三十度求其本緯

一黃半徑全數一○○○○○

二【大距正】變率

○四三九○乘得二一九五○○三三十度正五○○○○○○○

四三十度本緯○二一九五

解曰此以變率求變率故徑得本緯不須再變寅旭用中緯準分卽此理也

求各度正余變率法

置各度正余以伏見輪半徑乘之得數去末五位卽得變率之正余

求金星視緯法【水星仿此】

一求合伏距交

法以本日太陽實行在正交後宮度【卽伏見輪心距交宮度】命爲合伏距交度

解曰凡星合伏必與太陽同度太陽行一度小輪上合伏亦隨之移一度故太陽實行度卽輪心而輪心距交必與輪周之合伏距交等角

二求星距交

法以用日距合伏后日數在位用星離日度三十七分弱爲法乘之得離日平行以加合伏距交度爲星距交平行度再簡本度盈縮差加減之【卽加減差從最髙卑起算】爲星實行距交度分

解曰金星之行速於太陽太陽行一度金星行一度三十七分弱有奇故𨿽與太陽同行而常在前謂之離日度曆書以太陽之行爲星平行非眞平行故必並此離日度始爲眞平行

星平行在伏見輪周而根本在本天嵗輪心行於本天有髙卑加減古歷謂之盈縮差伏見輪上行旣與本天上嵗輪心行相應則亦必有盈縮加減矣

三求兩距交度入陰陽曆及初末限

法以兩距交度【一伏見輪心距交是黃道上度一星體距交是伏見輪周度】並視其在半周以下爲入陰曆【○一二三四五宮】滿半周以上內減去半周爲入陽曆【六七八九十十一宮】各視其度在象限以下爲初限【○一二宮爲陰曆初限六七八宮爲陽曆初限】滿象限以上用以減半周餘爲末限【三四五宮爲陰曆末限九十十一爲爲陽曆末限】

四求視緯正

法以星距交正【用變率】及各度本緯【變率】各自乘實相減得數開方得根以加減黃道正【卽輪心距交度正用本數】爲黃道正又自乘之得數以與本緯自乘實相並【本緯實卽上所求】爲視緯股實開方得視緯正【防法不必開方只用股實】

加減例視【黃道上輪心伏見輪上星】兩距交度【同在陰曆或同在陽曆則相加或一在陰曆一在陽曆則相減】

解曰星距地心綫如句股之卽全數也故亦有其正爲股余爲句

五求視緯余

法以星距交度余【變率】加減黃道余【用本數與正同】爲視緯余

加減例視兩距交度【仝在正交邊或仝在中交邊則相加若一在正交邊一在中交邊則相減】

解曰在正交邊者陰曆初限陽曆末限也陰曆初限爲已過正交在正交前一象限也陽曆末限爲未到正交在正交後一象限也此兩象限共一百八十度在十字直綫之右並於正交爲近也

在中交邊者陰曆末限爲未到中交之度在中交後一象限陽曆初限爲已過中交之度在中交前此一百八十度在十字直綫之左並於中交爲近也

又總解曰正之加減論陰陽曆以十字橫綫爲斷也余之加減論正中交以十字直綫爲斷也橫綫者交綫也直綫者大距綫也正綫並與大距綫平行是各度距交綫之數余綫並與交綫平行是各度距大距綫之數於此而知十字綫之爲用大也

六求星距地心綫

法以視緯正余各自之並而開方得星距地心綫七求視緯

法以各度本緯【變率】加五位爲實星距地心爲法除之得視緯論曰必如此下算則事事有著落視緯得數始眞若前緯後緯之表以中分取數加減法𨿽巧便得數亦恐不眞耳

假如金星伏見輪心距正交三十度星距合伏三十五度求視緯

如圖大圈爲黃

道小圈爲伏見輪

輪心在日距正交

爲井日弧三十度

合伏距正交爲

合正亦三十度星在戊過合伏三十五度距正交爲戊正弧六十五度

法先用日乙丙丁戊巳兩三角形依變率法日乙與乙丙大緯正若丁戊星距交正與戊巳緯次用丁戊巳直角形巳爲直角戊丁爲戊巳爲勾求得巳丁股次用戊巳癸直角形巳爲直角以巳丁股加丁癸【丁癸卽日壬爲輪心距交井日弧正】共己癸爲股戊巳爲勾求得戊癸爲視緯正次以星距交正戊弧余丁日卽壬癸也與壬心相加【壬心爲輪心距交井日弧之餘】共癸心爲視緯余次用戊癸心形癸爲直角戊癸爲股癸心爲勾求得戊心星距地心綫末用心戊巳直角形巳爲直角心戊與戊巳緯若全數與戊心巳角之正求弧得心角視緯度【圖內諸三角形俱是立三角須以渾體觀之便明】

按右法未加髙卑之算蓋前緯後緯表原亦未用髙卑也若求宻率仍當以髙卑入算爲穏說具後條

又按依右法用三角形推算可不必立前後緯表亦不用中分曆書蓋以作表故用約法以該之也

論大距緯之變率又以髙卑而變

大距緯者卽黃道交角之正金水本天半徑皆小於黃道半徑【黃道常爲十萬而金星本天半徑得其十之七有奇水星得其十之三有奇】故其大距緯亦小於黃道之大距緯而各度從之皆有變率矣然星本天旣有髙卑則其半徑亦時有大小而其距緯亦從之有大小變率之法又當以此爲準的也準前論在本天最髙則半徑大而伏見輪半徑亦大卽距緯亦大矣在最卑則半徑小【本天與伏見輪並仝】距緯亦小矣【皆變率之距緯】說者遂謂其與視法之理相反殊不然也何則本緯之變率與視緯之變率不同也

本緯在最髙則半徑大本緯亦大在最卑則半徑小本緯亦小乃本天自有之數非闗視法【伏見輪上緯仍是本天】視緯星距地逺則大緯變小星距地近則小緯變大全系視法【從地上看伏見輪上星】

論黃道亦有半徑之大小

黃道半徑常爲十萬分全數然黃道旣有髙卑則其半徑必有大小最髙時半徑必十萬有奇最卑時半徑必十萬不足日躔章原有太陽距地髙卑表所當取用者也

太陽距地爲黃道半徑亦卽伏見輪心距地也在上三星用嵗輪卽爲嵗輪半徑王寅旭曰因黃道之髙卑而嵗輪有大小蓋謂此也今按嵗輪與黃道同大歷家算髙卑或用不同心圏則其距地之數有大小乃是半徑有大小非以此半徑另作一圏也以嵗輪立算乃是數中之象因天運有常故可以輪法測之此可爲達者告也論伏見輪半徑亦有大小而本緯因之有大小

本天旣有髙卑則半徑有大小而伏見輪並與之等伏見輪半徑旣有大小則其正余之變率及大距度之變率與各度之本緯並因之而有大小

法以本天髙卑求得各度半徑爲伏見輪各度半徑【最髙距正交十六度起算】

就以半徑爲法乘各度正余去末五位爲正余變率又以半徑爲法乘大距正【金星大距三度二十九分】去末五位爲大距變率

就以大距變率爲法乘各度正去末五位爲各度本緯

以上數端並以最髙變大最卑變小

論視緯當兼用兩種髙卑立算

準上論黃道半徑有大小伏見輪半徑及正余及本緯並有大小必兼論之則視緯始爲宻率

法以伏見輪各度正變率自乘本緯亦自乘兩得數相減開方求根以加減黃道正【髙卑所求】爲正又自乘之以並本緯自乘爲視緯自乘實【卽視緯股實】又法不用加減但以伏見輪正【變率】爲一邊黃道正【髙卑所算】爲一邊大距度外角【以大距角減半周】爲一角用切綫分外角法求得視緯正自乘爲股實亦同又以伏見輪余黃道余相加減【俱用變率】爲視緯余又自乘之爲句實並視緯股實句實開方得卽星距地心逺近綫也

末以星距地心爲法本緯【變率】加五位爲實實如法而一得視緯宻率

黃道髙卑於太陽實行度取輪心距最髙宮度【在正交後若干度起算】

本天髙卑於伏見輪上星實行度取距最髙宮度【距正交十六度起算】

又按用此宻率當設兩表

一伏見輪上各度半徑表以金星髙卑算得其大小一伏見輪上各度大距表卽以各度半徑乘大距變率正全數除之卽得

其黃道中各度半徑卽用日躔髙卑表不必另作有各度半徑卽可求逐度正余變率【黃道仝】

有各度大距變率卽可求各度正緯以上俱用乘法按金星之最髙不與正交同度相差十六度當於伏見輪上安兩種十字綫水星之最髙則與正交同度

論金星前後緯表南北之向

金星前緯自小輪初宮向北其緯極大爲一度二十八分自此漸減至二宮三十度而減盡無緯度【卽三宮初度】自三宮初向南漸有南緯至五宮三十度南緯極大爲九度○二分【卽六宮初度】

自六宮初以後南緯漸減至八宮三十度南緯減盡無緯【卽九宮初度】

自九宮初度復向北漸有北緯至十一宮三十度復爲一度二十八分【卽初宮初度】

據此則金星前緯南緯大北緯小南大緯至九度○二北大緯只一度二八而分爲四限

自合伏至畱際【乃嵗輪上距合伏九十度亦可名爲畱際】北緯減盡爲初限自畱際向南至退合南緯至九度○二分【爲南緯極大】爲次限

自退合以後南緯漸減至畱際【距退合亦九十度】南緯減盡爲三限

自畱際復向北至合伏北緯至一度二十八分【北緯極大】爲末限

此蓋以嵗輪上合伏之時星距地逺故緯度見小退合之時星距地近故緯度見大

此前緯是置輪心在正交後大距處而算伏見輪上一周之緯故其南北之向如此

金星後緯自小輪初宮初度無緯度自此向北而生北緯北緯之大爲二度三十三分在四宮十五度自此漸減至五宮三十度北緯減盡【卽六宮初度】

自六宮初度以後向南而生南緯南緯之大亦二度二十三分在七宮十五度又自此漸減至十一宮三十度南緯減盡【復至初宮初度】

據此則金星後緯向南向北分爲兩限【其增減之分南北相同但有順逆而無大小】

自合伏始向北而生北緯至距合伏一百三十五度北緯甚大【至二度三十三分】至距合伏一百八十度北緯減盡而無緯度【卽退合時其距大緯度相距四十五度】是爲北緯限

自退合後始向南而生南緯至距退合四十五度南緯甚大【亦二度三十三分】從此漸減至退合一百八十度南緯減盡而無緯度【卽復至合伏其距南大緯度一百三十五度】是爲南緯限此後緯是置輪心在正交而算伏見輪上一周之緯故其南北之向若此若水星南北之向俱與金星相反然伏見輪之理則同

合前後二緯表觀之距合伏后一象限前後緯宜相加以其同爲向北也距退合前一象限前後緯宜相減以前緯已攺向南而後緯仍向北也

過退合後一象限前後緯又宜相加以前緯仍向南而後緯亦向南也過退合後第二象限【卽距合伏前一象限】前後緯又宜相減以前緯已攺向北而後緯仍向南也

論金星前後緯加減之法

前緯起大距【凡言起者卽合伏所在】自初宮至二宮共九十度爲陰曆末限後緯起正交自初宮至二宮共九十度【○一二宮】爲陰曆初限𨿽分初末皆陰曆也故相加

前緯過九十度【三宮四宮五宮】爲陽曆初限後緯過九十度【三宮四宮五宮】爲陰曆末限一陰曆一陽曆南北相反故相減前緯過一百八十度復行九十度【六宮七宮八宮】爲陽曆末限後緯過半周復行九十度【六宮七宮八宮】爲陽曆初限並陽曆俱在南故亦相加

前緯過二百七十度行一象限復至合伏【九宮十宮十一宮】爲陰曆初限後緯過二百七十度行一象限【九宮十宮十一宮】復至正交爲陽曆末限一陰曆一陽曆故又相減

此置輪心【卽太陽】於正交【後緯】及正交後大距【前緯】立表若置輪心於中交【爲後緯】及中交後大距【爲前緯】則陰陽之名相易然加減之法並同

並以合伏后一象限相加【○一二宮】第二象限相減【三四五宮】退合後一象限【六七八宮】又相加第二象限又相減【九十十一宮】又按曆書樞綫之說蓋是謂交防移則南北變恐非有翕張之形也假如交在合伏則合伏綫與交綫合而無緯度若合伏過正交若干度則正交上之合伏后若干度【卽合伏防距樞綫之度】此處無緯度而合伏反有緯度矣是緯度之變動全系乎樞綫之移也【卽輪心所到】

論五星以髙卑變緯度

本天髙卑能變緯度理宜有之然按圖詳審其法有三其一於本天之斜交徑上作嵗輪三徑綫與黃道面平行逺近不同緯度自異其二於本天斜徑上只作一嵗輪徑綫而最髙卑之嵗輪心有時而移卽其周之長短隨之逺近其三亦只作一徑綫而行最髙時嵗輪圏大行最卑時嵗輪圏小三者𨿽同用最髙卑立算而加減各異此必徴之實測乃可定之

第一法用三綫則交角𨿽不變而嵗輪面與黃道面之逺近頓殊【角旣同矣緯何得異曰所用之本天徑綫不同也假如中距時交角爲三度其所得正乃中距時徑綫爲全數也若最髙時則其全數大矣𨿽亦三度角之正而其實數則大矣故緯亦大最卑時全數小而正亦小彷此論之其畱際上下角不同者又在其外也】

又有異者若用三綫則交防亦當有變何也中距面綫至正交時與黃道面徑合爲一綫其餘兩嵗輪面綫必一在北一在南【按至交防則三綫合一此一節可以勿論】

第二法嵗輪只用一綫其面之距緯本無不同而最髙卑時輪心有動移最髙時輪心在上則正綫如故而角變小矣【謂小於中距之角】最卑時輪心近下則正如故而角變大矣【大於中距角】何則正𨿽同【謂嵗輪面與黃道面平行之緯】而輪心在上則逺於地心而見小矣輪心在下則近於地心而見大矣【又法用不同心於黃道則不但正不變角亦不變但人在地心視之則有大小與上法二而一者也】

第三法只作一嵗輪徑綫【凡言徑綫皆因旁視而面變爲綫】而其兩端並作三層綫折半爲嵗輪心而兩端無參差盡其輪邊【卽徑綫兩銳尖盡處】爲最大圏之徑乃最髙時所用兩端各縮進爲界則中距時徑也兩端又縮進爲界則最卑時圏徑也西曆論火星嵗輪有大小之故解之以髙卑而王寅旭亦取之用此法也

以上三法不知誰爲定法故曰必徴諸實測

又按三法在上三星其用皆同至金水則又大異何則金水嵗輪大於本天【以其徑同太陽天故】則包過地心退合時輪心在人之背而星在輪周跨過地心在人之上星之下星在輪周與其輪心如月之望而人居其間故最髙時輪心逺於地而星在輪周反近於地緯反變大矣若最卑時輪心近地而星在輪周反逺於地緯反變小矣此自然之勢不得不然者也【此在第一法第二法並同】

若用第三法則𨿽有髙卑而兩端之逺近不變與前二法相反故必徴之實測乃取其合者用之

楊學山曰西法步五星土木火有嵗輪金水有伏見輪𨿽兩輪行度求角之法皆同然嵗輪上爲星離日之虛度輪心在本天伏見輪則自有行度輪心卽太陽細按曆書之說蓋謂上三星本天包太陽天外星離日而又與日有定距是生嵗輪其半徑恆與太陽天等若金水之本天卽太陽天其平行與太陽同距地亦與太陽等【俱一千一百四十二地半徑】而此伏見一輪以日爲心繞日環轉而爲伏見使非此輪則星無所爲伏見【以平行同太陽故也】故名伏見輪之半徑皆有定度【金星七千二百奇水星三千八百奇】是其意原非以伏見輪當嵗輪若果卽爲嵗輪則半徑宜有大小何則火星因與太陽天近尙有日躔本天二差以變次均角豈金水在太陽天下而反無之今測不然是伏見輪另爲一種行動爲金水之所獨故昔人別立伏見輪之名也其所云卽嵗輪者蓋因行法相同而混言之耳今勿庵之說又異是謂五星皆同一法皆有嵗輪上三星因本天大故用嵗輪金水因嵗輪大難用故用繞日圓象【卽伏見輪如上三星圍日之圏】如此可明金水自有本天因得自有髙卑亦自有平行度因在日天下速於太陽本天斜倚黃道因有正交中交之名諸根底俱有著落且五星一貫但依此立算凡星平行自行之根數初均次均之度分南緯北緯之大小皆與曆書數迥異驗之於天末識合否余嘗疑歷指論五星緯說多混淆金水尢略因作五星緯行解一卷明之勿庵之說不敢遽定其是非存之以待參攷焉

歷算全書卷十六

欽定四庫全書

歷算全書卷十七

宣城梅文鼎撰

火緯本法圖說

熒惑一星最爲難算至地谷而其法始宻圖表具在可攷而知也何嘗云火星天獨以太陽爲心不與餘四星同法乎作曆書者突發此語遂令學者沿譌是執圖以觀圖而不以算理觀圖也不知歷算家有實指之圖有借象之圖地谷氏之圖火星所謂借象也非實指也錢唐友人袁惠子士龍受黃三和先生憲歷學以歷指爲金科余故爲作此以極論之而徴之切綫分角之法以著其理袁子虛懷見從已復質諸睢州友人孔林宗興秦亦以爲然而手抄以去又旁證諸穆氏天步眞原王氏曉庵歷法大防亦多與余合

火星本法【發曆書之覆】

據歷指萬曆癸丑年太陽在降婁宮一十四度有半

地谷測火星體防合於井宿第五星

經度爲鶉首四度半

緯度在黃道北二度十一分

火星平行在壬

距冬至二百一十七度半彊

火星最髙在丙

引數自丙歷丁至壬三百三十八度半弱

圖說乙爲地心卽爲各天平行之心【亦黃道心】大圈爲火星平行之天內圈爲太陽平行天皆以地爲心【其度皆應黃道】太陽在本天自春分壁向婁順行火星嵗輪心在本天自丙過丁至壬順行太陽行速而火星行遲今太陽在後火星在前是

太陽與星已過相衝之度而從後逐星也火星在嵗輪上亦自戌順行過亢至申合伏時星在戊衝日時星在亢今在申是星己過衝日之限而復向合伏也太陽距星實行爲婁張【亦卽心氐】以減半周爲張角爲黃道上星距日衝之度【亦卽氐未】太陽在黃道上自婁仍順行其衝亦自角順行星亦自氐順行而日速星遲故其距漸近而星距日衝漸逺則星在嵗輪上距合伏之度亦漸近距衝日之度亦漸逺其嵗輪上漸逺漸近之度皆與黃道上距度相應然黃道上婁張是日在後追星嵗輪上是星向合伏【申戌】黃道上日衝度漸離星【角張】嵗輪上是星離衝日【申亢】

本法以平行壬爲心作子癸小輪自最髙子過癸左行爲引數之數至醜又以醜爲心作夘辰小均輪自辰最近右行過夘歷寅復過辰歷夘至寅爲引數之倍減去全周得嵗輪之心到寅

先以丑寅壬三角形求得丑壬寅角及壬寅綫次以寅壬乙形求得寅乙綫爲嵗輪心距本天心之數又求得壬乙寅角爲平行實行之差卽前均也因在後六宮其號爲加得寅乙申角爲實行視行之差

此以上曆書之法並同以下則異

次以寅爲心作嵗輪戊申亢圏也戊爲最逺合伏之度也亢爲最近衝日之度也今太陽在降婁火星在鶉首是已過衝日之度而日反在後以逐星也其日星之距爲降婁至鶉首之度在嵗輪上則爲申戊弧乃星行嵗輪末至合伏之度也【歷家謂之距余蓋順數自戊合伏過亢衝日至申爲距合伏行度以全周得申戊爲距余】以申戊減半周得申亢爲巳過衝日之度卽申寅亢角【或申寅乙角】

末以申寅乙三角形求申寅半徑此形有先求得寅乙距心綫又有申乙寅角爲先測火星視行與所算實行之差度有申寅乙角爲嵗輪上己過衝日之度有兩角自有寅申乙角法爲申角之正與乙角之正若寅乙綫與申寅綫也【此以測得視差而求半徑】若先有申寅半徑而無視差度求乙角者則以切綫法求之以申寅邊乙寅邊並之得戊乙爲總數【一率】又以申寅減乙寅得亢乙爲較數【二率】以申戊度半之爲距余半求其切綫【爲三率】法爲總數與較數若半距余角【卽半總角】之切綫與半較角之切綫也求得四率查切綫得其度以減距余半之度余爲申乙寅視差角乃以視差角減實徑爲視徑【已過日衝其差爲減】此本法也曆書所載求法得數並同而其圖迥異蓋巧算耳下文詳之

曆書之法亦是用兩角一邊以求余邊【星過日衝弧度是一角測得視行與實行之差是一角算得寅乙距心綫是一邊今以法取嵗輪半徑爲所求一邊】然不正作申乙寅視差角而反作乙寅甲爲視差角故亦不正作申寅乙星過衝日角而作寅乙甲爲星距衝日角然則用本法者惟寅乙距心一綫耳

然旣有寅乙綫爲主又有寅乙甲爲星距日衝度有乙寅甲角爲視差度則乙寅甲三角形與申乙寅三角等而甲乙邊必與申寅半徑同矣此倒算防法與加減差法不作角於心而作角於邊同一樞軸也

其法以先得寅乙綫爲三角之底其兩端各作角【卽先得兩角】

各引其邊遇於甲則甲乙爲半徑【寅甲亦卽爲星體距心與申乙之距同矣又大陽心在降婁其衝未在壽星星實行在氐氐末爲氐乙未角卽星實行己過日衝之眞距也正與嵗輪上申亢度等故用氐乙未角爲黃道上星距日衝之度與用嵗輪上申寅亢同此爲借象之一根】

然又以甲爲地心而作圏周分十二宮何也曰此則借象也其法妙在作甲己綫與寅乙平行何也先依寅乙綫作三角形其寅甲原與申乙平行今己甲又與寅乙平行則寅甲己角與申乙寅角等度而且等勢矣【寅甲綫斜交於寅乙及甲己兩平行綫中則所作寅甲己及甲寅乙兩角等寅乙綫斜交於申乙及寅甲兩平行綫中則甲寅乙與申乙寅角亦等而寅甲己角與申乙寅不得不等矣○角之度旣相等而寅乙綫卽原用之綫也今巳甲與寅乙平行故不惟等度而且等勢也】由是而自甲心作春秋分橫綫井箕直綫卽與乙心所作大圏上降婁壽星橫綫及冬夏至直綫悉爲平行而等勢【橫與橫平行直與直平行則其勢等】於是而勻分十二宮卽無一不與乙心所作大圏等

十二宮旣與大圏等勢而寅甲己角又與大圏之申乙寅角等度等勢則己甲綫卽指星實行度寅甲綫卽指星視行度而可以命其宮度不爽矣推此而辛甲爲星最髙指綫及作平行綫於己甲實行之內一一皆眞度矣

又以乙爲太陽體何也曰太陽實行降婁宮度原在大圏其離降婁之度爲乙角今太陽指綫過乙至甲則甲角與乙角等度而乙防在次圏上【甲心所作之甪】距春分之度與大圏等【圏有大小而角度等】卽太陽眞度可以命之爲日矣乙旣命爲日則次圏可命爲太陽所行之天而乙心所作大圏以太陽之衝處割小圏有火星行嵗圏最近侵入太陽天內之象故遂以大圏命爲星行之圏也【又寅乙甲角原爲星距日衝之度與申寅乙角同而甲己旣與寅乙平行甲未卽甲乙之截綫則己甲未角又與寅乙甲角同而己亥與嵗輪上申亢同爲星距日衝之】

此一圖也有嵗輪半徑之數【甲乙】有火星實行視行差度【寅甲己角】有周天宮度有太陽度及火星最髙卑度又有火星行最近入太陽天內之象可謂簡而該巧而妙矣非地谷精於測算神明於法不能爲也

然則何以謂之借象曰以其一圖而備數端故知之也何以言之甲乙者嵗輪之半徑也不得與日距地心同數一也寅乙距心之綫從兩小輪求出而兩小輪在火星本天是從乙心起算不從甲心起算二也因寅乙距心之綫以得視差之角亦爲乙心之角非甲心之角三也若甲眞爲地心則與乙太陽有距數太陽乙心所見之差角至地心必不同觀四也視行實行之差角爲地面實測非乙心之數不得兩處悉同五也又大圏旣爲本天而侵入太陽天內則將爲嵗輪之心若衝日之時嵗輪心旣在太陽天內星又在嵗輪最近將越過地心如金水之退伏合而不得衝日矣六也由是觀之此圖但爲借象巧算之用而非以是爲眞象也或者不察遂眞以乙爲日體則死於古人句下矣

或問五星新圖亦以火星天用太陽爲心而衝日之處割入太陽天內又何以說焉曰火星之行圍日而能割太陽天者乃嵗輪上周行之迹耳非本天也蓋火星本天在太陽之外能包太陽之天因嵗輪之行合伏時在嵗輪之頂去太陽益髙合伏以後離太陽漸逺則行於嵗輪中半與本天齊及其衝日則行嵗輪之底而在本天之內去地益近其去地益近者爲日所攝也此理五星所同故土木火三星皆可爲圍日之象今新圖五星不以地爲心者是也火星則嵗輪最大衝日時稍侵入太陽之天其實嵗輪之心仍系本天在太陽天外耳七政小輪周行於天遂成不同心之圏嵗輪周行於天成圍日之形一而已矣今以實數攷之火星嵗輪半徑約爲本天半徑十之六其合伏時則兩半徑相加成十六沖日時兩徑相減只餘十之四其侵入太陽天內約爲一二分則太陽天半徑只得火星天半徑十之六有奇而火星合伏時在太陽上約爲十分衝日時在太陽下亦約十分而成圍日之形矣是故以日爲心者嵗輪上星行之軌迹也非本天也【圖見下】

火星嵗輪上軌迹圍日之圖【土木二星因嵗輪之度而成圍日之形與此同理但其天更大而嵗輪小故不致侵入余裏之天】

丁庚寅辛爲太陽天戊癸己壬爲火星本天甲醜嵗輪以戊爲心丙子嵗輪以己爲心

丁爲日體甲丙皆星體

甲癸丙壬爲嵗輪上星行軌迹成一大圈而以丁日爲心

星天日天各有小輪髙卑其本天則皆以地爲心星在嵗輪甲爲合伏而去地極逺星在丙爲衝日衝日之時庚丙辛割入太陽天庚寅辛之內而去地極近

星在嵗輪丙時已割入日天然嵗輪心則在本天已若如眾說以割入日天內者爲本天則衝日時當以丙爲嵗輪心矣而星在嵗輪之上又當向日豈不越地心乙而過之乎必不然矣

切綫法解在後

火星次均解【火星次均用切綫求嵗輪上視差角乃三角法也】

欲明火星次均用切綫之法當先明三角形用切綫之法

甲夘乙三角形有甲鈍角一百五十度有甲乙邊六十有甲夘邊一百整求夘角

法曰以甲角減半周得餘三十度爲癸甲乙外角半之得十五度爲丙甲辛角其切綫辛癸【二六七九五】並甲乙【六十】甲夘【一百】共得丙夘一百六十爲首率【總數】以甲乙減甲夘余得辰夘四十爲二率【較數】半外角之切綫辛癸爲三率二率乘三率爲實首率爲法除之得辛夘【六六九八】爲四率卽辛甲壬減之切綫也以四率查切綫表得三度五十分弱爲辛甲壬減角以所得辛甲壬減角三度五十分減半外角十五度余壬甲丙角十一度一十分卽夘角也

今以火星言之丙乙辰圏則嵗輪也甲爲嵗輪之心丙甲辰夘過心綫卽星實行度分也

夘爲本天之心甲夘者距心綫也【卽表中距日數】甲丙甲乙甲辰皆嵗輪半徑也【卽表中半徑合日差而成星數也】

先以前均求到星之實行在甲矣然此嵗輪之心而非星也星則自丙合伏順行過辰衝日而漸近合伏其體在乙則丙辰乙爲星在嵗輪上行之度【與星距太陽實行之度相等】卽相距度也

乙丙則距余度半之爲辛丙則距余半也乙辰爲星巳過衝日之度則甲角度也

今已知嵗輪心實行之度又已知星在嵗輪上行之度所不知者視差角耳蓋自本天心夘作實行綫過甲心至黃道又從夘作視行綫過乙星體至黃道其差爲夘角是故求次均者求此夘角也

用上法以距日【卽距心】爲一邊【甲夘】以星數爲一邊【甲乙】以星行過衝日之度【卽乙辰】爲一角【甲角】成甲夘乙三角形依上法得夘角卽次均也

一率距日與星數之總【卽甲夘並甲乙亦卽甲丙】二率星數減距日之較【卽辰夘】

三率距余半之切綫【卽半夘角之切綫辛癸蓋乙甲丙角爲距余卽乙甲夘角之餘度半之爲辛甲丙角卽距余半】

四率減之正切綫【卽辛壬其角爲辛甲壬】

末於辛甲丙【距余半角】內減去辛甲壬【減角】余成壬甲癸角與夘角等得視差之度如所求

旣知三角形用切綫之法尢當進而明其所以用切綫之理

如後圖乙甲夘三角形甲角一百五十度甲乙邊六十甲夘邊一百兩邊之總一百六十爲首率兩邊之較四十爲次率甲角之餘角半之求切

綫爲三率【卽率癸】求得四率爲半較角之切綫辛壬求其度以減半余角得夘角

何以用切綫也曰此分角法也凡外角【乙甲丙爲乙甲夘之餘角亦爲外角】內兼有形內余兩角之度【乙甲丙外角兼有夘角及甲乙夘角之度】試作壬甲綫與乙夘平行分外角爲兩則壬甲丙角如

夘角矣【以壬申及乙夘皆平行綫而丙甲夘未一直綫故其作角必等】

外總角內減去同夘角之壬甲丙角則其餘壬甲乙角必爲甲乙夘角矣

今但有外角爲總角而不知其分角故以比例分之而切綫則其比例也

又試作乙丙綫爲外角之通又從乙作正綫至丁爲乙甲壬大角之正從丙作正綫至戊爲壬甲丙小角之正而通遇壬甲分角綫於子成乙子及子丙兩綫此大小兩綫之比例與大小兩角之正比例等何也乙子丁勾股形與丙子戊勾股形以子爲交角則相似而乙子【大】與子丙【小】若乙丁【大股】與丙戊【小股】矣

又甲夘大邊與甲乙小邊原若所對之大角正【乙角】及小角【夘角】正【凡三角形邊之比例與對角正之比例皆等】卽乙丁與丙戊也【角同則正同】則甲夘與甲乙亦若乙子與子丙矣

又試作辛甲綫分外角爲兩平分而各作切綫爲辛癸爲辛己【卽半外角之切綫】則兩切綫聨爲一【己癸】而與乙丙平行又引壬子綫割之則分爲二綫而己壬與壬癸之比例若乙子與子丙亦若甲夘與甲乙矣

又作庚甲綫使庚己如壬癸則庚壬爲兩綫之較己癸爲兩綫之總

而甲乙甲夘兩邊之較爲辰夘其總爲丙夘

甲夘大邊與甲乙小邊之比例旣若大綫【己壬】與小綫【壬癸】則兩邊之總與較亦必若兩綫之總與較矣

一率丙夘【卽甲乙甲夘兩邊之總】

二率辰夘【卽兩邊之較】

三率己癸【卽己壬壬癸兩綫之總】

四率庚壬【卽兩綫之較】

今各半之

辛癸半總【卽半外角辛甲癸之切綫】

辛壬半較【卽半較角辛甲壬之切綫】

旣得辛壬切綫查表得其角度卽半較角也以半較角減【辛甲癸】半外角卽半角也

若以半較角加【乙甲辛】半外角亦卽甲乙夘角矣

火星測算本法圖說【明曆書之倒算】

嵗圏半徑【六四七三八】甲乙

查加減表八宮十九度【四十分】半徑數【六四○八七三】太陽引數星紀二十三度加六宮爲六宮二十三度日差【一○一六】相並得【六四一八八】爲星數與所測防差

若用實引得半徑【六四四二五】其數益相近

距心數【九九六九七】寅乙

平引八宮一十九度【四十二分二十秒】

加均數一十度【三十三分三十秒】

實引九宮初度【一十五分五十秒】

查加減表八宮一十九度【四十分】距日【九九七○一】所差不多若用實引則距心【一○一六七四】差稍大然按圖用乙寅綫宜用實引

圖說本宜用寅防爲嵗輪之心以寅乙申角爲嵗輪上視差角卽寅未也

寅申綫則嵗輪之半徑也此爲本法

今曆書所載地谷圖不於寅心作嵗輪圏而以甲爲心蓋因戌寅亥角與寅乙申視角同度【切綫法用此角以代乙角】而甲寅乙角者戌寅亥之交角也凡交角皆同大則甲寅乙角亦卽寅乙申視角矣旣以甲寅乙角爲所測視角則乙防卽可爲嵗圈之心而甲乙寅角可代乙寅申角矣故以嵗圏上星過衝日之度【衝日卽近防亢星過日衝卽乙寅申角亦卽亢申】移作寅乙甲角自乙嵗圏心依角度作乙甲綫與寅甲綫遇於甲【先有乙寅甲角自有寅甲綫】則甲防卽嵗輪上星所到度可代申防而甲乙卽嵗輪半徑可代寅申矣故以甲乙綫爲半徑者巧法也

然則當以乙爲嵗輪之心用代寅防矣何又以甲爲心乎曰甲乙旣爲半徑則以乙爲心甲爲界或以甲爲心乙爲界其半徑等爲甲乙也故倒以甲爲心其法與諸加減表說作差角於圏界者同也【先倒作均角於寅界法同兩術中慣用此倒算之法】

然則以甲爲地心何也曰此則其移人耳目之法也何以言之彼固言甲乙爲嵗輪半徑矣又以甲心乙界之輪爲嵗輪矣甲旣爲嵗輪之心又安得爲地心乎然則地心安在曰以理論之仍當以乙防爲地心耳何也星之實經在寅其視經在未寅未之成寅乙未角此固實測之度也實測差角從地上得之安得不以乙爲地心乎若謂乙爲日體則日之去地逺矣日體所見之差角與測所見之差角必有分也而今不然故不得以乙心徑爲日體也

非地心而地心之何也蓋所以使人疑也其使人疑柰何嵗輪心之非地心易見也乙防之非日體難知也以其所易見例其所難知疑則思思則得矣地心旣非地心則日體亦非日體然則其中機彀固以示之矣又論曰借甲爲地心妙在作戊己綫與乙寅平行蓋甲己旣與乙寅平行則己甲寅角卽甲寅乙角亦卽寅乙申均角而甲地心所作之十二宮度一切皆與乙心所作之度相應矣此用法之巧也

先以乙寅甲角代寅乙申視角而取甲乙綫以代寅申半徑是倒算也復以甲爲心乙爲界作嵗圏以甲心代乙心亦倒算也兩番倒算而倒變爲順故甲可代乙爲地心卽本天心也而甲己綫與寅乙平行卽地心所指實行之度也己甲寅角卽視差角也寅甲綫卽視行指綫與申乙同也故天度皆應可作十二宮分細度也若於乙作嵗圏則但能得半徑而十二宮之向皆反矣故借甲爲心法之巧也

乂取甲爲心影出火星能入太陽天之象其實火星入太陽天者乃其嵗輪上度非嵗輪心也若眞以此爲嵗輪心則火星體將過地心而與日同度如金水矣又用甲爲心作十二宮則細度可不礙書若用本法則有兩小輪各綫相雜而不能詳書細數故移乙心於甲移寅乙申角爲己甲寅角也嗚呼可謂巧之至矣但未說破故後學遂妄爲作解耳

論曰旣火星初均在寅卽當以寅爲嵗輪心而今不然何耶曰此巧算也甲寅乙角卽寅甲己角也何也甲己與乙寅平行也卽均角也又乙寅者嵗輪心距日數也乙甲者半徑也寅乙甲角者先有之角卽星日相距之餘數也卽己過日衝之度本法以距日數及半徑爲兩邊與先有之角求均數角今先測得均角而無半徑故反用其法以求半徑法之巧也蓋先有兩角一邊而求余邊之法也

一率甲角之正【有乙寅兩角自有甲角】二率乙寅邊

【卽距日數實爲嵗輪心距本天心】三率寅角之正【卽均角乃所測視行與實行之差度】四率甲乙邊

【卽嵗輪半徑包有日差在內】

由是言之甲乃嵗輪心耳非地心也若甲眞爲地心則甲乙非嵗輪半徑矣

火星次均解查火星嵗輪半徑與本天半徑略如六與十宜卽用爲比例作圖則所得均角亦近【後數系初稿存例非火星正用】

圖說乙甲夘三角形有甲角一百二十度有甲夘邊一百乙甲邊四十一求夘角乙角乙夘邊

法曰以乙甲甲夘二邊並得一百四十一爲總【卽丙夘】爲一率又相減得五十九爲較【卽辰夘】爲二率丙甲乙外角六十度半之得三十度【卽辛甲丙角】其切綫五七七三五【卽辛癸】爲三率求得【壬辛】爲四率得二三九八八查表得十三度二十九分四十秒収作三十分【卽辛甲壬角】以辛甲壬角減半外角【辛甲丙角】得壬甲丙角十六度三十分卽夘角也又以辛甲壬角加辛甲丙【卽辛甲己】得壬甲己角四十三度三十分【亦卽甲乙夘角】末以甲乙夘角四十三度三十分之正六八八三五爲二率乙甲四十一爲三率全數爲一率法爲全數與乙角之正若乙甲與甲午也得甲午又甲乙夘角之餘七二五三七爲二率乙甲四十一爲三率全數爲一率法爲全數與乙角之餘若乙甲與乙午也得乙午用勾股以甲午冪減甲夘冪餘數開方得數

爲午夘乃並乙午午夘共爲乙夘邊

一系甲夘如火星距心綫【卽表中距日數】

甲乙卽如火星嵗輪半徑【卽表中半徑加日差爲星數之數】丙甲乙外角卽如火星行嵗輪上離合伏之度【卽日星相距度】

丙甲辛角卽如火星半距度【辛癸其切綫】

壬甲辛角卽火星減【壬辛其切綫】卯角卽均角

一系丙防如嵗輪合伏度甲爲嵗輪心夘爲本天

心丙甲夘綫卽嵗輪心平行綫

一系丙夘乙均角在前六宮是平行綫東爲加

一系嵗輪上加減以夘亥切綫所到爲限自丙防以至亥防距合伏度漸從小至大其均度漸增過亥防至辰衝日距度漸從大至小均度漸減蓋距合伏度大則半距亦大反之則小也

一系星行嵗輪過亥防則距度大而減更大故均數

漸減

如圖星行至未成甲未夘三角丙甲未外角半之於酉而壬甲酉爲減其得均角夘與星行在乙等

若欲知未甲辰角法用三率求之

一率甲未邊

二率夘角正

三率甲夘邊

四率未角正

旣得未角以並夘角而減半周其餘卽甲角也

星行到乙與星行到未同以夘角爲均度

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十七﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十七﹥

一系星之離日有定距

一系星之嵗輪與日天略等

一系日距星爲日離星而東日速故也

星距日爲星離日而西星遲故也

一系日距星爲日天之度星距合伏爲嵗輪之度一系論右旋則日速星遲若左旋則星反速於日故嵗輪心漸逺於日可稱左旋而嵗輪上圍日之象亦左旋也

一系星有遲速皆嵗輪心之行而星行嵗輪邊成圍日之行則

五星一理

一系星本天右旋星在嵗輪上亦右旋而星圍日之行左旋此外仍有自行之髙卑故土星能至甲木能至乙至丙火能至丁各天故不甚相逺

自人所見五星所當宿度則距日有逺近之殊而五星在天以徑綫距太陽終古如一以此圖觀之見矣

所異者五星各有髙卑本輪則有微差而火星則兼論太陽髙卑要不能攺其徑綫相距之大致

算火星前均及距地心綫用簡法依表說用兩小輪圖設平引三十度依表說算得均角四度五十分加減表四度五十分七秒表說差七秒

今用簡法得四度五十分十秒只差三秒

表說又算距心一十○萬九千九百○三加減表是一十一萬○○一十三差十萬分之一百一十【數見表首卷第四章

稱爲火星年嵗圈心距地心數】今用簡法得一十一萬○○一十九隻差十萬分之單六又原法用勾股作垂綫以求角求邊

今用簡法以半外角切綫乘兩邊之較爲實兩邊之總爲法除之卽得半較角以減半外角卽爲均角工力較前省半其小輪上加減之角用小輪半徑四與一之比例乘除工力尢省數倍

求邊之法只用對角之正比例工亦省半

竊意立表時當是用此法

凡諸表數或是西人成法翻譯成書或是歷局依法算演俱不可攷然是入用之數當以爲主

火星平引三十度算得均角四度【五十分十秒】距心綫【一十一萬○○一九】查表均角四度【五十分七秒只差三秒】距心【十一萬○○一三隻差十萬分之單六】可謂宻近丙戊甲三角形求甲角及戊甲邊丙甲爲一四八四○丙戊三七一○其比例爲四與一

簡法其總爲五其較爲三丙角六十度【引數之倍】先求甲角法以丙角減半周得餘外角一百二十度半之六十度查其切綫一七三二○五以較【三】因之總【五】除之得一○三九二三查切綫表得其度爲四十六度六分○八秒爲半較角以半較角減半外角六十度餘一十三度五十三分五十二秒爲丙甲戊角

表說甲角十三度五十四分是不用秒數也

次求戊甲邊

法以甲角之正【二四○二○】爲一率丙戊邊【三七一○】爲二率丙角之正【八六六○三】爲三率求得戊甲邊【一三三七六】爲四率次戊甲丁三角形有甲丁邊【一○○○○○】有先求到戊甲邊【一三三七六】有甲角【以求到戊甲丙角加引數丙乙三十度共得四十三度五十四分弱爲戊甲乙外角餘一百三十六度六分彊爲甲丙角】

先求丁角【卽三十度視差角】

法並【甲丁戊甲】兩邊得總【一一三三七六】爲一率又兩邊相減得較【八六六二四】爲二率半外角得【二十一度五十七分弱】之切綫【四○三○○】爲三率求得半較角切綫【三○七九○】爲四率

查表得角【十七度六分五十秒】以減半外角餘四度【五十分一十秒】卽丁角次求戊丁綫【卽表距日數實卽嵗輪心距地心之數】

法以丁角之正【八四二六】爲一率戊甲邊【一三三七六】爲二率甲角【用余角四十三度五十四分弱】正【六九三三八】爲三率求得戊丁邊【二○○一九○】爲四率

一系凡兩小輪有比例者俱可用簡法求角七政並同一系凡三角形有一角在兩邊中者遇其邊有比例可用簡法土星自行輪半徑八七二一小均圏半徑二九○七其比例爲三與一其總爲四其較爲二總與較之比例爲折半簡法【但以半外角之切綫折半卽得半較角】

木星自行輪半徑七一五五小均圏半徑二八三五其比例亦爲三與一【法同土星】

金星自行輪半徑二四○六小均半徑八○二其比例爲三與一【法同土木】

水星地谷宻測自行輪半徑六八二二小均輪一一三七其比例爲六與一總爲七較爲五法用五因七除多祿某舊法自行輪九四七九小均輪一五八○其比例爲六與一而彊

太陰本輪半徑【八千七百】三平分之二爲新本輪半徑【五千八百】一爲均輪半徑【二千九百】其比例爲二與一其縂爲三其較爲一法用三爲法以除半外角切綫得半較角

朔望次輪半徑二千一百七十舊爲二千三百一十此朔望輪地谷轉用於地心之上

太陰朔望次輪全徑四千三百四十以全加於本輪半徑則一萬三千○四十故兩之加減至七度四十分然以比五星嵗輪則太陰最少

太陽兩心差三五八四折半一七九二

王寅旭法兩心差三八八三八八收作三五八四小均輪半徑爲兩心差四之一第一均輪半徑爲兩心差四之三兩均輪之比例爲三與一其總四其較二亦折半比例也與土木金三星並同

加減差圖說以兩心差折半作角蓋謂此也

兩均輪比例

求七政各小輪半徑法具曆書今只定其大小之比例

兩心差火星最大爲一萬八千五百奇次土星一萬一千六

百奇又次木星○萬九千九百九十又次太陰八千七百又次水星七千八百五十太陽數少三千五百八十四金星更少只三千二百○六

上三星軌迹成繞日圓象

五星本天並以地爲心與日月同至若嵗輪【卽古法遲畱逆伏之叚日】則惟金水二星繞太陽左右而行其嵗輪直以日爲心土木火三星則不然並以本天上平行度爲嵗輪心【金水以太陽爲嵗輪心亦以二星之平行與太陽同度也】然其軌迹所到並於太陽有一定之距故又成繞日左行之圓象西人所立新圖不用九重天而五星並以太陽爲心蓋以此也然金水嵗輪繞日其度右移上三星【土木火】軌迹其度左轉若嵗輪則仍右移耳

七政前均簡法【訂火緯表說因及七政】

西法用表如古法之用立成不得其列表之根表或筆誤無從訂攺矣故有表說以發明之然或表說所用之數有與表中互異者則是作表者一人作表說者又一人也余因查火星之表而爲之推演然後知立表之法甚簡洵乎此心此理不以東海西海而殊

歷算全書卷十七

欽定四庫全書

歷算全書卷十八

宣城梅文鼎撰

七政細艸補注

推日躔法

先查年根【冬至後一日子正距冬至】隨錄本年髙衝【年根子正髙衝】後查日數【本日子正距冬至後一日子正之平行】隨錄髙行【亦本日子正距冬至後一日子正之髙行】髙行加入髙衝書於髙衝格內【卽本日髙衝所在】年根日數相加得平行【卽本日距冬至之平行】平行內減去髙衝爲引數【卽得本日子正距髙衝】以引數查加減表相較【用中比例】得均數隨記加減號均數依號加減於平行卽得細行【人目所見視度】細行內按宮度減宿次卽得本日宿也

鼎按年根者冬至後一日子正之平行也日數者毎日之平行也故相加卽爲本日之平行

邵本云凡算宿鈐以戊辰年爲主毎年加五十一秒所積之秒以六○歸之加於宿鈐之內再與細行相減

髙衝者太陽最卑防距冬至之度毎年東行一分推月離法

先查四年根獨正交行加六宮後查四日數俱年日相加得三平行而正交年日相減爲正交平行書本日太陽細行卽按細行宮度查日差表得數記書加減號按數至時刻平行表內查得日差兩書之依號加減於平行總平行引以平行引查加減表相較【中比例】得均數記加減號均數依號加減於平行總平行引卽爲實行實行引實行內減去太陽度爲月距日次引以月距日次引同實行引宮度查表【二三均數表】相較得次均次均依號加減於實行卽白道經度【邵本云卽白經恆減】以月距日次引查交均記加減號隨查大距數交均依號加減於正交平行卽正交經度正交經度加六宮卽中交置白道經度內減去正交經度卽月距正交以月距正交查白道同升差表得同升差記加減號白道經度與同升差依號相加減爲黃道視行以月距正交與大距數查緯表【卽黃白距度表】得視緯減宿照日躔減法同

邵本云錄本日太陽細行而太陽恆減以太陽恆減查日差表記得數於旁加減號記於月離日差之旁次將所得之數查時刻平行表如查出之數隻分秒耳卽日差以兩平行與日差照號加減得平行總平引

又云以月距日次引查二三均表直行以實行查橫行所遇之處卽得

如月距日次引過六宮減去然後查表

內行宮度順查外行宮度逆查而粗格所在卽加減所分

按楊學山雲月之二三均數以距日而生與五星嵗輪同理但其行法卻異於五星兼有又次輪附於次輪之上與次均相消相長表乃二均三均之總數故與五星次均表絕殊其加減之句亦不以六宮而分○月之交均距限亦以距日而生地谷以前無之也推土木星法

先查兩年根【冬至後一日子正星距冬至及引數】後查正交行再查日數【年根距冬至及引數之下各書日數】兩書之年日相加得平行平引【年根距冬至引數各加日數爲平行與平引卽所求本日子正】以平引查加減表相較【中比例】得均數隨錄中分【加減表中分】記書加減號均數依號加減於平行得實經【嵗輪心所到】卽書本日太陽細行【日躔條求得數】於格太陽內減去實經卽次引【本日星在嵗輪距合伏】以次引查次均隨得較分亦相較【中比例】記書加減號中較相乘六十歸之得三均三均與次均恆加卽定均將定均依次均號加減於實經卽視經【遲畱逆伏之度】減宿照日躔減法同置實經於交行下內減交行卽得距交【所求日星距正交】以距交查中分【緯表內之中分】以次引【卽前所得嵗輪上星距合伏】查緯限中緯相乘六十歸之得視緯定南北以距交宮度定之前六宮【○一二三四五】號北後六宮【六七八九十十一】號南

按學山云五星三均恆用加者以嵗輪心自最髙至最卑次均皆漸大而表所列次均數乃置輪心在最髙時算也

五星加減表中分是從髙卑立算緯度中分是從交防至半交立算乃歷家簡括之法若依三角形算則不用中分矣

推火星法

先查兩年根【距冬至引數】隨錄正交行後查日數【兩年根之下各書日數】兩書之年日相加爲平行平引以平引查加減表相較【中比例】得均數卽書加減號均數依號加減於平行得實行實引隨錄本日太陽細行太陽內減去實行得相距若相距過六宮則於實行內減去太陽得距余減距余之半卽得距余半此系後六宮者若前六宮卽將相距減去一半爲半距無距余半太陽內減去髙衝攺作對衝宮爲日引【加六宮卽是從最髙起】以實引查距日及半徑以日引查日差半徑日差相加得星數【星數卽歳輪半徑】星數與距日【距日卽嵗輪心距地】相加爲總相減爲較以距余半查八綫表卽得半距切綫數與較相乘又以總數除之得數再查八綫表取相近切綫用之卽得減弧半距或距余半內恆減去減弧得次均卽看相距在前六宮者加【嵗輪上從合至衝】後六宮者減【從衝至合】依號加減於實行卽視行宿次照日躔減法同實行內減去正交卽距交以距交查中分以相距【日星相距】查緯限【先定南北】緯有加減分距交在北者依號加減爲定緯限中分緯限相乘六十歸之得緯以距交定南北前六宮是北後六宮是南

按距日半徑俱以實引取之查各式並同天學防通亦同

按前六宮是自合伏至衝日後六宮是自衝日復至合伏皆以嵗輪言

邵本於半距切綫下注雲從距日至再查切綫俱逢十進之

按楊學山云火星半距總較切綫等用是斜三角形有一角二邊求余角之法也五星皆可用惟日差星數火星所獨耳

推金水星法

先查三年根【引數伏見距冬至】後查太陽日數兩書之【卽用爲星平行日數兩書於引數及距冬至下金水距冬至平行卽日躔表數也金水以太陽爲平行之心】再查本星表內日數【此則伏見平行之日數】書於伏見行下年日相加得各平行以引數平行查加減表相較【中比例】得前均卽書加減號隨得中分【加減表中分】前均依號加減於各平行得實經實引獨伏見行下前均加減號反用得伏見實行【反用均數加減伏見平行爲伏見實行】以伏見實行查二均亦相較【中比例】書加減號隨得較分中較相乘六十歸之得三均二均三均恆加卽定均並均依號加減於實經卽視經減宿與日躔法同實引內恆加十六度【金星正交在最髙前十六度】卽得次實引【卽星距正交】以次實引查前中分【前緯表中分】以伏見實行查前緯限中緯相乘六十歸之記書南北號其後中分【後緯表中分】後緯限【亦以距交查後中分】亦照前緯查法同【以伏見實行查後緯限】亦書南北號如前後緯號同者兩緯相加【俱南緯俱北緯則相加】如號異者兩緯相減【一南一北則相減】卽得視緯其南北以數大者定之【若異號相減則以南緯大者命其減余爲南北大者則命爲北】水星照此推法同獨無次實引【水星正交與最髙同度卽以實引爲距交】

金水伏見行卽土木之次引也

土木以星行嵗輪心與太陽相減得次引者是星距日度卽嵗輪上距合伏之度

金水則伏見輪心卽太陽無可相減故另有伏見之行

金水次實引卽土木之距交也

因水星卽用實引數爲距交故金星別之爲次實引然殊亂人目不若直名之距交

邵本查後中分後緯下有云必中緯同在一篇者方可用以便定南北

學山雲金水緯行獨有前後二表者以二星之緯皆由伏見輪而生而伏見輪小於黃道斜交側立旋居於本天之周作表須前後兩表以該之非星緯實有前後之分也

學山雲金水伏見實行與初均加減號相反者以伏見輪心之角斜綫錯列適與初均成相反之勢故反加減之得星合伏眞度非伏見之行與本輪相反勿誤認袁說

推火星諸行假如【甲申年距根一百三十五日】

距冬至平行查【本星】二百恆年表【本年下】距冬至橫行【一十一宮○六度五十三分五十九秒】隨查日數【二宮十度四十五分】日數與年根並之得【一宮十七度三十九分】

引數平行

查恆年表【本年下】引數橫行【三宮七度○五分二十七秒】日數與距冬至同年根日數並之得【五宮十七度五十分】

初均數

以引數平行查【本星】加減表得【二度三十分四十二

秒其號順減書減號於均數之旁】隨錄距日數

距冬至實行以【本星】平行內減去初均數得【一宮一十五度○八

分以均數之號爲加減】

引數實行

以本平行內減去均數之全數得【五宮十五

度十以均數之九分號爲加減】

太陽

卽錄本日日躔細行

相距

以太陽內恆減去距冬至實行得【二宮二十

九度三十五分】

半距

卽以相距半之若相距過半周則借全周內減去相距全分卽爲距余再將其較半之卽距余半也

日引

以本日太陽加六宮減去日躔表內本

年下最髙衝得【十宮八度三十一分】

距日

以引數實行查加減表得【八九三七四○】勿

庵按距日半徑俱宜用實行

半徑

以引數實行查加減表得【六三○七一七】

日差

以日引查之得【○一九一四四】

星數

以半徑恆加日差得【六四九八六一】

總數

以距日內加星數得【一五四三六○一】

較

距日內減去星數得【二四三八七九】

半距切綫

以半距全分查八綫表正切綫得【九九二四

七】

減弧

以較數與半距切綫相乘得【二四二○四二五九一一三】又以總數除之得【一五六八○】以此查正切綫得【八度五十五分】

次均

半距內恆減去減弧得【一宮五度五十二分】

視行

以實行內加次均全分得【二宮二十一度】

正交

查【本星】恆年表【本年下】正交橫行得【四宮十七度十

三分】

距交

以實行內恆減去正交得【八宮二十七度五十】

中分

以距交查首卷本星緯度得【五分六】

緯限

以相距查緯表得【十分一度二十】

視緯

以緯限數化作【九分八十】與中分【九分六】相乘得【十分五千三百四】爲實以六十爲法除之得【十分八十】以六十分成度得【九分一度二十﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十八﹥】

推淩犯法

月犯恆星以本年七政歷與恆星鈐表恆星經度及南北緯度月在上相距二度內取月在下相距一度內取之又以本日與次日之月視行相較化分爲一率日法一千四百四十分爲二率恆星經度內減月經度之較化分爲三率二三相乘一率除之得淩犯時刻

月犯五星以本年七政查月與五星經度及南北緯度月在上相距二度內取月在下一度內取之次以本日之月視行內減次日之月視行取其較又以五星本日經度內減次日經度取其較視星順行者兩較相減逆行者兩較相加化分爲一率日法一千四百四十分爲二率以本日五星經度內減月經度爲月未及星之距化分爲三率求得四率爲淩犯時刻

五星犯五星以本年七政五星經度及南北緯度相距一度內取用五星各以本日經度與次日經度相減得較如俱順俱逆者兩較相減一順一逆者兩較相加化分爲一率日法一千四百四十爲二率又以本日五星經度兩相減之較化分爲三率如法求得四率爲淩犯時刻

五星犯恆星以本年七政與恆星鈐表經度及南北緯度相距一度內取用次以五星本日經度內減次日經度得較度化分爲一率日法一千四百四十爲二率又置恆星經度內減本日五星經度得較度化分爲三率如法求得淩犯時刻爲四率若五星退行者以五星經度內減恆星經度爲三率

月與星一度爲犯十七分以內爲淩同緯爲掩五星與星一度爲犯三分以內爲淩同緯爲掩

視淩犯時刻在地平上者取之若在地平下可勿推算定上下以北爲上南爲下月緯星緯同在北以月緯多者在上少者在下月緯星緯同在南則以月緯多爲在下少爲在上其兩緯相減若星月一南一北則以月南爲在下月北爲在上兩緯相加

推月星淩犯密法

依本年七政歷並恆星鈐視恆星經度及南北緯度月在上二度內取之月在下一度內取之又以恆星經度內減本日之月視行得度化分爲二率以一千四百四十分爲三率本日之月視行相減其較數度分爲一率二三率相乘以一率除之卽得時刻

一求太陽細行以一千四百四十分爲一率次日細

行與本日細行相減得較爲二率淩

犯時化分爲三率二三率相乘一率

除之得四率以四率加於本日細行

得太陽細行

二求時分

以太陽細行查交食四卷內【九十度表】得

時分太陽度過三十分進一度查表

得數卽是

三求總時

以時分及淩犯時刻午後減十二小

時午前加十二小時滿二十四時去

之餘爲總時【卽應時】

四求九十度限以總時查交食四卷表與時分相對

者錄之得九十度限

五求恆星經度置恆星經度

六求限髙度

以九十度減距天頂之度分得限髙

度

七求月實引

置月離內月實引

八求月距地【半徑】以月實引查交食二卷表內得月距

地半徑【邵本作查交食表二卷內視半徑】

九求月實行

以月實引查交食二卷表內得月實

行

十求星距限

九十度限之宮度分內減星之經度

宮度分爲限大則星在西若不及減

置星經度內減九十度限之宮度分

爲限小則星在東

【十一】求置正交【經度】置月離內正交經度

十二求較數

以正交經度內減九十度限宮度若

九十度限不足減則加十二宮減之

卽得較數

十三求眞髙度以較數查交食二卷太陰距度表得

月實緯分北加南減於限髙度得眞

髙度六宮以上定北加以下定南減

十四求地平差以眞髙度並月距地半徑求地平差

【見交食九卷表】

十五求時差

以地平差變爲髙下差【查交食表九卷】及星

距限度求時差

十六求較數

以眞髙度置九十度減之餘爲較數十七求气差

以較數及月距地半徑求气差【交食九卷

表內】月距地半徑查上橫行以較數查

右直行

十八求月實緯以淩犯時刻化分爲三率本日之月

緯度與次日緯度相較得數化分爲

二率與淩犯化分相乘以二十四小

時化分爲一率除之得數加減於本

日緯度視南北號順加逆減卽月實

緯若南北異號以兩數相加爲二率

後除得之數用減本日緯度以次日

之號定南北

十九求視緯

以月實緯度南加北減於气差得視

緯

二十求恆星緯置恆星緯度分

廿一求月距星月視緯北多定上月視緯南多定下

以大減小一度以外不用得月距星

如一南一北兩數相加

【廿二】求淩犯時刻置淩犯時刻

廿三求定時差以月實行分爲一率時差分爲二率

六十分爲三率二三率相乘一率除

之得四率有六十分進一時十五分

進一刻得定時差

廿四求視時

以定時差加減於淩犯時刻卽得淩

犯視時視星距限度西加東減

南北異號【月南在下月北在上兩數相加】

南北同號

同【北南】月緯大在【上下】月緯小在【下上】兩數相減

按凡推月與五星及恆星淩犯用此式較密

攷節气法【用變時表依法查之更密】

凡半月一節气遇細行一十四度與二十九度卽是交節气之日次日細行與本日細行相減減余化秒爲一率置六十分以本日細行分秒減之減余化秒爲二率化二十四小時爲一千四百四十爲三率二三率相乘以一率除之得數卽四率其分秒用六歸之收作時刻分查節气日差加減表【在日躔二卷內凡六十分爲一小時若過半分作一分用】一百二十分爲一大時十五分爲一刻如不滿一刻作分算時自子正起算

二十九度與次宮○度相較爲气

十四度與十五度相較爲節

查二至限法

以二至度爲主加以本日太陽經度未滿宮度之餘分卽是二至限如冬至日經度爲二十九度二十五分【卽此廿五分爲未滿之餘分也】而本至宿爲箕三度三十五分加二十五分則爲冬至限在箕四度

假如五月初十日太陽在申宮二十九度二十三分宿在觜十度十二分

問曰夏至限系何宿度分答曰觜宿十度四十九分

假如十一月二十日太陽在寅宮二十九度十五分宿在箕二度五十六分

問曰冬至限系何宿度分答曰箕宿三度四十一分

假如正月十四日太陽在子宮十四度二十一分八秒十五日太陽在子宮十五度二十二分三秒

問曰立春系何時刻答曰申初初刻十分

假如二十九日太陽在子宮二十九度三十一分二十五秒

三十日太陽在亥宮初度三十一分十四秒

問曰雨水系何時刻答曰午初一刻六分

定合朔望法

合朔以月距日次引滿十一宮二十餘度此日卽合朔也滿十二宮卽○宮是合朔之次日也

求合朔時刻【凡星同度法同】

以本日太陽與次日太陽相減得較數另記又以本日之月視行與次日之月視行相減得較仍以兩較數相減得數化分爲一率以一千四百四十爲二率又置本日太陽減去本日之月視行得數卽月不及日之度爲三率二三相乘一率除之得數再以六十分收之爲時余以十五分收爲刻卽得時刻及分

假如正月初一日太【陽陰】在子宮【十四度十五分二十秒十度二十三分十二秒】初二日太【陽陰】在子宮【十五度十四分六秒二十三度三十分三十一秒】問曰合朔系何時刻答曰辰初二刻八分

相望亦以次引滿五宮二十度之上將近六宮卽是望也到六宮卽望之次日也

求望時刻

以本日與次日太陽之較及月視行之較相減化分爲一率以一千四百四十爲二率又置本日之月視行內減去本日太陽其餘宮度分上輳滿三宮望輳滿六宮下輳滿九宮將輳滿之數化分爲三率二三相乘一率除之得數再以六十收之爲時刻分

假如十六日太【陽陰】在【戌辰】宮【十五度十六分九秒六度三十分二十一秒】十七日太【陽陰】在【戌辰】宮【十六度十五分十六秒十八度二十九分三十五秒】問曰望系何時刻答曰戌初初刻七分

上以次引二宮二十餘度將近三宮卽上也若滿三宮卽爲上之次日也

假如初八日太【陽陰】在【亥申】宮【八度三十四分八秒七度五十八分四十秒】初九日太【陽陰】在【亥申】宮【七度三十四分二十秒二十度五十五分十六秒】問曰上系何時刻答曰丑初初刻十分

下以次引八宮二十餘度將近九宮卽是下也若九宮一二度卽下之次日也

假如二十三日太【陽陰】在【酉子】宮【二十一度十一分二十秒十一度三十三分六秒】二十四日太【陽陰】在【酉子】宮【二十二度八分十六秒二十五度二十八分三十秒】問曰下系何時刻答曰酉初三刻四分

求月入宮法

以次日宮度分內減去本日宮度分余度分化分爲一率本日未滿整宮之餘度分亦化分爲二率一千四百四十爲三率二三率相乘一率除之卽得時刻

假如正月初七日太陰在戌宮十八度三十一分初八日太陰在酉宮一度二十四分

問曰月入宮系何時刻答曰亥初一刻八分入酉宮

求月升法

以朔日之月離宮度定之

子宮十五度至酉宮十五度爲正升

酉宮十五度至未宮初度爲斜升

未宮初度至寅宮十五度爲橫升

寅宮十五度至子宮十五度爲斜升

假如正月初一日月在丑宮十八度四十六分

問曰月系何升

答曰系斜升

求月孛羅計法

以本年所推月離稿內毎月初一十一二十一三日月孛實行正交經度中交經度內減本年宿余減宿卽得三宿分

假如正月初一日月孛實行在己宮八度四十四分本年宿鈐在己宮一度八分爲張宿

問曰月孛系何宿度分答曰張宿七度三十六分求五星伏見

土木火三星與太陽合伏后爲晨見合伏前俱稱夕與太陽衝後爲夕見衝前爲晨【蓋星行遲太陽行速故也】

金水二星順行與太陽合伏曰夕逆行合伏曰晨假如土星四月十九日合伏

問曰土星合伏前後應晨應夕見與不見

答曰合伏前系夕不見合伏后系晨見

假如水星五月十二日與太陽衝

問曰太陽衝前衝後應晨夕見與不見

答曰衝前系夕不見衝後卽晨見【按水星不衝日今云爾者蓋退合亦衝之屬也當云退合伏前系夕不見退合伏后卽晨見】

求五星衝伏同度時刻法

兩星各以次日行與本日行相減得較兩較相加減爲一率同順同逆兩較相減一順一逆兩較相加一千四百四十爲三率二三率相乘以一率除之得時刻

假如正月十八日【土水】星在子宮【二十六度四十九分二十六度三十三分】十九日【土水】星在子宮【二十六度五十六分二十八度一十七分】

問曰【土水】二星系何時同度答曰寅初三刻十二分

假如正月二十五日【太陽水星】在亥宮【二十八度三十分二十八度四十二分】二十六日【太陽水星】在亥宮【二十九度三十分二十七度四十二分】

問曰水星系何時與太陽合退伏答曰醜正一刻九分

假如二十日【太陽土星】在【丑未】宮【三度二十六分四度十分】

二十一日【太陽土星】在【丑未】宮【四度二十四分四度六分】

問曰土星系何時與太陽衝答曰酉初初刻一分

假如二十八日【太陽木星】在子宮【二十七度三十分二十七度五十五分】二十九日【太陽木星】在子宮【二十八度三十分二十八度二分】

問曰木星系何時與太陽合伏答曰午初一刻四分

求五星退入宮法

本日度分內減去次日度分其較爲一率本日余分爲二率【度以上不算止用余分】一千四百四十爲三率二三率相乘以一率除之得時刻

假如二十六日金星在戌宮初度三十二分

二十七日金星在亥宮二十九度三十八分

問曰金星系何時退入某宮答曰未正初刻十三分退入亥宮

求五星順入宮法

以次日宮度分內減去本日宮度分余度分化分爲一率諸法俱與月入宮法同【如退入宮者則於本日宮度分內減去次日宮度分得數化分爲一率以日法爲二率卽以本日初度分爲三率依法求之】

假如正月初三日水星在丑宮二十九度四十六分初四日水星在子宮一度三十五分

問曰水星系何時刻入某宮答曰寅初初刻四分入子宮

求五星最髙卑中距法

凡三宮九宮爲中距○宮爲最卑六宮爲最髙火金水三星以實引次實引查土木星以平引查假如土星平引在四宮八度二十分

問曰從何限之上下行答曰中距下行

求五星畱逆法

凡五星經度自一度二度而行者爲順如從十五度十四度而行者爲逆本日系十度五分次日仍十度五分者爲畱第三日系十度六分爲畱順初如系十度四分三分爲畱退初

求五星伏見法

以天球安定北極出地如四十度求晨在東地平上用本日太陽距星之數求夕在西地平上用次日太陽距星之數以太陽所在之宮挨地平又看此日之星宮度相距太陽之逺近又用缺規矩較星距太陽之定限如土星定限距太陽十一度木星定限距太陽十度火星定限距太陽十一度半金星定限距太陽五度水星定限距太陽十一度半以缺規矩較定之限挨地平視星所在之宮度及緯南緯北之度視﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十八﹥

歷算全書卷十八﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

欽定四庫全書

歷算全書卷十九

宣城梅文鼎撰

揆日候星紀要

求日影法

謹按測日之法要先知太陽緯度其次要知裏差其次要知句股算法其次又要知割圓八綫

太陽緯度有半年在赤道南有半年在赤道北此以節气定之假如冬至日太陽在赤道南二十三度半爲緯度之極南其影極長自此以後太陽漸漸自南而北其南邊緯度漸減則影之長者亦漸減至春分日太陽行到赤道上卽無緯度

旣過春分太陽行過赤道之北於是漸生北緯緯旣漸北其影漸短至夏至之日而影短極矣

夏至日太陽在赤道北二十三度半爲緯度之極北其影極短自此以後太陽漸漸自北而南則北邊緯度漸減而影之短者復漸長至秋分日太陽行到赤道上亦無緯度

旣過秋分太陽行過赤道之南於是漸生南緯緯旣漸南影亦漸增至於冬至之度而復爲影長之極矣長極則短短極則長總由太陽南北緯度之所生其緯日日不同故影之長短亦日日不同也

凡防表上層節气順數而下自初日至十五日止下層節气逆數而上亦自初日至十五日止或論日或論度防有不同然所差不逺

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十九﹥

查表法

第一表是太陽在赤道南所紀度分是南緯日日不同之數管冬至小寒大寒立春雨水驚蟄【其日期自上而下順推】又管秋分寒露霜降立冬小雪大雪【其日期自下而上逆推】凡順推日期者看右行順下之數逆推日期者看左行逆上之數

第二表是太陽在赤道北所紀度分是北緯日日不同之數管春分淸明谷雨立夏小滿芒種【日期順推看右行】又管夏至小暑大暑立秋處暑白露【日期逆推看左行】

凡查緯度看本日是何節气則知太陽在赤道南或在其北

又看是節气之第幾日依表順逆查之卽知太陽在赤道南北相離幾何度分

假如辛未年四月初一日是在谷雨節內檢表便知在赤道北又查交過谷雨已有八日便於谷雨節之下從上順數而下對右行八字之格內【系第九格】尋其緯度是【十四度十三分】便是此日太陽距赤道北緯之數也

又法不用算日期只於本年七政歷尋本日太陽所到宮度加三十分卽是假如四月初一日七政歷內太陽是酉宮七度三十六分此是夜半子時度數加三十分得八度○六分便是本日午正太陽躔度也以午正太陽入酉宮八度○六分從本表中谷雨節一行內從上順數而下到橫對右行順下第八號之格是十四度一十三分便是此日此時太陽離赤道北之緯度也以上論太陽緯度

旣知緯度則日影長短之緣已得之矣然又要知裏差何也緯度不同是天上事乃萬國九州所同然而人所居有南北故所見太陽之髙下各異則其影亦異前所論緯度髙下是毎日不同今論裏差則𨿽同此一日而北方日影與南方不同若不知此則誤矣

裏差南北論本地北極出地

卽如四月初一日午正推得太陽在地平上髙六十四度此據京師地勢言之若在別省則其度不同何也北極之出地不同也後圖明之

右圖舉浙江爲例其他處各各不同可以類推

北極出地度開後

京師四十度

山東三十七度陜西三十六度盛京四十二度山西三十八度河南三十五度江南三十二度浙江三十度

福建二十六度湖廣三十一度【江西四川】俱廿九度廣西二十五度貴州二十四度廣東二十三度雲南二十二度求赤道髙法

各以其地北極出地度減九十度余爲赤道髙度觀前圖自明

以上論裏差

旣知太陽緯度又知本地裏差則任舉一日可知太陽午正之髙度而測影不難矣

然又要知句股算法及割圓八綫

凡測影有二法一是用直表而取平地之影【又名直影】一是用橫表而取壁上之影【又名倒影】

此兩者皆是句股形

直表取影是一个正句股形

古人用八尺表取影只用直表直影故前所論者亦直影也

凡此句股之法生於割圎八綫

何以謂之割圓周天三百六十度今取其若干度而算之是將渾淪圓形剖開算之故曰割圓也

割圓有八種綫俱是算句股之法今取日影則所用者切綫也切綫有正有餘此因直表取影故所用者又是余切綫也

凡測影者先以緯度及裏差得太陽髙度卽用所得髙度入八綫中查本度之餘切卽得所求直影

假如前推四月初一日太陽髙六十四度一十四分卽於八綫表中尋六十四度十四分之餘切綫便是所得直影

八綫表在曆書中其查法毎度六十分自四十五度以前自上而下四十五度以後至九十度自下而上【其順下逆上俱自一分起至六十分止俱要看表旁之分號對而取之】

甲乙爲半徑

【爲股】以當表丙

乙爲余切綫

【爲句】以當影甲

丙爲日光斜



太陽在已光

射於表端之

甲直至於丙成甲乙丙句股形

其己庚髙度與戊丁相對之度等用戊丁卽如用己庚也

以戊丁爲主則丁乙爲余度而丙乙者卽戊丁髙度之餘切綫也

查八綫表法

先查某度再查某綫再查某分以橫直相遇處取之

其度數有寫在髙處者【自○度起至四十四度止】有寫在下面者【自四十五度起至九十度止】

其八綫之號有寫在上一層者有寫在下一層者其分數有自上而下者有自下而上者此無他故也只看度數寫在髙處者其八綫之號【如正切等】亦卽寫在上一層而其分數亦自上而下也若度數寫在下面者其八綫之號亦卽寫在下一層而其分數亦自下而上也【凡一度俱有兩張一張自○分至三十分一張自三十分至六十分】

假如前推太陽髙六十四度便知此度數寫在下靣卽於表中尋下面左角上寫有六四字樣者此則六十四度之表也度旣寫在下便從下一層橫看八綫之號至余切字樣處認定此卽六十四度余切之行也又因度下有一十四分便向表中原寫六四字樣處接了便是○分自此逆上一分二分以至十四分止是所用之橫格也依此十四分之號橫看至余切之行其中所書便是六十四度十四分之餘切綫數矣他仿此【若依前加太陽十五分便尋三十分之號如法求之】

又式

康熈辛未七月初四日丁亥測正午時日影京師立表

前月二十八日壬午夘時交大暑節

本日子正太陽度鬼宿三度七分爲六宮四度三十三分

午正太陽度鬼宿三度三十六分爲六宮五度○二分黃緯十九度○五分在北

京師赤道髙五十度午正太陽髙度六十九度○五分

余切綫○三八三八六

立八尺表正午日影該三尺○七分

凡立表須正取影之地須平又須正對子午

又按此直表也故當以太陽半徑加髙度而取直影【用余切】

若橫表卽當以太陽半徑減髙度而取倒影【用正切】此測影中最精之理不可不知

皖城北極髙

三十一度

赤道髙五十

九度立表

八尺冬至

日在赤道外

二十三度三

十一分半

午正太陽髙三十五度二十八分半余切綫一四○○六五直影宜加太陽半徑十五分奇共髙三十五度四十四分其餘切綫一三八九九四以表數八尺乘余切綫得影長一丈一尺一寸二分若求倒影宜減太陽半徑十五分奇得髙三十五度一十三分

四省表影立成

四省表影立成者爲友人馬徳稱氏作也徳稱系本西域逺祖瑪沙伊克瑪哈齊兩編修公以善治歷見知洪武朝受敕譯西書其文禦制稱爲不朽之智人欽天監特寘專科肄習子孫世其官皆精其業西域之言歷者宗焉西域之歷有二一曰動的月以望晦朔爲序乃太陰曆也故齋期以見月爲滿一曰不動的月以二十四定气爲端乃太陽曆也故禮拜以晷景爲憑然此二者皆有裏差而今回回家所傳二十四節气表景尺度共祗一術故徳稱氏疑焉謂其不足以盡諸省直之用而欲有以是正之以屬余余旣稔知西域之以天爲教以歷爲學經數百年能守其舊俗不變可謂有恆而徳稱氏又能不牽於習見踵事加詳以致其恪恭鄭重之意深爲可敬遂力疾爲之布算以歸之夫歷學至今日明且確矣而泰西氏之法大綱多出於回回竊意如各省直裏差之說必西域所自有或當時存而未譯或譯之而未傳或傳之久而殘缺皆未可知吾願徳稱氏與其西域之耆舊尙爲之詳徵焉而出以告世庶有以證吾之說而釋夫傳者之疑以正其疎也

四省直節气定日表影考定

立表十尺【若表短則用折算假如用表一尺則以尺爲寸寸爲分分爲釐皆折取十分之一若表八尺則尺取八寸爲十之八】

右表影皆以直省城內爲準附近二百里內外可用其餘州縣各各不同須以彼處北極髙度定之

一凡立表須直不得稍偏於東西南北則影爲之變須以綫垂而準之古所謂八綫附臬者是也

一植表取影之地須極平如砥若防有髙下陂陀坑坎垤則影不應矣當以水準之

一量表量影之尺度須極勻極細

一取正午之影須在正南然天上正南非羅鍼所指之正南也須於羅鍼正午之西稍偏取之或曰丙午之間縫鍼與臬影合亦非也蓋鍼所指在在不同如金陵則偏三度此非正方案則不能定或以曆書法用北極附近星取之

以上四事皆求表影者所當知

此外又有節气加時在午前午後之不同則影亦爲之加減

假如冬至影極長而冬至不在正午或午前或午後則其午影必防差而短

又如夏至影極短而夏至不在正午或午前或午後則其午影必微長

又如小寒至芒種十一气影自長而短若其加時在午前則午影必防短加時在午後則午影必微長

又如小暑至大雪十一气影自短而長若其加時在午前則午影必防長加時在午後則午影必防短按以上加減只在分釐若所用徑尺之表初無損益可無深論也惟春秋分及前後兩節晷差頗速若其加時又在亥子之間則距午甚逺爲差益大不可不知

午正太陽髙九十度已至天頂則日中無影其過此者皆在天頂之北而生南影法當以所帶零度轉減九十度而用其餘命爲太陽在天頂北之髙度

北極出地二十度則赤道在天頂南二十度而夏至日躔在赤道北二十三度半故其日午時已過天頂北三度而影在表南

芒種日午正亦過天頂北二度奇影亦在南

凡午影芒種必髙於小滿夏至又髙於芒種今皆反之亦此故也

自北極髙二十三度以前仿此論之

宜邑謝野臣至中州尋古測景之臺所立石表尙存其形似墖上小下大夏至日中無影蓋其根盤半徑卽日景所到如句髙尖距地之數爲表如股亦表八尺土圭尺有五寸之比例也以此推之則向南州邑並可作夏至無影之石表

論恆星

中星定時

中星之法肇於堯典羲和分職測日之後繼以中星蓋中星所以覘四時驗寒暑定昏旦考節气察日度辧裏差其用甚鉅故與測日均爲治歷之大端也第星之麗天左旋之勢則依赤道自行之度則向黃道因此星之經緯度自二道望之參差不齊法以黃赤二道之極爲宗出弧綫過星體用弧三角法可推各星之經緯度在古歷未覺有恆星之行【中法謂之歳差不言星行】西用大儀累年密測知恆星亦依黃道毎嵗東行五十一秒其距黃道有定度若赤道因黃道斜絡之勢度分多變動不居因普測周天有名位之星算其二道之經緯度列表今推中星祗用赤道度以時刻憑赤道爲主故也法以星赤道度與本日太陽赤道度相離之數變時得星昏旦中之時刻取用星座除二十八舎外止用三等以上之星餘光體茫昧者可勿論也

推中星求時法

先查本年七政歷太陽宮度分至儀象志八卷內變爲赤道度分次查所出之星在十二三卷內系若干度分將星之度分減去太陽所變之度分如不足減數加三百六十度減之所餘之度分移至儀象志第五卷

之變時表內變爲時刻分從未初起算至所得時刻卽所求之時也

推時求中星法

先查本年七政歷太陽宮度分至第八卷

儀象志內變爲赤道度分次查所出之時刻從未初起算得幾時刻移至第五卷

變時表內變爲赤道經度分時之度分加於太陽之度分若滿過三百六十度則去之所餘之度分至十二三卷內比例相近度分之大星宿卽所求之星宿也【星宿之度分不及則偏西有餘則偏東】

諸名星赤道經緯度加減表

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十九﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十九﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十九﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十九﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十九﹥

二十八宿距星黃赤二道經緯度

二十八宿距星赤道經緯度【自春分起算】壬子年度

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十九﹥

二十八宿距星黃道經緯度壬子年度

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十九﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十九﹥

二十八宿黃道積度

康熈戊辰年各宿距星所入各宮度分【黃道經度】

以上戊辰年經度視儀象志又各加一十四分惟鬥牛二宿加十五分

紀星數

大西儒測算凡可見可狀之星一千二十二若防小者或不常見者或朦黒者不與焉其大小分爲六等又因其難以識認盡假取人物之像以別其名【星非眞有象也但人借名之耳】毎合數星以成一像凡四十八像其多寡大小不等在黃道北者二十一像第一曰小熊內有七星外有一星二曰大熊內二十七外八三曰龍凡三十一星四曰黃帝內十一外二五曰守熊人內二十二外一六曰北冕旒凡八星七曰熊人內二十九外一八曰琵琶凡十星九曰鴈鵞內二十二外一其十曰嶽母凡十三星十一曰大將內二十六外三十二曰禦車凡十四星十三曰醫生又曰逐蛇【一醫常取蛇合藥以救世其星如人逐蛇狀】內二十四外五十四曰毒蛇凡十八星十五曰箭凡五星十六曰日鳥【性喜視日】內九外六十七曰魚將軍【性好人聞人歌樂卽來聽呼其名漸來就人溺水則載之岸邊人取魚彼卽領眾魚至呼之彼先躍過眾魚則罹网矣】凡十星十八曰駒凡四星十九曰飛馬凡二十星二十曰公主凡二十四星二十一曰三角形凡四星共在北者三百六十星一等三二等十八三等八十四四等一百七十四五等五十八六等十三昏者十在黃道中者【按節气】十二象【卽十二宮】一曰白羊卽春分淸明內十三外五二曰金牛卽谷雨立夏內三十三外十一三曰雙兄卽小滿芒種內十八外七四曰巨蟹卽夏至小暑內九外四五曰獅子卽大暑立秋內二十七外八六曰室女卽處暑白露內二十六外六七曰天秤卽秋分寒露內八外九八曰天蠍卽霜降立冬內十一外三九曰人馬卽小雪大雪凡三十一星十曰磨羯【羊頭魚尾】卽冬至小寒凡二十八星十一曰寶瓶卽大寒立春內四十二外三十二曰雙魚卽雨水驚蟄內三十四外四共在中者三百四十六星一等五二等九三等六十四四等一百三十四五等一百○六六等二十九昏者三在黃道南者十五像一曰海獸凡二十二星二曰獵戶凡三十八星三曰天河凡三十四星四曰天兔凡十二星五曰大犬內十八外十一六曰小犬凡二星七曰船凡四十五星八曰水蛇內二十五外二九曰酒缾凡七星十曰烏雅凡七星十一曰半人牛凡三十七星十二曰豺狼凡十九星十三曰大臺凡七星十四曰南冕凡十三星十五曰南魚內十二外六共在南者三百十六星一等七二等十八三等六十四等一百六十八五等五十三六等九昏者一三方共一千二十二星分其大小一等共十五二等共四十五三等共二百○八四等共四百七十四五等共二百十七六等共四十九昏者共十四

新增一十二像【系近南極之星】

火鳥十水委三蛇首蛇腹蛇尾十五小斗七飛魚七南船五海山六十字架四馬尾三馬腹三蜜蜂四三角形三海石五金魚四夾白二附白一異雀十孔雀十波斯十一鳥喙六鶴十二共一百三十四星

據西書言彼地天文家原載可見之星分爲四十八像後自治十年丁巳有精於天文吳黙哥者行至極南見有無名多星復有西士安徳肋者亦見諸星之旁尙有白气二塊如天漢者嗣於萬曆十八年庚寅有西士胡本篤始測定南極各星經緯度數新增一十二像至萬曆四十八年庚申湯羅兩公航海過赤道南三月有奇見南極已髙三十餘度將前星一一對測經緯皆符但據云一十二像今又有二十一名何耶

地谷測定經緯之星數

歷法西傳曰地谷著書第四卷

取六星之距度以經度相並適合周天之全度求角宿經緯度以起周天之度再求近赤道十二星經緯度證星之黃道緯度今古不同求星之經度並解其時八百餘星之眞經緯度【五十三年前】復加百餘星赤道經緯度說

按地谷實測過者只有八百星則其餘非地谷測也新法曆書星數

歷引曰恆星爲數甚多莫能窮盡其間有光渺體防非目可及非儀可推者則略而不錄其在等第之內已經新法所測定者南北兩極共得一千七百二十五星又曰星以大小分爲六等第一等大星如五帝座織女類者一十七次二等如帝星開陽類者五十七次三等如太子少衞類者一百八十五次四等如上將柱史類者三百八十九次五等如上相虎賁類者三百二十三次六等如天皇大帝後宮類者二百九十五是皆有名之星共爲一千二百六十六餘則皆爲無名之星矣西又分爲六十二像各命之以名以期便於識別又曰西古歷亦有二十八舎義與中古相侔其所定二十八距星亦皆脗合第觜宿距星西用天闗耳

此二十八宿者各以一字命名分注毎日之下內以房虛星昴爲屬太陽之日心尾畢張爲屬太陰之日是外五緯各屬四宿毎以七日爲期毎日各屬一宿西曆亦然義理皆符西經相傳上古有大師名諾厄者所通於天下萬國云

按天經或問恆星多寡條與此同但總數作一千一百六十六則總撒符矣湯道未刪定歷引數同但總數百字上缺畫不明今查經緯表三等星有二百○七除海石等七星仍有二百則云八十五者非矣

恆星歷指曰自古掌天星者大都以可見可測之星求其形似聨合而爲象命之名以爲識別是有三垣二十八宿三百座一千四百六十一有名之星世所傳巫咸石申甘徳之書是也西曆依黃道分十二宮其南北又三十七像亦以能見能測之星聨合成之共得一千七百二十五其第一等大星一十七次二等五十七次三等一百八十五次四等三百八十九次五等三百二十三次六等二百九十五蓋有名者一千二百六十六按此星數與歷引同惟三等星多一百然以總數合之此爲是

星屏赤道南北兩總星圖說曰舊傳三垣二十八宿共三百座一千四百六十一有名之星如世傳巫咸丹元子之書之類然細測有在疑似者今則非實測不圖舊圖未載而測有經緯亦增入焉南極旁星向來無象無名因以原名翻譯共得星一千八百一十二第一等一十六第二等六十七第三等二百一十六第四等五百二十二第五等四百一十九第六等七十二

按此星數細數少五百總數多五百

恆星經緯表舊本一等星十七二等六十八三等二百○九四等五百一十二五等三百四十六等二百一十六共一千三百六十二外有傅說積屍气等不入等之星共七然今刻表又有不同

天學防通星數

論各星大小一等十五星二等四十五星三等二百八十星四等四百七十四星五等二百一十六星六等五十星共一千二十九星

按此數合總該一千○八十總撒不符必有誤也薛書若此類頗多

查表一等大星畢參二五車狼老人星軒轅五帝座角大角心南門織女北落師門共十五與此合其水委不在此內

又查表三等並新增海石等共二百○七則十字衍可知

又查表二等星五十又新增海石等十七共六十七與此及歷引歷指俱不同

天文實用星數

恆星總像例條曰中歷分垣分宿計二百八十座見界諸星盡矣西國於此見界諸星約以四十八像別如近南極諸星都爲六十像驗時依像推效各異古歷家詳察星之形星之性與某物合因以毎物像之

白羊宮起降婁二十八度止大梁一十八度金牛宮起大梁一十九度止實沈二十五度雙兄宮起實沈二十六度止鶉首二十四度巨蟹宮起鶉首二十四度止鶉火一十二度獅子宮起鶉火一十三度止鶉尾一十六度室女宮起鶉尾一十六度止大火六

度天秤宮起大火六

度止大火二十六度天蠍宮起大火二十七度止析木二十五度人馬宮起析木二十六度止星紀二十八度磨羯宮起星紀二十八度止枵二十二度寶瓶宮起枵二十三度止娵訾一十五度雙魚宮起娵訾一十五度止降婁二十七度

漢志星數

漢書天文志曰凡天文在圖籍昭昭可知者經星常宿中外官凡百一十八名積數七百八十三

晉志星數

晉書天文志曰馬績雲天文在圖籍昭昭可知者經星常宿中外官凡一百一十八名積數七百八十三皆有州國官宮物類之象張衡云文曜麗乎天其動者有七日月五星是也日者陽精之宗月者陰精之宗五星五行之精眾星列布體生於地精成於天列居錯峙各有攸屬在野象物在朝象官在人像神其以神差有五列焉是爲三十五名一居中央謂之北斗四布於方各七爲二十八捨日月運行歷示吉凶五緯躔次用告禍福中外之官常明者百有二十四可名者三百二十爲星二千五百微星之數蓋萬有一千五百二十庶物蠢蠢咸得系命不然何得總而理諸後武帝時太史令陳卓總甘石巫咸三家所著星圖大凡二百八十三官一千四百六十四星以爲定紀

隋志星數

隋天文志又列目曰經星中官乃另起敍星自北極五星起北斗輔星三公止又另起自文昌六星起至少微長垣止太防天市二垣俱雜敍其中是爲天文上卷次捲天文中列目曰二十八捨乃另起敍星自東方角二星起又北方南斗六星西方奎十六星南方東井八星各另起而於後低三字總結之曰右四方二十八宿並輔官一百八十二星又列目曰星官在列宿之外者乃另起敍星自庫樓十星起靑丘土司空軍門止仍低三字總結之曰自攝提至此大凡二百五十四官一千二百八十三星並二十八宿輔官名曰經星常宿逺近有度大小有差茍或失常實表災異

隋天文志曰後漢張衡爲太史令鑄渾天儀總序經星謂之靈憲其大略曰中外之官常明者百有二十可名者三百二十爲星二千五百微星之數萬有一千五百二十庶物蠢動咸得系命而衡所鑄之圖遭亂湮滅星官名數今亦不存三國時吳太史令陳卓始列甘氏石氏巫咸三家星官著於圖錄並注占贊總有二百五十四官一千二百八十三星並二十八宿及輔官附坐一百八十二星總二百八十三官一千五百六十五星宋元嘉中太史令錢樂之所鑄渾天銅儀以朱黒白三色用殊三家而合陳卓之數髙祖平陳得善天官者周墳並宋氏渾儀之器乃命庾季才等參挍周齊梁陳及祖暅孫僧化官私舊圖刋其大小正彼疏密依準三家星位以爲蓋圖以墳爲太史令自此太史觀生始能識天官

客星說【附】

歷法西傳曰地谷書第五卷

解其時新見大客星計十二章一詳初起及漸大至與金星等並漸減二取某宮星以定其經緯度三解測新星所用諸器四取新星與他星距度五解其更度幾何六用各法以求新星經緯度七求新星赤道經緯度八證新星不麗空際而麗列宿天九攷新星之大小十取新星之似徑得三分三十秒十一證新星大倍於日大於地三百六十倍十二攷眾星參差

彗星解【附】

歷法西傳又載地谷彗星十卷測彗星之髙度尾之長短光之隱顯及其方向攷十二星在黃道上度以求彗星之眞所在設彗星離兩星之度求黃赤道經緯度求彗星毎日赤道經緯度求彗星所行之道及其道交黃赤之角處依毎日彗星行黃赤二道作立成表證彗星在月上較月更逺於地爲三百地半徑故知彗星在日月二天之中證其尾恆向日與金星作彗星行度圖徴彗星之大爲月二之一尾長爲九十六地半徑因攷前人彗星之論當否

極星攷

隋書紐星去不動處一度余

隋天文志曰北極五星皆在紫宮中北極辰也其紐星天之樞也天運無窮三光疊耀而極星不移故曰居其所而眾星共之賈逵張衡蔡邕王蕃陸績皆以北極紐星爲樞是不動處也祖暅以儀準候不動處在紐星之末猶一度有餘

宋時極星去不動處三度余

宋時天文志載沈括於熙寧七年七月上渾儀浮漏景表三議其渾儀議內一則云前世皆以極星爲天中自祖衡以璣衡窺攷天極不動處乃相極星之末猶一度有餘今銅儀天樞內徑一度有半乃謬以衡端之度爲率若璣衡端平則極星常遊天樞之外璣衡小偏則極星乍出乍入令瓚舊法天樞乃徑二度有半蓋欲使極星遊於樞中也臣攷驗極星更三月而後知天中不動處逺極星乃三度有餘則祖恆窺攷猶未爲審今當爲天樞徑七度使人目切南樞望之星正循北極樞裏周常見不隱天體方正【按祖衡祖恆並誤當作祖暅乃衝之子】

按古法自渾儀之南窺渾儀之北皆用衡管則必過心所得之度數亦眞惟此候極之樞似有未確何以言之南樞旣亦徑七度則人目可中可邊致有遊移若南樞窄小令目常在樞心則目光射星不過儀心而悉成斜望矣且以圓理徵之人目窺處卽圓心爲起度之根而北極之度變七度爲三度有半矣故不如元極儀之確元候極儀亦徑七度然設於簡儀是從心窺周其度眞確

又嘗疑西術言極星亦東行而祖暅時離不動處一度沈括時遽離三度奇可謂速矣而至郭太史時仍三度奇何以又遲今以其儀器攷之則宋時離不動處正在二度左右耳

祖氏所用儀器恐亦是自南周用目以窺北周則𨿽云離一度有餘若其眞度恐未及一度

宋史誌極度條又言北極爲天之正中而自唐以來歷家以儀象攷測則中國南北極之正實去極星之北一度有半此蓋中原地勢之度數也中興更造渾儀而太史令丁師仁乃言臨安府地勢向南於北極髙下當量行移易局官呂璨言渾天無量行移易之制若用於臨安與天參合移之他往必有差忒遂罷議後十餘年邵諤鑄儀果用臨安北極髙下爲之以淸臺儀挍之實去極星四度有奇也

又敍中外官星言北極五星在紫防宮中北辰最尊者也其紐星爲天樞天樞在天心四方去極各九十一度賈逵張衡蔡邕王蕃陸績皆以北極紐星之樞是不動處在紐星末猶一度有餘今淸臺則去極四度半按此兩條誤以北極出地之髙下差爲極星去不動處之距度作史者之疎乃如此愚前一條言用目自心窺周爲測圓正法足證郭太史簡儀之妙然自昔無人見及其理甚微無怪其然也若後兩條之辧茍稍知歷法者宜知之柰何史家瞶瞶也

王良閣道攷

隋天文志曰天良五星在奎北居河中天子奉車禦官也其四星曰天駟旁一星曰王良亦曰天馬其星動爲策馬車騎滿野亦曰王梁梁爲天橋主禦風雨水道故或占津梁其星移有兵亦曰馬病客星守之橋不通前一星曰策王良之禦策也主天子僕在王良旁若移在馬后是爲策馬則車騎滿野閣道六星在王良前飛道也從紫宮至河神所乘也一曰閣道主道裏天子遊別宮之道也亦曰閣道所以扞難滅咎也一曰王良旗一曰紫宮旗亦所以爲旌表而不欲其動揺旗星者兵所用也傅路一星在閣道南旁別道也備閣道之敗復而乘之也一曰太僕主禦風雨亦遊從之義也

晉志並同隋但亦曰王良作亦曰梁若移在馬后作若移在王良前居馬后

前漢天文志曰紫宮左右星曰天槍右四星曰天棓後十七星絕漢抵營室曰閣道又曰營室爲淸廟曰離宮閣道漢中四星曰天駟旁一星曰王梁王梁策馬車騎滿野旁有八星絕漢曰天橫天橫旁江星江星動則人涉水史記天官書曰紫宮左三星曰天槍右五星曰天棓後六星絕漢抵營室曰閣道又曰營室爲淸廟曰離宮閣道漢中四星曰天駟旁一星曰王良王良策馬車騎滿野旁有八星絕漢曰天潢天潢旁江星江星動人涉水又宋均雲天潢天津也津湊也主計度也○正義曰天江四星在尾北主太陰也不欲明明而動水暴出其星明大水不禁也宋史天文志並同

鼎按史記本云閣道六星而漢書更其文曰十七星不知何據今曆書圖閣道爲十餘星其本諸此歟

三十雜星攷

回回曆書有三十雜星錢塘袁惠子攷其經緯系以中法星名但所攷尙缺第三第四第五第十三第十四第廿四第廿五第廿九壬申秋晤於京師則皆補完余問其何本則皆自揣摩而得非三和授也又以餘言攺定巨蟹爲積屍气缺碗爲貫索

薛儀甫歷學防通亦有三十雜星之攷亦有缺星名者今余所攷則以回歷星名同者爲證似比兩公爲有根本也又查恆星出沒表四十五大星內星名同者二十一

人坐椅子諸像非西洋六十像之像如貫索在回回歷爲缺椀在西洋則爲冕旒卽此見西占之本出回回也第五作觜宿南星性情旣合又與參宿同象而曆書言逺鏡測之有三十六星則爲气類宜爲雜星所收今從袁說

查回回淩犯表有天關及昴宿性情𨿽同星名不合若如袁說則兩星性情皆系金土亦未可爲確據不如缺之

攷定三十雜星

【戊午年距歷元戊辰五十一年加星行四十三分二十秒】

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十九﹥

今將原書所載列後

西星名

【譯書時所距

述宮度

黃道】等性

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷十九﹥

原書云以上數星是三百九十二年之前度數如此其星皆往東行一年行五十四秒十年行九分六十六年行一度觀者依此推之

歷算全書卷十九

欽定四庫全書

歷算全書卷二十

宣城梅文鼎撰

仰儀簡儀二銘補注

仰儀

按元史天文志簡儀之後繼以仰儀然簡儀紀載明析而弗錄銘辭仰儀則僅存銘辭而弗詳制度蓋以銘中弗啻詳之也庚寅暮春眞州友人以二銘見寄屬防其義余受而讀之簡儀銘旣足以補史誌之闕仰儀銘與史亦多異同而異者較勝豈牧庵作銘後復有定夲耶爰據其夲以爲之釋仍附錄史誌原文以資攷訂焉

不可形體莫天大也無競維人仰載也

言天體之大夲不可以爲之形似而今以虛坳似之器仰而肖之則以下半渾圓對覆幬之上半渾圓而周天度數悉載其中此人巧之足以代天工故曰無競維人也

六尺爲深�自倍也兼深�倍絜兌也

形是半渾圓而其深六尺是渾圓之半徑也倍之爲廣則渾圓之全徑也兼深與�之度而又倍之渾圓之周也蓋仰儀之口圓徑一丈二尺周三丈六尺也兌爲口故曰兌絜猶度也【此𨿽亦徑一圍三古率然其器果圓則畸零在其中矣】

振漑不泄繚以澮也正位辧方曰子卦也

口周圍爲水渠環繞注水取平故曰振漑不泄繚以澮也口之面均列二十四方位而從子半起子午正則諸方皆正故曰正位辧方曰子卦也

橫縮度中平斜載也斜起南極平鐓也【度入聲】

縮直也仰儀象地平下半周之渾天其度必皆與地平上之天度相對待故先平度之從儀面之卯酉作弧綫相聫必過儀心以橫剖形爲二地平下卯酉半規也又直度之從儀面之子午作弧綫相聨亦過儀心而直剖形爲二地平下子午半規也兩半規交於儀心正中天在地平下正對天頂處也故曰衡縮度中然此所謂中乃平度之中【其衡縮度之者並自地平之子午卯酉出弧綫而防於地平下之中心】若在天之度固自斜轉卽非以此爲中故旣平度之復斜度之有兩種取中之法故曰平斜載也【載猶再也】斜度柰何曰宗南極也法於地平下子午半規勻分半周天度乃用此度自地平午數至南極入地度命爲斜度之中心故曰斜起南極【言緯度從此起】鐓者之鐓卽儀心也【鐓徒對切矛防底平者曰鐓曲禮進矛防者前其鐓類篇矛防柲下銅也儀類而形仰最坳深處爲其底心故謂之鐓】爲地平下兩半規十字交處而下半渾圓之心平度以此爲宗亦如斜度之宗南極故曰平鐓也蓋以此二句釋上二句也【不言起省文】

小大必周入地畫也始周浸斷浸極外也

此言斜度之法也斜畫之度旣宗南極則其緯度之常隠不見者毎度皆繞極環行而成圓象【毎度相去約一寸弱】𨿽有大小皆全圓也【近南極旁則小漸逺漸大毎度相離一寸其圓徑之大小毎度必加二寸】故曰小大必周而明其爲入地之畫也在南極常隠界內故也若過此以往則離極益逺緯度之圓益大其圓之在地平下者漸不能成全圓而其闕如玦以其漸出南極常隠界外也故曰始周浸斷浸極外也【亦是以下句釋上句】

極入地深四十太也北九十一赤道齘也列刻五十六時配也

儀設於元大都大都北極出地四十度太【四分之三爲太】則南極入地亦然仰儀凖之近南極四十度內皆常隠界也若四十一度以上則所謂始周浸斷者也至於離南極一象限【四分天周各九十一度奇爲象限銘蓋舉成數也】則爲赤道之齘而居渾天腰圍矣【齘齒相切之界縫也考工記圅人衣之欲其無齘也仰觀經緯之度入算處並只一綫故曰齘】凡晝夜時刻並宗赤道赤道全周勻分百刻以配十二時仰儀赤道乃地平下半周故列刻五十配六時也六時者起卯正初刻畢酉初四刻皆晝時仰儀赤道半周居地平下而紀晝時者日光所射必在其衝也【日在卯光必射酉日在午光必射子余時亦皆若是】

衡竿加卦防坤內也以負縮竿子午對也【子元史作夲】末旋機杖【機杖元史作機板】窽納芥也上下懸直與鐓防也視日漏光何度在也

此仰儀上事件也防東南坤西南所定口之卦位也橫竿之兩端加此二卦者以負直竿也直竿正與口爲平面承之者必稍下故曰內也直竿加橫竿上如十字其夲在午而末指子故曰對也直竿必圓取其可以旋轉而竿末則方其形類板板之心爲圓竅甚小僅可容芥子故曰窽納芥窽卽竅也然必上下懸直以爲之凖蓋直竿之長適如半徑其末端𨿽自午指子實不至子而納芥之竅正在口平圓之心於此懸繩取正則直綫下垂亦正直底鐓心故曰與鐓防也旣上下相應無豪髮之差殊則竅納芥處亦卽爲渾圓心矣凡所以爲此者以取日光求眞度也何則仰儀爲形以象地平下之半天而所測者地平上之天也故必取其衝度以命之而渾圓上經緯之相衝必過其心玆也機板之竅旣在渾圓之最中中央從此透日光以至底視其光之在何度分卽可以知天上日躔之度分矣漏卽透也

暘谷朝賔夕餞昧也寒暑發斂驗進退也

此詳言測日度之用也虞書分命羲仲宅嵎夷曰谷寅賔出日分命和仲宅西曰昧谷寅餞內日此古人測日用裏差之法也今有此器則隨地隨時可測日度卽裏差已在其中不必谷昧谷而寅餞之用已全矣周禮以土圭致日日至之影尺有五寸爲土中又取最長之影以定冬至此古人冬夏致日之法也今有此器以測日道之發南斂北【日躔在赤道以南謂之發在赤道以北謂之斂皆以其逺近於北極而立之名】則毎日可知其進退之數【二分前後黃赤斜交故緯度之進退速二至前後黃赤平行故緯度之進退緩細攷之亦逐日各有差數】不必待南至北至而可得眞度視表影所測尢爲親切矣

薄蝕終起鑑生殺也以避赫曦奪目害也

言仰儀又可以測交食也【日月交食一曰薄蝕】歷家之測驗莫大於交食而測算之難亦莫如交食是故測食者有食之分秒有食之時刻有食之方位必測其何時何刻於何方位初虧爲食之起何時何刻於何方位復圓爲食之終何時何刻於何方位食分最深爲食之甚自虧至甚爲食之進自甚至復爲食之退凡此數者一一得其眞數始可以驗歷之疏宻以爲治歷之資然太陽之光最盛難以目窺今得此器透芥子之光於儀底必成小小圓象而食分之淺深進退畢肖其中【但蝕於左者光必闕於右蝕於右者光必闕於左上下亦然皆取其對衝方位】而時刻亦眞不煩他器矣古者日食修徳月食修刑然春生秋殺之理固在寒暑發斂中而起虧進退尢測之精理此蓋與上文互見相明也

南北之偏亦可槪也極淺十七林邑界也深五十二【元史作五十奇】鐵勒塞也淺赤道髙人所載也夏永冬短猶少差也深故赤平冬晝晦也夏則不沒永短最也【載當作戴】此言仰儀之法不特可施之大都而推之各方並可施用因舉二處以槪其餘也蓋時刻宗赤道赤道宗兩極而各方之人所居有南北北極之出地遂有髙卑而南極之入地因之有深淺則有地偏於南如林邑者其地在交趾之南是爲最南故其見北極之髙只十七度卽南極之入地亦只十七度而爲最淺又有地偏於北如鐵勒者其地在朔漠之北是爲最北故其見北極之髙至五十餘度卽南極之入地亦五十餘度而爲最深南極入地淺則赤道入地深而成立勢其赤道之半在地上者漸近天頂爲人所戴故夏日亦不甚長冬日亦不甚短而永短之差少也南極入地深則赤道入地淺而成眠勢其赤道之半在地上者漸近地平繞地平轉故冬日甚短而至晝晦夏晝甚長而日不沒永短之最斯爲極致也【按元史鐵勒北極髙五十五度夏至晝七十刻夜三十刻北海北極髙六十五度夏至晝八十二刻夜十八刻未至於夏日不沒則冬亦不至晝晦然北海之北尙有其北北極有漸直人上之時逺徵之周髀所言近驗之西海所測夏不沒冬晝晦容當有之銘蓋因二方差度而遂以推極其變也】

二天之書曰渾蓋也一儀卽揆何不悖也以指爲告無煩喙也闇資以明疑者沛也智者是之膠者怪也此言仰儀之有禆於推步也渾天蓋天並古者測天之法蓋同出於一源傳久而分遂成岐指近代蓋天之說浸防惟周髀算經猶存十一於千百而習之者稀今得此器以肖地平下之天𨿽常隱不見之南極其度數皆如掌紋而渾天之理賴以益明卽蓋天家所言七衡之說並可相通初無齟齬然後知渾蓋兩家實有先後一揆並行而不悖者矣所以者何也多言亂聽喙愈煩而心惑一儀惟肖指相授而目諭也由是而理之闇者資之以明從來疑義渙然冰釋𨿽其器創作爲膠固者之所怪而其理不易終爲明智者之所服矣【周髀算經云北極之左右物有朝生暮獲趙爽注曰北極之下從春分至秋分爲晝從秋分至春分爲夜是北極直人上而南極益深爲人所履赤道平偃與地面平日遂有時而不沒地爲永短之最觀於仰儀可信其理】

過者巧歷不億軰也非讓不爲思不逮也將窺天眹造物愛也其有俟然昭聖代也泰山厲兮河如帶也黃金不磨悠久賴也鬼神禁訶庻勿壊也

此承上文而深贊之也言古來巧歷不可數計然不知爲此者豈其謙譲不遑乎無亦精思有所未及耳抑天道幽逺將造物者不欲以朕兆令人窺測而有愛惜耶其待人而行非時不顯故若有所俟必至聖代而始昭耶然則玆器也實振古所未有而玆器之在宇宙間亦當與天地而常存𨿽泰山如礪長河如而玆器也悠久賴之如黃金之不磨而鬼神且爲之呵防以庻防勿壊矣

按史載斯銘引古六天之說而謂仰儀可衷其得失是等蓋天於宣夜諸家而歸重渾天也然郭太史有異方渾蓋圖固已觀其防通玆則並舉渾蓋且以仰儀信其揆之一蓋牧庵之歷學深矣愚故以斷其爲重定之夲也學無止法理愈析益精古之人皆如是上海徐公之治西曆也開局後數年推宗郭法乃重於前惟公則明惟虛受益好學深思者其知所取法哉

簡儀【儀制詳元史玆約舉爲銘而文章爾雅能略所詳詳所略與史相備因並釋之】

舊儀昆侖六合包外經緯縱橫天常衺帶三辰內循黃赤道交其中四遊頫仰鈞簫

此將言簡儀而先述渾儀也昆侖卽混淪古者渾天儀渾圓如球故曰舊儀昆侖也渾天儀有三重外第一重爲六合儀有地平環平分廿四方向有子午規卯酉規與地平相結於四正又自相結於天頂以象宇宙間四方上下之定位故曰六合包外經緯縱橫也又依北極出地於子午規上數其度分命爲南北二極之樞兩樞間中分其度斜設一規南髙北下以象赤道之位而分時刻謂之天常規故又曰天常衺帶也內第二重爲三辰儀亦有子午規卯酉規而相結於兩極各爲樞軸以綴於六合儀之樞中分兩極間度設赤道規與天常相直又於赤道內外數南北二至日度斜設一規爲黃道兩道斜交以紀宿度以分節气而象天體故曰三辰內循黃赤道交也內第三重爲四遊儀亦有圓規內設直距以帶橫簫橫簫有二並綴於直距而能運動故可以上下轉而周窺規樞在兩極又可以左右旋而徧測故曰其中四逰頫仰鈞簫也

凡今攺爲皆析而異繇能防明無窒於視

此承上文而言作簡儀之大意也渾天儀經緯相結而重重相包今則析爲單環以各盡其用故曰皆析而異各環無經緯相結作之旣簡而各儀各測無重環掩映之患故曰防明無窒於視也

四遊兩軸二極是當南軸攸沓下乃天常維北欹傾取軸榘應鏤以百刻及時初正赤道上載周列經星三百六十五度奇贏

此以下正言簡儀之制也簡儀之四遊環用法與渾儀之四遊同而厥制防異原亦有經緯相結今只一環【𨿽用防環而左右平列無經緯相結卽如一環】又原在渾儀之內爲第三重今取出在外而中分其環命爲兩極北極樞軸連於上規之心南極樞軸在赤道環心故曰四遊兩軸二極是當南軸攸沓下乃天常也天常卽百刻環與赤道相疊言天常不言赤道省文也上規貫北云架柱之端赤道百刻疊置承以南云架柱兩云架柱斜倚之勢並凖赤道但言維北欹傾者省文互見也兩並欹傾則二軸相應如繩正指兩極而四遊環可以運動其勢恆與上下兩規作正方折其方中矩故曰取軸矩應此以上言四逰環也百刻環勻分百刻又勻分十二時時又分初正此二句言百刻環也赤道環疊於百刻環上故曰上載其環勻分十二次周天全度於中又細分二十八捨距度故曰周列經星三百六十五度奇贏也【百刻環卽六合儀上斜帶之天常赤道環卽三辰儀之赤道然皆不用子午規而單環疊置此其異也】

地平安加立運所履錯列幹隅若十二子

地平環分二十四方位與渾儀同【幹八幹甲乙丙丁庚辛壬癸隅四維乾坤艮巽十二子支辰子丑寅卯辰巳午未申酉戌亥也】然彼爲六合儀之一規此則獨用平環臥置以承立運故曰立運所履也立運環渾儀所無玆特設之以佐四逰之用其制亦平環分度而中分之爲上下二樞上樞在北云架柱之橫輄下樞在地平環中心二樞上下相應如垂繩之立而環以之運故謂之立運

五環三旋四衡絜焉

一四遊二百刻三赤道四地平五立運凡爲環者五也旋運轉也五環之內百刻地平不動四遊赤道立運並能運轉是能旋者三也衡卽橫簫古稱玉衡絜猶絜矩之絜用衡測天如算家之�術絜而度之以得其度也簡儀之衡凡四而並施於旋環之上故曰五環三旋四衡絜焉也【下文詳之】

兩綴闚距隨捩畱遷欲知出地究玆立運去極防何卽遊是問

兩者兩衡承上文四衡而分別言之先舉其兩也兩者維何一在立運環一在四遊環也闚闚管距直距捩闗捩卽樞軸也畱遷者言畱遷惟人所用也闚管綴於直距有樞軸以轉動隨其所測可以頫仰周闚此兩衡之所同也然各有其用欲知日月星辰何方出地及其距地平之髙下則惟立運可以測之若欲知其去北極逺近防何度分惟四遊可以測之此又兩衡之所異也

赤道重衡四末張上結北軸移景相望測日用一推星兼二定距入宿兩候齊視

前云四衡而上文已詳其兩尙有二衡復於何施曰並在赤道環也赤道一環何以能施二衡曰凡衡之樞在腰而此二衡者並以赤道中心之南極軸爲軸重疊交加可開可合故曰重衡也衡旣相重故不曰闚衡而謂之界衡界衡之用在綫不設闚管也用綫柰何其法以綫自衡樞間循衡底之渠貫衡端小孔上出至北極軸穿軸端所結綫折而下行至衡之又一端入貫衡端小孔順衡底渠至衡中腰結之如此則一綫折而成兩並自衡端上屬北極其勢斜直張而不弛半衡如句而綫爲之一衡首尾二綫重衡則四綫矣故曰四末張末指衡端張者狀其綫之直也北軸卽北極之軸穿綫處也四綫並起衡端而宗北極故又曰上結北軸也景謂日影移衡對日取前綫之景正加後綫則衡之首尾二綫與太陽參直故曰移景相望也衡上二綫旣與太陽參直則界衡正對太陽衡端所指卽太陽所到加時早晚時初時正何刻何分並可得之【百刻環中具列其數】則一衡已足故曰測日用一也測星之法移衡就星用目睨視取衡上二綫與其星相參值則爲正對與用日景同理但須二衡並測故曰推星兼二也二衡並測柰何曰二十八捨皆有距星以命初度若欲知各宿距度廣狹者法當以一衡正對距星又以一衡正對次宿距星則兩衡間赤道度分卽夲宿赤道度分矣若欲知中外官星入宿深淺者法當以一衡對定所入宿距星復以一衡正對此星稽兩衡間赤道卽得此星入宿度分矣旣用二衡卽亦可兩人並測故曰定距入宿兩候齊視也

巍巍其髙莫莫其遙蕩蕩其大赫赫其昭步仞之間肆所賾考明乎制器運掌有道法簡而中用宻不窮歷考古陳未有侔功猗與皇元發帝之蘊畀厥羲和萬世其訓

簡儀之制及其用法上文已明此則贊其制作之善歸羙夲朝也言天道如斯髙逺乃今測諸步仞之間如示諸掌則制器有道耳其爲法也簡而適中其爲用也宻而不窮歷攷古制未有如我皇元斯器之善﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

歷學駢枝自敍

歷猶易也易傳象以數猶律也律制噐以數數者法所從出而理在其中矣世乃有未習其數而嘐嘐然自謂能知歷理𨿽有髙言雄辧廣引博稽其不足以折疇人之喙眀矣而株守成法者復不能因數求理以眀其立法之根於是有沿誤傳訛而莫之是正歷所以成絕學也然理可以深思而得數不可鑿空而撰然則茍非有前人之遺緒又安所乎【鼎】自童年受易於先大父又側聞先君子餘論謂象數之學儒者當知謹識之不敢忘壬寅之夏獲從竹冠倪先生受臺官通軌大統歷算交食法歸與兩弟依法推步疑信相參乃相與晨夕討論爲之句櫛字比不憚往復求詳遇所難通則廢瞑食以助其憤悱夫然後气朔發斂之由躔離朓朒之序黃赤道差變之率交食起復滿之算稍稍闚見藩籬乃知每一法必有一根而數因理立悉本實測爲端固不必彊援鐘律牽附蓍卦要其損益進退消息往來於易於律亦靡弗通也爰取商確之語錄系本文之下義從淺近俾可共曉辭取眀暢不厭申重庶存一時之臆見以爲異時就正之借𨿽於歷學未必有禆亦如駢拇枝指不欲以無用折之云爾

康熙元年歲在元黓攝提格相月旣望又三日宣城山口梅文鼎書於陵陽之東樓

歷學源流

夫治歷以明時乃古今之大典而气朔爲之首章以總七政之要當時有載太史令郭公守敬因气朔之不齊遂攷景以驗气更立四十尺之表測至元十八年辛巳歲前天正冬至恆气日則己未丑初一而爲元曰授時謂授人時而已距來歲之冬至則三百六十五萬二千四百二十五分爲一歲之實以二十四气約之是知每气一十五萬餘二千一百八十四分三十七秒半爲之气盈一月凡二气計盈四千三百六十八分七十五秒也其月有遲疾而三十日之間與日防之同度曰合朔然此非交食無以攷也今朔距來朔則二十九萬五千三百○五分九十三秒爲朔實是知一朔之實而少四千六百九十四分○七秒不及三十日爲之朔虛並一月之气盈得九千○百六十二分八十二秒曰月閏積一年凡一十○萬八千七百五十三分八十四秒曰歲閏積三年而過朔實有三萬餘是三年一閏而名曰正閏積五年復成再閏稍未及二朔之實積十九年成七閏爲一章之終亦不及七朔實之八百餘分也所以五年之十九年之閏皆曰餘閏稽之於韻閏卽余也余卽閏也故曰閏餘成歲歷之旣成在元凡八十七年迨至我

朝尢重之勅太史令王公恂撰之立成元公統注諸通軌契歷經不言之奧開來學未遇之疑旣而更太史院爲欽天監實敬天勤民之盛心授推步官爲保章正乃設職從政之美意又何以加於是乎故爲序

右歷學源流一篇不知誰作味其語意首言气朔爲首章蓋卽首章之序也案元史授時歷經本有七章曰气朔曰發斂曰日躔曰月離曰中星曰交防曰五星而本書合气朔發斂爲一章又取日躔章之盈縮差月離章之遲疾差使相附麗則經朔之後卽求定朔頗便於用大致亦本歷艸也然不用授時消分則元統氏之爲也元統所傳歷法於日躔月離交防五星皆有通軌而此章獨無蓋久爲疇人所習簡明易知無煩攺作也作此序者又在元統之後其言气盈朔虛置閏甚有原委字句朴簡猶存古意故仍冠其首

釋凡四則

一印心

歷生於數數生於理理與气偕其中有神焉而不亂也變焉而有常也於是聖人以數紀之堯命羲和舜在璣衡皆是物也中遭秦炬先憲略亡自太初以後作者數十家人各效才王郭肇興大成斯集夫天不變理亦不變故歷代賢者往往驗天以立法要皆積有其畢生之精力始得其一法之合於理有聖人𨿽起不能易者而後垂之不刋以至今鼎何人也敢與於斯夫創起者難爲功觀成者易爲力昔人緣理以立數今玆因數以知理期以信吾心焉耳矣所不能信者不敢知也其或章句繁複往復諄然夫必如是而後自信以信於古人僭越獲罪旣無所逃拘滯固陋詒誚通方幸有以敎

一存疑

大統歷法所以仍元法不變者謂其法之善可以永久也夫旣仍辛巳之元合用授時之數乃以今所傳較之歷經參伍多違豈別有說愚故不能無疑也按歷經上考往古則歲實百年長一周天百年消一下驗將來則歲實百年消一周天百年長一此其據往以知來自堯典徵降而諸史所載可以數求者當時則旣一一驗之矣而今所傳歲實一無消長此其可疑一也又按歷經諸應等數隨時推測不用爲元固也今則气應仍是五十五日○六百分周應仍是箕十度至於閏原是二十○萬一千八百五十分今攺爲二十○萬二千○五十分較授時後二百分轉應原是一十三萬一千九百○四分今攺爲一十三萬○千二百○五分較授時先一千六百九十九分交應原是二十六萬○千一百八十七分八十六秒今攺爲二十六萬○千三百八十八分較授時後二百○○分一十四秒或差而先或差而後以之上考辛巳必與元算不諧若據歷經以步今玆亦與今算不合然則定朔置閏月離交防之期又安所取也豈當時定大統歷有所測驗而攺之與夫攺憲則必另立元今气應周應俱同而獨於數者有更此其可疑二也又按歷經盈縮遲疾皆有二術其一術不用立成其一術用立成然只有用之之法而無其圖其遲疾圖則又仍如古式只二十八日母數而無逐限細率意者當時修史者之遺忽與抑有所禁祕也今據此所載立成以求盈縮二術俱諧以求遲疾則自八十三限以至八十六限與前術有所不合意其所謂立成者有異歟據元史王恂先卒其立成之槁俱未成書郭公守敬爲之整齊意者歷經前術爲王公未定之槁與此其可疑三也又如日月食開方數乃所求食分橫過半徑之數據歷經皆五千七百四十乘之今攺月食者爲四千九百二十乘是所測闇虛小於原所測者二十分也則其所測月輪圓徑亦小於原測一十分也茍非實有測驗於天又何敢據此以非彼與茍非於交食之際立渾比量周徑縱橫之數何從而定與茍非於虧復之際下漏刻以驗之定用分之多少何自而知與此其可疑四也又有自相背馳如立成所載日出入半晝分是自冬至夏至後順數隻問盈縮不言初末而通軌求日出入法又似有初末二圖此言不可意斷者至於晝夜永短與元史所載大都刻數不同則以北極髙下黃道因之所在而殊理固然也然篇首旣不言郡省撰名復載王恂豈當時九服晷漏之永短皆推有圖而元史止載其一歟然畢竟此所列者據何地爲則也此其可疑五也凡此數端同異出入未敢偏據姑卽所傳略附箋疏去取是非俟之君子

一刋誤

大抵一書傳經數手多非其舊或謄冩魯魚或簡編蠧蝕故君子愼闕疑也乃若專守殘文習焉不察有所未解彊入以己意參之遂使斲輪不傳糟粕並失金根輒攺燕郢何憑今於其尢謬亂者是正數條或據歷經或據本書非敢逞私憑臆以重獲戾於古今也一者日月食限乃算家所憑以定食不食者也而今所載或失而出或失而入失而入不過虛費籌筞而已失而出則將據此以斷不食其有不合將以疑立法之不詳今皆據陰陽食限極之諸差所變以爲常準卽準本書以定似爲稍密脫有不合其必非本算所能禦矣其日食夜刻月食晝刻亦據本書及歷經所載時差並定用分得之其月帶食若據歷經定用分尙有微差亦不多也一者月食時差分據歷經爲定蓋歷考古歷皆與此所載不合故斷從經一者黃道定積度原以歲差推變自大衍以後爲法略同今若定鈐何異膠柱今斷從歷經仍以天啟辛酉一年步定爲式一者月食旣內分據歷經原以旣內分與一十分相減相乘平方開之也今則訛爲一十五分夫月食十分而旣其旣內五分倍之爲十分而止矣安得有所謂旣內十五分乎今以較求句股法求得旣內小平圓積數皆與所求相應一如歷經原法故斷從之別有圖說以證其理一者日月帶食凡日出入分在初虧已上復圓已下是爲帶食而出入也今則訛爲初虧已上食甚已下是得其半而失其半求之歷經亦復仍訛故愚亦不敢全據歷經者謂有此等處也今據後已復光未復光條攺爲復圓分已下厥數實諧於理亦暢又月食通軌前所錄數定望並晨分下注誤又月食分秒定子法誤又月食定用分並旣內分定子俱誤又月食更防歸除法並定數法俱誤又逕求次年天正交泛分條誤多有閏無閏每月加數今皆刋正

一補遺

算有所必不可略句與字有所必不可無而或無之或略之則非作法者之故爲祕惜也如日食交前後條正交交定度在七度已下數𨿽在正交度下而實則陽曆交後度也法宜加交終度減之此算之所必不可略者也乃此書旣不之載至元歷經亦復闕焉何也夫此亦數之易知當必非所甚祕豈非梨棗鉛槧者之責乎將謂精於算者自能知之而無所用書歟今輒斷之以理重爲補定古人而得見我何以幸教之也【續讀學歷小辧所載大統交食法有在七度以下食在正交語足與愚說相證】又如定子法爲乘除後進退而設甚便於初學其立法立意不可謂不至也乃多有遺去言十定一不滿法去一二語者夫定子所以禦乘除之變而此二語又所以通定子之窮若無此二語則何如不定子之爲愈乎又如求天正赤道黃道度二條皆不用定子夫赤道不定子知其所減者爲度位乎爲分位乎黃道乘除不用定子固也然何以處夫除不滿法與夫減過積度只剩秒防者乎又如食甚入盈縮條遺食甚甚字夘酉前後條遺定望望字凡此皆字與句之所必不可無者也今皆補定

欽定四庫全書

歷算全書卷二十一

宣城梅文鼎撰

歷學騈枝卷一

大統歷步气朔用數目錄

元世祖至元十七年辛巳嵗前天正冬至爲歷元按古歷並溯太古爲元各立積年未免牽合故久而多差惟授時歷不用積年截用至元辛巳爲元一慿實測而無假借故自元迄明承用三四百年法無大差以視漢晉唐宋之屢攺屢差不啻霄壤故曰授時歷集諸家大成蓋自西曆以前未有精於授時者徐文定公曆書亦截崇禎戊辰爲元而廢積年用此法也【又按大統歷以洪武甲子爲元然易其名不易其實故臺官布算仍用至元辛巳也】

周天三百六十五萬二千五百七十五分

半周一百八十二萬六千二百八十七分半

天體渾員自角初度順數至軫末度得周天度分均剖之卽半周天

按天本無度因日躔而有度古歷代更天度異測授時歷用簡儀實測當時度分視古爲密

度法一萬分

按古歷以日法命度並有畸零【如太初歷以八十一分爲日法大衍歷以三千四百分爲日法而度法因之亦有畸零】惟授時歷不用日法故一度卽爲一萬分而周天三百六十五度二五七五分卽命爲三百六十五萬二千五百七十五分此王郭諸公之卓見超越千古也又按授時歷周天百年長一今大統不用此其與授時防異者也

嵗周三百六十五萬二千四百二十五分

嵗周一名嵗實自今嵗冬至數至來嵗冬至得此日數實不及周天一百五十分而嵗差生焉

半嵗周一百八十二萬六千二百一十二分半

均剖嵗周也自天正冬至算至本年夏至又自本年夏至數至本年冬至其日數並同

气防一十五萬二千一百八十四分三十七秒半置嵗周日數以二十四气平分之得此日數謂之恆气

日周一萬分【自今日子正至來日子正共得此數】刻法一百分【毎日百刻故也】旬周六十分【自甲子至癸亥六十日之積分】

紀法六十日【卽旬周也】按日周一萬分乃整齊之數故旬周亦整六十日也太陽行天每日一度前云度法萬分者亦以此也並以整萬分立算而無畸零故曰不用日法也又按授時歷嵗周上考已往百年長一分下推將來百年消一分大統省不用故不言也

通餘五萬二千四百二十五分

置嵗周減六旬周得余此數卽五日二十四刻二十五分乃一年三百六十日常數外之餘日余分

气應五十五萬○千六百分

此授時歷所用至元辛巳天正冬至爲元之日時也是爲己未日丑初一刻乃實測當時恆气之應上考已往下求將來並距此立算以此爲根也其數自甲子日子正初刻算至戊午日夜子初四刻得五十五日又自己未日子正初刻算至醜初一刻得六刻合之爲五十五萬零六百分

嵗防三百五十四萬三千六百七十一分一十六秒此十二朔策之積也自今年正月經朔至來年正月經朔得此積分或置嵗實內減嵗閏亦同

朔防二十九萬五千三百○五分九十三秒

此太陰與太陽合朔常數乃晦朔朢一周也自本月經朔至次月經朔得此積分又謂之朔實乃十二分嵗防之一

朢防一十四萬七千六百五十二分九十六秒半此朔防之半乃二十四分嵗防之一自經朔至經朢又自經朢至次月經朔並得此數又謂之交朢

防七日三千八百二十六分四十八秒二五

此朢策之半乃四分朔策之一自經朔至上又自上至經朢又自經朢至下至次月經朔其數並同

月閏九千○百六十二分八十二秒

此一月兩恆气與一經朔相差之數置气防倍之得三十○萬四千六十八分七十五秒內減朔防得之

嵗閏一十○萬八千七百五十三分八十四秒

此十二个月閏之積也亦名通閏

閏應二十○萬二千○百五十○分

此至元辛巳爲元之天正閏餘也蓋卽己未冬至去經朔之數當時實測得辛巳嵗前天正經朔是三十四萬八千五百五十分卽至元庚辰年十一月經朔爲戊戌日八十五刻半爲戌正二刻也

閏凖一十八萬六千五百五十二分○九秒

置朔防內減嵗閏得之

盈初縮末限八十八日九千○百九十二分二十五秒此冬至前後日行天一象限之日數蓋冬至前後一象限太陽每日之行過於一度故也【四分嵗周所行度得九十一度三一○六二五爲一象限】

縮初盈末限九十三日七千一百二十○分二十五秒此夏至前後日行天一象限之日數也蓋夏至前後一象限太陽毎日之行不及一度故也

按盈初者定气冬至距定气春分之日數縮末者定气秋分距定气冬至之日數也此兩限者並以八十八日九十一刻稍弱而行天一象限縮初者定气夏至距定气秋分日數盈末者定气春分距定气夏至日數也此兩限者並以九十三日七十一刻有奇而行天一象限今現行時憲歷節气有長短卽此法也又按古歷每日行一度原無盈縮言盈縮者自北齊張子信始也厥後隋劉焯唐李淳風僧一行言之綦詳歷宋至元爲法益密然不以之注歷者爲閏月也大衍歷議曰以恆气注歷定气算日月食由今以觀無處不用但每月中節仍用恆气不似西洋之用定气耳西洋原無閏月只有閏日故以定气注歷爲便若中土之法以無中气爲閏月故以恆气注歷爲宜治西法者不諳比气輒訶古法爲不知盈縮固其所矣

轉終二十七萬五千五百四十六分

此月行遲疾一周之日數也內分四限入轉初日太陰行最疾積至六日八十餘刻而復於平行謂之疾初限厥後行漸遲積至十三日七十七刻奇而其遲乃極謂之疾未限於是太陰又自最遲以復於平行亦六日八十餘刻謂之遲初限厥後行又漸疾亦積至十三日七十七刻奇其疾乃極如初日矣謂之遲末限合而言之共二十七日五十五刻四十六分而遲疾一周謂之轉終也

轉中一十三萬七千七百七十三分

卽轉終之半【解見上文其數一名小轉中】

轉差一萬九千七百五十九分九十三秒

置朔策內減轉終得之乃相近兩經朔入轉之相差日數也

轉應一十三萬○千二百○五分

此至元辛巳天正冬至日入轉日數也蓋實測得冬至己未日丑初一刻太陰之行在疾末限之末日也

交終二十七日二千一百二十二分二十四秒

此太陰出入黃道陽曆陰曆一周之日數也

交差二日三千一百八十三分六十九秒

置朔防內減交終得之乃相近兩經朔入交之相差日數也

交應二十六萬○千三百八十八分

此至元辛巳天正冬至入交泛日也【乃實測冬至己未日丑初一刻月過正交日數】

气盈○日二千一百八十四分三十七秒半

此气策內減十五整日外余此數【一月兩恆气共盈四千三百六十八分七十五秒】

朔虛○日四千六百九十四分○七秒

置三十日內減朔策得之乃一朔防少於常數三十日之數

沒限○日七千八百一十五分六十二秒半

置日周一萬內減气盈得之

土王防一十二日一千七百四十七分五十○秒又土王防三日○千四百三十六分八十七秒半按土王防一名貞防置嵗實以五除之得七十三日○四八五爲一嵗中五行分王之日數又爲實以四除之得一十八日二六二一二五爲每季中土王日數內減气防得餘三日【○四三六八七五】爲土王防乃自辰戌丑未四季月中气日逆推之數土王防四因之得十二日【一七四七五】亦爲土王防乃自四季月節气日順數之數二者只須用一今並存者所以相考也

宿會二十四萬

宿余分一萬五千三百○五分九十三秒

日直宿二十八日一周是爲宿會以宿會減朔實得宿余

限防九十○限○六八三○八六五

置防以十二限二十分乘之得此數故以全加得次限

限總一百六十八限○八三○六○【一名中限】

置小轉中以十二限二十分乘之得此數故限防加滿則用以全減

朔轉限防二十四限一○七一一四六

置轉差以十二限二十分乘之得此數故以全加得次朔限

按以上三者爲求遲疾限之捷法然可不用蓋旣有日率相減之法則十二限二十分乘之法已爲筌蹄何況限防

盈防六十九萬六千六百九十五分二十八秒

置气盈分爲實以气防除之得毎日盈一百四十三分五三四七七五轉用爲法以除日周得每六十九日六六九五二八而盈一日是爲盈防故以加盈日卽得次盈

虛防六十二萬九千一百○四分二十二秒

置朔虛分以朔防除之得毎日虛一百五十八分九五六一七一轉用爲法以除日周得六十二日九一○四二二而虛一日是爲虛防故以加虛日卽得次虛

大統歷步气朔法

求中積分

置嵗實三百六十五萬二千四百二十五分爲實以距至元辛巳爲元之積年減一爲法乘之卽得其年中積分【定數以嵗實定六子以積年視有十年定一子百年定二子乘法言十加定一子得數後共以八子約之爲億也】如徑求次年中積分者加一嵗實卽可得之中積分者自所求年天正冬至逆推至辛巳爲元之天正冬至中間所有之積日積分也積年減一者以嵗前天正冬至爲立算之根故也假如康熈元年壬寅距至元十七年辛巳該三百八十二算法祗以三百八十一年入算是爲減一用之也蓋欲算本年之气朔必以年前天正冬至爲根是所求康熈壬寅年之中積分乃順治辛丑年十一月冬至之數故也定子法者爲珠算定位設也其法十定一子百定二子千定三子萬定四子十萬定五子百萬定六子千萬定七子億萬定八子嵗實首位是三百萬故定六子積年有十定一有百定二皆一法也言十加定一子者以乘法首位言之凡法首位與實首位相呼九九數有言十之句則得數進一位故加定一子此條原文缺此句余所補也得數以八子約之爲億者謂視原定之子若有八子則乘得數首位是億也未乘之先視法實之數以定子故旣乘之後卽據所定之子以定得數此法最便初學也

附嵗實鈐

千百十萬

一

三六五二四二五

凡用鈐自單年起有二

七三○四八五○

十年則進一位用之三一○九五七二七五

有百年又進一位卽四一四六○九七○○

得所求中積分並以五一八二六二一二五

單年無定之位推而六二一九一四五五○

上之卽算位俱定七二五五六六九七五

八二九二一九四○○

九三二八七一八二五

求通積分

置所得其年中積全分加气應五十五萬○千六百分卽得所求通積分如徑求次年亦加嵗實

前推中積分是從辛巳歷元天正冬至起算今加气應是又從辛巳歷元冬至前五十五日○六刻起卽甲子日子正初刻也

求天正冬至

置通積全分滿紀法六十萬去之餘爲所求天正冬至分也萬以上命起甲子算外爲冬至日辰【欲求時刻依發斂加時條求之見後】如逕求次年者不拘有無閏月並加通餘五萬二四二五滿紀法去之卽得

通積分旣從甲子起算故滿紀法去之卽知日辰也算外命日辰者以有小餘也凡滿萬分成一日者爲大餘九千分以下皆爲小餘大餘爲日乃先一日之數小餘爲時刻乃爲本日故取算外也

求天正閏餘分

置其年中積全分如閏應二十○萬二千○百五十分爲閏積以滿朔實二十九萬五千三百○五分九十三秒除之爲積月其不滿者卽爲所求年天正閏餘分也閏餘分滿閏凖一十八萬六五五二○九者其年有閏月【補法閏餘滿十六萬八四二六四五以上者其年冇閏如用閏凖須加兩月閏】如逕求次年天正閏餘者不拘有無閏月並加通閏一十○萬八七五三八四滿朔策去之卽得【如卻求前嵗閏者置本年閏餘內減通閏得之閏餘小於通閏不及減加朔實減之卽是】

閏餘分者乃嵗前天正冬至距天正經朔數也法當自辛巳歷元天正經朔起算故以閏應通之也閏凖是朔實內去十二个月閏之數若閏其年十一二月者此法不能禦故有補法也若於所得閏餘分加一萬八千一百二十五分六四【兩月閏之數】再用閏凖取之亦同

附經朔鈐

百十萬

一

二九五三○五九三閏積內與經朔鈐數二

五九○六一一八六同者減去之減至不三

八八五九一七七九滿一朔實二十九萬四一一八一二二三七二五三○五九三而止五一四七六五二九六五其餘數卽閏餘分六一七七一八三五五八

七二○六七一四一五一

八二三六二四四七四四

九二六五七七五三三七

求天正經朔

置其年通積全分內減去其年閏餘全分滿紀法六十萬去之餘爲所求天正經朔分

又法置冬至內減閏餘卽得經朔如冬至小於閏餘不及減加紀法六十萬減之如逕求次年天正經朔者無閏加五十四萬三六七一一六【十二朔實去紀法之數】有閏加二十三萬八九七七○九【十三朔實去紀法之數】並滿紀法去之卽得

朔者日月同度之日經者常也經朔者朔之常數所以別於定朔也古人只用平朔故日蝕或在晦二唐以後始用定朔則蝕必於朔然不知經朔則定朔無根故必先求定朔

先推通積分自歷元甲子日算至冬至減去閏餘是從甲子日算至經朔故去紀法卽得經朔之大小餘也

先推冬至分是以紀法減過通積而得乃冬至前甲子日距冬至數內減閏餘卽爲甲子日距經朔數也如冬至小於閏餘是此甲子日𨿽在冬至前卻在經朔後故加紀法減之是又從經朔前甲子算起也求天正盈縮歷

置半嵗周一百八十二日六二一二五內減去其年閏餘全分余爲所求天正縮歷也【補法若其年冬至與經朔同日而冬至加時在經朔前則天正經朔入盈歷】如逕求次年天正縮歷者內減去通閏一十○萬八七五三八四得之減後視在一百五十三日○九以下者再加一朔防卽是

按冬至交盈歷夏至交縮歷各得嵗周之半今置半嵗周是減去盈歷半周只用縮歷半周從夏至日算至冬至日之數也內減閏餘卽爲從夏至算至十一月經朔日數故恆爲縮歷

亦有入盈歷者其前必有閏月而至朔同日冬至小餘又小於經朔小餘先交冬至後交經朔其經朔已入盈歷法當於經朔小餘內減去冬至小餘命其餘爲天正盈歷也若冬至小餘大於經朔小餘不用此法蓋𨿽至朔同日而朔在至前仍爲縮歷此處原本所缺故備著之

凡閏餘加通閏卽爲次年閏餘今所得天正縮歷是半周內減閏餘之數於中又減通閏卽如減次年閏餘矣故逕得次年天正縮歷也一百五十三日○九以下者半周內減一朔防也減後得此必有閏月在次年天正經朔前故必復加朔防而得次年天正朔歷也

求天正遲疾歷

置其年中積全分內加轉應一十三萬○二○五減去其年閏餘全分爲實以轉終二十七萬五五四六爲法除之其不滿轉終之數若在小轉中一十三日七七七三以下者就爲所求天正疾歷也若在小轉中以上者內減去小轉中則爲天正遲歷也

如逕求次年天正遲疾歷者加二十三日七一一九一六【十二轉差積數】經閏再加轉差一日九七五九九三並滿轉終去之遲疾各仍其舊若滿小轉中去之者遲變疾疾變遲也

中積分原從歷元冬至起算至所求天正冬至止今加轉應減閏餘是從歷元冬至前十三日初交疾歷時起算至所求年天正經朔止故不滿轉終卽爲天正疾歷也轉中者轉終之半故疾歷滿此卽變遲歷也

附轉終鈐

百十萬

一

二七五五四六

二

五五一○九二

三

八二六六三八

四一一○二一八四

五一三七七七三○

六一六五三二七六

七一九二八八二二

八二二○四三六八

九二四七九九一四

求天正入交泛日【原本作交泛分今依歷經攺定】

置中積減閏餘加交應二十六萬○三八八爲實以交終二十七萬二一二二二四爲法除之其不滿交終之數卽爲所求天正入交泛日及分也

如逕求次年天正入交日者無閏加六千○百八二○四【十二交差內減去交終之數】有閏加二萬九千二百六五七三【十三交差內減去交終之數】卽得

中積減閏餘與求遲疾法同加交應是從辛巳歷元前二十六日初入正交時算起也故不滿交終卽爲天正入交日也泛者對定而言也有經朔有定朔則入交之深淺亦從之而移此所得者經朔下數故別之曰泛

附交終鈐

百十萬

一

二七二一二二二四

二

五四四二四四四八

三

八一六三六六七二

四一○八八四八八九六

五一三六○六一一二○

六一六三二七三三四四

七一九○四八五五六八

八二一七六九七七九二

九二四四九一○○一六

推經朔次气及望法

置天正經朔全分加五十九萬○六一一八六【卽二朔防】滿紀法六十萬去之爲所求年正月經朔累加朔防二十九萬五千三百○五九三爲逐月經朔累至次年天正經朔必相同也【次年天正經朔在本年爲十一月】復以朢防一十四萬七六五二九六五累加各月經朔得經朢又加之卽得次月經朔復以防七萬三八二六四八二五累加經朔得上加上卽復得經朢又加之得下又加之復得次月經朔凡累加時並滿紀法去之其復得數必與原推分秒不異【或先加防次加朢防亦同】

前有逕求次年天正經朔法與此挨次累加之數互相參考卽知無誤算法還原之理也以後並同

推恆气次气法

置天正冬至日及分加四十五萬六五五三一二五【卽三气防】滿紀法去之爲所求年立春恆气累加气策一十五萬二一八四三七五滿紀法去之得各恆气加至本年冬至卽與前逕推次年天正冬至相同也

附二十四恆气鈐

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十一﹥

立春【次年】正月節五十○萬八九七八一二五右鈐以加天正冬至滿紀法去之卽逕得各月恆气大小餘

凡恆气大餘命起甲子算外得日辰小餘命時刻【依發斂加時條取之】並同冬至法

推盈縮歷次气法

置天正盈縮歷日及分加五十九萬○六一一八六滿半嵗周一百八十二日六二一二五去之爲所求年正月經朔下盈歷也累加朔防二十九萬五三○五九三爲逐月經朔盈歷也盈歷加滿半嵗周去之交縮歷又累加之滿半嵗周去之復交盈歷也【累加至十一月卽與次年天正盈縮歷相同】復以防七萬三八二六四八二五累加之各得朢乃次朔之盈縮歷也【至次朔亦必相同】

盈歷滿初限八十八日九○九二二五爲有末之盈縮歷滿初限九十三日七一二○二五爲有末之縮

推初末限法

置半嵗周一百八十二日六二一二五內減有末之盈縮歷全分余爲所求各末限日分也復於各盈縮末限日分累減防七萬三八二六四八二五得各朢及次朔下盈縮末限必相同也若不及減防者末限已盡盈交縮縮交盈也【補法置防以不及減之餘末轉減之卽各得所交盈縮初限日分相同也】

凡盈歷算起冬至縮歷算起夏至並從盈縮初日順推至所求日時若盈末則算起夏至縮末則算起冬至並從盈縮盡日逆推至所求日時故置半嵗周減之而得末限日分也

所得末限日分是所求日時距盈縮末盡日逺近之數朔而朢入歷益深則其距末盡日益近故在初限累加防者在末限卽用累減而得也

推盈縮差法

置盈縮歷全分【若系末限則置所得末限全分】減去大餘不用只用小餘【有千分定三有百定二有十定一】並以立成相同日數下取其盈縮加分爲法乘之【加分有百定二有十定一言十加定一子】得數以所定八子約之爲度位乃於立成本日下所有盈縮積與得數相倂卽得所求盈縮差

凡言八子或九子約之爲度者乃是於得數上定此虛位以便與盈縮積度相加非言得數有八子九子也假如八子爲度位而原所定只有五子卽得數爲度下三位若盈縮積有度卽度得數上第三位加之法於得數首位呼五字逆上數之曰五六七八至八字住於此加積度卽無誤也遲疾歷同

盈縮加分是本日太陽行度或過或不及於一度之分也【或日行過於一度而有餘分是爲盈加分或日行不過一度而有欠分是爲縮加分】盈縮積度則是本日以前加分累積之數也【總計逐日盈加分爲盈積度總計逐日縮加分爲縮積度】法當以小餘乘本日加分爲實日周一萬分爲法除之卽得小餘時刻內所有之加分乃以得數倂入本日以前原有之積度則爲本日本時之盈縮差矣【歷經云萬約爲分卽是以日周一萬除乃本法也】玆以定子法約之故以八子爲度所得亦同【假如以千乘百共定五子則所得乘數爲十萬分就用爲實以日周一萬爲法除之當去四子剰一子則所得除數成十分是於度下爲第三位也何以言之蓋度下有千有百故十分爲第三位今於所定五子虛進三位至八子位命爲度以加積度卽得數十分適居度下第三之位而相加無誤矣前條八子命億而此以八子約爲度何也曰無二理也八子於乘得數原是億位蓋億卽一萬萬用萬萬爲實以一萬爲法除之當去四子剩四子則除後得數爲萬而成度位今不去子故以八子爲度其實卽歷經萬約爲分之法非有二也】

問初限是從盈縮初日順推【盈初從冬至起算縮初從夏至起算並數其已過之日】其小餘亦順推【並自本日子正刻起順下丑寅數至所求時刻】若末限則是從盈縮末盡日逆數【盈末距夏至立算縮末距冬至立算皆數其未到之日】其小餘亦逆數【並自本日夜子初刻逆轉亥戌數至所求時刻】而加分乘小餘加積度之法並無有異且盈縮互用【盈末所用之加分積度卽縮初之數縮末所用之加分積度卽盈初之數】何也曰凡初限所積之盈縮度分並爲末限之所消【假如盈初限共有積盈度二度四十分一交盈末卽每日有所縮以消其積盈直至盈末盡日其盈消盡而交夏至爲縮歷矣又如縮初限共有積縮度二度四十分一交縮末卽每日有所盈以消其積縮直至縮未盡日其縮消盡而交冬至復爲盈歷矣】故同一加分也在初限爲日增之分在末限則爲日消之分【假如盈末限未到夏至若干日與縮初限已過夏至之日數等則其日行度之所縮亦等故盈末日卽用縮加分又如縮末日與盈初限之日數等則其距冬至等而日行之所盈亦等故縮末日卽用盈加分】同一積度也在初限爲己積之度分若末限則爲未消之度分【假如盈末毎日內各有縮加分以消其盈而今盈末尙有若干日則其縮加分末用而積盈亦未消累而計之其數必與縮初限相同日數下之積度等故卽用縮積度爲盈積度也縮末卽用盈積度爲未消之縮積度其理亦同】今末限旣有小餘則此時刻內亦必有未消之零分在積度外故以小餘乘加分而萬約之【卽八子爲度之法解已見前】倂入積度卽知此日此時尙有未經消盡之積度共若干度分而命之爲盈縮差矣【盈末日𨿽用縮加分縮積度數而仍爲盈差縮末日𨿽用盈加分盈積度數而仍爲縮差蓋其加分積度爲逐日之盈縮而盈縮差分是總計初日以來之盈縮故也】

推遲疾歷次气法

置天正遲疾歷日及分加三日九五一九八六【兩轉差數】爲所求年正月經朔下遲疾歷也以後累加轉差卽得各月經朔下遲疾歷也凡加後如滿小轉中一十三萬七七七三者去之疾變爲遲遲變爲疾不滿者遲疾不變累加至十一月卽與次年天正遲疾歷相同也復以防七日三八二六四八二五累加之各得朢及次朔之遲疾歷亦滿小轉中去之變遲疾也

本宜累加朔防而去轉終今用轉差是防法其得數同也

附轉差鈐

一

一日九七五九九三用鈐加正月經朔下二

三日九五一九八六遲疾歷可逕求各月三

五日九二七九七九遲疾歷若加滿小轉四

七日九○三九七二中去之疾變遲遲變五

九日八七九九六五疾也

六十一日八五五九五八

七

○日○五四六五一自七个月以後爲減八

二日○三○六四四過小轉中之後加後九

四日○○六六三七卽變遲疾若加滿小十

五日九八二六三○轉中去之反不變也十一七日九五八六二三

十二九日九三四六一六

推遲疾歷限數法

置遲疾歷日及分【十日定五單日定四○日有千定三○日○千有百定二有十定一】以十二限二十分【定一】爲法乘之【言十定一】得數以所定有四子爲單限五子爲十限六子爲百限卽得各遲疾歷限數如逕求次朢之限數者【如自朔求上自上求朢之類】每加限

防九十限卽得加滿中限一百六十八限去之則變遲疾如超次月【如以朔求次朔以上求次月上之類】累轉加朔轉限防二十四限一○卽得【亦滿中限去之而變遲疾】如累加之至十个月間有多一限乃二十分尾數積成故有退一限減之之法不必致疑皆以日率爲定也

遲疾分限數何也太陰行天有遲疾其遲疾又有初末與太陽之盈縮同所不同者太陽之盈縮以半嵗周分初末而其盈縮之度止於二度奇太陰之遲疾以十三日七十七刻奇分初末而其遲疾之度至於五度奇【疾初只六日八十八刻奇而疾五度遲初只六日八十八刻奇而遲五度】歷家以八百二十分爲一限【卽八刻奇】一日分十二限二十分而自朝至暮逐限之遲疾細分可得而求矣

捷法以所得遲疾歷與立成中遲疾日率相較擇其相近者用之【或所得遲疾歷日及分卽立成內日率相同或稍彊於日率卽可取用】卽可逕得限數【此法可免十二限乘亦卽無退退一限減之之事余所補也】

推遲疾差法

置遲疾歷日及分以立成內相同限下日率減之【如立成日率大不及減卽退一限減之】用其餘分爲實【有百分定四子十分定三子單分定二子十秒定一子】以其下損益分【十分定五子單分定四子十秒定三子單秒定二子】爲法乘之【言十定一】得數又爲實以八百二十分【去二子】爲法除之【不滿法又去一子】得數取所定八子爲度位視立成是益分卽於得數上依位加本限下遲疾積度【如盈縮差加積度法】若是損分卽置遲疾積度內減去得數【如八子爲度位而所定只五子則於度下第三位減之餘仿此】卽各得所求遲疾差

遲疾日率者毎限八百二十分之積數也【如滿八百二十分則爲一限滿兩个八百二十分則爲二限乃至滿十个八百二十分卽爲十限百个八百二十分卽爲百限故曰日率】而所得遲疾歷未必能與各限之日率巧合而無零分故以此日率減之卽知此日太陰之行度己足過若干限而尙餘若干時刻也【毎限八百二十分卽八刻奇未滿此數皆爲零分】

損益分者各限內遲疾進退之差也自初限至八十三限爲益分其遲疾爲進也【在疾歷則益其疾在遲歷亦益其遲故並爲益分】自八十四限至一百六十八限爲損分其遲疾爲退也【在疾歷則損其疾在遲歷亦損其遲故並爲損分】此損益分皆整限八百二十分之數零分所有之損益必小於八百二十分之損益故以零分乘八百二十分除也

遲疾積度者是本限以前所積之遲疾度分也【如在八十三限以前則爲日益之積數八十四限以後則爲日損之餘數】於是以所得零分內之損益分損之益之便知此時此刻內太陰之遲疾所不同於平行者共有若干度分而命之爲遲疾差也

定子之法千三百二則萬四常爲度位而此與盈縮差並用八子者盈縮差原是萬約爲分宜去四子今省不去故八子卽是四子也此求遲疾之損益是以八百二十除原非萬約爲分而亦用八子爲度者因乘時加定四子【余分百定四子是加定二子也損益分之十分是度下一位宜定千三今定五子是又加二子也合之共加定四子】則八子亦是四子其故何也遲疾歷遇八十一限至八十六其損益分多爲單秒則定子之法窮故加四數以豫爲之地也

不滿法又去一子者亦以相除時算位言之【假如法是八實亦是八或八以上可以除得一數卽爲滿法若實在八以下卽不能除得一數當退位除之卽爲不滿法也此不論十百千萬之等惟論自一至九之數假如以八十除六百亦爲不滿法若以八百除九十亦爲滿法皆以得數有進位不進位而分算中精理也】蓋除法本是降位【如用十爲除法是以十爲一當降一位故去一子百爲除法是以百爲一當降兩位故去二子】今不能除得一數而退位除之是又降一位故再去一子也按古歷太陽朓朒之行但有各恆气十五日奇之總率而無毎日細數太陰朓朒之行但有毎一日之總率而無一日內分十二限奇之細數有之皆自授時始皆以平立定三差得之授時之密於古法此一大端也

推加減差法

視各經朔朢下盈縮差與遲疾差如是盈遲縮疾爲同名則相倂用之如是盈疾縮遲爲異名則兩數相較用其餘分【有萬定四子千定三子百定二十定一】以八百二十分【定二子】乘之【言十定一】得數爲實以立成本限下遲疾行度爲法【遲用遲行度疾用疾行度並以萬去四子千去三子】除之【不滿法又去一子】得數以所定有三子爲千分二子爲百分卽得所求加減差

同名者盈遲爲加差

縮疾爲減差

異名者盈多疾少爲加差疾多盈少爲減差遲多縮少爲加差縮多遲少爲減差

加減差者時刻之進退也前論盈縮遲疾二差則行度之進退也因日月之行度各有紓亟而時刻因之進退故前旣分求之玆乃論之也

以右旋之度言之日每日平行一度月每日平行十三度有奇合朔時日月同度歷防七日【三八二六四八二五】而月度超前離日一象限是爲上又歷防而月度離日半周天與日對度是爲朢自此以後月向日行又歷策而距日一象限是爲下更歷防而月追日及之又復同度而爲合朔矣凡此者皆有常度有常期故謂之經朔經朢經也乃若定朔定朢定則有時而後於常期故有加差焉有時而先於常期故有減差焉

凡加差之因有二一因於日度之盈夫日行旣越於常度則月不能及一因於月度之遲夫月行旣遲於常度則不能及日二者皆必於常期之外更增時刻而後能及於朔朢之度故時刻加也

減差之因亦有二一因於日度之縮夫日行旣緩於常度則月易及之一因於月度之速夫月行旣速於常度則易及於日二者皆不待常期之至而已及於朔朢之度故時刻減也

乃若以日之盈遇月之遲二者皆宜有加差以日之縮遇月之疾二者皆宜有減差故【盈與遲縮與疾】並爲同名而其度宜倂若以日之盈遇月之疾在日宜加在月則宜減以日之縮遇月之遲在日宜減在月宜加故【盈與疾縮與遲】並爲異名而其度宜相減用其多者爲主也

如上所論旣以【盈縮遲疾】二差同名相從異名相消則加減差之大致已定然而又有乘除者上所言者度也非時刻也故必以此所得之度分【卽同名相從異名相消之度分】用每限之時刻【八百二十分】乘之爲實每限之月行度爲法【卽遲疾行度】除之卽變爲時刻而命之爲加減差矣以異乘同除之理言之月行遲疾行度則所歷時刻爲八百二十分今加減之度有防个遲疾行度則月行時刻亦當有防个八百二十分故以此乘除而知加減差之時刻

推定朔法

各置經朔朢大小餘各以其加減差加者加之減者減之卽各得所推定朔朢大小餘大餘命起甲子算外得定日支幹小餘命時刻【依發斂加時條求之】其定朔朢日小餘若在本日日出分以下者退一日命之惟朔不退定朔日干名與次月同者其月大不同者其月小內無中气者爲閏月

朢退一日者以月當用更防也假如定朢在乙丑日日未出前則仍是甲子日之更防故也

按節气爲兩月相交之界故謂之節中气爲一月三十日之正中故謂之中月有中气然後可正其名曰某月【如有冬至則爲十一月有大寒則爲十二月有雨水則爲正月他皆若是】若月內無中气而但有節气則在兩月交界之間不能名其爲何月而謂之閏月矣

凡閏月前一月中气必在晦後一月中气必在朔則前後兩月各在定名而此月居其間不得復以前後月之名名之不得不爲閏月【如月內但有立春節而無中气則大寒中气在前月之晦定其爲十二月雨水中气則後月之朔定其爲正月前後兩月各有本名不可移動而本月無中气卽無月名必爲閏月也】歷家以無中气爲閏月則各月之中气必在本月而不可稍移所謂舉正於中民則不惑也然惟以恆气注歷始能若是唐一行之說所以確不可易而歷代遵守以爲常法非不知有定气而但知恆气也【定气卽日行盈縮若於各恆气求其盈縮差而以盈差爲減差縮差爲加差卽得各定气日及分然而不用者爲閏月也】

推入交次气法

置天正入交泛日及分加四日六三六七三八【卽兩交差】卽爲所求年正月經朔下入交泛日及分也以後累加交差二日三一八三六九滿交終二十七日二一二二二四去之卽各月經朔下入交泛日也累加至其年十一月卽與次年天正入交泛日相同也復以交朢一十四日七六五二九六五累加之亦滿交終去之卽得各月經朢下入交泛日加朔得朢加朢得次朔亦必相同也附交差鈐

一

二日三一八三六九用鈐加正月經朔下二

四日六三六七三八入交泛日可逕得所三

六日九五五一○七求某月經朔下入交四

九日二七三四七六泛日若加正月經朢五十一日五九一八四五下入交泛日亦可逕六十三日九一○二一四得所求某月經朢下七十六日二二八五八三入交泛日加滿交終八十八日五四六九五二

二十七日二一二二九二十○日八六五三二一二四並去之用其餘十二十二日一八三六九○數

十一二十五日五○二○五九

十二○日六○八二○四

推盈日法

視各恆气之小餘在沒限七千八百一五六二五以上者爲有盈之气也置防余分一萬○一四五【以十五日除气防得一萬○一四五六二五止用四位取大數也】內減有盈之气小餘四位用其餘分爲實【以千三百二定之】以六十八分六十秒【以气盈除十五日得六十八分六十六秒九五今亦止用三位】定一爲法乘之【言十定一】得數取定四子爲日位用加恆气大餘日滿紀法去之命起甲子算外爲所推盈日也

又法亦以有盈之恆气小餘去減防余分余以一气十五日乘之爲實气盈二千一百八四三七五爲法除之得數以加恆气大餘滿紀法去之命爲盈日亦同若逕求次盈日者置所得盈日毎加盈防六十九萬六六九五二八卽得第二盈日亦滿紀法去之命干支也盈日卽古歷之沒日也凡气內有盈日者多一日假如甲子日立春則己夘日水今盈一日爲庚辰日雨水故謂之盈日

防余分者十五日除气防之數也蓋謂毎大餘一日卽帶有盈分○千一百四十五分故必足得防余分【一萬○一四五】之數則爲十五分气防之一也

六十八分六十秒者气盈除十五日之數也蓋謂毎盈一分在恆气爲六十八分六十秒卽六十八分六十秒盈一分也今有盈之恆气小餘尙不及防余分有若干分則必更歷若干六十八分六十秒而其盈分始足命之盈日也

又法以十五日乘气盈除卽六十八分六十秒乘也故其得數同

捷次盈以盈防加者率六十九日奇而有盈日則毎一嵗周只有五盈日或四日也余詳用數

推虛日法

視各經朔之小餘在朔虛四千六百九四○七以下者爲有虛之朔也置有虛之朔小餘四位【千定三百定二】爲實以六十三分九十秒【朔虛除三十日得六十三分九十一秒奇此用大數故只三位】定一爲法乘之【言十定一】得數取定四子爲日位用與經朔大餘相加滿紀法去之命起甲子算外爲所推虛日也又法以三十日乘有虛之小餘爲實朔虛四千六百九四○七爲法除之得數以加經朔大餘滿紀法去之爲虛日亦同

若逕求次虛日者置所得虛日每加虛防六十二日九一○四二二卽得第二虛日其命干支亦滿紀去之也虛日卽古歷之滅日也凡月內有虛日者其月小【以經朔言之】故謂之虛日

六十三分九十秒者朔虛除三十日之數也蓋謂毎虛一分在月內爲六十三分九十秒卽毎六十三分九十秒當虛一分也今經朔小餘尙有若干分則必更歷若干六十三分九○而其虛分始盡命之虛日也

其又法以三十日乘朔虛除卽六十三分九○乘也故得數亦同

捷次虛日以虛防加者率六十三日弱而有虛日則每一嵗防亦只五虛日也余亦詳用數

推土王用事法

置四季月節气大小餘【三月用淸明六月小暑九月寒露十二月小寒】各加土王防一十二萬一七四七五滿紀法去之大餘命起甲子算外各得所推土王用事日辰也

又法置四季月中气大小餘【三月用谷而六月大暑九月霜降十二月大寒】內各減第二土王防三日○四三六八七五如不及減加紀法減之所得亦同

天有五行而土無專位以體之立者言之則居中以用之行者言之則在隅土者木火金水之所以成終而成始也參同契曰土旺四季羅絡始終靑赤白黒各居一方皆稟中宮戊己之功蓋謂此也歷家以春木夏火秋金冬水分旺者各得气策四又十二日【一七四七五】而土寄旺於四季之末者各得气防一又三日【○四三六八七五】與四行之數適以相等而嵗功成焉前法用加節气者是於四時之末而要其終後法用減中气者是據土王用事之初而原其始余詳用數推發斂加時法

各置定朔朢及恆气之小餘爲實以十二時爲法乘之【法實並以千三百二定之言十定一以所定四子爲萬】取萬爲時命起子正有五千起作一時命起子初並以算外命時其不滿五千者取一千二百爲刻命起【初正】初刻算外爲某刻

又法各置小餘加二爲時減二爲刻不須定數就以千位爲時百位爲刻有五百起作一時命起子初初刻不起者命起子正初刻也

按古法以日行赤道外去北極逺謂之發日行赤道內去北極近謂之斂發斂字義並主北極爲言日道之自近而逺逺而復近皆以漸致故不曰逺近而曰發斂也古諸家歷法並有步發斂一章其所列者月卦律呂气之類而加時之法附焉授時亦然故曰步發斂加時也【授時𨿽不用律呂月卦惟存七十二而統以廿四中節蓋卽其所謂發斂而所謂步發斂加時者以推各气候初交之時刻發斂字義防上文而爲說猶云步气候加時云爾】大統則省去步發斂一章故加時之法在气朔章後而猶云推發斂加時因仍舊名無他義也

以十二乘者何也蓋以日周一萬分十二時則各得八百三十三分三三不盡故以十二乘之通日周一萬爲十二萬則可以勻分乃算術通分法也日周旣通爲十二萬故以一萬爲一時以一千二刻爲一刻也有五千起作一時者因時有初正則各得五千其子初四刻爲前半个子時乃先一日之數謂之夜子時子正四刻爲後半个子時乃本日之數本日十二時並從玆起故滿一萬者命起子正也命起子正則算外爲醜正矣【因所滿一萬數中有子正四刻丑初四刻在內則前半个丑時已滿而算外爲醜正】若但滿五千則算外爲丑初【但滿五千則所滿者是後半个子時而交前半个丑時是爲丑初非醜正也】故起作一時而命起子初此是從先日夜子初刻算起借前半个子時輳合成整以便入算也

其又法加二爲時減二爲刻者加是就身加二卽十二乘但不變千位不定子故卽以一千爲一時而起子正有五百起作一時而起子初也減二卽十二除而挨身減二不動算位所謂定身除法也故卽以一百爲一刻

附十二時鈐

千百十分十秒

千百十分十秒

子正○○○○○○午正五○○○○○丑初○四一六六六未初五四一六六六醜正○八三三三三未正五八三三三三寅初一二五○○○申初六二五○○○寅正一六六六六六申正六六六六六六夘初二○八三三三酉初七○八三三三夘正二五○○○○酉正七五○○○○辰初二九一六六六戌初七九一六六六辰正三三三三三三戌正八三三三三三巳初三七五○○○亥初八七五○○○巳正四一六六六六亥正九一六六六六午初四五八三三三【夜子】初九五八三三三凡日下小餘分並以十二時鈐相減命時【如滿四一六六者卽命其時爲丑初滿八三三三者卽命其時爲丑正】減不盡者以一百分爲一刻如不滿百分卽命初刻滿一百分卽命一刻滿二百分命二刻滿三百分命三刻滿四百分命四刻【如小餘可減二千五百分命其時爲夘正減過餘數有一百分卽爲夘正一刻有二百分爲夘正二刻有三百分爲夘正三刻有四百分爲夘正四刻若減余不滿百分只爲夘正初刻他皆若是】初正並同推朔值宿法

置辛巳爲元求到其年通積全分內減去其年閏餘全分加三萬○六一一八六【卽兩宿余】滿宿防二十八萬去之命起虛宿算外卽得所求年正月經朔直宿以後累加宿餘一萬五三○五九三滿宿會去之卽得各月經朔直宿再以各朔下加減差加者加之減者減之亦滿宿會去之命起虛宿算外卽得各月定朔直宿【其加減過小餘亦必與定朔小餘相同爲凖】

此蓋以辛巳爲元之天正冬至前甲子日正直虛宿故逕以通積取之卽得直宿

按日直宿法乃演禽之用占家之一種也故諸家歷法無之授時歷經亦所未載而大統歷有之蓋元統之所增其實無闗歷法

推閏月所在

置朔實【二十九萬五三○五九三】內減去有閏之天正閏餘全分【卽所推天正閏餘在閏凖以上者其年有閏是也】余爲實以月閏九千○百六二八二爲法除之滿法爲月視所得有防月命起嵗前十一月算外得閏在何月此法仍多未的然只在其月之前後皆以定朔爲凖也

滿法爲月者滿得一个月閏之數卽爲一月若滿兩个月閏卽爲兩月此只求整月不除分秒故不必定子

附六十甲子鈐

初日【甲子】一日【乙丑】二日【丙寅】三日【丁夘】四日【戊辰】五日【己巳】六日【庚午】七日【辛未】八日【壬申】九日【癸酉】十日【甲戌】十一【乙亥】十二【丙子】十三【丁丑】十四【戊寅】十五【己夘】十六【庚辰】十七【辛巳】十八【壬午】十九【癸未】二十【甲申】廿一【乙酉】廿二【丙戌】廿三【丁亥】廿四【戊子】廿五【己丑】廿六【庚寅】廿七【辛夘】廿八【壬辰】廿九【癸巳】三十【甲午】三十一【乙未】三十二【丙申】三十三【丁酉】三十四【戊戌】三十五【己亥】三十六【庚子】三十七【辛丑】三十八【壬寅】三十九【癸夘】四十【甲辰】四十一【乙巳】四十二【丙午】四十三【丁未】四十四【戊申】四十五【己酉】四十六【庚戌】四十七【辛亥】四十八【壬子】四十九【癸丑】五十【甲寅】五十一【乙夘】五十二【丙辰】五十三【丁巳】五十四【戊午】五十五【己未】五十六【庚申】五十七【辛酉】五十八【壬戌】五十九【癸亥】二十八宿鈐

初日【虛】一日【危】二日【室】三日【壁】四日【奎】五日【婁】六日【胃】七日【昴】八日【畢】九日【觜】十日【參】十一【井】十二【鬼】十三【栁】十四【星】十五【張】十六【翼】十七【軫】十八【角】十九【亢】二十【氐】廿一【房】廿二【心】廿三【尾】廿四【箕】廿五【斗】廿六【牛】廿七【女】

歷算全書卷二十一

欽定四庫全書

歷算全書卷二十二

宣城梅文鼎撰

歷學駢枝卷二

大統歷交食通軌用數目錄

周天三百六十五度二十五分七十五秒

按此卽步气朔章用數但彼以萬分爲度法此以百分爲度法故百分爲分而分爲秒名異而實同也

半周天一百八十二度六十二分八十七秒半

周天象限九十一度三十一分四十三秒七十五防平分周天度爲半周天又平分之則爲象限乃四分周天之一如兩儀之分四象也

半嵗周一百八十二度六十二分一十二秒半

此太陽行天半嵗之度也亦以度爲百分與气朔章異而以日命度則同以較半周天不及七十五秒乃嵗差所自生

嵗差一分五十秒

若以萬分命度則爲一百五十分

交終度三百六十三度七十九分三十四秒一十九防【六】

此以月平行度乘交終之數月入交一轉凡行天度有此數也

交中度一百八十一度八十九分六十七秒【○九八】此以月平行乘半交之數月入交一半凡行天度有此數也

正交度三百五十七度六十四分

此於交終度內減去六度一五有奇也

中交度一百八十八度○五分

此於交中度內加入六度一五有奇也日食入交度有加減者日旣髙於月黃道在天亦髙於月道故當其初入陰曆六度時月之行天𨿽在日北而人之見月尙在日南中交度所以有加也及其將入陽曆尙差六度時月之行天𨿽在日內而人之見月已出日外正交度所以有減也此皆由測驗而得也其所以然則亦中國地勢爲之

前凖一百六十六度三十九分六十八秒

前者交前也入陰曆滿此是在正交前也入陽曆滿此是在中交前也以後凖減交中卽得

後凖一十五度五十分

後者交後也入陽曆在此數以下是正交後也入陰曆在此數以下是中交後也凖者定也凡月食在交前後以此爲定蓋無論交前交後皆以十五度五十分爲定過此則不食也前凖數𨿽多以減交中度則以十五度五十分也

月平行分一十三度三十六分八十七秒半

置月行極遲極疾度數一轉之積以月行一轉之日平分之得此數

日行分八分二十秒

此乃一限之日行分也月行一限在日周一萬內八百二十分也蓋萬分日之百卽百分度之一分也

日食分二十分

此置日食十分倍之【倂日體月影各十分卽二十分】

月食分三十分

此置月食一十五分倍之【倂月體十分闇虛二十分共三十分】

陰食限八度定法八十分

陰者月入陰曆是在黃道北在日內也在日內則易爲揜故八度食也陰食八度故陰定法亦八十分以八十分除八度卽得陰食十分也

陽食限六度

定法六十分

陽者月入陽曆是在黃道南在日外也在日外則難爲揜故六度食較陰食近也陽食六度故陽定法亦六十分以六十分除六度卽得陽食十分也

月食限一十三度○五分

定法八十七分

以定法八十七除一十三度○五分卽得月食一十五分也月旣小於闇虛闇虛所至卽月所至無髙下故不論陰陽曆皆十三度卽食也闇虛者日之影倍大於月故月食十有五分所謂旣內旣外也

日月食限數【凡數滿萬爲日千爲十刻百爲單刻】

陽食入交

在○日五十刻已下日月不食

在二十六日○二刻已上日月皆食

在一十三日○○刻已上日月皆食

在一十四日七十五刻已【下上】日月皆食

在○日五千四百五五已【下上】日月皆食

在二十五日六一五一已上日月不食

在一十二日○○八九已上日月不食

在一十四日一五一六已下日月皆食

陰食入交

在一日二十五刻已下不食

在一十二日四十二刻已【上下】月食

在一日一八七二已下日食

在二十六日○二四九已上日月皆食

在一十二日四一八九已上

在一十四日七九三三已下

又在交朢一十四日七六五二九六五已下日月皆食又在交終二十七日二一二二二四已下日月皆食又在交中一十三日六○六一一二已下日月皆食右各日月食限如日食視其定朔小餘在夜刻者如月食視其定朢小餘在晝刻者卽同不食亦不必推算也又與各交泛者數同則食也不同者不食其已上已下皆指小餘而言凡數自萬已上爲大餘自千已下爲小餘凡日食視其定朔小餘在一千二四九以下八千八百以上皆在夜刻也起亥初初刻止醜正四刻凡月食視其定朢小餘在三千○一六已上七千○八三已下皆在晝刻也起辰初初刻止申正四刻【晝夜刻仍宜以日出八分與定朔朢小餘相較而定之】

按自定朔之法行而日食必在朔歷家以是驗其疎密者千有餘年矣歷至授時法益密數益簡𨿽然月有交也逐逐步算𨿽簡亦繁許學士之譏世醫謂獵不知兔廣絡原埜術已疎矣今通軌所載食限顚倒繆亂殆不可以數求其誤後學將何已乎今爲訂定如左

今考定日月入交食限

朔泛交入陽曆

在○日五○一六已下爲入食限已上者日不食在一十三日一○四五已上爲入食限已下者日不食

朔泛交入陰曆

在一十四日不問小餘皆入食限

其小餘在一五一六已下一三○七已上者的食

在一十五日一七七九已下爲入食限已上者日不食在二十五日六四○四已上爲入食限已下者日不食在二十六日不問小餘皆入食限

其小餘在六六六七已上六八七六已下者的食

又在交終二十七日二一二二二四已下爲入食限又在交中一十三日六○六一一二已上爲入食限

朢泛交不問陰陽曆

在○日不問小餘皆入食限

其小餘在七九六六已下者月的食

在一日一五五六已下爲入食限已上者不食

在一十二日四五○五已上爲入食限已下者不食其小餘在八○九五已上者月的食

在一十四日七六一七已下爲入食限已上者不食其小餘在四○二七已下者月的食

在二十六日○五六六已上爲入食限已下者不食其小餘在四一五六已上者月的食

又在交終二十七日二一二二二四已下月的食又在交中一十三日不問小餘皆的食

右日月食限皆視其朔朢入交泛日其不入食限者卽不必布算也其入的食限者必食也其入食限不言的者或食或不食也是皆以算禦之也凡言已上已下者皆指小餘有不問小餘者則只以大餘命之也又視其定朔小餘如在日入分後及日出分前十分以上者夜刻也定朢小餘如在日入分前及日出分後七百三十分以上者晝刻也日食在夜刻月食在晝刻卽不得見初虧復圓同不食限不必布算也按日食陰曆距交前後二十一度而止以月平行除之得一日五七一八日食陽曆距交前後六度七十一分而止以月平行除之得○日五○一六卽各食限也其陰曆距交前後七度○一三四至七度二九三四爲日的食限月平行除之得○日五千二百四六至○日五千四百五五也其陽曆則無的食何也蓋日食𨿽有陽食限六度陰食限八度其實總在陰曆陽曆本無蝕法也今所定陽曆食限以諸差得之皆或限也諸差者何一曰盈縮差加減之極至二度四十分一曰南北東西差加減之極至四度四十六分幷二數六度八十六分內除未交陽曆前原空有一十五分餘六度七十一分是爲陽曆食限也其陰曆的食起七度○一至七度二九止者正交中交限距交皆六度一十五分而陽食限只六度是原空一十五分也如入盈縮差幷南北東西差六度八十六分共七度○一而差變極矣故的限以比起置正交中交距交數加陰食限八度共一十四度一十五分內減去盈縮差幷減去南北東西差餘七度二九而差變極矣故的限以此終不入此限度皆或限也置正交中交距交數加陰食限共一十四度一十五分又加入盈縮差又加入南北東西差共二十一度是爲陰曆食限也蓋極其變可以得其常執其常可以追其變今所訂定食限皆要其變之極者言之而其常可知也

又按月食不問陰陽曆只距交前後一十五度四十五分而止在月平行得一日一五五六爲食限也其距交前後一十○度六十五分在月平行得○日七九六六爲的食限也夫月食何以不問陰陽曆也月之掩日以形形則有所不周日之掩月以气气則無所不及故日必以陰曆食月不問陰陽曆皆食陽全陰半之理也又月𨿽掩日尙不能直至於日之所也故有東西南北差日以闇虛掩月則直至於日之所也故亦無東西南北差惟其不用東西南北差也故只以盈縮差二度四十分加其食限一十三度○五分而得食限一十五度四十五分或食之數止此而差變極也只以盈縮差二度四十分減其食限一十三度○五分而得的食限一十○度六十五度或不食之數亦至此而差變極也

又按夜刻不見日食以時差分與定用分相較知之大約日出入夘正酉正合朔當之時差之多至六百五十分若當二至日出入其差乃極亦不下六百三十分故定朔分若與日出入同者其食甚皆在日出前日入後六百三十分以上也假如日食十分當月行極遲之限定用分極多至六百三十五分止矣故知定朔在日出分前一十分以下者卽不得見未復光定朔在日入分後一十分以上者卽不得見初虧斷爲夜刻無疑也其晝刻不見月食亦以時差分與定用分相較知之依授時時差法朢在卯酉正時差之多至一百三十分若當二至日出入其差爲極亦不下八十九分故定朢若與日出入分同者其食甚皆在日入前日出後八十九分已上也假如月食十五分當月行極遲之限定用分多至八百十六分止矣故知定朢在日出分後七百三十分已上者卽不得見初虧定朢在日入分前七百三十分已上者卽不得見未復光斷爲晝刻無疑也【授時算月食時差法見後時差條】又按大衍歷有九服交食法庚午元歷有裏差自宋以前歷法皆有晷漏所在差數今所定只據授時歷經所載大都食法其日出入據立成所載蓋是應天漏刻也元統作通軌是洪武中故用南都漏刻【授時立法時宜有諸方漏刻及裏差推步之術今皆失傳故只據通軌】

日食通軌

錄各有食之朔下數

經朔全分

盈縮歷全分

盈縮差全分遲疾歷全分遲疾限數

遲疾差全分加減差全分定朔全分

入交泛日全分按有食之朔卽所推其朔入交泛日入食限者也故其下所有數皆全錄之蓋數以倚數參伍相求此所錄皆母數原定朔時俱已推定故也月食仿此推定入遲疾歷法

置所推或遲歷或疾歷全分以本日下加減差加者加之減者減之得爲定入遲疾歷分也

按原推遲疾是經朔今以差加減之則是定朔下遲疾也

推定入遲疾歷限數法

置所推定入遲疾歷全分依朔下限數法推之卽得按定朔遲疾旣不同經朔則其入轉限數亦異故復定之

推定限行度法

視所推定入遲疾限與太陰立成相同限下遲疾行度【遲用遲行度疾用疾行度】內減日行分八分二十秒【於度下二位減】卽爲定限行度也

定限行度內減去八分二十秒者月行一限日行八百二十分於百分度法爲八分二十秒也蓋右旋之度月速於日立成中遲疾行度月行於天之數此所推定限行度乃月行距日之數卽日月兩行之較也假如一限內月行一度日亦行八分二十秒則月行之多於日行爲九十一分八十秒

推日出入半晝分法

視有食之朔下是盈歷者大餘若干用立成內冬至後相同積日下日出入半晝分全錄之是縮歷者大餘若干用立成內夏至後相同積日下日出入半晝分全錄之

按日出入者所以定帶食也以全晝之分半之爲半晝分所以定午也只用經朔盈縮歷不加減者所差半日而極無甚差數也

推嵗前冬至天正赤道宿次度分法

置嵗差一分五十秒【定二子】爲實以所距積年減一算【十定一百定二】爲法乘之【言十定一】得數【定有四子爲度】置箕宿十度相減余爲赤道箕宿度分也

按嵗差者日行黃道之度所毎嵗遷徙不常者也堯時冬至在虛一度至元冬至在箕十度漸差而西也嵗差一分五十秒者凡六十六年有八月而差一度也原至元冬至在箕十度至今所求年又差幾度故以距算乘嵗差而得所差之數以減箕宿十度便知退在箕宿幾度也嵗差之度自東而西其數爲退故用減也

推嵗前冬至天正黃道宿次度分法

置所推赤道度分內減去黃道立成相同積度下第三格積度全分余【有十定三子有分定二子十秒定一子】爲實以同度下第四格度率爲法除之【不去子只不滿法去一子】得數【定有三子爲十分二子爲單分一子爲十秒於十分前一位加積度】加入同度第一格積度得爲天正黃道箕宿度分也

按此以箕宿赤道度變黃道也欲明其交變之理當先知渾天之形蓋天體渾員而赤道紘帶天腰其南北極皆等赤道度勻分如瓣離赤道逺則其度漸斂漸狹以會於兩極若黃道之度𨿽亦勻分然半出赤道之外半在赤道之內與赤道有平斜之別若自兩極作經度縱剖赤道必過黃道則有時赤道一度當黃道一度有奇以黃道度斜也【二分黃道斜穿赤道而過故赤道平而黃道斜】有時赤道一度當黃道則不及一度以赤道度小也【二至黃道所經離赤道二十四度弱在赤道度則已爲瓣漸斂之時其度瘦小故不能當黃道之一度】古諸家歷法各有黃赤變率惟授時依割員句股之法剖渾度爲之於古爲密也

黃赤立成起二至畢二分起二分畢二至並於一象限內互相乘除各有定率【詳第三卷

】箕宿近冬至故用至後立成

立成第四格赤道度率也第二格所變黃道度率也凡至後赤道一度零若干分始可當黃道一度也【以赤道小度當黃道之平度則一度不能當一度必加零分始可相當】第三格赤道積度也第一格所變黃道積度也凡至後赤道幾度幾十幾分始可當黃道幾度也

嵗差之法毎年冬至西移則冬至所在宿毎年之距度不同【如至元辛巳冬至在箕十度則箕初距冬至亦十度今康熙壬寅冬至退至四度奇則箕初距冬至亦只四度奇】故必毎年變之始爲凖的【如康熙壬寅箕宿赤道距冬至四度奇以變黃道則不足四度冬至愈退則距度愈近而毎度之加率愈多】

今以所推箕宿赤道度分【是從本年天正冬至逆數至箕宿初度】與第二格積度相減其滿積度數卽變成黃道積度【第三格赤道積度俱帶零分第一格黃道積度並爲整度以此相變是以帶零分之赤道幾度變爲無零分之黃道幾度也】其減不盡者以第四格赤道度率爲法除之則此赤道零分亦變爲黃道零分【所變零分必少於赤道零分】乃以所變零分倂入所變積度爲箕宿初度距冬至之黃道度卽知天正黃道實躔箕宿若干度分也

以異乘同除之理言之赤道一度零幾分於黃道爲一度今有赤道零分若干於黃道亦當爲零分若干法當置赤道零分以黃道度率乘之爲實赤道度率爲法除之得數爲所變黃道零分今因黃道率是一度乘訖數不動故省不乘而只用除是防法也【惟其省乘故除亦不去子惟不滿法去一子蓋不去子則實位暗陞與乘過之得數無兩】

黃道立成

黃積度【加此】度率【此乘黃道】赤積度【減此】

度率【此除黃道】初度

一度

初度○○○○一度○八六五一度

一度

一度○八六五一度○八六五二度

一度

二度一七二八一度○八六○三度

一度

三度二五八八一度○八七五四度

一度

四度二四四五一度○八四九五度

一度

五度四二九四一度○八四三六度

一度

六度五一三七一度○八三三七度

一度

七度五九七○一度○八二三八度

一度

八度六七九三一度○八一二九度

一度

九度七六○五一度○八○一十度

一度

十度八四○六一度○七八六按黃赤道交變立成原有九十一度今只用十度者以箕宿只十度也【若再過二三百年嵗差於箕度退完交入防度則立成數宜用二十度】箕宿度在冬至前而今用至後立成者赤道變黃道之率至前與至後本同一法故可通用也【至後是從冬至順數至前是從冬至逆溯其距冬至度同則赤黃之變卛不異】大致與縮末盈初二限共一加分積度者同理近乃有名家撰述輒譏此條爲錯用立成是未嘗深思而得其意也

推交常度法

置有交食之入交泛日全分【十日定五子單日定四子空日定三子空千定二子空百定一子空十不定子】以月平行一十三度三六八七五【定一】爲法乘之【言十定一乘過定有四子爲單度五子爲十度六子爲百度】卽得所推交常度分也

按交常度者經朔太陽躔度距黃道白道相交之度也

推交定度法

置所推交常度全分內盈加縮減其朔下盈縮差度分爲交定度分如遇交常度數少不及減縮差者加交終度三百六十三度七九三四一九減之餘爲交定度分也遇滿交終度去之

按交定度者定朔太陽所在距黃道白道相交之度也闇虛爲日對度故只用太陽盈縮差加減之也如遇交常度數少不及減縮差者是以常數言之𨿽已在交後計日行盈縮則仍在交前故加入交終度減之卽仍作交前算也

推日食在正交中交度

視交定度分如在七度已下三百四十二度已上者爲食在正交如在一百七十五度已上二百○二度已下者爲食在中交

按正交者月自陰曆入陽曆交之始也中交者月自陽曆復入陰曆交之中也交終之度於此始卽於此終故爲正交也交中之度於此適半故爲中交也七度已下三百四十二度已上者正交食限陽曆距交初七度陰曆距交終二十一度而止也一百七十五度者陽曆距交中亦七度而止爲食限二百○二度者陰曆距交中亦二十一度而止爲食限也

推中前中後分法

視定朔小餘如在半日周五千分已下者就置五千分內減去定朔小餘而余爲中前分也如在半日周已上者就於定朔小餘內減去半日周餘爲中後分也按中前是從午逆推前所距分也故以小餘減半日周中後是從午順求後所距分也故以半日周減小餘順數逆推皆自午正起算也

推時差分法

置半日周內減去所推或中前或中後分余【千定三百定二】爲實復以中前或中後【千三百二定之】爲法乘之【言十定一】得數又以九十六分【去三子按九十六分宜去一子今去三子者經所謂退二位也】爲法除之【不滿法去一子除過定有二子爲百分一子爲十分】得爲時差分也中前爲減差中後爲加差

按時差分者食甚之時刻有進退於定朔者也蓋經朔本有一定之期旣以月遲疾日盈縮加減之爲定朔矣而猶有差者則以合朔加時有中前中後之不同也其所以不同者何也大約日在外月在內故能掩之人又在月內故見其掩而有食當其正相當一度謂之食甚如其合朔午正則以人當月以月當日相當繩直故無所差若在午前以至於夘則漸差而早假如定朔夘正一刻日月合在一度是日月合朔本等時刻也人自地上觀之則不待其月之至於此度也當其夘初初刻月未及日一度時已見其合於日是差而早六刻有奇也若在午後以至於酉則漸差而遲假如定朔酉正一刻日月合在一度是日月合朔本等時刻也人自地上觀之則月𨿽已至此度尙未見其合也直至戌初一刻月行過於日將一度時始見其合於日是差而遲六刻有奇也其自夘而辰而已所差漸少至午正則復於無差也其自午而未而申積差以漸而多至酉則差而極於六刻有奇也蓋天體至圓其行至健運乎四虛地在其中爲气所團結而不散若卵之有黃夫卵旣圓矣黃安得獨方故地之方者其徳其體則必不正方如碁局也夫日月並附天行而月在日下當其合時去日尙不知有幾許人自地上左右窺之與天心所見不同故日月平合在夘酉皆不能見所見食甚日稍在下月稍在上斜所當差近一度在月平行爲六百餘分惟午則自下仰觀所見正當繩直與在左右旁視者異故無差也昔人常云人能淩倒景以瞰日月則晦月之表光應如望吾亦云使人能逐景而行與日相偕則舉頭所見常如在午又使地如琉璃光人居其最中央旋而觀日八面皆平時差之法可以不設矣是其所差不問盈縮遲疾而只在本日之加時故曰時差

推食甚定分法

視時差分如是中前分推得者置定朔小餘內減去時差分余爲食甚定分也如是中後分推得者置定朔小餘內加入時差分共得爲食甚定分也滿日周去之至入盈縮度再加之

按食甚食而甚也食甚分是自虧至復之中日月正相當於一度之時刻也中前減小餘者差而早也中後加小餘者差而遲也若夜刻不算者恐無滿日周去之之理末二句疑有誤

推距午定分法

置所推中前或中後分內加入時差分共得爲距午定分也

按距午定分是食甚時刻距午正之數也食甚以時差加減距午則不減只加者蓋食甚原是順故有加減距午分則一自午順推一自午逆溯總是差而漸逺於午正故也

推食甚入盈縮定度法

置前推或盈歷或縮歷初末全分加入定朔大餘及食甚定分內減去經朔全分余爲食甚入盈縮歷定度分也按原推盈縮歷是經朔下者故以定朔大餘及食甚分加之減去經朔全分如以經朔大小餘加減作食甚大小餘故卽得食甚所入盈縮歷數也

推食甚入盈縮差度法

置所推食甚盈歷或縮歷全分減去大餘依朔下盈縮差法推入得食甚入盈縮差度分也如遇末限亦用反減半嵗周之數【數止秒】

按食甚盈縮歷旣異經朔則其所積盈縮之差亦不同故復求也

推食甚入盈縮歷行定度法

置食甚入盈縮歷全分以萬爲度內盈加縮減其所推食甚入盈縮差得爲食甚入盈縮歷行定度分也【末限不用數止秒】

按凡盈歷若干日卽是常數日行距冬至宿之度數也凡縮歷若干日卽是常數日行距夏至宿之度數也以其差加減之卽得所推食甚日躔距二至宿之度數也凡用末限者所以紀其差是逆從二至推至二分其差整齊易知也今不用末限者所以積其度是順從冬至數至夏至從夏至數至冬至也

推南北泛差度法

視所推食甚入盈縮歷行定度如在周天象限九十一度三一四三七五已下者爲初限也如在已上者置半嵗周內減去行定度余爲末限也或得初限或得末限俱自相乘之【初末限者十度上下各定三子單度各定二子言十各定一子】得數以一千八百七十度【去三子】爲法除之【不滿法去一子除過定有四子爲度三子爲十分按上下各定二子則四子矣故四子爲度】復置四度四十六分【按四度四十六分者卽周天象限自乘復以一千八百七十度除之者】內減去得數余爲南北泛差度分也

推南北定差度法

置所推南北泛差全分【度定四子十分定三】以所推距午定分【千定三子百定二子】爲法乘之【言十定一】得數復以其所錄半晝分【去二子】爲法除之【不滿法去一子除過定有四子爲度三子爲十分】仍置泛差減其得數余爲南北定差也若遇泛差數少不及減者反減之而得也又視其盈縮歷及所推正交中交限度如是盈初縮末者食在正交爲減差中交爲加差也如是縮初盈末者食在正交爲加差中交爲減差也若遇反減泛差者應加作減應減作加不可忽略也

按南北差者古人所謂气差也易之曰南北所以著其差之理也蓋日行盈初縮末限則在赤道南其逺於赤道也至二十三度九十分日行縮初盈末限則在赤道北其逺於赤道也亦二十三度九十分日之行天在月之上而髙故月道與黃道相交之度有此差數以南北而殊也假如盈初縮末限一日空日間日行赤道外極南去人極逺去地益近日道所髙於月道之中間人皆從南觀之易得而見故月道之出黃道而南也較常期【所謂常期皆南北東西差折中之數卽所定大都正交度中交度也】早四度有奇其入黃道而北也較常期遲四度有奇由是以漸而至於盈初縮末八十八日行天漸滿一象限之時黃道之在赤道南者去赤道以漸而近去地之數以漸而逺其日髙月下相去之數人所從旁見者以漸而少故其所差四度有奇以漸而殺也又如縮初盈末限一日空日間日行赤道內極北去人益近去地極逺日道所髙於月道之中間人仰面視之難得而見故月道之出黃道南而爲正交也較常期遲四度有奇其入黃道北而爲中交也較常期早四度有奇由是以漸而至於縮初盈末九十三日行天漸滿一象限之時黃道之在赤道北者去赤道以漸而近去地之數亦以漸而近其日髙月下相懸之數人所從旁見者又以漸而多故其所差四度有奇亦以漸而殺也四度四十六分者據其極差者言也以得數減之便是今所有差也然此皆據午地而言故以距午分乘之以半晝分除之便知今距午之地應分得差數凡幾許而今已距午幾許則此所有之差已不可用故以減原得泛差數而知其尙餘幾許之差爲定差也蓋於天則冬至夏至之黃道爲南北於地則加時在正子午爲南北今泛差之數近二至則多近二分則少是以天之南北而差也定差之數近午正則多近日出沒時刻則少是以加時之南北而差也故曰南北差月自黃道北出黃道南謂之正交卽經所謂交前陰曆交後陽曆也月自黃道南入黃道北謂之中交卽經所謂交後陰曆交前陽曆也其南北泛差不及減反減者此帶食出入方有之何也此必是食甚定分在日入分已上或日出分已下則其距午定分多於半晝分故乘除後得數亦多於泛差也不則以多除以少乘其數且不能泛差相等況能多於泛差乎愚故斷其爲帶食也泛差數少不及減是距午定分已過於半晝是在夜刻故反算其距子之數夫距子與距午其盈縮南北逺近幷旁視仰視之理正相反故加者減之減者加之以爲定差也

推東西泛差度法

置所推食甚入盈縮歷行定度就爲初限也去減半嵗周餘爲末限也以初末二限互相乘之【百度定四子十度定三子言十定一是也】得數復以一千八百七十度【去三子】爲法除之【不滿法去一子除過定有四子爲度三子爲十分】卽得所推東西泛差也

推東西定差度法

置所推東西泛差全分【度定四子千定三子】以所推距午定分【千定三子百定二子】爲法乘之【言十定一】得數以二千五百度【去三子】爲法除之【不滿法去一子除過定有四子爲度三子爲十分】視所推如在東西泛差已下者就爲東西定差度分也如在已上者倍其泛差內減去得數余爲東西定差度分也又視其盈縮歷及中前中後分與正交中交限度若是盈歷中前縮歷中後者正交爲減差中交爲加差也若是盈歷中後縮歷中前者正交爲加差中交爲減差也

按東西差卽古所謂刻差也易其名曰東西者其差只在東西也於天則近二分之黃道爲東西於地則近卯酉之時刻爲東西蓋日行在二至前後其勢平直日行在二分前後則其黃道與赤道縱橫相交其勢斜徑當其斜徑加時又在卯酉則有差也假如春分日在盈歷九十餘度其黃道之交於赤道自南而北勢甚斜徑若加時中前則是赤道倚而黃道橫也加時中後則是赤道倚而黃道縱也又如秋分日在縮歷九十餘度其黃道之交於赤道自北而南勢甚斜徑若加時中前則是赤道倚而黃道縱與盈歷中後仝也加時中後則是赤道倚而黃道橫與盈歷中前仝也黃道縱立於夘酉月道之出入亦從而縱正面視之繩直相當其日內月外相去之中間人所見者少意與南北差縮初盈末正在人頂者同也故月道之出黃道南而爲正交也較常期遲四度有奇其入黃道北而爲中交也較常期早四度有奇此盈歷中後縮歷中前皆於正交以差加中交以差減也黃道橫偃於夘酉月道之出入亦從而橫人在赤道之北斜而望之其日內月外相去之中間皆得而見意與南北差盈初縮末橫偃南上漸近於地者同也故月道之出黃道南而爲正交也較常期早四度有奇其入黃道北而爲中交也較常期遲四度有奇此盈歷中前縮歷中後皆於正交以差減中交以差加也若盈縮歷當二分加時又在卯酉則其差之極四度有奇迨至二分前後黃道之斜徑以漸而平故其差亦以漸而少由是而至於二至黃道之斜徑依平而差亦復於平故曰二至無刻差也若加時不在夘酉則𨿽二分之黃道其差卻與他气不殊蓋其斜徑之勢亦以漸而平故也假如二分加時辰巳之間其定差則正與四立泛差等漸而至於午中則其差亦漸而復於平是其所差只在東西故曰東西差凡東西泛差近二分多是以天之東西而差也其定差以加時夘酉而多是以地之東西而差也以距午分乘之者距夘酉之數也以二千五百除之者日周四分之一乃夘酉距午之數也蓋此所爲泛差乃距午二千五百分時所有之差也乘除後得數若多於泛差是食甚距午分其數亦多於日周四分之一其加時乃在夘前酉後也夘前酉後之差於正夘酉者其數正與夘後酉前等故倍泛差減得數卽爲定差也凡差於南北者復於東西差於東西者復於南北幷二差加減數總無過四度四十六分以是爲交度進退之極也蓋原所謂正交中交限各損陰曆六度余爲陽曆者乃是據中國地勢所差於南戴赤道之下者言人在北道之北故所見黃道交處皆差而近北六度余此常數也若黃道在冬至橫於南上去人益逺故其交處差而北者又四度余而極是共差十度余矣若黃道在夏至去人反近正在中國人頂故其交處原差而北者乃復而南亦四度余而極是只差一度余矣此南北差之理據午上言也若移而至日出入時則其橫於南上者已斜縱於夘酉其正當人頂者已橫斜於夘酉所見差度以漸而平如常數故南北差近午多近日出沒則少也若黃道在春分而加時夘黃道在秋分而加時酉其勢皆橫偃於東西而與地相依故其交處益差而北又四度余而極是亦共差十度余矣若黃道在春分而加時酉黃道在秋分而加時夘其勢皆縱立於東西而與人相當故其交處原差而北者亦皆復而南四度余而極是亦只差一度余矣此東西泛差之理據夘酉而言也若移而至午則其橫偃於夘酉者反斜縱於午上其縱立於夘酉者反橫斜於午上所見差度自以漸而平如常數故東西差近夘酉多近午則少也假使人能正當赤道之下則兩極平見相望子正赤道平分界乎夘酉則凡正交只在交終中交則在交中其气刻之差減正交加中交者則差而北其加正交減中交者則差而南當亦各四度有奇也今中國地勢則正在赤道之北故所見赤道皆斜倚於人之南其所見正交中交度常數亦皆因其赤道之斜倚者而斷惟其黃道交在四立之宿加時在巽坤之維則黃道之勢正自斜倚適如赤道之理而南北東西之差皆少與常數相依若黃道橫則其勢赤道加偃故正交中交之度益差而北若黃道縱則其勢視赤道反直幾有類於南戴日下之赤道故正交中交之度𨿽曰復差而南其實乃復於無差也凡縮初盈末而加時午盈歷而加時中後縮歷而加時中前皆黃道縱之類也其縮初盈末當午𨿽橫在天心然東西視之則亦縱也凡盈初縮末而加時午盈歷而加時中前縮歷而加時中後皆黃道橫之類也其冬夏至黃道當日出入其二分黃道當午皆黃道斜倚之類也

推日食在正交中交定限度

視所推日食在正交中交限度如食在正交者置正交度三百五十七度六十四分在中交者置中交度一百八十八度○五分俱以所推南北東西定差是加者加之減者減之卽爲所推正交中交定限度分也

按正交本在交終三百六十三度七十九分今曰三百五十七度六十四分者於陰曆本數內損六度余爲陽曆也中交本在交中一百八十一度八十九分今曰一百八十八度五分者於陽曆本數外增六度余侵入陰曆也蓋黃道於月道如大環包小環月在日內中間相去空隙猶多人在月內稍北日月交其南人自北斜望得見其間空隙故其交處皆差而北也惟其交處差而北故其交而南也早六度其交而北也遲六度此據地勢爲言在授時立法原在大都若迆而漸南至於戴日之下所差漸平迆而向北差當益大當亦必有各方差數而不可攷矣又按此正交中交度增損六度者只是地勢使然已爲常數其因時而差者又有南北東西二差於是復以加之減之而後乃今所推正交中交之度可得而定而後乃今交前交後陰陽曆可得而定矣

推日食入陰陽曆去交前交後度法

視所推交定度若在正交定限度已下者就於定限度內減去交定度余爲陰曆交前度也若在正交定限度已上者於交定度內減去正交定限度余爲陽曆交後度也又視其交定度若在中交定限度已下者就於定限度內減去交定度余爲陽曆交前度也若在中交定限度已上者於交定度內減去中交定限度余爲陰曆交後度也按若交定度在七度以下者數𨿽在正交定限度下而實則爲陽曆交後度也法當置交定度加入交終度復減去正交定限度余爲陽曆交後度也【勿庵補】按凡交定度在正交後中交前者陽曆也其在正交前中交後者陰曆也若以東西南北差定之而正交度有加中交度有減者是陽曆變爲陰曆也其正交度有減中交度有加者是陰曆變爲陽曆也正交陽變陰中交陰變陽是交後變爲交前也正交陰變陽中交陽變陰是交前變爲交後也故必以所推正交中交定限度爲則與交定度相較而得合朔日躔距交前後的數也凡以交定度去減正交中交定限度者爲交前是逆從交處數來也其於交定度內減去正交中交定限度者爲交後是順從交處數去也又按交定度在七度以下食在正交也若以減正交定限度其所餘當在三百五十度內外爲陰曆交前度也勿庵曰非也若然則凡正交七度已下者永不入食限不必布算矣況所謂陰陽曆者自正交中交而斷【正交後爲陽中交後爲陰】所謂交前後者皆附近正交中交前後而斷【正交後爲陽曆交後正交前爲陰曆交前中交後爲陰曆交後中交前爲陽曆交前】交終度分爲陰陽曆陰陽曆又各分前後安得有陰曆交前度乃多至三百五十餘度者乎此必無之理亦必不可通之數也然則何以通之曰有法焉凡交定度在七度已下是其數不特在正交度下幷在中交度下也然而又與中交數逺幷亦不得減中交爲交前也夫在中交數下是陽曆非陰曆也不在交前是交後也夫陽曆交後度法當置交定度內減去正交定限度而此交定度數少不及減故必加入交終度而後可以減之也如入交終度減之則陽曆交後之度復其本位也則凡距交七度已下者皆得入陽食之限也然則歷經何以不云通軌何以闕載也曰是偶爾之遺也或姑略之以俟人之變通也或傳之久而失其眞原有闕文也夫夏五疑三豕徴信各行其是而已爲其恐誤後學也故訂之

推日食分秒法

視日食入陰陽曆交前交後度是陰者置陰食限八度是陽者置陽食限六度皆減去陰曆或陽曆交前交後度余【度定四十定三】爲實各以其定法是陰者置八十分陽者置六十分【去一】爲法約之【不滿法去一子所定有二子爲單分一子爲十秒】卽得所推日食分秒也如陰陽食限不及減交前交後度者皆爲不食也

按陰食限八度者陰曆距交八度內有食也陽食限六度者陽曆距交六度內有食也凡合朔若正當交度其食十分漸離其處食分漸少假如陽曆距交一度二十分則於食十分內減二分只食八分也又如陰曆初交二度四十分則於食十分內減三分只食七分也故各置陰陽食限以距交前後度減之卽是於食十分內減去若干分秒也其減不盡者則正是今所推合食之數故各以定法除之而得也凡陰陽定法皆十分食限之一也如食限不及減爲不食者是距交前後之度多於陰陽食限其去交甚逺不能相掩斷爲不食也

推日食定用分法

置日食分二十分內減去推得日食分秒余【十分定三單分定二】爲實卽以日食分秒【單分定二】爲法乘之【言十定一所定有六子爲百分五子爲十分】卽爲所推開方積也立天元一於單微之下依平方法開之得爲開方數【有十定一】復以五千七百四十分【定五】爲法乘開方數【言十定一】得數又以所推定限行度【去四子空度去三子】爲法除之【不滿法去一子所定有二子爲百分一子爲十分】卽爲所推定用分也

按定用分者日食虧初復末中距食甚所定用之時刻也凡日食若干分則其所經歷凡有若干刻食分深者歷時久以月所行之白道長也食分淺者歷時暫以月所行之白道短也今所求開方之數卽自虧至甚或自甚至復月行白道之率也

日食只十分今用二十分者何也日月各徑十分其半徑五分凡兩員相切則兩半徑聮爲一直綫正得十分爲兩心之距以此兩心之距爲半徑從太陽心爲心運規作大圓其外周各距日之邊五分爲日月相切時太陰心所到之界其大圓全徑正得二十分也

以日食分秒相減相乘何也此句股術中較求股法也依前所論初虧時兩圓相切其兩心之距十分此大圓之半徑常爲句股之食甚時兩心之距如句而太陰心侵入大圓邊之數如句較自虧至甚太陰心所行白道如股而太陰心侵入大圓邊之數與食分正同蓋月邊掩日一分則月心亦移進一分也故卽以日食分秒爲句較與大圓全徑二十分相減其餘卽爲句和和較相乘爲開方積卽股實也其開方數卽股亦卽自虧至甚月心所行之白道矣其自食甚至復光理同

五千七百四十分乘者何也先求日食分秒及句股開方等率皆就日體分爲十分其實日體不滿一度大約爲十之七耳五千七百四十者七因八百二十也月行一限得八百二十分其十之七則五百七十四分矣故以五百七十四分乘開方爲實以定限行度除之爲定用分之時刻也

以異乘同除之理言之月行定限行度歷時八百二十分則月行虧至甚之白道【卽開方數】該歷時有若干分然此所得開方數於度分爲十之七法當置開方數七因退位【如有十分只作七分】然後乘除今開方數不動而七因八百二十爲五千七百四十得數亦同【卽算術中異乘同乘之用】開方數之分是度下一位宜定三子七因八百二十而退位實爲五百七十四宜定二子今開方數不定子故於五千七百四十加交三子爲五子其乘除後定數同也

初虧時兩心之距爲【卽大員二十分半徑】食甚時兩心之距爲句食甚時月心侵入限內三分爲句較

自虧至甚月心所行白道爲股【甚至復亦同】此以月在陽曆日食三分爲例餘可仿推

推初虧復圓分法

置所推食甚定分內減去定用分爲初虧分不及減加日周【一萬】減之復置食甚定分如入定用分爲復圓分滿日周去之時刻依合朔法推之

按食甚者食之甚食之中也日月正相當於一度也初虧者虧之初食之始也月始進而掩日也復圓者復於圓食之終也月已掩日而退畢也凡言分者皆時刻也蓋初虧在食甚前幾刻故減小餘復圓在食甚後幾刻故加小餘初虧距食甚時刻正與食甚距復圓數等故皆以定用分加減之也月食仿此又按據加日周減滿日周去二語定用分當不止此數也

推日食起復方位法

視所推日食入陰陽曆如是陽曆者初起西南甚於正南復圓於東南也如是陰曆者初起西北甚於正北復圓於東北也若食在八分以上者無論陰陽曆皆初起正西復圓於正東也

按日食起復方位主日體言之卽人所見日之左右上下也以午位言則左爲東右爲西上爲北下爲南也日食入陰陽曆者主月道言之月在日道南爲陽曆月在日道北爲陰曆也如是陽曆食是月在日南掩而過故食起西南甚於正南復於東南也如是陰曆食是月在日北掩而過故食起西北甚於正北復於東北也其食在八分已上者是月與日相當一度正相掩而過故食起正西復於正東其食甚時正相掩覆而無南北不言可知也凡日月行天並自西而東日速月遲其有食也皆日先在東月自西追而及之旣相及矣則又行而過於日出於日東故日食虧初皆在西復末皆在東也又按歷經云此所定起復方位皆自午地言之其餘處則更當臨時消息也推帶食分法

視朔下盈縮歷與太陽立成同日之日出入分如在初虧分已上食甚分【按食甚當作復圓】已下爲帶食之分也若是食在晨刻者置日出分昏刻者置日入分皆與食甚分相減余爲帶食差也置帶食差【百定六十定五】以所推日食分秒【十定五單定四】爲法乘之【言十定一】得數復以所推定用分【百去六子】爲法除之【不滿法去一子所定有五子爲十分四子爲單分三子爲十秒】得數去減所推日食分秒余上下兩處皆爲帶食已見未見之分也按帶食分者日出入時所見食分進退之數也假如日出分在初虧分已上是初虧在日未出前但見食甚不見虧初也日入分在初虧已上是食甚在日入後但見虧初不見食甚也又如日出分在復圓分已下是食甚在日未出前不見食甚但見復末也日入分在復圓分已下是復圓在日入後不見復末但見食甚也見食甚不見虧初是食在未出已有若干尙有見食若干帶之而出其食爲進也見初虧不見食甚是食在未入見有若干尙有不見食若干帶之而入其食亦爲進也不見食甚但見復末是食在未出前已復若干尙有見復光若干帶之而出甚食爲退也不見復末但見食甚是食在未入前見復若干尙有未復光若干帶之而入其食亦爲退也凡此日出入所帶進退分秒何以知之則視其帶食而出爲晨刻者置日出分其帶食而入爲昏刻者置日入分皆以食甚分與之相減而得帶食之差也假如日出分在初虧分已上其食甚分又在日出分已上則以日岀分減其食甚分其減不盡者則是日出已後距食甚之時刻也若日入分在初虧分已上其食甚分又在日入分已上則以日入分減其食甚分其減不盡者則是日入已後距食甚之時刻也又如日出分在復圓分已下其食甚分又在日出分已下則於日出分內減去食甚分其減不盡者則是日出已前距食甚之時刻也若日入分在復圓分已下其食甚分又在日入分已下則於日入分內減去食甚分其減不盡者則是日入已前距食甚之時刻也凡此帶食差分用乘日食分秒又以定用分除之便知日出入時所距食甚時刻在定用分全數內占得幾許卽知日出入時所帶食分於日食分秒全數內占得幾許也以其數減食分所餘分秒卽是日出入前距虧初已過食分或日出入後距復末未見食分也上下兩處者得數與減余兩處之數已見未見之分卽已復未復已食未食如後二條所列也

日有帶食例

置日出入分內減去食甚分謂之已復光未復光將所推帶食分錄於前

晨【日未出已復光若干日已出見復光若干】

昏【日未入見復光若干日已入未復光若干】

置食甚分內減去日出入分謂之見食不見食將所推帶食分錄於後

晨【日未出已食若干日已出見食若干】

昏【日未入見食若干日已入不見食若干】按置日出入分內減去食甚分者其日出入分皆在復圓分已下也故謂之已復光未復光假如日食甚五分在日出入前其帶食三分以之相減尙餘二分若在晨刻是日未出前已復光三分日已出後見復光二分也若在昏刻是日未入前見復光三分日已入後未復光二分也此二端帶食分皆是已復光數故錄於前也其以帶食分減之而餘者則是未復光數故錄於帶食之後也置食甚分內減去日出入分者其日出入分皆在初虧分已上也故謂之見食不見食假如日食甚五分在日出入後其帶食三分以之相減尙餘二分若在晨刻是日未出前已食二分日已出後見食三分也若在昏刻是日未入前見食二分日已入後不見食三分也此二端帶食分皆是未食數故錄於後也其以帶食分減之而餘者則是已食數故錄於帶食之前也月食仿此但以日之昏爲月之晨以日之晨爲月之昏蓋日出於晨入於昏月出於昏入於晨也其餘並同

推黃道定積度法

置所推食甚入盈縮歷行定度如是盈歷者內加入天正黃道箕宿度共得爲黃道定積度也如是縮歷者內加入半嵗周及天正箕宿黃道度共得爲黃道定積度也按黃道定積度者逆計食甚日躔度距天正冬至日躔宿度積數也盈歷加入天正黃道箕度者是逆從天正冬至所躔宿初度積算起也縮歷復加半嵗周者縮歷本數是從夏至度起算今加入半嵗周又加入天正箕宿度是變而如盈歷亦從天正冬至箕宿初度起算也所得定積度卽是今所躔宿度與箕宿初度相距逺近之數也

推食甚日距黃道宿次度法

置所推黃道定積度無論盈縮歷皆以黃道各宿次積度鈐挨及減之餘爲食甚日躔黃道某宿次度分也按所推黃道定積度無問盈縮皆是今食甚躔度前距箕宿初度之積數也然尙未知其爲黃道何宿度也故以黃道各宿積度鈐取其相挨及者減之其減去者是今積度內已滿其宿之度日躔已過此宿斷爲前宿也其不及減而餘者則是前宿算外所餘度分也是日躔正在此宿中未過故其積度亦未滿當卽以所減算外之度分斷爲食甚日躔某宿幾度幾分也假如食甚定積十度則以箕宿積度九度五九減之餘○度四十一分爲箕宿算外餘數斷爲食甚日躔黃道斗宿初度四十一分也餘仿此

黃道各宿次積度鈐

箕九度【五九】

斗三十三度【○六】牛三十九度【九六】女五十一度【○八】虛六十○度【○八太】危七十六度【○三太】室九十四度【三五太】壁一百○三度【六九太】奎一百廿一度【五六太】婁一百三十三度【九二太】胃一百四九度【七三太】昴一百六十度【八一太】畢一百七七度【三一太】觜一百七七度【三六太】參一百八七度【六四太】井二百十八度【六七太】鬼二百廿○度【七八太】栁二百三十三度【七八太】星二百四十度【○九太】張二百五七度【八八太】翼二百七七度【九七太】軫二百九六度【七二太】角三百○九度【五九太】亢三百十九度【一五太】氐三百三十五度【五五太】房三百四一度【○三太】心三百四七度【三○太】尾三百六五度【二五太】

按黃道積度鈐皆自箕初度積至其宿垜積之數也假如日躔斗二十三度四七加入箕宿九度五九則已共積得三十三度○六也又如日躔牛六度九十分如入斗二十三度四七又如入箕九度五九共積得三十九度九六也餘仿此又按凡言鈐者皆豫將所算之數幷其已前之數垜積而成以便臨算取用意同立成也𨿽然黃道不可以立鈐算者當知黃道度之所由生則可以斷其是非矣蓋黃道積度生於其宿黃道度各宿黃道度皆生於赤道赤道三百六十五度二五七五黃道亦三百六十五度二五七五而其各宿度數不同者則以二至二分所躔不同也赤道近二至則其變黃道度也損而少赤道近二分則其變黃道度也益而多蓋赤道平分天腹適當二極之中所紀之度終古不易黃道不然其冬至則近南極在赤道外二十三度九十分其夏至則近北極在赤道內亦二十三度九十分其自南而北自赤道外而入於其內也則交於春分之宿其自北而南自赤道內而出於其外也則交於秋分之宿交則斜以斜較平視赤道之度必多此處旣多則二至黃道視赤道之數必少理勢然也【二至赤道以斂小之度當黃道大度已詳天正箕宿注】黃道之損益旣系於分至分至旣以嵗而差黃道積度是必毎嵗不同古人則旣言之矣此所載者猶據授時歷經所測黃道之度乃至元辛巳一年之數也上考下求數十年間則皆有所不合況距今三百八十餘算積差尢多安得海制此鈐以盡古今之無窮乎今仍以授時歷經黃赤道差法求得天啟辛酉年黃道積度如左

依授時歷經求得天啟辛酉年黃道積度

天正冬至赤道箕宿四度九○

赤道四象積度

箕五度【五】

斗三十○度【七】

牛三十七度【九】女四十九度【二五】虛五十八度【二○太】危七十三度【六○太】室九十○度【七○太】壁九十一度【三一四三太】

右冬至後一象之度

壁七度【九九三一少】

奎二十四度【五九三一少】婁三十六度【三九三一少】胃五十一度【九九三一少】昴六十三度【二九三一少】畢八十○度【六九三一少】觜八十○度【七四三一少】參九十一度【三一四三太】

右春分後一象之度

參初度【五二八太】

井三十三度【八二八太】鬼三十六度【○二八太】栁四十九度【三二八太】星五十五度【六二八太】張七十二度【八七八太】翼九十一度【三一四三太】

右夏至後一象之度

翼初度【三一四三太】

軫一十七度【六一四三太】角二十九度【七一四三太】亢三十八度【九一四三太】氐五十五度【二一四三太】房六十○度【八一四三太】心六十七度【三一四三太】尾八十六度【四一四三太】箕九十一度【三一四三太】

右秋分後一象之度

黃道積度

箕五度【○七】

斗二十八度【七一】牛三十五度【六九】女四十六度【九五】虛五十六度【○六太】危七十二度【二○太】室九十○度【六五太】壁九十九度【九八太】奎一百十七度【七一太】婁一百二十九度【九三太】胃一百四五度【五四太】昴一百五六度【四八太】畢一百七二度【八二太】觜一百七二度【八七太】參一百八三度【一一太】井二百十四度【三五太】鬼二百十六度【四八太】栁二百二十九度【六五太】星二百三十六度【○四太】張二百五四度【○五太】翼二百七四度【二八大】軫二百九二度【九五太】角三百○五度【六八太】亢三百十五度【一二太】氐三百三十一度【三二太】房三百三十六度【七三太】心三百四二度【九三太】尾三百六十度【七四太】箕三百六五度【二五太】

天正冬至黃道箕宿四度五一二○

黃道各宿度

角十二度【七三】亢○九度【四四】氐十六度【二】房○五度【四一】心○六度【二】尾十七度【八一】箕○九度【五八】

右東方七宿七十七度三十七分

斗二十三度【六四】牛○六度【九八】女十一度【二六】虛○九度【一太】危十六度【一四】室十八度【四五】壁○九度【三三】

右北方七宿九十四度九十一分太

奎十七度【七三】婁十二度【二二】胃十五度【六一】昴一十度【九四】畢十六度【三四】觜初度【○五】參一十度【二四】

右西方七宿八十三度一十三分

井三十一度【二四】鬼○二度【一三】栁十三度【一七】星○六度【三九】張十八度【○一】翼二十度【二三】軫十八度【六七】

右南方七宿一百○九度八十四度

黃道各宿次積度鈐

箕九度【五八】

斗三十三度【二二】牛四十○度【二】女五十一度【四六】虛六十○度【五七太】危七十六度【七一太】室九十五度【一六太】壁一百○四度【四九太】奎一百二十二度【二二太】婁一百三十四度【四四太】胃一百五十度【○五太】昴一百六十度【九九太】畢一百七七度【三三太】觜一百七七度【三八太】參一百八七度【六二太】井二百十八度【八六太】鬼二百二十度【九九太】栁二百三十四度【一六太】星二百四十度【五五太】張二百五八度【五六太】翼二百七八度【七九太】軫二百九七度【四六太】角三百一十度【一九太】亢三百十九度【六三大】氐三百三十五度【八二太】房三百四一度【二四太】心三百四七度【四四太】尾三百六五度【二五太】

已上度鈐據天啟辛酉嵗差所在步定俟嵗差移一度時再攺步之又按歷經有增周天加嵗差法因前所推俱依通軌故仍之

歷算全書卷二十二﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

欽定四庫全書

歷算全書卷二十三

宣城梅文鼎撰

歷學騈枝卷三

月食通軌

錄各有食之望下數

經望全分

盈縮歷全分

盈縮差全分遲疾歷全分

遲疾限數

遲疾差全分加減差全分

定望全分【將本日日出分推在卯時何刻望在何刻已下者退一日也說見定朔望條夘時舉例言也按其定望退一日只據小餘在日出分已下斷之並不必求時刻】入交泛日全分定入遲疾歷

定入遲疾限【此限與前仝者便不必書出損益分並行度○按此處損益分不言何用似總不必書出】

定限行度

晨分【月入之時刻也先於復圓有帶食】日出分

日入分

昏分【月出之時刻也後於初有帶食】

【按晨昏分所以定更防也其帶食分只用日出入分不用晨分蓋晨昏日未出月則猶見昏前日已入月則已見也注誤】

天正赤道度天正黃道度

交常度交定度已上諸法皆與日食同

推夘酉前後分法

視定望小餘如在二千五百分已下者就爲夘前分若已上者去減半日周五千分爲夘後分又如在七千五百分已下者內減去五千分爲酉前分已上者去減日周一萬分爲酉後分

按凡夘酉前後分皆距子午言之夘前分是距子正後之分故卽以小餘定之夘後分是逆數午正前之距分故以小餘減半日周酉前分是順數午正後之距分故以半日周減小餘酉後分是逆數子正前之距分故以小餘減日周

推時差分法

置日周一萬內減去夘前夘後分或酉前酉後分【滿千分者命爲十分滿百分者命爲單分】爲時差分

推食甚定分法

置所推時差分如入定望小餘共得爲食甚定分按日食气刻時三差皆起於唐宣明歷非月食所用後來諸歷或有用月食時差者皆於近夘酉則差多近子午則差少又皆子前減子後加今依通軌所推則近夘酉者差反少近子午者差反多又不問子前子後皆以加定望小餘而無減法種種與歷經相反竊依元史月食時差法定之如左

依歷經求月食甚定分法

置卯酉前後分【有千法實皆定三有百法實皆定二】自相乘【言十加定一子】退二位去二子如四百七十八而一【去二子不滿法去一子以所定二子爲百分一子爲十分】爲時差子前以減子後以加皆加減定望分爲食甚定分依發斂加時求之卽食甚時刻

按卯酉前後分卽前所推卯前卯後分或酉前酉後分自相乘者如求南北差法卽以所得卯酉前後分爲法與實也凡卯酉前後分皆自子午起算以自相乘則近卯酉差多近子午差少矣退二位法同日食時差以得數後有百萬退作萬有十萬退作千而後除之也如四百七十八而一者是以四百七十八除之如四百七十八分爲一分也子前減子後加者凡望時之月在日所衝故日在子前月乃在午前日食午前減故月食亦子前減也日在子後月乃在午後日食午後加故月食亦子後加也其差多者不過一百三十分有奇而止故以四百七十八爲法除之也推食甚入盈縮歷及食甚入盈縮差並食甚入盈縮歷行定度三法俱與日食同只換望日

推月食入陰陽曆法

視所推交定度如在交中度一百八十一度八九六七已下者便爲入陽曆也如在已上者內減去交中度余爲入陰曆也

按交中度數原生於陰陽曆月入陽曆則在黃道南行一百八十一度有奇畢復入黃道北而行陰曆一百八十一度有奇畢則又復入陽曆矣行陽曆陰曆各一次謂之交終半之爲交中今交定度在交中度已下是月在黃道南就爲入陽曆度數也其在已上者是月在黃道北故於交定度內減去交中度命其餘爲入陰曆度數也陽曆數自交初起算陰曆數自交中起算也

推交前交後度法

視所推月食入陰陽曆如在後凖一十五度五十分已下者便爲交後度也如在前凖一百六十六度三九六八已上者置交中度內減去陰陽曆余爲交前度也按凡言交者皆月出入黃道斜十字相交之際也凡陰曆在後凖已上者是月入陰曆去交未逺尙在十五度內故爲陰曆交後度也凡陰曆在前凖已上者是將交陽曆距交已近只在十五度內故爲陰曆交前度也陽曆同月食限只一十三度○五分而此言十五度五十分者蓋以盈縮差加減之則亦十三度有奇故以十五度五十分爲食凖也

推月食分秒法

置月食限【一十三度五分】內減去交前或交後度【十度定三單度定二按定子法疑有誤若如所云則月食必無十分者安得有旣內外之分乎愚意當是十度定五單度定四也】

以定法八十七分【去一】爲法除之【不滿法去一子所定有三子爲十分二子爲單分】爲月食分秒不及減者不食十分已下者用三限辰刻法已上者用五限辰刻法

按月食限度多於日食者闇虛大而月小也故不問陰陽曆但距交前後一十三度○五分內卽能相掩而有食也定法八十七卽食限十五分之一故定望正當交度其食十五分漸離其處食分漸殺假如距交前後一度七十四分則於食十五分內減二分只十三分又如距交前後九度五十七分則於食十五分內減十一分只食四分也故置食限以距交度減之卽於食十五分內減去若干分秒減不盡者如定法而一爲所食之分秒也如食限不及減則是距交前後度多於月食限【已在十三度○五分之外】闇虛𨿽大至此不能相掩斷不食也

推月食定用分法

置月食分三十分內減去所推月食分秒余【十分定三單分定二】爲實卻以月食分秒【十分定三單分定二按十分宜定一今加定三子者以分下有十有秒也故亦以定六子爲百分法實共加定四子也】爲法乘之【言十定一定有六子爲百分五子爲十分】得爲開方積立天元一於單微之下依平方法開之得爲開方數【言十定一】復以四千九百二十分【定五按以六分乘八百二十分得四千九百二十分又按元史數同日食】爲法乘開方數【有十定一】得數又以其前推得定限行度【去四子空度去三子】爲法除之【不滿法去一子定有二子爲百分一子爲十分】得數爲所推定用分也

定用分者月食自初復滿距食甚之時刻也然日食只十分而月食則有十五分者闇虛大也闇虛之大防何曰大一倍何以知之以算月食用三十分知之也依日食條論兩員相切法闇虛半徑十分月半徑五分兩邊相切則兩半徑聫爲一直綫共十五分爲兩心之距以此距綫用闇虛心爲心運作大圓正得全徑三十分也此大圓邊距闇虛邊四周各五分爲兩圓相切時月心所到之界其兩心之距十五分卽大圓半徑常用爲而以食甚時兩心之距爲句食甚時月心侵入大圓邊之數爲句較其數與月食分秒同以此與大圓全徑相減余卽句和和較相乘爲股實開方積也其開方數爲股卽自復至食甚月心所行之白道也

四千九百二十乘者何也依日食條論又是十分八百二十而用其六也蓋所得月體又小於日一分也然歷經所用與日食同此不同者蓋攺率也或亦攺三應數時所定

推三限辰刻等法

置所推食甚定分內減去定用分余爲初分也不及減者加日周減之復置食甚定分內加入定用分共得爲復圓分也滿日周去之時刻依合朔推之

按三限辰刻同日食理不復贅

初時兩心之距爲【卽大員三十分半徑】

食甚時兩心之距爲句

食甚時月心侵入大員界八分爲句較

自至甚月心所行之度分爲股【甚亦復亦同】

此以月食八分爲例餘可仿推

又此系陽曆故月在闇虛南若陰曆反此論之

推旣內分法

置月食限一十五分【按歷經作月食旣一十分今從之】內減去所推月食分秒自單以下全分余【十分定三單分定二句誤按此處無十分當是有分定二十秒定一也】爲實卻以月食分秒自單分以下分秒【單分定二十秒定一】爲法乘之【言十定一所定有五子爲十分四子爲單分】得爲開方積立天元一於單微之下依平方法開之得爲開方數就置開方數【十分定五單分定四按十分定五句誤此處開方數必無十分當作十秒定三有分定四也分加定四子者以有秒防也】復以四千九百二十分【定五】爲法乘之【言十定一】得數又以所推定限行度【去四子空度去三子】爲法除之【不滿法去一子所定有六子爲百分五子爲十分】得爲所推旣內分也

按歷經原是以旣內分與一十分相減相乘此則攺爲一十五分今以大圓掩小圓率求得旣內小平圓徑一十分與歷經合故斷從歷經

月食十分則旣矣此時月體十分全入闇虛而月之邊正切闇虛之心兩心之距正得五分以得五分爲半徑自闇虛心作小平圓其全徑十分其邊各距闇虛心五分爲食旣時月心所到之界過此界則爲旣內矣假如月食十二分食旣時月心正掩小圓之邊食甚時月體則入闇虛內二分而月心亦侵入小平圓二分故卽用此二分爲句較以與小平圓全徑相減余爲句和和較相乘得積開方得股卽月心從食旣至食甚在闇虛內所行小平圓內之白道也於是亦如前法變爲度分而計其行率則知月入闇虛以後行至食甚所歷時刻之數而命爲旣內之分也食甚至復圓同論

乙爲闇虛心初虧時月心在甲以其邊切闇虛於庚兩心之距爲乙甲與壬乙等大員半徑十五分也爲大食甚時月心行至丁丁甲度分爲自虧至甚之行與甚至復丁戊之行等爲大股丁乙三分食甚時兩心之距爲句壬丁十二分食甚時月心侵入大圓內之數也爲句較

食旣時月心在丙兩心之距乙丙與生光時己乙之距等小圓半徑五分也爲小丙丁爲月心自旣至甚之行與甚至生光己丁之行等爲小股丁乙仍爲句午丁二分爲食甚時月心侵入小員之數爲句較丙至丁所歷時刻與己至丁時刻等是爲旣內分甲至丙所歷時刻與己至戊等是爲旣外分此以陰曆月食十二分爲式餘皆仿論開方數

壬丁十二丁癸十八相乘二一六平方開之得丁甲十四【六九】午丁二分丁辰八分相乘十六平方開之得丁丙四分

推旣外分法

置所推定用分內減去旣內分余爲旣外分也

按旣外分者是月食初虧至食旣生光至復圓所歷時刻也原所推定用是自虧初復末中距食甚之數乃旣內旣外總數也故於其中減去旣內時刻其餘卽旣外時刻

推五限辰刻等法

置食甚定分內減去定用分爲初虧分初虧分加旣外分爲食旣分食旣分加旣內分爲食甚分食甚分加旣內分爲生光分生光分加旣外分爲復圓分也不及減者加日周減之滿日周去之推時刻同前

按月食有五限辰刻異於日食者日食只十分故其食而旣也卽其食甚也才食而旣其光卽生則其生光之分亦卽其食甚也若月食則十五分自食旣以至生光歷時且久爲刻皆殊中折二數以知食甚總計虧復故有五限也以定用減小餘者所算定用原是食甚距初虧之數也故以減食甚得初虧以旣外加初虧及生光者所算旣外原是初虧距食旣及生光距復圓數也故以加初虧得食旣以加生光得復圓至於所算旣內原是食旣至生光折半之數卽是食旣生光中距食甚之數也故以加食旣得食甚以加食甚得生光不及減加日周者是食甚在子正後初虧等在子正前也加滿日周去之者是食甚等在子正前復圓等在子正後也凡言時刻同前者皆依發斂加時推法也

推月食入更防法

視望下盈縮歷與太陽立成同日之晨分就加一倍得數用五千分而一【句誤按當作五而一下同】得爲更法分也【定數滿法得千分不滿法得百分也】將更法又用五千分而一得爲防法分也【定數滿法得百分不滿法得十分也句誤甚按當作滿法者百已上不滿法者二百已上也大約更法有幹者則不滿法】

按更防倍晨分者凡日入後二刻半而昏日未出前二刻半而晨晨則辧色未昏則不禁行晨昏啟閉以此爲節是益晝五刻損夜五刻聖人扶抑之道無所往而不存也其晨分皆自子正距晨之數夜之有晨分猶日之有半晝分也逆推子正前距昏之數正與相等故倍其晨分卽爲夜刻也於是以五除之卽其夜每更所占時刻之數也假如晨分二千五百倍之五千五除之則知每一更中占有一千分也滿法者是在五千分已上故知得數爲千分不滿法者是在五千分已下故知得數爲百分於是又置更法以五除之卽其夜每防所占刻數也假如更法分一千五除之則知每防中占有二百分也其防法得數無論滿法不滿法總是百分不必定數又除法只是單五每夜五更每更五防故以五除之也

推初虧等更防法

視初虧分如在晨分已下者就加入晨分共爲初虧更分也如在昏分已上者內減去昏分余爲初虧更分也卻以元推更法分爲法除之命起一更算外得爲初虧更數也其不及更法數者卻以元推防法分爲法除之命起一防算外得爲初虧防數也次四限更防仿此而推各得更防也【若在日入以上昏分以下者命爲昏刻若在日出以下晨分以上者命爲晨刻皆無更防】

按初虧等分如在晨分已下者是在子後也加入晨分是逆從子前昏刻算起也其在昏分已上是在昏後也故減去昏分是減去晝刻截從初昏算起也二者總是從初更初防起算【初更初防卽一更一防】加減後得數卽知今距初更初防已若干數於是以本日更法除之其滿過更法有防數便知已過防更故算外命爲更數也其不滿更法而餘者則正是初入此更以來未滿之數故又以防法除之其滿過防法有防數便知在此更中已過防防故算外命爲防法便知所推初虧等尙在苐防更苐防防中未滿也其有總不滿更法數者則只是初更其有以防法除總不滿法者則只是初防也

推月食起復方位法

視月食入陰陽曆如是陽曆者初起東北食甚正北復圓於西北也如是陰曆者初起東南食甚正南復圓於西南也若食在八分已上者無論陰陽曆皆初起正東復圓於正西也

按月食起復方位主月體言之卽人所見月之上下左右也以卯位言之則東爲下西爲上北爲左南爲右以酉位言之則東爲上西爲下南爲左北爲右也月食入陰陽曆亦主月道言之如是陽曆食是月在日道南其入闇虛被掩者在北故食起東北甚於正北復於西北也如是陰曆食是月在日道北其入闇虛被掩者在南故食起東南甚於正南復於西南也其食在八分已上者是月入闇虛正相掩而過故食起正東復於正西也凡闇虛在日所衝太陽每日行一度闇虛隨之而移月之行天旣視闇虛爲速故其食也皆闇虛先在東月自西來道有必經無所於避遂入其中而爲所掩旣受掩矣則行而出於闇虛之東卻視闇虛又在月西故月食虧初皆在東復末皆在西也又按歷經此亦據午地言之

推月有帶食分法同日食推

月有帶食例

昏【月未出已復光若干月已出見復光若干】

晨【月未入見復光若干月已入未復光若干】昏【月未出已食若干月已出見食若干】

晨【月未入見食若干月已入不見食若干】按月帶食法同日食而只互易其晨昏書法者何也蓋月食於望望者日月相望故日出則月入月出則則日入故易日之昏爲月之晨易日之晨爲月之昏也其所以同者何也假如日入分在復圓分已下是復圓在日入月出後於日爲見食甚不見復末者於月則爲見復末不見食甚也若日出分在復圓分已下是復圓在日出月入後於日爲見復末不見食甚者於月則爲見食甚不見復末也之二者總是以食甚分減日出入分其所推帶食則總是日月出入前距食甚之數其以減食分而餘者亦總是日月出入後未復光之數故總謂之已復光未復光而以所推帶食分錄於前也又如日入分在初虧分已上是初虧在日入月出前於日爲見虧初不見食甚者於月則爲見食甚不見虧初也若日出分在初虧分已上是食甚在日出月入後於日爲見食甚不見虧初者於月則爲見虧初不見食甚也之二者總是以日出入分減食甚分其所推帶食分則總是日月出入後距食甚之數其以減食分而餘者亦總是日月出入前已食之數故總謂之見食不見食而以所推帶食分錄於後也【余詳日食】又按歷經月食旣者以旣內分減帶食差余進一位如旣外分而一以減旣分卽帶食出入所見之分不及減者爲帶食旣出入蓋凡所推帶食差是食甚所距日出入時刻今以旣內分減之而餘者卽是日出入後距食旣前或日出入前距生光後其間所有時刻也進一位者卽是以旣分乘之也又以旣外分除之則知其食旣生光距日出入時於旣外全數中分得防許時刻卽知其於食旣全數內分得防許食分也故以減食旣十分卽爲帶食出入之食分也不及減者是帶食差少於旣內分其日出入分已在旣內分內故爲帶食旣出入也

推食甚月離黃道宿次度法

置元推食甚入盈縮歷行定度全分如是盈歷者加半周天一百八十二度六二八七五及天正黃道箕宿度其得爲黃道定積度也如是縮歷者止加天正黃道箕宿度內減去七十五秒余爲黃道定積度也無論盈縮歷皆以其黃道各宿次積度鈐挨及減之餘爲食甚月離黃道某宿次度分也

按月食黃道定積度者逆計月離度前距天正日躔宿度之數也元推食甚入盈縮歷行定度則是所求日躔距天正宿度乃月食所衝也如日在北正月食於南正故盈歷加半周天便是食甚月離宿度又加天正箕宿度便知食甚月離距黃道箕宿初度若干也其縮歷行定度則是日躔距夏至度數故卽用其數爲月離蓋月食日衝日躔夏至宿後第防度月食卽亦在冬至宿後第防度故不必加半周天也內減去七十五秒者盈歷縮歷相距半嵗周不及半周天七十五秒減黃道積度鈐法仝日食不贅

依授時歷經黃赤道法【勿庵補定】

求四正後赤道積度

置天正冬至所在宿赤道全度以天正赤道減之餘爲距後度以赤道宿度累加之卽各得其宿距冬至後赤道積度加滿象限去之爲四正宿距後度亦以赤道宿度累加之滿象限去之卽各得其宿距春分夏至秋分後赤道積度

按四正者四仲月中气卽二至二分也凡天正赤道度是天正冬至前距其宿初度之數故以減其宿全度卽各得冬至後距其宿末度之數也於是以後宿赤道累加之卽知冬至後各宿距冬至度所積之數也滿象限去之者加滿象限是其宿當四正所躔故減去象限卽知四正後距其宿末度之數也於是又以赤道各宿度累加之卽各得四正後各宿所距四正度之數也

求赤道變黃道

置各宿距四正後赤道積度用黃赤道立成視在至後者以第三格赤道積度相挨者減之餘【有十定三有分定二】爲實以其上第二格黃道率乘之【不用乘只加定四子】以下第四格黃道率爲法除之【有度去四有十去三不滿法再去一視定有四子爲度三子爲十分】加入第一格黃道積度卽爲其宿距至後黃道積度其夏至後再加周半天卽各得其宿距天正黃道積度也若在分後者以第一格赤道積度相同者減之只用小餘【有十定三有分定二】爲實以下第四格黃道率爲法【有度定四○度定三】乘之【言千定一】得數以其上第二格赤道率除之【不用除只去四子視定有四子爲度三子爲十分】加入第三格黃道積度卽得其宿距分後積度其春分後再加一象限秋後分再加三象限卽各得其宿距天正黃道積度也於是各置其宿距天正黃道積度以相挨前一宿黃道積度減之卽各得其宿黃道本度也【秒就近約爲分】

按至後不用乘者其立成黃道率只是一度乘過數不動故只加定四子也分後不用除者其立成赤道率亦是一度除過數亦不動故只虛去四子也夏至後加半周天春分後加一象限秋分後加三象限者此所求黃道積度皆距四正起算故各以四正距天正黃道數加之卽其宿前距天正之數也蓋至後黃道𨿽減於赤道分後黃道𨿽加於赤道其實至四立之後則加之極而反減減之極而反加總計一象皆得九十一度有奇此天道如環平陂往復間不容髮也減前宿積度爲其宿本度者積度卽是距天正數原包前宿在內故減之卽得本度也【秒就近約爲分者凡秒五十已上收爲分已下棄之就整數也其七十五秒寄虛度】

求天正冬至黃道度

置周天度【三百六十五度二五七五】內減天正前一宿距天正黃道積度余命爲天正冬至宿黃道度分也若逕求者置象限以其年天正赤道度減之餘爲天正前宿距秋分後赤道積度依赤道變黃道法求出其宿距分後黃道積度以減象限余爲天正黃道度

按周天度是自天正後積至天正前黃道總數故減去前宿距天正黃道積度卽得天正距所在宿初度之數也逕求法置象限者卽是自天正前距秋分後赤道總數也內減去天正赤道度其餘卽是前宿距秋分後赤道積度也赤道變黃道法卽是以立成第一格積度減余以第四格度率乘以第二格度率除加入第三格積度而命爲前宿距秋分後黃道積度也又以減象限者此所爲象限卽是自天正前距秋分後黃道總數故減去前宿距秋分黃道積度其餘卽是天正冬至距其宿初度黃道之數也

求黃道宿積度定鈐

置天正冬至宿黃道度及分加入其宿距至後黃道積度及分共得爲天正冬至宿黃道定積度以各宿黃道度累加之卽各得其宿黃道定積度

按分至每嵗有差黃道因之而易卽不能每嵗步之當於六十六年嵗差一度時更定度鈐始爲無也凡冬至所在宿皆有前後距其黃道皆減於赤道今所推其宿至後積度是自冬至日躔後距其宿末度黃道數其天正黃道宿度則是自冬至日躔前距其宿初度黃道數也合二數爲其宿初度距其末度總數故卽命爲天正宿定積度也於是以各宿黃道度累加之卽所得其宿所距天正宿初度之數而命爲定積度也

求日月食甚宿次黃道度及分秒法同通軌

又術置所推食甚盈縮歷縮歷加半周天爲黃道定積度月食盈縮歷俱加半周天滿周天分去之爲黃道定積度皆逕以距天正黃道積度相挨者減之卽各得日月食甚黃道宿度及分秒

按此法不用定積度鈐故亦不加天正黃道度然必每年步定黃道積度方可用之也

赤道宿度

角十一度【一○】亢○九度【二○】氐十六度【三○】房○五度【六○】心○六度【五○】尾十九度【一○】箕一十度【四○】

右東方七宿七十九度二十分

斗廿五度【二○】牛○七度【二○】女十一度【三五】虛○八度【九五太】危十五度【四○】室十七度【一○】壁○八度【六○】

右北方七宿九十三度八十分太

奎十六度【六○】婁十一度【八○】胃十五度【六○】昴十一度【三○】畢十七度【四○】觜○○度【五】參十一度【一○】

右西方七宿八十三度八十五分

井三十三度【三○】鬼○二度【二○】栁十三度【三○】星○六度【三○】張十七度【二五】翼十八度【七五】軫十七度【三○】

右南方七宿一百○八度四十分

黃赤道立成

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十三﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十三﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十三﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十三﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十三﹥

歷算全書卷二十三

欽定四庫全書

歷算全書卷二十四

宣城梅文鼎撰

歷學駢枝卷四

盈縮歷立成

太陽冬至前後二象盈初縮末限

太陽夏至前後二象縮初盈末限

布立成法

歷經盈縮招差法

太陰遲疾立成

布立成法

求每限月平行度法

歷經遲疾歷三差法

日出入晨昏半晝分立成

冬至後半嵗周

夏至後半嵗周

考立成法

太陽冬至前後二象盈初縮末限

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥

【置本限八十八度九○九二二五加入盈積度二度四○一四卽合周嵗一象限九十一度三一○六二五之數】

太陽夏至前後二象縮初盈末限

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥

【置本限九十三度七一二○二五減去縮積度二度四○一四卽合周嵗一象限九十一度三一○六二五之數】布立成法

先依歷經盈縮招差各以其日平差立差求到每日盈縮積次以相挨兩日盈縮積相減余爲每日盈縮加分以其日加分盈加縮減一度卽每日日行度又以兩日加分相減余爲每日平立合差再置末日平立合差以初日平立合差減之餘爲實末日日數爲法法除實卽得每日平立合差之差數也【如盈初置八十七日下平立合差六分五五六八內減初日四分九三八六餘一分六一八二爲實八十七日爲法除之得○一八六爲每日之差縮初置九十二日下平立合差五分九二六六內減初日四分四三六二餘一分四九○四爲實九十二日爲法除之得○】

【一六二爲每日之差】又法【盈初置立差三十一縮初置立差二十七各六因之卽得每日平立合差之差數】

歷經盈縮招差法

凡求盈縮積皆以入歷初末日乘立差得數用加平差再以初末日乘之得數以減定差餘數復以初末日乘之得數萬約爲分卽各得其日盈縮積

太陰遲疾歷立成

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥

布立成法

依歷經垜疊招差各以平差立差求到各限遲疾度次以相挨兩限遲疾度相減余爲各限損益分次以各限損益分加減每限月平行度得爲各限遲疾行度也數止秒秒以下不用其加減法在疾歷益加損減遲歷反之

求每限月平行度法

置小轉中【十三日七七七三】以每日月平行度【十三度三六八七五】乘之得【一百八十四度一八五二七九三七五】爲實以一百六十八限除之得一度○九六三四○九四是爲每限月平行度也

歷經遲疾歷三差法

立差三百二十五

平差二萬八千一百

定差一千一百一十一萬

凡推遲疾在八十四限以下者爲初限以上者去減一百六十八限余爲末限置立差以初末限乘之得數用加平差再以初末限乘之以減定差餘數再以初末限乘之得數滿億爲度卽得各限遲疾積度【凡初限是從初順數至後末限是從未盡日逆溯至前故其數並同也】

月與日立法同但太陽以定气立限故盈縮異數太陰以平行立限故遲疾同原

日出入晨昏半晝分立成

冬至後半嵗周

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥

夏至後半嵗周

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十四﹥

考立成法

以半晝分轉減五千分【半日周】余爲日出分日出分減去二百五十分爲晨分以晨分減日周一萬分余爲昏分昏分減去二百五十分爲日入分

又防法【晨分與昏分相並成日周一萬又日出分與日入分相並亦成日周一萬】

歷算全書卷二十四﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

交防管見小引

交食爲驗歷大端其事之著者有三一曰食分深淺一曰加時早晚一曰起復方位古法至授時立法已詳新法有西洋所測更密幾於無可復議獨其所謂起復方位並以東西南北爲言【如日食八分以上初虧正西復圓正東八分以下陽曆初虧西南食甚正南復員東南陰曆初虧西北食甚正北復員東北月食八分以上初虧正東復員正西八分以下陽曆初虧東北食甚正北復員西北陰曆初虧東南食甚正南復員西南之類】而東西南北並以日月光體中心爲主故其邊向北極處斯謂之北向南極處斯謂之南而東西從之亦以日月之邊向東升處卽謂之東向西沒處卽謂之西此中西曆法所同也然天旣北倚赤道之勢與北極出地相應皆南髙而東西下黃道斜交赤道又因節气而殊初虧食甚復圓各限加時又別是故人所見日月光體之東西南北非日體之東西南北也故於仰觀不能盡合密測者以日月體勻爲細分而求其虧甚所當之處於理爲盡然必測器精良用法取影庶幾可知終不能若食分深淺加時早晚之可以萬目同觀眾著無疑也愚今別立新術凡虧復各限並於日月光體之上下左右直指其蝕損所在而不用更雜以東西南北之名欲令測候之時舉目共見卽步算之疎密纎毫莫遁或於測學不無小補猶冀髙賢深明理數有以進而教之也

康熙四十有四年嵗在防防作噩勿庵梅文鼎謹識時

年七十有三

欽定四庫全書

歷算全書卷二十五

宣城梅文鼎撰

交防管見

求初虧復員定交角

以初虧復員定時分依法求其距午時分午後以加午前以減各加減日實度所對時分【入九十度表取之】爲初虧復員時定總時

以定總時各求其日距限限距地髙遂以得其交角加減之得初虧復員時定交角

求初虧復員時先闕後盈之防在日體上下左右

法自天頂作垂弧過日心以至地平分日體員周左右各一百八十度次依定交角度分日在限西初虧爲右下之角復員爲左上之角其度右旋日在限東初虧爲右上之角復員爲左下之角其度左轉並自垂弧左右起算數至定交角度分卽得太陽員周初虧時先闕復員時後盈之防其定交角或爲鈍角者上下相易【如本爲右下者變爲右上本爲右上者變爲右下左亦然】是爲虧復時交道中徑食十分者用此卽中西舊法所謂八分以上初虧正西復員正東者也【初虧復員各依其定交角度分取之】

若食九分以下當先求蝕緯差角法爲並徑與月視黃緯若半徑與蝕緯差角之正也以月視黃緯化秒乘半徑爲實以並徑減一分化秒爲法除之得蝕緯差角之正查正得度分以加減虧復時交道中徑得日體周邊先缺後盈之防

視緯北者日在限西初虧以加復員以減日在限東初虧以減復員以加視緯南者日在限西初虧以減復員以加日在限東初虧以加復員以減並置交道中徑以蝕緯差角度分加減之得數仍自垂弧左右起算得初虧何處先缺復員何處後盈上下左右皆可預定

求食甚在日體上下左右

惟食十分者食甚時兩心相掩或全黒或作全環皆無上下左右可論其食九分以下皆以陰陽曆論南北視緯若食甚時正在黃平象限則視緯北者食甚在日體上半缺口正向天頂形如仰瓦卽舊法所謂正北視緯南者食甚在日體下半餘光厚處正對天頂缺處正向地平兩角下垂形如覆梳卽舊法所謂正南也若此者只有上下可言而無左右偏側之度其餘日在限西則南緯在左下北緯在右下日在限東南緯在右下北緯在左下並以食甚時定交角之餘度或左或右並從天頂垂弧之兩旁起算卽得食甚在日體上下左右之度

求日體周邊受蝕幾何

法用太陽太陰兩半徑相並爲和相減爲較和較相乘爲實月視黃緯爲法除之得數以加減月視黃緯訖乃折半以乘半徑又爲實以太陽半徑爲法除之得余查表得度倍之卽食甚時日體受蝕度分【以太陽全周分三百六十度內該受蝕者幾何度】加減例【日半徑大於月以得數加黃緯日半徑小於月置黃緯以得數減之】

求日食三限在地平上髙度

食甚時日距地髙卽可徑用初虧復員各以定時求其距午分依日赤緯南北度入髙弧表卽各得虧復時地平上髙度【如無正表取前後二表數以中比例酌之假如其地極出地三十一度則查三十度表及三十二度表以兩表數並而半之卽是本地髙弧之數】又算法【以限距地髙度與日距限之餘度相加爲捴相減爲較捴較各取余視捴弧過象限則兩余相並不過象限兩余相減並折半得髙弧正撿表得髙度】

求日食三限地平經度

法以地平緯度之餘度分與極出地之餘度分相加爲總相減爲較總弧較弧之餘相減若總弧過象限則相加並折半爲法【初數】又取較弧矢與日距北極度之矢【對弧矢也日赤緯在南者以加象限赤緯在北者置象限以赤緯減之卽各得距北極度】相減得較較乘半徑爲實實如法而一得角之矢【以矢命度】若日食在午前其角度爲距正北子正之度食在午後以減半周爲距正南午正之度【正矢與大矢並同一法】三限皆如是

求帶食分在日體上下左右

以日出入時距緯爲法半徑乘月視黃緯爲實實如法而一得正查表得帶食緯差角度分如求初虧復員之法以帶食緯差角加減白道中徑得帶食分在日體上下左右若帶食在初虧後食甚前其加減用初虧法帶食在食甚後復員前其加減用復員法

帶食在初虧後食甚前者陰曆日在限西加日在限東減

陽曆日在限西減日在限東加

帶食在食甚後復員前者陰曆日在限西減日在限東加

陽曆日在限西加日在限東減

右並置月道中徑以帶食緯差角度分加減之得數仍自垂弧左右起算卽得帶食時食分最深之處在日體上下左右【凡帶食出入時或防虧或見蝕半或半以上其餘光皆成兩角外向均折兩角取其中卽帶食分最深之處】

求帶食出入時日邊受蝕幾何

以太陽太陰兩半徑相並爲和相減爲較和較相乘爲實日出入時距緯爲法除之得數以加減日出入時距緯【日半徑大於月以得數加入距緯日半徑小於月置距緯以得數減之】乃折半用乘半徑又爲實太陽半徑爲法除之得余查表得度倍之爲帶食出入時太陽周邊受蝕之分【以三百六十度分太陽全周內該缺幾何度分】

作日食分圖法【交食之驗非圖莫顯圖必分作其象始眞故不憚反覆詳明以著其理】

一定日食時交道斜正

作立綫以象垂弧此綫上指天頂下指地平卽地平經度圏之一象限也綫上取一防爲心規作員形以象太陽其員周爲地平經綫所分左右各一百八十度依本限定交角作防【或初虧或復員或食甚各有定交角】若日距限在西其度右旋日距限在東其度左旋於太陽員周上下並從垂綫分處數至定交角度止得兩防聮爲一直綫必過太陽之心兩端稍引長之橫出是爲日食時月道交於垂弧之象若日距限西交道左昂右低日距限東反之其初虧食甚復員三限距限東西有時而異𨿽其不異亦必有逺近髙下之殊則交道低昂異勢未可以一法齊也今三限各求定交角依度作圖不論東西南北一以太陽邊左右上下言其虧甚之狀卽測算可以相符歷法之疎宻可以眾睹更無絲毫可容假借

如圖甲乙爲垂弧甲丁乙丙爲日體乙己丙爲定交角丁己甲爲對角乙至丙甲至丁皆定交角之度因日距限在限西故右旋數其度

丙丁爲上下兩防己爲日心聮丙丁爲直綫則過日心稍引長之至庚則成交道因在限西故月道左昂右低【交道卽月道也爲月視緯所成在食十分時可名月道其食不滿十分者可名月道平行綫】

各號並與前同

惟日距限在限東故從乙至丙從甲至丁並左旋數定交角度而庚辛月道右昂左低

如圖月道平過與天頂垂弧相交成十字正角而又在午方則上北下南左東右西各如本位矣【如舊法食十分初虧正西復圓正東食八分以下者陰曆初虧西北食甚正北復圓東北陽曆初虧西南食甚正南復圓東南惟此時爲然】此必日食在黃平象限左右因定交角加減而成正角然不常有卽有之又未必在正南方則與東西南北之名不相葉應故不如用定交角直以上下左右言其方向【黃平象限有離午正二十三四度時又有定交角加減則𨿽離午正三十餘度之逺而能有此象蓋卽月道之九十度限也食旣者遇之虧必正右復必正左北緯者虧右上復左上而食甚正向天頂南緯者虧右下復左下而食甚向地平】

己爲日戊爲月

乙至丙甲至丁皆交角之度

丙爲初虧丁爲復圓

戊丙己丁爲月道

此因日食十分故卽用丙丁二防爲初虧復圓卽舊法所云初虧正西復圓正東者也然以日距限西故初虧在日體右下復圓在日體左上

此亦日食十分因距限在東故初虧在日體爲右上復圓在日體爲左下

凡日距限西者復圓交角必小於初虧日距限東者復圓交角必大於初虧故必分作其圖始能合算今從簡省以交角相同者合爲一圖非謂一食中虧復同角也

一圖初虧

先以初虧定交角如法作垂弧及交道安太陽於交防若食十分者於太陽右方截取交道如月半徑之度以此爲心規作月體與太陽邊相切卽初虧時先缺之防【圖己見前】

若食不滿十分者用緯差角度算太陽邊周之度月視黃緯在北向上數之在南向下數之並從太陽右方交道起算數至緯差角度止卽爲初虧時先缺之防自太陽心向此防作直綫透出其外稍引長之以並徑爲度從心截取引長綫作防卽初虧時兩心之距也以截防爲心太陰半徑爲度作圓形卽初虧時太陰來掩太陽相切之象也從太陰心作直綫與交道平行則月視行之道也從太陽心作垂綫至視行綫成十字角卽月視黃緯也以上並不論初虧是午前午後亦不論地平方位或在正南或偏東西並同一法食甚復圓仿此

乙己丙交角乙丙其度從丙過己心至丁而引長之卽月道平行綫

丙己庚爲緯差角丙庚其度因月視黃緯在北故從交道丙向上數其度至庚庚卽初虧時先缺之防

從太陽心己作直綫過庚防而透出其外爲己庚戊綫乃並日月兩半徑【得己戊】爲度截己庚戊綫於戊戊卽太陰心也以戊庚月半徑從戊心作圓爲太陰與太陽邊相切於庚初虧象也

從月心戊作戊辛癸綫與丙己丁平行月視行道也【此月視行綫乃人所見月心所行故以丙己丁交綫爲月道平行綫】從太陽己心作十字垂綫至月視行綫上如己辛月視黃緯也

乙己丙交角以乙丙爲度從丙過己心作月道平行綫丙己庚緯差角以丙庚爲度因月視黃緯在南故從交道丙向下數其度至庚庚卽初虧時先缺之防【此爲緯差角大於定交角故易右爲左】

從己心向庚作己庚戊綫而以己戊並徑度截之於戊用爲月心規作月體與太陽相切於庚象初虧也從戊心作癸戊辛綫與丙己丁平行月視行道也從己心作己辛綫與戊辛相遇成方角月視黃緯也以上二宗爲日距限西日距限西者初虧定交角並爲右下之角然惟食十分時則初虧右下與定交角同防其餘則北緯者能易右下爲右上前條是也南緯者能易右下爲左下此條是也

甲己丁交角以丁甲爲度從丁過己心作丁己丙月道平行綫

丁己庚緯差角以丁庚爲度因月視黃緯在北從交道丁向上數至庚以庚爲初虧之防【此亦緯差角大於定交角故易右爲左】如前從己心向庚作透出綫截之於戊使己戊同並徑則戊爲月心從戊心作圓形象初虧時太陰以其邊切太陽於庚從戊作戊辛癸綫爲月視行之道與丁己丙平行又從己作己辛綫爲月視黃緯辛爲正角

諸號同前

惟以月視黃緯【卽己辛】在南故緯差角【丁己庚角】從交道【丁】向下數其度【至庚】爲初虧之防

以上二者爲日距限東凡初虧在限東者其定交角爲右上之角然惟日食十分與定交角同防而初虧右上其餘北緯者能易右上爲左上南緯者能易右上爲右下此二條可以推矣

一圖食甚

先以食甚定交角作垂弧月道於交防安太陽並如初虧法次於太陽周邊數定交角余度若日距限西其度左旋日距限東其度右旋並於日體上下方從垂綫數起至定交角余度止各作防聮爲一直綫稍引長之此綫與月道爲正十字能過月道之極卽月道之經圏食甚時太陽太陰並在此綫之上乃以月視黃緯求其距若視緯在北向上量之視緯在南向下量之並從太陽心截取視緯於月道經綫作防卽食甚時兩心之距也以此爲心月半徑爲度規作月體卽見食甚時月掩太陽在日體上下左右幾何度分此時兩心之距爲最近其食分最深於此綫上分太陽光體爲十平分卽所食之分可見若於太陽之邊數其所蝕光界卽知太陽周邊受蝕幾何度分

若於月心作綫與月道經綫爲十字正角卽自虧至復月行之道也兩端稍引長之用並徑爲度從太陽心截之左右各得一防卽初虧復圓之防也【右爲初虧左爲復圓】如此卽爲總圖【総圖惟食甚爲正形初虧復圓亦得大槪仍當於分圖攷之】

若食十分者或全黒或作金環並無視緯更無上下左右可論不用此法

又若食甚時定交角滿九十度則北緯正對天頂餘光有如仰盂南緯正對地平餘光有如覆椀其月道左右平衡其南北視緯卽於垂弧取距【北緯自太陽心向上南緯自太陽心向下並以月視黃緯取其度爲兩心之距】不須另作月道經綫又於月道經綫以月視黃緯量其距若陰曆向上量之陽曆向下量之並自太陽心量至視黃緯止從此作綫與月道經綫爲十字角卽與虧復月行之道平行南北差之理亦自可見

乙己丙爲定交角其度自乙右旋至丙丙己丁綫過太陽心爲月道平行綫

乙己庚爲定交角之餘角其度自乙左旋至庚庚爲食甚所向之方從庚過太陽心作午己庚綫爲太陽全徑分爲十分依月視黃緯自太陽心己截至戊以戊爲心月半徑壬戊爲度作圓以象食甚時掩日之月計所掩徑自庚至壬得蝕六分餘光自壬至午得四分計所掩邊自酉過庚至卯得缺光之邊一百三十分餘光自酉過午至夘得未掩之邊二百三十分約爲蝕三之一而彊【此以太陽邊周爲三百六十分也分亦可名度】

從月心戊作戊癸綫與太陽徑爲十字角與交綫平行是爲月視行之道以並徑爲度自太陽心己截戊癸月道於辛於子各爲心作太陰象卽見初虧於酉復圓於卯可當總圖

此與前圖皆食在限西故乙己丙定交角同勢惟月視黃緯在北故用甲庚余角從甲左旋數至庚爲食甚所向之方亦作午己庚十分全徑而透出之用月視黃緯截之於戊戊爲心戊壬半徑作月體交加於太陽光體之上計所掩自庚至壬得蝕四分有奇其自未過庚至醜爲所蝕之邊又如法從戊心作月視行之道以幷徑截之於辛於子各作月體卽見卯酉爲虧復之防幾食在限西者南緯必食甚左下北緯必食甚右上惟交角大者余角小交角小者余角大而大致不攺卽二圖可槪其餘

其初虧交角必大於食甚復員交角必小於食甚全圖聊舉大意仍以分圖爲定

乙己丙定交角其度自乙左旋至丙丙己丁過太陽心爲月道平行綫

乙己庚余角度自乙右旋至庚庚己午太陽全徑引長之以月視黃緯度截之於戊戊爲食甚時月心所到其邊掩太陽至壬午壬爲食甚所向之方分太陽全徑爲十分午壬爲所掩之分得二分有奇未午丑爲所缺之邊約得九之二

此與前圖皆食在限東乙己丙交角同勢惟月視黃緯在南故用甲己午餘角【卽乙己庚】右旋從乙至庚庚防爲食甚所向庚己午太陽全徑十分以月視黃緯截己戊戊爲月心作太陰體掩太陽至壬得八分有奇未庚丑爲所缺之邊約得九之四凡食甚在限東者北緯必左上南緯必右下𨿽角有大小其大致不變以上二圖可槪其餘以上食甚四圖或居太陽體之左上左下右上右下並以定交角論其餘角不論地平經度之東西南北並同一理卽令食甚正午而距限有東西卽交道有低昂必無正北正南如舊法所云者也

此月視緯在北

日食七分奇

甲爲食甚在日體上方餘光如仰盂

此月視緯在南

日食五分

戊爲食甚

在日體下方

餘光如覆椀

惟此二圖是交角成像限若又居正南方則北緯食甚可稱正北南緯食甚可稱正南

一圖復圓

以復圓定交角作垂弧月道安太陽並如上法

若食十分者於太陽左方截取月道如月半徑之度以此爲心規作月體與太陽邊相切卽復圓時後盈之防【圖亦見前】

若食不滿十分者用緯差角度算太陽邊周之度北緯向上數之南向下數之並從太陽左方交道起數至緯差角度止卽爲復圓時後盈之防自太陽心向此防作直綫透出其外稍引長之以並徑爲度從心截取引長綫作防卽復圓時兩心之距以截防爲心規作太陰與太陽相切卽復圓時太陰行過太陽初離之象也

甲己丁交角【卽乙己丙】其度甲丁從丁過己心作丙己丁綫引長之卽月道平行綫

丁己庚爲緯差角其度丁庚因月視黃緯在南從交道丁向下數其度至庚庚卽復圓時後盈之防從太陽心己出直綫過庚而透出其外爲己庚戊綫以幷徑爲度截之於戊以戊爲心月半徑爲界作太陰圓體切太陽邊於庚卽太陰行過太陽初離之象也從月心戊作戊辛直綫月視行之道也而己辛者月視黃緯也

甲己丁交角【卽乙己丙】其度甲丁從丁作月道平行綫過己心至丙而引長之

丁己庚緯差角大於交角而月視黃緯在北法當從交道丁向上數丁庚之度跨甲而至庚庚卽復圓時復光最後之防又法從己心作丙己丁之十字垂綫乃以月視黃緯爲度截之於辛則己辛卽食甚兩心之距也從辛又作十字長垂綫與丙己丁交道平行如戊辛癸卽月視行之道也次以幷徑爲度截月視行道於戊以戊爲心月半徑爲度作復圓時太陰象卽其邊切太陽於庚

以上二圖皆復圓距限西也凡復圓限西者其定交角爲左上之角然惟食十分其防不攺其餘則有易爲正左稍下如前圖者有易爲右上如此圖者余可數推

乙己丙交角以乙丙爲度從丙作月道平行綫過己心至丁而引長之

因月視黃緯在北從交道丙向上數緯差角丙己庚之度至庚卽庚爲復圓之防又法以丁午丙半周度折半於午從午作綫至太陽心己爲丙己丁之十字垂綫於此垂綫上截取辛己如月視黃緯卽於辛防作十字交綫與交道綫【卽月道平行綫】平行爲月視行之道於此月視行道取戊己斜距如並徑則戊防卽復圓時太陰之心從心作太陰體卽切太陽於庚而正居太陽左方

此交角與差角同度也庚己丙交角其度自庚數至丙防爲月道平行綫所過【丙己丁過心綫爲交道卽月道平行綫】

丙己庚差角自丙數至庚【因南緯向下數】庚防爲復圓時太陰初離太陽邊猶相切之處也差角丙庚之度與交角庚丙等故相減至盡而正居太陽之底也如用又法從己心作己午垂綫以月視緯截辛防從辛作十字綫如辛癸與交綫平行爲月視行道卽可以戊己並徑截戊防爲太陰心其邊卽切太陽於庚亦同

凡復圓限東者定交角必居左下然惟食十分者則然其餘則有變爲日體正左或日體正下者如以上二條者可類推也

甲爲九十度限乙爲黃道過午規交角乙丙爲黃道在午規距天頂之度今用乙甲丙正弧三角形有甲正角乙交角乙丙弧而求甲丙弧爲九十度距天頂之度法爲半徑與丙乙弧正若乙角之正與丙甲正也

【一半徑二丙乙正】

【三乙角正四丙甲正】

增沿曆書乃以丙乙余與乙角余相乘爲實半徑除之得丙甲正失其防矣

簡庵曰甲角非正角也何以言之自天頂出綫過赤道則爲正角其過黃道不能成正角甲角旣爲天頂綫過黃道所作之角則必非正角勿庵曰不然甲防者九十度限也若甲非正角則不得爲九十度限矣

簡庵曰赤道能爲正角者以天頂綫能過北極也若黃極則不能過天頂天頂綫旣不串黃極則甲必不能爲正角明矣勿庵曰子午綫所以能穿天頂與北極者以赤道在平地上半周一百八十度而交子午圈處爲其折半最中之處故天頂綫交赤道成十字角也天頂綫與赤道作正角惟此一處蓋惟此處能使地平經綫【卽天頂出綫至地平分方位之綫】與赤道經綫【卽北極出綫至赤道分時刻之綫】合而爲一【從地平經綫言之爲子午規從赤道言爲過極圈】他處則不能也黃道亦然其在地平上亦一百八十度每度並從黃極出經綫至黃道上成正角但不能過天頂而必有一度爲黃道半周折半之處則此一經綫必過天頂而穿黃極天頂綫旣穿黃極則其交黃道處必成十字正角矣天頂綫與黃道作正角亦惟此一處【亦如赤道之有子午規】蓋亦惟此處能使地平經綫與黃道經圈合而爲一而他度不能西法用九十度限其理如此故甲角必正角簡庵聞此欣然首肯焉

本法用乙甲丙形求丙甲爲九十度距天頂今依簡庵說用丁戊丙形求得戊丙爲天頂距黃極之度以減象限卽得丙甲距天頂之度

法曰以正午黃經之赤道同升度取丁角【從冬至數之卽得】以各地北極出地余度取丁丙邊以兩極相距二十三度半爲丁戊邊

是爲一角兩邊可求戊丙邊

若用垂弧法𨿽多轉折其理無訛若用加減代乘除法乃捷矣

又按此以正弧形爲本形攺用斜弧爲次形亦弧三角中一法往所未及也可見學問相長之無窮

旣得甲丙邊又原有乙丙邊甲正角可求甲乙邊爲九十度距午規

丁北極戊黃極丑寅圈徑五度爲白道極所行之迹醜爲今所求月道心【卽白道極所到】得丑寅邊爲丑戊寅角之度亦卽爲丁戊醜角度先用丁戊丑弧三角形有丁戊邊【爲兩極距二十三度半】有醜戊邊【爲月道大距五度】有戊角【卽上所論】可求醜丁邊爲白道極距北極之弧可求醜丁戊角

次用丁丑丙弧三角形有醜丁弧【爲先所求】有丙丁醜角【以先有之戊丁丙角與今得之醜丁戊角相加減得丙丁醜角】有丁丙邊【卽本地北極出地余度】可求醜丙邊爲白道極距天頂之弧亦卽爲白道九

十度距地平之髙度求白道極所在【卽醜防】法曰凡白道極隨交防而移交防逆行故白道極亦逆行也先求正交【或中交】在黃道度分離此一象限卽爲半交最逺之所此防與白道極相應若系半交是陽曆則白極在黃極南半交是陰曆則白極在黃極北極距黃極五度奇卽醜戊也醜戊弧五度循黃極而左旋有時而合於兩極距綫爲寅戊或戊辛則無丑戊丁角自此以外皆有戊角此算之根也

設白道極【丑】在寅卽丑戊寅角法當以戊寅五度【白極距黃極】與丁戊二十三度半相減餘十八度半爲寅丁寅丁丙弧三角形有寅丁邊【爲白極距北極】有丁丙邊【北極距天頂】有丁角可求寅丙邊爲白極距天頂

又設【醜】防在辛卽以戊辛加戊丁爲一邊【辛丁】如上法可求辛丙弧爲白極距天頂

以上二者因白極距黃極之綫與黃極距北極同一大圈之經度故丁戊綫有加減而丁角無加減故只用一弧三角形卽可得之此惟月邊半交在二至度然後能如是

設正交在秋分之度中交在春分之度則陽曆半交在冬至黃道外陰曆半交在夏至黃道內各五度奇而白道極在兩極距綫外亦五度奇如辛如酉

法當以白黃大距五度奇【辛戊或酉戊】加兩極距二十三度半【戊丁】共得二十八度半奇【辛丁或酉丁】爲一邊丁丙爲一邊【北極距天頂】丁爲一角【或辛丁丙或酉丁丙】可求辛丙邊【或酉丙邊】卽白道極距天頂度以減九十度余爲白道距天頂度【捷法卽以所得白道極距天頂命爲白道九十度距地平】

此圖丁辛綫己用弧綫不能作兩白道極圈

如圖丙爲天頂丁爲北極丁戊二十三度半卽以丁爲心戊爲界運規作圓卽黃極繞北極之圈再以丁戊引長之至於辛又以戊爲心辛爲界作圓爲白極繞黃極之迹戊辛爲黃白距五度奇【此圖則戊酉可省】

今聮丁辛丙成三角形如上論余觀圖自明

更當明者白道限度之不能與黃平象限同在一度卽若黃平象限之不能與赤道髙度同在一度同也黃平象限與赤道髙度能在一經度者惟極至圈在子午規之度爲然白道限度之能與黃平象限同在一經度者惟兩交在二分之度又極至圈同在午規時也

又設正交在春分之度中交在秋分之度則陽曆半交在夏至黃道外陰曆半交在冬至黃道內各五度奇而白道極在兩極距綫內亦五度奇如寅如未

法當以白黃大距五度奇【寅戊或未戊】去減兩極距二十三度半【戊丁】得餘十八度半弱【寅丁或未丁】爲一邊丁丙爲一邊丁爲一角【或寅丁丙或未丁丙】可求寅丙邊【或未丙邊】爲白極距天頂卽命爲白道九十度距地平之髙圖如後

以上二者並只用一弧三角形何則以交防在二分也交防在二分則半交與白極並在極至交圈故丁戊弧自有加減而丁角無加減若交防離二分則否何則交防逆行卽羅計度也交防周於天而半交大距亦一周天而白極亦周於黃極左右之小圈故丁角有加減而必用兩三角形也

求戊角【用兩三角形必先取戊角】法曰正交在秋分則白極在辛【卽在酉】從辛左旋過丑至寅而復於辛以生戊角戊角之度或鋭或鈍皆以交防距分之度命之

白極小圏以羅計一周而復於元度【假如正交自秋分向夏至逆行過秋分二十度則白極離辛防亦二十度以減半周餘百六十度爲戊鈍角】

求丁角【戊丁丙角】法曰視極至交圏距午圏若干度分卽得戊丁丙角【以加時午正黃道度取之】

白道九十度限用法

依前所論以求加時白道九十度限在地平上之髙的確不易【用斜弧三角形】但如此則交食表所算九十度限俱可不用當另算白道九十度表

法曰醜戊丁三角形以丁戊邊【兩極距二十三度半】醜戊邊【白極距黃極五度】戊角【白極距冬至經圏之度亦卽正交離秋分之餘度】爲二邊一角可求丁丑邊【此邊之度天下所同】丁角【此角亦天下所同】其法並以戊角之大小立算【只算半周可以立表矣】

正交在【秋分前以過夏至而至春分春分前以過冬至而至秋分】之度角在極至圏【西東】戊丁丙三角形求丁角

法曰以應時法求加時午正黃道【可借用黃道九十度表】取其赤道同升度卽得丁角

視同升度在冬至後半周其距冬至度卽爲丁角【其角在子午綫西】若同升度在夏至後半周卽以距夏至度去減半周餘爲丁角【其角在子午綫東】此丁角亦天下所同

醜丁丙三角形先求丁角

法曰以先有之兩丁角相減或相並卽得丁角

兩丁角俱在西或俱在東【則相並】兩丁角一在西一在東【則相減】此丁角亦天下所同

次求丁丙邊

法曰丁丙者各地之北極距天頂也以北極髙度減象限得之

次求白道九十度限之髙

法曰旣有丁角【卽上所求】丁丑邊【卽先所求】丁丙邊【卽極距天頂】爲一角兩邊可求醜丙邊【爲白極距天頂度】以減象限得白道九十度限距天頂亦卽得其距地平之髙

旣得白道九十度限距地平之髙再求得月在白道上距九十度限之度分【法以月距交前交後度減象余卽得】可求其交角【白道交天頂經度之角也】

此交角可借黃道交角表用之但須補作黃道北五度表旣得交角則髙下差可知而東西南北差悉定矣

康熙四十三年五月十七日乙卯朢月食分秒時刻並起復方位

京師月食十分三秒

初虧子正二刻三分東北

食旣丑初三刻八分

食甚醜正一刻二分

生光丑正二刻一分

復圓寅正初刻一分正北稍偏西

右計食限內凡十三刻十三分

按食限內共十三刻十三分折半得六刻十四分故以此減食甚時刻得初虧【自初虧子正二刻三分至食甚醜正一刻二分正得六刻十四分】加食甚亦得復圓【自食甚醜正一刻二分至復圓寅正初刻一分亦得六刻十四分】是虧至甚甚至復時刻適均也時刻所以適均者月行天之度均也然則作圖之法自當以食甚月體置於虧復兩限適中之處而不宜偏側矣今監頒蝕圖乃偏置於東若是則虧至甚月行之度分多甚至復月行之度少度旣不均則時刻亦宜增減若時刻旣無增減則圖之偏者必非正法矣

又按食旣至食甚食甚至生光時刻亦宜適均與虧至甚甚至復之理無二【曆書本法虧復折半之數謂之食甚距分以減食甚得初虧若以加食甚得復圓其食旣至生光折半數謂之食旣距分以減食甚得食旣以加食甚亦得生光並無長短伸縮】今圖中所注食旣至食甚時刻多【食旣是丑初三刻八分至食甚醜正一刻二分計一刻○九分】食甚至生光時刻少【食甚醜正一刻至生光丑正二刻一分只十四分】相差十分何也豈以食甚圖偏而自疑其法耶不然何以若是

又按交食表食甚距分是一時四十四分【卽監推六刻十四分】食旣距分是四十二分【實計二刻十二分】月食只十分○三秒食旣生光不得有五刻九分之久【倍食旣距分得八十四分實五刻○九分】蓋覺其非是而棄表不用也然表之數宜攺而其法不宜攺【表自旣至生光五刻九分監推只二刻○八分是攺數也曆書以距分加減食甚得旣與生光而監推相差三分刻之二是攺法也】今攺其數幷攺其法不知何所見而云然也

或疑月行有遲疾自生光至食甚行遲故歷時刻多食甚至生光行疾故歷時刻少此亦說之可通者也然月之遲疾必以漸成決無於二刻八分中頓有十分之差【月平行二刻八分只行天三分度之一而弱】且食旣生光旣有遲疾之差初虧復圓何以獨無可謂進退失據矣

又按食甚云者以月於此時侵入闇虛獨湥也則其距前後之時刻必爲折中均平之處也故月食未旣者必於食甚時定其食分以此時所蝕之分最大也【假如月食九分則惟食甚時能滿九分前後皆少食八分以下盡然】是以謂之食甚若圖有偏側不得謂之食甚矣

食未旣時有食分以攷之【食分最多時始爲食甚】食旣矣則食甚無可指惟賴食旣生光時刻折半取中而今乃相差若此又何所據而爲食甚耶

又詳檢之初虧至食旣【計五刻五分】食旣至食甚【計一刻九分】食甚至生光【計十四分不滿一刻】生光至復圓【計六刻】無一相同而遲疾皆不倫初限較末限旣先疾而後遲【初虧至食旣五刻五分是初限行疾也生光至復圓整六刻是末限行遲也】二限較三限又先遲而後疾【食旣至食甚一刻九分是次限行遲也食甚至生光只十四分而不滿刻是三限又行疾也】是初虧行疾限至食旣而忽遲食旣行遲限至食甚而頓疾食甚行疾限至生光以後而又遲不識月轉遲疾有如此行度否乎

歷算全書卷二十五

欽定四庫全書

歷算全書卷二十六

宣城梅文鼎撰

交食求卷一

曆書有交食求七政引二目刻本逸去玆以諸家所用細艸補之並稍爲訂定以便初學

日食

一求諸平行

首朔根

檢二百恆年表本年下首朔等五種年

根並紀日錄之

朔防

用十三月表以所求某月五種朔策之

數錄於各年根下

平朔

以首朔日時與朔實及紀日並之【滿二十四

時進一日滿六十日去之】

太陽平引

以太陽引根與朔策並之

太陰平引

以太陰引根與朔防並之

交周平行

以交周度根與朔策並之

隨視其宮度

○宮二十度四十分內

五宮○九度二十分外

六宮十一度二十分內

【十一】宮十八度四十分外

以上俱有食再於實交周詳之

太陽經平行以太陽經度根與朔防並之

二求日月相距

日定均

以太陽平引宮度檢一卷加減表如平

引滿三十分進一度查之【記加減號】

月定均

以太陰平引宮度檢一卷加減表如平

引滿三十分進一度查之【記加減號】

距弧

以日月定均同號相減異號相加卽距弧

距時

以距弧度分於四行時表月距日橫行內檢取相當或近小數以減距弧得時【視相當近小數本行上頂格所書時數錄之卽是】其餘數再如法取之得時之分秒【依上法用相當近小數取之】並所得數卽爲距時

隨定其加減號

兩均相減者日大則減日小則加

兩均相加者日大則加日小則減

兩均一加一減者

加減從日

三求實引

日引弧

以距時時及分入四行時表取太陽平

行兩數【兩數謂時及分下同】並之【依距時加減號】

日實引

置太陽平引以日引弧加減之卽得月引弧

檢四行時表取距時【時分】下太陰平引兩

數並之【依距時加減號】

月實引

置太陰平引以月引弧加減之卽得四復求日月相距

日實均

以日實引宮度檢一卷加減表如實引

滿三十分進一度查之【記加減號】

月實均

以月實引宮度檢一卷加減表如實引

滿三十分進一度查之【記加減號】

實距弧

以日月實均同減異加卽得

實距時

以實距弧度分檢四行時表與前距時

同【加減號亦同前】

五求實朔

實朔

置平朔以實距時加減之卽得如加滿二十四時者進一日不及減者借二十四時減之則退一日爲實朔也

六求實交周

交周距弧

檢四行時表以實距時【時分】取交周平行

兩數並之卽得【依實距時加減號】

交周次平行置交周平行以交周距弧加減之卽得實交周

置月實均【記加減號】以加減交周次平行卽

得實交周

隨視其宮度以辧食限

凡陰曆○宮十七度四十分以內

五宮十二度二十分以外

凡陽曆六宮○八度二十分以內

【十一】宮廿一度四十分以外

實交周入此限者並有日食

七求躔離實度

日距弧

以實距時【時分】檢四行時表取太陽平行

兩數並之卽得【依實距時加減號】

日次平行

置太陽經度平行以日距弧加減之卽

得

日實度

置日實均【記加減號】以加減日次平行卽日

實度

八求視朔

加減時

以日實度檢一卷加減時表【如日實度滿三十分

進一度取足】記加減號

視朔

置實朔以加減時加減之卽得

九求徑距較數

月距地

以月實引查二卷視半徑表月距地數

卽得【度取相近者用之】

月半徑

查月距地下層有太陰之數卽月半徑月半徑

以日實引加減六宮檢視半徑表取太陽之數卽得【日實引在六宮以下加六宮如四宮則用十宮實引在六宮以上減六宮如十宮則用四宮】

並徑

以日月二半徑並之卽是

月實行

以月實引宮度【滿三十分進一度查】檢二卷太陰

實行表【度取相近者用之】

十求近時

總時

檢四卷九十度表【九十度表一名黃平象限表其表隨地不同如在京師立算取四十度在江南取三十二度冬依極出地取本表用之】以日實度取表第一行宮度得相對第二行防時防分另以視朔時分與十二時相加減得數以加入之卽爲總時總時過二十四時去之用其餘

加減十二時法

視朔在十二時以上減去十二時【止用餘數】視朔在十二時以下加上十二時用之

日距限

以總時【時分】入黃平象限本表第二行取其相對第三行九十度限下之宮度分用中比例得數與日實度相減卽得日距限度分並東西號

定東西法

日實度大內減限度日在限東

日實度小去減限度日在限西

限距地髙

以總時【時分】相對本表第五行限距天頂數置象限九十度減之餘數卽限距地髙

日赤道緯

以日實度在三宮以下者加九宮在三宮以上者減去三宮用檢五卷太陽距赤緯表卽得【記書南北號】

日距地髙

以【日赤緯視朔時】檢六卷髙弧表【髙弧隨地不同各依北極髙度取用】先以緯度或南或北之數檢右直行次以視朔檢上橫行其視朔滿十二時去之用其餘刻入表【假如十二時三十三分止以三十三分作二刻入表】不滿十二時則置十二時減之用其餘入表【加減餘一時卽作四刻】

月髙下差

以九求月距地數及日距地髙度【滿三十分進一度】檢八卷太陽太陰視差表先以月距地數檢右直行次以日距地髙檢上橫行得數內減去本數上之太陽視差分秒卽月髙下差

兩圏交角

用本求日距限限距地髙【滿三十分進一度】檢七卷交角表【以限距地查左右直行以日距限檢上橫行用中比例取之】得數以減象限卽得

定交角

置交角加減白道角五度爲定交角【實交周是○宮十一宮日距限在限西則減在限東則加若實交周是五宮六宮日距限在限西則加在限東則減】

時差

用定交角月髙下差檢八卷時气差表【以定交角檢左右直行以月髙下差檢上橫行】卽得時差【順度用上時差號逆度用下時差號】

近時距分

月實行化秒爲一率六十分爲二率時差化秒爲三率二三相乘一率除之卽得【零及半者收作一數】

近時

置視朔以近時距分加減之卽得【日在限西則加限東則減如定交角大於象限則反其加減若適足象限則無時差卽以視朔爲食甚眞時不用後法】

十一求眞時

近總時

置總時以近時距分加減之卽近總時

【日在限西則加限東則減】

日距限

以近總時如前法取之記東西號限距地髙

以近總時如前法取之

日距地髙

以日赤道緯及近時如前法檢髙弧表月髙下差

以九求月距地及【本求】日距地如前法檢

視差表

兩圏交角

以日距限限距地髙如前法檢交角表

【如前加減爲定交角】

近時差

以定交角度及月髙下差如前法檢時

气差表

視行

以近時差與先得時差相減爲較若先得時差小以較減之若先得時差大以較加之卽爲視行又防法倍先得時差內減去近時差得視行亦同

眞時距分

以十求內先得時差化秒與近時距分相乘爲實以視行化秒爲法除之卽得

眞時

置視朔以眞時距分加減之卽眞時【亦以

限西加限東減】

十二求考定眞時

眞總時

復置總時以眞時距分加減之【日在限西則加

限東則減】卽眞總時

日距限限距地髙【並以眞總時查】

日距地髙【以眞時】月髙下差

兩圏交角【定交角】以上並如前法

【眞時差气差】

以本求【定交角月髙下差】如前法取【時差表內得時差卽

得气差】

以眞時距分與月實行化秒相乘爲實一小時化秒爲法除之得數爲眞距度【秒六十收爲分】

食甚定時

以所得眞距度與本求眞時差相較若相等者卽用眞時爲食定時【如此卽不用後條距較考定法】

距較度分

若【眞距度眞時差】相較有餘分卽爲距較度分

【差數秒不論】

距時損益分以眞時距分與距較度分化秒相乘爲實十求內先得時差化秒爲法除之得數爲距時損益分若眞時差大於眞距度則爲益分眞時差小於眞距度則爲損分【須記損益分】

【考定】眞時距分置眞時距分以所得損益分如號損益

之卽是

【考定】食甚時

復置視朔時以考定眞時距分加減之

【東減西加並如原號】爲考定食甚時

十三求食分

距時交周

以實朔與眞時相減得較數如前法取

四行時表交周度卽得【限東爲減號限西爲加號】

定交周

置實交周以距時交周加減之卽得月實黃緯

以定交周檢太陰距度表【依中比例求之式如左】假如定交周○宮十度十四分求共黃緯

一率全度六十分二率三百○七秒三率小餘十四分四率

七十一秒以所得四率【七十一秒收爲一分一十一秒】如十度黃緯共得黃緯五十二分五十七秒其緯在北

中比例加減法【表上數前少後多者加前多後少者減】

辧月緯南北並視定交用是【○宮五宮六宮十一宮】其緯在【北南】月視黃緯

置月實黃緯以气差加減之卽得視緯凡月實緯在南以气差加月實緯在北以气差減若實緯在北而气差大於實緯當以實緯轉減气差爲視緯其緯變北爲南

並徑減距

置前並徑內減去一分再以月視緯減之卽並徑減距如月視黃緯大於並徑不及減則不得食矣

食分

倍日半徑爲一率十分爲二率並徑減距爲三率求得四率爲食甚分秒

十四求初虧時刻

日食月行【復圓同用】以日實引檢八卷日食月行表【分三表查】五六七宮在最髙限取【二三四八九十】宮在中距限取○一十一宮在髙衝限取【如日實引滿十五度進一宮查之】法以月實引宮檢直行【如月實引滿十五度亦進一宮查之】又以月視黃緯分檢上橫行取縱橫相遇之數卽所求日食月行度分

前總時

以十二求眞總時內減一時卽前總時日距限【記東西號若眞時在限西而初虧限東則爲異號】限距地【並以前總時如法求之】日距地髙

置眞時內減一時如前法以日赤緯檢

髙弧表

月髙下差

以【九求】月距地及【本求】日距地髙如前法檢

視差表

兩圏交角【定交角】以【本求】日距限及限距地檢交角表【如前法求之】前時差

以【本求】定交角及月髙下差如前法檢時

气差表

差分

以【前眞】時差相減並卽差分【法恆用減惟定交角過九

十度則相並其東西異號者恆相並惟定交角過九十度則相減】

視行

置月實行以差分加減之卽得視行

日在限【西東】前時差大則【加減】小則【減加】

若差分用並者則恆減【又若食甚眞時定交角滿象限無眞時差可較卽用前時差減或初虧定交角滿象限無前時差卽用眞時差減並減實行爲視行】

初虧距時分以本求視行化秒爲一率一小時六十分爲二率置日食月行分內減一分化秒爲三率二三相乘爲實一率爲法除之得數卽初虧距時【以滿六十分爲一時】

初虧時刻

置眞時【卽食甚】內減去初虧距時分卽初

虧時刻

十五求復圓時刻

後總時

用十二求眞總時加一時卽後總時日距限

以後總時如前法求之【記東西號若眞時在限東復員

在限西爲異號】

限距地髙

以後總時取之並如前法

日距地髙

用眞時加一時以日赤緯檢髙弧表【如前法】月髙下差

以月距地【九求】及本求日距地髙檢視差

表【如前法】

兩圏交角【定交角】以本求日距限限距地髙檢交角表【如前法】後時差

以【本求】定交角及月髙下差檢時气差表

差分

以後時差與眞時差相減並得差分【法同

初虧】

視行

置月實行以差分加減之卽得視行

日在限【西東】後時差大則【減加】小則【加減】

【若差分用並者恆減又若食甚眞時定交角滿象限無眞時差可較卽用後時差或復員定交角滿象限無後時差亦卽用眞時差法恆用減與初虧同】

復圓距時分置日食月行分【卽初虧所用】內減一分化秒爲三率一小時六十分爲二率本求視行化秒爲一率二三相乘爲實一率爲法除之得復圓距時【分滿六十爲時】

復圓時刻

置眞時恆以復圓距時加之卽得十六求宿度

黃道宿度

置日實宮命黃道宮名卽食甚時黃道宮度【○宮起星紀】以各宿黃道宿鈐近小者去減黃道宮度卽得食甚時黃道宿度【記冩宿名】法以所求年距歷元戊辰之算乘嵗差五十一秒加入宿鈐然後減之如加嵗差後宿鈐轉大於食甚黃道不及減退一宿再如法減之【如角宿不及減用軫宿是也】

赤道宮度

以黃道宮度入一卷升度表對度取之【黃道滿三十分進一度查】卽得所變食甚時赤道宮度【記寫宮名】

或檢儀象志八卷取用亦同

赤道宿度

以所入宿黃道宮度並其宿南北緯度入儀象志八卷內如法求其宿赤道宮度置所得食甚時赤道宮度以本宿赤道宮度減之餘爲食甚時赤道宿度又法以弧三角求之其法別具【見補遺】

定日食方位食八分以上者初虧正西復圓正東不及八分者防月實黃緯號在南者初虧西南食甚正南復圓東南黃緯號在北者初虧西北食甚正北復圓東北

○宮至五宮爲陰曆其號在北

六宮至十一宮爲陽曆其號在南

又法不論東西南北惟以人所見日體上下左右爲憑詳交防管見

補遺

帶食法

求日有帶食

若食在朝者初虧時刻在日出前食在暮者復圓時刻在日入後是有帶食也

求帶食距分

若帶食在朝者以日出時刻在暮者以日入時刻並與食甚時刻相減余卽爲食距分

辧食分進退

凡日出入時刻在食甚前其所帶食分爲進也【食在朝爲不見初虧尙可見食甚復圓日在暮爲但見初虧不得見食甚復圓】

若日出入時刻在食甚後其所帶食分爲退也【食在朝爲不見初虧食甚但見復圓食在暮爲可見初虧食甚不見復圓】

若日出入時刻與食甚同則不用更求帶食分卽以原算食分爲日出入時刻所帶食分其食十分者爲帶食旣出入【食在朝爲不見初虧食在暮爲不見復圓】

求帶食出入之分

帶【己退方進】之分者以【復圓初虧】距分化秒爲法並以帶食距分化秒日食月行化秒相乘爲實實如法而一得數自乘又以月視黃緯化秒自乘並而開方得數收爲分【以六十秒爲分】得日出入時距緯以減並徑餘數以十分乘之爲實太陽全徑爲法除之得日出入時帶食之分

算赤道宿度用弧三角法

一求赤道緯度

兩極距二十三度三十一分半爲一邊本宿距星去黃極度爲一邊二邊相加爲總相減爲較總弧較弧各取余以總弧不過象限兩余相減過象限相加並折半得初數又以黃道經度爲對角取其矢【黃道春分後三宮以正夏至後三宮以余並與半徑相減爲正矢秋分後三宮以正冬至後三宮以余並與半徑相加爲大矢】以乘初數爲實半徑爲法除之得矢較以加較弧矢得赤道緯度矢矢與半徑相加減得本宿赤道緯度正【加矢較後得數小於半徑則轉減半徑爲正其緯在北若加後得數大於半徑則於內減去半徑爲正其緯在南】

一求赤道經度

以所得赤道緯度是北緯與象限相減南緯與象限相加爲去北極度用與兩極距度相加爲總相減爲較總較各取余以總弧不過象限兩余相減過象限相加並折半爲初數又以宿去黃極度取矢與較弧矢相減得較以乘半徑爲實初數爲法除之得角之矢與半徑相加減得本宿赤道經度之【角之矢小於半徑爲正矢其經度在南六宮若矢度大於半徑爲大矢其經度在北六宮】

春分至秋分半周爲北六宮所得爲大矢當於得數內減半徑爲赤道經度之

春分後三宮爲赤道正夏至後三宮爲赤道余

秋分至春分半周爲南六宮所得爲正矢當置半徑以得數減之爲赤道經度之

春分後三宮爲赤道正夏至後三宮爲赤道余

作日食總圖法【依舊法稍爲酌定】

先定東西南北之向

作正十字綫其橫者黃道也以左爲東以右爲西其立者黃道經圏也以上爲北以下爲南次以十字交處爲心太陽半徑爲界規作圖形以象太陽光體太陽居十字正中則東西南北各正其位矣

次定食限

十字心爲心太陽太陰兩半徑相並爲度【用太陽半徑原度以後量視緯亦同】規作大圓於太陽之外是爲食限太陰心到此圏界始得與太陽相切過此則不食也

次求月道

實交周在○宮十一宮爲月道由陽曆入陰曆也法於圓周上下各自南北綫左旋數五度識之【圓周並分三百六十度】若實交周是五宮六宮爲月道由陰曆入陽曆也則於圓周上下各自南北綫右旋數五度識之並以所識聫爲直綫必過圓心是爲月邊上經綫也於此綫上從圓心量至月視黃緯爲度【視緯在北自圓心向上量之視緯在南自圎心向下量之】卽食甚時月心所到防也於此防作橫綫與月道經綫相交如十字則自虧至復月行之道也此綫兩端引長與大圏相割東西各有一防卽爲初虧復圓時月心所到之防也【西爲初虧東爲復圓】

次考食分

初虧食甚復圓三防各爲心以太陰半徑爲度作圓形以象月體卽見初虧時太陰來掩太陽其邊相切復圓時太陰已離太陽其光初滿食甚時太陰心與太陽心相距最近食分最深若以太陽全徑分爲十分則所掩分數惟此時與所算相符故謂之食甚也

又初虧時或在日體正西或在西南西北復圓時或在日體正東或在東南東北食甚時或在日體正南或在正北或食十分則正相掩無南北並以太陽心爲中論其南北東西一一皆如所算又或有時太陰全徑小於太陽全徑十秒以上兩心𨿽正相掩不能全食當依月徑於太陽光界之內規作太陰卽見四面露光之象爲金環食也

辧日實度大小法

凡論日食在限東西並以日實度大於黃平限度則食在限東若小於黃平限度則食在限西其法有三其一日實度與限度同在一宮之內卽以度分之多少爲大小

假如限度在寶瓶宮十度日實度在寶瓶宮十五度是日實度大則內減限度得食在限東五度也若日實度在寶瓶宮七度是日實度小則置限度以日實度減減之得食在限西三度也

其二日實度與限度不同宮則以一宮通作三十度然後相較

假如限度在寶瓶宮十度日實度在雙魚宮十五度法以寶瓶宮十度作四十度【寶瓶是一宮一宮者三十度也旣原帶有三十度加入今限度十度共得限度四十度爲自○宮初度算起也】以雙魚宮十五度作七十五度【雙魚是二宮原帶有六七度加入今日實度十五度共得日實度七十五度亦自○宮初度算起也】相減得日實度大於限度三十五度爲食在限東之距也若限度在寶瓶十度而日實度在磨羯十五度法以實瓶十度作四十度【解見上】與磨羯十五度相減【磨羯是○宮故只用本度亦是從○宮初度起算】得日實度小於限度二十五度爲食在限西之距也

其三日實度與限度不同宮而其宮相隔太逺如一在磨羯寶瓶雙魚一在天秤天蠍人馬則以加十二宮之法通之然後相較

假如限度在天蠍十五度日實度在寶瓶十度相隔太逺【天蠍是十宮寶瓶是一宮相隔九宮是太逺也】法當於寶瓶加十二宮得十三宮十度內減天羯十宮餘三宮十度作一百度內又減天蠍宮原有十五度餘八十五度爲日實度大於限度之距而食在限東

又如限度在雙魚宮五度日實度在人馬宮二十五度【雙魚是二宮人馬是十一宮相隔九宮】法當於雙魚加十二宮得十四宮○五度內減人馬十一宮餘三宮○五度作九十五度內又減人馬宮原有二十五度餘七十度爲日實度小於限度之距而食在限西

凡限度爲地平上黃道半周之最髙度日實度或在其東或在其西皆距限度在一象限內若過象限卽在地平以下不得見食矣故無隔三宮以上之事然反有隔九宮以上者右旋一周之度畢於人馬【十一宮】而復起磨羯【○宮】故以加十二宮之法通之而隔九宮以上者距度反近亦只在三宮以下爲象限內而已

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十六﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十六﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十六﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十六﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十六﹥

歷算全書卷二十六﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

欽定四庫全書

歷算全書卷二十七

宣城梅文鼎撰

交食防求卷二

日食附說

第一求

恆年表以首朔爲根何也曰首朔者年前冬至後第一朔也因算交防必於朔望故以此爲根也根有五種曰干支也太陽太陰各平引也太陰交周太陽經度各平行也太陽太陰各二而干支者所以紀之也西曆於七政皆起子正而此處首朔日食有小餘者交防無一定之時故也紀日者年前冬至次日之干支也首朔日時者年前十二月朔距冬至之日時也以此相加得首朔之干支及其小餘矣於是再以逐月之朔實加之得各月平朔干支及其小餘矣

太陽平引與其經度不同何也曰太陽引數從最髙衝起算而經度從冬至起算也冬至定於○宮初度最髙衝在冬至後六七度且每年有行分此西曆與古法異者也

第二求

日定均者卽古法之盈縮差也月定均者遲疾差也距弧者平朔與實朔進退之度也距時者平朔實朔進退之日時也因兩定均生距弧因距弧生距時卽古法之加減差也

第三求第四求五求

平朔旣有進退矣則此進退之時刻內亦必有平行之數故各以加減平行而爲實引也實引旣不同平引則其均數亦異故又有實均以生實距弧及實距時也夫然後以之加減平朔而爲實朔也

平朔古云經朔實朔古云定朔然古法定朔卽定於第二求之加減差其三求四求之法古亦有之謂之定盈縮定遲疾則惟於算交食用之而西曆用於定朔此其微異者也

第六求【原爲第九】

朔有進退則交周亦有進退故有實交周按古法亦有定交周其法相同然必先求次平行者以實朔原有兩次加減也只用月實均者其事在月也其序原居第九今移此者以辧食限也

第七求【原爲第六】

經度有次平行者以實朔有兩次加減故經行亦有兩次加減乃得日實度也只用日實均者其事在日也

第八求

問平朔者古經朔也實朔者古定朔也何以又有視朔曰此測驗之理因加減時得之古法所無也

何以謂之加減時曰所以求實朔時太陽加時之位也蓋歷家之時刻有二其一爲時刻之數其一爲時刻之位凡布算者稱太陽右移一度稍弱爲一日又或動天左旋行三百六十一度稍弱爲一日此則天行之健依赤道而平轉其數有常於是自子正歷丑寅復至子正因其運行之一周而均截之爲時爲刻以紀節以求中積所謂時刻之數也凡測者稱太陽行至某方位爲某時爲某刻此則太虛之體依赤道以平分其位一定於是亦自子正歷丑寅復至子正因其定位之一周而均分之爲時爲刻以測加時以淩犯所謂時刻之位也之二者並宗赤道宜其同矣然推二分之日黃赤同防【經緯並同】二至之日黃赤同經【緯異經同】則數與位合【所算時刻之數太陽卽居本位與所測加時之位一一相符】不用加減時其過此以往則二分後有加分加分者太陽所到之位在實時西二至後有減分減分者太陽所到之位在實時東也然則所算實朔尙非實時乎曰實時也實時何以復有此加減曰正惟實時故有此加減若無此加減非實時矣蓋此加減時分不因裏差而異【九州萬國加減悉同非同南北東西差之隨地而變】亦不因地平上髙弧而攺【髙弧𨿽有髙下加減時並同非若地半徑及蒙气防差之以近地平多近天頂少】而獨與實時相應【但問所得實時入某節气或在分至以後或在分至以前其距分至若同卽其加減時亦同是與實時相應也】故求加減時者本之實時而欲辧實時之眞者亦卽徴諸加減時矣

其以二分後加二至後減何也曰升度之理也凡二分以後黃道斜而赤道直故赤道升度少升度少則時刻加矣二至以後黃道以腰圍大度行赤道殺狹之度故赤道升度多升度多則時刻減矣

假如所算實朔巳定於某日午正時而以在二分後若干日當有加分則太陽加時之位必在午正稍西從而測之果在午正之西與加分數合卽知實朔之在午正者眞也

又如所算實朔是未正而在二至後當有減分太陽加時之位必在未正稍東從而測之果在未正之東與減分數合卽知實朔之在未正者確也

加減時卽視時也一曰用時其實朔時一曰平時加減時之用有二其一加減實時爲視時則施之測驗可以得其正位如交食表之加減是其正用也其一反用加減以變視時爲實時則施諸推步可以得其正算如月離表之加減是其反用也然其理無二故其數亦同也【月離表攺用時爲平時卽是據所測視時求其實時以便入算】

古今測驗而得者並以太陽所到之位爲時故曰加時言太陽加臨其地也然則皆視時而已視時實時之分自曆書始發之然有至理歷家所不可廢也

第九求【原爲十求】

月距地者何卽月天之半徑也月天半徑而謂之距地者地處天中故也地恆處天中則半徑宜有恆距而時時不同者生於小輪也月行小輪在其髙度則距地逺矣在其卑度則距地近矣每度之髙卑各異故其距地亦時時不同也

日半徑月半徑者言其體之視徑也論其眞體日必大於月論其視徑日月略相防所以能然者日去人逺月去人近也然細測之則其兩視徑亦時時不防此其故亦以小輪也日月在小輪髙處則以逺目而損其視徑在其卑處則以近日而增其視徑矣

檢表法不同者視半徑表並起最髙而加減表太陽引數起最卑太陰引數起最髙故月實引只用本數而日實引加減六宮也

並徑者日月兩半徑之縂數也兩半徑時時不同故其並徑亦時時不同而時分之深淺因之虧復之距分因之矣

月實行者一小時之實行也其法以月距日之平行每日分爲二十四限卽一小時平行也各以其應有之加減分加減之卽一小時之實行也𨿽虧復距甚未必皆爲一小時而以此爲法所差不逺【此與授時用遲疾行度內減八百二十分者同法】

第十求【原爲十一】

縂時者何也以求合朔時午正黃道度分也何以不言度而言時以便與視朔相加也然則何不以視朔變爲度曰日實度者黃道度也時分者赤道度也若以視朔時變赤道度亦必以日實度變赤道度然後可以相加今以日實度變爲時卽如預變赤道矣此巧算之法也其必欲求午正黃道何也曰以求黃平象限也【卽表中九十度限】何以爲黃平象限曰以大圏相交必互相均剖爲兩平分故黃赤二道之交地平也必皆有半周百八十度在地平之上【黃道赤道地平並爲渾圓上大圏故其相交必皆中剖】其勢如虹若中剖虹腰則爲半周最髙之處而兩旁各九十度故謂之九十度限也此九十度限黃赤道並有之然在赤道則其度常居正午以其兩端交地平常在卯正酉正也黃道則不然其九十度限或在午正之東或在午正之西時時不防【惟二至度在午正則九十度限亦在午正與赤道同法此外則無在午正者而且時時不同矣】其兩端交地平亦必不常在卯正酉正【亦惟二至度在午正爲九十度限則其交地平之處卽二分防而黃道與赤道同居卯酉此外則惟赤道常居卯酉而黃道之交於地平必一端在赤道之外而居卯酉南一端在赤道之內而居卯酉北】而時時不等故也【黃道東交地平在卯正南其西交必酉正北而九十度限偏於午規之西若東交地平在卯正北其西交地平必酉正南而九十度限偏於午正之東則半周如虹者時時轉動勢使然也】蓋黃道在地平上半周之度自此中分則兩皆象限若從天頂作綫過此以至地平必成三角而其勢平過如十字故又曰黃平象限也【地平圏爲黃道所分亦成兩半周若從天頂作弧綫過黃平象限而引長之成地平經度半周必分地平之兩半周爲四象限而此經綫必北過黃極與黃經合而爲一】

問黃平象限在午正必二至日有之乎曰否每日有之也凡太陽東升西沒成一晝夜則周天三百六十度皆過午正而西故每日必有夏至冬至度在午正時此時此刻卽黃平象限與子午規合而爲一每日只有二次也自此二次之外二至必不在午正而黃平象限亦必不在二至矣觀渾儀當自知之

黃平象限表以極出地分何也曰凖前論地平上黃道半周中折之爲黃平象限其兩端距地平不防而自非二至在午正則黃道之交地平必一端近北一端近南【亦前論所明】極出地漸以髙則近北之黃道漸以出近南之黃道漸以沒而黃平象限亦漸以移此所以隨地立表也

求黃平象限何以必用縂時曰黃平象限時時不同卽午規之地亦時時不同是午正黃道與黃平象限同移也則其度必相應是故得午正卽得黃平【黃平限爲某度其午正必爲某度謂之相應然則午正爲某度卽黃平限必某度矣故得此可以知彼】而縂時者午正之度也此必用縂時之理也

日距限分東西何也曰所以定時差之加減也【凡用時差日在限西則加日在限柬則減】

日距地髙何也曰所以求黃道之交角也【時差气差並生於交角又生於限距地及限距日】二者交食之關鍵而非黃平象限無以知之矣

日距地髙何也謂合朔時太陽之地平緯度也亦曰髙弧髙弧之度隨節气而殊故論赤緯之南北赤緯之南北同矣又因裏差而異故論極出地極出地同矣又以加時而變故又論距午刻分極出地者南北裏差距午刻分者東西裏差也合是數者而日距地平之髙可見矣

日赤緯加減宮數者何也緯表○宮起春分而日實度○宮起冬至故三宮以下加九宮三宮以上減去三宮以宮數變從緯表也

視朔時加減十二時者何也求太陽距午刻分也日在地平上之弧度惟正午爲髙其餘則漸以下或在午前或在午後皆以距午爲防其距午同者髙弧之度亦同也視朔滿十二小時是朔在午後也故內減十二時用其餘爲自午正順數若不滿十二時是朔在午前則置十二時以視朔減之而用其餘爲自午正逆推卽各得其距午之刻分矣

其必求髙弧者何也所以求月髙下差也髙下差在月而求日距地髙者日食時經緯必同度故日在地平之髙卽月髙也

何以爲月髙下差曰合朔時太陰之視髙必下於眞髙其故何也月天在日天之內其間尙有空際故地心與地面各殊地所見謂之視髙以較地心所見之眞髙往往變髙爲下以人在地靣傍視而見其空際也故謂之月髙下差【地心見食謂之眞食地靣見食謂之視食眞食有時反不見食見視食時反非地心之眞食縱使地心地靣同得見食而食分深淺亦必不同凡此皆月髙下差所爲也】

月髙下差時時不同其緣有二其一爲月小輪髙卑卽第九求之月距地數也在小輪卑處月去人近則距日逺而空際多髙下差因之而大矣在小輪髙處月去人逺則距日近而空際少髙下差因之而小矣其一爲髙弧卽本求之日距地髙也髙弧近地平從旁視而所見空際多則髙下差大矣髙弧近天頂卽同正視而所見空際少則髙下差小矣【若髙弧竟在天頂卽與地心所見無殊無髙下差】小輪髙卑天下所同髙弧損益隨地各異故當兼論也兩圏交角何也曰日所行爲黃道圏以黃極爲宗者也人在地平上所見太陽之髙下爲地平經圏以天頂爲宗者也此兩圏者各宗其極則其相遇也必成交角矣因此交角遂生三差日食必求三差故先論交角也何以謂之三差曰髙下差也東西差也南北差也是謂三差

三差之內其一爲地平緯差卽髙下差前條所論近地平而差多者也其一爲黃道經差卽東西差其一爲黃道緯差卽南北差此三差者惟日食在九十度限則黃道經圏與地平經圏【卽髙弧】相合爲一而無經差故但有一差【無經差則但有緯差是無東西差而有南北差也而兩經緯旣合爲一則地平之髙下差又卽爲黃道之南北差而成一差】若日食不在九十度而或在其東或在其西則兩經圏不能相合爲一遂有三差【月髙下差恆爲地平髙弧之緯差而黃道經圏自與黃道爲十字正角不與地平經合以生經度之差角是爲東西差又黃道上緯度自與黃道爲平行不與地平緯度合以生緯度之差角是爲南北差東西南北並主黃道爲言與地平之髙下差相得而成句股形則東西差如句南北差如股而髙下差常爲之合之則成三差也】因此三差有此方見日食彼方不見或此見食分深彼見食分淺之殊故交食重之而其源皆出於交角

得數減象限何也以表所列爲余角也表何以列余角曰三差旣爲句股形則有兩圏之交角卽有其餘角而交角所對者爲气差【卽南北差】余角所對者爲時差【卽東西差】作表者蓋欲先求時差故列余角然與兩圏交角之名不相應故減象限而用其餘以歸交角本數也

定交角何也所以求三差之眞數也何以爲三差眞數曰日食三差皆人所見太陰之視差而其根生於交角則黃道之交角也殊不知太陰自行白道與黃道斜交其交於地平經圏也必與黃道之交不同角則所得之差容有未眞今以陰陽曆交黃道之角加減之爲定交角以比兩圏交角之用爲親切耳【詳補遺】時差古云東西差其法日食在東則差而東爲減差減差者時刻差早也日食在西則差而西爲加差加差者時刻差遲也其故何也太陽之天在外太陰之天在內並東陞而西降而人在地靣所見之月度旣低於眞度則其視差之變髙爲下者必順於黃道之勢故合朔在東陞之九十度必未食而先見【限東一象限東下西髙故月之眞度尙在太陽之西未能追及於日而以視差之變髙爲下亦遂能順黃道之勢變西爲東見其掩日矣】若合朔在西降之九十度必先食而後見【限西一象限黃道西下東髙故月之眞度𨿽已侵及太陽之體宜得相掩而以視差之故變髙爲下遂順黃道之勢變東而西但見其在太陽之西尙逺而不能掩日矣】而東西之界並自黃道九十度限而分此黃平象限之實用也問日月以午前東升午後西降何不以午正爲限而用黃平象限乎曰此西法之合理處也何以言之日月之東升西降自午正而分者赤道之位終古常然者也日月之視差東減西加自九十度限而分者黃道之勢頃刻不同者也若但從午正而分則加減或至於相反授時古法之交食有時而疏此其一端也問加減何以相反曰黃平限旣與午正不同度則在限爲西者或反爲午正之東在限爲東者或反爲午正之西日食遇之則加減相違矣假如北極出地四十度設午正黃道【卽縂時】爲寶瓶十七度其黃平限爲防魚十一度在午正東二十四度而日食午初日實度躔二宮二度在限西九度宜有加差若但依午正而分則食在午前反當有減差是誤加爲減算必先天矣又設午正爲天蠍二度其黃平象限爲天秤八度在午正西二十四度而日食午正後二刻日實度躔九宮二十四度距限東十六度宜有減差若但依午正而分則食在午後反有加差是又誤減爲加算必後天矣

時差表有倒用之說何也曰此亦因交角表誤列余角也今旣以交角表之數減九十度爲用則交角已歸原度而此表不湏倒用矣

近時距分者何也卽視朔時或加或減之時刻分也所以有此加減者時差所爲也然何以不徑用時差曰時差者度分也以此度分求月之所行則爲時分矣【查歷指所謂時差卽近時距分而東西差卽時差表皆易之今姑從表以便查數也】

近時何也所推視朔時與眞朔相近之時也食在限東此近時必在視朔時以前故減食在限西近時必在視朔時以後故加

十一求【原爲十二】

近縂時何也近時之午正黃道度也朔有進退午正之黃道亦因之進退故仍以近時距分加減十求之視朔午正度爲本求之近時午正度

旣有近時又有近時之午正度則近時下之日距限及距限地髙日距地髙以及月髙下差兩圏交角凡在近時應有之數一一可推因以得近時之時差矣【內除月距地數在九求日赤緯在十求並用原數其餘並攺用近時之數故皆復求然求法並同十求】旣得時差可求視行

視行者何也卽近時距分內人目所見月行之度也何以有此視行曰時差所爲也蓋視朔旣有時差則此時差所到之度卽視朔時人所見月行所到差於實行之較也視朔旣攺爲近時則近時亦有時差而又卽爲人所見近時月行所到差於實行之較矣此二者必有不同則此不同之較卽近時距分內人所見月行差於月實行之較矣故以此較分加減時差爲視行也本宜用前後兩小時之時差較加減月實行爲視行【如用距分減視朔者則取視朔前一小時之時差若距分加視朔者則取視朔後一小時之時差各取視朔時差相減得較以加減月實行卽爲一小時之視行】再用三率比例得眞時距分法爲月視行與一小時若時差度與眞時距分也今以近時內之視行取之其所得眞時距分防

何以明其然也曰先得時差卽近時距分之實行也實行之比例防則視行之比例亦防

一一小時實行一小時視行法爲一小時之實行與二一小時

一小時

一小時若時差度與近三時差【近時距分之實行】視行【卽近時距分之視行】時距分則一小時之視四近時距分

近時距分

行與一小時亦若視行

度與近時距分也

一一小時視行視行

今一小時視行與一小二一小時

近時距分

時旣若時差與眞時距

三時差

時差

分則視行與近時距分四眞時距分眞時距分

亦必若時差與眞時距

分矣

問視行之較一也而或以加或以減其理云何曰凡距分之時刻變大則所行之度分變少故減實行爲視行若距分之時刻變小則所行之度分變多故加實行爲視行假如視朔在黃平限之東時差爲減差而近時必更在其東其時差亦爲減差乃近時之時差所減大於視朔所減是爲先小後大其距分必大於近時距分而視行小於實行其較爲減又如視朔在黃平限之西時差爲加差而近時必更在其西時差亦爲加差乃近時之時差所加大於視朔所加是亦爲先小後大其距分亦大於近時距分而視行亦小於實行故其較亦減二者東西一理也若視朔在黃平限東其時差爲減而近時時差之所減反小於視朔所減又若視朔在黃平限西其時差爲加而近時時差之所加反小於視朔所加此二者並先大後小則其距分之時刻變小矣時刻變小則視行大於實行而其較應加東西一理也

如圖戊爲黃平象限甲爲視朔甲乙爲視朔時差甲丙甲丁並近時時差其甲乙時差爲視朔時順黃道而差低之度變爲時卽爲近時距分此分在限東爲減差若在限西

卽爲加差其理一也若以甲丙爲近時差則大於甲乙其較度乙丙依實行比例求其較時則距分變而大矣距分變大者行分變小法當於甲乙差度內減去乙丙較度【卽乙庚】其餘如甲庚則是先定甲乙距分行行甲乙度者爲實行而今定甲乙距分只行甲庚度者爲視行也故在東在西皆減也

又若以甲丁爲近時差則小於甲乙其較乙丁依實行比例求其較時則距分變而小矣距分變小者行分變大法當於甲乙差度外加入乙丁較度【亦卽乙庚】成甲庚則是先定甲乙距分行甲乙度者爲實行而今定甲乙距分能行甲庚度者爲視行也故在東在西皆加也防法用倍時差減近時差何也曰卽加減也何以知之曰凡時差先小後大者宜減今於倍小中減一大是於先得時差內加一小時差減一大時差也卽如以較數減先時差矣先大後小者宜加今於倍大內減一小是於先得時差內加一大時差減一小時差也卽如以較數加先時差矣數旣相合而取用不煩法之善者也眞時距分者何也卽視朔時或加或減之眞時刻也其數有時而大於近時距分亦有時而小於近時距分皆視行所生也視行小於實行則眞時距分大於近時距分矣視行大於實行則眞時距分小於近時距分矣其比例爲視行度於近時距分若時差度與眞時距分也眞時何也所推視朔之眞時刻也眞時在限東則必早於視朔之時眞時在限西則必遲於視朔之時此其於視朔並以東減西加與近時同惟是眞時之加減有時而大於近時有時而小於近時則惟以眞時距分爲防不論東西皆一法也

若眞時距分大於近時距分而在限東則眞時更先於近時在限西則眞時更後於近時是東減西加皆比近時爲大也若眞時距分小於近時距分而在限東則眞時後於近時在限西則眞時先於近時是東減西加皆比近時爲小也

十二求【原爲十三】

眞縂時何也眞時之午正黃道也故仍以眞時距分加減視朔之縂時爲縂時【卽是攺視朔午正度爲眞時午正度】

近時旣攺爲眞時卽食甚時也然容有未眞故復考之考之則必於眞時復求其時差而所以求之之具並無異於近時所異者皆眞時數耳【謂日距限限距地髙日距地髙月髙下差兩圏交角防項並從眞時立算】是之謂眞時差

旣得眞時差乃別求眞距度以相考則食甚定矣【考定眞時全在此處】何以爲眞距度曰卽眞時距分內應有之月實行也蓋眞時差是從眞時逆推至視朔之度眞時距分內實行是從視朔順推至眞時之度此二者必相等故以此考之考之而防則眞時無誤故卽命爲食甚定時也

其或有不防之較分則以法變爲時分而損益之於是乎不防者亦歸於相防是以有距較度分考定之法也距較度分者距度之較也損益分者距時之較也其比例亦如先得時差度與眞時距分故可以三率求也眞時差大者其距時亦大故以益眞時距分益之則減者益其減原在限東而眞時早者今乃益早若加者亦益其加原在限西而眞時遲者今則益遲矣眞時差小者其距時亦小故以損眞時距分損之則減者損其減原在限東而眞時早者今攺而稍遲若加者亦損其加原在限西而眞時遲者今攺而稍早矣

如是考定眞時距分以加減視朔爲眞時卽知無誤可謂之考定食甚時也

气差古雲南北差凖前論月在日內人在地靣得見其間空際故月緯降髙爲下夫降髙爲下則亦降北爲南矣此所以有南北差也【南北差生於地勢中國所居在赤道之北北髙南下故也】然又與髙下差異者自天頂言之曰髙下自黃道言之曰南北惟在正午則兩者合而爲一髙下差卽爲南北差其餘則否

气差與時差同根故有時差卽有气差而前此諸求但用時差者以食甚之時未定重在求時也今則旣有眞時矣當求食分故遂取气差也【時差气差並至眞時始確】

十三求【原爲十四】

距時交周何也卽實朔距眞時之交周行分也故以實朔與眞時相減之較查表數然何以不用視朔曰原算實交周是實朔故也

定交周者何也眞時之月距交度也食甚旣定於眞時則一切視差皆以食甚起算故必以實朔交周攺爲食甚之交周斯之謂定交周也月食黃緯者食甚時月行陰陽曆實距黃道南北之緯度也月視黃緯者食甚時人所見月距黃道南北緯度則气差之所生也月行白道日行黃道帷正交中交二防月穿黃道而過正在黃道上而無距緯其距交前後並有距緯而每度不同然有一定之距是爲實緯實緯因南北差之故變爲視緯卽無一定之距隨地隨時而異但其變也皆變北爲南假如月行陰曆實緯在黃道北則與黃道實逺者視之若近焉故以气差減也若月行陽曆實緯在黃道南則與黃道實近者視之若逺焉故以气差加也至若气差反大於實緯則月𨿽陰曆其實在黃道北而視之若在南故其气差內減去在北之實緯而用其餘數爲在南之視緯也

並徑減距者何也並徑所以定食分減距所以定不食之分也距者何也卽視緯也並徑則日月兩半徑之合數也假令月行陰曆其北緯與南北差同則無視緯可減而並徑全爲食分其食必旣其餘則皆有距緯之減而距大者所減多其食必淺距小者所減少其食必深是故並徑減余之大小卽食分之所由深淺也若距緯大於並徑則日月不相及或距緯等於並徑則日月之體相摩而過不能相掩必無食分矣

並徑內又先減一分何也曰太陽之光極大故人所見之食分必小於眞食之分故預減一分也

然則食一分者卽不入算乎曰非也並徑之分度下分也【毎六十分爲一度】食分之分太陽全徑之分也【以太陽全徑十平分之假令太陽全徑三十分則以三分爲一分】是故並徑所減之一分於食分只二十餘秒

問日月兩半徑旣時時不同則食分何以定曰半徑𨿽無定而比例則有定但以並徑減余與太陽全徑相比則分數覩矣【分太陽全徑爲十分卽用爲法以分並徑減距之餘分定其所食爲十分中幾分】有時太陰徑小於太陽則𨿽兩心正相掩而四面露光歷家謂之金環是其並徑亦小於太陽全徑𨿽無距緯可減而不得有十分之食故也【細艸原用表今攺用三率其理較明法亦簡易】

十四求

日食月行分者何也乃自虧至甚之月行度分也【自甚至復同用】其法以並徑減一分常爲視緯常爲句句求股卽得自食甚距虧與復之月行度分矣

【按此卽授時歷開方求定用分之法所異者並徑時時增減與舊法日月視徑常定不變者殊耳】

前總時何也卽食甚前一小時之午正度也得此午正度卽可得諸數以求前一小時之時差謂之前時差前時差與眞時差之差分卽視行與實行之差分故以差分加減實行得視行也假如日在限西而前時差大於眞時差是初虧所加多而食甚所加反少也以此求虧至甚之時刻則變而小矣時刻小則行分大故以差分加實行爲視行若日在限西而前時差小於眞時差是初虧所加少而食甚所加漸多也以此求虧至甚之時刻則變而大矣時刻大則行分必小故以差分減實行爲視行若日在限東而前時差大於眞時差是初虧所減多而食甚所減漸少也以此求虧至甚之時刻則變而大矣時刻大者行分小故以差分減實行爲視行若日在限東而前時差小於眞時差是初虧所減少而食甚所減反多也以此求虧至甚之時刻則變而小矣時刻小者行分大故以差分加實行爲視行食甚定交角滿象限不用差分何也無差分也何以無差分曰差分者時差之較也食甚在限度卽無食甚時差無可相較故初虧徑用前時差復圓徑用後時差又食甚在限度則初虧距限東而前時差恆減復圓距限西而後時差恆加減時差則初虧差而早加時差則復圓差而遲其距食甚之時刻並變而大也時刻大者行分小故皆減實行爲視行【又若初虧復圓時定交角滿象限亦無差分而徑用食甚之時差減實行爲視行與此同法其初虧復圓距食甚之刻分亦皆變大而行分變小也視行之理此爲較著】初虧距時分者初虧距食甚之時刻也用上法得視行爲食甚前一小時之數而初虧原在食甚前則其比例爲視行之於一小時猶日食月行之於初虧距時故可以三率取之也【日食月行減一義見前條】

旣得此初虧距分則以減食甚而得初虧時刻也

十五求

後縂時者卽食甚後一小時之午正度分也用此午正度得諸數以求後一小時之時差爲後時差又以後時差與眞時差相較得差分以加減實行爲視行並同初虧但加減之法並與初虧相反

假如日在限西而後時差大於眞時差是食甚所加少而復圓所加多則甚至復之時刻亦變而大矣時刻大者行分小故以差分減實行爲視行

若日在限西而後時差小於眞時差是食甚所加多而復圓所加反少則甚至復之時刻亦變而小矣時刻小者行分大故以差分加實行爲視行

假如日在限東而後時差大於眞時差是食甚所減少而復圓所減反多則甚至復之時刻變而小矣時刻小者行分大故以差分加實行爲視行

若日在限東而後時差小於眞時差是食甚所減多而復圓所減少則甚至復之時刻變而大矣時刻大者行分小故以差分減實行爲視行【食甚在限度求視行之理已詳十四求】復圓距時分三率之理並與初虧同惟復圓原在食甚後故加食甚時刻爲復圓時刻

十六求

黃道宮度內減宿鈐何也黃道宮度起冬至各宿黃道起距星也凡距星所入宮度必小於日實度宮度故以相減之較爲食甚時所入本宿度分也其每年加五十一秒者恆星東行之度卽古嵗差法也因嵗差所加故有宿鈐在日實度以下而變爲日實度以上則食甚時所入非其宿矣故退一宿用之也其以嵗差【五十一秒】乘距算【本年距歷元戊辰】之數各宿並同𨿽退一宿所加不異也赤道宮度可以升度取者黃道上升度一定也若赤道宿度則不可以升度取何也各宿距星多不能正當黃道而在其南北各有緯度故必以弧三角求之爲正法也

此後原有十七求以算東西異號今省不用何也曰東西異號之算曆書語焉不詳故細艸補作之亦有思致但所求者仍爲黃平象限之東西故必復求定交角今於十四求十五求卽得定交角爲白道限度之東西簡易直防可不必更多葛藤矣故省之也

附說補遺

求縂時條加減十二時

問求縂時與求日距地髙二條並以視朔與十二時相加減然後用之而用法不同何也曰求縂時條是欲得午正黃道距春分之升度故並從午正後順推【如視朔過十二時則內減十二時而用其餘數是從午正後數其距視朔之時刻也若視朔不及十二時則以十二時加之是從先日午正後數其距今視朔之時刻也故其法皆爲順數】日距地髙條是欲得視朔距午正之度故各從午正前後順推逆數【如視朔爲十二時去之而用其餘數是從視朔時逆推其己過午正之刻也若視朔不滿十二時則置十二時以視朔時減之而用其餘數是從視朔順數其未及午正之刻也其視朔滿十二時減去之兩法並同惟視朔不滿十二時用法則異】

附又法

問視朔在午前若用減十二時法亦可以得縂時乎曰可其法亦如求日距地髙置十二時以視朔時減之求到視朔未至午之刻去減日實度距春分時刻【卽九十度表第二行對日實度之時刻】亦卽得縂時與上法同此法可免加滿二十四時去之然遇日實度距春分時刻不及減又當加二十四時然後可減矣假如日實度是春分後相距只一時而視朔在午正前三時是爲日實度小不及減法當以日實度加二十四時作二十五時減去三時餘二十二時爲總時

定交角或問

問定交角滿象限以上反其加減何也曰此變例也西曆西加東減並以黃道九十度限爲宗今用定交角則是以白道九十度限爲宗而加減因之變矣

問白道亦有九十度限乎曆書何以未言曰曆書𨿽未言然以大圏相交割之理徵之則宜有之矣何則月行白道亦分十二宮【視月緯表可見】則亦爲大圏其交於地平也亦半周在地平上則其折半之處必爲白道最髙之處而亦可名之爲九十度限矣【或可名白道限度】

若從天頂作髙弧過此度以至地平則成十字正角而其圏必上過白道之極成白道經圏與黃平象限同【黃平象限上十字經圏串天頂與黃道極故亦成黃道經圏與此同理】月在此度卽無東西差而南北差最大與髙下差等【前論月在黃平象限無東西差而卽以髙下差爲南北差其理正是如此但月行白道當以白道爲主而論其東西南北始爲親切】若月在此度以東則差而早宜有減差在此度以西則差而遲宜有加差但其加減有時而與黃平象限同有時而與黃平限異故有反其加減之用也

問如是則白道亦有極矣極在何所曰白道有經有緯【凡東西差皆白道經度南北差皆白道緯度】則亦有南北二極爲其經緯之所宗但其極與黃極恆相距五度以爲定緯【𨿽亦有小小增減而大致不變】其經度則嵗嵗遷動至滿二百四十九交而徧於黃道之十二宮則又復其始【約其數十九年有奇】法當以黃極爲心左右各以五緯度爲半徑作一小圓以爲載白道極之圏再以正交中交所在宮度折半取中卽於此度作十字經圏必串白道極與黃道極矣則此圏之割小圓防卽白道極也問何以知此圏能過黃白兩極也曰此圏於黃道白道並作十字正角故也【凡大圏上作十字圏必過其極】問此圏能串兩極則限度常在此度乎曰不然也此度能串黃白兩極而未必其串天頂如黃道上極至交圏也若限度則必串天頂以過白極而未必其過黃極如黃道上之黃平限也是故白道上度處處可爲限度亦如黃道上度處處可爲黃平限但今在地平上之白道半周某度最髙卽其兩邊距地平各一象限從此度作十字經圏必過天頂而串白道之兩極何也此圏過地平處亦皆十字角卽與地平經圏合而爲一所謂月髙下差卽在此圏之上矣【惟白道半交爲限度能與黃平限同度此外則否況近交乎故必用定交角也】

以定交角推白道限度

白道限度大約在黃道交角之八十五度【定交角三此滿象限過此則有異號】

若太陰定交周是○宮十一宮而黃平限在午正之東乃白道限度則更在其東而原以限東宜減者今或以定交角大而變爲限西宜加矣

若定交周是五宮六宮而黃平限在午正西白道限度必更在其西而原以限西宜加者今或以定交角大而變爲限東宜減矣

以上二宗並離午正益逺交食遇此則古法益疏而新法猶近

若定交周是○宮十一宮而黃平限在午正西乃白道限度或尙在其東而原以限東宜減者今以定交角大而變爲限西宜加矣

若定交周是五宮六宮而黃平限在午正東乃白道限度或尙在其西而原以限西宜加者今以定交角大而變爲限東宜減矣

以上二宗並離黃平限而近午正交食遇此則有時古法反親而新法反疏若白道限度徑在午正則古法宻合矣

由是之加減東西差宜論白道明甚曆書略不言及豈非缺陷之一大端

問定交角者所以變黃道交角爲白道交角也然何以不先求白道限度曰交角者生於限度者也交角變則限度移矣故先得限度可以知交角【交角之向指以距限東西而異交角之大小以距限逺近而殊】而旣得交角亦可以知限度故不必復求限度也

其加減以五度何也曰取整數也古歷測黃白大距爲六度【以西度通之得五度五十四分奇】西曆所測只五度奇而至於朔望又只四度五十八分半今論交角故祗用整數也【若用弧三角法求白道限度所在及其距地之髙並可得交角細數然所差不多蓋算交食必在朔望又必在交前交後故也】

問五度加減後何以有異號不異號之殊曰近交時白道與黃道低昻異勢者也【惟月在半交能與黃道平行亦如二至黃道之與赤道平行也若交前交後斜穿黃道而過不能與黃道平行亦如二分黃道之斜過赤道也故低昻異勢】然又有順逆之分而加減殊焉其白道斜行之勢與黃道相順者則恆減減惟一法【減者角損而小也𨿽攺其度不變其向】若白道與黃道相逆者則恆加加者多變遂有異號之用矣【加者角增而大也增之極或滿象限或象限以上遂至攺向】

是故限西黃道皆西下而東髙限東黃道皆西髙而東下此黃道低昻之勢因黃平象限而異者也而白道正交【○宮十一宮也卽古法之中交】自黃道南而出於其北亦爲西下而東髙【黃道半周在地平上者偏於天頂之南以南爲下北爲上正交白道自南而北如先在黃道之下而出於其上故比之黃道爲西下而東髙也】白道中交【五宮六宮也卽古法之正交】自黃道北而出於其南亦爲西髙而東下【白道自北而南如先在黃道之上而出於其下故比之黃道爲西髙而東下也】

假如日食正交而在限西日食中交而在限東是爲相順相順者率於交角減五度爲定交角是角變而小矣角愈小者東西差愈大故低昻之勢增甚而其向不易也【限西黃道本西下東髙而正交白道又比黃道爲西下東髙則向西之角度變小而差西度增大其時刻遲者益遲矣限東黃道本西髙東下而中交白道又比黃道爲西髙東下則向東之角度變小而差東之度增大其時刻早者益早矣是東西之向不易而且增其勢也】

假如日食正交而在限東日食中交而在限西是爲相逆相逆者率於交角加五度爲定交角是角變而大矣角愈大者東西差愈小故低昻之勢漸平而甚或至於異向也【限東黃道本西髙東下而正交白道比黃道爲西下東髙則向東之角漸大而差東度攺小時刻差早者亦漸平若加滿象限則無時差乃至滿象限以上則向東者攺而向西時刻宜早者反差遲矣限西黃道本西下東髙而中交白道爲西髙東下則向西之角漸大而差西度攺小時刻差遲者亦漸平若加滿象限則無時差乃至滿象限以上則向西者攺而向東而時刻宜遲者反差而早矣】

凡東西差爲見食甚早晚之根如上所論定交角所生之差與黃道交角無一同者則欲定眞時刻非定交角不可也若但論黃道交角時刻不眞矣

凡東西差與南北差互相爲消長而南北差卽食分多少之根如上所論則欲定食分非定交角不能也但論黃道交角食分亦悞矣

差分有用並之理

問差分本以兩時差相較而得【十四求已有備論】今乃有用並之法何也曰異號故也此其白道限度必在兩食限之間【或限度在甚與復兩限之間則食甚在限東而復圓限而或限度在虧與甚之間則食甚在限西而初虧限東】兩食限一距限東一距限西其兩時差必一爲減號一爲加號是爲東西異號無可相較故惟有相並之用也

乃若定交角大於象限則先爲同號而變爲異號其食甚必在黃平限及白道限度之間【食甚在黃平限西白道限度東則先推食甚復圓同號者變爲異號矣食甚在黃平限東白道限度西則先推食甚初虧同號者變爲異號矣】兩食限旣變爲東西異號則其兩時差亦一加一減變爲相並矣

問異號恆相並固也乃復有定交角過九十度而仍用相較爲差分者何也曰此異號變爲同號也其黃平限必在兩食限之間而白道限度或反在食限之外則能變異號爲同號【假令黃平限在復與甚之間甚距限東復距限西本異號也而復圓之定交角過象限則白道限度必又在復圓之西而先推黃平限復圓在西者今推白道限度復圓在限東卽復圓食甚變爲同號矣又加黃平限在虧與甚之間虧距限東甚距限西本異號也而初虧之定交角過象限則白道限度必又在初虧之東而先推黃平限初虧在東者今推白道限度初虧在限西卽初虧食甚變爲同號矣】又如前論食甚在黃平限及白道限度之間能變同號爲異號卽亦能變異號爲同號【凖前論食甚在黃平限西白道限度東能變食甚與復圓異號則先推食甚與初虧異號者今反同號矣若食甚在黃平限東白道限度西能變食甚與初虧異號則先推食甚與復圓異號者今反同號矣】凡此之類變態非一皆於定交角取之故可以不用十七求也

相並爲差分者並減實行爲視行之理

問用差分取視行有減實行加實行之異而相並爲差分者一例用減何也曰凡相較爲差分者有前小後大前大後小之殊故其於實行有減有加【觧見前條】減者常法加者變例也【凡減實行爲視行者在限東者益差而東在限西者益差而西食限中如此者多故爲常法若加實行爲視行者限東者反損其差東之度在西者反損其差西之度乃偶一有之故爲變例】若相減爲差分者不論前後之大小縂成一差故於實行有減無加只用常法也【十四求附說論食甚初虧復圓三限定交角滿象限並用時差減實行與此同理蓋彼以無可相較故徑用一時差此則𨿽有兩時差不以相較而且以相益故其時刻並變大而行分變小故皆減實行爲視行也】

己爲天頂庚爲黃道極丑寅癸爲地平子爲黃平象限度子辛丙癸爲地平上黃道之一象限甲乙丁壬爲黃道北緯己乙丙寅爲地平經圏乙爲天上太陰實緯【在黃道北】丙爲人所見太陰視度【正當黃道】乙丙爲髙下差【是地平上髙弧差】乙丁爲東西差【是黃道經度差】丙丁爲南北差【是黃道緯度差】蓋髙卑差以天頂爲宗下至地平爲直角南北差以黃極爲宗下至黃道爲直角東西差以中限爲宗下至黃極爲直角而其根皆生於地靣與地心不同視之故也

設太陰實髙在乙視髙在庚髙弧上乙庚之距爲髙下差

從黃極出經綫至太陰實度【乙】又從黃極出經綫至視度庚必過【丁】黃道上乙丁之距爲東西差

實度乙正當黃道視度庚在黃道南其距丁庚緯度與乙丙防是爲南北差

設太陰實髙在庚視髙在乙髙弧上庚乙之距爲髙下差

從黃極出經綫二一過實髙庚指黃道度丁一過丙至視度乙黃道丁乙之距爲東西差【與丙庚防】

實度庚在黃道北其緯度庚丁與丙乙防視度乙正當黃道無緯度丙乙爲南北差【與丁庚防】

設太陰實髙在辛視髙在庚髙弧上辛庚之距爲髙下差

從黃極出經綫二一過太陰實髙度辛至黃道乙乙爲實度一過北緯甲及黃道丁至太陰視髙度庚丁爲視度黃道上乙丁之距爲東西差【與甲辛丙庚防】

月實緯辛在黃道北其距辛乙與甲丁防視緯庚在黃道南其距丁庚與乙丙防甲庚爲南北差【與辛丙防】歷算全書卷二十七

欽定四庫全書

歷算全書卷二十八

宣城梅文鼎撰

交食防求卷三【訂補】

月食

一求諸平行

首朔根

查二百恆年表本年下首朔等五種年

根並紀日錄之

朔策望策

用十三月表以所求某月五種朔策並

望策之數錄於各年根之下

平望

以首朔日時與朔策望策並紀日並之

【滿二十四時進一日滿六十日去之】

太陽平引

以太陽引根與朔策望策並之【滿十二宮去之

後並同】

太陰平引

以太陰引根與朔策望策並之

交周平行

以交周度根與朔策望策並之

隨視其宮度以辧食限

○宮○六宮十五度以內

五宮十一宮十五度以外

以上宮度俱有食

太陽經平行以太陽經度根與朔望二策並之二求日月相距

日定均

以太陽平引宮度查一卷加減表如平

引滿三十分進一度查之【記加減號】

月定均

以太陰平引宮度查一卷加減表如平

引滿二十分進一卷查之【記加減號】

距弧

以日月定均同號相減異號相並卽得

距時

以距弧度分於四行時表月距日橫行內查得相當或近小數以減距弧得時【視相當近小數本行上頂格所書時數錄之卽是】其餘數再如法查取得時之分秒【依上法用相當近小數取之】並所查數卽爲距時

隨定其加減號

兩均同加者日大則加日小則減

兩均同減者日大則減日小則加

兩均一加一減者

加減從日

三求實引

日引弧

以距時時及分查四行時表太陽平行

兩數並之【依距時加減號】

日實引

置太陽平引以日引弧加減之卽得月引弧

查四行時表取距時時分下太陰平行

兩數並之【依距時加減號】

月實引

置太陰平引以月引弧加減之卽得四復求日月相距

日實均

以日實引宮度查一卷加減表如實引

滿三十分進一度查之【記加減號】

月實均

以月實引宮度查一卷加減表如實引

滿三十分進一度查之【記加減號】

實距弧

以日月實均同減異加卽得

實距時

以實距弧度分查四行時表與前距時

同【加減號亦同前】

五求實望

實望

置平望以實距時加減之卽得如加滿二十四時則進一日不及減借二十四時減之【則實望退一日】

六求實交周

交周距弧

查四行時表實距時時分下交周平行

兩數並之卽得【依實距時加減號】

交周次平行置交周平行以交周距弧加減之卽得【凡加者滿三十度進一宮滿十二宮去之爲○宮減者遇所減度數反小則加三十度退一宮減之○宮度不及減則加十二宮然後減之】

實交周

置月實均【記加減號】以加減交周次平行卽

得

七求月距黃緯

月距黃緯

以實交周查太陰距度表依中比例法

求之

假如實交周十一宮十九度十四分先以十九度查得五十六分五十三秒又以十九度與二十度之數相減得較五分○七秒化作三百○七秒與實交周小餘十四分相乘用六十分爲法除之得七十一秒収作一分十一秒以減十九度之數得五十五分四十二秒卽月距緯【其緯在南】中比例加減法視表上數前【少多】後【多少】者【加減】

又法視表上宮名在上者以所得

中比例數加○宮六宮是也表上

宮名在下者以所得中比例數減五

宮十一宮是也

辧交食月緯南北法

視實交周是【○六】宮【五十一】宮其緯在【北南】

八求徑距較數

月半徑

以月實引查二卷視半徑表卽得影半徑

月半徑下層卽景半徑

景差

以日實引加減六宮查視半徑表卽得

實景

景半徑內減去景差卽實景

並徑

以實景加月半徑卽得

並徑減距

置並徑以月距緯減之卽得如距緯大

於並徑不及減則不得食矣

九求食分

食分

以月半徑倍之爲一率並徑減距爲二率月食十分爲三率二三相乘一率除之卽得食分

十求躔離實度

日距弧

以實距時時分查四行時表太陽平行

兩數並之卽得【依實距時加減號】

日次平行

置太陽經平行以日距弧加減之卽得日實度

置日實均【記加減號】以加減日次平行卽得月實度

以日實度加減六宮卽月實度【記寫宮名】十一求視望

加減時

以日實度查一卷加減時表卽得【記加減號】

視望

置實望以加減時加減之卽得

十二求所食時刻

月實行

以月實引查二卷太陰實行表得之【實行表三度一查假如某宮一度二度俱在○度下查若四度五度俱在三度下查餘仿此】

初虧距弧

以距緯加並徑與並徑減距相乘平方

開之卽得

初虧距【時分】

置距弧用三率法化時卽得

食旣距弧

實景內減去月半徑餘數與距緯相加爲和相減爲較和較相乘平方開之卽得

食旣距【時分】

置距弧用三率法化時卽得

三率法

月實行化秒爲一率六十分爲二率【初虧食旣】距弧化秒爲三率求得【初虧食旣】距【時分】爲四率

初虧時刻

置視望以初虧距【時分】減之卽初虧時刻復圓時刻

置視望以初虧距【時分】加之卽復圓時刻食限縂時

復圓時刻內減去初虧時刻卽縂時食旣時刻

置視望以食旣距【時分】減之卽食旣時刻生光時刻

置視望以食旣距【時分】加之卽生光時刻旣限縂時

生光時刻內減去食旣時刻卽得十三求宿度

黃道宿

以黃道距宿鈐減月實度卽得【記寫宿名】其宿鈐每年加嵗差行五十一秒如實度小於宿鈐不及減攺前宿

赤道宮度

以月實度用弧三角求之卽得【記寫宮名

求赤道經緯弧三角法見日食防求下同】

赤道宿度

以所入宿黃道經緯【加過嵗差之宮度爲經其緯用恆星表取之】用弧三角法求到本宿赤道經度以減月赤道度得食甚時赤道宿度【如不及減取前一宿如法用之】

十四求各限地平經緯

各限交周

置實交周以初虧食旣距弧加減之得

各限交周【以查月距度表得各限月緯】

黃白差角

定爲四度五十九分【此朔望交角也各限有微差可以不論】

是○宮【十一】宮上方差角在黃經度西是五宮六宮上方差角在黃經度東用月實度入極圏交角表取其餘度卽得是【○一二三四五】宮上方差角在赤經度西是【六七八九十十一】宮上方差角在赤經度東

月赤道差

以所推黃白黃赤兩差角東西同號者相並異號者相減卽得【記東西號】其異號以小減大並以度之大者爲主命其東西

以上所推食甚時差角各限同用【各限亦有微差可以勿論】

距午度分

置各限時刻如在子後者卽爲距午時【此從午正順數】如食在子前者置二十四時以各限時刻減之餘爲距午時【此從午正逆推】再以時變爲度卽得各限太陰距午度分時變度法每一時變十五度每時下一分變度下十五分時下四分成一度時下一秒變度下十五秒時下四秒成一分秒滿六十収爲分分滿六十収爲度

各限髙度【卽地平緯】以極距天頂爲一邊月實度距北極爲一邊【以黃赤距度南加北減象限得之】二邊相加爲縂相減爲存存縂各取余相加減【縂弧不過象限相減縂弧過象限相加若存弧亦過象限則仍相減】並折半爲初數【各限同用】乃以各限距午度取其矢【距午度過象限則用大矢】以乘初數去末五位爲矢較用加存弧矢得對弧矢矢減半徑得余命爲髙度正查表得髙度【所得對弧卽月距天頂乃髙度之餘故其餘卽髙度正】

一率【半徑】二率【角之矢】三率【初數】四率【兩矢較】

各限方向【卽地平經】以極距天頂爲一邊月距天頂爲一邊【髙度之餘】二邊相加爲縂相減爲存存縂各取余相加減【並如髙度法】如法取初數【各限不同】乃以月距北極爲對弧取其矢【月在赤道南用大矢】與存弧矢相減爲矢較進五位爲實初數爲法實如法而一得所求矢【卽地平經度皆子午規所作天頂角度分之大小矢】矢與半徑相減得余查其度命爲月距正子午方地平經度【凡正矢去減半徑得鋭角余其度子後食者逆推子前食者順數並距正子方立算大矢內減半徑得鈍角余其度子後食者順數子前食者逆數並距正午方立算卽得各限月在地平上方位】

一率【初數】二率【兩矢較】三率【半徑】四率【角之矢】

地經方位度分鈐【鋭角用本度鈍角用外角度並以余查表取之】

地經赤道差以月距北極爲一邊月距天頂爲一邊二邊相加爲縂相減爲存存縂各以余相加減【如前法】取初數【各限不同】以天頂距北極爲對邊取其矢【各限同用】與存弧矢相減得矢較進五位爲實初數爲法實如法而一得差角矢【從北極作赤道經圏過月心又從天頂作髙弧過月心得此差角】矢減半徑得余命度【記東西號】

地經白道差置所推地經赤道差以月赤道差加減之【東西同號者相並異號者相減】卽得各限白道經度差於地經髙弧之數【記東西號】若月赤道差大於地經赤道差法當反減其號東西互易並以月赤道差之號命其東西【月食有初虧子前復圓子後者各依本限論之各限時刻在子前用子前法在子後用子後法】此綫所指卽月行白道之極【猶赤經綫之指北極】

訂補月食繪圖法

赤經主綫

縂圖先作立綫以象赤道經此綫上指北極下指南極綫左爲東綫右爲西爲作圖主綫

闇虛食限

主綫上取一防爲心地景半徑爲度作圓形以象闇虛又以闇虛心爲心並徑【景半徑月半徑相加】爲度作大圓於闇虛之外是爲食限又徑較爲度【景半徑月半徑相減】作小圓於虛闇之內是爲旣限

黃道交角

以月實度入極圏交角表取之命爲食

甚時黃道與赤經所作之角

黃道綫

依黃道交角度分作角於主綫左右皆自主綫起算數食限上度分作識向闇虛心作直綫令兩端透出卽上下各成相對二角並如黃道交赤道之角而此綫象黃道

凡上方角度【右順左逆】下方角度【左順右逆】並自主綫起算數食限大圓周度分作識從此作過心直綫至對邊則角度皆防

白道經度

依所推月赤道差角於赤經左右數其度【亦借圓邊數之其左右如先所推】作識向圓心作直綫而透出之卽食甚時白道經綫

白道

虧復各取月緯於黃道上下作兩平行虛綫【陽曆用南緯此二平行綫作於黃道下方陰曆用北緯作兩平行綫於黃道上方】虛綫兩端必與食限大圓相遇而各成一防依法各取其合用之防聫爲一直綫卽自虧至復所行白道也【交前先逺後近以逺防爲初虧近防爲復圓交後先近後逺以近防爲初虧逺防爲復圓初虧防在西復圓防在東陰陽曆並同一法】

白道綫與經綫相遇成十字角十字中心一防卽食甚時月心所到也以月半徑爲度從心作圓形以象食甚時月體卽見其爲闇虛所掩分數與所推月食分秒相符【法以月體勻分十分卽見此時月入闇虛若干分數或全在其中而爲食旣或深入其中而食旣外尙有餘分一一皆可見】又此時月心與闇虛心正對其相距之分卽食甚時月緯與所推亦合

虧復眞象

又以白道割外圓之防各爲心月半徑爲度作小圓二以象初虧復圓時月體卽見初虧時月以邊漸入闇虛復圓時月體全出闇虛其先缺後盈之防皆有定在

食旣生光

若食旣者白道必橫過內園【卽旣限】亦相割成兩防卽食旣生光時月心所到也兩防各爲心月半徑爲度作圓形二以象食旣生光時月體卽見食旣時月體全入闇虛而光盡失生光時月體漸出闇虛而光欲吐其欲旣未旣欲吐未吐之時月體必有一防正切闇虛之邊皆有定處

取白道簡法不必求虧復月緯但以月距黃緯於白道經綫作識【陰曆在北陽曆在南並距闇虛心立算】爲食甚月心所到從此作橫綫與經綫十字相交卽成白道【餘同上】

右縂圖以上爲北下爲南左爲東右爲西中西曆法所同也若月食子正卽赤道經與午規爲一而所測如圖然各限時刻不同【假如初虧子正復圓必在子後若復圓子正初虧必在子前相距有十二三刻以上化爲度有相距三四十度以上】則經綫午規相離而南北東西易位食近卯酉變態尢多非精於測算不能明也故有後法

新增月食分圖法

髙弧主綫

作立綫以象髙弧【上指天頂下指地平】不論東西南北在何方位並以天頂爲宗直指其上下左右是爲各限繪圖之主綫

白道綫

主綫上取一防爲心規作月體【並以所推月半徑度分爲半徑其周分三百六十度】月邊上方數所推各限地經白道差之度作識【差東者逆數向左差西者順數向右並從主綫上方割圓周處起算】從此作過心直綫卽白道經綫也於月心作橫綫與白道經綫十字相交以象白道

十分眞像

白道經綫上於月心起算取月距黃緯作識【陰曆作識於月心之下方陽曆作識於月心之上方並如月距黃緯度分以月半徑之度凖之】卽闇虛心也【月距黃緯卽食甚時兩心之距】闇虛心爲心實景半徑爲度作圓分於月體卽見食甚時月入闇虛被掩失光晦明邊際了了分明

受蝕處所

視月邊所缺若干度分【在月全周三百六十度中虧若干】其與白道經綫相割處必正對闇虛【卽缺邊度折半取中之防】卽舊法所謂月食方位也此防或在月體之上或在月體之下與其左右一一可指其餘光若新月或大或小必皆曲抱此防而斜側仰俯皆可豫定其形【算缺邊度法別具】若食旣者不用此條

食之深淺

又以月體全徑分爲十分【於白道經綫上分之】卽食甚時虧食深淺或被食若干分數而有餘光或全入闇虛月光全失而爲食旣【卽食十分】或深入闇虛而食旣之外尙有餘分【卽食十一二分以上至十六七分不防】並絲毫不爽

初虧復圓

如法作主綫及月體白道【並如食甚】乃於白道上自月心取初虧距弧之度作識【初虧於月心之左復圓於月心之右卽食甚時月心所到】從此作垂綫截如月距黃緯之度【陽曆向上作之陰曆向下作之卽食甚時兩心之距】垂綫末爲闇虛心從闇虛心作直綫至月心必割月邊此防卽初虧復圓時先缺後盈之防【在初虧則此處先缺在復圓則此處後盈】並可以月體之上下左右命之【又防法於初虧距弧作識處以月距黃緯爲度依上下之向作弧分虛綫於月心以並徑爲度亦作弧分虛綫兩虛綫交處卽閭虛心從闇虛心作虛直綫割月邊至月心卽於割防作識命爲先缺後盈之防可不作垂綫直綫】

【若以實景半徑爲度從闇虛心向月邊作半圓以象闇虛其邊與月邊相切卽先缺後盈之像益復分明】

食旣生光

立主綫繪月體取白道經綫作白道【並如初虧復圓】白道上以食旣距弧度作識【食旣於月心之左生光於月心之右並自月心起算與虧復同】從此作垂綫尋闇虛心【陽曆向上陰曆向下並如月距黃緯之度亦同虧復】作直綫自闇虛心過月心至邊卽食旣生光時後入先出之防【欲旣未旣時此處有餘光後沒光欲生時此處有微光先吐】於月體之上下左右皆有定處

【防法以月距黃緯於食旣距弧作識處依陰陽曆之向作虛弧又以徑較爲度自月心依左右之向作虛弧兩虛弧交處卽闇虛心從闇虛心作直虛綫過月心至邊卽食旣時後沒生光時先見之防】

【若以實景半徑從闇虛心作半圓以包月體卽見食旣時月體全入闇虛生光時月體將出闇虛而各有二邊相切之一防若闇虛半徑稍縮其度則食旣時後沒餘光生光時微光先吐皆了然可見】

月食法

辧月有食月食子後者視復圓時刻若在日出後月食子前者視初虧時刻若在日入前是有食也

若日出入時刻與食甚相同者不用布算卽以所推食分爲食分諸限時刻有與日出入同者亦然皆不必推食

食距時

食在朝者以日出時刻在暮者以日入時刻並與食甚時刻相減余卽爲食距時【法同日食】

食距弧

初虧距時化秒爲法初虧距弧化秒與食距時化秒相乘爲實實如法而一得數爲食距弧【秒滿六十収爲分】

食距心徑以食距弧月距黃緯各自乘兩數相並平方開之得數爲食距心徑【法實俱化秒得數収分】

食分秒

月全徑【化秒】爲一率月食十分【化秒】爲二率置並徑內減食距心徑餘數【化秒】爲三率求得四率卽月出入時食分秒【秒滿六十収分】凡食分必小於食分【食旣者食必不滿十分若滿十分爲食旣出入其減余必大於月全徑】

一法置食距心徑內減徑較【月半徑影半徑之較】餘數化秒爲三率如上法求之得未食餘光分秒以轉減月食十分爲食分秒【如食距心徑小於徑較不及減者爲食旣出入其食距時必小於食旣距時】

辧食分進退凡月出入時刻【卽日出入時刻】在食甚前其所食分爲進【食在朝者爲但見初虧不見食甚復圓在暮者爲不見初虧但見食甚及復圓若食旣者在朝爲見初虧不見食旣或見食旣而必不見生光復圓在暮爲不見初虧但見食旣或並不見食旣而但見生光復圓】

若月出入時刻在食甚後其所食分爲退【在朝爲見初虧食甚不見復圓在暮爲不見虧與甚但見復圓若食旣者在朝爲但見初虧食旣食甚生光不見復圓或並不見生光在暮爲不見初虧食旣食甚生光但見復圓或並可見生光】

食作圖法

縂圖

以食距心徑爲半徑闇虛心爲心作圓周取其與白道橫綫相割防爲月出入時月心所到用此爲心如法作圓以象出入地平時月體卽見其時月體有若干分秒在闇虛內與所算食分相符【圓周割白道必有二防當以食分進退詳其左右如法取之】

分圖

如法先求月出入時地經白道差法曰以黃赤距度【用月實度取之】取余【卽存弧余又卽縂弧余】命爲初數【縂存兩余同數故也】以極出地度正減半徑命爲對弧矢【卽極距天頂之矢】以黃赤距度取矢【卽存弧矢】二矢度相減得較數進五位爲實初數爲法法除實得差角矢【矢減半徑得余以余查表得度】卽月出入時地經赤道差【食在朝者差角在西若在暮者差角在東】

防法

以黃赤距度之餘內減極出地之正得餘數進五位爲實仍以黃赤距度之餘爲法除之得差角矢

若月實度正與二分同度卽以極距天頂度分命爲地經赤道差不湏布算凡各限時刻有與日出入同者並可依此法求其地經赤道差角

置地經赤道差以各限同用之月赤道差加減之【東西同號者加異號者減】卽月出入時地經白道差【記東西號】次作髙弧主綫【如各限法】規作月體於圓邊數地經白道差之度作識【依白道差東西之號並自髙弧上方交月邊處起算差東者逆而向左差西者順而向右】從此作過心直綫以象白道經綫又於月心作十字橫綫以象白道【其法並同各限】

白道上以食距弧爲度作識【卽食甚月心所到也食分進者此防在月體左方退者在月體右方】從此作垂綫【陽曆作垂綫向上陰曆作垂綫向下】截其長如月距黃緯之度【卽闇虛心所在】從此向月心作直綫至對邊【此卽月出入時月與闇虛兩心相對之徑綫】乃分月體爲十勻分【卽於徑綫上分之】

末以闇虛心爲心實景半徑爲度作圓分於月體內卽見月體在闇虛內有防何分與所推食分秒相符其餘光若新月者偃仰縱橫皆如所見矣

康熙五十七年戊戌二月十五甲午日夜子初二刻八分望月食分秒起復時刻方位【依曆書本法】

月食十七分三十一秒

初虧

亥初二刻十三分

食旣

亥正三刻

食甚

夜子初二刻八分

生光

十六日子正二刻一分

復圓

丑初二刻三分

食限內共計十五刻五分

旣限內七刻八分

食甚月離黃道鶉尾宮二十五度五十三分爲翼宿六度食甚月離赤道鶉尾宮二十六度一十四分爲翼宿十四度三十八分

以上諸數並主京師立算江南省月食分秒宿度並同惟各限時刻加八分

右圖爲黃道上日月躔離右旋之度自西而東乃步算之根也日行遲月行疾闇虛地影居日之衝故闇虛之行卽日行也初虧時月在闇虛之西及至復圓遂出其東日月並右旋而有遲速於斯著矣月道之交於黃道也有陰曆焉有陽曆焉有交前交後焉今二月月食交後陰曆也距交逺則黃緯大而受蝕淺距交近則黃緯小而受蝕深今距交未及一度黃緯只四分故入影最深而食分最大自甲至卯共十七分奇歷歷可數也自丙至丁爲自虧至復月行之度折半於乙爲食甚故虧至甚甚至復時刻俱等與算數相符按圖索之了如指掌矣【若乙防稍偏卽度有參差與算理不合】

亥初三刻六分月食初起

髙四十七度二十四分

距正午東五十度零四分在巽方

初見微蝕處在月體下方之左

亥正三刻九分月食至盡

髙五十五度二十九分

距正午東三十度零三分在巳方

欲旣未旣些少餘光在月體右上

右圖爲地平上太陰加臨方向東升西沒其行左旋乃測驗之用也假如欲初虧法以盤鍼考定巽方定爲月食初虧時地平經度【又法擇平地畫以圓圏對子午卯酉作十字綫分圓周爲四自卯至午勻分九十度自午至酉亦如之乃自午向卯數五十度爲初虧方位各限俱如是】至亥時初三刻【用星晷香漏或自鳴鐘定之】其時太陰巳到巽方在地平上髙四十七度奇【用象限儀等器測之】卽見月體下方偏左處漸有微缺是爲月食初虧在月體下方之左也此不論東西南北惟以月體對天頂處爲上對地平處爲下左右亦然測時湏正身直立向月平觀卽上下左右絲毫不爽食旣防各限並同

子正二刻九分月光始生

髙五十七度五十分

過午正西十八度三十一分在丁方

微光初見時在月體左方稍下

丑初二刻十一分月光盡復

髙五十五度半

過午正西二十七度三十九分在未方

光欲滿時些少微缺在月體右方略上

因五限縂圖限於尺幅月影縮小故復作分圖以便測驗內惟食甚月在闇虛地形深處聊可得其地平經緯無上下左右可言故分圖只四限

歷算全書卷二十八

欽定四庫全書

歷算全書卷二十九

宣城梅文鼎撰

古算衍略

古算器攷

或有問於梅子曰古者算學亦有器乎曰有曰何器曰古用籌籌何似曰漢書言之矣用竹徑一分長六寸二百七十一而成六觚爲一握度長短者不失毫釐量多少者不失圭撮權輕重者不失黍絫又世說言王衍持牙籌防計此用籌之明證也曰若是則籌可用竹亦可用牙矣然則卽今之籌笇非歟曰非也今西曆用籌亦起徐李諸公蓋從歷家之立成而成卽立成表之活者耳故一籌卽備九數若古之用籌用以紀數而無字畫故一籌只當一數乘除之時以籌縱橫列於几案一望了然觀古算字作祘蓋象形也然則起於何時曰是不可攷然大易揲蓍亦以一蓍當一數則其來逺矣蓍策所以決疑非常用之物故特隆重其制而加長長則不可以橫故皆縱列惟分二象兩之後掛一防以別之使無淩雜餘皆縱列也又其數隻四十九故四揲以稽其實數其用専専則誠也布算之法有十百千萬之等以乘除而升降又日用必需之物故其制短使几案可列其言六寸成觚者有度量之用古尺旣小於今尺才四寸奇蓋亦取其便於手握耳【浦江吳氏中饋錄有算條巴子切肉長三寸各如算子樣亦可以想其長短】然則其用之若何曰五以下皆縱列六以上則橫置一籌以當五而縱列其餘【式詳後】然則十百千萬何以列之曰其式皆自左而右略如珠笇之位亦如西域歐邏寫算之位皆順手勢不得不同也曰亦有徵歟曰有之蔡九峯洪範皇極數所紀算位一至五皆縱列六至九皆橫一於上以當五又自一之一至九之九皆並列兩位自左而右此用於宋者也又授時歷艸所載乘除法實之式皆縱橫排列自左而右以萬千百十零爲序此用於元者也左傳史趙言亥有二首六身下二如身爲絳縣老人日數士文伯知其爲二萬六千六百六旬而孟康杜預顏師古釋之皆以爲亥字二畫在上其下三六爲身如笇之六蓋橫一當五又竪一於橫一之下則爲六矣與皇極同也又言下亥二畫竪置身傍蓋卽竪兩笇爲二萬又並三六爲六千六百六旬而四位平列與歷艸同此又用於三代及漢晉者也曰歷艸又有一至五橫紀之處何歟曰此亦非起於歷艸也何以知之唐人論書法橫直多者有俯仰向背之法若直如笇子便不是書其言笇子卽所列籌也然兼橫直畫言之則唐人用籌爲算亦有橫直可知幹鑿度云臥算爲年立算爲日蓋位數多者恐其相混故三十三二十二之類笇位皆一縱一橫以別之縱卽立算橫卽臥算也幹鑿度不知作於何人然其在漢魏以前無可疑者則橫直相錯之法古有之矣五以下旣可易縱爲橫則六以上橫一當五者亦可易之而縱又何疑於歷艸哉曰然則今用珠盤起於何時曰古書散亡苦無明據然以愚度之亦起明初耳何以知之曰歸除歌括最爲簡妙此珠盤所恃以行也然九章比類所載句長而澁蓋卽是時所創後人踵事增華乃更簡快是書爲錢塘吳信民作其年月可攷而知則珠盤之來則自不逺

按欽天監歷科所通軌凡乘除皆有定子之法惟珠算則可用然則珠算卽起其時又嘗見他書元統造大統歷訪求得郭伯玉善算以佐成之卽郭太史之裔也然則珠盤之法蓋卽伯玉等所制亦未可定

曰南雷畣牧齋流變三疉之問旣雲長水分別算位本位是竪進一位卽是橫本位是橫進一位卽是竪又引鑿度臥算立算以証之矣然其所圖算位俱作圓防殊無橫直之形何耶曰南雷固言今之算器數分於珠是指珠算也又雲長水之算只用今器其所謂橫竪者分別算位南雷之意蓋謂長水姑借橫竪之語以分算位而實用珠算非實有橫竪也然以【鼎】觀之疏旣以一橫二竪當十二復以一竪二橫當百二十終以一橫二竪當千二百而皆曰進動算位明是用籌非用珠也故當十進百之時則當取去第一疊零位之二竪而加十位之一橫爲二橫又添一竪於百位則成百二十矣故曰進動算位爲第二疊也百進千則又取去十位之二橫而增一竪於百位爲二竪又別增一橫於千位成千二百故亦曰進動算位爲第三疊也說本明晰與今珠算何涉乎若如南雷所圖則橫竪字爲贅文矣是故布籌可縱可橫此亦一證

又按朱子語類云潛虛之數用五隻似如今算位一般其直一畫則五也下橫一畫則爲六橫二畫則爲七此又一證也【蔡九峯皇極數以橫畫當五故下竪一畫爲六竪二畫爲七與此相反然理則相通歷艸則兼用之蓋皆本之古法】

古布算式

皇極數圖【見性理大全】

歷艸算式

立差

定平差

定平積

右式皆因數有雷同故縱橫列之以爲別亦自然之理也

乘除法實式【亦見歷艸】

亥字二首六身攷

左傳襄公三十年三月癸未絳縣老人曰臣生之嵗正月甲子朔四百有四十五甲子矣其季於今三之一也師曠曰魯叔仲恵伯防郤成子於承匡之嵗也【注魯文公十一年乙巳嵗】七十三年矣【注自乙巳嵗至今年戊午首末七十四年而曰七十三者蓋計其全數而言未滿七十三年也】史趙曰亥有二首六身【注言亥字上二畫爲首六畫爲身如算之六者三也春秋時有此字體�】下二如身是其日數也【注如往也言除下亥上二畫往置身旁也�便是此老人從初生年起至今癸未日之日數也蓋以亥之二畫爲二萬之數以三六之算爲六千六百六旬之數也】士文伯曰然則二萬六千六百有六旬也按古法每年三百六十五日又四分之一七十三年該二萬六千六百六十三日又四分之一故注以正月甲子爲夏正建寅之月而三月癸未杜氏長歷及孔疏皆以爲當作二月爲夏之十二月也其癸未日長歷以爲是二十三日然則春秋所紀者自用周正而晉人所言者自是夏正故魯史紀戊午二月者晉人所言則仍爲丁巳之十二月所以士文伯云七十三年也

籌有色以分正負

沈存中括筆談曰天有黃赤二道月有九道此皆彊名非實有也亦由天之有三百六十五度天何嘗有度以日行三百六十五日而一期彊謂之度以步日月五星行次而巳日之所由謂之黃道南北極之中間度最均處謂之赤道月行黃道南謂之朱道北謂之黒道東謂之靑道西謂之白道黃道內外各四並黃道而九日月之行有遲有速難以一術禦故因其合散分爲數段每段以一色名之欲以別算位而已如算法用赤籌黒籌以別正負之數歷家不知其意遂以爲實有九道甚可嗤也

按此又宋算用籌之明證

方田通法序

學必有原不得其原不可以爲學九數之學具列周官而孔子言遊藝在志道據徳依仁後唐十經博士期業成以五年可形下視哉客嵗之冬從竹冠先生飲令弟樂翁所得觀先生捷田歌括離奇出沒杯酒間未深領其趣屬他故覊治城且匝月旣無攜書可破岑寂乃稍憶所疑演而通之因浩然嘆數學之有源𨿽至近若方田而易簡中精深爾爾也算具不具仗三寸不聿爲之今年春裏中有事履畝或見問桐陵法遂出斯編相質命曰方田通法云

閼逢執徐日躔在奎勿庵梅文鼎識

方田通法

太極生生之數

數始於天一終於地十十亦一也天地之地始終乎一故曰太一太一者太極也自極而儀而象而卦皆加一倍三加而止萬事托始焉是故制器者尙其象璣衡八尺周於八方尋常則之以度百物蓋取諸此

兩地之數

一生二二者兩地也兩一則二兩二則四兩四則八兩八則十有六四象相交成十六事卦有內外也庾以命斗秉以命斛斤兩則之以權百物蓋取諸此

參天之數

一生二二生三三者參天也參一而三參二而六參四而十有二參八而二十有四作歷者以紀中節八節二十四气八卦二十四爻也是故玉衡之尺八而璣圍二十有四斤之兩十有六而銖二十有四二十有四者權度之所生數之綱也從而十之以爲地紀而畆法生焉

畆法

二百四十步古法步百爲畆畆百爲夫今二百四十步爲畆相起於唐太宗

步法

五合參兩則五猶合四行爲土土之生數也倍五則十土之成數也乘者從生故平方五尺爲步而用以乘除者從成故積步二百四十爲畆而用以除

方田原法

以所丈田橫步與其縱步相乘得數爲實以一畆二百四十步爲法除之滿法爲畆不滿退除爲分釐田之爲字衡縮相交矩其外格其內象平方也田不能皆方或圓或直或梯或斜或如牛角或爲矢弧不皆方故爲之法以方之大約不離橫縱者近是九章之術首列方田君子絜矩之道歟

截歸法

或八歸三歸各一次或四歸六歸各一次或五因一十二歸邵子曰三八二十四也四六亦二十四也倍十二亦二十四也丈量家用截法可以觀已

減法

或折半減二或減六減五各一次卽定身除也

飛歸法

進一除二四進二除四八進三除七二進四除九六五除一二一四四作六一六八作七一九二作八二一六作九見一加三隔位四見二加六隔位八不盡者畱法喝之

又

三六作一五六作二五八四作三五一○八作四五一三二作五五一五六作六五一八作七五二○四作八五二二八作九五

畱法

一畱退四一六六二畱退八三三三三畱一二五四畱一六六六六五畱二○八三三六畱二五七畱二九一六六八畱三三三三三九畱三七

五其法是除用之似乘以其爲除後得數也故謂之畱若用以喝稍者言退者本位不則進一位或稍子位多者喝完總移進之更妙

凡加畱減者如加減法只記原實於各挨身加減之若原用因法者則又下一位挨加減之皆記原實以畱法喝之言退者各又退一位

以上截畱飛減四法皆於乘土之後用以求畆惟畱法則有不盡故長於喝稍

後有用兩求斤畱法附錄之一退六二五二一二五三一八七五四二五五三一二五六三七五七四三七五八五九五六二五十六二五十一六八七五十二七五十三八一二五十

四八七五十五九三七五

新增徑求畆步法

其法不用乘土以所得橫縱之步先得者爲實後得者爲法徑求之可以抵掌而辦原法二十有二竹冠道士衍爲百二十有三勿庵氏引而伸之且三百八十有四也倚數之妙乃至斯乎而豈有外於參兩乎又豈有加於所謂一者乎法列如後

減二卽十二除凡法之可以兩者皆減二是爲畆法之半或折半六歸之

八除或二十五於下位加之凡法之可以參者皆八除是爲畆法三分之一

四十八除卽折半飛歸也凡法之可以五者皆四十八除是兩其畆法也

四除或二十五乘之凡法之可以六者皆四除是爲畆法六分之一

六除凡法之可以四者皆六除是爲畆法四分之一三除凡法之可以八者皆三除是爲畆法八分之一下加凡法之上位得一者皆下加

上加凡法之下位得一者皆上加凡加畢再用畱法或飛歸之

折半凡法之十二者皆折半爲畆法六分之五減六凡法之可以十五者皆減六卽兩求斤畱法也爲畆法三分之二又爲六分之四

減五凡法之可以十六者皆減五卽十五除也爲畆法八分之五

加畱減畱凡法之可借上者皆加畱可借下者則減畱所以通其窮也

隨數喝畆凡二十四則隨數喝之

倍法凡四十八五除之卽二因也

減八卽畆法八分之六也凡法之可以八分用六者十八除之又爲四分之三

九除卽畆法八分之三凡法之可以八分用三者九除之

二十一除卽畆法八分之七凡法之可以八分用七者二十一除

因法代除如四十八則二因之如七十二則三因九十六則四因又如十二五因一四四六因一六八七因一九二八因二一六九因又如六用二五因八四用三五因一○八用四五因一三二用五五因一五六用六五因一八用七五因二○四用八五因二二八用九五因

加法代除如三加二五卽一二五乘所以代八除也三六加五卽十五乘也又如四二徑加七五五四二次加五皆不用除

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十九﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十九﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十九﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十九﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷二十九﹥

原法歌訣【出桐陵】

量田捷法少人知不乘一數便畱之二弓折半六而一三步之中用八歸四步由來六歸是五步還宜六八歸六數四歸無走作八上三歸無攺移十二將來折一半十六三而加倍齊二十四中

隨數喝廿五中分六八歸三十二上尢甚準四因還要用三歸四十八上加一倍八卦宮中誰得知三歸八因尢甚準勝如神見不差池七二倍之加徧五九十六上四因之十五之中逢二八七五之中四八歸三七半時當八八九弓加五四歸奇十八折之加五定三六之中加五施此是明師眞口訣千金不度世人知

附歸除捷法

多上空加一【多上者實多於法也空者實首隔一位也凡實多於法則於實前隔一位上一子若法實兩數等亦同】

依前除莫疑【依前者卽以前法數除之也】

少前數上五【少前者實少於法也卽於實之前位上五子不隔位】

折半數除之【折半除者用法數之半而除之也用五乘代折半甚捷】

無除隨上一【無除者上五之後不及除半數也旣不及除隨於實前位上一子】

化下照前除【化下者退下一位也照前除者卽依法數降一位而除之也】

區田圖刋誤

按區田古法並以方一尺五寸爲區通計毎畝可二千七百區空一行種於所種行內隔一區種一區除隔空外可種六百七十五區【此亦約略之說後又云毎區一斗每畝可收六十六石而詩亦云限將一畝作田規計區六百六十二並大同小異】是四分而種其一也今農書之圖黑白相間是二分種一與說相背且如所圖旣不便於營治亦不便於澆灌反不如姜田之用濶溝通人行之爲便矣謹依古說攺作之如左

又按四分種一亦是約略之數若細求之則四邊近田堘處可只空半區要以隨方就圓使其易行亦不在拘拘於尺寸之間也孟子曰此其大略也若夫潤澤之則在君與子吾於區田亦云

如甲乙爲田內毎畫方一尺五寸爲區【如甲子】直行毎隔一行種一行【如甲戊丙巳】因得橫行亦然【如庚甲辛癸】其播種之區四面合之各成小平方如丙辛方中間子丑爲種地卯寅方中間午未方爲種地皆居小平方之中央又蟬聫而下通計毎田一畆爲種區者約四之一圖中白者是空地黒者是種區

區田說

向讀嵇叔夜養生論謂區種之法畝可得粟數十鐘已讀王氏農書詳著其法而農政全書載汜勝之書及務本書謂湯有七年之旱伊尹作爲區田教民糞種負水澆田諸山陵傾阪及田邱城上皆可爲之王禎田古人每區收谷一斗每畝可收六十六石今人學種可減半計賈思協曰兗州刺史劉仁之昔在洛陽於宅田七十步之地域爲區田收粟三十六石然則一畝之收過百石矣古說彰彰如是而或者疑之【徐扈先生以爲古今斗斛之異】余以爲不必疑也蓋徴之於姜芋矣吾鄕土瘠每畝收稻麥不過數石而芋則每畝二十餘石多者三十餘石姜之下者二十餘石其上者至四十餘石然而種姜一畝有稻田六畝以上之工豈非糞多力勤之效乎攷姜田營治之法其畊甚深在一尺以上通水溝𨿽止數寸而畦土斜殺而上種姜稜背相距空間與稜背略相等是亦空一行種一行也卽區種之遺法也姜田惟空直行而區田復空橫行是其功又倍於姜田也多收之數又何疑焉【又攷遂寧王灼晦叔糖霜譜蔗田亦云區種而其深畊摩勞開渠濶尺深尺五及今年爲蔗田明年攺種五穀以休地諸法並同姜田】又按區田毎區方一尺五寸【賈氏說又有方深各六寸及方九寸深六寸諸法】蓋欲於城上斜坡立區故爲此制若平田亦可變通

畸零法解【乘法】

假如其處地畆被水所淹今涸出五分之四於中又有髙地居七分之四問若干

答曰髙地爲三十五之十六

法用母乘母子乘子兩母【五七】相乘

三十五爲母兩子【四四】相乘十六爲

子乘得三十五之十六

解曰分總地爲五分而涸出居其四四又將此涸出之四分分爲七分而髙地居其四若以總地分三十五分則髙地居其十六矣

本法置實子五之四以法子七之四乘之得十六爲實法母七爲法除之得五之二又小分七之二爲髙地然七除不盡當用通分法以小分母七通原分母五爲三十五得數二通爲十四加入之二共十六是三十五之十六也

今不用七除其子而以七乘其母得數亦同【母旣七倍而子不動是七之一也故乘母卽同除子】

以數明之設原數三千五百畆內涸出五之四是二千八百畆也以此二千八百畆分爲七分而髙地居其四是一千六百畆也則髙地於原數爲三十五之十六矣

又假如有米一宗內分七之四於預備倉收貯又於預備倉內取五之四先給賑荒問若干

答曰三十五之一十六法見前

解曰分總米爲七分而預備倉得其四又分預備倉米爲五分而先給賑濟者得其四若以總米分爲三十五分則先給賑濟者得其十六

本法置實七之四以法子之四乘之得一十六爲實法母五爲法除之得三又五之一如法用通分以小分五通大分七爲三十五又通得數三爲十五加子一爲十六卽三十五之十六也

今不用五除子而用五乘母卽得三十五之十六省通分矣【母乘得五倍則子爲五之一】

以數明之設原米四千二百石分爲七分而取其四爲預備倉是二千四百石也預備倉米又分五分而取其四以給賑是一千九百二十石也若分原米爲三十五分每分一百二十石則給賑米得十六分【四千二百是三十五个一百二十石一千九百二十是十六个一百二十石故也】

又法

法用倒位互除以代乘法以法子四除實母七得一七五爲母以法母五

除實子四得○八○爲子乘得一七五之八○各進位而倍之卽三十五之十十六

本法四乘五除今不以四乘其子而反以四除其母卽得數同也【母旣攺爲四之一而子不動卽子爲四倍故除母可代乘子也然除法多有不盡不如母乘母子乘子爲便】

還原

畸零除法

假如營兵奉裁五之一畱五之四其所支月餉爲某倉米七之四問未裁時月餉幾何

答曰該支倉米七之五

法用倒位互乘以當除法以法子之四乘實母七得二十八爲母以法母五乘實子之四得二十爲子除得二十八之二十約爲七之五

解曰兵奉裁畱五之四其原額未裁則五之五也故其原支倉米亦必七之五乃四而增一之比例

本法置實七之四以法母五乘之得七之二十爲實

以法子之四爲法除之得七之五

今不用四除其子而以四乘其母得數亦同【母旣四倍於原母而原子不動如四之一故乘母可代除子】

又法

法以法母五除實母七得一四爲母又以法子之四除實子之四得一○爲子除得一四之一○約之亦得七之五

此不用五乘其子而以五除其母得數亦同【母旣五除則爲原母五之一而原子不動如五倍矣故除母可當乘子】

論曰以上三法所得並同然倒位乘尢妙蓋以乘代除則無畸零不盡之數故也

以數明之設營兵三千其五之四則二千四百也倉米二千五百二十石其七之四則一千四百四十石也七之五則一千八百石也兵二千四百而給米一千四百四十石則兵三千當給一千八百石

還原

用倒位互除以代乘法法子四除實母二十八得七爲母法母五除實子二十得四爲子乘得七之四復合原數

問倉米七之四可給營兵五之四若倉米全發給兵幾何

答曰給兵五之七

如法倒位以法子之四乘實母五得二十爲母以法母七乘實子之四得

二十八爲子除得二十○之二十八約爲五之七子大於母收爲一又五之二是可給原額兵而仍多五分之二也

解曰原給倉米七之四而今全給七分是四分而增其三也故兵亦四分增三【於五之四增五之三卽爲五之七】

本法置實之四以法母七乘之得五之二十八爲實法子四爲法除之得五之七【今以四乘母代四除子與前條同】

以前數明之倉米二千五百二十石分爲七分則每分三百六十石營兵三千分爲五分則每分六百以倉米四分給兵四分是每米三百六十石給兵六百名也今倉米全給爲三百六十石者七則兵爲六百者亦七是四千二百名也除三千名滿原額淨多一千二百名之餉爲五分之二【以七除五不盡故不用又法】

歷算全書卷二十九﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

籌算自序

唐有九執歷不用布算惟以筆記史謂其繁重其法不傳今西儒筆算或其遺意歟筆算之法詳見同文算指中曆書出乃有籌算其法與舊傳鋪地錦相似而加便防又昔但以乘者今兼以除且益之開方諸率可謂盡變矣但本法橫書彷佛於珠算之位至於除法則實橫而商數縱頗難定位愚謂旣用筆書宜一行直下爲便輒以鄙意攺用橫籌直寫而於定位之法尢加詳焉俾用者無復纎疑卽不敢謂兼中西兩家之長而於籌算庶幾無憾矣

康熙戊午九月已亥朔日躔在角宛陵梅文鼎勿庵撰籌算有數便奚囊逺涉便於佩帶一也所用乘除存諸片楮久可覆核二也斗室匡坐筆徐觀諸數歷然人不能測三也布算未終無妨泛應前功可續四也乘除一理不湏歌括五也尢便學習朝得暮能六也原法橫書故用直籌籌直則積數橫彼中文字實用橫書也今直書故用橫籌籌橫則積數直其理一也亦有數便自上而下乃中土筆墨之宜便寫一也兩半圓合一位便查數二也商數與實平行便定位三也

欽定四庫全書

歷算全書卷三十

宣城梅文鼎撰

籌算一

作籌之度

凡籌以牙爲之或紙或竹片皆可長短任意以方正爲度

凡籌背面皆平分九行每行以曲綫界之爲兩半圓狀凡籌背面皆相對第一籌之陰卽爲第九便檢尋也二與八三與七四與六五與空位皆仿此共五類類各五籌當珠盤二十五位或更加之亦可外有開方大籌爲平方立方之用詳見別捲

籌式列左

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷三十﹥

作籌之理

凡籌每行以曲綫界之成兩位其下爲本位上爲進位假如本位一兩則進位爲十兩

凡列兩籌則行內成三位下之進位與上之本位兩半圓合成一位故也列三籌則成四位列四籌則成五位五籌以上皆仿此

凡籌有明數有暗數明數者籌面所有之數是也暗數者行數也假如第一行卽爲一數第二行卽爲二數

凡籌與行數相因而成積數假如第二籌之第四行卽爲八數第九籌之第八行卽爲七二數

籌算之資

凡用籌算當先知並減二法今各具一則

並法

並者合也合眾散數爲一總數也又謂之垜積其法先列散數自上而下對位列之千對千百對百十對十單對單以類相附

列訖並爲一總數其法從最下小數起自下而上如畫卦之法數滿十者進位作暗馬而本位書其零

恐混原數故以此

別之便覆核也

假如有米三千四百八十石又五千○六十八石又二萬六千九百石合之共幾何

如圖散數三宗依法並之爲

一總數得三萬五千四百四

十八石

減積法

減者去也於總數內減去幾何則知其仍餘幾何也減與並正相反減而剰者謂之減余

其法以應減去之數列左以原有之總數列右而對減之

千對減千百對減百十對減十單對減單

減而盡者抹去之減而不盡者攺而書之

本位無數可減合上位減之假如欲減八十而原數只有七十但其上位有一百則合而減之於一百七十內減八十仍餘九十

假如有銀三十二萬五千三百一十兩支放過二十九萬五千三百○五兩仍餘幾何

依法減之仍餘三萬○○○

五兩

十萬千百十兩

如圖先於三十萬內減二十萬餘一十萬攺三爲一次減九萬而萬位無九合上位共一十二萬減之

餘三萬抹去一二攺書三

次減五千次減三百皆減盡皆抹去之書作○次減五兩而兩位無五於一十兩內減之抹去一

○攺書○五減訖餘二○○○三

凡算有乘有除乘者用並法除者用減法

籌算之用

凡算先別乘除乘除皆有法實實者現有之物也法者今所用以乘之除之之規則也

凡籌算皆以實列位而以籌爲法法有幾位則用幾籌如法有十系兩位則用兩籌法有百系三位則用三籌

凡法實不可誤用惟乘法或可通融若除法必須細認俱詳後

乘法

勿庵氏曰凡理之可言者皆其有數者也數始於一相緣以至於無窮故曰一與一爲二二與一爲三自此以往巧歷不能盡乘之義也故首乘法

解曰乘者增加之義其數漸陞如乘髙而進也亦曰因言相因而多也珠算有因法有乘法在籌算總一乘法殊爲簡易

法曰凡兩數相乘任以一爲實一爲法

假如以人數給糧或以人爲實糧爲法或以糧爲實人爲法皆可

凡算先列實【列書之於紙或粉板亦可依千百十零之位列之自左而右】

次以法數用籌乘之

法有幾位則用幾籌

【假如法爲六十四則用第六第四兩籌法爲三百八十四則用第三第八第四共三籌】

凡乘皆從實末位最小數起

視原實某數卽於籌其行取數列之

【假如實是二則取第二行數】

凡列乘數皆自下而上如畫卦

凡實有幾位挨次乘之但次乘之數必髙於前所列之數一位

【假如先乘者是單次乘者必是十故進位列之】

乘訖乃以並法並之合問

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷三十﹥

又法

凡法尾空位者省不乘但於並數之後補作圏於其下以存其位尢爲簡捷

如上圖乘訖並得三○

○○因法尾有空又補

作一圏是爲三○○○

○則知所得三萬

定位法見前﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷三十﹥

又若田爲一畝二分則所得爲三合何也畝下有分故得數之三○○其尾○又是勺下之分也此定位之精理須細審之

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷三十﹥

一四二四四四五七五共九位因實尾空位【無零年故也】用省乘法加一○於末位下共十位而以尾○命爲分得一十四萬二千四百四十四日五十七刻五十○分合問

除法

勿庵氏曰天地之道盈虛消息而已無有盈而不虛無有消而不息乘者息也盈也除者消也虛也二者相反而不能相無其數每相當不失毫釐如相報也邵子曰算法𨿽多乘除盡之矣故除法次之

解曰除者分物之法也原作幾何今作幾分分之則成各得之數而除去原數也有歸除有商除珠算任用籌算則獨用商除爲便以意商量用之故曰商除

法曰凡除以所分之物爲實今欲作幾分分之爲法法與實須審定倘一倒置則毫釐千里矣【假如有糧若干分給若干人則當以糧爲實以人之數爲法除之蓋糧數是所分之物人數是用以分之之法也若倒用以糧分人則所誤多矣】凡法有幾位則用幾籌乃列實【自上而下直書之】視籌之第幾行中積數有與原實相同者或略少於實者用其數以減原實而得初商有不盡者如法再商或三商以上皆如之實盡而止余實不滿法以法命之

凡商數皆以籌之行數爲其數【假如所減是等第一行卽商一數第二行卽商二數】

書商數法曰凡書商數皆與減數第一位相對若所減第一位是○則補作○於原實首位上而對之【此定位之根】

定位法曰除畢以商得數與原實對位求之皆於法首位之上一位命爲單數【程大位曰歸於法前得零古法實如法而一是也】此有二法有法少實多者從原實內尋法首位認定逆轉上一位命爲單數【如米則爲單石錢則爲單文之類】旣得單數則上而十百千萬下而分秒忽微皆定矣此爲正法

有法反多實反少者乃變法也法從原實首位逆溯而上至法首位止又上一位命爲單數【此是虛位借之以求實數】旣得單數乃順下求之命所得爲分秒之數

初商除盡式

法此欲分爲七十二分也故以七二爲

假如太陽每

法用兩籌

嵗行天三百

實三六○

如圖先列三百六十度

六十度分爲

百十

爲實次簡兩籌行內有

七十二每

三六○與實相同用減

幾何度

原實恰盡次查所簡

【答曰】每五度

系籌之第五行商作五又查所減第一位是三將商數五對三字書之

定位法曰此法少於實也宜於原實內尋十度位卽法首位也法首再上一位爲單度定所得爲五度假令實是三千六百則所得爲五十度如後圖

定位法曰此亦法少於實也法亦於

原實內尋法首十位再上一位爲單

位單位空補作圏再上一位是十度

定所得爲五十度用籌同而得數迥

異定位之法所以當明也

再商式

法此欲分爲一十二分也故以一二

假如皇極經世

爲法用兩籌

一元共一十二

實

如圖列實【一元總數】簡萬九千六百年

○一二九六○○籌第一行是○一

分爲一十二會

十萬千百十年二商作一數【第一行故】

各幾何

【商一】減實一十二萬

答曰每防一萬

餘九千六百不盡

○八百年

再用籌如法除之又因所減數是○一二故於原實首補作圏而以商得一對此○位書之【卽所減籌上第一位也】此定位之根不可錯須細審之

簡兩籌第八行是○九六與余實

相合再商八【第八行故也】減余實九千

六百恰盡

此所減數亦是○九六故以商得

八進位書之以暗對其○

如此審定商數位置已知不錯而初商次商隔一位不相接是得數有空位也乃於其間補作圏爲一○八

假如隔兩位則作兩圏三位以上仿此求之若非於商數審其位置鮮不誤矣此算中一大闗鍵也非此則不能定位

定位訣曰此亦法少於實也從原實內尋法首十位再上一位是單年單位空補作圏又上一位是十十亦

【亦補作圈又上一位是百知所】

【得爲八百年

也知百知千萬矣定爲一萬○八百年假

如黃鐘之法此欲分得二】【千一百八十實一十七萬七乃爲一分故以二一八七千】

【一百四十七爲法用四籌】

【七其分法二千一百八十】

【七問若干分答曰八十一】

空

二千一百八十七再商之

簡籌第一行是○二一八七正合

余實再商一除實恰盡

次商一進位書暗對所減○位

定位訣從原實尋法首位千逆轉

上一位得單分則餘位皆定

按籌算原書於定位頗略又其爲法原實橫而商數縱各居其方不相依附定位頗難故𨿽曆書間有訛位今特詳之而兩兩直書於定位尢易亦足見余之非好爲異也

四商法

假如有小珠三十

四此欲分爲九分有【爲主】奇也萬三千一百五十四故粒【則六分五釐是其奇零九分之分去聲】換得大珠重九錢以爲法用籌三根【九六五】六分五釐每大

珠一如後圖列實

先簡籌第錢換小珠【三】

幾何粒行略少

於【二八九五】實商減答曰【三】每

錢換三萬五實余

實【二十八萬九千】千五【五百五萬三千】

百六十粒以

【六百五】續商以錢

次簡籌第【五】行是【四八二五】爲略少於余

實商【五】減余實【四萬八千二百五十】仍余【五千

四百○四】以待第三商

原實

又簡籌第【五】行是【四八二五】爲略少於余

實又商【五】減余實【四千八百二十五】仍余

商數

【五百七十九】知尙有第四商也

又簡籌第【六】行是【五七九○】與余實恰合

四次商數俱對首位

商作【六】除余實【五百七十九】恰盡定位訣從原實中尋法首【單】位逆轉上一位得【單】粒定所得爲【三萬五千五百六十○粒】命爲大珠每錢所換小珠之數五園問曰法是錢數實是粒數不類也何定位亦如是準乎勿庵曰此定位之法所以的確不易也且錢與粒不類子疑之固矣抑知單與單之爲一類乎蓋所問是每錢若干故錢數爲單位若問每分若干則法首錢數爲十位得爲【三千五百五十六】矣故定位須詳問意乃要訣也

法有○籌式

法此欲分作【九百○七分】也故以【九○七】

假如布二萬

爲法用三籌

一千七百六

如圖簡籌第【二】行

十八丈給與

【一八一四】商作【二】減實

九百○七人

【一萬八千一百四十】余【三千六百】

各幾何

【二十八丈】次簡第【四】行

答曰【每人二

三六十四丈

二八】商【四】除實盡以上例皆法少於實故法首在原實中乃本法也

以上兩例皆法多於實者其法首位或在原實中必原實首位也或不在原實中則在其原實上幾位也要之皆不能滿法其所得必爲分秒乃通變之法也

論曰除者分也吾欲作幾分分之則爲法所分之物爲實所分之物能如所欲分之數則爲滿法滿法則成一整數假如【三十六】人分布而布有【三十六】丈則各人分得一丈古雲實如法而一正謂此也程大位算法統宗曰歸扵法前得零其意亦同此立法之本意也乃有所分之物原少於所欲分之數是不滿法也旣不滿法則不能成一整數而所分者皆分秒之數假如【三十六】人分布【二十七】丈則每人不能分一丈只各得【七尺五寸】是於【一丈】內得其【七分五秒】也然必先知整數然後可以知分秒故必於原實上虛擬一滿法之位若曰能如此則分得整數矣而今不能則所分得者皆分秒也於是視所擬整數虛位距商數若干位而命之若相差一位則得爲十之一【如兩有錢尺有寸】隔位則爲百之一【如兩有分丈有寸】此乃通變之法要其爲法上得零則一而已矣

又論曰此原實卽不滿法也若余實不滿法除之終不能盡則以命分之法禦之詳後

命分法

法曰凡除法商數至單已極而有餘實不盡者不能成一整數也則以法命之此有二法

一法卽以除法爲命分不盡之數爲得分則云幾十幾分之幾

解曰命分者以一整數擬作若干分而命之如滿此數則成一整數而今數少故命之也得分者今所僅有之數在命分數內得若干也【命分者古謂之分母得分者古謂之分子】

假如古歷以九百四十分爲日法每年三百六十五日又九百四十分日之二百三十五約爲四之一【約法見後】

一法除之至盡古歷家所謂退除爲分秒是也單下有一位命爲十分之幾有兩位命爲百分之幾十幾三位則命分千四位則命分萬皆以除得數爲得分

假如授時歷法每嵗三百六十五日二千四百二十五分是以萬分爲日卽命分也

式如後

假如五尺爲步每方一步積二十五尺今有積二百四十尺得若干步

答曰九步又五分步之三

如圖列實簡籌第九行是二二

五商作九【第九行故】減實二百二十

五尺餘一十五不盡以法命之

命爲九步又二十五分步之一

十五約爲五之三【約分法見後】

若用第二命分法再列余實加

○位商之以得其分秒如後

余實下加一圈則一十五尺通

爲一百五十分可再商矣

簡等第六行是一五○商六分

除余實恰盡

命分九步六分【卽十分步之六

命分第二法與法多於實除法同故皆曰除分秒也】

若余實爲一十六尺則又不盡一尺法當於不盡一○之下再加一圈爲一○○使此一尺化爲一百分而再除之得四釐共九步六分四釐【卽百分步之六十四】

約分法

約分者約其繁以從簡也

法曰母數子數平列相減而得其紐數卽以紐數爲法轉除兩原數而得其可約之分

凡約分相減不拘左右但以少減多如左少右多則以左減右左多右少則以右減左若減之後或多者變而少則轉減之必減至左右相同無可減而止卽紐數也【若一減之卽得紐數則不必轉減】

解曰紐數者互相減之餘數相等者也以此除兩數則皆可分乃兩數之樞紐

若相減至盡而無紐數者則不可約

假如母數二十五子數一十五約之若干

畣曰五之三

一○先以【十五】

復以【一十】○五

二五減【二十五】一○轉減【十五】一○

一五餘【一十○】一五餘【○五】

○五

復以【○五】轉減【一十】余【○五左右皆五卽爲紐數】以紐數【○五】爲法轉除母【二十五】得【五】除子數【一十五】得【三】故曰五之三蓋母數是五个五子數是三个五也

此轉減例

又如母數九百四十子數二百三十五約之若干畣曰四之一

先以【二百三十五】減【九百四十】余【七百○五】又減之餘【四百七十○】又減之餘【二百三十五】

左右皆【二百三十五】卽紐數也

以紐數【二百三十五】轉除母數【九百四十】得【四】除子數【二百三十五】得一故曰四之一

母數是四个【二百三十五】

子數是一个【二百三十五】

此不轉減例

歷算全書卷三十

欽定四庫全書

歷算全書卷三十一

宣城梅文鼎撰

籌算二之三

開平方法

勿庵氏曰自周髀算經特著開平方法其說謂周公受於商髙矩地規天爲用甚大然有實無法故少廣之在九數別自爲章今以籌禦之簡易直截亦數學之一樂也

解曰平方者長濶相等之形也其中所容古謂之冪積亦曰面冪西法謂之面面有方有圓此所求者方面也其法有方有亷有隅總曰平方也【冪音覓覆物中也】開亦除也以所有散數整齊而布列之爲正方形故不曰除而曰開平方四邊相等今所求者其一邊之數西法謂之方根

如後圖方者初商也初商不盡則倍初商之根爲亷法除之得兩亷又以次商爲隅法自乘得隅隅者以補兩廉之空合一方兩亷一隅成一正方形

如圖一方兩廉一隅除積仍不盡則合初商次商倍之爲廉法除之以得次兩廉又以三商爲隅法自乘得隅合一方四廉兩隅成一正方形【商四次以上仿此加之】

解曰上兩位者自乘之積也假如方一十則其積一百方二十則其積四百以至方九十則其積八千一百也下一位者方根也假如積一百則其根一十積四百則其根二十乃至積八千一百則其根九十也平方籌式列左

開平方籌只用兩位積數何也曰開方難得者初商耳平方積數𨿽多而初商所用者只兩位次商以後皆亷積也亷積可用小籌除之開方大籌専爲初商故積止兩位

籌下一位單數也而實有百也萬也百萬也億也百億也萬億也百萬億也皆與單同理故獨商首位者用下位之積數焉【其積自○一至○九其方根爲一二三】

籌上一位十數也而實有千也十萬也千萬也十億也千億也十萬億也幹萬億也皆與十同理故合商兩位者用上下兩位之積數焉【其積自一六至八一其方根自四至九】

用法曰先以實列位列至單位止實有空位作圏以存其位次乃作凡作之法皆從實單位實單位起作一毎隔位則之而視其最上一以爲用首位有防者以實首一位獨商之【乃補作一圏於原實之上亦成兩位之形】

首位無在次位者以實首位合商之

皆視平方大籌積數有與相同或差小於實者用之以減原數而得方數卽初商也

定位法曰旣得初商則約實以定其位知其所得爲何等【或單或十或百之類】以求次商

其法依前隔位所作之總計之視有若干防

假如只一者初商所得必單數也【自方一至方九】則初商已盡無次商矣

有二者初商所得必十數也【自方一十至方九十】初商十數者有次商

有三者初商所得必百數也【自方一百至方九百】初商百數者有次商又有三商

有四者初商千也有商四次焉

有五者初商萬也有商五次焉

次商法曰依前術定位則知其宜有次商與否

若已開得單數𨿽減積不盡不必更求次商也𨿽未開得單數而初商減盡亦不必更求次商也惟初商未是單數而減積又有不盡是有次商矣次商者倍初商爲亷法用小籌以除之【初商一則用第二籌初商七則用第一第四兩籌皆取倍數】視籌積數有小於余實者用之爲亷積視亷積在小籌某行命爲次商數

旣得次商減去亷積卽用次商數爲隅法以求隅積隅積小平方也卽隅法自乘之數也【可借開方籌取之】若隅積大於余實不及減者轉攺次商及減而止

以數明之假如積一百其方根十卽除實盡此獨用方法無亷隅矣若積一百四十四初商十除實百餘四十四則倍初商之根得廿爲亷法【在初商之兩旁故曰亷亷有二故倍之也】次商二以乘亷得四十爲亷積又次商二爲隅法自乘得四爲隅積共四十四除實盡開其根得一十二也

商三次以上法曰次商所得尙非單數而減積又有不盡是有第三次商矣

商第三次者合初商次商數皆倍之爲次亷法如前用籌以除余實求得第三商以減亷積

又卽以第三商之數爲隅法以求隅積皆如次商

商四次五次以上並同第三商

命分法曰但開至單數而有餘實者是不盡也不盡者以法命之法以所開得數倍之又加隅一爲命分不盡之數爲得分凡得分必小於命分

亦有開未至單宜有續商而其餘實甚少不能除作單一者亦如法命之而於其開得平方數下作圈紀其位如雲平方每面幾十○又幾十幾分之幾或平方每面幾百○○又幾百幾十幾分之幾

若欲知其小分別有開除分秒法見第七卷

列商數法曰凡初商得數而書之有二法其法依前隔位所作以最上一爲主凡得數皆書於此之上一位五以上者又進一位故有二法也

其故何也五以上之亷倍之則十故豫進一位以居次商四以下𨿽倍之猶單數也所以不同凡歸除開平方須明此理不則皆誤矣大約所商單數必在亷法之上一位乃法上得零之理也平方有實無法亷法者乃其法也

凡次商列位亦有二法次商用歸除除法者皆書於籌之第一位故次商以之

看次商所減之數其籌行內第一位是空與否若不空卽以次商數對而書之對余實首一位是也

若第一位是圈卽以次商數進位書之以暗對其圏余實上一位是也

知此則知空位矣次商有一定之位故空位亦一定也如次商與初商隔位則作圈隔兩位作兩圈是也

商三次以上書法並同

隅積定位法曰凡減隅積皆視其隅數爲何等【隅數卽次商之數也或單或十或百千等】以求其積

隅數是單其減隅積亦盡於單位

隅數是十其減隅積必盡於百位

隅數是百其減隅積必盡於萬位

隅數千其隅積必百萬

隅數萬其隅積必億

每隅數進退一位則隅積差兩位【隅積小平方也故皆與初商同理】

還原法曰凡開方還原皆以所開得數爲法又爲實而自相乘之有不盡者以不盡之數加入卽得原數

假如有積三百六十平方開之

列位【單位作圈】作防【從單位起】

視首位有以首位三百獨商之乃視平方籌積數有小於○三者是○一也○一之方一故商一十【有二故初商是十】

於原實內減去方積一百餘二百六十【初商是十知有次商】以上一爲主凡得數皆書於此之上一位此常法也四以下用常法

次倍初商【一十】作【二十】用第二籌爲亷法

視籌第九行積一八小於二六次商九於初商一十之下去亷積一百八十餘八十【所減數在籌上一位不空故以商數九對余實首位書之】

次以次商九爲隅法其隅積八十一大於余實不及減應轉攺次商爲八視籌之第八行積數【一六】減亷積一百六十餘一百【所減第一位下空故對位書之】

乃以次商八爲隅法減隅自乘積【六十四】余【三十六】不盡

隅數單故減隅積亦盡於單位

初商【一十】次商【八】共【一十八】是已開至

單位也而有單位也以法命之以平方【一十八】倍之又加隅【一】共【三十七】爲命分

命爲平方一十八又三十七分之三十六

還原法

以平方一十八用籌爲法卽以平方

一十八爲實而自相乘之得三百二

十四加入不盡之數三十六共得三

百六十如原數

命分還原論詳別捲

假如有積一十二萬九千六百平方開之

列位作

視首位無在次位以兩位一

十二萬合商之

乃視平方籌積有小於一二者是

○九其方三也於是商三百【三故初商百】減去方積九萬餘三萬九千六百【初商百故知有次商】

次倍初商【三百】作【六百】用第六籌爲亷法

視籌第六行積數【三六】小於【三九】次商六十於初商三百之下減去亷積三萬六千餘三千六百【所減首位不空故對書之】次以次商【六十】爲隅法減隅積三千六百恰盡【隅數十故減隅積必盡於百位】

凡開得平方三百六十○開方𨿽未至單減積已盡是方面無單數也後仿此

還原法

以所得平方三百六十○爲法爲實而自相乘之得一十二萬九千六百○○如原數

假如有積一千平方開之

列位作防

視在次位以首二位一千○百合商之

乃視平方籌小於【一○】者【○九】也【○九】

之方三商作三十【二防故初商十】減方積九百餘一百次以初商【三十】倍作【六十】用第六籌爲亷法

視第六籌第一行是【○六】小於【一百】次商一千初商三十之下減亷積六十餘四十【所減是○六首位空也故書於進位以對其○今𨿽對於余實以所減六十言之猶進位也列位之理明矣】

次以次商一爲隅法減隅積一餘三十九不盡【隅積盡單位】

所開已至單位而有不盡以法命之倍所商三十一又加隅一共六十三爲命分

命爲平方三十一又六十三分之三十九

此以上皆初商四以下列位之例皆以最上之一爲主而書其初商所得數於防之上一位乃常法也

假如有積四千○九十六平方開之

列位作

視在次位以四千○百合商之

乃視平方籌積數有三六小於四○

其方六也商作六十【二防故初商十】減方積

三千六百餘四百九十六【初商十故知有次商】

以最上一爲主而書其得數於之上兩位乃進法五以上用進法

次倍初商【六十】作【一百二十】爲亷法【用第一第二兩籌】視籌第四行積數【四八】小於余實次商四於初商六十之下減亷積四百八十餘一十六【所減是○四八首位空也故次商四進位書之若初商不進則次商同位矣】

次以次商四爲隅法減隅積一十六恰盡【隅數單故隅積盡單位】

凡開得平方六十四

假如有積八千○九十九以平方開之

列位作

視在次位以八千○百合商之

乃視平方籌有【六四】小於【八○】其方

八也於是商八十【二防故初商十】除實六千

四百餘一千六百九十九【初商是十宜有次商】次以初商八十倍作一百六十爲亷

法【用第一第六兩籌】

合視兩籌第一行積【一六】與余實同宜商【一十】因無隅積攺用第九行【一四四】次商九於初商八十之下減亷積一千四百四十餘二百五十九【所減第一位不空故對位書之】

次以次商九爲隅法減隅積【八十一】仍餘一百七十八不盡【隅數單隅積盡單位】

已開至單位而有不盡以法命之應倍所商八十九又加隅一共一百七十九爲命分

命爲平方八十九又一百七十九分之一百七十八【因少一數故不能成九十之方】

假如有積二千五百四十八萬二千三百○四平方開之列位作

視在次位以二千五百萬合商

之

乃視平方籌積有【二五】與實相

同其方五也商五千【四防故初商千】除方積二千五百萬餘四十八萬二千三百○四【初商千有次商】

【又法旣以四防知所得爲五千倍之則爲一萬卽亷法也法上一位便是單逆上三倍則五千位矣】

次倍初商【五千】作【一萬】爲亷法【用第一籌】

視籌第四行積四與余實同次商四十於初商五千之隔位減亷積四十萬餘八萬二千三百○四【所減是○四故進位書之以對其○然與初商五千猶隔一位故知所得爲四十此定位之法之妙也】次以次商四十爲隅法減隅積一千六百餘八萬○七百○四【隅數十故減隅積盡於百位商至十有末商】

次合初商次商倍之得【一萬○○八十】爲亷【用第一第八並二空位共四籌】

【大凡商五數以上則其亷法視所商方數必進一位不論初商次商皆然若四以下則其亷法視方數必同位亦初次商盡然】

合視籌內第八行積數【八○六四】小於余實又次商八於先商五千○四十之下減亷積八萬○六百四十餘六十四【此所減第一位亦是○故商數八亦進位書之以對其○】

次以末商八爲隅法用減隅積六十四恰盡【隅數是單故減隅積亦必盡於單位】

凡開得平方五千○四十八

以上皆商五以上進書例也

常法中有初商得二或四者進法中有初商得七或九者並雜見開方分秒法並開方捷法中

開立方法【籌算三】

勿庵氏曰物可以長短度者泰西家謂之綫綫之原度一橫一縮而自相乘之以得其羃積者平方也西法謂之方面方面與綫再相乘而得其容積則立方也西法謂之體

解曰平方長濶相等形如碁局立方長濶髙皆相等形如骰子細分之有方有平亷有長亷有小隅總曰立方

立方亦有實無法以所有散數整齊之成一立方形故亦曰開

立方長濶髙皆等今所求者其一邊之數故西法亦曰立方根

如圖方者初商也初商不盡

則再商之於是有三平亷三

長亷一小隅共七並初商方

形而八合之成一立方形

如圖方形者長濶髙皆如初商之數

方形只一

如圖平亷形者長濶相同皆如初商數其厚則如次商數【平亷形凡三以輔於方形之三面】長亷者長如初商數其兩頭髙與濶等皆如次商數【長亷形亦三以補三平亷之隙】

小隅者長濶髙皆等皆如次商數【其形只一以補三長亷之隙】

商三位圖

如後圖一方三平亷三長亷

一小隅除實仍不盡則更商

又得次平廉次長廉各三

次小隅一合之共十五形湊

成一大立方形次平亷之

長濶相等皆如初商並次商

之數厚如三商數其形三以

輔初商並次商合形之外次長亷之長如初商並次商之數其濶與厚相等皆如三商數其形亦三以補次平亷之隙次小隅之長濶髙皆等皆如三商數其形只一以補次長亷之隙

立方籌式【列後】

解曰上三位者自乘再乘之積也假如根一十則其積一千根二十則其積八千乃至根九十則其積七十二萬九千也次兩位者自乘之積卽平方也置於立方

籌者以爲亷法之用假如初商一百則

其平亷亦方一百其積一萬乃至商九

百則其平亷方九百而積八十一萬也

又如次商一十則其長亷之兩頭亦必

方一十而積一百乃至次商九十則其

長亷之兩頭必方九十而積八千一百

也下一位者方根也假如立積一千

則其根一十立積八千則其根二十乃

至積七十二萬九千則其根九十也

立方籌三位何也自乘再乘之數止於三位也且以爲初商之用故只須三位其餘實𨿽多位皆亷積耳

用法曰先以積列位至單位止無單者作圈以存其位次作從單位起每隔兩位作一【卽滿三位去之之法也】訖視最上一以爲用

在首位者獨商之以首位爲初商之實

單數商法也若千若百萬若十億若萬億若千萬億凡以三位去之餘一位者皆與單法同

在次位者合首兩位爲初商之實

十數商法也若萬若千萬若百億若十萬億若兆凡以三位去之餘二位者皆與十同法

在第三位者合首三位爲初商之實

百數商法也若十萬若億若千億若百萬億若十兆凡以三位去之餘三位者皆與百同法

又法視其在首位則於原實之上加兩圈在次位者上加一圈皆合三位而商之

次以初商之實與立方籌相比勘視立方籌積數有與實相同或差小於實者用之以減原實而得其立方之數卽初商也

定位法曰旣得初商則約實以定位知所得立方爲何等【或單或十百等】以知有續商與否皆以前所作防而合計之視有若干之命之

假如只有一則商數是單初商已得單數無次商

有二防者商數十初商十數者有商兩次焉有三者商數百初商百數者有三三次焉四商千五防商萬每多一防則得數進一位而其商數亦多一次皆以商得單數乃盡也

減積法曰凡初商減積皆止於最上之位

次商法曰依前定位若初商末是單而減積未盡是有次商也次商者有平亷法有長亷法有隅法【解曰平亷古曰方法長亷法古曰亷法以後或曰平亷長長亷從質也或省曰方法亷法從古也】

先以所得初商數三之爲亷法

又以初商數自乘而三之爲三法以方法用籌除積以得次商【以列位之法定之其法見後】

旣得次商用其數以乘方法爲三平亷積

又以次商自乘以乘亷法爲三長亷積

其次商卽爲隅法以隅法自乘再乘得小立方積爲隅積

乃並三平亷三長亷一小隅積爲次商亷隅共積若此亷隅共積與余積適等或小於余積則減而去之視其仍余若干以爲用【或續商或以法命之】

若共積反大於余實不及減轉攺次商及減而止【若次商單一而無減以法命之】

商三次法曰次商尙未是單而減積未盡是有第三次商也

第三次商者合初商次商得數而三之爲亷法又合初商次商得數自乘而三之爲方法如前以方法用籌除余實求得第三商【亦以列位法詳其所得】

旣得第三商如前求得三平亷三長亷一小隅積以減余實其法並同次商

四次以上皆同法

命分法曰但商得單數而有不盡則以法命之未商得單數而余實甚少不能商單一者亦以法命之其法以所商立方數自乘而三之【如平亷】又以立方數三之【如長亷】又加單一【如小隅】並三數爲命分不盡之數爲得分其命分必大於得分

列商數法曰依前隔位作防以最上一爲主而論之有三法凡商得立方一數者於此之上一位書之【或單一或一十或一百或一千並同】此常法也

若商得立方二三四五者於此之上兩位書之【單十百千其法並同】乃進法也

若商得立方六七八九者於此之上三位書之【單十百千其法並同】乃超進法也

平方只有進法而立方有三法何也平方以亷法爲法而平方只二亷故其亷法之積數只有進一位故止立進法與常法爲二也立方以方法爲法而立方有三平廉故其方法之積數有進一位進兩位故立進法超進法而與常法爲三也其預爲續商之地使所得單數居於法之上一位則同

假如立方單一其方法單三若立方單二則方法一十二變爲十數進一位矣故單一用常法而單二卽用進法也

又如立方單五其方法七十五若立方單六則方法一百○八又變百數進兩位矣故單五隻用進法而單六以上必用超進之法也

假如立方一十其方法三百若立方二十則方法一千二百變千數進一位矣故一十隻用常法而二十卽用進法也

又如立方五十其方法七千五百若立方六十則方法一萬○八百又變萬數進兩位矣故五十仍用進法而六十以上必用超進之法也

若宜進而不進宜超進而不超進則初商次商同位矣不宜進而進則初商次商理不相接矣此歸除開立方之大法也

其次商列位理本歸除以所減積數首一位是空不是空定其進退皆同平方商三次以上並同

隅積法曰隅法單隅積盡單位隅法是十隅積盡於千位

隅法百隅積盡百萬之位以上仿求大約隅法大一位則隅積大三位

還原法曰置開得立方數爲實以立方數爲法乘之得數再以立方數乘之有不盡者加入不盡之數卽得原實

假如有積一千三百三十一立方開之

列位作【從單位起】

視首位有以○○一千爲初商

之實

乃視立方籌有○○一其立方一

於是商一十【有二故商十】減去立方積一千餘三百三十一【初商十者有次商也】

以最上爲主商一數者書於防之上一位常法也次以初商一十而三之得三十爲亷法

又以初商一十自乘而三之得三百爲方法【用第三】

視籌第一行積數○三與余

實同次商一於初商一十之

下【減積首位是○故進位書於一十之下以暗對其○】

於是以次商一乘方法仍得三百爲平亷積又以次商一自乘仍得一用乘亷法仍得三十爲長亷積又以次商一自乘再乘皆仍得一爲隅積並三

積共三百三十一除余實恰盡

凡開得立方一十一【還法以立方一十一自乘得一百二十一又以一十一再乘合原積】

假如有積一十二億五千九百七十一萬二千立方開之列位作

視首位有以○○一十

億爲初商之實

乃視立方籌有○○一其方亦一於是商一千減立方積一十億餘二億五千九百七十一萬二千次以初商一千而三因之得三千爲亷法

又以初商一千自乘得一百萬而三之得三百萬爲方法【用第三籌】

視第三籌之第八行積數二四小於余實次商八十於初商一千之下一位【所減首位不空故次商八書本位而上一位作○因與次商隔位故知其是十】

就以次商八十乘方法三百萬得二億四千萬爲平亷積

又以次商八十自乘得六千四百用乘廉法三千得二千九百二十萬爲長亷積又次商八十自乘再乘得五十一萬二千爲隅積並三積共二億五千九百七十一萬二千除實盡

凡開得立方一千○八十○【初商千次商○八是十而除實已盡是所商單位亦○也此列位之妙】

以上皆商得一數例也皆以最上一爲主而以初商得數書於之上一位乃常法也惟商得一數者可用常法一十一百一千一萬並同

假如有積九千二百六十一立方開之

列位作

視在首位以○○九千命爲初商之實

乃視立方籌積有小於○○九者

○○八也其立方二於是商二十

【二故初商十】減立方積八千餘一千二

百六十一

以最上一爲主而以得數書於防之上兩位乃進法也商二至五之法也

次以初商二十用三因之得六十爲亷法

又以初商二十自乘得四百而三因之得一千二百爲方法【用第一第二兩籌】

合兩籌第一行積一二與余實相同次商單一於初商二十之下【所減首位空宜進書也若初商不先用進法則無以處次商矣故進法自商二始】

就以次商一乘方法仍得一千二百爲三平亷積又以次商一自乘得一用乘亷法仍得六十爲三長亷積又以次商一自乘再乘皆仍得一爲隅積並三積共一千二百六十一除實盡凡開得立方二十一

假如有立方積三萬二千七百六十八立方開之問得若干

列位作

視在次位以○三萬二千爲初

商之實乃視立方籌積小於○三

二者是○二七其立方三也於是

商三十【二防故初商十】減商三十【二故初商十】減立方積二萬七千餘五千七百六十八

次以初商三十用三因得九十爲亷法

又以初商三十自乘得九百而三之得二千七百爲方法【用第二第七兩籌】

合視兩籌第二行積○五四小於余實次商單二於初商三十之下【所減首位○宜進書以對其○】

就以次商單二乘方法得五千四百爲平亷積又以次商自乘得四用乘廉法得三百六十爲長廉積又以次商自乘再乘得八爲隅積並三積共五

千七百六十八除實盡凡開得立方三十二

假如有立方積一十一萬七千六百四十九立方開得若干

列位作

視在第三位以一十一萬七千爲初商之實

乃視立方籌積有小於一一七者

○六四也其立方四於是商四十

【二故初商十】減立方積六萬四千餘五

萬三千六百四十九次以初商四十用三因之得一百二十爲亷法

又以初商四十自乘得一千六百而三之得四千八百爲方法【用第四第八兩籌】

合視兩籌第九行積數四三二小於余實次商九於初商四十之下【所減首位不空故本位書之】

就以次商九乘方法得四萬三千二百爲平亷積又以次商九自乘得八十一用乘亷法得九千七百二十爲長亷積又以次商九自乘再乘得七百二十九爲隅積合計亷隅三積共五萬三千六百四十九除實盡

凡開得立方四十九

假如有積一千六百六十三億七千五百萬立方開得若干

列位作

視在第三位以一千六百六十億爲初商之實

乃視立方籌有小於一六

六者是一二五其立方五

也商作五千【四商千】除立方

積一千二百五十億餘四百一十三億七千五百萬次以初商五千用三因之得一萬五千爲亷法又以初商五千自乘得二千五百萬三因之得七千五百萬爲方法【用第七第五兩籌】

合視兩籌第五行積三七五小於余實次商五百於初商五千之下【所減首位不空故書本位】

就以次商五百乘方法得三百七十五億爲平亷積又以次商五百自乘得二十五萬用乘亷法得三

十七億五千萬爲長亷積又以次商五百自乘再乘得一億二千五百萬爲隅積並三積共四百一十三億七千五百萬除實盡凡開得立方五千五百○○

以上乃商得二三四五之例也皆以最上一爲主而以初商所得進書之上兩位進法也初商得二三四五者用進法單十百千並同

假如有積二十六萬二千一百四十四立方開之列位作

視在第三位以二十六萬二

千爲初商之實

乃視立方籌有小於二六二者

二一六也其立方是六商六十【二防商十】減立方積二十一萬六千餘四萬六千一百四十四

以最上一爲主而以得數書於之上三位超進法也乃商六至九之法也

次以初商六十用三因之得一百八十爲亷法又以初商六十自乘得三千六百而三因之得一萬○八百爲方法【用第一空位第八三籌】

合視籌第四行積四三二小於余實次商四於初商六十之下【所減首位是○故進位書之以對其○】

就以次商四乘方法得四萬三千二百爲平亷積又以次商四自乘得一十六用乘亷法得二千八百八十爲長亷積又以四自乘再乘得六十四爲隅積並三積共四萬六千一百四十四除實盡凡開得立方六十四

假如有積三十七萬三千二百四十八立方開之列位作

視在第三位以三十七萬三千爲初商之實

乃視立方籌積有小於三七三

者是三四三其立方七也商七

十【二商十】減立方積三十四萬三

千餘三萬○二百四十八次以初商七十用三因之得二百一十爲亷法

又以初商七十自乘得四千九百三之得一萬四千七百爲方法【用第一第四第七三籌】

合視籌第二行積二九四小於余實次商二於初商七十之下【所減首位空故進位書之以對其○】

就以次商二乘方法得二萬九千四百爲平亷積又以二自之得四用乘亷法得八百四十爲長亷積又以二自乘再乘得八爲隅積並三積共三萬

○二百四十八除實盡凡開得立方七十二

假如有積五十三萬一千四百四十一立方開之列位作

視在第三位以五十三萬一千爲初商之實

乃視立方籌積有五一二小於

五三一其方八也商八十【二商十】減立方積五十一萬二千餘一

萬九千四百四十一

次以初商八十用三因之得二百四十爲亷法又以八十自乘得六千四百三之得一萬九千二百爲方法【用第一第九第二三籌】

合視籌第一行是一九二小於實次商一於初商之下就以次商一乘方法爲平亷積又以一自乘用乘亷法爲長亷積又以一自乘再乘爲隅積並三積共一萬九千四百四十一除實盡

凡開得立方八十一

假如有積九十七萬○二百九十九立方開之

列位作

視在第三位以九十七萬○爲初商之實

乃視立方籌有七二九小於九七○其方九也商九

十【二商十】減積七十二萬九千餘

二十四萬一千二百九十九

次以初商九十三之得二百七十爲亷法

又以九十自之得八千一百而三之得二萬四千三百爲方法【用第二第四第三三籌】

合視籌第九行是二一八七小於余實次商九於初商九十之下【所減首位不空故本位書之】

就以次商九乘方法得二十一萬八千七百爲平亷積又以九自乘得八十一以乘亷法得二萬一千八百七十爲長亷積又以九自乘再乘得七百二十九爲隅積並三積共二十四萬一千二百九十九除實盡凡開得立方九十九

此以上皆初商六七八九之例也皆以最上一爲主而以得數書於之上三位乃超進法也初商六七八九用超進之法單十百千並同

命分例

假如有立方八百一十尺問立方每面各若干

列位作

在第三位以八百一十○尺爲

初商之實

視立方籌有小於實者爲七二九

其立方九商九尺減積【七百二十九尺】余【八十一尺】

此商數已至單尺而有不盡當以法命之

法以商數九自乘【八十一】而三之得【二百四十三】如平亷又置商數九而三之得【二十七】如長亷加小隅一共【二百七十一】爲命分

命爲立方每面九尺又二百七十一分尺之八十一此商得單數而有不盡以法命之例也

又如有立方積一億二千五百七十五萬尺問立方若干

列位作

在第三位以一億二千五百萬

尺爲初商實

視立方籌有【一二五】恰與實合商【五百尺】減實【一億二千五百萬尺】余【七十五萬○○○○尺】

有三故知所商是【五百尺】宜有第二商第三商也乃以初商【五百尺】自乘【二十五萬尺】而三之得【七十五萬尺】爲平亷法又以初商【五百尺】三之得【一千五百尺】爲長亷法視余實【七十五萬尺】僅足平亷之數而無長亷知第二商第三商皆空也補作兩圈而以法命之

法以平亷法長亷法合數加小隅一共【七十五萬一千五百○一尺】爲命分

命爲立方每面五百尺又七十五萬一千五百○一分尺之七十五萬○○○○

此商數𨿽未至單而余實甚少不能成一整數亦以法命之例也

歷算全書卷三十一

欽定四庫全書

歷算全書卷三十二

宣城梅文鼎撰

籌算四之五

開帶縱平方法

勿庵氏曰算有九極於勾股勾股出於圓方故少廣旁要相資爲用也然開平方以禦勾股而縱法以禦和較古有益積減積翻積諸術參伍錯綜盡神通變要之皆帶縱一法而已

【平方者長濶相等如碁局也平方帶縱者直田也長多於濶之數謂

之縱縱之濶如平方之數其長則如縱之數縱與方相乘得縱積以

加方積成一直田形積也】

平方與方縱兩形初商之積也兩

亷一隅一亷縱者次商之積也亷

有二故倍之亷之縱只一故不倍

也

如前圖除積不盡則有第三商如

此圖𨿽三商亦只倍亷而不倍縱

四商以上仿此詳之

用法曰先以積列位如法作防從單位起隔位防之視防在首位獨商之防在次位合兩位商之皆命爲實次以帶縱數用籌與平方籌並列之各爲法

視平方籌積數有小於實者用其方數爲初商用其積數爲方積【初商自乘之數也】卽視縱籌與初商同行之積數用之爲縱積【初商乘縱之數也如初商一則用縱籌第一行】兼方積縱積兩數以減原實而定初商【必原實中兼此兩積之數則初商無悞矣故曰定】若原實不及減攺而商之如前求得兩積以減之爲初商定數不及減又攺商之及減而止若應商十數因無縱積攺商單九是初商空也則於初商之位作○而紀其攺商之數於○下若次商者然【初商應是百而攺九十應是千而攺九百並同】

定位法曰旣得初商視所作原實之防共有幾何以定其得數之位以知其有次商與否【如一防則得數是單而無次商二防則得數是十而有次商之類皆如平方法取之】

次商法曰依前定位知初商未是單數而減積又有未盡是有次商也次商之法倍初商加入縱爲亷法用籌除之視亷法籌行內之積數有小於余實者用爲亷積以減余實用其行數爲次商就以次商自乘爲隅積以減余實以定次商【必余實內有亷隅兩積則次商無誤】不及減者攺商之及減而止皆如平方法

商三次以上並同次商

命分法曰若得數已是單而有不盡則以法命之法以所商數倍之加入縱爲亷又加隅一爲命分不盡之數爲得分

亦有得數非單而余實少在亷法以下不能商作單一者亦以法命之法卽以亷法加隅一爲命分

列商數法曰依平方法視所作防而以最上一防爲主若初商五以上【不論單五或五十或五千或五百並同】皆用進法書其其得數於防之上兩位則不論縱之多少也

若初商四以下【亦不論單十百千】則以縱之多少而爲之進退法以縱折半加入初商【單從單十從十百千各以類加】若滿五以上者變從進法書於防之上兩位【如初商四而縱有二初商三而縱有四之類】

若縱數少𨿽加之而仍不滿五數者仍用常法書其得數於防之上一位【如初商四而縱只有一初商三而縱只有二只有二之類】總而言之所商單數皆書於亷法之上一位故初商得數有進退之法乃豫爲亷法之地以居次商也初商五以上倍之則十𨿽無縱加亷法已進位矣初商𨿽四以下而以半縱加之滿五則其倍之加縱而爲亷法也亦滿十而進位矣亷法進位故初商必進兩位書也若加半縱仍不滿五則其亷法無進位矣故初商只進一位而書之蓋豫算所商單數已在亷法之上也

又初商若得單數其亷法卽爲命分凡商得單數必在命分之上一位以此考之庶無謬誤

假如有直田積六十三步但云濶不及長二步

列位【依平方法】作防【從單位起】

視防在次位合六十三步商之爲實次以平方籌與縱二籌平列之各爲法

視平方籌積有【四九】小於【六三】其方七也商作單

七【用進法書於防之上兩位一防知所商是單】

卽視帶縱籌第七行積數【一四】用爲縱積

並方積【四十九】縱積【一十四】共六十三除實盡【此亦偶除盡耳設不盡其命分必是十數故前商七之數必進書之以存其位】

定爲濶七步加縱二步得長九步

凡得數在五以上用進法書於防之上兩位此其例也

假如有直田六百三十步但雲長多濶二步

列位【無單位補作圈】作防

視防在首位獨商之以○六百步

爲實

以平方帶縱二各用籌爲法

視平方籌積數有【○四】小於【○六】

其方二商二十步【二防故初商十】自乘得方積【四百步】隨視縱籌第二行是【四】得縱積【四十步】並兩積共四百四十步以減原實餘一百九十步再商之【初商十故有次商也商數二十以縱折半得單一加之共二十一仍不滿五數故只用常法書於防之上一位】

次以初商【二十步】倍之【四十步】加縱【二步】共四十二步爲亷法【用第四第二兩籌】

合視兩籌第四行積數【一六八】小於【一九○】次商【四】減亷積一百六十八步餘二十二步【所減首位不空次商故書本位】次以次商【四步】爲隅法自乘得【一十六步】爲隅積用減余實不盡六步以法命之【初商𨿽不進位所得次商單數已在命分之上一位矣列商數法妙在於此】倍所商【二十四步】爲【四十八步】加縱【二步】又加隅【一步】共五十一步爲命分

命爲濶【二十四步】又【五十一分步之六】加縱【二步】得長【二十六步】又【五十一分步之六】

凡得數在四以下以半縱加之仍不滿五則只用常法書於防之上一位此其例也

假如有直田五畝但雲長多濶八十八步

列位【以畝法二百四十通之得一千二百步十步單步空補作兩圈】作防

視防在次位合商之以一千二

百步爲實縱有兩位用兩籌與

平方籌並列各爲法

先視平方籌有【○九】小於【一二】宜商三十【二防商十】因有縱攺商二

十其方積四百步縱積一千七

百六十步【初商十與縱相乘故縱單數皆成十數】兼兩積共二千一百六十步大於實不及減所商有誤抹去之

攺商【一十步】其方積【一百步】其縱積【八百八十步】並兩積共除實九百八十步餘二百二十步再爲實以求次商【初商十故有次商也】

【縱折半四十四步加初商一十步共五十四步故變用進法】

次以初商【一十步】倍之【二十步】加縱【八十八步】共一百○八步爲亷法【用第一空位第八三籌】

合視籌第二行積【二一六】小於【二二○】次商【二步】於初商【一十步】之下減亷積一百一十六餘四步【所減首位○故進書之初商豫進正爲此也】

次以次商【二步】自乘得四步爲隅積除實盡

定爲濶一十二步加縱【八十八步】得長一百步

假如有直田一十二畝半但雲長多濶七十步

列位【以畝法二百四十通之得三千步百十單皆作圈】作防

視防在次位以三千○百步爲實

以平方帶縱七十各用籌爲法

先視平方籌積有二五小於【三○】宜

商【五十】因縱攺商【四十步】其方積一

千六百步其縱積二千八百步共四

千四百步大於實不及減抹去之

攺商【三十步】其方積【九百步】其縱積【二千一百步】共三千步除實盡

【縱七十折半三十五加初商三十共六十五是五以上也故用進法書商三於防上兩位假有餘實則當再商或命之以分今𨿽商盡當存其位命分者亷法加隅一也倍初商加縱共一百三十是原實百者亷法之位也進一位乃單位初商不進兩位何以容單數】

凡開得平方三十步爲田濶加縱七十步共一百步爲長

假如有直田七畝但雲長多濶六十步

列位【以畝法二百四十通之得一千六百八十步單位空作圈】作防

視防在次位合商之以一千六百步

爲實

以平方帶縱六十步用籌各爲法

先視平方籌有一六與實同宜商四

十【二防初商是十】因帶縱攺商三十步其方

積【九百步】縱積【一千八百步】共二千

七百步大於實不及減抹去之

攺商【二十步】其方積【四百步】縱積【一千二百步】共減一千六百步餘八十步再商之

【縱折半三十加初商共五十故進書之】

【假余實滿命分一百○一步卽當商一步故初商豫進以居次商今次商𨿽空當存○位故也】

次以初商【二十步】倍之【四十步】加入縱六十步共一百步爲亷法亷法大於余實不及減次商作○其餘實以法命之法以亷法加隅一爲命分

命爲濶【二十步】又【一百○一分步之八十】加縱爲長【八十步】又【一百○一分步之八十】

假如有直田四畝但雲長多濶九十步

列位【以畝法通之得九百六十步】作防

視防在首位獨商之以○九百爲實

以平方帶縱九十步各用籌爲法

先視平方籌積有【○九】與實同宜

商三十步【二防故初商十】因帶縱攺商二

十步其方積【四百步】縱積【一千八】

【百步】不及減又攺商一十步其方積【一百步】縱積【九百步】共一千步仍不及減此有二防宜商十步今攺商一十仍不及減是初商十位空也

【縱九十折半四十五加初商十步滿五十以上故商一進書防之上兩位】

攺商單九步其方積【八十一步】縱積【八百一十步】共八百九十一步以減實餘六十九步不盡【此宜商十數者變商單步故初商之位作○而以攺商之九步書於○位下如次商然也蓋必如此書之所商單數乃在命分之上一位也】

商數已得單步而有不盡以法命之以商九步倍之加縱九十步共一百○八步更加隅一步共一百○九步爲命分

命爲濶九步又【一百○九分步之六十九】加縱爲長九十九步又【一百○九分步之六十九】

以上四則乃縱多進位之法也凡得數𨿽四以下以半縱加之滿五卽用進法書於防之上兩位此其例也

開帶縱立方法【籌算五】

勿庵氏曰泰西家說勾股開方甚詳然未有帶縱之術同文算指取中算補之其論帶縱平方有十一種而於立方帶縱終缺然也程汝思統宗所載又皆兩縱之相同者惟難題堆垜還原有二例只一可用其一彊合而已非立術本意又不附少廣而雜見於均輸𨿽有善學何從而辧之玆因籌算稍以鄙意完其缺義取曉暢不厭煩復使得其意者可施之他率不窮云爾

凡立方帶縱有三

一隻帶一縱

如雲長多方若干或髙多方若干是也【卽同髙】

一帶兩縱而縱數相同

如雲長不及方若干髙不及方若干是也【此方多數爲縱】

一帶兩縱而縱數又不相同

如雲長多濶若干濶又多髙若干是也

大約帶一縱者只有縱數而已帶兩縱者有縱亷又有縱方故其術不同

帶一縱圖三

此長多於方

此髙多於方

也爲橫縱橫

也爲直縱直

縱之形濶與

縱之形長濶

髙等如其方

相等如其方

其厚也如其

其髙也如其

縱所設

縱所設

俱立方一縱形一合爲長立方形

如圖立方形方縱形合者初商

也平亷三內帶縱者二長亷三

內帶縱者一小隅一此七者次

商也

平亷所帶之縱長與立方等厚

與次商等其髙也則如縱所設

長亷所帶之縱兩頭橫直等

皆如次商其髙也如縱所設

用法曰以積列位乃作防從單位起隔兩位防之防畢視積首位有防獨商之以首位爲初商之實首位無防以首位合有防之位商之防在次位以首兩位爲初商之實防在第三位以首三位爲初商之實皆同立方法

先視立方籌積數有小於初商之實者用其方數爲初商【定位法合計所作防共有若干一防者商單數二防則商十數每一防進一位皆如立方】用其積數爲初商立方積【定位法視初商方數若初商單數其積亦盡於單位若初商十數其積乃盡於千位每初商進一位其積進三位亦可以防計之皆如立方】

次以初商自乘以乘縱數爲縱積

合計立方積縱積共數以減原積而定初商【若初商無誤者原實中必兼此兩積】命初商爲方數加縱數爲髙數【或長數皆依先所設】不及減者攺商之及減而止

次商法曰依前定位知初商是何等【或單十百千等】若初商未是單數而減積又有不盡是有次商也

法以初商自乘而三之又以縱與初商相乘而兩之共爲平亷法又法以初商三之縱倍之並其數與初商相乘得數爲平亷法或以初商加縱而倍之並初商數以乘初商爲平亷法並同

又以初商三之加縱爲長亷法

乃置余實列位以平亷法除之得數爲次商【用籌爲法除而得之】

【依除法定其位】

於是以次商乘平亷法爲三平亷積又以次商自乘以乘長亷法爲三長亷積就以次商自乘再乘爲隅積合計平亷長亷隅積共若干數以減原實【原實中兼此並積知次商無誤矣】乃並初商次商所得數爲方數加縱命爲髙數【或長數皆如先所設】合問不及減者攺商之及減而止

商三次者以初商次商所得數加縱而倍之並商得數爲法仍與商得數相乘爲平亷法

又以商得數三之加縱爲長亷法余並同次商

命分法曰己商至單數而有不盡則以法命之其法以所商得數加縱倍之加所商得數以乘所商得數【如平亷】又以所商得數三之加縱【如長亷】並兩數又加單一【如隅】爲命分不盡之數爲得分

或商數尙未是單而余實甚少在所用平亷長亷兩法並數之下或僅同其數【僅同者無隅積】是無可續商也亦以法命之法卽以所用平亷長亷兩法並之又加隅一爲命分

列商數法曰依立方法以初商之實有防者爲主【卽原實內最上之一防】凡初商得數必書於防之上一位乃常法也惟初商一數者用常法

有以初商得數書於防之上兩位者進法也初商二三四五者用進法

有以初商得數書於防之上三位者超進法也初商六七八九者用超進之法

若縱數多亷法有進位則宜用常法者攺用進法宜用進法者用超進之法宜超進者更超一位書之其法於次商時酌而定之蓋次商時有三平亷法三長亷法再加隅一爲命分法於原實尋命分之位爲主命分上一位單數位也從此單數逆尋而上自單而十而百而千至初商位止有不合者攺而進書之若與初商恰合者不必彊攺此法甚妙平方帶縱亦可用之

若宜商一十而攺單九或宜商一百而攺九十凡得數退攺小一等數者皆不用最上一防而以第二防論之此尢要訣【或於初商位作圈而以所商小一等數書於圈之下卽可以上一防論也細考其數則同此商數列位立法之妙宜詳翫之】

假如浚井計立方積七百五十四萬九千八百八十八尺但云深多方八百尺法以立方帶縱爲法除之列位作防

視防在首位獨商之以○

○七百萬尺爲初商之實

以立方籌爲法視立方籌積有○○一小於○○七商一百尺【三防故初商百商一百故用常法書於防之上一位】得立方積一百萬尺【三防者方積盡百萬之位初商之方積皆盡於最上之一防】

次以初商一百尺自乘一萬尺乘縱八百尺得八百萬尺爲縱積並兩積九百萬積大於原實不及減抹去之不用攺商如後圖

視立方籌第九行積七二九攺商九十尺得立方積七十二萬九千尺【百攺十故亦攺用第二防第二防是十位故方積亦盡於千位】次

以初商九十尺自乘八千一

百尺乘縱八百尺得六百四

十八萬尺爲縱積並兩積

共七百二十萬○九千尺以減原實餘三十四萬○八百八十八尺再商除之【初商一百今攺商九十故上一防不用用第二防論之商九者書於第二防之上三位超進法也】

次用次商又法以縱八百尺加初商九十尺而倍之得一千七百八十尺並初商九十尺共一千八百七十尺用與初商九十尺相乘得一十六萬八千三百尺爲平亷法又以初商九十尺三因之得二百七十尺加縱八百尺共得一千○七十尺爲長亷法乃列余實以平亷爲法除之【用第一第六第八第三共四等】

商九十用超進法書於第二防之上三位今以縱多致亷法進爲十萬故次商時應更爲酌定又超一位書之然後次商單數在亷法上一位矣攺如後圖【亷法十萬上一位單數位也今商九十不合在此位故攺之】

合視籌第二行積○三三六六小於余實次商二尺於初商九十之下【所減首位是○法宜進書也初商不攺而更超之何以居次商】就以次商二尺乘平亷法得三十三萬六千六百尺爲平亷積又以次商二尺自乘四尺用乘長亷法得四千二百八十尺爲長亷積又以次商二尺自乘再乘得八尺爲隅積並三積共三十四萬○八百八十八尺除實盡

乃以商數命爲井方加縱爲井深

計開

井方九十二尺深八百九十二尺

此超進法攺而更超一位也

帶兩縱縱數相同圖二

此髙不及方也方之橫與直俱

多於髙是爲兩縱兩縱者縱廉

二縱方一並立方而四

立方形長濶髙皆相等

縱亷形髙與濶相等如其方之

數其厚也如所設縱之數

縱方形兩頭等皆如縱數其髙也如立方之數兩縱亷輔立方兩面而縱方補其隅合爲一短立方形

不及之數有在立方旁者觀後圖可互見其意

如圖初商有立方有縱廉二縱方一共四形今只圖其二餘爲平廉所掩意防之可也【此橫頭不及方也卽前圖之眠體】

次商平廉三內帶一縱者二帶兩縱者一長廉三內帶縱者二小隅一共七

平廉帶一縱者濶如初商加縱爲長厚如次商其帶兩縱者髙濶皆等皆如初商加縱之數厚如次啇

長廉帶縱者長如初商加縱之數其兩頭橫直皆等皆如次商

無縱長廉長如初商兩頭橫直等如次商

小隅橫直髙皆等皆如次商

用法曰先以縱倍之爲縱廉【兩縱並也】以縱自乘爲縱方【兩縱相乘】

此因兩縱數同故其法如此也若兩縱不同徑用乘法並法矣

乃如法列位作防求初商之實

以立方籌爲法求得初商方數及初商立方積【皆如立方法皆依定位法命之】

次以初商乘縱方得數爲縱方積又以初商自乘數乘縱亷得數爲縱亷積

合計縱方縱亷立方之積共若干數以減原實而定初商【皆如一縱法】

命初商爲髙數【或深數皆如所設】加縱爲方數【不及減攺商之若初商未是單數則以余實求次商】

次商法曰以初商加縱倍之以乘初商髙數得數又以初商加縱自乘得數並之共爲平亷法【又法初商三之加縱以初商加縱乘之得數爲平亷法亦同】

次以初商加縱倍之並初商數共爲長亷法【又法初商三之縱倍之並爲長亷法亦同】

乃置余實列位以亷法位酌定初商列法而進退之以平亷爲法而除余實得數爲次商【皆以所減首位是○與否而爲之進若退】又法合平亷長亷兩法以求次商

於是以次商乘平亷法爲平亷積又以次商自乘數乘長亷法爲長亷積又以次商自乘再乘爲隅積合計平亷長亷隅積共若干數以減余實而定初商【皆如一縱法】

【又法以次商乘長亷法爲長亷法又以次商自乘爲隅法並平亷長亷隅法以與次商相乘爲次商亷隅共積以減余實亦同】

乃命所商數爲髙【或深之類如所設】加縱數命爲方合問

不盡者以方倍之乘髙又以方自乘【如平亷】又以方倍之並髙【如長亷】又加單一【如隅】爲命分

假如有方臺積五百八十六萬六千一百八十一尺但云髙不及方一百四十尺以帶兩縱立方爲法除之【方者長濶等每面各多髙一百四十尺】

先以縱一百四十尺倍之得二百八十尺爲縱積又縱自乘之得一萬九千六百尺爲縱方

列位加防

視防在首位獨商之以○

○五百萬尺爲初商之實

視立方積有○○一小於

○○五商一百尺【三防故商百尺】得立方積一百萬尺【商一數宜用常法書於防之上一位今因縱多致亷法升爲十萬法上一位爲單單上一位爲十今初商是百尺故攺用進法書之亷法之升見後】

就以初商一百尺乘縱方得一百九十六萬尺爲縱方積

又以初商一百自乘一萬乘縱亷得二百八十萬尺爲縱亷積

合計立方縱方縱亷積共五百七十六萬尺以減原實餘一十萬○六千一百八十一尺【初商百尺宜有續商】初商一百尺髙也加縱共二百四十尺方也次以方倍之四百八十尺用乘髙數得四萬八千尺又以方自乘之得五萬七千六百尺並之得一十萬○五千六百尺爲平亷法

又以方倍之並髙得五百八十尺爲長亷法

乃列余實以亷法酌定初商攺進一位書之

以平亷法用籌除余實

視籌第一行○一○五六

小於余實次商一尺於初

商一百尺之隔位【所減是○一○五六首位○宜進書然猶與初商隔位故知爲單一尺】就以次商一尺乘平亷法如故又以次商一尺自乘以乘長亷法亦如故就命爲平亷長亷積又以次商自乘再乘仍得一尺如故合計三積共一十萬○六千一百八十一尺除實盡

乃以所商數命爲臺髙加縱爲方

計開

臺髙一百○一尺方二百四十一尺

此常法攺用進法也

假如有方池積五十萬丈但云深不及方五十尺先以縱【五十】尺倍之一百爲縱亷又縱自乘之得【二千五百】尺爲縱方

列位加防

視防在第三位合商之以五十

萬○○尺爲初商之實

視立方籌有三四三小於五○

○宜商七十尺【二防商十尺】因縱攺商六十尺得立方積二十一萬六千尺次以初商六十尺自乘三千六百尺用乘縱亷一百尺得三十六萬尺已大於實不及減不必求縱方積矣攺商五十尺用籌求得立方積一十二萬五千尺

就以初商五十尺乘縱方得縱方積亦一十二萬五千尺又以初商五十尺自乘二千五百尺用乘縱亷得縱亷積二十五萬尺並三積共五十萬尺除實盡以商數命爲池深加縱爲方

計開池深五十尺方一百尺

此進法攺爲超進也【假有次商則其平亷法二萬尺矣假有命分則其命分二萬○二百五十一矣】亦有髙與長同而濶不及數者準此求之但以初商命爲濶而加縱爲髙與長

帶兩縱縱數不相同圖二

此長多於濶而髙又多於

長也是爲兩縱而又不相

同凡爲大縱亷小縱亷各

一縱方一並立方形而四

立方形長濶髙相等

大縱亷橫直等如其方而

髙如大縱小縱亷髙濶

等如其方而厚如小縱

縱方形之兩頭髙如大縱厚

如小縱其長也則如立方大

縱小縱以輔立方之兩

面而縱方補其闕合爲一長

立方形如圖初

商有立方有大縱廉小縱廉

縱方各一共四隻圖其二餘

爲平廉所掩也次商平廉三

內

帶小縱者一帶大縱者一帶

兩縱者一長廉【在初商大縱立方之

背面】三內帶小縱

者一帶大縱者一小隅一共

七在初商

大縱立方之

帶小縱平亷濶如初商長如初商加小縱之數髙如次商

帶大縱平亷濶如初商髙如初商加大縱之數厚如次商

帶兩縱平亷濶如初商加小縱之數髙如初商加大縱之數厚如次商

帶小縱長亷長如初商加小縱之數帶大縱長亷髙如初商加大縱之數無縱長亷長如初商數其兩頭橫直皆如次商之數

小隅橫直髙皆如次商之數

用法曰以兩縱相並爲縱亷以兩縱相乘爲縱方列位作防求初商之實以立方籌求得初商立方積以初商求得縱方縱亷兩積皆如前法乃以初商命爲濶各加縱命爲長爲髙

求次商者以初商長濶髙維乘得數而並之爲平亷法

又以初商長濶髙並之爲長亷法

乃置余實列位【以平亷酌定初商之位】以平亷爲法求次商及平亷積長亷積隅積以減余實乃命所商爲濶各以縱加之爲髙爲長【如所設】皆如前法

不盡者以所商長濶髙維乘並之【如平亷】又以長濶髙並之【如長亷】又加單一【如隅】爲命分

假如有長立方形積九十尺但云髙多濶三尺長多濶二尺

先以兩縱相並五尺爲縱亷以兩縱相乘六尺爲縱方

列位作防

視防在第二位合商之以○九十

○尺爲初商之實

乃視立方籌有○六四小於○九○宜商四八因有縱攺商三尺得二十七尺爲立方積【原實只一防故初商是單商三故書於防之上兩位用進法也】

次以初商三尺自乘九尺乘縱亷得四十五尺爲縱亷積

又以初商三尺乘縱方得一十八尺爲縱方積並三積共九十尺除實盡

乃以初商命爲濶各加縱爲髙爲長

計開

濶三尺長五尺髙六尺

假如有立方積一千六百二十尺但雲長多濶六尺髙多濶三尺

先以兩縱相並九尺爲縱亷以兩縱相乘一十八尺爲縱方

列位作防

視防在首位獨商之以○○一千

尺爲初商之實

乃視立方籌有○○一與實同商一十尺【二防商十】得立方積一千尺次以初商一十尺自乘一百尺乘縱亷得九百尺爲縱亷積又以初商一十尺乘縱方得一百八十尺爲縱方積合計之共二千○八十尺大於實不及減【商一十故用常法書於防之上一位】攺商九尺得七百二十九尺爲立方積【十變爲單則上一防不用用第二防故商九書於第二防之上兩位用超進法也】

次以初商九尺自乘八十一乘縱亷亦得七百二十九尺爲縱亷積

次以初商九尺乘縱方得一百六十二尺爲縱方積並三積共一千六百二十尺除實盡

乃以商數命爲濶各加縱爲長爲髙

計開

濶九尺長一十五尺髙一十二尺

假如有長立方積六萬四千尺但雲長多濶五尺髙又多長一尺

先以長多五尺髙多六尺並之得【十十】爲縱亷又以五尺六尺相乘三十爲縱方

【解曰長多濶五尺髙又多長一尺是髙多濶六尺也】

列位作防

視防在第二位合商之以○六

萬四千尺爲初商之實

視立方籌有○六四與實同宜

商四十尺因有縱攺商三十尺【二防故商十尺】得二萬七千尺爲立方積【商三十故書於防之上兩位用進法也】

次以初商三十尺自乘九百尺乘縱亷得九千九百尺爲縱亷積

次以初商三十尺乘縱方得九百尺爲縱方積並三積共三萬七千八百尺以減原實餘二萬六千二百尺再商之【初商十宜有次商】

初商三十尺濶也加縱五尺共三十五尺長也又加一尺共三十六尺髙也

乃以初商長濶髙維乘之

濶乘長得一千○五十尺髙乘濶得一千○八十尺長乘髙得一千二百六十尺

並三維乘數共三千三百九十尺爲平亷法【又法並長與髙乘濶又以髙乘長並之亦同】

次以初商長濶髙並之共一百○一尺爲長亷法【又法初商三之加兩縱亦同】

乃以平亷用籌爲法以余實列位除之

如後圖合視籌第六行是二○三四小於余實次商六尺【所減首位不空故書本位】得二萬○三百四十尺爲平亷積【次商乘平亷法也】

次以次商六尺自乘三十六尺乘長亷法得三千六百三十六尺爲長亷積又以次商六尺自乘再乘得二百一十六尺爲隅積

並三積共二萬四千一百九十二尺以減余實餘二千○○八不盡以法命之

法以初商濶髙長各加次商爲濶髙長而維乘之濶乘長得一千四百七十六尺髙乘濶得一千五百一十二尺長乘髙得一千七百二十二尺

並得四千七百一十尺【如平亷】又並濶髙長得一百一十九尺【如長亷】又加一尺【如隅】共得四千八百三十尺爲命分不盡之數爲得分

命爲四千八百三十分尺之二千○○八卽奇數也計開

濶三十六尺有奇【音基】長四十一尺有奇髙四十二尺有奇

假如有長立方形積一十萬○一千尺但雲長多濶五尺髙多濶六尺

先以兩縱並得一十一尺爲縱亷

以兩縱乘得三十尺爲縱方

列位作防

視防在第三位合三位商之以

一十萬○一千爲初商之實

乃視立方籌有○六四小於一

○一商四十尺【二防商十】得六萬四千尺爲立方積【商四十故書於防之上兩位進法也】

次以初商自乘一千六百尺乘縱亷得一萬七千六百尺爲縱亷積

次以初商乘縱方得一千二百尺爲縱方積

並三積共八萬二千八百尺以減原實餘一萬八千二百尺再商之

初商四十尺濶也加縱五尺得四十五尺長也加縱六尺得四十六尺髙也

乃以初商濶長髙而維乘之

長乘濶得一千八百尺濶乘髙得一千八百四十尺【又法並髙與長九十一尺以濶四十尺乘之共三千六百四十尺省兩維乘其數亦同】髙乘長得二千○七十尺

並維乘數共五千七百一十尺爲平亷法

又以濶長髙並之共一百三十一尺爲長亷法乃列余實以平亷用籌爲法除之

合視籌第三行是一七一三小於

余實次商三尺【所減首位不空故本位書之】就

以次商三尺乘平亷法得一萬七

千一百三十尺爲平亷積又以

次商三尺自乘九尺乘長亷法得一千一百七十九尺爲長亷積又以次商三尺自乘再乘得二十七尺爲隅積並之得一萬八千三百三十六尺大於余實不及減

攺商二尺

就以次商二尺乘平亷法得一萬一千四百二十尺爲平亷積【卽用籌第二行取之】

次以次商自乘四尺乘長亷法得五百二十四尺爲長亷積又以次商自乘再乘得八尺爲隅積並之共一萬一千九百五十二尺以減余實仍餘六千二百四十八不盡以法命之

法以濶長髙各加次商二尺爲濶長髙而維乘之並髙四十八尺長四十七尺共九十五尺以濶四十二尺乘之得三千九百九十尺【代兩維乘】又以長乘髙得二千二百五十六尺並得六千二百四十六尺又以長濶髙並之得一百三十七尺又加一尺共六千三百八十四爲命分

命爲六千三百八十四之六千二百四十八卽奇數計開

濶四十二尺有奇

長四十七尺有奇

髙四十八尺有奇

歷算全書卷三十二﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

欽定四庫全書

歷算全書卷三十三

宣城梅文鼎撰

籌算六之七

開方捷法

勿庵氏曰亷隅二形也故有二法今借開方大籌爲隅法列於亷法籌之下而合商之則亷隅合爲一法而用加捷矣存前法者所以著其理用捷法者所以善其事

平方

法曰如前列實從單位作防每隅位防之以求初商【初商列位有常法進法俱如前】旣得初商卽倍根數爲亷法【亦同前法】以亷法數用籌【亷法幾位用籌幾根】列於平方籌之上爲亷隅共法【或省曰次商法】合視亷隅共法籌某行內有次商之實同者或略少者減實以得次商【以本行內方根命之】

三商者合初商次商倍之以其數用籌列平方籌上爲亷隅共法【或省曰三商法】以除三商之實而得三商四商以上仿此求之

解曰隅者小平方也故可以平方籌爲法亷之數每大於隅一位今以平方籌爲隅列於亷之下則隅之進位與亷之本位兩半圓合成一數故亷隅可合爲一法

【何以知亷大於隅一位也曰有次商則初商是十數矣平方亷法是初商倍數其位同初商故大於隅一位】

凡初商減積盡最上一防故最上一防者初商之實也次商減積盡第二防故第二防以上次商之實也三商減積盡第三防故第三防以上三商之實也推之第四防爲四商之實第五防爲五商之實【以上並同】

審空位法曰若次商之實小於亷隅共法之第一行【凡籌第一行最小數也】則知次商是空位也【不能成一數故空】卽作圈於初商下以爲次商乃於亷法籌下平方籌上加一空位籌爲亷隅共法以求三商【若空位多者另有簡法見後】三商實小有空位並同

假如有平方積二千四百九十九萬九千九百九十九尺問每面若干

列位作防

如圖防在次位以二千四百

萬爲初商實

視平方籌有小於二四者是

一六其方四也商四千尺減積一千六百萬尺【有四防故初商是千而有次商】

次以初商四千尺倍之得八千尺爲亷法用第八籌列平方籌上爲亷隅共法

以第二防余實八百九十九萬爲次商實視籌第九行合數八○一小於實次商九百尺減實八百○一萬尺

【此所減首位不空故對位書之】

次倍初商次商共四千九百尺得九千八百尺用第九第八兩籌列平方籌上爲廉隅共法以第三防上余實九八九九爲三商之實

合視籌第九行是八九○一小於實商九十尺減余

實八十九萬○一百

尺

【首位不空故亦對位書之】

次倍三次商共四千九百九十尺得九千九百八十尺用九九八三籌列平方籌上爲廉隅共法

以第四防上余

積九九八九九

爲四商之實

合視籌第九行

積八九九○一

小於實商九尺

減余實八萬九

千九百○一尺

不盡九千九百九十八尺

開方已得單尺而有不盡以法命之倍方根加一數得九千九百九十九爲命分

凡開得平方四千九百九十九尺又九千九百九十九之九千九百九十八

右例可明四以上用常法之理蓋積所少者不過萬分之一不能成五數之方而其法迥異

加空籌式

假如有平方積一千六百七十七萬七千二百一十六問每面若干

列位作防

如圖防在次位以一千六百萬

爲初商實

視平方籌有一六與實同其方

四商四千尺減積一千六百萬尺【凡余實必在商數下一位起倘空位則作圈補之後仿此】次以初商四千尺倍得八千尺爲亷法用第八籌列平方籌上爲亷隅共法【籌見前例】

以第二防上余實○七七爲次商實

籌最小數是○八一【第一行數】大於實

不及減是商數無百也

乃於初商四千下作一圈以爲次

商【減去實中○位】次如上圖加一空位籌於次商亷法之下平方籌之上爲三商亷隅共法

以第三防上七七七二爲三商實

視籌第九行是七二八一小於實商九十尺減積七十二萬八千一百

次合初商次商三商共四○九倍之得八一八爲廉法

去空位籌加一八兩籌列於平方籌之上爲四商廉隅共法

以第四防上四九一一六爲四商之實

合視籌第六行數與實合商六尺減積四萬九千一百一十六尺恰盡

凡開得平方四千○九十六尺

假如有平方積九億○○一十八萬○○○九步問每面若干

列位

作防

如後圖防在首位以○九億步爲初商實

視平方籌有○九與實同商

三萬步【五防故初商萬】減積九億步

次以初商三萬步倍之得六

萬步用第六籌加平方籌上爲次商法【卽廉隅共法】以第二防上爲次商之實視實三位俱空無減知商數有空位且不止一空位也如前法宜挨次商得一空位則於原實內銷一圈【凡續商之實必下於前商之實一位故𨿽○位必減去之以淸出續商之實】而於共法籌內加一空位籌如此挨商頗覺碎雜故攺用又法

又法曰凡實有多空位者知商數亦有多空不必挨商當於原實中審定可減之數在何位則此位之上皆連作圈而徑求後商如此余實有三圈皆無積可減必至○一乃有可減而法是第六籌籌最小是○六大於○一仍不可減必至一八方可減而一是籌之進位當以商數對之則知以上俱是空位乃皆作圏合視之有三圈卽次商三商四商也幹原實內銷去三圈如後圖

此卽次商三商四

商合圖也

次加三空籌於平亷【第六籌】之下平方之上爲五商亷隅共法徑以第五防上一八○○○九爲五商實

視籌第三行數與余實合商三尺

除積一八○○○九恰盡

凡開得平方三萬○○○三步

又假如積二千五百○七萬○○四十九尺問方若干列位作防

如圖防在次位以二千五

百萬尺爲初商實

視平方籌有二五與實同

其方五商五千尺減積二千五百萬尺

次倍初商五千尺得一萬○千尺用一籌空位籌爲廉法【凡商得五數則原帶有空位】列平方籌上爲次商法實多空位以前除又法審之必至○七萬尺乃有可減而○七之○與籌上首位之○對當以商數居之則知此以上俱無商數也於是於初商五千下作兩圏如後圖

此次商三商合圖也【原實上減兩圏商數下加兩圏】

如上圖加兩空位籌於廉法一萬○千之下平方之上爲四商法

以○七○○四九爲四商實【次商三商之兩防已銷故徑用第四防】

視籌第七行相合商七尺減實

恰盡

凡開得平方五千○○七尺

又假如積五千六萬三千五百○○尺問方若干列位

作防如圖防在次位以五十六萬爲初商實

視平方第七行是四九小

於實商七百尺除實四十

九萬

次倍初商七百得一千四百用第一第四兩籌列平方籌上爲次商法以第二防上○七三五爲次商實

合視第五

行是○七

二五小於

實商五十

尺減去余

積○七萬

二千五百

尺

次合商數七百五十倍之得一千五百○尺應用第一第五空位三籌加於平方籌上爲三商法以第三防上○一千○○尺爲三商實而實小於法不能成一尺乃於商數未作一圏以爲三商其不盡之數以法命之

凡亷隅共法籌第一行數卽命分

也蓋能滿此數卽成一單數矣

凡開得平方七百五十○尺又一

千五百○一之一千○○○約爲

三之二弱

立方

法曰如前列實隔兩位作防以求初商旣得初商卽以初商數自乘而三之爲平亷法【卽方法】以平亷法用籌列於立方籌之上【借立方籌爲隅法也】爲平亷小隅共法別以初商數三之而進一位爲長亷法【卽亷法】以長亷法用籌列於立方籌之下【法於長亷數下加一空籌以合進一位之數】先以平隅共法【卽平亷小隅共法或省曰共法】爲次商之法卽截取初商下一位至第二防止爲次商之實法除實得次商【視共法籌內有小於實者爲平亷亷小隅共積用其根數爲次商】次以次商之自乘數【卽大籌立積下所帶平方積數】與長亷法相乘【以平方數尋長亷籌之行取其行內積數用之】得數加入平隅共積爲次商總積以此總積減次商之實及減則已倘不及減轉攺次商及減而止【因亷積或大有不及減者】

三商者合初商次商數自乘而三之爲平亷法以其數用籌列方籌上爲平亷小隅共法

別以初商次商數三而進位以其數用籌加一空位籌列立方籌下爲長亷法

截取次商下一位至第三防爲三商之實共法爲法除之以得三商【其積爲共積】次以三商自乘數與長亷法相乘得數加入共積爲三商總積減實【又一法長亷法不必加空位籌得於得數下加一圏卽進位也】

四商以上仿此

解曰隅者小立方也故可以立方籌爲法平亷之數每大於隅二位今以立方籌爲隅列於平亷下則隅之首位與平亷之末位兩半圓合成一數故平亷小隅可合爲一法長亷之兩頭皆如次商自乘之數故可以平方乘之又長亷之數每大於隅一位故於下加一空籌以進其位便加積也

【何以知平亷大於隅二位而長亷只大一位也曰平亷者初商自乘之數也初商於次商爲十數十乘十則百數矣隅積者次商本位也故平亷與隅如百與單相去二位也若長亷只是初商之三倍位同初商初商與次商如十與單故長亷與小隅亦如十與單相去一位也】

凡初商積盡於上一防故上一防爲初商實次商積盡於第二防故第二防以上爲次商實推之三防爲三商實四防爲四商實以上並同

審空位法曰若次商之實小於平亷小隅共法之第一行或僅如共法之第一行而無長亷積則次商是空位也卽作圏於初商下以爲次商乃於平亷籌下立方籌上加兩空位籌爲三商平亷小隅之共法以求三商其長亷法下又加一空位籌【並原有一空位籌共兩空位籌】爲三商長亷法【又法長亷不必加空籌但於得數下加兩圏】若商數有兩空位者平亷小隅籌下加四空位籌長亷積下加三圏

解曰有空位則所求者三商也初商於三商如百與單而平亷者初商之自乘百乘百成萬故平亷與三商之隅如萬與單大四位也此加兩空籌之理也【平亷原大二位加二空籌則大四位矣】初商與三商旣如百與單則長亷與隅亦如百與單大兩位也此又加一空籌之理也

初商列位商一用常法二至五用進法六至九用超法今各存一例於後

假如有立方積六百八十五萬九千尺問每面若干列位作防

如圖防在首位以○○六百

萬爲初商實

視立方籌有小於○○六者

○○一也其立方一商一百尺【三防故初商百】減積一百萬尺次截取第二防上五八五九爲次商實

以初商一百尺自乘得一萬尺而三因之得三萬尺爲平廉法用第三籌列立方籌上爲平廉小隅共法

別以初商一百尺三而進位得三百○十尺爲長廉法

列立方籌下視平隅共法籌第九行是三四二九小於實商九十尺

次以第九行平方八一乘長廉三得二四三○以加共積得五百八十五萬九千爲次商九十尺之積除實盡

次商十宜有三商而除實已盡是方面無單數也凡開得立方每面一百九十○尺

假如有立方積一千二百八十六億三千四百六十七萬○五百九十二尺問方若干

列位

作防

如圖防在第三位以一

千二百八十億爲初商

實

視立方籌內有小於一二八是一二五其方五也商五千尺【四防故初商千】減積一千二百五十億

次截取第二防上○三六三四爲次商實

以初商五千自乘得二千五百萬而三之得七千五百萬爲平廉法用七五兩籌列立方籌上爲平廉小隅共法別以初商五千尺三而進位得一萬五千○百尺爲長亷法用籌列立方籌下

視共法籌第一行是○

七五○一大於實不及

減知次商百位空也於

初商下作一圏爲次商【原實上減一圏】

乃截第三防三六三四六七○爲三商實

次於平亷籌下立方籌上加兩空位籌爲平亷小隅共法

於長亷籌下又加一空位籌【原有一空位籌共二空位】爲長亷法

視共法籌第四行

是三○○○○六

四小於實用爲共

積商四十尺以長廉法與四行之平方一六相乘得二四○○○爲長廉積加入共積得三○二四○六四減積三十○億二千四百○六萬四千尺次以商數五千○四十自乘得二千五百四十○萬一千六百尺而三之得七千六百二十○萬四千八百尺爲平廉法列立方籌上爲平隅共法別以商數五千○四十尺三而進位得一萬五千一百二十○尺爲長廉法列立方籌下

乃截第四防

六一○六○

六五九二爲

四商之實

視共法籌第

八行六○九

六三八九

一二小於實

商八尺以長亷法與第八行平方六四相乘得九六七六八○爲長亷積以加共積得六一○六○六五九二除實盡

凡開得立方每面五千○四十八尺

右加兩空籌例

假如有立方積七千二百九十七億二千九百二十四萬三千○二十七尺問每面若干

列位作防

如圖防在第三位以七

千二百九十億爲初商

實視立方籌方九之

積七二九與實同商九千尺減積七千二百九十億【四防故初商千】次截第二防○○○七二九爲次商實以初商九千尺自乘八千一百萬尺而三之得二億四千三百萬尺爲平亷法列立方籌上爲平亷小隅共法別以初商九千尺三而進位得二萬七千○百尺爲長亷法列立方籌下視共法籌第一行是○二四三○一大於實不及減知次商百位空也於初商九千尺下作一圏爲次商【原實上減去一圏】乃於平亷籌下立方籌上加兩空籌爲平廉小隅共法於長亷籌下又加一空籌得二七○○爲長亷法截取第三防○○七二九二四三爲三商實視共法籌第一行是○二四三○○○一大於實仍不及減知三商十位亦空也於商得九千○百下加一圏爲三商【原實上又減去一圏又法實多空不必挨商但尋至不空之界如○七乃與平亷相應卽於○七之上初商之下作連圏爲次商三商而於原實中銷兩圏】

此次商三商合圖也

乃於平亷籌下立方籌

上又加兩空籌【共四空籌】爲

平亷小隅共法其長亷籌下又加一空籌【共三空籌】得二七○○○爲長亷法【或不必加籌只於得數下加三圏亦同】

截取第四防○七二九二四三○二七爲四商實

視共法籌第三行是○七二

九○○○○二七小於實商

三尺以長亷法與第三行

平方○九相乘得二四三○

○○爲長亷積以加共積得

○七二九二四三○二七除實盡

凡開得立方每面九千○○三尺

右加四空籌例

開方分秒法【籌算七】

勿庵氏曰命分古法也然但可以存其不盡之數而已若還原則有不合故有分秒法以禦之也𨿽亦終不能盡然最小之分卽無關於大數視命分之法不啻加宻矣

平方

法曰凡開平方有餘實不能成一數不可開矣若必欲開其分秒則於余實下加二圏【原實一化爲一百分】如法開之所得根數是一十分內之幾分也或加四圏【原實一化爲一萬分】如法開之所得根數是一百分內之幾分也或加六圏【原實一化爲一百萬分】如法開之所得根數是一千分內之幾分也如此遞加兩圏則多開得一位乃至加十圏【原實一化爲百億分】其根數則十萬分內之幾萬幾千幾百幾十幾分也

假如平方積八步開得二步除實四步餘四步不盡分秒幾何

法於余實下添兩圏則余實四步

化爲四百○○分爲次商之實

依捷法以初商二步倍作四步爲

亷法列平方籌上爲亷隅共法簡

籌第八行積三八四小於余實次商八分除實三百八十四分開得平方每面二步八分不盡一十六分再開之

又於余實下加兩圏則余實一十六分化爲一千六百○○秒爲三商之實

依捷法以初商次商共二步八分倍之得五步六分爲亷法列平方籌上爲亷隅共法簡籌第二行積一一二四小於余實商作二秒除實一千一百二十四秒共開得平方每面二步八分二秒不盡四百七十六秒

此單下開兩位式也所不盡之數不過百分之四若欲再開亦可得其忽防如後式

還原以二步八二用籌爲法又以二步八二列爲實而自相乘之得七萬九千五百二十四分加不盡之分四百七十六共八萬乃以一萬分爲一步之法除之【當退四位】仍得八步合原數

解曰此以一步化爲百分故其積萬分何也自乘者橫一步直一步也今旣以一步化爲一百分則是橫一百分直一百分而其積一萬分爲一步

假如平方九十步開得九步除實八十一步餘實○九步不盡【小分幾何】

法於余實九步下加八圏則余實九步化爲九億共作五防而以第二防○九億○○分爲次商之實依捷法以初商九步倍作一十八步爲亷法列平方

籌上爲亷隅共法簡籌第

四行○七三六略小於余

實商四千分除實七億三

千六百萬分餘一億六千

四百○○萬分爲第三商

之實【第三防也】

又依捷法以初商次商九步又十之四倍之得一十八步八爲亷法列平方籌上爲亷隅共法簡籌第八行一五一○四略小於余實商八除實一億五千一百○四萬餘一千二百九十六萬分○○爲第四次商之實【第四防也】

又依捷法以三次所商共九步四八倍之得一十八步九六爲亷法列平方籌上爲亷隅共法簡籌第六行一一三七九六略小於實商六除實一千一百三十七萬九千六百分餘一百五十八萬○四百○○分爲第五次商之實【第五防也】

又依捷法以所商九步四八六倍之得一十八步九七二爲亷法列平方籌上爲亷隅共法簡籌第八行一五一七八二四略小於實商八除實一百五十一萬七千八百二十四分餘六萬二千五百七十六分不盡凡開得平方每面九步四千八百六十八分【亦可名爲四分八秒六忽八防】不盡一○○○○○○○○之○○○○六二五七六【卽一萬分之六分有奇】

𨿽不盡不過萬分之一不足爲損益可棄不用還原以九步四八六八用籌爲法又爲實自乘得八十九億九千九百九十三萬七千四百二十四分加入不盡之分六萬二千五百七十六共九十億以一億分爲一步之法除之【當退八位】仍得九十步合原數解曰此以一步化爲一萬分故其自乘之積一億何也自乘者橫一步直一步之積也今旣以一萬分爲步則是橫一萬分直一萬分而其積一億爲一步

若依命分法則還原不合

如前例原實八步開得方二步除實四步不盡四步法當倍每方二步作四步又加隅一步爲命分命爲二步又五分步之四意若曰若得五步則商三步矣今只四步是五分內止得四分也然還原有不合何也

以算明之

用通分法以命分五通二步得一十分又加得分四共一十四分自乘得一百九十六爲實以命分五自

乘得二十五分爲法【每步通作

五分橫一步直一步則共得二十五分也】除之

得七步又二十五分之二十一以較原實少二十五之四

以圖明之

每步作五分其羃積二十五分方二

步積四步共一百分又五之四以乘

方二步得四十分倍之爲亷積八十

分又五之四自乘得隅積一十六分

共九十六分以合原余積四步該一百分少二十五分之四

以此觀之實數每縮虛數常盈故命分之法不可以還原其故何也曰隅差也何以謂之隅差曰平方之有奇零其在兩亷者實其在隅者虛何也亷之虛者一面而隅之虛者兩面也卽如二步五之四謂五分內虛一分故不能成一步也然試觀於圖兩亷之四步皆虛一分【橫四分直五分積二十分以二十五分計之是爲於五分之中虛一分】而隅之一步虛一分有零【橫四分直亦四分積一十六分虛九分以二十五分計之是爲五分之中虛二分弱】則是邊數二步五之數者其積不及五之四也今余積四步者實數也其邊數常盈於五之四有奇也而命之曰五之四宜其不及矣然則古何以設此法曰古率常寛以爲所差者防故命之也不但此也古率圓一圍三方五斜七今考之皆有防差故曰寛也

愚常考定開平方隅差之法法曰如法以命分之毋通其整而納其子【卽得分】爲全數以全數自相乘得數爲通積另置分毋以分子減之餘數以乘分子而加之爲實乃以分毋自乘爲法除之卽適還原數如上方二步五之四以分毋五通二步得十納子四共十四自乘得方積一百九十六分另以分子四減分毋五餘一以轉乘分子四得四卽隅差也以隅差加入方積共二百分爲實乃以分毋五自乘得二十五爲法以除實得八步合原積

又如後例原實九十步開得九步除實八十一步不盡九步法當倍每方九步作十八步又加隅一共十九步爲命分命爲九步又十九分步之九意若曰若得十九步則加商一步成十步今只九步是十九分內只得九分也然還原亦不合

以算明之

用通分法以命分十九通九步得一百七十一步又加得分九共一百八十步自乘得三萬二千四百爲實以命分十九自乘得三百六十一爲法【每步十九分橫十九分直十九分共得三百六十一分也】除之得八十九步又三百六十一分之二百七十一以較原實之九十步計少三百六十一分之九十分

若依隅差之分以得分九減命分十九餘十轉乘得分得九十分爲隅差以加自乘通積三萬二千四百共得三萬二千四百九十爲實乃以命分自乘三百六十一爲法除之恰得九十步合原積

以圖明之

甲戊丁庚形者方九步九分

之總形也通爲一百八十分

積三萬二千四百分以三百

六十一爲步除之較原實少

九十分

內分甲丙乙巳形爲初商方九步之形其積八千一步戊乙形庚乙形次商亷積之形也長九步【通爲一百七十一分】濶九分積一千五百三十九分兩亷共計三千○七十八分

丁乙者小隅者橫直各九分以較亷積中每一步之形【如醜乙】欠一丁癸形卽隅差也

以積考之亷九步每步濶九分長一步【通爲十九分】積一百七十一分隅濶九分長亦九分積八十一分少九十分爲隅差

立方

法曰凡立方有餘實不能成一數不可開矣若必欲知其分秒則於余實下加三圏【原實一化爲一千分】如法開之所得根數是一十分之幾分也若加六圏【原實一化爲一百萬分】所得根數是一百分之幾分也若加九圏【原實一化爲十億】則根數是一千分之幾分也若加十二圏【原實一化爲萬億】則根數是一萬分之幾分也

解曰平方籌兩位故兩位作防而其化小分亦以兩位爲率蓋積多兩位則根數可多一位也【亷一位隅一位故兩位】立方籌三位故三位作防而其化小分亦以三位爲率蓋積多三位則根數可多一位也【平亷一位長亷一位隅一位故三位】

假如立方積一十七步開得立方二步除八步餘實九

步不盡法於余實下

加十二圈則余實九

步化爲九萬億分【增

四防可加開四位】

依捷法截第二防○九○○○爲次商之實以初商二自乘【四】而三之得一十二步爲平亷法列立方籌上爲平隅共法以初商【二】三而進位得【六○】爲長亷法列立方籌下簡共法籌第五行積【○六一二五】小於實商五分【六行七行亦小於實因無長亷積故不用】

乃以第五行平方【二五】與長亷法相乘得【一五○○】爲長亷積以加共積共得【○七六二五】是爲次商五分之積以除實餘一三七五以俟三商

又截取第三防一三七五○○○爲三商之實以初商次商共二步五分自乘得【六二五】而三之得【一八七五】爲平亷法列立方籌上爲平隅共法以初商次商【二步五分】三而進位得【七五○】爲長亷法列立方籌第七行【一三一二八四三】共法【八四三】小於實商七秒乃以第七行平方【四九】與長亷法相乘得【三六七五○】爲長亷積以加共積共得【一三四九五九三】爲三商七秒之積以除實余○二五四○七以續商

又截取第四防○二五四○七○○○爲四商之實以商數【二五七】自乘得【六六○四九】而三之得【一九八一四七】爲平亷法列立方籌上爲平隅共法以商數【二五七】進位而三之得【七七一○】爲長亷法列立方籌下簡共法籌第一行【○一九八一四七○一】小於實商一忽

乃以第一行平方【一】乘長亷得【七七一○】爲長亷積以加共積得【一九八二二四一一】爲商一忽之積以除實余○五五八四五八九以末商

通第五防○五五八四五八九○○○爲末商之實以商數【二五七一】自乘得【六六一○○四一】而三

之得【一九八三○一二三】爲平亷法列立方籌上爲平隅共法以商數【二五七一】進位而三之得【七七一三○】爲長亷法列立方籌下簡共法籌第二行【○三九六六○二四六○八】小於實商二防

乃以第二行平方【○四】乘長亷法得【三○八五二○】爲長亷積以加共積得【○三九六六三三三一二八】爲末商二防之積以減實餘一六一八二五五八七二不盡

凡開得立方每面二步五分七秒一忽二防【不盡之數不能成一防棄不用】

還原以二步五七一二用籌爲法別以二步五七一二列爲實以法乘實得六六一一○六九四四

再乘之得一十六萬九千九百八十三億八千一百七十四萬四千一百二十八分

乃以不盡之積一十六億一千八百二十五萬五千八百七十二分加入再乘積共得一十七萬億以一萬億爲一步之法【以一步爲萬分橫一萬直一萬商一萬共一萬億】除之得一十七步合原數

若依命分法則還原不合

如前所設立方積一十七步開得立方每面二步除積九步餘九步法當以立方二步自乘得四步而三之得十二步爲平亷又以立方二步三之得六步爲長亷又加【一步】爲隅共【一十九步】爲命分命爲立方二步又十九分步之九意若曰余積若滿十九步則加商一步矣今只有九步是以十九分爲一步而今僅得九分也然還原則有不合

以算明之

用通分法以命分十九通立方二步得【三十八分】又加得分九共【四十七分】此卽所云二步又十九分之九乃立方一面之數也以此自乘得【二千二百○九分】再乘得【一十○萬三千八百二十三】乃立方二步又十九分之九所容積數也爲實別以命分十九自乘得【三百六十一】再乘得【六千八百五十九】乃方一步之積爲法以除實得【一十五步又六千八百五十九之九百三十八】較原實一十七步少【一步又六千八百五十九分之五千九百二十一】

其故何也曰長亷小隅之差也何以言之曰立方之有奇零其在平亷者實其在長亷小隅者虛何也平亷之虛者一面而長亷虛兩面小隅虛三面故也今以十九分爲一步其立方積【六千八百五十九分】爲步法以十九分除之得每【三百六十一】爲分法平亷每步【橫十九分直十九分髙九分積三千二百四十九】分法除之得九是爲十九分之九適合命分之數也

若長亷【橫九分直十九分髙九分積一千五百三十九分】分法除之得四分有奇而已以較平亷九分之積【三千二百四十九】少【一千七百一十分】三長亷共【六步】共少【一萬○二百六十分】步法除之得一步又三千四百○一分爲長亷差

若小隅【橫直髙各九分積七百二十九分】分法除之得二分有奇而已

以較平亷九分之積【三千二百四十九】少二千五百二十分爲隅差

合亷隅兩差計之共少一步又六千八百五十九分之五千九百二十一

以圖明之

丑寅爲立方一步之形每步通爲十九分橫直髙各十九分積六千八百五十九分是爲步法

以十九分除步法得三百六十一分是爲分法

亷隅總圖【見左】

甲乙丙三平亷也縱橫各方二步通爲三十八分厚九分積一萬二千九百九十六分三亷共三萬八千

九百八十八分丁戊巳三長亷

也各長二步通爲三十八分厚

濶各九分積三千○七十八分

三亷共九千二百三十四分

庚小隅也長濶髙皆九分積七

百二十九分

三長廉三平廉一小隅共包一正方形在內

正方形縱橫各二步通爲三十八分積五萬四千八百七十二分

總形方二步九分通爲四十七分髙如之積一十○萬三千八百二十三分以步法除之得一十五步有奇不滿原實一步又五千九百二十一分

平亷方二步其容四步卽辛壬癸

子之分形也每步縱橫皆一步通

爲十九分厚皆九分積三千二百

四十九【辛一形積如此壬癸子者同】以分除之適得九分

長亷長二步【如丑寅合形】通爲三十八

分厚九分皆與平亷同所不同者

平亷濶十九分而長亷濶只九分

故長亷二步尙不及平亷一步之積以積計之每長亷一步【如醜形】積一千五百三十九分較平亷每步之積【如醜夘合形】少一千七百一十分【如醜之虛分夘】三長亷計六步共少一萬○二百六十分是爲長亷之差

小隅橫直髙皆九分【如未形】於平亷

一步之積不及四之一以積計之

小隅之積七百二十九較平亷一

步之積【如未申合形】少二千五百二十分【如未之虛分申】是爲小隅之差合二差共一步五千九百二十一分今考定開立方亷隅差法法曰凡立方有命分者如法以分母【卽命分】通其整而納以分子【卽得分】爲立方全數以全數自乘再乘得數爲立方通積另置命分【母數】與得分【子數】各自乘得數以相減用其餘數以乘得分得數爲隅差又置命分與得分相減用其餘數轉與得分相乘以乘命分得數是爲長亷每步虛數又以長亷法乘之得數爲長亷差合二差數以加通積爲實以命分自乘再乘得數爲法除之卽適還原數如所設立方積十七步開得立方二步又十九分

之九法以分母【十九】通立方二步而以分【子九分】納之共【四十七分】爲立方全數以全數自乘再乘得【一十○萬三千八百二十三】爲通積另置命分【十九】自乘得【三百六十一】內減分子【九】自乘【八十一】余【二百八十分】以分子【九】乘之得【二千五百二十分】爲隅差又置命分【一十九】內減得分【九】餘十分轉乘得分【九】得【九十分】以乘命分【十九】得【一千七百一十分】爲長亷每步虛數又以長亷法【六步】乘之得【一萬○二百六十分】爲長亷差合二差共一萬二千七百八十分以加通積共得一十一萬六千六百○三分爲實以命分一十九自乘再乘得六千八百五十九分爲法以除實得一十七步合原積

歷算全書卷三十三

筆算自序

或問筆算西人之法耳子何規規焉曰非也自圖書啟而文字興參兩倚數畢天下之能事六書九數皆原於易非二事也古人算具以籌策縱橫布列略如筮法之掛扐其字象形爲祘是故其縱立者一而一其上橫者一而五珠盤之位實此權輿夫用蓍在立卦之後則籌策之算必不在文字先矣是故籌策之未立形聲防畫自足以用而籌策之所得又將紀之簡策以詔方來書與數之相須較然眀也近數百年間再變而爲珠盤踵事生新以趨簡易然觀九章中盈朒方程必列副位厥用仍資筆札其源流不可想見與故謂筆算爲西人獨智者非也曰今所傳同文算指西鏡錄等書亦唐九執歷元明間回回土盤之遺耳與中算固各有本末矣曰是則然矣然安知九執以前不更有始之始者乎西人之言歷也自多祿某以來二千年屢變而宻溯而上之亦不能言其始於何人其爲算也亦若是己矣夫古者聖人聲教洋溢無所不通南車記裏之規隨重譯而四逹我則失之彼則存之烏乎識其然烏乎識其不然耶且夫治理者以理爲歸治數者以數爲斷數與理協中西非殊是故禮可以求諸野官可以問諸郯必以其西也而擯之取善之道不如是隘也況求之於古抑實有相通之故乎曰然則子何以易衡而直曰旁行者西國之書也天方國字自右而左歐邏巴字自左而右皆衡列爲行彼中文字盡然也彼之文字旣衡故筆算亦橫取其便於彼用耳非求異於我也吾之文字旣直故筆算宜直亦取其便於用耳非矜勝於彼也又何惑焉問者以爲然遂書其語爲序康熙癸酉二月初吉宣城梅文鼎撰

發凡

筆算之便與籌算同然籌仍資筆而筆則無假於籌於文人之用尢便【筆算無歌括最便學習又無妨酬應久可覆核皆與籌算同詳籌算書】

筆算易橫爲直以便中土蓋直下而書者中土聖人之舊而吾人所習也與籌算易直爲橫其理正同

筆乘原法以法實相疊殊混人目今所更定者一縱一橫法實各居其所而縱橫相遇處得數生焉不惟便用而已其所以然之理亦按圖可知

筆除原法得數與原實相離定位易淆今所更定者法實與得數兩兩相對算理井然定位尢簡

【所謂原法者並據同文算指乃西土之舊式利西泰所授而李水部之藻所刻也厥後有西鏡錄等書稍稍講明定位之用蓋亦酌取中法而爲之然於古人實如法而一之防似猶有隔玆以法上得零之訣定之庶令學者一望而知所兾髙賢有以教之幸甚】

欽定四庫全書

歷算全書卷三十四

宣城梅文鼎撰

筆算卷一

列位法

數始於一究於九畢於十十則又復爲一矣等而上之爲百爲千爲萬乃至兆億皆得名之爲一卽皆得名之爲二三四五六七八九故必先稽其位而列之並減乘除以此爲基非是則算無可施矣法具如後【以一位言之有自一至九之名此如同軰之有長防合上下之位言之有單十百千萬之等此如己身而上有髙曽祖父己身而下又有子孫云仍故單以下復有畸零之位也】

列位式

萬千

百十

零

【此姑以五位爲式位有多寡皆以零數爲根零亦曰單】

假如有數二萬四千七百五十九依法列之

二四

七五

九

【凡列數以最下小數爲單單上有一位共二位卽是十數有三位是百有四位是千有五位是萬不必更書十百千萬等字但稽其有若干位卽得之矣】

又如有數四千○九十六依法列之

四○

九六

【凡數大小相乘中有空者必作○以存其位如此式有千有十有單而無百故於百作○以存其位】

又如有數一萬○八百

一○

八○

○

【凡數以單位爲根今此數無千無十而並無單故必補作三○以成五位則知首位是一萬矣】

又如有數一十二萬九千六百

一二

九六

○○

【原數四位無空然無十無單故必補作兩空以成六位則知首位爲十萬】

畸零列位式

凡整數自單而陞若畸零數則自單而析故單位者數之根也然整數之陞以十爲等自單而十而百而千而萬皆一法也【萬以上有以十萬爲億十億爲兆十兆爲京自此而垓而秭壤溝澗正載皆以十而變謂之小數有以萬萬爲億億億爲兆兆兆爲京以上盡然皆以自乘而變謂之大數今所用者以萬萬爲億萬億爲兆萬兆爲京以上盡然皆以萬而變謂之中數三者不同然其列位皆以十爲等故曰一法也】若畸零之式其故多端約而言之亦只二法其一以十爲等其一不以十爲等而各以其所立之率爲等是二法者又各分二類列之各有其法【詳後】

其一以十爲等分二類

假如錢糧料則毎田一畝該五分九釐八毫六七忽九微三纎四沙八塵九埃二渺一漠

依法列之

○○五九八六七九三四八九二一

兩錢分釐毫絲忽微纎沙塵埃渺漠

【右式今所通用自兩而下以十之一爲錢又以錢十之一爲分分十之一爲釐如是遞析爲毫爲忽以至渺漠皆以十爲等】【原科則自分起以至渺漠計十二位今加兩○爲十四位者乃列位之法也何也分之上有錢錢之上有兩兩爲單數凡列畸零之數必以單數爲根始便合總故兩數𨿽空必存其位也】

凡度法以丈爲單數則其十之一爲尺又十析之爲寸爲分爲釐毫絲忽之屬【亦有以尺爲單以寸爲單者皆如所設】

凡量法以石爲單數則其十之一爲斗又十析之爲升爲合爲勺之屬【亦有以斗爲單數者皆如所設命之】法並同上

右法以十爲等卽以一位爲一名如上位是兩下一位卽是錢此爲一類

假如授時歷法毎一平朔二十九日五十三刻零五分九十三秒依法列之

【右式日爲單數而以日百析之爲刻又百析之爲分又百析之爲秒故列位時必作防以志之使知日下二位始爲單刻由是而分而秒皆隔兩位而變其名然仍是以十爲等凡作防必單位如日爲單位下又有單刻單分單秒之屬】

凡開平方尺有百寸寸有百分其法同上

凡開立方尺有千寸寸有千分則三位而變卽隔三位作防以志之法亦同上

右法𨿽亦皆以十爲等而不以一位爲一名或隔兩位或隔三位前法只尋單位卽知其餘此法單位之下仍須各尋單位蓋前法之分秒只有單而此法分秒各有十有百故必以作防之處知其爲單分單秒是與前法微別又爲一類也其一不以十爲等而各以其所設之率爲等亦分二類

假如回回歷法以六十分爲一度六十秒爲一分太陽三十日平行二十九度三十四分一十秒作何排列

【右以度爲單數下兩位爲分又下兩位爲秒故作防志之略同授時然皆以六十而進非以百也其自秒以下爲微纎等數凡在授時以百爲數者回回之法皆以六十爲之是𨿽不以十爲等而所設六十之率鉅細同法西洋法亦然】

又如古量有以四升爲豆四豆爲區四區爲釜皆以四爲率又如楊子云太以三方統九州二十七部八十一家其遞析也皆以三

又如測量家以矩度分十二度每一度又分十二分是又以十二爲率也右諸率皆不用十而所用之率屢析不易是爲一類

假如物重十六兩爲一斤二十四銖爲一兩今有物二斤四兩半作何排列

【此以斤爲單數斤下二位爲兩又下二位爲銖銖與兩皆斤之分秒也故作防志之亦同前法但銖以二十四爲率兩以十六爲率二率不同】

又如歷家以甲子六十爲旬周每日十二時又分初正【西曆謂之二十四小時】每各四刻每刻有十五分今依新法算得辛未年冬至爲旬周之第五十日二十二時二刻七分依法列之

【此以日爲單數下二位析日爲時又下一位析時爲刻又下兩位析刻爲分皆日下之畸零也然時之率二十時刻之率四分之率十五各率不同所當細玩】

右法旣不以十爲等而所用之率又不齊同是又一類也【此二類不以十分爲率而各有其率卽通分子母之法也但通分以子母並列又是一法別捲詳之】並法

凡數合總法當用並有諸數於此並而合之爲一總數又名垜積卽珠盤之上法也【數相並則相益而多故亦名加法在錢谷之用則所以稽總撒】

法曰置所有防數幾宗各依列位法自上而下對位列之萬千百十單各以類從

列訖仍並之自上而下如畫卦之法

數滿十者進位作號而本位紀其零

紀號式

丨����丅���【此古算位也用以別原數便稽核也】

假如有絲八百九十二斤又一千○八十八斤又【三百五十斤合之若干】

如上式防數三宗依法列位並之

得總數二千三百三十斤

假如有絹四丈五尺六寸又五丈○三寸又八丈五尺合之若干

九減試法

【凡九減之法不論單十百千之位亦不計○位只摢現有之數而合計之先減減數首行八九二合得十九減去二九餘一以合次行一八八共得十八減去二九恰盡只餘三行三五合成八數紀於右次減總數二三三合得八紀於左左右相同知其不誤】

【第二圖先減防數首行四五成九減去餘六合次行三成九減去餘五合三行八五共十八成二九減盡紀○於右次以總數一八九成二九減盡紀○於左左右相同知其無誤或問九減不計上下之位何也曰此防法也凡九減者數不變假如以九減一十則仍餘一減二十則仍餘二推之百千萬亦然故不論位】七減試法

【凡七減與九減不同須論位減實數第一圖先減防數自上而下頭一排只有一作一十算合第二排八三得十一共二十一以七減之盡第三排九八五合得二十二以七減之餘一作一十合第四排八二得十共得二十以七減之餘六紀於右次減總數亦自上起首位無七有二合第二位作二十三以七減之餘二又合第三位作二十三以七減之餘二合末位○作二十減二七餘六紀於左左右相同不誤】

【第二圖先減防數頭一排四五八合十七以七減之餘三作三十合第一排兩个五成十共四十以七減之餘五作五十合下六三成九共五十九以七減之餘三紀右次減總數首兩位十八以七減之餘四合第三位○作四十以七減之餘五作五十合下位九共五十九以七減之餘三紀左左右相同不誤】

畸零並法

假如有物十斤四兩十二銖又九斤十一兩十二銖共若干

答曰二十斤

【銖數並得卄四成一兩進位並原數共十六兩成斤進位並原數十九斤

共卄斤銖率卄四兩率十六不同故以防隔

之凡率不同難用九減七減只以減法

還原其法於總數內減原防數一宗其餘一宗必合減余是爲無誤減法

見後詳通分】

假如品官計俸原歷任過三年○九个月今又歷任一年十一个月共若干

答曰共歷任五年○八个月

【先並月得二十再以十二个月成一年進位紀號餘八个月次並一年三年加所進一年共五年並得五年○八个月此因月法十二非以滿十而進故以防隔之此亦非滿十而進不用九減七減只以減法還原】

遞加法

假如授時歷歳實【三百六十五日二十四刻二十五分】兩次加气策【一十五日二十一刻八十四分三十七秒五十微】共若干

答曰【三百九十五日六十七刻九十三分七十五秒】

此遞並法借前總數當防數用之如此則可以層累而加

【前條三百八十○日四十六刻奇是從嵗前冬至算至本年小寒此條三百九十五日六十八刻弱是又算至本年大寒】

截小總法【凡並法頭項太多者截分小總則易淸乃垜積之防法】

假如河工一十二宗一工【五千○十四工】又【三千三百工】又【八百九十一工】又【二千○九十工】又【九百○九工】又【一千○八十工】又【二千○二十工】又【九十一工】又【六百六十七工】又【四千七百工】又【七百三十工】又【八十二工】問共數

答曰二萬一千五百七十四工

法曰【先以河工十二宗任分爲三段依法並之各成小總再合各小總依法並之爲一大總合問】

【或有極多至百十宗者宜多分小總小總又並爲小總末乃並爲一大總變繁爲簡最便覆核】減法

凡數相較法當用減有兩數於此以相減則得其大小之較也有全數於此減其所去則得其畱余之數也【在錢糓之用則減爲開除減余爲實在若收受則所減爲已完減余爲未完其法與並法正相對其用亦相需也】

法曰置原數於右置減數於左依列位法自上而下對位列之【若兩數相較則以大數列右以當原數小數列左爲減數】乃以兩數相較以少減多【原數必多減數必少若原數反少則有轉減】減訖列減余之數於左行

凡減自下小數起本位無可減借上位一數化十而減之則於上位作防以爲志【還原時卽用此防爲進位之志或不用防用短直亦同】

假如有庫銀十萬兩支放過五萬九千五百○三兩問存庫若干答曰四萬○四百九十七兩

【此因數萬以下俱空故皆用借十作防之法自最下兩位起兩位空作防於上位借十兩減三存七支數原無十兩因借減之防宜減十兩而十兩亦空復作防於上位借一百內減一十存九十支數五百加借防共六百亦作防借一千減六百存四百支數九千湊借防成一萬作防於萬位湊原支五萬共六萬又作防於首位借十萬減六萬存四萬】

還原用並法【卽借用本圖】從兩位起以支放三兩並存畱七兩得十兩作防於十兩位湊存畱九十兩成一百兩又作防於百位湊支放五百存畱四百並得一千作防於千位湊支放九千成一萬作防於萬位湊支放五萬存畱四萬共成十萬作防於首位至此存畱支放俱無可輳淨十萬兩作一十萬字於原銀位合總無差

遞減法

假如有應進貢【貂皮一千五百張收過九百○五張次年補收四百九十五張仍欠若干】答曰【一百張】

【以頭一次九百○五張依法減原額一千五百張得減餘五百

九十五張爲欠數次以補收四百九十五張減欠

數五百九十五張得減餘一百張爲仍欠數】

因兩次遞減亦減兩次試之

【九六

七二

先以原額減餘數列右減�

減�

合收欠減餘數列左】

【試一

試○

次以欠數取減余列右法�

法�

合續收仍欠減余列左】

還原【倒用前圖】以仍欠一百並續收四百九十五得五百九十五合前欠數又以欠五百九十五並先收九百○五得一千五百合原額凡遞減者亦以遞並還原

透支轉減法

假如有錢一萬五千○三十文陸續支用過一萬六千○五十文該有透支若干答曰淨多支一千○二十文

此因支數多於原數故以原數轉減支數而得透支之數【凡兩數相較多寡皆仿此】

還原以多支一千○二十並原錢一萬五千○三十

得一萬六千○五十合支用數

畸零減法

假如有地丁銀三千五百零三兩徴完三千二百一十兩零三錢五分仍未完若干答曰二百九十二兩六錢五分

還原以已完未完相並得數合額編之數【此原數至兩而止因減而有錢與分之數蓋以兩爲單數其錢爲兩十之一分又爲錢十之一皆畸零也】

假如授時歷毎月二節气共三十○日四十三刻六十八分七十五秒經朔二十九日五十三刻○五分九十三秒兩數不同是生月閏該若干

答曰月閏九十○刻六十二分八十二秒

太陽節气

此經朔減節气也

太陰經朔

經朔小節气大相減

月閏

之較是爲月閏還原以月閏並經朔得總卽仍合節气之數

假如品官計俸以三年爲滿今歷任過一年零七个月該補若干答曰該補一年零五个月

【此以十二个月爲一年故減法不同

先減七个月月位無可減作防於年位借一年爲十二月減七存五

次減一年並所借一防共二年以減三年餘一年】

還原以己歷一年○七个月補俸一年○五个月相並得三年合總

假如有海濵田一百三十一頃四十畝被潮坍損二頃八十五畝一百五十九步仍余若干

答曰仍存田一百二十八頃五十四畝八十一步解曰【此以百畝成頃二百四十步爲畝故列位時須作防別之而減法亦同

先減一百五十九步原數無步作防於畝位借一畝

爲二百四十步紀號於原位乃如法減之】

仍存一二�五�○八�

還原以坍損田及仍存田相並得原田數合總右二式畸零之率不同難用九減七減只以並法還原【余詳通分】

錢糧四柱法

四柱者舊管新收開除實在也各衙門造冊必歸四柱則收放可稽在筆算爲減並合用蓋舊管新收用並法開除用減法其實在則減余也亦有減盡無餘者則無實在卽於實在項下直注曰無其事件創立前無所承者則無舊管亦有存畱不動之項則有舊管而無新收其法並同【如無舊管則注曰舊管無或無新收則亦曰新收無】若所出浮於所入則爲透支當用轉減之法也【開除本用以減今反將並舊管新收以減開除故曰轉減】凡轉減者亦當於實在項下注明【如雲實在無外多支若干是也】式如後

假如藩庫原存地丁銀一十二萬○三百○三兩今於康熙三十年徵收一百四十一萬○五十五兩六錢節次支放過一百二十二萬二千○五兩六錢問該存畱若干答曰三十萬○八千三百五十三兩

【先用並法得舊管新收共一百五十三萬○三百五十八

兩六錢再用減法於共數內減去開除一百卄二萬二千

○五兩六錢得實在存畱三十萬○八千三百五十三兩

以舊管新收共數與開四除實在並數各依試法】

【四左右列減余相同知其不誤九減七減並余

四可省一圖】

假如倉內原存米四千四百石新收某處解到米五百○三石麥三千六百石奉文支放兵米五千石問實在若干答曰【米支放訖仍缺額九十七石麥實在三千六百石存倉】

麥

【法以舊管新收共米】舊管無

【四千九百○三石轉】新收三六○○

【減開除五千石得缺】開除無

【項九十七石】實在三六○○

【試法合舊管新收加入缺項而九減七減之紀余於右又單

用開除一項九減七減紀余於左以左右相同知其無誤

凡轉減者仿此試之】

假如某鎭軍餉原存二千一百○三兩支放過正月分口糧折銀一千八百○九兩續於二月有某處解到協濟銀三千五百兩於四月內發過艸料銀八百九十二兩又制造盔甲銀用過九百九十九兩五錢續準某軍門公文發到餉銀一千○九十兩問今庫內現存若干答曰仍存二千九百九十二兩五錢

以上先用並法變六宗爲兩宗然後相減

若依四柱法則當以協濟三千五百兩院發一千○九十兩另並爲新收四千五百九十兩

【九六

七三】

【試�

試�右試法並以舊管新收並爲

一宗而九減之紀余於右以開除實在並爲一宗而九減

之紀余於左七減亦然所不同者除實

在減至錢數則舊管新收亦必減至○錢位止然後左右

相較可以無誤此七減之要訣所當熟翫】

淮倉銷算【邸抄附錄爲式】

戶部題爲差委司屬官員事查得淮倉監督將任內自康熙廿九年九月初六日起至三十年八月初七日止收放錢糧數目造冊具題前來查冊開舊管銀三萬八千一百一兩五錢三分零米麥四萬五千一百六十九石九斗三升零新收銀一萬二千一百四十八兩九錢九分零米麥一萬七千三百六十九石二斗六升零又收過商稅等銀三萬一千六十四兩八錢六分零內相符準銷銀一萬八千三百一十五兩一錢五分零米麥一千一百一十九石八斗四升零行查催解銀三萬五百五十四兩八錢零米麥一萬三千二百五十石八斗二升零存剩銀三萬二千四百四十五兩四錢三分零米麥四萬八千一百六十八石五斗三升零將解支欵項開後一解部銀一萬七千六百二兩三錢五分零米一百三石毎石九錢折銀九十二兩七錢麥一千一十六石八斗四升零每石五錢折銀五百八兩四錢二分零等語查前項銀兩已經解到收訖無庸議一給門軍口糧銀七百一十二兩八錢等語查系應給之項無庸議一解河工銀五千八百一十三兩二錢六分零查未開解交年月日期應令開明報部之日查核一給淮安等衛廿九年分行糧銀五千三百兩三錢二分零米麥一萬三千二百五十石八斗二升零月糧銀一萬四千七百三十二兩九錢查總漕未奏銷應俟奏銷到日查核一解淮安府銀四千七百八兩三錢二分零查卄八九兩年解府銀兩尙未動支今何得又行起解應令作速解部一存剩銀三萬二千四百四十五兩四錢三分零米麥四萬八千一百六十八石五斗三升零應將此解部米麥存倉備用又收過房田稅契銀四百二兩六分六釐零查前項銀兩已經解到收訖無庸議者奉

防依議

今以四柱法核之如後

【桉此卽原題四柱冊也舊管者卽四柱之舊管也新收及商稅皆新收也準銷卽除存剩卽實在其行查催解銀則四柱中原作開作而部不準銷攺入實在之數也】法【以準銷查催共數與舊管新收共數相減卽得存剩】

細賬

【仍原數不動】

以上並依法合總無訛

外有房田稅契銀另項附銷不在四柱之內

歷算全書卷三十四

欽定四庫全書

歷算全書卷三十五

宣城梅文鼎撰

筆算卷二

乘法

以數生數是之謂乘數不能自生相得乃生故乘亦曰因【生則不窮故乘有陻義生則日積故乘有載義】有一位乘有多位乘【或分一位曰因多位曰乘然古皆謂之乘今從古】皆有法有實有得數

【凡實數縱列於右凡法數橫列於下縱橫相遇而得

數生焉直行所對者法數也斜行

所對者實數也而紀得數則以橫行定之

或問實何以對斜行曰法有進行故得數斜陞是故

右第一行是法單位乘出之數也其次行則法十位

乘出之數也又次而百而千視此矣故其乘得數不

出斜格此虛位也單十百千周流疊居皆於臨時

定之】

凡乘出數皆有本位有進位如有十數又有零數【三四一十二四四一十六之類】則紀零於本位【本格之右方】紀十於進位【上一格之左方】有十數無零數則紀十於進位而本位作○【五四成二十五六成三十之類】有零數無十數則紀零於本位而進位作○【一一如一二二如四之類】凡法實有空位則本位進位俱紀○

凡乘皆從法尾位起【卽右第一行】對定實數相乘自下而上如畫卦之法右行乘畢挨乘左行毎移一行必進上一位其各行中斜對實數自下而上皆如右行法

凡法與實有空位則無可乘然必於本位進位各作○以存其位【若實尾有空位則於合摠時補之】

凡各行乘訖必覆核之乃以並法合總而紀於左方以爲得數實尾有幾○皆作於總數之下

凡乘訖定位皆於原實內尋原問毎數爲根以橫行對定得數命爲法尾數則上下之位皆定

凡數單乘單成單【甲爲本位戊爲進位】十乘十成百【乙爲本位已爲進位】百乘百成萬【丙爲本位庚爲進位】千乘千成百萬【丁爲本位辛爲進位】前圖可明

定位又法【法曰有本數有大數有小數如原問是毎畝之價而原實恰止於畝數是本數也凡本數卽用得數尾位命爲法尾數若原問是毎畝之價而原實只有十畝或只有百畝是大數也凡大數當於得數尾位下增○然後於所增○位命爲法尾數若大幾位亦增幾○皆增至毎位止卽命末○爲法尾數也若原問是每畝之價而原實不止於畝畝下有分釐是小數也凡小數當於得數之尾截去之原畸零幾位亦截去幾位然後命之卽所截之上一位爲法尾數是也】

凡乘畢恐其有誤宜用除法還原【置得數爲實以法數爲法除之卽得原實或置得數爲實以實數爲法除之亦得法數】不則以九減七減試之尢防

【先以法數如法九減之而紀其餘於右如甲次以實數亦九減之而紀

其餘於左如乙再以左右兩減余相乘得數仍九減之而紀其餘於上方

如丙末以得數亦九減之而紀其餘於下方如丁丁丙相同卽知無

誤七減亦然】

【先以法數實數各如法九減之而並紀其餘如甲與乙次以兩減余相

乘得數仍九減之而紀其餘如丙以上並居左方末以得數亦九減之

而紀其餘於右方如丁視丙丁相同卽知無誤如甲乙二者內有一

○卽丙亦○又或甲爲一數卽丙數同乙皆不用乘七減亦然】

一位乘式

假如有熟田三千五百一十九畝每畝編銀六分問該若干答曰二百一十一兩一錢四分

【法從下起先以法數六乘實數九呼六九五十四紀四於

於本位紀五於進位進乘實數一呼一六得六紀六於本

位紀○於進位進乘實數五呼五六成三十紀○於本位

紀三於進位進乘實數三呼三六一十八紀八於木位紀

一於進位乘畢以倂法合總】

定位法因原問是毎畝科則就於右行原實內尋每畝數爲定位之根橫對左行得數命法尾分則其餘皆定【根是九畝橫對是四分則上位是錢又上是兩又上十兩又上是百兩定所得爲二百一十一兩一錢四分】

兩位以上乘式

假如有金九錢八分五釐每兩價銀八兩八錢問該若干答曰八兩六錢六分八釐

【先以法八錢乘實數五呼五八成四十紀○於本位紀四於進位進

乘實數八呼八八六十四紀四於本位紀六於進位進乘實數九呼

八九七十二紀二於本位紀七於進位

次進一位以法八兩乘實五呼五八成四十紀○於本位進乘實八

呼八八六十四紀四本位紀六進位進乘實九呼八九七十二紀二

本位紀七進位乘畢以並法合總】

定位法【原問毎兩之價而實無兩當於實九錢上補作○兩位爲根以橫對得數定爲法尾錢卽上下之位俱定】

定位又法【此小數也原問以毎兩價爲法而實有錢分釐共小三位卽於得數截去尾三位定第四位爲六錢】

【法實減余平列左上相乘而減之列左下

得數減余列右下以相同爲定】

假如有錢三十萬零五百八十文每千賣銀九錢零五釐該若干

答曰二百七十二兩零二分四釐九毫

【先以法數五乘實數八紀四○次乘實數五紀二五

次乘實數○○本位進位俱紀○次乘實數三紀一五

進一位以法數○乘實○無可乘於本位進位各紀

○以存其位又進一位以法數九乘實

數八紀七二進乘實數五紀四五進乘兩○紀○進

乘實數三紀二七乘畢以並法合總】

定位【原問是毎千之價當於原實內尋乾位爲根以對得數命爲法尾釐則其餘皆定】定位又法【此亦小數也實有十丈於原問毎幹爲小兩位當於得數截去末兩位定爲法尾釐】

【此卽前問也因法有空位省不乘但於法首九

錢起進二位乘之卽得數無訛與前法同

本宜進一位乘九錢今進兩位以合空位之數

若法有兩空卽進三位以上仿論】

假如星命家以年月日時配成八字【以七百二十乘七百二十】問共該若干

答曰五十一萬八千四百

【如法乘訖並之得五一八四】

定一【原問七百二十年月下毎一數中各配七百二十日

時宜於原實下補作○單位爲根以對得數定法尾十】或用又法【實數止於十大於毎數一位乃大數也宜

徑於得數增一○位定法尾一】

解曰【六十年各十二月則前四字七百二十六十日各十二時下四字亦七百二十故以相乘卽能盡八字之變】

假如西曆天度毎周三百六十今有星行天三百周該若干答曰一十萬零八千度

【依法乘訖用並法合總得一○八】

定位【原問是毎周之度今實數是三百周當於原實下補作兩○至毎周位止

以此爲根橫對得數定法尾十度而得數空補作一○上一位爲百度位得數亦空

又補作○是得數無百無十也再上爲千爲萬爲十萬定所得爲一十萬○八千】或用又法【星行三百周大於毎周兩位乃大數也法徑於得數下增兩○

定末○爲法尾十度卽得數皆定】

【此先置三百六十爲實而以三百周爲法乘之也得

數一○八與前法同但變兩位乘爲一位乘其用更

簡】

定位【用大數法以實止十度無毎位徑於得數

下補作一○定爲法尾百卽得數定爲十萬○八千】

假如有珠子三分五釐毎兩值銀二十四兩該

若干

答曰八錢四分

依法乘而並之得八四○

定位【原問珠毎兩價今實數只有分乃進位作

○於錢位又上作○於兩位兩爲根橫對得數爲法尾數

兩而兩位空補作定所得爲八錢四分】

定位又法【此小數法也實有分釐在原問毎兩下三位宜截去得數末三位定法尾數兩而得數隻三位無可截乃補作○於得數之上然後截之定爲○兩】

此與前條金價並畸零乘法也【余詳通分】

省乘法【古謂之加法】

假如有漕糧三百六十石毎石耗米四斗問正耗共若干答曰共五百○四石

此就身加法也【原數卽當得數不動只挨身加四

先於六十石加四六二十四石又於三百石加三四一百二十石末

用並法連原數並之合總凡加法定位依原數不湏更求下同】

【加法九試七試略同並法並合原數加數減余列右共數減余列左此及下

條並九減七減俱無餘】

假如銀五十四兩毎兩月息二分五釐今兩个月共本息若干

答曰共五十六兩七錢

【此因所加是分在兩下二位故隔位加又因毎月二分半今兩个

月該五分故以五分爲法先於四兩加二○進於五十加二五末以

並法連原數合總】

省乘又法【古謂之求一乘法】

凡法數之首爲一數者卽原數不動而挨身加之與前兩條同也若法首非一數者以法變爲一數則亦可挨加此爲本非一數求而得之故名求一乘法也其法遇法首爲二爲三則折半用之而倍其實法首遇五六七八九則加倍用之而半其實法首遇四則取四之一用之而四其實【如此則法首成一數可用省乘】

【凡求一乘法定位亦於原實內尋毎數爲根以橫行對得數定之但此所對得數恆爲法首位數若乘法則爲法尾位數與此不同乃理勢之自然不可不知】

假如前條珠三分五釐價毎兩值銀二十四兩用乘法得價銀八錢四分今以法數折半作一十二兩實數加倍作七分挨身加之所得正同而用加防矣

【原數不動卽用爲法首一數所乘也挨身以法次位二與原數相乘呼二七加

一十四本位紀一下位紀四加訖以並法合總亦連原數作數並之】定位【亦從原數七分上加兩○尋毎兩位爲定位之根橫對左行總數得法首

位是十兩下一位是兩俱空位補作兩○再下一位卽錢定所得爲八錢四分】

又如前條錢三十萬○○五百八十文毎千價九錢○五釐以錢折半【十五萬○二百九十】爲實價加倍【作一兩八錢一分】爲法

【原數借爲得數不動以法去首位一隻用八一挨身加

之自下起於九加七二九於二加一六二其○位無加於

五加四○五於實首一加八一加訖合原數並總】定位【尋原數千位爲根橫對左行得數得法首兩位】

並乘法【凡有數次乘者並爲一次乘亦算家簡法舊謂之異乘同乘】

假如原本銀三千二百兩毎兩一年獲息一錢五分六釐二毫五絲已經四年該息若干答曰二千兩

【法先以三千二百兩乘四年得一萬二千八百兩再

以息銀乘之是並兩次乘爲一次乘也】

截乘法【凡乘法位多者截作數次乘之以便初學其法與並乘相反而其理相通】

假如有三十二人各給布六丈四尺共若干

答曰二百○四丈八尺

【先置六丈四尺以十六人爲法用省乘就身加六得一百○二丈四尺又

二乘加倍合總解曰十六乘又二乘卽三十二乘也】定位【凡就身加者原數卽可定位如前條漕糧毎石加四斗是也此

條是十六加首行六四𨿽以原數當得數而六丈四尺已陞爲六十四丈

矣若加倍自是本位此在用算者臨時消息之也】

或置三十二人以八丈乘兩次亦同

解曰八乘二次卽六十四乘也

或置六丈四尺以四乘之得數又以八乘之所得亦同

解曰四乘一次又八乘一次卽三十二乘也

除法

以數剖數是之謂除除其原數以歸各數故除亦曰歸【除與乘對理精用博近或謂之分義則淺矣】

有一位除有多位除【或分一位曰歸多位曰除或曰歸除曰混歸然古皆曰除】皆有法有實有得數【得數一名商數】

實其物也法其則也法實在乘法或可互用而除法必須審定乘法以法與實相遇而生一數如陰陽相交而生物也故𨿽互用而其交之理不易其生之用亦不易也除法以實滿法而成一數如鎔金以就型也故曰實如法而一若倒用之則非矣【實如法而一或變文曰如某數而一如用三除者省文曰以三而一言以三數成一數也而字皆連上爲文或者不察遂竟以而一當除之字義失其防矣】定法實訣

凡審法實有二訣一曰先有定則卽以定則爲法其所除者必同名之物也【如有定則之銀爲法而除總銀以定則之米爲法而除總米是也】一曰先無定則而求定則須詳問意以所用求之者爲法其所除者必異名之物也【如以總米除總銀以總銀除總米是也】何以爲先有定則也以事明之如銀糴米而先知每米一石之銀若干是先有定則之銀也卽以此定則之銀爲法而以總銀爲實以法除實則得總銀所糴之總米矣【此爲有總銀數又有米毎石之銀數故以銀除銀而得總米】

若先知毎銀一兩之米若干是先有定則之米也卽以此定則之米爲法而以總米爲實以法除實則得總米所糶之總銀矣【此爲有總米數又有銀毎兩之米數故以米除米而得總銀】

是皆所除者同名而所得者異名也又謂之以毎數求總數【凡以毎數求總數者以每數爲法毎數卽定則也以比例求之更明圖具左方】

何以爲先無定則而求定則也如有總米又有總銀而無毎數則當於問意詳之問者若欲知每米一石之銀是以米分銀也則以總米爲法總銀爲實問者若欲知每銀一兩之米是以銀分米也則以總銀爲法總米爲實是所除者異名而所得者亦異名也又謂之以總數求每數【凡以總數求毎數先無定則故必於問者之所求酌之亦有比例之理】

又防法

凡不動者爲法動者爲實何以明之如有總米總銀而欲知毎米一石之銀則將變總銀爲每米之銀是銀動而米不動也故以米爲法若欲知每銀一兩之米則將變總米爲毎銀之米是米動而銀不動也故以銀爲法其以毎數求總數者先有定則不動卽用爲法尢爲易見

凡布算乘易而除難除法之難尢在法實法實無誤則思過半矣此乃珠算筆算所同也故首辧之如右若筆算除法更有宜知者數端具如後方

一列位【法實旣辧卽當列位】

其法先作兩直綫自上而下平行相望約其間可容字兩行爲率其長短則視位數多寡定之先以實數列於右直綫之右自上而下依列位法書之次以法數列於右直綫之左亦自上而下其千百十單皆與實相對或法數有千而實只有百者卽對書於上一位餘皆仿此亦有實數無分秒而法數有之者亦對書於實尾之下次約實以求得數【得數亦名商數】

以法約實紀其得數於左綫之右視法首位是言如之數【如三三如九之】則書於實之上一位而於實首添作○以遙對之或法首位是言十之數【如二六一十二之類】則書於實首之對位其次商三商以上皆依此書之若書之而不相接輳是商數有空位也補作○此定位之根愼不可錯次乘商數求應減之數以減原實

以商得數與法數相呼乘之而紀數於左綫之左皆以乘數之進位對商數紀之【如二六一十二則以一十對商數書之如三三如九是爲○九則以九上之○對商數書之他皆仿此】乃遂以乘出數與右行原實對減【周減法】足減者於原實抹攺之不足減者攺商數其乘出數亦抹去便續商也

次定得數之位

先於法數之上一位作�爲識以對得數命爲單位等而上之則十百千萬等而下之則分秒忽微皆從此定

次命分

除有不盡者以法命之用法數爲母不盡之數爲子命爲幾分之幾

次還原

凡除法恐其有誤當以乘法還原用法數與得數相乘除有不盡者並入之卽得原實

又法仍以除法還原用得數爲法轉除原實卽復得法數除有不盡者以減原實爲實然後除之

又法以九減七減試之以法數九減七減皆用其所減之餘紀右再以得數如法減之紀其餘於左左右兩餘數相乘仍如法減之紀其餘於上方末以原實亦如法減之紀其餘於下方上下相同則無誤矣

又簡法作直綫於左方以應減之數依並法並之必合原實有不盡數亦並入之【此法更簡更確】

按筆除原法以法實上下相疊不論數之何等【謂十單分秒之等】而但齊其尾殊欠條理又以得數橫續於法實之尾定位易淆今法與實皆用眞數相對而宜減之數先列左方對減無誤卽古人實如法而一之故了了分明據法首定位尢爲簡快

一位除式

假如有額編地丁銀二百一十一兩一錢四分其科則毎畝六分問原地若干

答曰三千五百一十九畝

審法實訣【此爲以毎數求總數也其毎數六分爲先有之定則不動故以爲法】

【右並法還原卽用原列應減之數並之必合原實是爲簡法】列位法【如法作兩直綫先以實數二一一一四列於右直綫之右自上而下順布之次以法數六列於右直綫之左因法系六分故與實分位相對】

商除法【次以法數約實法是六實是二以六除二當合下位作廿一除之商作三以乘法六呼三六一十八是言十之數將商得三以法首二書於左直綫之右以乘得一八書於左直綫之左因是言十之數以乘得進位一字對商數三字書之遂以此乘得一八用減法與原實二一對減先於實次位減八實系一不足減作防借上一數爲十一減八餘三攺書三於實一之右次於實首位減一實系二因借去一防只作一減盡作○乃作綫抹去二一存○三亦於左作綫抹去減數一八】

【次商以六除三亦當合下位作三一除之商作五以乘法六呼五六成三十是言十之數將次商五對實三字書於初商之下亦以乘得三○依法以三字爲進位對次商五字書於左直綫之左依法對減實三】

【作○仍作綫抹去實三亦於左減數抹去三○三商以六除一合下位作十一商作一呼一六如六是言如之數將三商一對實上位一字書於次商五之下依法以乘得○六對所商一字書於左綫之左以對減實一一以六減一不足減作防借上成十一減六餘五攺書五於右抹去一一亦於左減數抹去○六末商以六除五亦合下位作五十四商作九呼六九五十四是言十之數將商得九對實五字書於三商一之下依法以乘得五四對所商九字書左綫之左以對減實五四恰盡俱攺書○而抹去五四左減數亦抹去共商得三五一九】

定位訣【於右綫法數六字上一位作�爲單位之識以橫對左得數九字定爲單九畝進位是十畝又進百畝又進千畝命所得爲三千五百一十九畝】

乘法還原【以法六分乘得數三千五百一十九畝仍得原實見乘法】除法還原【以得數爲法除原實仍得法數六分見後條】試法

【九減得數無餘紀○於左法數餘六紀於右左右相乘仍紀○於上

九減原實無餘紀○於下凡○位與他數相乘所得皆○】

【七減得數餘五紀左法數餘六紀右左右相乘仍以七減餘二紀於

上七減原實餘二紀於下兩試皆上下相同知其不悞】

【論曰除法以乘法還原猶之乘法以除法還原此舊法珠算所必需若除法以除法還原則舊所無也同文算指用九減七減試法可免還原頗稱巧防今以並法代之則試法亦省故稱簡法焉玆各具一則用相參互以明算理握算者擇而用之可也今定筆除只用簡法還原若筆乘仍用試法】

多位除式

假如有熟地三千五百一十九畝共徵銀二百一十一兩一錢四分問每畝科則若干答曰毎畝六分審法實【此以總數求毎數也問者欲知毎畝科則是將以總銀變爲毎銀銀數動地畝不動故以地爲法銀爲實】

列位法【先以實數自上而下順布於右綫之右次以法數對書於右綫之左實首位是二百法首是三千法大於實一位故進一位列之凡進位列者皆不滿法】

商除法【以法數約實法首是三實是二合兩位二一除之宜商七因法有次位須畱餘地攺商六以乘法三呼三六一十八是言十之數以商數六對實首二書於左直綫之右以乘得一八書於左綫之左遂以商數六徧乘法次位五呼五六成三十乘得三○挨書於一八之下一位又以商數徧乘法第三位一呼一六如六乘得○六挨書下一位又以商數六徧乘法末位九呼六九五十四乘得五四又挨書下一位如此徧乘法四位訖乃以乘出數爲減數對減原實恰盡】

定位【尋法首上一位爲單位橫對左綫得數上二位定爲兩順下一位是錢此二位俱空補作○○再下是分定所得爲六分】

此一次除盡例也又爲法大實小故所得不能成整數【兩爲整數今所得是分在兩下二位】

【若用乘法還原同前條還原法若用除法還原卽前條除法】

此所定單位在得數之外乃借虛位以定實數【下條同】其故何也曰法是三千有零能滿此數始能成一兩故曰實如法而一今法大實小是實不滿法不能成一數所得者乃剖一整數而得其若干如此條所得乃百分兩之六也【詳命分】

假如有銀八兩六錢六分八釐換金毎金一兩該銀八兩八錢問換金若干

答曰九錢八分五釐

定法實訣【此爲以銀除銀金價八兩八錢是先有之定則不動就以爲法】

【如前法對列法實於右綫之左右初商法八實八宜商一因無次商攺退商九以乘法八得七二又乘法次位八亦得七二依法挨書遂以對減實三位八六六餘○七四次商八以乘法八得六四乘法次八亦得六四依法書之遂以對減余實七四八餘○四四三商五以乘法八八得四四○依法書之遂以對減余實恰盡】

定位【法數上一位爲單位橫對得數上一位是兩定爲○兩九錢八分五釐法實首位同而法次位八大於實次位六故亦借虛位以定實數說在前條】

【甪乘法還原見乘法第二條用除法還原以金九錢八分五釐爲法除實得毎兩價八兩八錢卽畸零法也詳通分】

假如有銀四萬八千兩六十四人分之該若干

答曰各七百五十兩

假如有銀二百七十二兩○二分四釐九毫毎錢一千銀九錢○五釐問錢若干答曰三十萬零五百八十文定法實【此先有定則九錢○五釐故以爲法】

【此法有○位例也亦是得數有○之例

初商三以乘法九得二七法次位空無乘挨作○○以存其位

再乘法末位五得一五各如式書之以對減原實二七二○余

○○○五實空位無可商次商從實五字起商作五以乘法

九得四五法次位空亦作○存位乘法末位五得二五如式

書之以對減實五二四九餘○七二四】

【初商三乘九得二十七是言十之數宜對實首位二字書得數三次商五乘九得四十五亦是言十之數宜對余實首位五字書得數五如此審定而書則乘出減實之數與實相對了了分明便知不誤然初商次商不相接續所差二位是得數有二空位也補作○○於初商次商之間以存得數之空位如是則次商之事畢末商八以乘法九得七二法次位無乘亦作○存之法末位乘得四○以對減餘七二四恰盡】定位【此因所問是毎千之價故千卽單數也從法上一位橫對定爲千文之位上爲萬又上十萬定所得爲三十萬○○五百八十文】

若以數三十萬○○五百八十文爲法除原實二百七十二兩○二分四釐九毫亦復得九錢○五釐爲毎千之價如後圖

審法實【此問錢價是以錢分銀故以總錢爲法總銀爲實】

列位之理【所欲知者毎千之價故以千爲

單以萬爲十以十萬當百與原銀對列

其書商數如式不錯則得數之空位自明定位亦自無

舛說見前此兩條互相還原若以

乘法還原並用乘法第三條】

命分法

凡除法至單而止故曰實如法而一所謂一者卽單一數也其有除至單數而仍有不盡之餘實或法之數本大於實皆不能成一整數則以法命之其法有二其一除之至盡如計輕重者不滿一兩則除之爲若干錢若干分及釐毫絲忽前條法大實小及得數單下仍有數位者是也【若授時歷萬分爲度百秒爲分及錢鈔論貫貫之下有百冇十有零文尢爲易見】其一以法數爲分母不盡之數爲分子命爲幾分之幾【如以三除五內除三數滿法成一整數余實二不能成整則以此二數各剖爲三分共成六分而以三除之各得二分是爲三分之二也】假如十九人分銀二百五十四兩問各若干

答曰各十三兩零十九分之七

【以十九人爲法除二百五十四兩各得一十三兩不盡七兩以法命

之其法以法十九命爲分母不盡七數爲分子命爲十九分兩之

七解曰一整兩各剖爲十九分則不盡之七兩共剖爲一百三十

三分以十九人分之各得七分並整數分數爲毎人分得一十三兩

零十九分兩之七】

【若用乘法還原法以十九人乘得數十三兩得共二百四十七兩加

八不盡七兩共二百五十四兩合原實】

【若用除法還原法置原實內減不盡之數七兩餘二百四十七兩爲實毎人十三兩爲法法除實得十九人】

論曰古人只用命分後世乃有除之至盡之法然終不能盡【如以十九人除七兩各得三錢六分八釐四毫二絲一忽終餘一忽】故不如命分之簡妙【如錢糧尾數一忽之下仍冇微纎等七位不等徒滋繁文無禆實用然亦終不能盡若命分之法只一語喝盡更無滲漏然後知古法爲無】

省除法【舊名定身除亦名減法凡法首位是一數者用之】

假如漕糧正耗共五百○四石每正米一石除耗四斗問正米若干

答曰三百六十石

【先以原數五定正數爲三書直綫左以應減耗數四乘所定正三得

耗一十二並正三共得四二以減原數五○余○八次以餘數八定

正數爲六書正數三之下以減耗四乘六得二十四並正六共得八

四減餘數恰盡合得數減數並之卽還原數或用

加四亦同】

定位【凡省除皆以原數定位】

省除又法【古謂之求一除法】

凡定身除惟法首是一數者可用今以倍半之法求之則法首皆變爲一數

其法遇法首位是二是三法實皆折半遇四則折半兩次遇五六七八九法實皆加倍【如此則法首位皆成一數】假如前條六十四人分銀四萬八千兩用除法各得七百五十兩今以法實各折半兩次用定身除所得亦同

【先以法六十四折半作三十二又折半一十六爲法實四萬八千折

半作二萬四千又折半一萬二千爲實用定身除法先以實首兩位

一二定七爲得數法去首位一不用只用六以乘得數七得四十二

書左並得數七共一一二以減原實一二餘○○八次以余實八定

五爲得數亦以法六乘得三○挨書於左以減余實八恰盡】

定位【得數七對原實千因法是有十之數退一等作七百定所得爲七百五十石假如十人七千卽毎人七百故法有十者退一位也凖此推之法有百退二位有千退三位萬以上仿此論之凡省除依原實定位當知此訣】

並除法【舊名異除同除】

凡有當除數次者則以法相乘爲法作一次除之亦簡法也【如以四除之又以五除之又以七除之則以四乘五得二十又以七乘得一百四十共爲法以除之是並數次除爲一次除也】

假如經商獲利二千兩原本三千二百兩已經四年問毎年毎兩之息

答曰毎兩息一錢五分六釐二毫半

法曰先以四年乘原本【三千

二百】得【一萬二千八百】爲總法【本法宜以

二千二百除二千得毎兩之息再以四年除之得毎

年毎兩之息今並兩次除爲一次除足簡法也】

截除法【與並除相反所以便初學】

凡除有法數位繁者或可以截爲兩次除以從簡易假如五十六人分銀【一千五百一十二兩】各若干

答曰各二十七兩

【此因法五十六是七八相乘之數故先以八除得一百八十九兩仍用爲實再以七除之得二十七兩合問】

【或先用七除得數二百一十六兩復以八除之亦得二十七兩爲毎人數】

【右省除式也只作一直綫書原實於右紀得數於左而以九九數呼而減之不必另書減數凡法只一位者用此爲便】

假如銅一百二十八斤價二十兩問毎斤若干

答曰毎斤一錢五分六釐二毫半【原法三位今用截除三次俱一位爲法可用省除】

假如銀一千○八十兩置田二百一十六畝問田價每畝若干

答曰五兩【原法三位今用六除三次亦同】

約分法

凡命分有可約者以法約之古法曰可半者半之不可半者以少減多更相減損求其有等以等約之【以等數除母子數則皆除盡西人謂之紐數】

假如八十一人分銀二十七兩問各數答曰各得三分兩之一

法曰【以八十一除二十七不能各得一兩依命分法八十一爲分母二十七爲分子命爲八十一分兩之二十七又以法約之爲三之一】解曰【八十一是三个二十七若剖毎兩爲八十一分卽各得其二十七分是三之一也】

分母八一【約分法曰置分母八十一用遞減法以分子二十七減之餘五十四復以二十七減】分子二七【之仍餘二十七如是則兩數齊同是有等也卽用此等數二十七爲法轉除分母八】減餘五四【十一得三除分子得一如此則不用細分但以毎兩均剖爲三而各得其一分卽三又減分子】二七【人共一兩也若分子是五十四則用轉減法以子五四】仍餘二七【轉減母八一餘廿七又以母餘二十七轉減子五四亦余卄七是相等也就以此等數卄七爲法除母八一得三除子五四得二是爲約得三之二】

假如米八十五石分結一百○二人問各若干

答曰各得六分石之五

法曰【人多米少不能各一石依命分法以一○二爲分母八五爲分子命爲一百○二之八十五以法約之爲六分之五】【約分法曰置分母一百○二以分子八十五減之得餘十七用轉減法以餘十七減分子八十五餘六十八又遞減之餘五十一又減之餘三十四又減之餘亦十七是相等也就此等數十七爲法轉除母數一百○二得六除子數八十五得五約爲六分之五解曰一百○二是六个十七八十五是五个十七故曰六之五卽六人共米五石也若以米毎石均分六分八十五石共得五百一十分爲實以一百○二人爲法除之得五是毎所得爲一石米中六分之五也】

歷算全書卷三十五﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

欽定四庫全書

歷算全書卷三十六

宣城梅文鼎撰

筆算卷三

異乘同除法

以先有之數知今有之數兩兩相得是生比例莫善於異乘同除乃古九章之樞要也先有者二今有者一是已知者三而未知者一用三求一故西法謂之三率今先明同異名之說以著古法次詳三率之用以顯通理

異者何也言異名也同者何也言同名也假如以粟易布則粟與粟爲同名布與粟爲異名也

何以爲異乘同除也主乎今有之物以爲言也假如先有粟若干易布若干今復有粟若干將以易布則當以先所易之數例之是先易之布與今有之粟異名也則用以乘是謂異乘若先有之粟與今有之粟同名也則用以除是謂同除皆用以乘除今粟故曰主乎今有以爲言也【置今有粟以異名之布乘之爲實再以同名之粟爲法除之是皆以今粟爲主而以先有之二件乘除之也】

問何以不先除後乘曰以原總物除原物總價則得每物之價以乘今有總物亦可得今有之總價然除有不盡則不可以乘故變爲先乘後除其理一也

假如原有豆一百○八石價銀三十六兩今有豆一百三十五石問價若干

答曰四十五兩

法曰置今豆一百三十五石以原豆價三十六兩乘之得四千八百六十兩爲實以原豆一百○八石爲法除之得四十五兩爲今豆應有之價【見以物求價也若還原則以價求物】

假如原有銀四十五兩買豆一百三十五石今有銀三十六兩問豆若干

答曰一百○八石

法以豆一百三十五石乘價三十六兩得四千八百六十石爲實以價四十五兩爲法除之得一百○八石合問西人三率法

其法以先有之二件爲一率二率今有之二件爲三率四率則前兩率之比例與後兩率之比例等故其數可以互求

【今冇之二率先只有其一合前有之二率共爲三率以求之而得今有之餘一率是以三求一故曰三率法實四率也】

假如一率是三二率是四三率是九則四率必爲十二何也三與四之比例若九與十二也故以四【二率】九【三率】相乘【卅六】爲實以三【一率】爲法除之必得十二【四率】

若互用之以四率爲一率則十二與九之比例若四與三故曰可以互求【此卽還原之理】

【解曰以三比四以九比十二並三分加一之比例以十二比九以四比三並四分減一之比例凡言比例等者皆如是

此以上圖之四率爲

一率也故其序皆倒

而所得四率卽上圖

之一】

又更而互之

凡二三相乘與一四相乘等積此立法之根觀右圖可明【四九相乘三十六而十二與三相乘亦三十六故以三除三十六得十二以十二除三十六亦復得三此前兩圖互求之理若更一四爲二三其實同爲三十六故以四除之得九以九除之亦復得四此後兩圖互求之理】

又錯綜之

此又以前圖之二與三更之則前兩率之第二變爲後兩率之第一而其比例亦等【凡一率二率爲前兩率乃先有之二件也三率四率爲後兩率乃今有之兩件也今以二率三率相易則是先有之次率變爲今有之首率也然以比例言之在前圖爲三與四若九與十二者在此圖則三與九亦若四與十二也】

若以一率除二率得數以乘三率亦得四率【如以一率三除二率九得三以乘三率四亦必得四率十二以一率四除二率十二得三以乘三率三亦得四率九但先除後乘多有不盡之分故異乘同除爲算家大法乃中西兩術所同也】

試仍以古圖明之

原有小麥十二石換食鹽九石【俱四分之三比例若以上�左】今有小麥四石換食鹽三石【右更置卽成三率之前四圖】

更之【以縱爲橫】

原有粱米三石換棉布九疋【俱三倍之比例若以上下左右】今有粱米四石換棉布【十二】疋【更置卽成三率之錯綜四圖】辧法實

凡三率之用皆以二率乘三率爲實首率爲法除之以得所求爲四率

然何以定其孰爲一率孰爲二率三率也曰此則古人同異名之法不可易也訣曰凡今有之已知者常定爲三率【其未知者待算而知則常爲四率】視先有之物與三率之今有同名者定爲首率其與今有異名必爲二率矣

又訣曰凡三率之法以三件求一件其所求之一件未知而三件則巳知也此已知之三件中必有兩件同名【如價與價物與物之類】就以此同名之兩件審其孰爲先有定爲首率【其今有者則爲三率而其餘異名之一件亦必先有也恆爲二率】

假如有句股形田長一百三十五步闊四十五步今截相似形長一百○八步問闊若干

答曰截闊三十六步

定法實訣

以今截長一百○八步定爲三率長與長同名以原長一百三十五步定爲首率濶與長異名以原濶四十五步定爲二率

又訣【此巳知之三件是原長原闊截長內長與長同名以原長是先有之數定爲首率截長是今有之數爲三率原濶與長異名爲次率】

按原長與原濶卽大句大股截長截濶卽小句小股也四者皆可以遞互相求三率中更互錯綜之理尢爲易見

以比例言之大股與大句若小股與小句也更之則小股與小句亦若大股與大句也此爲以股求句反之而以句求股則大句與大股亦若小句與小股也又更之則小句與小股亦若大句與大股也

又錯綜之則大股與小股若大句與小句也而大句與小句亦必若大股與小股矣又小句與大句若小股與大股也而小股與大股亦必若小句與大句矣是爲三率之八變

異乘同除定位法

三率定位與乘法除法無異【乘法以實單位爲根定所對得數爲法尾數除法以法首上一位作識定所對得數爲所求單數並詳前卷】但所用之實以二率三率相乘而得握算者或疑其數之驟陞而不能守其定法則定位必訛而其理益晦矣故復論之【諸家算術往往有定位不確者皆由見乘後數多未免驚怖而輙爲酌攺故也】

假如六个時辰馬行二百一十里今行五个時辰當有若干裏

答曰一百七十五里

論曰試以六時除馬行【二百一十里】得每時行【三十五里】以乘【五】時亦得【一百七十五里】原無可疑今先乘後除故以【一千○五十里】爲實驟觀之似乎太多究竟除後得其本數而已

假如銀【三十二兩】換錢【三萬六千文】今有銀【二十八兩】問錢若干答曰三萬一千五百文

若以【三十二兩】除【三萬六千】得毎兩錢【一千一百二十五文】以乘【二十八兩】亦得三萬一千五百文【知得數之同則知一百萬零八千之非誤】

異乘同除約分法

三率內有兩率相凖可用約分者卽攺用所約之數易繁爲簡如法乘除所得無誤而用加防矣【兩率者其一首率其一次率或三率也凡以法約之必兩率相準次率三率祗用其一皆取其與首率相凖也或兩率並爲偶數則俱折半或兩率並可均剖爲四則折半兩次或兩率並可均分爲三則各取三之一或兩數互減而得等數則以等數約之並如約分法】

【論其比例半之則以三約之以九約之再約之爲十八比九與八則六與十則二與十則爲一十六若九之比例六之比例六之比例與八若十九與八亦若九若三十三若十一與十一與十八也

十九與與八十八八十八

八十八八十八】

假如賃房九个月銀七十八兩問住二年該若干答曰二百零八兩【法以二年成二十四个月依式列之】

四

二百零八【八乘廿六卽得此數】假如八色金六十兩換銀二百八十八兩今有九色金五十兩該若干

答曰二百七十兩【此以金折成足色六十兩作四十八兩五十兩作四十五兩算之】

四

二百七十【十八乘十五得此數右皆約得一數爲首率故不須除但以二率乘三率卽得所求爲四率】

重測法【三率有疊用兩次者謂之重測卽兩个異乘同除】

假如有夏布四十五丈欲換棉布但云毎夏布三丈價二錢棉布七丈價七錢五分問換棉布若干答曰二十八丈一夏布三丈

先用爲法

四價

三兩法除實得此數

重列

一價【七錢五分】

又用爲法

四棉布【二十八丈】法除實得此數

此因兩布各有其價故先用法求得第四率以夏布變爲銀就以此定爲重列之第三率【卽今價也】而以棉布價【七錢五分】爲首率【以與今價同名也】棉布【七丈】爲次率【以與今價異名也】如法乘除得所換棉布爲四率

並乘除法

以兩次乘除並而爲一是合兩三率爲一三率也卽古法之同乘同除【古以並乘爲異乘同乘以並除爲異除同除今乘除俱用並法故謂之同乘同除也】假如今有芝麻五十四石欲換黃米但云芝麻三石換緑豆五石換黃米三石問該換黃米若干

答曰六十七石五斗

本法

重列

一麻

三石

豆

四石

二豆

五石

米

三石

三今麻【五十四石】

今豆九十石【此重列之第三卽先得之第四乃本法也】四該豆【九十石】

米【六十七石五斗】

簡法【卽並法】

【今以兩首率相乘爲首率

亦以兩次率相乘爲次率

以兩九十石對去不用故三率

省乘是爲並法實簡法也】

論曰本用兩次乘除今以豆【四石】乘麻【三石】得【十二石】以除是並兩次除爲一次除也以米【三石】乘豆【五石】得【十五石】以乘是並兩次乘爲一次乘也依法求之卽得所換米【六十七石五斗】與兩次求者數同【又因一率二率可用約分約之爲四與五而法益簡】

然則第三率何以獨異【第三率徑用今麻不以豆九十石乘之是與並兩首率爲首率並兩次率爲次率者迥別】曰重列之第三卽先得之第四故可以對去不用不惟不用亦可不求【重列之第三率旣無乘並之用則原列之第四率不必更求其數】而乘除之用已偹【今麻原系第三率今仍用爲第三是三率之用本無所缺】卽所求之得數已淸矣【若第三率用豆九十石乘過之則所得第四率亦必爲豆九十石乘過之米得數後必以九十石除之始能淸出米數反多曲折今對去豆九十石不用則所得四率卽米數直截了當】故爲簡法

又式

假如有戰兵七百名毎年額餉一萬二千六百兩內有新著伍兵三百名已經應役七个月問該餉銀若干答曰三千一百五十兩

依重測並乘除法當以【十二月】乘【七百名】得【八四○○】爲法以【七个月】乘【一萬二千六百】得【八八二○○】又以【三百名】乘之得【二六四六○○○○】爲實法除實得三千一百五十兩爲兵三百名七个月之餉今用約分以【七百】與【三百】約爲七與三【皆百約之】則首率次率各有【七】對去不用可省並乘

重列之時徑以【十二】爲首率餉銀【一二六○○】爲次率【三】爲三率依法乘除而得四率又以首率【十二】三率【三】約爲四與一則徑以餉【一二六○○】爲實以四爲法除之得【三千一百五十】合問變測法【古謂之同乘異除在三率謂之變測卽幾何原本之互視法也】

凡異乘同除皆以先有之一率爲法【卽首率】以先有之又一率乘今有之一率爲實【卽二率三率相乘】

若同乘異除則反以今有之一率爲法【同文算指列於第三今依法實之序定爲首率】以先有之兩率自相乘爲實【同文算指列於第一第二今定爲第二第三】𨿽亦以法除實得今所求之又一率【卽四率】與諸三率同而法實相反故曰變測

假如用秤稱物物重秤不能稱外加一錘稱得【八十四斤】本錘【一斤五兩】加錘【一斤三兩】問其物實重若干

答曰一百六十斤

一錘重二十一兩

爲法

四實重一百六十斤

法除實得數

法以錘【一斤五兩作二十一兩】加錘【一斤三兩作十九兩】共重【四十兩】爲先有之一率稱重【八十四斤】爲先有之又一率相乘【三三六○】爲實以本錘重【二十一兩】爲今有之一率爲法法除實得實重【一百六十斤】爲所求今有之又一率合問

假如秤失去錘有所稱物【重一百六十斤】今以他物代錘【重四十兩】稱得重【八十四斤】問錘重若干答曰一斤五兩

一物重一百六十斤

二稱得重八十四斤

三【他物代錘】重四十兩

四錘重二十一兩

假如布幔一具用布十六丈五尺布濶二尺今有布濶一尺五寸如式作幔該用若干

答曰二十二丈

一今濶一尺五寸

二原濶二尺

三原長十六丈五尺

四今長二十二丈

假如儲粟方窖長【一丈二尺】濶【九尺】深【一丈】今欲別穿一窖藏粟與之等長亦【一丈二尺】但深加【二尺五寸】該濶若干

答曰濶七尺二寸

一今深十二尺五寸

二原深十尺

三原濶九尺

四今濶七尺二寸

【此原長不動而加深減濶也今深今濶相乘得九十尺與原深乘原濶等以乘長一十二尺得一千零八十尺亦等則其藏粟等】

又問若依原窖之濶【九尺】但加長【三尺】該深若干

答曰深八尺

一今長十五尺

二原長十二尺

三原深十尺

四今深八尺

【此原濶不動而加長減深也今長乘今深得一百二十尺與原長乘原深等以乘濶九尺並得一千零八十尺】

假如有方倉髙【一丈八尺】濶【二丈】深【二丈一尺】今更造一倉亦深【二丈一尺】但髙減三尺問闊若干

答曰濶加四尺【共濶二十四尺所儲米石卽同原倉之容】

一今髙十五尺

二原髙十八尺

三原濶二十尺

四今濶二十四尺

【此原深不動而減髙增濶也當與右二條參防倉之髙卽窖之深倉之深卽窖之長】

【今髙乘今濶得三百六十尺與原髙乘原濶等再以深二丈一尺乘之得七千五百六十尺與原倉之容積等】

假如原借八五色銀四十八兩今還九六色銀問該若干答曰四十二兩五錢

一今銀色九六

爲法

四今還四十二兩【五錢】法除實得數

【解曰原銀八五色是毎兩實折八錢五分故以乘原銀得四十兩零八錢乃折實紋銀之數也還銀九六色是毎九錢六分成一兩故以除折實紋銀得四十二兩五錢爲應還之數凡零乘數反損零除數反增詳別捲】

假如有田一區用三十二人耕治五日而畢今用四十人問該幾日答曰四日

一今用四十人

二原用三十二人

三原耕五日

四今耕四日

假如決水修池水竇濶三尺十二日涸出今開濶八尺問水涸幾日

答曰四日有半

一今濶八尺

二原濶三尺

三原十二日

四今四日半

假如額兵五千六百設有一年之餉今祗畱兵三千三百六十名問其餉可支幾時

答曰一年零八个月

一今兵三千三百六十

二原兵五千六百

三原設餉十二个月

四今可支二十个月

歷算全書卷三十六

欽定四庫全書

歷算全書卷三十七

宣城梅文鼎撰

筆算卷四

通分法【並減乘除並有子母通分之用故別自爲捲其畸零以十百千萬爲等者不用此法】

凡整數下有零分而不以十分成整當用通分其法以一整數剖爲若干分是爲母數其所零分在母數中得幾分之幾是爲子數

通分子母列位法

通分列位其法有三曰化整爲零曰以整零曰收零爲整

假如有物一斤四兩則以一斤通爲十六兩加入所四兩共二十兩而列之

二○【斤以十六兩爲母其所四兩是子今化斤爲兩則可乘除謂之以母從子也】

若欲通爲銖則以毎兩二十四銖爲母通二十兩爲四百八十銖

四八○【此以斤通爲兩兩又通爲銖是兩次用通分也】

若畸零累析有用通分三次四次以上者準此論之如皇極經世一元有十二防一防有三十運兩次通之則一元有三百六十運一運有十二世一世有三十年兩次通之則一運有三百六十年

若以元通爲年則用四次【元通爲防防又通爲運運又通爲世世又通爲年是四次用通分也】通得十二萬九千六百爲一元年數

假如古歷十九年七閏謂之一章其月謂之章月二三五【此以毎年十二月通十九得二百二十八月加入閏七月共得二百三十五月爲一章之月】右化整爲零古通分法曰通以分母納以分子蓋言以分母通其整數而以所零分加入也然亦有不納子而但通其整之時旣以分母通之則整數不用全化爲分故西學謂之化法

別有變零爲整之法與此化整爲零之法似同而實不同所以爲零乘之用蓋化整則全化爲零而不用整變零則全變爲整而不用零其數則同【謂自一至九之數】

其等則異【謂如零陞爲單單陞爲十之類】詳見零除條

凡通分化整爲零以便乘除不必更書其母若列位本法以整零當以母數子數並而書之曰幾分之幾【若分下有小分則曰幾分之幾又幾分分之幾】

假如有整數二十五有零分爲整數十二分之七又仍零秒爲分數三十分之十四

【此如歷法一周十二宮一宮三十度今得星行二十五周又七宮十四度也】

假如有整數十六又零數爲整數七分之五

【此以一整數剖爲七分而所零分適得其五也七爲分母五爲分子】

假如有零數爲整數三十分之十四又有小分爲分數六之五

【此原無整數但有分又有小分其分以三十爲母十四爲子是一整數剖爲三十而得其

十四也小分以六爲母五爲子是一大分又剖爲六而得其五也小分母古謂之秒母】

右以整零

凡母數必大於子數其常也乘除之後有子數反多者法當以母數收之爲整而其零

假如有零分十六其分母九【此以子數反大當以母數收爲整】

【九之十六】收得一【九之十六分內除九分收爲整餘七七

分是爲整一又九分之七也】

假如方田之法以方五尺爲步其積二十五尺今有積七十尺

【步法二十五尺而積有七十尺子數反多法當收整】

【七十尺內除五十尺收爲二步剩二十尺不能成步是爲整二步又二十五分步之二十】

假如古歷法以十九年爲一章四章爲一蔀今距元中積一百年問在第幾蔀第幾章

畣曰第二蔀第二章

之第六年

【法先以章法十九收九十五年成五章剰五年次以蔀法四收四章成一蔀剩一章

通列之成一蔀一章零五年是爲已過之數今正在交第二蔀第二章

之第六年也】

右收零爲整【凡欲乘除必化整爲零旣乘除矣仍必收零爲整此二者相須爲用也】此外仍有除零附整之法其法以分母爲法分子爲實實如法而一得零數爲整數十分之幾或百分千分萬分之幾所謂退除爲分秒也見除法命分

通分並子法

通分並子其類有三曰母同者曰母不同者曰大分又小分者而所以並之之法有七曰徑並法曰變分母法曰互乘法曰連乘法曰維乘法曰截並法曰通母納子法

徑並法

凡分母數同者徑並其子並滿母數收爲整【數在三宗以上而母同者皆可徑並其子或大分之下有小分而分母同者並用此法】

假如有絲五分斤之四又五分斤之三並之若干畣曰整一斤【又五分斤之二】

【此因兩母同爲五故徑並其子子數七母數五是子滿母數而且

有餘也當以母數收之得整一零五之二】

以上分母同者徑並其子爲通分並法之一類

變分母法

凡分母不同而有比例可求者變而同之可省互乘假如有數【六之三】又加【四之一】共若干

畣曰共四之三

【法以六之三母子各損三之一變爲四之二則兩母同爲四而其子可並矣

所以然者四與六是倍半比例故去三分之一卽相同也】

假如有金【八分兩之五】又【四分兩之三】並之若干

答曰一兩又八分兩之三

【八與四爲折半比例然不以八折半者其子奇數不可半也故以四之三

加倍卽母數齊同可相並矣】

互乘法

凡分母不同而無比例可求者先互乘以同其母再以母互乘其子而並之【數在三宗以上而母不同者皆可用此法】

假如有物【四分石之三】又【七分石之四】共若干答曰整一石又【卄八分石之九

先以右母四互乘左母七得卄八又互乘子四得十六變七之四爲

卄八之十六次以左母七互乘右母四及子三變四之二爲卄八

之卄一兩母旣同遂並其子爲二十八之三十七

以滿共母二十八収爲整一仍餘九】

凡三母內有兩母相乘與餘一母同者只用一互乘卽可相並假如有甲乙丙丁四數乙得甲【七之六】丙得甲【五之四】丁得甲【卅五之二十三】若合乙丙丁三數得甲數若干答曰得甲數二【又三十五之十一

法以乙丙兩母相乘三十五與丁母同數卽用乙母七互乘丙五之

四得三十五之卄八丙母五互乘乙七之六得三十五之三十以並

丁三十五之二十三共得卅五之八十一以滿母卅五成整數合問

歸整】得甲數二【又卅五之十一】

連乘法

凡數三宗以上者用母連乘爲共母又以各母除之得數以乘其子爲子而並之並滿共母收爲整

假如有數六【之四】又加三【之一】又加五【之四】並之若干

答曰整一【又九十之

法以六乘三得一十八又以五七十二

乘之得九十爲連乘之共母

卽六除共母得數以乘之四之數

卽三乘共母得數以乘之一之數

卽五除共母得數以乘之四之數】

歸整得一又【九十之七十二】

觧曰【此卽互乘也試以五互乘六之四得三十之二十又以三互乘之卽成九十之六十以六互乘三之一得十八之六又以五互乘之卽成九十之三十以六互乘五之四得三十之二十四又以三互乘之卽成九十之七十二】維乘法【此古維乘法也與母除共母以乘子之法所得同】

假如錢糧一次完過【九分之一】又完【四分之一】又完【六分之一】又完【六分之一】又完【七分之一】問共完若干答曰五百○四之四百零一【約爲十分之八稍弱】法【以八乘六得四十八再以七乘之得三百卅六又以九乘之得三千○卄四又以四乘之卽得一萬二千○九十六】

約爲五百○四之四百○一【卄四約之】

解曰【此卽連乘法也但因分子皆爲之一故卽以母除共母之數爲子相並而省一乘】

試用維乘所得亦同

截並法

凡數件中有分母同者先取出並之然後與各件並列則五件可作四件用【六件以上仿論】而共母亦簡

如前圖有八之一四之一爲加倍比例可先取並之【用變分母法】

乃重列之【原數五宗今作四宗入余並同前】

【解曰共母原系一萬二千

○九十六今只三千○二

十四簡四之三故所得之

子皆於前式爲四之一】

凡宗數繁多而分母又各不同者可分作幾次並之假如有物四宗甲數【五分斤之三】乙數【六分斤之一】丙數【三分斤之二】丁數【七分斤之四】並之若干

答曰整二斤又六百三十分斤之三

如上圖依法互乘以四宗並作兩宗乃重列之

以上分母不同者爲通分並子之又一類

大分小分並法

凡大分之下有小分而母相同者如法並之自小分起滿小分之母進爲大分滿大分之母進爲整

若大分之母同而小分母不同者用互乘法使其同【餘如上法】若大分母不同者卽通大分爲小分再用互乘以同之假如西曆以一日分二十四小時一時又析爲六十分今得中防二十九日十七時三十六分實防該加七時四十分依法並之得三十日零一時一十六分

原二九【卄四之六十之時爲大分大分之母二十四一七

三六

時下爲小分小分之母六十】加

【卄四之六十之先並小分得七十六以滿六丨丨○�

四十

十進爲一時仍餘十六分】

並得三○日○一時十六分【次並大分得二十五時以滿二十四進爲一日仍餘一時】假如修築河堤新修七里○六十六步一尺舊堤原存一十二里二百九十三步四尺問堤長若干答曰長二十里新修○七○六六一

【裏法三百六十步法五先並尺一四共五進一步次並步】原存�����四

【共三百六十進一里次並裏二七及所進之一共十里並】共長二○裏○○○步○尺【原十里是爲堤長二十里合問】

假如有硃砂八斤十兩○九銖又有三斤五兩十八銖共若干答曰十二斤○三銖

八一○○九

【銖滿二十四進一兩餘三兩滿十六進一】�○��八

【斤斤共十二是爲一十二斤○三銖合問】

共一二斤○○兩○三銖

右大小分母俱同故徑以子並

假如甲數九【之四】又小分【五之四】乙數九【之八】又小分【八之三】並之若干答曰整一又九之四又小分四十之七

先同其小分之母

【先以小分母相乘得四十爲共母又互乘其子變

五之四爲四十之三十二變八之三爲四十之十五】

小分母旣同乃重列而並之【餘同上】

【並之】得九之十二又四十之四十七

歸整一又【九之四】又小分四十之七【小分滿四卜收爲大分一大分滿九收爲整一】右系大分母同而小分之母不同故互乘之使其同

假如有田二坵甲坵二畝【又四分畝之三】又小分【五之一】丙坵一畝【又三分畝之二】又小分【四之三】並之若干

答曰整四畝【又六十分畝之四十三】

先以甲小分母五通大分四之三爲小分二十之十五加入原小分一共二十之一十六爲甲數

又以丙小分四通大分三之二爲小分十二之八加入原小分三共十二之十一爲丙數

解曰【此卽古通分納子之法也以大分盡通爲小分而納小分焉實則以小分陞爲大分也】

【並得】三又

二百四十之四百一十二歸整四又【二百四十之一百七十二】約爲六十之四十三

右系大分母不同故盡通爲小分而並之

以上大分小分法爲通分並子之又一類

凡通分並法以通分減法還原【互見後除】

通分子母減法

通分減法亦有三類曰母同者曰母不同者曰大分小分者而其減之之法有五曰徑減法曰變分母法曰互乘法曰子乘母除法曰通母納子法【並之與減猶乘之與除可以互相還原相反而適相成也故所用之法皆同】徑減法【數在三宗以上而母同者並用此法】

凡分母同者徑以相減不足減者以分母通整數減之假如有紵絲一疋零【五分疋之三】用過五分疋之三問仍存若干答曰五分疋之四

原一五之二

【此以之三減之二則減數反大於原數不足減以借法作】減

五之三

【防於疋位借原數一疋通作五分並之二共成五之七內】存○五之四

【減去五之三仍存五之四合問】以上分母同者徑以對減爲通分減法之一類

變分母法

凡分母有可以比例言者以比例同之可省互乘假如有數六之三又有數四之三其較若干

答曰四之一

較

四之一

假如有整數一零八之三減去四之三該存若干答曰八之五

整數一八

【之通三爲】八之【十一】

減數

四【之三】變八之六

存數

八之五

互乘法

凡分母不同者先互乘以同其母以母互乘其子而減之假如有兩數甲五之三乙七之四不知誰多

【法以兩分母五七相乘得三十五爲共母又互乘其

子變甲數爲三十五之二十一變乙數爲三十五之

二十以相減則乙不及甲者其較爲三十五分之一】

甲多

三十五之

一

凡分母同者視其子爲大小【子數大者卽大小者卽小】若子同而母不同者反是【母數大者子數反小】亦以互乘見之如後圖

【甲六之四乙五之四】互得三十【之二十丙四之三之卄四丁五之三】互得二十之【十五十二】

乙多

三十分之四丙多

二十分之三右二則以分相較而辧其多寡卽古課分之法也

凡三母內有兩母相乘與餘一母同者只用一互乘卽可相減假如有甲數二又【三十五之十一】乙得甲【七之六】丙得甲【五之四】余爲丁數該若干

答曰丁得甲三十五之二十三

【先以分母通整數爲分而納入分子

次以減數分母相乘爲共母又互乘

其子而並之是爲三十五之五十八】

丁存

三十五之卄三【以減甲數仍餘三十五之卄三合問】子乘母除法

凡分母有可以相除者以分母除其分母得數轉以乘子而減之其餘數仍以分母除之卽得約分之數若原系兩分母互乘而並者用此法可知原母【數在三宗以上而母不同者並用此法可代維乘】

假如有沈香一石零【二十八分石之九】用去七分石之四該余若干

存

卄八之

二十一約爲四之三【法以分母通共數一爲二十八並子之九共三十七變共數爲二十八之三十七又以減分母七除共數之分母二十八得存數原母四以乘減分子四得十六變減數爲二十八之十六兩相減得所存數爲二十一於是仍以減分母七除之得存數原子三變存數爲四之三】

【論曰此亦變分母法也其數與互乘所得無異但用互乘則數益煩故用子乘母除之法變七之四爲二十八之十六母旣相同卽可以相減矣若互用異乘同除則成三率之比例如後圖】

一率【分母七】法以子之四乘所變分母二十八得一百二率【分子四】十二爲實分母七爲法除之得所變分子三率【分母卄八】爲十六其比例爲七與四若二十八與十四率【分子十六】六也

又論曰存數不用約分法而竟以分母七除何也曰約分之法以對減而得紐數今分母七旣可以除其母二十八又可以除其子二十一卽紐數也又何事於對減之煩乎況用之互乘還原尢爲親切蓋互乘之共母旣以原母相乘而得卽無不可以原母除之而盡也

假如有整數一又【九十之七十二】甲得六【之四】乙得三【之一】余爲丙數該若干

答曰丙得五之四

丙存

五之四

九十之七十二法曰【先以分母通整一爲九十並分子七十二是爲九十之一百六十二次以甲分母六除原母九十得十五以甲分子四乘之得六十爲甲數又以乙分母三除原母九十得三十以乙分子一乘之仍三十爲乙數合甲乙兩數得九十以減原數一百六十二仍餘七十二爲丙數以法約之爲五之四約分法詳後條】約分防法置丙存數【九十之七十二】爲實以甲乙分母【六三】相乘得

數【十八】爲法除之得五之四爲丙存數【以十八除九十得五十八除七十二得四約分本法用子數七十二減母數九十得十八以轉減子數得五十四再遞減之亦餘十八是爲紐數乃用爲法以除子母數得約分五之四今攺用甲乙兩母相乘亦得十八爲法何也以原數九十可以六除亦可以三除知其爲三數維乘而得者也故於還原最切】

論曰此有分母三宜用維乘然其數益繁故攺用子乘母除之法則三母齊同可用相減而法與數俱簡矣

試先減乙丙數則所存者卽甲數【法同上】

甲存【約爲】六之四

卽九十之六十

若先減甲丙數則所存者必乙數其法並同玆不悉具按如此互求卽知無誤可無假他法還原矣

假如有數五百○四之四百○一甲得【八之一】乙得【六之一】丙得【七之一】丁得【九之一】餘者爲戊數該若干答曰戊得四之一

原數五百○四

之四百○一

甲減八

之一

六十三

乙減六

之一以各減母除原母得

八十四

丙減七

之一

七十二

丁減九

之一

五十六

共減

二百七十五

戊存五百○四

之一百二十六約爲四

之一【以所存之數除原母卽得】

解曰此因分子俱系之一故卽以除數爲得數也以上分母不同者爲通分減法之又一類

大分小分減法

凡大小分母並同者【謂原數之大小分母與減數之大小分母也下仿此】竟以對減不足減者借整數以分母通爲分【小分不足減亦以小分之母通大分爲小分其借上位皆作防志之】若大分母本同而小分母不同者用互乘以同之餘如上法若大小分母俱不同者用通分法盡通大分爲小分而納小分焉餘如上法

假如西曆得某月平朔三十日○一時一十六分其實距時七時四十分爲減號問實朔在某甲子某時刻

答曰壬辰日酉初二刻○六分【以二十九日命爲壬辰日以十七時命爲酉初其小餘三十六分以三十分收爲二刻尙餘六分命爲壬辰日酉初二刻○六分】

日時

分【時爲大分大分以二十四爲母時下爲小分小分之母六十】

平朔三�○�一�【先減小分四十原數隻十六不足減作直號於大分位借一分通爲小分實距時】

七四�【六十並原小分共七十六減四十餘三十六次減大分七原數一已借】實朔二�一�三�【去亦借整一通爲二十四減七餘十七原數三十因借減一餘二十九】凡大小分母不同者【謂大分之母與小分之母不同也】須作防以別之故借整化零之防攺爲直號

右系大小分母並同故竟以對減

假如有整數一又【九之四】又小分【四十之七】甲得九【之四】又小分五【之四】余爲乙數該若干

答曰乙得九之八又八之三

乃重列之【小分旣同卽可相減】

乙存

九之八二百之七十五約爲八之三法曰【先減小分減數大原數小不足減乃作直號於大分位借一分通爲小分納原數共二百三十五減一百六十餘七十五次減大分原數四因借減一變三亦借整數一通爲九共十二減四餘八整數借減盡】

試先減乙【用變分母法以代互乘余並同上】

原數一九

之�又

四十之七減乙

九之八又八之三變四十之一十五存甲

九之四又五之四卽四十之三十二解曰【四十與八是五倍比例故以乙小分八之三母子各五倍之卽變爲四十之一十五則兩母齊同可以對減矣】右系大分母同而小分母不同故用互乘以同之

假如甲丙兩坵田共四畝又六十分畝之四十三甲坵二畝又四分畝之三又小分五之一餘爲丙坵該若干

答曰一畝又十二分畝之十一【卽六十之五十五母子各五約之爲十二之十一】法先以甲小分母五通大分四之三爲二十之十五加入原小分一共二十之十六乃列而減之【如此則大分小分合而爲一與原數無小分者類矣】

存丙一又

六十之五十五用變分母法以甲子母各加三倍變二十之十六爲六十之四十八以減原數四十三不及減乃作直號於整數位借一數通爲六十分納原數共一百○三減甲數四十八餘五十五次減整數整數四因借減一成三減甲二仍餘一是爲整數一又六十之五十五卽丙存數也

右系大分母不同故通爲小分而減之

以上大分小分法爲通分減法之又一類通分子母乘法

假如有田三十六畝六分毎畝徵銀三分錢之二問該銀若干答曰二兩四錢四分

法以分子之二乘田三十六畝六分得

七十三分二以分母三收之得二兩四

錢四分合問

何以知其爲七十三分也曰原問毎畝

徴銀三分錢之二分故於右行實數內

尋毎畝之位爲定位之根以橫對左行

得數卽命爲分則上下俱定矣

假如有銀六十四兩毎兩買銅八斤十二兩該銅若干答曰五百六十斤

先以斤法【十六】收十二兩爲斤下之七分

五釐加八斤共八七五爲法以乘銀六

十四兩得五六○○○卽於右行實數

內尋毎兩位以橫對左行得數命法尾

釐推而上之定爲五百六十斤

假如有米五石【又三分石之二】毎石價銀九分兩之八該銀若干答曰五兩又二十七分兩之一

法以分母三通五石爲十五分納子二

共十七分以價之八乘之得一百三十

六又以兩分母【三九】相乘得二十七收之

合問

通分子母除法

假如毎田一畝徴銀三分錢之二今完編銀二兩四錢四分該田若干

答曰三十六畝六分

法以分母【三】通二兩四錢四分爲七十

三分二爲實以分子之二爲法除之卽

得三十六畝六分合問【原所設三分之二以錢爲主故

四分所通爲小分】

假如有米五石又三分石之二共價銀五兩又二十七分兩之一問毎石該價若干

答曰九分兩之八

法先以米分母【三】通五石爲十五分納子二共十七分爲法又以價分母【卄七】通五兩爲一百三十五納子一共一百三十六分爲實法除實得八爲毎石三分一之價以分母三乘之得二十四分爲毎石價命爲二十七分兩之二十四約爲九之八

又防法【以米分母三除銀分母二十七得九爲毎石價之母卽以除出之數爲子卽九之八】

假如有絲一斤又六分斤之四共價一兩又四十二分兩之二十問毎斤價若干答曰七分兩之六又十之二法先通絲一斤爲六分納子四共一十爲法又通銀一兩爲四十二分納子二十共六十二退一位【卽一十除也】命爲單六又小分二卽毎斤六分一之絲價也於是以分母六乘之得三十六又小分十二爲毎斤價是爲四十二分兩之三十六又小分十二也子母並六約之爲七分兩之六又小分十之二防法【以絲分母六除價分母四十二得七爲毎斤絲價之母卽命爲七分兩之六又十之七】通分子母三率法【卽異乘同除】

假如西曆太陽毎日平行【五十九分零八秒二十微】今有二刻半該行若干分答曰一分三十二秒卄四微【又九十六分微之卄六】

法【先通五十九分爲三千五百四十秒加原帯八秒共三千五百四十八秒又通爲二十一萬二千八百八十微加原二十微共二十一萬二千九百微在位以二刻半乘之得五十三萬二千二百五十微爲實以一日化九十六刻爲法除之得五千五百四十四微不盡除滿三千六百微收爲一分又一千九百二十微收爲三十二秒仍餘二十四微不盡者以法命之是爲一分三十二秒二十四微又九十六分微之二十六】

論曰此小數法也何則二十一萬二千九百者是每日九十六刻之數今以二刻半乘之於刻下多一位故截去得數尾一位命爲百

假如以粟易布毎粟六分石之二易布五分疋之三今有粟一石又三分石之二該布若干答曰三疋

一粟六分石之二【母子各減一倍】變爲三之一

四布五分疋之【十五】

收爲整三疋【兩粟母同爲三省不用只以布分母收之】用變分母法變一率六之二爲三之一則兩粟母相同可省互乘而子變爲之一又可省除只以三率一石用分母通爲三納子二共五以乘二率布分子之三得十五再以布分母五收之卽得三疋合問

假如以銀換金毎銀二兩又三分兩之二換金九分兩之二今有銀六分兩之四該金若干

答曰十八分兩之一

四金【十八】分兩之一

法以一率分母【三】互乘三率六之四爲十八之十二與二率之二相乘得二十四爲實又用一率分母三通二兩爲六分納子二共八是爲三之八復以三率分母【六】互乘之爲十八之四十八以乘金母【九】得四百三十二爲法法大實小以法命之爲四百三十二之二十四母子各二十四約之卽十八分兩之一合問

若用變分母法則如後式

一銀二兩【又三之二】

通爲三之八乘得【七十二】爲法【以金母九乘之八也】

四金【七十二分】兩之四約爲【十八】之一【子母各四約之】

解曰十八分兩之一卽五分五犛五五不盡畸零分子母乘法

假如以八之五乘四之三該若干

答曰三十二之十五

法以母乘母得三十二子乘子得十五卽三

十二之十五爲乘得數也

又法以除代乘則倒位互除之

法以五除四得八爲母數以八除三得三七

五爲子數是爲八之三七五與乘得之數同

解曰四除三十二得八四除十五得三七五若四因八得三十二四因三七五亦得十五

用法

假如谷一石價二十七分兩之十六今有谷四分石之三價若干

答曰九分兩之四

一谷一石

四價九分兩之四【因首率是一故省除卽以九之四爲得數】

解曰二十七分兩之十六卽五錢九分二犛六毫弱也谷四分石之三卽七斗五升也價九分兩之四卽四錢四分四四不盡也

若用倒位除以代乘則徑得九之四

法用母四除十六得四爲子用子三除二

十七得九爲母是爲九之四也

畸零分子母除法

假如以五之四除四之三該若干

答曰八之七五

法以母除母得八子除子得七五是爲八之

七半卽除得數也

又法以乘代除則倒位互乘之

法以母五乘子三得【十五】爲子以子四乘母四

得【十六】爲母是十六之十五與除得之數同

解曰十六卽八之倍數十五卽七五之倍數故其數同用法

假如以絹易縀絹五分丈之四換縀七分丈之四問絹毎丈該縀若干

答曰該換縀七分丈之五

一絹五分丈之四法以母除母得一四子除子得一○是二縀七分丈之四爲一十四之一十子母各半之爲七分

三絹一丈

之五【三率是一省乘卽用縀七之四爲實】

四縀七分丈之五

解曰五分丈之四者八尺也七分丈之四者五尺七寸一分彊也七分丈之五者七尺一寸四分彊也

若用倒位乘以代除所得亦同

法用子四乘母七得卄八爲母用母互乘子

四得卄爲子子母各取四之一卽七之五也

論曰同文算指有畸零乘除之法甚爲簡妙然莫適所用今以三率列之則實數可稽而用法亦明矣

畸零乘除定位

凡乘法得數必大於原問之數若畸零乘則其數反降凡除法得數必降若畸零除則其數反陞蓋卽異乘同除之理諸家術皆未經說破故定位多訛玆以三率明之如左假如換珠每珠一兩值銀二十四兩今有珠三分五釐該若干答曰八錢四分

此首率是單兩

而三率有分釐

是單下有三位

零也故截去得

數尾三位命法

尾兩兩位空定所得爲八錢四分

論曰此卽以乘出之數爲四率者以首率是單一兩故省除耳試卽以三率實尾位釐爲單而定所得爲八百四十兩爲實亦陞首率單兩爲千釐爲法除實【卽以實數降三位】亦仍得八錢四分合問【此條已詳二卷乘法中玆以三率列之於定位之理益明】

又論曰乘除之難在於定位而畸零爲尢難所以者何凡定位以單數爲根而畸零無單位可言故也前於乘法中立本數大數小數三法以尋每位可以禦畸零矣於除法猶未有以處也今皆歸之三率惟視三率中所有之數卽命爲單數【如金銀之類本以兩爲單今視三率中有分卽以分爲單而兩則爲其百數又如米谷之類本以石爲單今三率中有斗卽以斗爲單而石則爲其十數他仿此】則𨿽畸零皆可作整數算無論乘除一以貫之矣【是爲以零變整而乘除之後得數無異此所以別於通分化整爲零之法也】

假如有珠三分五釐價銀八錢四分問每兩珠價若干答曰二十四兩

【此一率首位是分卽以分爲單數以二率

陞兩位作八十四兩爲實以法三分五釐

對實分位列之除畢於法上一位命

爲單分推而上之定得數爲二十四兩合

問】

解曰二率陞二位爲實者卽百分乘也分原在單兩下二位今旣陞爲單則單兩亦陞二位成百分也

假如銀二錢四分買稻九十六斤毎兩該若干

答曰四百斤

【此以錢爲單數則三率單兩成十錢而二率亦陞一

位成九百六十○斤爲實於是以法二錢對實○位

列之以單錢對單斤也除畢於法上一位命爲單

斤卽得數爲四百斤合問】

假如以豆換油豆四斗八升換油十二斤今豆十石該油若干答曰二百五十斤

【此以斗爲單數則三

率十石成百斗故二率亦陞兩位作一千

二百斤爲實以法四斗對實○斤位列之

亦以單斗對單斤也余亦同】

假如芝麻六斗四升四合換豆一石今芝麻四石八斗三升該豆若干

答曰七石五斗

若以斗爲單則命實爲四十八石三斗【以二率十斗乘之也】而以法首六斗對實三斗列之除畢於法上位定爲斗亦得七石五斗或以升爲單以合爲單得數亦無不同也【以升爲單法上卽命爲升以合爲單法上卽命爲合】

假如錢六百五十文價四錢八分七釐半每千該價若干

【此問毎千錢價是以千爲單也今法首只有百

卽以百爲單而陞單千爲十百則二率亦陞一

位作四兩八錢七分五釐爲實四兩列之以單

百對單兩也除畢於法上位命爲單兩兩位空

定得數爲七錢五分】

歷算全書卷三十七

欽定四庫全書

歷算全書卷三十八

宣城梅文鼎撰

筆算卷五

開平方法

測量句股全恃開方開方有平有立而平之用博以其有實無法故別爲一術以佐乘除之所窮

平方者面羃也其形正方故亦爲自乘之積開平方者以自乘之積求正方之邊故西法謂之測面其邊謂之方根法先列實依除法作兩直綫以所用方積列於右直綫之右自上而下至單位止無單作○

次作防定位自單位作一防起毎隔一位防之有一防則商一位【如有二防則商數有十有三防則商數有百】

次定初商皆自原實最上一防截定爲初商之實【如防在首位卽以一位爲初商實防在次位卽合兩位爲初商實】以自乘數約而商之皆以防處爲本位防上一位爲進位【本位者單數也如一商一四商二九商三其自乘皆本位不論百與萬以上皆作單數用進位者十數也如一六商四二五商五以至八一商九其自乘皆有進位不論千與萬以上上皆作十數用】

又法以初商實入表皆視初商實有與表同數或稍大於表數者用之以命初商【如一商一四商二此與表數相同也如二三亦商一五六七八皆商二此比表數稍大也若至九則商三又爲相同之數矣十至十五皆商三皆比表數稍大至十六商四又爲相同之數他皆仿此】初商表【凡初商三以下減積在本位四以上減積合兩位此表明之】

用表防法【但視初商實不滿表上自乘積者退一格卽商數如不滿○四卽商一不滿○九卽商二他仿此】旣得商數卽書於左直綫之右皆對初防之進位書之【凡商得一二三四書於防之上一位】五以上又進一位【凡商得五六七八九書於防之上兩位】次減實以初商數自乘書於左直綫之左皆以本位對初防【如初商一二三自乘一四九皆本位卽對初防書之如初商四五六七八九其自乘皆有進位則以下一字對初防】就以此命爲減數以對減右直綫所列方積如減積不盡則有次商次商之法倍初商得數爲次商亷法對原實位書於右直綫之左【視實冇二防則初商是十有三防初商是百四防初商是千各取倍數對原列方積千百十零之位書之倍而言十者亦進位對之】截原實第二防爲次商之實【次商減積至此防止】以廉法約實爲次商數【並依除法約之】挨書於初商之下卽用次商數爲隅法亦書於廉法之下爲次商廉隅共法【省曰次商法】以與次商數相乘書其數於左直綫之左【皆以法首位所乘之進位對次商數書之若言如之數亦以○位對之法有幾位徧乘而挨書之至次防止又法先以法尾位隅法乘次商數以本位對次防書之進位上一字書之依乘法例自下而上法有幾位皆徧乘而疊進書之至次商數止亦同】命爲次商減積數以對減右直綫余積而定次商【皆減積至次防止】如減數大於余積則攺次商【亦攺隅法】如上乘減及減而止次商減積不盡則有三商

三商之法合初商次商數倍之爲廉法【簡法只以隅法加倍增入次商法內卽三商廉法】截原實第三防爲三商之實【三商減積至三防而止】余並同次商如減積不盡則有四商

四商以上並同三商法

審○位之法若次商廉法大於苐二防以上余積或數適相同是商得○位也【凡商得一數者其減積必與廉法同而多一數以爲隅故僅同者無隅積也卽不能商一數而成○位】則書○於初商之下以當次商亦增○於亷法之下爲三商亷法三商以上有○並同【若應商幾位而於初商或次商卽已減積至盡是末幾位皆商得○也俱補作○】命分之法若已商得單數而仍有餘積當以法命之【以商得方根倍之加隅一爲分母不盡之數爲分子命爲幾分之幾】𨿽未商得單數而余積甚少不能成單一數亦以法命之【前審○位云亷法大於余積者但取第二防以上相較不論千百十零其所謂不能商一數者或是一千或是一百不拘定是單一也故商○之後仍有所商與此不同】

還原法以商得方根自之有不盡者以不盡之數加入之卽得原實又簡法作直綫於左方以應減之積依並法並之必合原實有不盡數亦加入之並同除法還原

初商本位式【凡初商一二三者減積言如在本位初商一二三四者書商數於防之上一位然以書商數之位言之亦本位也兩本位法此一式中皆可明之】

假如有方田積二百五十六步問每面方若干

答曰每面方十六步

列實【作兩直綫列方積於右直綫之右】作防定位【自單位起毎隔一位作一防共兩防宜商兩次初商是十】

初商【防在實首位卽以實首位○二爲初商實以自乘數約之得一爲初商初商是一宜對防上一位書於左直綫之右有兩防初商是一十自乘一百爲減數書左綫之左遙對右行初防○二百書之就以對減初商實於二百內減一百仍余餘一百攺書之初商減積未盡有次商】

次商【倍初商一十作二十對原列方積十步位書於右綫之左爲亷法以第二防余實一五六爲次商實用亷法約實可商七步因無隅積只約六步爲次商以書於初商之下卽用六步爲隅法以書於亷法之下合亷隅共二十六步爲次商法以乘次商六步得亷積一百二十步隅積三十六步皆對次商位書起每挨一位書之至次防止共得次商減數一百五十六以對減余實恰盡】共開得平方根一十六步合問

甲乙丙丁四形合爲正方形【四面皆一十六步】甲分形正方【四而皆十步積一百步卽初商積】丙丁二分形皆長方【廣六步長十步積六十步兩形共積

一百二十步卽次商廉積】

乙小分形亦正方【面皆六步積三十六步卽次商隅積】自乘還原法置方一十六步爲實卽以

十六步爲法乘之得二百五十六步合

原數

初商進位式【凡初商四五六七八九減積言十在進位初商五六七八九書商數於防之上兩位凡書商數以防上一位爲本位則此其進位也兩進位法此一式中皆有之】

假如方積三十五萬八千八百零一尺問方若干答曰方五百九十九步

列位【同前】

作防定位【有三防宜商三次初商是百】

初商【防在實次位卽合兩位三五爲初商實入表表中有小於三五者是二五其方根五卽以五爲初商數對實初防上兩位書左直綫之右又卽以表中自乘數二五遙對實三五書於左直綫之左就以對減初商實餘一○攺書之以待次商】

次商【倍初商五百作一千○百對實千百位書於右直綫之左爲亷法以第二防上余實一○八八爲次商實用亷法約之得九爲次商續書於初商之下卽以次商九爲隅法書亷法之下合亷隅共一○九爲次商法以乘次商九得亷積九隅積八一對次商位書起至次防止共得減數九萬八千一百以減次商實餘一○七攺書之以待三商】三商【以次商隅法九十倍作一百八十於次商法一千之下抹去○九攺書一八共一一入爲亷法以第三防上余積一○七○一爲三商實用亷法約之得九爲三商續書於次商下卽以三商九爲隅法書於亷法之下合亷隅共一一八九爲三商法以乘三商九步得亷積一萬○六百二十隅積八十一對三商位書起至第三防止共得減數一萬○七百○一以對減三商實恰盡】凡開得方根五百九十九尺

初商甲【方五百尺積二十五萬尺】次商【丁戊】二亷【各長五百尺濶九十尺共積九萬尺】隅乙【方九十尺積八千一百尺】

三商【已庚】二亷【各長五百九十尺濶九尺共積一萬○六

百二十尺】隅丙【方九尺積八十一尺】七形合成正方共積【三十五萬八千八百○一○】

商○位式

假如方積八十二萬六千二百八十一尺問方若干答曰九百○九尺

列位

作防定位【並同前條】

初商【防在次位合兩位八二爲初商實表入表得八一小於八二其方根九卽爲初商在五以上對初防上兩位書之亦以表數八一對實八二書於左綫之左以減初商實余○一攺書之以待次商】

次商【倍初商九百作一千八百對原實位書之爲亷法以第三防上余實○一六二爲次商實以亷法約之法大實小不能商一數是商得○位也紀○於初商之下卽於實首位銷去一○余俟三商】

三商【因次商是○增○於廉法之下共一八○爲亷法以第三防上余實一六二八一爲三商實用亷法約實得九尺爲三商書於次商○之下卽以九爲隅法書於亷法之下共亷隅法一八○九以乘三商九得亷積一萬六千二百隅積八十一減三商實恰盡】凡開得方根九百○九尺

計開

初商方九百尺積八十一萬尺

續商亷【各濶九尺長九百尺】共積【一萬六千二百尺】隅方九尺積【八十一尺】通共八十二萬六千二百八十一尺

假如方積二十五億○七百○○萬四千九百尺問方若干答曰五萬○七十尺

列位【原積尾位是百補作兩○列之】作定位【有五防當商五次初商是萬】

初商【以實首兩位二五爲初商實入表得五爲初商書於防上兩位次以自乘數對實列之相減盡】次商【倍初商五萬尺得一十○萬爲亷法對原實位書之以第二防上余實○○○七爲次商實實有三○無可商是次商○也書○於初商五之下亦於實首銷去一○以待三商】

三商【因次商○增○於亷法下得一○○爲亷法以第三防上余實○○七○○爲三商實實仍有兩○位是三商亦○也又書○於次商○之下於實首復銷去一○以待四商】

四商【因三商亦○又增○於亷法之下得一○○○爲亷法以第四防上○七○○四九爲四商實用亷法約之得七十尺書於三商○之下卽以七爲隅法增於亷法下共亷隅法一○○○七以乘四商七得亷積七百萬隅積四千九百以對減四商實恰盡】

五商【五防宜有五商而四商已減實盡無可商作○於四商】

凡開得方根五萬○○七十○尺

命分式

假如方積五百七十六萬四千八百尺問方根若干答曰二千四百尺【又四千八百○一分尺之四千八百】

列位【實盡於百位如前法補作兩圏列之】作防定位【有四防宜商四次初商是千】

初商【以實首○五爲初商實入表得二爲初商以自乘數○四減實○五攺書餘一以待次商】次商【倍初商二千得四千爲亷法以第二防上余實一七六爲次商實用廉法約之得四爲次商卽以爲隅法書廉法下共亷隅法四四以乘次商四得亷積一百六十萬隅積一十六萬共減積一百七十六萬次商實減盡】

三商【倍次商隅法四作八增入次商法共四八爲三商亷法以第三防上余實○○四八爲三商實有兩○無可商作○於三商位消去實首一○以待四商】

四商【三商○亦增○於亷法下共四八○爲亷法以第四防上余實○四八○○爲四商實僅與亷法相同是無隅積也不能商一數作○於四商位其不盡之數以法命之法以亷法四千八百○加隅一共四千八百○一爲命分之母以不盡之數四千八百爲分子命爲四千八百○一分尺之四千八百卽一尺弱也】

共開得平方二千四百尺又四千八百○一之四千八百

此𨿽未開至單尺之位而余實甚少不能成一單尺故卽以法命之若余實是四千八百○一尺則商得平方二千四百○一尺矣今止四千八百尺是少一尺故不能成一單尺也

開方分秒【凡開方欲知分秒法於余實下毎增兩○位則多開一位爲分秒之數平方之積尺有百寸寸有百分皆以百爲母故增兩○】

假如有平方積二十四尺平方開之得方四尺不盡八尺問分秒若干答曰方四尺零八寸九分八釐九毫有奇

如常列位作防防在次位卽以

二四兩位合商得方四尺減其

自乘一十六尺餘八尺用命分

法以商四尺倍作八尺又加隅

一得九爲命分母不盡爲分子

命爲方四尺又九分尺之八

今欲知其寸【九分尺之八者是以尺作九分而今有其八言毎方四尺之外仍此畸零是其中有寸】法於余實下加兩○化八尺爲八百寸【毎尺縱橫十寸故其積百寸】用爲次商實以初商四尺倍之得八尺亦化八十寸【商數是毎邊之數故尺只十寸】對余實十寸位書之【卽第一○位】爲亷法用廉法約實可商九寸因恐無隅積只商八寸書於初商四尺之下亦卽以次商八寸爲隅法書於廉法八十寸之下共亷隅八十八寸以乘次商八寸得亷積六百四十寸隅積六十四寸共亷隅積七百○四寸自次商位書起至第二○位止以對減余實仍餘九十六寸命爲奇數

凡商得毎方四尺八寸有奇

再求其分

法於實下又加兩○以餘九十六寸化九千六百分【解見上】爲三商實商數四尺八寸亦化四百八十分倍之爲九百六十分移對余實百分十分之位書之爲亷法以亷法約實商得九分爲三商書次商之下亦卽以三商九分爲隅法書於亷法九百六十分之下共亷隅九百六十九分以乘三商九分得亷積八千六百四十分隅積八十一分共積八千七百二十一分自三商位書起至第四○位止以對減余實仍餘八百七十九分命爲奇數

凡商得每方四尺八寸九分有奇

再求其釐

法於余實下又加兩○以餘八百七十九分化八萬七千九百釐爲四商實次倍商數四尺八寸九分作九尺七寸八分化爲九千七百八十釐移對余實依千百十之位書之爲亷法用亷法約實得八釐爲四商書於三商之下卽以四商八爲隅法增於亷法末共亷隅法九千七百八十八釐以乘四商八釐得亷積七萬八千二百四十釐隅積六十四釐自四商位書起至第六○位止以減余實仍餘九千五百九十六釐

凡商得每方四尺八寸九分八釐有奇

再求其毫

如法於余實下又加兩○化余實爲九十五萬九千六百毫爲五商實次倍商數四八九八作九尺七寸九分六釐化爲九萬七千九百六十毫爲亷法移對余實萬千百十之位書之用亷法約實得九毫爲五商書四商下亦卽以五商九爲隅法增入亷法下共亷隅九萬七千九百六十九毫以乘五商九毫得亷積八十八萬一千六百四十毫隅積八十一毫對五商位書起至第八○位止以減余實仍餘七萬七千八百七十九毫

凡商得方四尺八寸九分八釐九毫又九萬七千九百七十九之七萬七千八百七十九卽奇數也

右單數下已開四位【尺爲單位析爲寸分釐毫凡四位】其不盡者是不滿一毫之數於單數爲十萬分之一【如欲再求忽微亦如上法】

開方縱【縱者長方形也以方爲濶加縱數爲長其法與方無異但須以商得數乘縱數爲縱積並入方積以減原積不及減者攺商之其次商亦倍初商加縱爲亷法但倍方而不倍縱三商以上並同】

假如有長田積六百二十四步濶不及長二步問長濶各若干答曰長二十六步濶二十四步

列位【以實列右綫之右以縱二步列右綫之左對實步位列之】

如常作防定位

初商【以○六爲初商實商得二十步自乘應減方積四百步又以商數乘縱二步得縱積四十步如法列之以減原實仍餘一百八十四步】

次商【倍初商二十步作四十步加縱二步共四十二步爲亷法以約余實得商四步卽以爲隅法合亷隅縱共四十六用乘次商四得亷積一百六十步隅積十六步縱積八步共減積一百八十四步恰盡】命爲濶二十四步

加縱二步爲長二十六步

合問

以圖明之

甲爲初商方形【長濶各二十步積四十步】已初商縱形【濶二步長亦二十步積四十步】戊丙並次商廉【長各二十步濶四步積八十步】乙次商隅【方四步積一十六步】丁次商縱亷【長四步濶二步積八步

以上五者合之爲一長方形共長二十六步濶二十四步

積六百二十四步合原數】

若縱數有比例可求者先以比例分其積平方開之得濶因以知長

假如有直田積四百五十步但雲長多濶一倍問長濶若干

答曰濶十五步長三十步

法平分其積得二百二十五步平方開之得濶十五步

置濶十五步倍之得長三十步合問

假如有長田積二百五十二步但雲長比濶多四分之三問長若干

答曰濶一十二步長二十一步

法以多三分加分母四共七爲法以分母四乘積爲實法除實得一百四十四步開方得濶一十二步置濶一十二步七因四除之得二十一步爲長【長比濶多九步於十二步爲四分之三】

開立方法

平方者方田之屬也但取面羃之積立方者方倉之屬也必求其內容之積故平方曰面立方曰體有面而後有體有綫而後有面故皆以綫爲根

假如長二尺者綫數也綫有長短而無廣狹若以此綫橫展之長亦二尺濶亦二尺則其積四尺爲面面者平方形也面有濶狹而無厚薄又以此面層累而厚之長濶皆二尺髙亦二尺則其積八尺爲體體者立方形也立方有虛有實如築方臺則實鑿方池作方窖則虛然其立方之積數一也

法先立位【同平方】作防【自單位起每隔二位防之以最上一防爲初商實】定位【視有若干防則商幾位如有二防則商數有十有五防則商數有百並同平方】

初商法以自乘再乘數約而商之【如一商一八商二二七商三之類】書商數於左綫之右【凡商得一數者書於防上一位商得二三四五者書於防上兩位商得六七八九者書於防上三位】卽以自乘再乘數書於左綫之左以對減初商實【初商減積至初防止】

次商法以初商自乘而三之爲平亷法【亦曰方法】以初商三之爲長亷法【亦曰亷法】皆對原實千百位書之截第二防上余實爲次商實【次商減積至次防止】以平亷法約實得次商【列初商下】卽以次商爲隅法列長亷次【亦按千百位列之】乃以次商乘平亷法爲平亷積又以次商自乘以乘長亷及隅法爲長亷小隅積俱挨書之以減余積不及減者攺商

三商法以余實另列之合初商次商自乘而三之爲平亷法合初商次商三之爲長亷法截第三防上余實爲三商實【三商減積至此防止】亦卽以三商爲隅法【余並同前】

四商以上並同三商

命分法合平亷長亷法再加隅一爲命分母不盡之數爲命分子【並同平方】

還原法置商數自乘得數再以商數乘之卽合原實【有不盡者以不盡之數加入之】

初商表【用法與平方表同】

假如立方積五千八百三十二尺問方若干

答曰方一十八尺

列實

作防定位【有兩防初商是十】

初商【以五千爲初商實約商一十自乘再乘得一千爲應減積減原實餘四千】

次商【以初商自乘而三之得三百爲平亷法又以初商三之得三十爲長亷法以平亷法約第二防上余實得八尺爲次商卽以爲隅法並如法列之乃以次商乘平亷法得二千四百爲平亷積又以次商自乘得六十四以乘長亷及隅法得長廉一千九百二十隅積五百一十二共減積四千八百三十二恰盡】

以圖明之

甲爲初商方形【長濶皆十尺積一千尺】乙爲次商平亷凡三以輔於

方之三面【長濶皆十尺厚八尺積八百尺共積

二千四百尺】

丙爲次商長亷亦三以輔三

平亷之隙【長十尺濶與厚皆八尺積六百四十

尺共積一千九百二十尺】

丁爲次商隅如小立方以補三長亷之隙【長濶髙皆八尺積五百一十二尺】

假如立方積二千二百五十九億七千七百八十一萬一千五百七十尺問方根若干答曰方六千零九十尺【又一億一千一百二十八萬二千五百七十一之一億一千一百二十八萬二千五百七十】

列實【實尾無單位補作○】作防定位【有四防初

商是】

千

初商【合實三位約之商六千對初防上三位列之以六千自乘再乘得減積二千一百六十億其餘積攺書以待次商】

次商【日乘初商而三之得一億○八百萬爲平亷法以初商三之得一萬八千爲長亷法各對原實位列之以第二防上余實爲次商實實首有兩○無可商是次商○也作○於初商之下卽於實首消去兩○余俟三商】

三商【次商○卽以次商法爲三商法以第三防上余實爲三商實以平亷法約之商九十尺卽以爲隅法對實十位列之乃以九十乘平亷法得平亷積九十七億二千萬又以九十自乘得八千一百以乘長亷及隅法得長亷積一億四千五百八十萬隅積七十二萬九千共減積九十八億六千六百五十二萬九千】

四商【以第四防上余實另列之合三次商數六○九自乘而三之得一億一千一百二十六萬四千三百爲平亷

法又以六○九三之得一萬八千二百

七十爲長亷法以法約實僅與兩亷法

之數相同無隅積不能成一單數以法命

之合平廉長亷數加隅一爲命分母余實

爲命分子】

命爲立方六千○九十尺又【一億一千一百二十八萬二千五百七十一尺之一億一千一百二十八萬二千五百七十】

自乘

再乘

歷算全書卷三十八﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

比例規用法假如原序

康熙癸未季弟爾素有比例規用法假如之作又五年丁亥重加挍錄示予屬爲序序曰形而上者不可得而數有數可數卽有象可見故算法量法理本相通而尺可爲算器也曆書中有書一卷耑明尺算謂之比例規觧比例云者謂以尺中原有之兩數求今所問之兩數以例相比如古者異乘同除及西人三率之法而有尺以著其象則不煩言說乃作者之意也規云者謂以銅鐵爲規器兩髀翕張用其末鋭分指兩尺上同數以得橫距而命得數則用尺之法也規本畫圓之器於尺爲借用故仍其名曰規本觧有作法用法惜無設例罕能用者攜李陳獻可藎謨補作例祗平分一綫而已龍舒方位白中通作數度衍以橫尺取數而不用規亦惟平分一綫夫平分用止乘除聊足以明異乘同除之理而尺算之善不盡於是若乃平方立方分圓輕重諸術其求法多不以異乘同除爲用而數變爲綫爰生比例卽盡歸於異乘同除此其所長也又規端取數毫犛可辧而防移進退簡快靈妙橫距𨿽無數而取諸本尺其則不逺固勝橫尺矣吾弟此書仍其用規本法自平分以下十綫一一爲之用例以明之原書謬誤稍爲刋正然後其書可得而用爲功於度數之學不小也憶嵗乙夘余始購得曆書抄本於吳門姚氏偶缺是觧至戊午秋介亡友黃兪邰太史虞稷借到皖江劉潛柱先生本抄補之蓋逾時而後能通其條貫以是正其訛闕又次年己未始爲山陰友人何奕美作尺亦稍以己意增損推廣之而未暇爲立假如今得爾素是書可以無作矣勿庵兄文鼎序

【方爾素撰此書時安溪相國以冢宰開府上谷公子世得鐘倫鋭意歷算之學余兄弟及兒以燕下榻芝軒與諸同學晨夕問難甚相得也無何爾素挈兒燕南歸相國入參密勿而世得亡兒相繼化去余亦大病濱死然猶能偸視息至今日爲爾素序此書不可謂非不幸中幸也憶爾素六十時余有句云如稼觀登塲如行將百里何以収桑楡無爲所生恥今當相與念玆弗替爾勿庵又識】

凡例

按西士羅雅谷自序謂譯書艸創潤色之增補之必有其時今之釋例不嫌小有同異所以相成當亦作書者之所欲得也

比例規觧原列十綫爲十種比例之法今仍之比例旣有十種可各爲一尺今總歸一尺者便攜也一尺中列十綫則一尺而有十尺之用恐其不淸故各綫之端書某綫以別之

各綫並從心起數惟立方綫初防最大割綫亦然又五金綫之用近尺末故俱不到心以便他綫之書字然其實並從心起算用者詳之【尺心卽尺端也兩尺端聫於樞心成一防故從玆起算】

欽定四庫全書

歷算全書卷三十九

宣城梅文鼎撰

目錄

第一平分綫

第二平方綫【原名分面】

第三更面綫【原名變面】

第四立方綫【原名分體】

第五更體綫【原名變體】

第六割圓綫

第七正綫【舊名節气】

第八切綫【舊名時刻】

第九割綫【舊名表心】

第十五金綫【附三綫比例】

以上十綫並如舊式惟平方立方攺從古名取其易曉又正攺附割圓切綫分爲時刻取其便用割綫去表心之目以正其名免悞用也說見各條之下

又按羅序言此器百種技藝無不賴之功倍用防爲造瑪得瑪第嘉之津梁然則彼中借此制器如工師之用矩尺則日晷等制並其恆業乃書中圖說反有參錯非故爲靳祕也良由仿造者眾未必深知法意爰致承訛抑或譯書時語言不能盡解而彊以意通遂多筆誤耳今於其似是而非之處徹底釐淸以合測量正理起立法之人於九京必當莫逆

比例尺式【卽度數尺也原名比例規以兩尺可開可合有似作圓之器故亦可云規】

用薄銅板或厚紙或堅木【黃楊木等】作兩長股如圖任長一尺上下廣如長八之一兩股等長等廣股首上角爲樞以樞心爲心從心出各直綫以尺大小定綫數今折中作五綫兩股兩面共十綫可用十種比例之法綫行相距之地取足書字而止尺首半規餘地以固樞也用時張翕防移

比例尺又式

前式兩股相疊此式兩股相並股上兩用之際以爲心規餘地以安樞其一規面與尺面平而空其中其一剡規而入於彼尺之空令宻無罅也樞欲其無偏也兩尺並欲其無罅也樞心爲心與兩尺之合綫欲其中繩也張盡令兩首相就成一直綫可作長尺或以兩尺橫直相得成一方角可作矩尺

規式【此本爲畫圓之器尺算賴之以取底數蓋相湏爲用者也】

用銅或鐡亦如尺作兩股但尺式扁方此可圓也首爲樞可張可翕末鋭以便於尺上取數也當其半腰綴一銅條橫貫之勢曲而長如割圓象限之弧與樞相應得數後用螺釘固之

凡算例假如有言取某數爲底綫者並以規之兩鋭於平分綫上量而得之其用底綫爲得數者並以規取兩尺上綫相等之距於平分綫上量而命之故規之兩鋭可當橫尺數度衍以橫尺比量反不如用規之便利而得數且眞也

第一平分綫

此綫爲諸綫之根取數貴多尺大可作一千然過宻又恐其不淸也故以二百爲率

分法如設一直綫欲作百分先平分之爲二又平分之爲四又於每一分內各五分之則已成二十分矣於是用更分法取元分四攺爲五分【如甲乙丙有丙戊丁三防是元分之四也今復勻作五分加己庚辛壬四防】則元分與次分之較【如壬丙及巳戊】皆元分五之一亦卽設綫百分之一分凖此爲度而周布之卽百分以成

解曰元分爲設綫百分爲二十分之一卽每一分內函五分也今壬丙己戊旣皆五分之一則甲壬己乙皆五分之四亦卽百分之四也又丙辛庚戊皆三而辛丁丁庚皆二也任用一度參差作防互相攷訂卽成百分勻度矣【每數至十至百皆作字記之】或取元分六復五分之亦同何則元分一內函五分則元分四共函二十分故可以五分之若元分六卽共函三十分故亦可五分之其理一也

用法一凡設一直綫任欲作幾分假如四分卽以規量設綫爲度而數兩尺之各一百以爲乃張尺以就度令設綫度爲兩之底置尺【置尺者置不復動故亦可云定尺下仿此】數兩尺之各二十五以爲斂規取二十五兩防間之底以爲度卽所求分數【卽四分中一分也以此爲度而分其綫卽成四分】若求極微分如一百之一如上以一百爲設綫爲底置尺次以九十九爲取底比設綫其較爲百之一若欲設綫內取零數如七之三卽以七十爲設綫爲底置尺次以三十爲斂規取底卽設綫七之三

謹按尺算上兩等邊三角形分之卽兩句股也兩句聫爲一綫而在下直謂之底宜也若兩尺上數原系斜攺而稱腰於義無取今直正其名曰

用法二凡有綫求幾倍之以十爲設綫爲底置尺如求七倍以七十爲取底卽元綫之七倍若求十四倍則倍得綫或先取十倍更取四倍並之

用法三有兩直綫欲定其比例以大綫爲尺末之數【尺百卽百千卽千】置尺斂規取小綫度於尺上進退就其兩等數如大綫爲一百小綫爲三十七卽兩綫之比例若一百與三十七可約者約之【約法以兩大數約爲兩小數其比例不異如一百與三十約爲十與三】

用法四有兩數求相乘假如以七乘十三先以十防爲取十三防爲底置尺次檢七十之等取其底得九十一爲所求乘數【若以十爲七爲底置尺而檢一百三十防之底得數亦同】

【論曰乘法與倍法相通故以七乘十三是以十三之數七倍之是七个十三也以十三乘七是以七數十三倍之是十三个七也故得數並同】

用法五有兩數求相除假如有數九十一七人分之卽以本綫七十爲取九十一爲底置尺次檢十防之取底必得十三爲所求

又法以九十一爲用規取七十爲底置尺斂規取一十爲底進退求其等亦得十三如所求

【論曰算家最重法實今當以七人爲法所分九十一數爲實乃前法以法數七爲實數九十一爲底又法反之而所得並同何也曰異乘同除以先有之兩率爲比例算今有之兩率𨿽曰三率實四率也徴之於尺則大與大底小與小底兩兩相比明明四率較若列睂故先有之兩率當則今所求者在底是以之比例例底也若先有之率當底則今所求者在是以底之例例也但四率中原缺一率比而得之固不必先審法實殊爲簡易矣】

【然則乘除一法乎曰凡四率中所缺之一率求而得之謂之得數乘則先缺者必大數也故得亦大數除則先缺者必小數也故得亦小數所不同者此耳是故乘除皆有四率得尺算而其理愈明亦諸家所未發也】

假如有銀九十六兩四人分之法以人數取四十分爲底置銀數九十六兩爲定尺斂規取一十分爲底進退求其等得二十四兩爲每人得數

又法取銀數九十六兩爲底置一百分爲定尺斂規於二十五分等取其底亦得二十四兩爲每人數

又如有數一百二十三欲折取三分之一法以規取三十分爲底置一百二十三等數爲兩定尺斂規取一十數爲底進退求其等數爲必得四十一命爲三分之一如所求

用法六凡所求數大尺所不能具則退位取之假如有數一百二十欲加五倍卽退一位取一十二爲底以尺之一十防爲兩定尺取兩五十防之底【卽五倍】得六十進一位命所得爲六百【以一十二當一百二十是一而當十故進位命之也凡用尺算湏得此通融之法】

又法以規取一十數爲底於尺之一十二防爲兩【一十二以當一百二十是一當十也或二十四亦可爲一當五】定尺展規取五十數【以當五倍】爲底進退求其等數之必得六十進位成六百

假如有銀十三兩每兩換錢一千二百文法退二位以規取十二分【當一千二百以尺上一數當一百】爲底置一十防【卽每兩之位】爲定尺然後尋一百三十防【卽十三兩之位】爲展規取其底得一百五十六分進二位命之得共錢一十五千六百

又如有銀四兩每兩換錢九百六十文法作兩次乘先乘六十取六數爲底置一十防爲定尺展規取四十防之底得二十四次乘九百取九數爲底置一十防爲定尺展規取四十防之底得三十六進一位並之得三八四末增一○爲進位得三千八百四十文

【二四三六】

因每兩是九百六十故末位增○

【三八四○千百十文】

假如有數一百二十欲折取三分之一法以規取六十【折半法也】爲底置九十分爲定尺然後尋兩之三十分防【卽三之一】取其底於本綫比之必二十命所得爲四十【加倍法也先折半故得數加倍】凡所用數在一十防以內近心難用則進位取之如前條所設宜用六數九數爲底其防近心取數難淸卽進位作六十取數用之是進一位也但先進一位者得數後卽退一位命其數此可於前假如中詳之【用尺時有退位得數後進位命其數用尺時有進位得數後退位命其數其理相通故不另立假如】或先進二位者得數亦退二位或先加倍者得數折半並同一法

用法七

凡四率法有中兩率同數者謂

之連比例假如有大數【三十六】小

數【二十四】再求一小數與此兩數

爲連比例法以大數爲【如辛甲】小數爲底【如辛巳】定尺再以辛巳

底爲【如甲丁】而取其底【如丁戊】其

數必【十六】則三十六與念四之比

例若念四與十六也【其比例爲三分損一】若先有小數【十六】大數【二十四】而求連比例之大數則以小數爲底【如丁戊】大數爲【如丁甲】定尺再以丁甲爲底【如辛巳】取其【如辛甲】其數必三十六則十六與念四若念四與三十六也【其比例爲三分增一】他皆仿此【原書有斷比例法今按斷比例卽古法之異乘同除西法謂之三率前各條中用尺取數皆異乘同除之法故不更立例】

用法八

凡句股形有句有股有共

三件先有兩件而求其不知

之一件法以尺作正角取之

假如有句【八尺】股【十五尺】欲知其

法以規量取八十防爲底

一端指尺上之六十四防一

端指又一尺之四十八防以

定尺則尺成正角乃於尺上

取八十防爲句又於一尺上

取一百五十防爲股張規以就所識句股之兩防必一百七十退一位得十七尺如所求【取句股數時原進一位故所得數退一位命之說見前】

若先有【十七尺】股【十五尺】求其句則以規取一百七十防爲句股之乃以規端指一百五十防以餘一端又於一尺上尋所指之防必八十也如上退位得句八尺或先有【十七尺】句【八尺】求其股亦以規取【一百七十】而一端指【八十】尋又一端之所指必得【一百五十】命【一十五尺】爲股如所求

凡雜三角形內無正角不可以句股

算法先作角假如先有一角及角

旁之兩邊求餘一邊法於平分綫

【任用一籩如甲乙】取數爲底分圓綫【六十】度爲

兩定尺以規取所設角之底【爲平分綫上任用甲乙邊等度之底】定尺則尺間角如所設【如乙角】乃於兩尺上依所設取角旁兩邊之數於兩尺各作識【如甲乙丙乙】遂用規取斜距之底【如甲丙】卽得餘一邊如所求

又法假如乙甲丙三角

形有甲角【五十三度○七分】甲乙

邊【五十六尺】甲丙邊【七十五尺】而求

乙丙邊法以規取一百分

爲分圓綫上六十度之底斂規取五十三度彊之底移於平分綫上作百分之底定尺乃於尺上取五十六防【如甲乙】又一尺上取七十五防【如甲丙】乃以規取兩防斜距之底於尺上較之卽得六十一尺【如乙丙】命爲所求邊【分圓綫見後】

用法十有小圖欲攺作大幾倍之圖用前倍法假如有小圖濶一尺二寸今欲展作五倍卽取十二爲十防之底定尺展規取五十防之底必得六十命爲六尺如所求

用法十一平圓形周徑相求法於平分綫上作兩識以一百八十八半弱上爲周六十爲徑各書其號假如有徑【七十一】求周法以規取七十一加於徑防爲底定尺展規取周防之底卽得周二百二十三如所求【以周求徑反此用之】

用法十二求理分中末綫法於綫上定三防於九十

六定全分五十九又三之一

爲大分三十六又三之二爲

小分假如有一直綫【一百四十四】欲分中末綫卽以設綫加於

全分防爲底取其大小分防之底卽得【八十九彊】爲大分【五十五弱】爲小分

【按平綫上旣作周徑之號若又作此則太繁不如另作一綫其上可寄五金綫也又按原書全分七十二大分四十二又三之一小分二十七又三之二大有訛錯今攺定】

以上十二用法姑舉其槪其實平分綫之用不止於是善用者自知之耳

第二平方綫【舊名分面綫凡平方形有積有邊積謂之冪亦謂之面邊綫亦謂之根卽開平方法也】

原爲一百不平分今按若尺小欲其淸則但爲五十分亦可假如有積六千四百則以平分綫之二十自乘得四百於積爲十六倍之一若置二十分於一防爲底求十六防之底則得方根八十或置於二防爲底則求三十二防之底或置於三防爲底則求四十八防之底皆同

分法有二以算一以量

以算分

算法者自樞心【甲】任定一度命爲十分【如甲乙】卽平方積一百分之根今求加倍平方二百分之根爲十四又念九之四卽於甲乙綫上加四分彊【如丙】命甲丙爲倍積之根求三倍則開平方三百分之根得十七又三十五之十一卽又於甲乙綫上加十分半弱【如丁】卽甲丁爲三倍積之根求四倍則平方四百之根二十卽以甲乙倍之得甲戊爲四倍積之根五六七以上並同【按用方根表甚簡易】

以量分

以任取之甲乙度作正方形【如丙乙甲】乃於乙甲橫邊引長之以當積數丙乙直邊引長之作垂綫以當根數如求倍

積之根卽於橫

綫上截丁乙爲

甲乙之倍次平

分甲丁於戊戊爲心甲爲界作半圈截垂綫於巳卽己乙爲二百分之邊求三倍則乙丁三倍於甲乙四倍以上並同又防法如前作句股形法定兩尺間成正方角如甲乃任於尺上取甲乙命爲一防而又於一尺取甲丙度與甲乙相等卽皆爲一百之根次取乙丙底加於甲乙

尺上爲二百之根甲丁又自丁至丙作

斜以加於甲乙尺上爲三百之根甲

戊又自戊至丙作以加於甲乙尺上

爲四百之根甲已如此遞加卽得各方

之根其加法俱從尺心起【如求得丙乙卽以丙加甲乙加丁成甲丁他皆仿此】

試法甲乙爲一正方形之邊倍其度卽四倍方積之邊否卽不合三倍得九倍方積之邊四倍得十六五倍得二十五又取三倍之邊倍之卽十二倍之邊【四其三也】再加一倍得二十七倍之邊【九其三也】再加倍得四十八倍之邊【十六其三也】再加倍得七十五倍之邊【二十五其三也】若以五倍之邊倍之得二十倍之邊【四其五也】再加倍得四十五倍之邊【九其五也】再加倍得八十倍之邊【十六其五也凡言倍其度者綫上度也如正方四百分之邊二十分甲乙正方一百分之邊十分其大爲一倍也言幾倍方積者積數也如邊二十者積四百卽尺上所書】

用法一有平方積求其邊【卽開平方】法先其設數與某數能相爲比例得幾倍如法求之假如有平方積一千二百

二十五尺欲求其根以約分法求得

二十五爲設數四十九之一卽以規

於平分綫取五防爲平方綫上一防

之底定尺展規於四十九防取其底

卽得一邊三十五尺爲平方根【積二十五方根五加四十九倍爲積一千二百二十五方根三十五】或用四十九爲設數【一千二百二十五尺】二十五之一卽以規取七防爲平方一防之底而取平方二十五防之底亦得方根三十五如所求【積四十九方根七加二十五倍爲積一千二百二十五則其方根三十五又法若無比例可求者但以十分爲一防之底定尺有假如在用法七】

用法二凡同類之平面形可並爲一大形【或方或圓或三角多邊等形但形相似卽爲同類】假如有平面正方四形求作一大正方形與之等積其第一形之冪積爲二第二形之積爲三第三形之積四有半第四形之積六又四之三法先並其積得【十六叉四之一】乃任取第一小形之邊爲

底二防爲定尺【若用第二形之邊爲底定尺卽用三防爲】而於十六防又四之一取其底爲大形邊其面積與四形總數等

若但有同類之形而不知面積亦

不知邊數則先求其積之比例如

甲乙丙丁方形四法以小形甲之

邊爲底平方綫第一防爲定尺

次以乙形邊爲底進退求等數得

第二防外又五分之一卽命其積

爲二又五之一【此與小形一之比例不拘丈尺】次

丙形邊爲底求得【二又四之三】丁形邊

得【四又六之五】並諸數及甲形一得【十又

六十分之四十七】約爲【五之四弱】向元定尺上

尋十防外十一防內之距取其五

之四爲等數之兩【卽十一弱】用其底

爲大方形邊其面積與四形並數

等

【此加形法也圓面及三角等面凡相似之形並可相並其法同上】

用法三平面形求作一同類之他形大於設形幾倍

【以設形之邊爲一防之底定尺】假如有正方形面

積四百其邊二十今求別作一方形

其容積大九倍法以設形邊【二十】爲平

方綫一防之底定尺而取平方九防等數之底得【六十】如所求【邊六十其方積三千六百以比設形積爲大九倍】

用法四平面形求別作一同類之形爲設形幾分之幾【以設形之邊爲命分定尺而於得分取數】假如有平方形積三千六百其邊六十今求作小形爲設形九之四法以設形邊【六十】爲平方第九防之底定尺而取第四防之底得【四十】如所求【邊四十其積一千六百以比設形積爲九之四也九爲命分四爲得分】此減積法也圓面三角等俱同一法

用法五有兩數求中比例【卽三率連比例之第二率】

假如有二與八兩數求其中比例法先以大數爲平方綫八防之底而取二防之底得四如所求

二與四如四與八皆加倍之比例故四爲二與八之中率

用法六有長方形求作正方形假如長方形橫二尺直八尺如上圖求得中比例之數爲四尺以作正方形之邊則其面積與直形等

直八尺橫二尺其積一十六尺

方形各邊並四尺其積亦十六尺

用法七有設積求其方根而不能與他數爲比例則以一十數爲比例

假如平積二百五十五用十數比之爲二十五倍半卽取十數爲平方綫一防之底而取二十五防半之底得十六弱爲方根【十六自乘積二百五十六今只欠一小數故命之爲十六弱】

第三更面綫

【凡平面形方必中矩圓必中規其餘各形並等邊等角故皆爲有法之形而可以相求】

分法

置公積四三二九六四以開方得正方形之根六五八三邊形之根一千五邊形之根五○二六邊形之根四○八七邊形之根三四五八邊形之根二九九九邊形之根二六○十邊形之根二三七十一邊形之根二一四十二邊形之根一九七圜徑七四二以本綫爲千平分而取各類之數從心至末取各數加本類之號

用法一有平面積求各類之根【凡三角及多邊各平面形其邊旣等故並以形之一邊爲根圓形則以徑爲根】法先以設數於平方綫上求其正方根以此爲度於更面綫之正方號爲底定尺次於各形之號取底卽得所求各形邊

假如有平面三等邊形積二千七百七十一寸欲求其邊法以設積於平方綫上如法開其平方根【依前卷用法七以設數爲十數之二百七十七倍彊各降一位命爲一數之二十七倍又十之七彊乃以一數爲平方一防之底定尺而於其二十七防十之七彊取底數得五寸二六進一位作五尺二寸半彊】以所得方根爲更面綫正方號之底定尺而取三等邊號之底得八尺爲三等邊形根如所求

用法二有平面形不同類欲相並爲一大形法先以各形邊爲更面綫上各本號之底定尺而取其正方號之底作綫爲所變正方形之邊次以所變方邊於分面綫上求其積數而並之爲總積

假如有甲【三角】乙【五邊】丙三形欲相並先以甲邊爲三角號之底定尺而取其正方號之底作綫於甲形內【如此則甲形已變爲正方下同】書其數曰十次以乙邊爲五邊號之底如前取其平方底向平方綫求之得二十一半【其法以甲

邊爲平方十防之底定尺而以乙所變方邊進退求等度之命之】卽

於乙形作方底綫書之次以丙圓徑

爲平圓號之底如前求得十六弱並

三數得四十七半弱爲總積【此因三形之邊

無數姑以小形命十數定尺而所得各方積並小形十數之比例】若三形內先知一形之面積卽用其

所變方邊定尺則所得皆眞數如上

三形但知丙形之積十六【或十六尺或十六寸】

【等】如法以丙形邊變方邊於平方綫十六防爲底定尺餘如上法求之亦必得甲爲十數乙爲二十一半總積四十七半但前條所得是比例之數比例𨿽同而尺有大小故以此所得爲眞數也

末以總數於原定尺上尋平方綫四十七防半處取其底度爲平方邊則此大平方形與三形面積等若欲以總積爲五邊形則以所得大平方邊爲更面綫正方號之底定尺而於五邊形之號取其底卽所求五邊形之一邊【若欲作三角或圓形並同一法】

用法三有平面形欲變爲他形如上法以本形邊爲本號之底定尺而取所求他形號之底

假如有三角形欲攺平圓則以所設三角形之邊加於本尺三角形之號爲底定尺而取平圓號之底求其數命爲平圓徑所作平圓必與所設三角形同積

用法四有兩平面形不同類欲定其相較之比例如前法各以所設形變爲平方

假如有六邊形有圓形相較卽如法各變爲平方求其數平圓數二十六邊數三十六卽平員爲六邊形三十六之二十以二十減三十六得十六爲兩形之較

第四立方綫【舊名分體綫凡平方形如棊局其四邊橫直相等而無髙與厚之數立方則如方櫃有橫有直又有髙而皆相等平方之積曰平積亦曰面積亦曰冪積如棊局中之細分方罫立方之積曰體積亦曰立積並如骰子之積累成方】

【舊圖誤以尺樞心甲書於一防上今攺正甲乙一亦卽一十則其內細數亦不平分舊圖作十平分亦誤今刪去】

分法有二一以算一以量

以算分從尺心甲任定一防爲乙則甲乙之度當十分邊之積爲一千【十分自乘之再乘之卽成一千假如立方一尺其積必千寸】紀其號曰一次加一倍爲立積二千開立方求其根得十二又三之一卽於甲乙上加二又三之一爲甲丙紀其號曰二再加一倍立積三千開立方得數紀三以上並同

防法取甲乙邊四分之一加甲乙成甲丙卽倍體邊又取甲丙七分之一加甲丙成甲丁卽三倍體邊又取甲丁十之一加甲丁成甲戊卽四倍體邊再加如圖

【右加法與開立方數所差不逺然尾數不淸難爲定率姑存其意】

又防法用立方表

以量分如後圖作四率連比例而求其第二蓋元體之邊與倍體之邊爲三加之比例也【假如邊爲一倍之則二若求平方面則復倍之爲四是再加之比例也今求立方體必再倍之爲八故曰三加三加者卽四率連比例也】

幾何法曰第二綫上之體與第一綫上之體若四率連比例之第四與第一【第一爲元邊綫第二爲加倍之邊綫第三以邊綫自乘爲加倍綫上之面第四以邊綫再自乘爲加倍綫上之體今開立方是以體積求邊綫卽是以第四率求第二率也】

假如有立方體積又有加倍之積

法以兩積變爲綫【元積如辛庚倍積如辛巳】作

壬巳辛庚長方形次於壬巳壬庚

兩各引長之以形心【戊】爲心作圈

分截引長綫於子於午作子午直

綫切辛角【如不切辛角必漸試之令正相切乃止】卽辛庚【一率】午庚【二率】子巳【三率】己辛【四率】爲四率連比例末用第二率午庚爲倍積之一邊其體倍大於元積

若辛巳爲辛庚之三倍四倍則午庚邊上體積亦大於元積三倍四倍【以上仿此】

解四率連比例之理

試於辛防作卯辛爲子午之垂綫次

用子壬度從午作卯午直綫截卯辛

綫於卯又從卯作直綫至子又從辛

防引辛庚邊至辰引辛巳邊至醜成

各句股形皆相似而比例等

【卯辛午句股形從辛正角作垂綫至醜分爲兩句股形則形相似而比例

等爲午丑辛形以午丑爲句醜辛爲股辛丑卯形以丑辛爲句丑卯爲股

則午醜與丑辛若丑辛與丑卯爲連比例也卯辛子句股形從辛正角

作垂綫至辰分兩句股形亦形相似而比例等卯辰辛形卯辰爲句辰

辛爲股辛辰子形辰辛爲句辰子爲股則卯辰與辰辛若辰辛與辰子

亦連比例也而辰辛卽丑卯故合之成四率連比例】

一率辛庚卽午丑

二率午庚卽丑辛亦卽辰卯

三率子巳卽辛辰亦卽丑卯

四率己辛卽辰子

試法元體邊倍之卽八倍體積之邊若三之卽二十七倍之邊四之卽六十四倍體積之邊五之卽一百二十五倍體積之邊

又取二倍邊倍之得十六【八其二也】再倍之得一二八倍體積之邊【六十四其二也】

三加比例表【平方立方同理卽連比例】

第一率

第二率

第三率

第四率

按第一率爲元數第二率爲綫卽根數也第三率爲面平方冪積也第四率爲體立方積也開平方開立方並以積求根故所用者皆二率也【比例規觧乃云本綫上量體任用其邊其根其面其對角綫其軸皆可其說殊不可曉今刪去】

用法一有立積求其根【卽開立方】

假如有立方積四萬法先求其與一千之比例則四萬與一千若四十與一卽取十數爲分體綫上一防之底定尺而取四十防之底得三十四彊卽立方之根【說見平方】

用法二有兩數求其雙中率【謂有連比例之第一與第四而求其第二第三】法以小數爲一率用作本綫一防之底而取大數之底爲二率旣有二率可求三率

假如有兩數爲三與二十四欲求其雙中率法約兩數之比例爲一與八卽以小數三爲本綫一防之底定尺而於八防取底得六爲第二率末以二率四率依法求中率得十二爲三率

一率三二率六三率十二四率二十四

用法三設一體求作同類之體大於設體爲幾倍【此乘體之法】

假如設立方體八千其邊二十求作加八倍之體爲六萬四千問邊若干法以設體根二十爲本綫一防之底定尺而取八防之底得四十卽大體邊如所求

用法四有同類之體欲並爲一法累計其積而並之爲總積求其根卽得

假如有三立方體甲容一十乙容十三又四之三丙容十七又四之一並得四十一卽以甲容一十爲本綫一防之底定尺而取四十一防之底爲總體邊如所求若設體無積數則以小體命爲一十而求其比例然後並之

用法五有兩同類之體求其比例與其較【此分體之法】假如甲丙兩立方體欲求其較而不知容積之數法以甲小體邊爲一防之底定尺而以丙邊爲底進退求其等數如所得爲九卽其比例爲九與一以一減九其較八卽於八防取底爲較形之邊

用法六有立方體欲別作一體爲其幾分之幾假如有立方體欲另作一體爲其八之五則以設體邊爲本綫八防之底定尺而於五防取底爲邊作立方體卽其容爲設體八之五

第五更體綫【舊名變體綫】

體之有法者曰立方曰立圓曰四等面曰八等面曰十二等面曰二十等面凡六種外此皆不能爲有法之體

六等面體各面皆正方卽立方也有

十二稜八角測量全義曰設邊一百

求其容爲一○○○○○○

渾圓體亦曰球體卽立圓也幾何補

編曰同徑之立方積與立圓積若六

○○○○○○與三一四一五九二

設徑一百求其容爲五二三五九八

此三角平面形相合而成有六稜四

角測量全義曰設邊一百求其容爲

一一七四七二半

此體各面亦皆三等邊形有十二稜

六角測量全義曰設邊一百求其容

爲四七一四二五有奇

此體各面皆五等邊有三十稜二十

角測量全義曰設邊一百求其容爲

七六八六三八九

此體各面亦皆三等邊有三十稜十

二角按幾何補編二十等面體設邊

一百其積二百一十八萬一八二八

測量全義作邊一百容五二三八○

九相差四倍故今不用

分法

置公積百萬依算法開各類之根則立方六等面體之根爲一百四等面體之根爲二○四八等面體之根爲一二八半十二等面體之根爲五○半彊二十等面體之根爲七七圓球之徑爲一二四【原本十二等面根五○二十等面根七六圓徑一二六今並依幾何補編攺定】因諸體中獨四等面體之根最大故本綫用二○四平分之從心數各類之根至本數加字

用法一有各類之立體以積求根【卽開各類有法體之方】法皆以設積於立方綫求其根乃移置更體綫求本號之根卽得

假如有十二等面體其積八千問邊若干法以一千之根十爲立方一防之底定尺而取八防之底得二十爲所變立方之根次以二十爲本綫上立方號之底而取十二等面號之底得一十○彊卽十二等面之一邊【他仿此】

用法二有各類之立體以根求積法先以所設根變爲正方根乃於立方綫求其積

假如有二十等面體其邊三十一弱問積法以根三十一弱爲本綫二十等面號之底定尺而取立方號之底得四十弱爲所變立方之邊次於立方綫以一十爲一防之底而以四十進退求等數得【十六】防命其積【一萬六千】如所求【邊一十其積一千則邊四十積一萬六千】

用法三有不同類之體欲相並爲一【此以體相加之法並變爲正方體積卽可相並】

假如有三立體甲渾圓體【徑一百二十四】乙二十等面體【邊七十七】丙十二等面體【邊五十○半】欲相並用前條法各以積變爲立方積則三體之積皆一百萬並之得三百萬如所求

用法四有不同類之兩體求其比例與其較【此以體相減之法】法各變爲立方體卽可相較以得其比例並同更面綫法

第六分圓綫【卽各弧度之通也舊名分綫亦曰分圈】

分法有二一以量一以算

以量分法作半方形如甲乙丙令甲丙斜與本綫

等長以乙方角爲心甲爲界作象限

弧如甲丁丙乃勻分之爲九十度各

識之次從甲防作直綫至各度移入

尺上識其號若尺小可作六十度

卽本綫之長爲六十度號若尺大可作一百八十度卽本綫之半爲六十度號

以算分法用正表倍之爲倍度之通假如求六十度通卽以三十度之正【五○○○○】倍之得【一○○○○○】卽六十度之通他皆若是

試法十八爲半周十之一【卽全圈二十之一也】三十六爲半周五之一【卽全圈十之一】四十五爲半周四之一【卽全圈八之】七十二爲半周五之二【卽全圈五之一】九十爲半周之半【卽全圈四之一謂之象限】百二十度爲半周三之二【卽全圈三之一】

用法一有圓徑求若干度之弧以半徑當六十度取之

假如有甲乙丙全圈有甲丙徑求五十度之弧卽以甲丙徑半之於丁以甲丁半徑爲本綫六十度之底定尺而取五十

度之底如甲乙直綫以切圓分卽得甲戊乙弧爲五十度如所求

用法二若以弧問徑則反之

如先有弧分如甲戊乙爲五十度而問全徑法從弧兩端聫之作直綫如【甲乙】用爲本綫五十度之底定尺而取六十度之底爲半徑【甲丁】倍之得全徑【甲丙】

用法三直綫三角形求量角度

法以角爲心任用規截角旁兩綫作通如法得角度

假如甲丙乙三角形不知角法任用甲丁度以甲爲心作虛圈截甲丙綫於丁截甲乙綫於戊次作丁戊直綫次卽用甲丁原度以乙爲心如法截甲乙於辛截丙乙於庚

作辛庚直綫末以甲丁爲六十度之底定尺乃用丁戊爲底進退求其等度之號得甲角之度用辛庚爲底亦得乙角之度合兩角減半周得丙角度

如甲角六十五乙角四十則丙角必七十五

用法四平面等邊形求其徑

假如有五等邊平面形欲求徑作圖【卽對角輳心直綫】法以設邊爲分圓綫七十二度之底而取其六十度之底爲半徑以作平圓末以原設邊爲度分其周爲五平分卽成五等面如所求【他等邊形並同】

五等邊形有一邊如丙乙如法求

得乙甲半徑以甲爲心乙爲界作

平圓而以丙乙邊度分其圓得丁

戊己等防作綫聫之卽成五等邊形而所作圓卽外切之圓

第七正綫【舊名節气綫以其造平儀時有分節气之用也然正在三角法中爲用甚多不止一事不如直言正以免掛漏】

正綫不平分亦近樞心大而漸小與分圓同

分法全尺爲一百平分尺大可作一千於正表取數從樞心至各度分之每十度加號

簡法第一平分綫可當此綫其綫兩傍一書平分號一書正號

又法分圓綫可當此綫以分圓綫兩度當正一度紀其號

假如分圓六十度齘卽紀正三十但分圓之號直書則正橫書以別之

解曰凡正皆倍度分圓之半故其比例等然則分圓之一度卽正之半度而半度亦可取用爲尢便也

如圖甲乙爲通甲丙乙丙皆正

用法一有設弧求其正法以九十度當半徑假如有七十五度之弧求正卽以本圈半徑爲正綫九十度之底定尺而取七十五之底爲正如所求

用法二有弧度之正數求徑數則以前條反用之假如有七十五度之正數卽用爲本綫七十五度之底定尺而取其九十度之底得半徑數

用法三句股形有角度有求句求股法以當半徑正當句與股

假如句股形之二丈有對句之角

三十度卽取平分綫之二十當數

爲正綫九十度之底而取三十度

之底得一十卽其句一丈

又於其角之餘【卽六十度正】取底得【一十七又三之二弱】卽其股爲【一丈七尺三寸二分】

若以句求則反之如句一丈其句與所作之角爲六十度其餘角三十度卽取一十數爲三十度之底定尺而取九十度之底得二十命其二丈

用法四三角形以邊求角假如三角形有乙甲邊甲丙邊及丙角度而求乙角法以乙甲邊數爲丙角正之底定尺而以甲丙

邊爲底進退求其等度取正綫上號爲乙角度如所求

用法五三角形以角求邊

假如三角形有戊角度己角度及庚己邊而求庚戊邊法以庚己邊爲戊角正之底定尺而取己角正之底得數卽爲庚戊邊如所求余詳三角法舉要

用法六作平儀求太陽二至日離赤道緯度

如圖以十字分大圓直者爲兩

極橫者爲赤道橫直交於圓心

卽地心也赤道卽春秋分日行

之道也地心至兩極半徑爲正

綫九十度之底定尺取二十

三度半之底於地心上下各作防於直綫於此防作橫綫與赤道平行爲二至日道近北極者夏至近南極者冬至也

又求作各節气日道

法先求黃道綫

法於夏至之一端作斜綫過地心至冬至之又一端卽成黃道日行其上一嵗一周天者也以黃道半徑爲九十度之底定尺每十五度正取底移至黃道半徑上【並從地心起度】

於地心上下各識之卽各節气日躔黃道上度也【或三十度取底則所得皆中气】

乃自黃道上各防作直綫並與赤道平行卽各節气日行之道此與分至日道皆東升西沒一日一周者

也其各綫兩端

抵大圓處卽各

節气赤道緯度

也春分以後在

赤道北秋分以

後在赤道南

試法於二至日道兩端作橫綫聫之【如甲乙】次以此橫綫之半爲度【如丙乙】過赤道處【如丙】爲心作半圈於大圓之上【如乙戊甲半圓】亦如法作半圈於下兩半圈各勻分十二分作識【若但求中气可分六分】上下相向作直綫聫之卽必與先所作日行道合爲一綫又以甲丙爲正九十度之底定尺而於其各正取底亦卽與原定日道緯度綫合【如丙辛三十度之正也與赤道旁第一緯綫合丙丁六十度之正也與第二緯綫合左右上下考之並同】

用法七定時刻【仍用平儀】

法以平儀上赤道半徑爲正綫九十度之底定尺而於各時刻距卯酉之度取其正於赤道作識【過兩極軸綫處卽夘正酉正也距此而上三十度午前爲辰正午後爲申正距此而下三十度子前爲戌正子後爲寅正距此而上六十度午前爲巳正午後爲未正距此而下六十度子前爲亥正子後爲丑正至圓周處上爲午正下爲子正】卽春秋分之時刻也欲作各時初正及刻凖此求之並以正爲用【每時分初正各加距十五度初正又各分四刻每刻加距三度又四分之三並取正如前法】又以二至日道之半徑爲正

九十度之底定尺如

法取各正作識卽二

至之時刻也末以分

至綫上時刻作弧綫聫

之卽得各節气之時刻

凖此論之平儀作時刻亦用正比例規觧以正名節气綫切綫名時刻綫區而別之非是

第八切綫【舊名時刻綫今按平儀時刻原用正惟以日景取髙度定時刻斯用切綫耳又如渾蓋通憲等法亦皆切綫其用甚多故不如直名切綫】

切綫不平分先小漸大至九十度竟平行無界故只用八十度或只作六十度亦可

分法簡切綫本表八十度之切綫五六七卽於尺上作五六七平分次簡各度數分之逢十加識

用法一三角形求角

假如乙甲丁三角形求乙角任截角

旁綫於丙得乙丙十寸自丙作垂綫

戊丙量得七寸次用十數爲切綫四十五度之底定尺而以戊丙七數爲底進退求等度得三十五度爲乙角

用法二求太陽地平上髙度【用直表】

法曰凡地平上直立之物皆可當表以表髙數爲切綫四十五度之底定尺而取表影數爲底進退求等度得日髙度之餘切綫

假如表髙一丈影長一丈五尺法以丈尺變爲數用一十數當表髙爲切綫四十五度之底定尺次以一十五數當影長爲底進退求等度得五十六度十九分爲日髙之餘度以減九十度得日髙三十三度四十一分

癸丙地平上日髙度與壬辛

等其餘度癸丁爲日距天頂

與戊辛等甲戊爲表長其影

戊已乃日距天頂之切綫在

日髙癸丙爲余切綫也

用法三求太陽髙度用橫表

植橫木於墻以候日影卽得倒影爲正切綫之度假如橫表長一尺倒影在墻壁者長一尺五寸法用十數當橫表爲四十五度之底定尺次以十五數當影長進退求等度得五十六度十九分卽命爲日髙之度

凡亭臺之內日影可到者量其檐際之深可當橫表

卯寅墻子甲爲橫表

太陽光從丁過表端甲射丑成子丑倒影丁丙爲

日在地平上髙度與午子度等故以子丑倒影爲日髙度之正切綫也

按直表之影低度則影長髙度則漸短日度益髙則影極短故以余切綫當直影【前圖是也】橫表之影低度則影短髙度則漸長日度益髙則影極長故以正切綫當倒影【後圖是也】比例規觧乃俱倒說今正之

用法四求北極出地度分假如江寧府立夏後九

日午正立表一丈測得影長爲

二尺四寸法以一百數當表髙

爲切綫四十五度之底定尺而

以二十四數爲底進退求等數

得一十三度半如法以減九十度得七十六度半爲日出地平上髙度簡黃赤距度表是日太陽北緯一十九度以減日髙度得赤道髙五十七度半轉減九十度得北極髙三十二度半防法以直表所得一十三度半加太陽北緯十九度卽得三十二度半爲北極髙度

解曰直表所得太陽距天頂度也加北緯卽赤道距天頂度亦卽北極出地度

又如順天府立春後四日如法

用橫表三尺得倒影二尺一寸

依切綫法求得日髙三十五度

簡表得本日太陽南緯一十五

度以加日髙度得赤道髙五十

度以減九十度得北極髙四十度

第九割綫【舊名表心綫今按割綫非表心又割綫之用甚多非只作日晷一事故直名割綫爲是】

割綫不平分先小後大並與切綫略同故亦只作八十度或只作六十度亦可

分法用割綫本表八十度之割綫五七五平分之其初防與切綫四十五度等次依表作度加識

用法一三角形以割綫求角

假如有甲乙丙三角形求甲角法任

於甲角旁之一邊截戊甲十寸作垂

綫如戊丁截又一邊於丁得丁甲十

九寸次以十數爲割綫初防之底定尺而以十九數爲底進退求等數得五十八度一十七分爲甲角之度

用法二作平面日晷【兼用割切二綫】

法曰先作子午直綫卯酉橫綫十字相交於甲以甲爲正午時從甲左右盡橫綫盡處爲度於切綫八十二度半爲底定尺次於本綫七度半取底向卯酉橫綫上識之自甲防起爲第一時如甲丙甲乙次每加七度半取底如前作識爲各時分【如七度半加之成十五度卽第二時又逓加如二十二度半三十度三十七度半四十五度五十二度半六十度六十七度半七十五度至八

八十二度半合綫末元定之防】若逓加三

度四十五分而取底作識

卽每時四刻全矣【按每七度半加

防乃二刻也今每三度四十五分則一刻加防】訂定法曰橫綫上定時刻

訖次取甲交防左右各十

二刻之度【卽元定四十五度之切綫亦卽】

【半徑全數】爲割綫上北極髙度之底定尺而取割綫初防之底爲表長【如壬庚】次以表長當半徑爲切綫四十五之底定尺而檢北極髙度之正切取底自甲防向

南截之如甲壬以壬爲表位

又於北極髙度之餘切綫取底

自表位壬向南截之如壬辛以

辛爲晷心末自晷心辛向橫

綫上原定時刻作斜直綫引長

之得時刻時刻在子午綫西

者乙爲午初丁爲巳正癸爲巳初又加之卽辰正又加之卽辰初在子午綫東者丙爲未初戊爲未正巳爲申初又加之卽申正又加之卽酉初並逓加四刻謹按卯酉綫卽赤道綫也二分之日日躔赤道日影終日行其上庚甲割綫正

對赤道正午時日影從庚射甲成庚甲影若已末午初則庚防之影不射甲而射乙而庚甲影如半徑乙甲如切綫矣以庚甲爲切綫上半徑而遞取各七度半之切綫以定左右各時刻之防並日影從庚所射也然此時庚甲之度無所取故卽用赤道綫四十五度之切綫代之用切綫實用庚甲也【庚甲旣爲切綫之半徑則必與四十五度之切綫同長】

以四十五度當半徑而取切綫以定時刻此天下所同也然赤道髙度隨各方北極之髙而變庚甲割綫何以能常指赤道則必於表之長短及表位之逺近別之故以庚甲當北極髙度之割綫而取其初防爲表長初防者半徑也本宜以半徑求割綫今先有割綫故轉以割綫求半徑也旣以庚壬表長爲半徑庚甲爲割綫則自有壬甲切綫而表位亦定矣表位旣定則庚甲影能指赤道矣何以言之表端壬庚甲角旣爲極髙度則庚角必赤道髙度而庚甲能指赤道也故北極度髙則庚角大甲角小而庚壬表短壬甲之距逺北極度低則赤道髙甲角大而庚壬表長壬甲之距近比例規觧乃以表位定於甲防失其理矣遂復誤以割綫爲表長余割綫爲晷心而彊以割綫名爲表心綫名實盡乖貽誤來學此皆習其業者原未深諳彊爲作觧而卽有毫釐千里之差立法者之精意亡矣故特爲闡明之

庚壬表上指天頂下指地心爲半徑

壬表位壬甲爲正切綫辛晷心辛壬

爲余切綫甲角卽赤道髙度壬庚甲

角卽北極髙度與辛角等

用法三先有表求作日晷【借用前圖可解】

法先作子午直綫任於綫中定一防爲表位如壬乃以表長數壬庚爲切綫四十五度之底定尺而取本方北極出地度之底得壬甲正切度於表位北作防【如甲】次於甲防作卯酉橫綫與子午綫十字相交卽赤道綫春秋分日影所到也又取極髙余度之底得壬辛余切綫於表位南作防【如辛】卽晷心也若自表端庚作直綫至晷心辛卽爲兩極軸綫辛指南極庚指北極也次以表長【庚壬】與壬甲正切相連作正方角則庚壬如句壬甲如股而取其綫庚甲卽極出地正割綫也次以庚甲爲切綫四十五度之底定尺而各取七度半之底累加之於甲防左右作識於卯酉橫綫上末自晷心辛作綫向所識防卽得午前後時刻並如前法

用法四有立面向正南作日晷並同平面法但以北極髙度之餘切綫定表位以正切綫定晷心則自晷心作綫至表端能上指北極爲兩極軸綫又立晷書時刻並逆旋與平面反然以立晷正立於北與平晷相連成垂綫則其時刻一一相符

用法五用橫表作向東向西日晷

假如立面向正東法於近南作直綫上指天頂下指地心近上作橫綫與地平相應兩綫相交於甲以甲爲心於兩綫間作象限弧自下起數至本方北極出地度止自此向甲心作斜直綫以分弧度

此綫卽爲赤道次以甲爲表

位用橫表乙甲之長取數爲

切綫四十五度之底定尺遞

取十五度切綫從心向赤道

綫累加之作識定時卽春秋

分日影所到也【若分二刻則逓取七度半】

【細分每刻則逓取三度四十五分】次於甲心作橫斜綫如丁戊爲赤道之垂綫其餘時刻防各作綫與丁戊平行【亦並與赤道十字相交】次於元定尺上【卽以表長爲四十五度所定】取二十三度半之切綫爲度於甲左右截之爲界【如丁甲如戊甲】卽二至卯正時日影所到也【二分日卯正則乙甲表正對日光無影分前後則有緯度而影亦漸生日日不同然不離丁戊綫至二至而極冬至影在北如丁夏至影在南如戊以此爲界向西酉正時亦然】仍用元尺取【每十五度之黃赤距緯】切綫作於丁戊綫內從甲防左右作識得各節气卯正日影【或取三十度切綫則所得每月中气酉正亦然】

次以乙甲表長爲割綫初防之底定尺而取十五度之割綫爲二分日在辰初刻之影如乙辛卽天元赤道上日離午綫十五度其光過乙至辛所成也就

以乙辛割綫爲切

綫四十五度之底

而取二十三度半

之底自辛防左右

截橫綫並如辛壬

爲冬夏至辰初刻日影所到之界【辛壬在南爲夏至其在北爲冬至亦然】又逓取【每三十度之黃赤距緯】切綫從辛至壬作防爲各中气界【此向南日影界乃赤道北半周節气其辛防向北作界爲南半周亦然】自此而辰正而巳初而巳正以至午初並同乃於節气界作綫聫之卽成正東日晷其面正西立晷作法並同但其時刻逆書自下而上最下爲未初次未正次申初次申正次酉初而至酉正則橫表正對日光而無影矣此亦二分日酉正也其餘節气亦有短影而不出本綫與卯正同

新增時刻綫【以切綫分時刻本亦非誤但切綫無半度取度難淸今另作一綫得數旣易時刻尢眞】

分法依尺長短作直綫【如後圖乙丙】於綫端作橫垂綫【如乙甲爲乙丙垂綫】又作直綫略短與設綫平行交橫綫如十字【如甲巳綫交橫綫於甲】以甲爲心作象限弧六平分之爲時限各一分內四平之爲刻限次於甲心出直綫過各時限至直綫成六時過各刻限者成刻乃作識紀之【並如後圖】

尺短移直綫近甲心取之【移進綫並與原直綫平行以遇第六時第二刻爲度如已戊虛綫遇丁戊綫於戊卽戊爲第六時之二刻】

用法凡作日晷並以所設半徑置第三時爲底定尺而取各時刻之底移於赤道綫上午前午後並起午正左右爲第一時依次加識卽各得午正前後時刻【並如前法】

第十五金綫【卽輕重之學】

物有輕重以此權之獨言五金者以其有定質也五金之性情有與七政相類者因以爲識

金【太陽】水銀【水星】鉛【土星】銀【太陰】銅【太白】鐵【火星】錫【木星】

分法用各分率及立方綫

比例率【先取諸色金造成立方體其大小一般無二乃權其輕重以爲比例】

黃金一

水銀一又七十五分之三十八【儀象志作九十五分之三十八】

鉛一又二十三分之一十五

銀一又三十一分之二十六

銅二又九分之一

鐵二又八分之三

錫二又三十七分之二十一【比例規觧原作三十七分之一則錫率反小於銅鐵而輕重之序今依儀象志】

金體最重故以爲凖自尺心向外任定一度爲金之根率自此依各率增之並以金度爲立方綫上十分之底定尺次依各率爲底進退求等數取以爲各色五金之根率自心向金率防外作識

解曰此同重異積之率也於立方綫上求得方根作識於尺則同重異根之率也金體重則其積最少【謂立方體積】各色之金【謂銀鉛等】體並輕於金故必體積多而後能與之同重然立積𨿽有多少非開方不得其根之大小故必於立方綫求之也

又解曰先以同大之立方權之得各率者同根異重之率也而卽列之爲同重異根之率何也蓋以根求重則金最重而他色輕以重求根則金最小而他色大其事相反然其比例則皆等假如金與銅之比例爲一與二彊若體同大則金倍重於銅矣若其重同者則銅之體必倍大於金其理一也

又法用立方根比例率

黃金一六六弱

水銀一九一弱

鉛二○二

銀二○四

銅二一三

鐵二二二

錫二二八

用法一有某色金之立方體求作他色金之立方體與之同重【或立圓及各種等面體並同】

假如有金球之徑又有其重今作銀球與之等重求徑若干法以金球徑數置本綫太陽號爲底定尺而取太陰號之底數作銀球之徑卽其重與金球等

用法二若同類之體其根同大求其重

假如有金銀兩印章體俱正方而其大等旣知銀重而求金重法以銀圖章之根數置太陰號爲底定尺而取太陽號底數次於分體綫上以銀章重數爲兩太陽號底定尺而轉以太陰底數【卽銀章根數】進退求等得數卽金章之重

輕重比例三綫法【附】

重學爲西法一種其起重運重諸法以人巧補天工實宇宙有用之學五金輕重又重學中一種蓋他物難爲定率可定者獨五金耳然比例規觧𨿽載其術而數多抵牾未可全據愚參以靈臺儀象志其義始確因廣之爲三綫曰重比例曰重之容比例曰重之根比例旣列之矩算復爲之表若論以發其凡康熙壬戌長夏勿葊梅文鼎謹述

重比例【異色之物體積同輕重異】

解曰重比例者同積也積同而求其重則重者數多輕者數少若反其率則爲容積比例矣

用法假如有金一件不知重法以水盛器中令滿權其重乃入金其中則水溢溢定出金乃復權之則水之重必減於原數矣乃以所減之重變爲綫於比例尺置於水防爲底乃於金防取大底卽金重也又如有玉刻辟邪今欲作銅者與之同大問用銅幾何法如前以玉器入水取水減重之數置水防爲底取銅防大底卽得所求【若作諸器用蠟爲模亦同或以蠟輕難入水者竟以蠟重於蠟防爲底而取銅防大底更妙也】

重之容比例【輕重同則容積異亦謂異色之物】

解曰容比例者同重也同重而求其積則重者積數少輕者積數多反其率亦卽爲輕重之比例矣

又觧曰容積比例以立方求其根則爲根比例矣故輕重當爲三綫也

用法假如有水若干重盛器中滿十分有澒與水同重盛此器中問幾何滿法以水滿十分之數作水防之底而取澒防小底則知澒在器中得幾分

用法二有同重之兩色物欲知其立方根法以容比例求其同重之積再於分體綫求其根

用法三有金或銅錫等不知重法如前入水求得水溢所減之重變爲綫乃以水重置金防爲底【若銅錫亦置銅錫防】於水防取大底【此借容比例求重故反用其率】若用蠟模鑄銅器亦以蠟重置銅防爲底【而於蠟防取大底卽得合用銅斤】

觧曰有二法三法則只須容比例一綫足矣蓋反用之可以求重旣得容可以求根【用三綫者取其便用一綫者取其簡可任意爲之也】

又容比例【附】

又客比例

解曰容比例有三率也其實一率而已第一率以水爲主取其便用也第二率以金爲主取其便擕也第三率平列乃立方之積數也其作綫於尺則皆一率而已矣

此外仍有通分之法亦愚所演然其理皆具原表中故仍載表而附之故後

輕重原表

右表靈臺儀象志所引重學一則也其法同重者以直推見容積同積者以橫推見重重比例容比例皆在其中矣旣得容可以求根則根之比例亦在其中矣比例規觧五金綫蓋原於此原書金與蠟之比例訛卄一爲廾九今攺定

通分法【亦容比例之率】

分母

澒九五

鉛廾三乘得二一八五

銀卅一又乘得六七七三五

銅○九又乘得六○九六一五

鐵○八又乘得四八七六九二○

錫卅七又乘得一八○四四六○四○爲金率

以澒分母九十五除金率得一八九九四三二以乘分子卅八得七二一七八四一六加金率得二五二六二四四五六爲澒率

以鉛母卄三除金率得七八四五四八○以乘子十五得一一七六八二二○○加金率得二九八一二八二四○爲鉛率

以銀母卅一除金率得五八二○八四○以乘子廾六得一五一三四一八四○加金率得三三一七八七八八○爲銀率

以銅母九除金率得二○○四九五六○以乘子一得如原數加金率二得三八○九四一六四○爲銅率

以鐵母八除金率得二二五五五七五五以乘子三得六七六六七二六五加金率二得四二八五五九三四五爲鐵率

以錫母卅七除金率得四八七六九二○以乘子廾一得一○二四一五三二○加金率二得四六三三○七四○○爲錫率

按自古歷算諸家於尾數不能盡者多不入算故曰半已上収爲秒巳下棄之其有不欲棄者則以大半少彊弱収之

假如一百分則成一整數【九十爲一弱一十爲一彊】百二十五爲少卽四分之一也【若二十爲少弱三十爲少彊】五十爲半【四十爲半弱六十爲半彊】七十五爲太卽四分之三也【七十爲太弱八十爲太彊】重之根比例【異色同重之立方】

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷三十九﹥

附求重心法

乙甲癸子形求重心先作乙甲綫分爲【乙子甲乙癸甲】兩三角

形次用三角形求心術求【乙子甲乙

癸甲】之形心在【丙丁】作丙丁綫聫之

又作子癸綫分爲【癸乙子癸甲子】兩

三角形求【癸乙子癸甲子】形之心在【庚辛】作庚辛綫聫之此二綫相交

於壬則壬爲本形心卽重心也試作乙巳正角綫至子癸綫上又作甲戊綫至子癸綫上此兩綫之比例卽兩形大小之比例也【法爲癸乙子形與癸甲子形之比例若乙巳與甲戊也】以此比例於庚辛兩心距綫上求得壬防爲全形之重心【法爲乙巳綫與甲戊若辛壬與庚壬】

如圖子巳與癸戊之比例

若丁壬與丙壬也余並同

前圖

一率子巳與癸戊二綫並

二率子巳

三率丁丙

四率丁壬

歷算全書卷三十九﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

方程論自敍

方程於數九之一也何獨於方程乎論曰方程猶句股也數學之極致故二以殿乎九今之爲數學往往覃思勾股而略方程不寧惟略抑多沿誤佹於闕矣數九而闕其一可以無論乎議者謂勾股測量用以知道裏之修城邑之廣山之髙水之深天地日月之行度若方程算術多取近用米鹽淩雜非其精且大是不然精觕小大人則分之而自一至九之數無分也且數何兆歟當其未始有物之初混沌鴻蒙杳防恍惚無始無終無聲無形無理可名無數可紀乃數之根也是謂眞一眞一者無一也一且非一而況其分及其自無之有無一而忽然有一有一則有萬萬者一之萬也萬各其一一各其萬卽萬卽一環應無端又孰從而精麄之小大之乎故果蓏之有理而星度齊觀理實同源數亦防防苟未達此而侈言髙逺遺乎目睫將日用之酬酢有外乎理數以自立者哉而二之也古者數學大司徒以備鄕之三物教萬民而賔興之其屬保氏掌之以教國子具曰九數未嘗右勾股於方程也𨿽然古之人以其進乎數者治數故用之簡易而言之約今欲於古學旣湮之日出獨是以信眾疑使方程之沿誤皆正而九數闕而復全則意取共明固不敢謬托簡古以自文其疎愚之論乃不覺其復矣凡六卷論成於壬子之冬寫而成帙則甲寅之夏勿庵梅文鼎自識

餘論

數學有九要之則二支一者算術一者量法量法者長短逺近以求其距西法謂之測綫方圓弧矢冪積周徑以相求西法謂之測面立方渾圓堆垜之形以求容積西法之測體在古九章則爲方田爲少廣爲商功爲句股算術者消息盈虛乘除進退以差多寡驗往以測來西法謂之比例通分子母整齊畫一不盡者以法命之西法謂之畸零若夫隠雜重復參錯難稽卽顯驗幽探賾窮深無例可比故西法別立借衰互徴以爲用亦比例也在古九章則爲粟布爲衰分爲均輸爲盈朒爲方程此二者相需不可偏廢𨿽然算術可以濟量法之窮而量法不可以盡算術之變何也可量者其可見也天下之不可見者多矣非算術何以禦之故量法有窮而算術不窮也夫旣量之而得其率矣所量者一欲知者百西法之用比例亦以算術佐量法也然以例相比非量法而有量法之理吾友桐城方位伯謂九章出於句股蓋以此也然吾觀方程正負同異減並之用非句股所能禦而能生比例愚故以算術必不可廢也

言數學者亦有二家一古法一泰西泰西之說詳明曉暢古人之法徑捷簡易可互明也然古書僅存算術而略於測量泰西詳於測量而或遺在算術吾觀泰西家言矩度三角八綫割圓幾何原本備矣謂其善用句股能有新意出於古率之外未爲過也若所譯同文算指者大約用三率以變古法至於盈朒方程則其術不復可行於是取古人之法以傳之非利氏之所傳也算術之妙莫盈朒方程若而泰西皆無之是九章闕其二也尙謂之賢於古法乎且泰西家欲以其說易天下故必宛轉箋疏以達其意以取信於學者若盈朒方程立法之意殊不能言也不能言盈朒故別立借衰之法以代之自謂超妙可廢古法矣而終不能廢盈朒若方程一章不但不能言之亦不能用之不過取古人之僅存者具數而已不能別立術以代之也諸書之謬誤皆沿之而不能察其必非知之而不用能言之而不悉亦可見矣夫古人之略於量法者非不能言也言之略耳言之詳者別有専書而人不能習不傳於世耳學士大夫旣苦其難竟又無與進取弋獲之利遂一切棄置不道淺獵焉者率得少以自多無所發明遂使古人之精意若存若亡不復可見今諸書所載方程法殘缺錯亂視盈朒尢甚其所僅存又多爲後之不得其說者參以臆解而其防益晦非古人舊也使古之方程僅僅如此何必別立一章列於盈朒之後乎然以好變古率如泰西而不能變方程勤於言算如泰西而不能言方程不能盡其用不能正其沿誤可見古人立法之深逺而決不可易向使習古法者盡見古人之書又能如泰西家羣萃州處窮年累月研精覃思以爲之引伸而推廣又豈止如斯而已乎言之三嘆

方程論發凡

一方程立法之始

按周禮九數一曰方田以禦田疇界域一曰粟米【一作粟布】以禦交質變易一曰差分【一名衰分】以禦貴賤廩稅一曰少廣以禦積方程一曰商功以禦功程積實一曰均輸以禦逺近勞費一曰盈朒【一云贏不足】以禦隠雜互見一曰方程以禦錯糅正負一曰句股【一云旁要】以禦髙深廣逺是則方程者九數之一乃九章中之第八章

也通雅以九數爲周公之法蓋自隸首作算數以來有九章卽有方程淵源逺矣

一方程命名之義

方者比方也程者法程也程課也數有難知者據現在之數以比方而程課者則不可知而可知卽互乘減並之用

一方程殘缺之故

按七十子身通六藝則九數在其中自漢以後史稱卓茂劉歆馬融鄭何休張衡皆明算術唐宋取士有明算科六典算學十經博士弟子五年而學成宋大儒若邵康節司馬文正朱文公蔡西山元則許文正王文肅莫不精算然則算學之疎乃近代耳夫數學一也分之則有度有數度者量法數者算術是兩者皆由淺入深是故量法最淺者方田稍進爲少廣爲商功而極於句股算術最淺者粟布稍進爲衰分爲均輸爲盈朒而極於方程【詳見末捲方程能禦雜法】方程於算術猶句股之於量法皆其最精之事不易明也而算學無闗進取皆視爲賈人胥史之事而不屑從事又其用近小但於方田粟布取之亦無不足故近代諸刻多不具九章其列九章者不過寥寥備數學者𨿽欲推明古法孰從而求之此方程殘缺之由也

一方程謬誤之故

方程句股皆不爲近用所需然句股測望自昔恆有専書近者西學驟興其言句股尢備故九章所載𨿽簡而不至大謬至若方程別無専書可證所存諸例又爲俗本所亂妄增歌訣立爲膠固之法印定後賢耳目而方程不復可用竟如贅疣周官九數幾缺其一愚不自揆輒以管闚之見反覆推論以明之務求其理眾曉而不疑於用庶不致謬種流傳以亂古法云爾【詳第四卷

刋誤】

一方程條件與舊不同之故

舊傳方程分二色爲一法三色爲一法四色五色以上爲一法頭緒紛然而和較之分疑未淸法無畫一所立假如僅可施之本例不可移之他處然如此則爲無用之法而方程一章爲徒設矣竊以古人立法決不如此今按方程有和有較有兼用和較有和較交變約法四端巳盡方程之用不論二色三色四色五色乃至多色其法盡同正不必每色立法反滋紛擾也然惟如此則有定法而方程爲有用且其用甚多竊以古人立法必當如此夫古人往矣愚生千載之下蓬戶山居耳目局隘不能盡見古人之書亦何以防其然哉夫亦惟是反之心而無疑措之事而可用則此心此理之同庶可共信非敢好爲新奇以自也天下大矣鄴架藏書豈無足攷尙冀博雅好古君子恵示古本庶有以證明其說而廣其所未知則所深望巳【詳見第一卷

及第四卷

刋誤】

一方程以論名篇之故

算學書有例無論則不知作法根原一再傳而多誤蓋由於此本書欲明算理故論多於例每捲之首皆有總論以爲之提网然後舉例以實其說【卽假如也】而例中或有疑似之端仍各有說以反覆申明之令覧者徹底澄淸無纎毫之凝滯凡爲論者十之七而例居其三以論名篇著其實也

一方程例有詳略可以互明

旣欲推明其理則無取誇多故首卷和較雜變四端不過數例意在假此例以發吾論但求大義曉暢更不繁引多例以亂人思其後數卷舉例稍繁然每設一例卽明一義務求委曲盡變庶令用者不疑前詳者後必略前略者後乃詳更無重復細觀自見

一方程著論校刻緣起

鼎性耽苦思書之難讀者恆廢寢食以求之必得其解乃巳有未能通則耿耿胸中𨿽歷嵗時未敢忘也算數諸書尢性所嗜𨿽隻字片言亦不敢忽必一一求其所以然了然於心而後快竊以方程算術古人旣特立一章於諸章之後必有精理而中西各書所載皆未能慊然於懷疑之殆將二紀嵗壬子拙荊見背閍戶養屙子以燕偶有所問忽觸胸中之意連類旁通若干門之乍啟亟取楮墨次第錄之得書六卷於是二十年之疑渙然冰釋然後知古人立法之精深必非後世所能易書𨿽殘缺全理具存苟能精思必將我吿管敬仲之言不余欺也

論成後冀得古書爲徵而不可得不敢出以示人惟亡友溫陵黃兪邰太史桐城方位伯廣文豫章王若先明府金陵蔡璣先上捨曾鈔副墨而昆山徐揚貢明府檇李曹秋嶽侍郎姚江黃黎洲徵君頗加鑑賞厥後吳江潘稼堂太史尢深擊節嵗丁夘薄逰錢塘同裏阮於嶽鴻臚付貲授梓屬以理裝北上未遂殺靑續遇無錫顧景範北直劉繼莊二隠君嘉禾徐敬可先軰朱竹垞供奉淮南閻百詩寧波萬季野兩徵士於京師並印可又得中州孔林宗學博杜端甫孝亷錢塘袁恵子文學共相質正乃重加繕錄以爲定本謬辱安溪李大中丞厚庵先生下詢歷算命之論撰以質同人獲與介弟安卿孝亷晨夕酬對承其謬賞玆編錄副以歸手挍欹劂視余稿本倍覺淸明向使湖上匆劇雕版反不能如是之精良矣感書成之非偶驚嵗月之易流而良朋好我之殷受益宏多更僕難數爰玆略紀以志不忘

數學存古序【附錄】

六藝古聖人用也所以開物成務垂澤將來𨿽然器久則毀聲傳而失彼其初非不窮神盡變而後稍湮沒古聖人無如何也今不盡亡者數學耳數之爲物不借器而存稽實待虛其道如易故禮樂代更而方圓不易書契形名世殊方別而奇偶自如數之不亡不能亡也顧不能亡者數僅存者數之學嘗稽漢藝文志許商算術二十六卷杜忠算術十六卷唐博士肄習具有十經今略不一覩又古人制渾儀往往有書說詳徴其故又凡作歷皆有測驗諸書與曆術並垂如史所載晉姜岌劉宋祖衝之隋劉焯唐李淳風一行宋沈括元郭守敬著撰皆富今其存逸皆不可得攷自漢趙氏周髀一經外無可廣證他緯書占候傅防難信然則今九章者果周官舊邪周官之舊旣以不可知近世儒者又略之弗講九數之學益以荒蕪於是泰西氏者乃始孤行其測圜三角諸術以矜奇創學其學者至以大衍塡寫九執未盡授時陰用回回法子云康節之書皆爲臆說而隸首之術必有所窮嘻其果然邪夫謂西曆能兼古法之長是也而反謂古人陰用乎西法此其說非也不觀之書禦乎禦用於騎書用於楷楷與騎日以習而古書禦亡或者未考輿輪而輒以古禦不如今騎未窺籕篆而謂古書不及今楷遂欲駕王武子於造父尊鐘元常於蒼頡過矣愚生晚不及見古人僻處山陬聞見固陋閒嘗於世傳九章者稍稍論列補葺遺缺而昰正其紕繆使讀者曉然知九數之學果不盡於今所傳而其僅存者猶能與泰西氏並行而不得以相廢𨿽不知於古人萬一有當然天下之大不乏其人尙其共出枕祕以昭明而光大之使古人之緒晦而復顯或由是以發其端歟是愚之所望矣

欽定四庫全書

歷算全書卷四十

宣城梅文鼎撰

方程論卷一

正名

名不正則言不順諸本方程皆以二色三色四色等分欵立法而不分和較宜其端緒紛糾而說之滋謬也故先正其名

正名有四一和數二較數三和較雜四和較交變和者無正負如只云某物如幹某物如幹共價如幹以問每物各價者是也較者有正負如雲以某物如幹與某物如幹相較多價如幹或少價如幹或相當適足者是也雜者半有正負半無正負如一行雲某物某物各如幹共價如幹而其一行則又云以某物如幹較某物如幹差價如幹或價相當適足者是也變者或先無正負而變爲有正負或先有正負變而無正負三色以往重列減余兼用兩行者是也

總論曰萬算皆生於和較和較可以禦萬分合之義也萬物之未形一而已矣一且未有況萬乎及其有也有一則有二有二則有三自此以至於無窮而數生焉矣和者諸數之合也較者諸數之分也分則有差故謂之較較與和相求而法立焉矣故一與一和則二也一與二和則三也一與二之較一也一與三之較二也萬算𨿽多凖此矣故和較者萬算之綱也算之用至於句股方程至矣盡矣窺髙致逺探賾窮幽無所不備然其用不出於和較且以方程言之凡方程列位皆以下位爲之端如所列下一位爲上中兩位之總價則和也若下一位爲上中兩位相差之價則較也較故分正負和故不分正負𨿽不立正負然必以兩和互乘對減以得其差然後其數可得而知矣故三色以往先無正負者有時而正負立焉故方程之法以和求較而已矣較者易知和者難知和之中有較較之中又有較此萬數之所由生萬法之所由起

和數方程例

方程用互乘對減與差分章貴賤相和法同但貴賤相和有總物總價又有每物每價不過以帶分之故難用匿價分身而變爲換影之術耳方程則有總物總價而無每數又有三色四色以至多色頭緒紛然自非逓減何取之此古人別立一章之意也

用法曰二色者任以一色列於上以一色列於中以總價列於下於是以列上者爲乘法左右互乘又互徧乘中下得數左右對減其上一色必兩相若而減盡其中一色對減必有相差之數下價對減亦必有相差之數數相差則減不能盡於是取其餘數以爲用一爲法一爲實以法除實而得中一色每價乃以中價乘原列中物得中物總價以中物總價減原列兩色之總價得上物總價以原列上物除之得上一色每價【若更以中一色列於上依法求之亦先得上一色價矣故上中之位可以互更也詳見後】

假如有山田三畝塲地六畝共折輸糧實田五畝七分又有山田五畝塲地三畝共折實田五畝五分問田地每畝折實科則各如幹

畣曰每山田一畝折實田九分每地一畝折實田三分畝之一

法各列位

上

中

下

先以右上田三畝爲法徧乘左行得數

次以左上田五畝爲法徧乘右行得數上位各得田十五畝對減盡中位左得地九畝去減右行三十畝餘地二十一畝爲法下位左折田得十六畝五分去減右行二十三畝五分余折田七畝爲實以法除實不滿法約爲三之一爲地每畝折實田之數【地一畝折田三分三釐三毫不盡卽地三畝折田一畝也】就以右行折實田共四畝七分內除原地六畝折實田二畝餘二畝七分以右上田三畝除之得九分爲田每畝折實之數【或以左行折田內減左原地三畝該折實田一畝餘四畝五分以左上田五畝除之亦得九分爲田每畝折實之數】

論曰以右上田三畝徧乘左行得數是各三之也爲五畝田者三畝三畝地者三則爲田地共折實五畝五分者亦三也

以左上田五畝徧乘右行得數是各五之也爲三畝田者五爲六畝地者五則爲田地折實共四畝七分者亦五也

於以對減而上位田各十五畝減而盡則其數同也惟中位地餘二十一畝在右行則是右行之地多於左行之地二十一畝也

而下位折實數亦餘七畝在右行則是右行折實之數亦多於左行折實之數七畝也

合而觀之此所餘折實七畝者正是餘地二十一畝之所折也

此以田地問折數故以地二十一畝爲法折七畝爲實也若以折數問原田地則以折七畝爲法地二十一畝爲實法除實得每折一畝原地三畝於是以右地六畝折二畝減折四畝七分餘二畝七分爲法除右田三畝得每折一畝原田一畝又九分畝之一卽一分一釐一毫一一不盡也

若更置以地列於上則先得田折數如後圖

上

中

下

先以左上地三畝徧乘右行得數

次以右上地六畝徧乘左行得數上位各得地十八畝對減盡中位左得田三十畝內減去右得九畝餘二十一畝爲法下位折田左得三十三畝內減去右得十四畝一分餘十八畝九分爲實以法除實得九分爲田每畝折實數

就以右田三畝折二畝七分減右折實共四畝七分餘二畝以右上地六畝除之不滿法命爲三分畝之一爲地每畝折實數【或於左行折實五畝五分內減去左田五畝該折四畝五分餘一畝以左地三畝除之亦得地折實每畝三之一】

論曰以右上地六畝徧乘左行是各六之也爲三畝地者六爲五畝田者六爲地三畝田五畝之折實田共五畝五分者亦六也以左上地三畝徧乘右行是各三之也爲地六畝者三爲田三畝者三爲地六畝田三畝之折實共四畝七分者亦三也以之對減而地在上位者各十八畝旣對減而盡則其各十八畝之折實在折實共數中者亦必對減而盡也田在中位者旣對減去九畝而僅餘左行之二十一畝則其各九畝之折實在共數中者亦必對減而盡也由是以觀則其所餘之左下折田十八畝九分正是左中余田二十一畝之所折也故以余田二十一畝爲法而以余折田十八畝九分爲實卽田之折數可知知田數知地畝矣

若以折問田畝則一十八畝九分折爲法二十一畝田爲實實如法而一得每折一畝原田一畝又九分之一於是以分母九通右行田三畝得二十七分而以一畝又九分之一共一十分爲法除之得二畝七分以減共折四畝七分余折二畝以除右地六畝得每折一畝原地三畝【以上二色例也三色四色以至多色凡和數者皆同但須重例減余以求之今不悉具於後諸條中詳之】

較數方程例

凡較數方程分正負之價與盈朒略同但盈朒章有盈朒又有出率方程則但有總物與盈朒而無每出之率又兼數色所以不同又盈朒者是有每率而不知總所言盈朒適足是總計所出以與原立總價相較之數也方程正負則是兩總物自相較之數若不立正負則下價之與上物不知其孰爲同異矣此正負之法異於盈朒也【負與正對所以分別同異蓋對數之所餘卽正數之所欠故謂之負與負責之負略相似老子言萬物負陰而抱陽蓋正卽正面負卽反面也開方法有負隅言隅之空隙也郭太史歷經三差法有負減言反減也本於平差內減去立差今立差反多於平差故於立差內反減平差是爲負減兼此數端而正負之義可見矣】

法曰任以一色爲正則以相當之一色爲負【此據二色者言之三色以上或以一色與多色相當或以多色與多色相當其法皆同二色】正物之價多爲正價負物之價多爲負價正與負爲異名異名相並正與正負與負爲同名同名相減

首位同名者仍其正負不變【首位同數同名卽可減去此正法也】首位異名變其一一以相從【首位亦同數但不同名故變而同之則亦同數同名而可減盡矣首位旣變則其行內皆從而變此通法也蓋必如是則同減異加始歸畫一而於和較交變之用尢便也】

其法皆於互乘時以得數變之蓋減並只用得數也只變一行其相對之行不必再變二色三色以至多色並同何也三色以上行數𨿽多而乘並之用皆以各相對之一行論同異卽同二色之理

論曰和數方程有減無並皆同名故也較數方程有減有並或同名或異名也減並者方程之綱要正負淆則同異之名混而並減皆失矣今諸本所言正負同異誃離舛錯𨿽加減得數皆偶合耳西人論句股三角八綫割圜幾何原本可謂詳矣矣至方程增立諸率亦復艸艸未窮其故也

用法曰以一色列於上以相當之一色列於中任以一色爲主而分正負【此亦以二色爲例三色以上皆以兩相當者主其一以分正負皆與二色法同】

以兩色相較之價列於下以正物爲主而分同異或正物所多之價命之爲正或正物所少之價命之爲負【正物之所少卽負物之所多】或正物負物之價兩相若命之適足則空位列之亦以列上位者爲乘法左右互乘徧乘中下以首位爲主而變正負得數對減其上一色必數相若且又同名而減盡中一色與下價或同名或異名異名者並之同名者對減取其減並之數以爲用一爲法一爲實以法除實得中一色每價以原列中物乘之得中物總價以與原列下價同名相減異名相並得數以原列上物除之得上一色每價【其上中亦可互求】

假如以研七枚換筆三矢研多價四百八十文若以筆九矢換研三枚筆多價一百八十文問筆研價各如幹

畣曰筆每矢價五十文研每枚價九十文

法各列位

上

中

下

先以左行研負三徧乘右行得數【首位異名須變一行以相從故研正變爲負筆負變爲正價正變爲負皆於得數變之】

次以右行研正七徧乘左行得數【右行旣變則左行不必再變故研負筆正價正皆仍舊】

於是以上研各負二十一同名相減盡次以中筆兩正同名相減餘五十四爲法再以下價左正右負異名相並得二千七百爲實以法除實得五十文爲筆價以左行筆正九乘筆價得四百五十內減同名價一百八十餘二百七十以左研負三除之得九十爲研價或以右筆負三共價一百五十加異名價正四百八十共六百三十以右研七除之亦得研價九十

論曰左行原是九筆多於三研一百八十文乘後得數則是六十三筆多於二十一研共一千二百六十文也右行原是七研多於三筆四百八十文乘後得數則是九筆少於二十一研一千四百四十文也於是以兩行得數較之上位研負二十一兩行盡同研之數同則其價亦同惟中位筆數左行多五十四枝則是左行筆多價一千二百六十文者以多此五十四筆而右行筆少價一千四百四十文者以少此五十四筆也夫右行筆價原少於二十一研者一千四百四十文以左行多五十四筆而反多於二十一研者一千二百六十文是此五十四筆旣補卻右行之所少而仍多此數也故並右行之所多共此二千七百以爲五十四筆之價知筆價知研價矣

若先求研價者以研列中爲除法以筆列上爲乘法如後圖

問者或云筆三矢換研七枚少價四百八十文又有研三枚以換筆九矢少價一百八十文則其下價爲兩負【四百八十是筆少於研之價一百八十是研少於筆之價】

先以左行筆負九徧乘右行得數【首位異名宜變一行故其正負皆更之】

次以右行筆正三徧乘左得數【右變則左不變故正負皆仍之】於是以得數較其同異而爲之減並筆各負二十七同名減盡研正同名相減餘五十四爲法價正負異名並得四千八百六十爲實實如法而一得九十爲研價以研價乘左正研三得二百七十異加價負一百八十共四百五十以左負筆九除之得五十爲筆價或以右研七價六百三十與價四百八十同減餘一百五十以筆三除之亦得筆價五十

論曰左行原是研三少於筆九者一百八十文乘後得數則是九研少於二十七筆者五百四十文也右行原是三筆少於七研者四百八十文乘後得數則是六十三研多於二十七筆者四千三百二十文也夫兩行筆皆二十七則其價同也而右行研價多於筆四千三百二十文左行研價反少於筆五百四十文是兩行研價相差者共四千八百六十文也推求其說則只是兩行中相差五十四研之故也故減去相同之筆用此相差之研以除此相差之研價而每研之價可知矣

若如難題所列以研爲正筆爲負問者當云以七研換三筆研多價四百八十以三研換九筆研少價一百八十文則價右正左負【難題系書名】

左右研正徧乘得數【首位本同名故其正負皆不變】研減盡筆餘五十四爲法價異並二千七百爲實法除實得筆價以次得研價如前若以筆爲正研爲負則其價右負左正

依法先得研價如第一圖

以前四圖或以筆爲正或以筆爲負或以研爲正或以研爲負或以價爲兩正或以價爲兩負或以價爲一正一負其所呼正負之名無一同者要其爲同異加減之用則一也

試以一行中同異言之其左行之價必與筆同名何也左行之價乃筆多於研之數也故與筆同名而與研異名也其右行之價必與研同名何也右行之價乃研多於筆之數也故與研同名而與筆異名也試以兩行中同異言之其上位皆減盡其中位皆相減爲法其下價皆相並爲實其減也皆以同名其研也皆以異名此下價異並例也

假如有大小餘句不知數但云倍小餘句以當三大餘句則不及一丈五尺三寸若倍大餘句則如七小餘句

畣曰大餘句六尺三寸小餘句一尺八寸

法以正負列位

先以左小餘句負七徧乘右得數【首位異名宜變以相從故小句變負大句下負數皆變正】

次以右小餘句正二徧乘左得數【右行旣變則此行不變下適足無乘亦無正負】乘訖乃較之小餘句各十四同減盡大餘句同減餘一十七爲法下正數十丈零七尺一分無對不減就爲實以法除實得六尺三寸爲大餘句乃置左行二大句該一丈二尺六寸以左行相當適足之七小句除之得一尺八寸爲小餘句【或用右行三大句該一丈八尺九寸以同名負一丈五尺三寸減之餘三尺六寸以右行二小句除之亦得一尺八寸】合問

論曰以左小句徧乘右是各七之也爲小句二大句三者七其相較之數亦七也以右小句徧乘左是各二之也爲小句七大句二者二其相當適足者亦二也但以首位必同名然後可減故以右小句正變而爲負以從左名也小句變爲負則所與相較之大句不得不變而正矣於是小句同減盡大句同名減去四餘右行正十七下較數無減仍餘十丈○七尺一寸然則此所餘者正是減余大句之數矣何也小句十四左右皆同若只如左行四大句則與小句相當適足矣而今右行獨余此較數者非以右多十七大句之故乎

試以大句列於上則先得小句如後圖

如法左乘右更其正負右乘左仍其正負大句同減盡小句同減余正一十七在左行爲法下較數負三丈○六寸在右行無對不減就用爲實以法除實得一尺八寸爲小句就以左行小句七該一丈二尺六寸以左相當適足之大句二除之得六尺三寸爲大句【或於右行正一丈五尺三寸加異名小句負二該三尺六寸共一丈八尺九寸以右大句三除之亦得六尺三寸】

論曰左行原是小句七以當大句二適足今以右大句乘而各三之則是小句二十一以當大句六而亦適足也右行原是大句三以當小句二而大句多一丈五尺三寸今以左大句乘而各二之則是大句六以當小句四而多三丈○六寸也以兩行之得數較之大句旣減盡惟左行之小句餘一十七則是左行得數所以相當適足者以多此十七小句之故而右行小句得數小於大句三丈○六寸者以少此十七小句之故也然則此三丈○六寸者正是十七小句之數也【依此論可見左行之所多卽右行之所少故左行名正者用於右行卽爲負而隔行之異名卽爲同名】

此下較無減例也

假如有大小方積不知數但云一大方積以當二小方積多數八十九若以三大方積當七小方積仍多二百五十一

畣曰大方積一百二十一小方積一十六

法以正負列位

上

中

下

先以右大積一徧乘左行皆如原數次以左大積三徧乘右行得數【首位同名故兩行正負皆不變】大積同減盡小積同減餘一爲法較數同減餘一十六爲實法除實仍得一十六爲小積以右行小積負二該三十二加異名正八十九共一百二十一爲大積【或以左行小積負七該一百一十二加異名正二百五十一共三百六十三以左大積三除之亦得一百二十一爲大積】

論曰左行原是大積三多於七小積者二百五十一乘後得數亦同右行原是大積一多於二小積者八十九乘後得數則是大積三多於六小積者二百六十七也於是以兩行對勘其大積旣減盡惟小積左行余負一其下較數則右行余正十六夫此十六數者與大積同名是右行大積之數也右行少一小積而大積之盈數多十六左行多一小積而大積之盈數少十六然則此十六數者正是此一小積之數矣若以小方積爲正則其下較數爲兩負【皆小積所少之數也故皆爲負】

上

中

下

依法徧乘對減余大積一爲法余負一百二十一爲實法除實不動就以一百二十一爲大積右大積一該一百二十一同名減負八十九餘三十二以小積二除之得一十六爲小積

此是右行多一大方積故多一同名之數一百二十一同在一行易知不須重論

以上二圖正負所呼迥異然所同者兩行之較數皆與大方積同名何也皆大方積多於小方積之數故與大方積同名而與小方積異名也

此下較同減例也

總論曰凡較數方程原列較數是本行中正與負之較也其乘後得數同減異加而得者則是兩行中正與正之較或負與負之較也故本行中以異名相較而兩行對減或加是以兩行之同名相較

假如原列較數與正物同名是正多於負之較也若列較與負同名是負多於正之較也故曰本行中異名相較也

假如乘後得數而兩行之較數皆與正物同名則兩較亦自同名乃以之對減而余在一行則知此一行正物必多於對行之正物而其所多之數卽如此所餘之較數矣

假如兩行較數皆與負物同名則兩較亦自同名以之對減而余在一行則知此一行負物必多於對行之負物而其所多之數正是此所餘之較數矣此同名相減之理也

假如右行較數與正同名而左行較數卻與負同名則一是正多於負之數而一是負多於正之數也夫正與負原相待負多於正之數卽正少於負之數也於是用異名相加法以左行負多於正之數變爲正少於負之數以相並則知右行之正數必多於左行之正物而其所多幾何正是此兩較之並數矣此異名相加之理也

合同減異並而觀之總是兩行中同名相較也

又論曰較數方程以兩相較而爲用𨿽有三色四色乃至多色其相較也必兩此正負所由立也立正負以別同異猶彼我也夫彼我者豈有一定之稱哉以此爲正則以彼爲負若以彼爲正則此反爲負矣正負之相呼猶彼我之相視也故曰無定𨿽然無定者正負有定者同異其無定者在未立正負之先其有定者在旣立正負之後旣以一爲主則同乎此者皆同名異乎此者皆異名矣是故無定而實有定也

今試以所列方程最下位觀之其言正負者必上物之較數也不言正負者必上物之和數也較數有盈有朒有適足和則否

假如下價盈則爲正正與正同名試於正物價之中減去下同名正價之盈則所餘之價必與負物之價相當矣正與負異名試又取上負物之價以加下異名正價則又必與正物之價相當矣

假如下價朒則爲負【正物之朒負物之盈也】負與負同名試於負物價之中減去下同名負價則所餘之價必與正物之價相當矣負與正異名試又取上正物之何以加下異名負價又必與負物之價相當矣

假如下價適足空位無盈朒則其上正負物價必自相當

又論曰正負之術分別同異全在有交變之法以通其窮要其爲用惟在使兩行之首位同名而已何也方程以互乘遞減立法每乘一次卽減去一色然惟和數則一乘之後卽可對減若較數則有同數而不同名之時若不減首位卽不成方程若徑以異名而減勢必以同名而並法不畫一而於後條和較交變之時益混淆而難用故以法變之使首位之同數者無不同名而仍爲同名利減焉首位旣以同名減則凡減者皆同名凡並者皆異名而其法畫一矣故首位旣變則行內之正負皆變何也從首位也行內之正負旣皆從首位而變由是而原與首位同名者皆與隔行之首位同名也原與首位異名者卽與隔行之首位異名也如此則隔行之同減異並亦淸矣正負猶陰陽也牝牡也各行中各有正負猶兩儀之生四象也乘而交變猶剛柔相推而生變化也隔行之正本行以爲負隔行之負本行以爲正眞陰眞陽互居其宅也同名相減者陰陽之偏不得其配也異名相並者陰陽得類雌雄相食也是皆有自然之理焉可以思古人立法之原矣

【以上亦以二色者舉例三色以上乃至多色正負之用尢顯詳具諸卷中玆不贅列然其理著矣】和較相雜方程例

方程之用以禦隠雜妙在雜與變知其雜則雜而不用矣知其變則變而不失其常矣諸書所論胥未及此故求之甚詳去之愈逺也

用法曰凡方程和較雜者和較從和法列之不立正負較數從較法列之明立正負其偏乘得數後在

較數行中者仍其正負之名在和較行中者皆變從乘法之名【和數原無正負則無可變但乘後得數取其與較數之首位同名而已首位旣同名下不得不同名矣】

凡兩較者下價或有減有並而中物只同減若一和一較者下價亦有減有並而中物皆異並此以兩色言之三色以上隨數通變皆以同異名禦之

假如有大小句不知數但云三其大句倍其小句共三丈三尺若倍大句則如六小句問若干

畣曰大句九尺小句三尺

法以一和一變列位【適足者以相較而得名卽同較義】

右行和數也不立正負左行較數也明立正負右乘左而三之和乘較也故其正負皆如故

左乘右而二之較乘和也故得數皆爲正從乘法之名也如法徧乘訖以兩行對勘大句同名相減盡小句異名相並得二十二爲法正數六丈六尺無減就爲實法除實得三尺爲小句以左行小句六共一丈八尺爲實以大句二爲法除之得九尺爲大句【或於右行共三丈三尺內同減小句二共六尺餘二丈七尺以大句三除之亦得九尺】

論曰右行大句三小句二共三丈三尺乘後得數則是六大句四小句共六丈六尺也左行大句二小句六其數相當乘後得數則是六大句十八小句亦相當適足也於以對減而兩大句同減盡則其數同也而右行正數猶有六丈六尺左則無有其故何也右行正數中有小句四而左則無且不惟無之而已其相對之負數反有十八小句焉是左行正數又自除卻十八小句之數也右行正數多四小句左行正數又自除卻十八小句則是右行正數之多於左行正數者二十二小句也故並此二十二小句爲右行所多之正物其六丈六尺則右行之正數也以正物除正數而小句可知知小句知大句矣

又細攷之六大句合四小句共六丈六尺則以與六大句相當之十八小句合四小句亦必六丈六尺也此亦西儒比例之理而以同異名盡之可見古人用法之簡快試更列之以小句居上則先得大句亦同

上

中

下

先以右小句二徧乘左行得數【和乘較也故仍其正負】

次以左小句六徧乘右行得數【較乘和也故皆命爲負與乘法同名】兩小句同減盡兩大句異並二十二爲法負數十九丈八尺無減就爲實法除實得大句九尺以右行大句三該二丈七尺減共三丈三尺餘六尺以小二句除之得小句三尺

論曰小句互乘之後則其數同也小句數同則負數亦同而右行之負數獨有十九丈八尺左則無有者以右之負數中有大句十八而左則無不惟無也其所對之正數中反有大句四是左行負數中又原少四大句也右負數多十八大句左負數少四大句是右之負數多於左之負數者共二十二大句也然則右之負數獨有此十九丈八尺者正是此二十二大句之數也

此和數與適足偕也

假如有江湖兩色船載物不知數但云江船五以較湖船一則江多二千八百石江船三湖船五則共載二千八百石問船力若干畣曰江船六百石湖船二百石

法以一和一較列位

如法左右徧乘得數

江船同減盡湖船異並二十八爲法載物同減餘五千六百石爲實法除實得二百石爲湖船數以湖船數加右行異名正二千八百共三千石以

右江船五除之得江船數六百石【或以湖船五共一千石同減左行二千八百石餘一千八百石以左江船三除之亦得六百石】

論曰徧乘後江船數同則其載數亦同今以兩正數相減而左多五千六百者以左正數中有湖船二十五而右則無不惟無也其所對之負數中反有湖船三是右行正數中又自少三湖船也左多二十五右少三是左正數多於右數者共二十八湖船也然則左之正數獨多五千六百者正此二十八湖船之數也此和數偕一正也負亦同

和變交變方程例

凡方程三色以上以減余重列則有和變較較變和者不可不察也若非和較之雜則二色方程之中物有減無並矣若非和較之變則三色四色方程和數者有減無倂矣夫和數較數非自我命之名也其下價之爲和爲較不可誣也

用法曰和變較者但和數減余有分在兩行者兼而用之卽變較數也和旣變較卽以較數法列之其法以一行之餘數命爲正以一行之餘數命爲負其下余價以與中位餘物同在一行者卽爲同名從其正負而命之若下價減盡無餘者命爲適足若減余只在一行者無變也只用和數法

較變和者但視較數減余或有一行內皆正或皆負者卽變和數也卽如和數法列之不立正負【其較數異並者以一行爲主而以隔行之之異名從本行爲同名】

若減余行內有正負者無變也只用較數法

若有兩異並而一位左正右負一位右正左負亦仍爲較數不變𨿽減余分在兩行而一行余正物一行余負物亦和數也何也隔行之異名乃同名也若減餘同名而分余於兩行卽仍爲較數不變何也隔行之同名乃異名也

若兩異並皆左正右負或皆左負右正亦和數也和較重列有俱變爲較者有只變一行爲較而余行如故者較數重列有俱變爲和者有只變一行爲和而其餘如故者皆如上法以和較雜列之

若四色以上有和變較較復變和者有較變和和復變較者皆以前法禦之

假如以衡校弓弩之力但云大神臂弓二弩九小弓二共重七百一十斤又有神臂弓三弩二小弓八共五百二十五斤又有神臂弓五弩三小弓二共五百一十五斤問各力

畣曰大神臂弓力五十五斤弩力六十斤小弓力三十斤

法先以和較列位【凡三色者可任以一行爲主與餘二行數相乘而減並之故前後之行可互更也詳見第三卷

】

先以中行神臂弓二爲法徧乘左右得數【此以中行爲主與左右互乘取其行間易爲減並之用也】

次以右行神臂三徧乘中行得數與中行對減神臂弓中右各六對減盡中弩二十七內減去右弩四餘二十三【中行余也】中小弓六去減右小弓十六餘十【右行余也】中力二千一百三十內減去右一千○五十餘一千○八十斤【中行余也】

以上減余分在兩行已變較數矣卽用較數之法分正負列之而以弩與力命爲同名【弩與力同在中行故也】次以左行神臂五徧乘中行得數而以中左兩行對減神臂弓各十減而盡中弩得四十五內減去左行弩六餘三十九

中行小弓得十內減去左小弓四餘六中力得三千五百五十內減去左一千○三十餘二千五百二十斤

以上減余俱在中行仍爲和數也不分正負

論曰此和數方程變爲一和一較也何也中右得數兩大弓減盡則其力相若也弩數相減而余在中行是中行之弩力多於右行也小弓相減而余在右行是右行小弓之力多於中行也弩力中多於右小弓力右多於中而今共力相減惟中多一千○八十斤則是此一千○八十斤者非余弩余弓之共數而余弩所多於余弓之較數也𨿽欲不分正負不可得也如中左對減而余弩余小弓俱在中行則中行之餘力二千五百二十斤者仍爲余弩余小弓共數無正負之可分也故以此兩減餘者依和較雜法重列而求之

如前對減旣於共力中淸出首一色大神臂弓不與弩小弓雜矣然所餘之力尙爲弩小弓共數與其較數而未能分別此二色之每數也故必重測

依和較雜法以左右余弩互徧乘得數【左乘右和乘較也故仍其正負右乘左較乘和也故變從乘法之名皆曰正】

弩同減盡小弓異並五百二十八爲法力同減餘一萬五千八百四十爲實法除實得三十斤爲小弓力以小弓力乘右行余小弓十得三百斤異如力正一千○八十斤共一千三百八十斤以余弩二十三除之得六十斤爲弩力【或於左行共力二千五百二十斤內同減小弓六該一百八十斤餘二千三百四十斤以余弩三千九除之得六十斤亦同卽此可見兩減余之爲一和一較】乃於原列任取右行八小弓力二百四十斤二弩力一百二十斤以減共力五百二十五斤餘一百六十五斤以大神臂弓三除之得五十五斤爲大神臂弓力

論曰兩弩正數同而其力不同者小弓之故也左行和數也是弩偕小弓之力也右行較數也是弩力中減去小弓之力而餘者也合而觀之則是左行之弩力有小弓一百三十八以爲之益而右行之弩力反減去小弓三百九十然則左行正數之多於右行者凡共差小弓五百二十八而左行正數所以多於右行一萬五千八百四十斤者正是此小弓五百二十八之力也

凡此減余之數亦可互求若更置之以小弓列上則先得弩力如後圖

上

中

下

依法右左徧乘得數【左乘右和乘較也故仍其正負右乘左較乘和也故變從乘法之名皆名之曰負】

小弓同減盡弩異並得五百二十八爲法力異並得三萬一千六百八十爲實法除實得六十斤爲弩力以弩力乘右行弩二十三得一千三百八十斤同減正一千○八十斤餘三百斤以小弓十除之得小弓力

論曰兩小弓同名負其數旣同而左行負數之力有若干右則無之而且反小於正數之力若干者何也以左行負數中有弩三百九十右則無之而其所對之正數反有弩一百三十八以爲之除算則是左負數之多於右者共五百二十八弩也右負數少此五百二十八弩而正數力遂多六千四百八十斤左負數多此五百二十八弩則不但補卻右行之所少而又自有力二萬五千二百斤然則左行共多於右三萬一千六百八十斤者正是此五百二十八弩之力也此三色和變較例也【四色以上雜見諸卷中】

問有甲乙丙三數甲加七十三得爲乙丙數者倍乙加七十三得爲甲丙數者三丙加七十三得爲甲乙數者四其本數各幾何畣曰甲七乙十七丙廿三

法先以較數列位

先以中行甲正一徧乘右左得數皆如故【只變中行故兩行之正負俱不變又是一數爲乘法故數亦不變】

次以右行甲負三徧乘中行次以左行甲負四徧乘中行各得數【左右旣省不變故變中行以從之首位變負下三位俱變正】

次以中右得數相減並甲同減盡中乙得正六同減左得正一餘正五中丙得正六異並右得負三共得正九中較數得正二百一十九異並右負七十三共得正二百九十二

次以中左得數相減並甲同減盡中乙得正八異並左得負四共得正十二中丙得正八同減左得正一餘七正中較數得正二百九十二異並左負七十三共得正三百六十五以上減並之數皆同名又皆在一行知已變爲和數重列之不分正負【依此顯𨿽同名而或乙正在中丙正在左卽不得變和數也何也左行之正中行之負也】

論曰此較數變爲和數也以中右之得數言之中行六个乙六个丙共多於三个甲者二百一十九右行一个乙少於三个甲三个丙者七十三於是兩相對較則兩行之甲皆三个其數本同而中行之乙丙多於甲二百一十九者因中行之乙多於右行之乙者五个又有同名之丙六个以益之而中行之甲又非若右行之甲與三个丙同名是又少三个丙也夫甲股內少則乙丙股內多合而觀之則是中行之乙丙股內共多五个乙九个丙而右行之乙股內共少此五个乙九个丙也夫中行之乙丙股內多五个乙九个丙便多於三个甲者二百一十九右行之乙股內少五个乙九个丙則不惟不多而反少於三个甲者七十三然則並此多二百一十九少七十三共二百九十二者正是此五个乙九个丙之共數而非其較數也故不分正負

又以中左之得數言之中行正數是八个乙八个丙負數是四个甲而正數多者二百九十二左行正數是一个丙負數是四个甲四个乙而正數少者七十三於是兩相對勘則兩行負數之甲皆四个其數本同惟中行之正數內比左正數多七个丙又加八个乙而中行之負數又比左負數少四个乙合而觀之是中行之正數比左行共多十二个乙與七个丙而左行之正數比中行共少十二个乙七个丙也然則中行正數之多於負數二百九十二者以多此十二个乙七个丙而左行正數之反少於負數七十三者以少此十二个乙七个丙也則是並此多二百九十二少七十三之數共三百六十五者正是此十二个乙七个丙之共數而非其較數也故亦不分正負

如法以乙數左右互徧乘得數相減【無正負故有減無並】乙減盡丙減餘七十三爲法下位餘一千六百七十九爲實法除實得二十三爲丙數以丙數乘左行丙七得一百六十一以減共三百六十五餘二百○四以左乙十二除之得一十七爲乙數又以乙數異加原列右行負七十三共九十內減原右行丙三該六十九餘二十一以原右行甲三除之得七爲甲數

論曰此同文算指所立疊借互徵設問之一也原法繁重今攺用方程簡易如此

此所設問三色方程耳以西術求之已不勝其難況四色以往乃至多色乎此亦足見方程之不可廢而古人別立一章之誠有實用也

此三色較變和例也四色以往至於多色則其變益多要不出於和較例具後諸卷中玆不詳列

歷算全書卷四十

欽定四庫全書

歷算全書卷四十一

宣城梅文鼎撰

方程論卷二

極數

吾論方程至和較之雜之變盡矣𨿽然不知帶分疊腳重審之法無以窮其致故極數次之

極數有三一帶分二疊腳三重審皆不離乎和較之四術帶分方程例

法曰視原問中有云防分之防者則以分母通其全數而列之或云有物防數又防分之防者以分母通其全數而納其子如法列位徧乘減並以求一法一實旣得法以除實而得者卽所求物之一分也以所得一分之數分母乘之則爲物之全數矣

或云防分之防又防分之防者以兩分母相乘爲全數而列之又以兩分母互乘其子爲所用之分而列之所用之分同在一行者並而列之分用於兩行者不並也並之而所用之分反大於全數者以全數除之命爲幾全數又幾分之幾其入算乘除仍用所並之分得數後則只以全數之分乘之爲全數【以上兩法皆化整爲零乘除竟用零分故先得一分之數】

又法

凡較數有以此之全數當彼之防分之防者則通其一行之內皆以分母乘之而後列焉則其所得卽爲全數而非其一分也【如雲乙得甲三分之二則以分母三乘乙全數得全乙者三乘甲之二分得六分是爲全甲者二則以三乙當二甲而列之驟視之如倒列其子母其實皆全數耳】若有正負之數亦以分母乘而列之【亦全數非零分也是爲以零變整與化整爲零之法不同故徑得其全數所用乘除皆整數非分故也】得卽爲整【其所用分母只在本一行中如一物有兩分母又分用於各行則各以其行中分母爲用】凡和數中有一位帶分而余只全數者亦可以分母通乘而列之其所得亦爲全數而非分【如甲三乙二又三之一共十六則以分母三乘甲得九乘一二得六乘乙之一得三亦整一也並得整七乘共十六得四十八是爲甲九乙七共四十八變零爲整徑以整數乘除所得卽爲整數】

又法

凡帶分之法或化整爲零或變零爲整取其畫一也此外又有雜用零整之法亦所當知【如行中有幾位或原帶有零分者以化整爲零法列之其原未帶分者只以整數列之但乘除得數後整列者所得卽爲整數零分列者所得只爲零分之數仍須以分母乘之爲全數】

又法

視所帶之分有可以分母除之而盡者則以所除分秒附於整數而列之則其乘除後得數亦爲所求之全數【若分母除其子不能盡者則不用此法】

今有甲字庫貯金丁字庫貯銀各不知總但云取甲四之三加丁五之二則一百一十萬若以甲加丁之倍數則四百四十萬問各若干

畣曰甲庫金四十萬丁庫銀二百萬

法以分子甲之三分丁之二分列右

以分母四通甲整一得四分以分母五通丁整二得十分列左

依和數法互乘對減餘丁之分二十二爲法餘八百八十萬爲實

法除實得四十萬爲丁之一分以丁之分母五乘丁之一分得二百萬爲丁庫銀數乃以丁庫數倍之得四百萬減四百四十萬餘四十萬爲甲庫金數此化整從零法也【原列零分故得亦零分之數】

又法以丁分母五互甲之三得十五以甲分母四互丁之二得八列右乂以兩分母【五四】相乘得二十爲甲丁共母以乘一甲得二十乘倍丁得四十列左乃以甲丁共母乘一百一十萬得二千二百萬列右乘四百四十萬得八千八百萬列左【分母相乘爲母母互乘子只是通分之法妙在以分共母乘其和數而零數皆爲整用矣此用法之妙】

上

中

下

依法乘減餘丁四百四十爲法八億八千萬爲實以法除實得二百萬爲丁數以丁四十計八千萬減八千八百萬餘八百萬以甲二十除之得四十萬爲甲數此變零爲整法也【原列整數故所得卽爲整數】

又法以甲分母四除之三得七分五秒以丁分母五除之二得四分列之則其餘數皆不變

左甲一乘右行皆如原數右甲○七分五秒乘左行各得四分之三甲各○七分五秒盡減丁餘一一【上一整數下一一分乃十分之一】爲法共數減餘二百二十萬爲實法除實得二百萬爲丁數以丁數倍之減共數餘四十萬卽爲甲數

此除零附整法也【零分旣除爲分秒則乘除之際皆以整數爲主故所得亦卽爲整數】

今有甲乙二數不知總但云取乙五之三又取乙四之一以益甲則甲之數倍取甲三之二又取甲七之二以與乙較則乙多數二百四十問甲乙本數各防何畣曰甲本數一千○七十一乙本數一千二百六十

法以較數帶分取之本二色也卻有三位以分母通之仍二位也先以乙分母【五四】相乘得二十以當乙之全數又以分母五互乘分子一得五以分母四互乘分子三得十二並之得十七以當乙所益甲之分是爲乙二十分之十七以益甲也

次以甲分母【三七】相乘得二十一以當甲之全數又以分母三互乘分子二得六以分母七互乘分子二得十四並之共二十以當甲所與乙較之分是爲甲二十一分之二十以與乙較也

於是分正負列位

依較數法乘減乙餘八十分爲法負數無減就以五千○四十爲實法除實得六十三爲乙之一分以乙全分二十乘之得一千二百六十爲乙本數乙本數同減負二百四十餘一千○二十卽甲與乙較之分也以左行甲之二十分除之得五十一爲甲之一分以甲全分二十一乘之得一千○七十一爲甲本數

乃細攷之置乙本數【三】因【五】除之得七百五十六爲五之三又置一本數【四】除之得三百一十五爲四之一並兩數共一千○七十一則與甲數同故以此益甲而甲倍也置甲本數【二】因【三】除之得七百一十四爲三之二又置甲本數【二】因【七】除之得三百○六爲七之二並兩數共一千○二十以此較乙則不及二百四十

此只是以乙之分與甲較又以甲之分與乙較也末捲所列諸率則是以乙之分益甲而轉與乙所存之分相較又以甲之分益乙而轉與甲所存之數相較故自不同合而觀之則見

今有寶泉寶源二局鑄錢不知總但云取寶源五之四又四之三以益寶泉則寶泉之數倍若取寶泉三之二以與寶源較則多於寶源四十二貫

畣曰寶泉原數一千九百五十三貫寶源原數一千二百六十貫

法先以寶源分母【五四】相乘得二十分爲全數又以分母五互乘分子【三】得十五分母【四】互乘分子【四】得十六並之共三十一分爲寶源所以益寶泉之分全數二十分所用以益寶泉者反有三十一分是爲以寶源全數又二十分之十一以益寶泉也其寶泉只一分母故不用乘並

乃列位

如法乘減中位餘二分爲法下位餘一百二十六貫爲實

法除實得六十三貫爲寶源局二十分之一分以分母二十乘之得一千二百六十貫爲寶源數以寶源數異加正四十二貫共一千三百○二貫卽寶泉局三分之二也於是以分子之二除以分母三乘得一千九百五十三貫爲寶泉數【置寶源數四因五除之得一千○八爲五分之四又置寶源數三因四除之得九百四十五爲四之三並兩數亦恰得一千九百五十三貫如寶泉數以加寶泉是爲寶泉者倍也】

論曰乘得數後寶泉分數同惟右行之寶源多於左行者二分而遂能與寶泉等若左行之寶源少此二分而其少於寶泉者遂一百二十六貫然則此一百二十六貫者正是寶源之二分矣【知分數卽知全數知寶源卽知寶泉】此二則皆化整爲零而分母不同也

今有貨泉刀貝四種之幣各不知數但雲泉八之一兼刀布七之二則如貨數也若刀布七之三兼貝六之四則其數如泉也若貝六之五又外加數八千九百七十則如刀布也若貨數自加九之一則其數如貝也問本數各防何

畣曰貨五千一百三十泉九千六百八十

刀布一萬三千七百二十貝五千七百

法以各分母通其原數然後以正負列之貨分母九泉分母八刀布分母七貝分母六【丁行貨合數一】

【又九分之一共十是爲九分之十凡全數帯分者準此】

先以甲行貨正九分爲法徧乘丁行得數又以丁行貨負十分爲法徧乘甲行得數【因首位異名故變一行以相從而以丁從甲】乃以甲丁兩行得數相減貨同減盡甲行泉負十分刀布負二十分皆無對不減丁行貝負五十四分亦無對不減下適足無乘無減仍爲適足

乃以泉刀同名在甲行者爲一類貝同名在丁行者爲一類分正負重列而求之【丁行之負甲行之正也】

因余行已無貨位當以泉爲乘法尋乙行中有泉徑用與減余相對

如法徧乘得數乃相減並泉同減盡刀布異並得【正】一百九十分貝同減余負三百九十二分以減余爲主命其正負而重列之

因余行又已無泉當以刀布爲乘法尋丙行有刀布徑用與減余相對

上

中

下

如法徧乘得數刀布同減盡貝同減餘一千七百九十四分爲法正一百七十萬四千三百無減就爲實法除實得九百五十爲負之一分以丙行貝之五分該四千七百五十異加正八千九百七十共一萬三千七百二十爲刀布原數以刀布分母七除原數得一千九百六十爲刀布之一分以刀布之三分該五千八百八十貝之四分該三千八百並之得九千六百八十爲泉數【用乙行也】以泉分母八除泉數得一千二百一十爲泉之一分以泉之一分加刀布之二分三千九百二十共五千一百三十爲貨數【用甲行也】以貨分母九除貨數得五百七十爲貨之一分以貨數加一分共五千七百爲貝數【用丁行也】

甲丁兩行乘減論曰旣互乘則甲丁之貨等而甲行之泉若刀布及丁行之貝又各與其首位之貨等則甲之泉若刀布必與丁之貝等也故對減去貨而徑以甲之泉若刀布與丁之貝分正負而命之適足也此卽西學中比例之理然方程中自有之且簡快如此

乙行減並論曰左右兩行之正負皆適足若於右正數內減左正右負數內減左負其所餘者亦必適足也今右正內旣減去同名之泉右負內又減去同名之貝而左負內有刀布不與右同名不能相減故反用以加加則正數多正數多則負數少而其數亦必適足矣

又論曰隔行之異名乃同名也今兩行之正與負旣皆適足若以左之正【泉】益右之負【貝】而共爲負以左之負【刀布貝】益右之正【泉刀布】而共爲正則亦適足也於是以兩者【右泉刀布左刀布貝爲一類左泉右貝爲一類】對減其相同之物【泉各減八十分貝各減四十分】則其所餘之物必亦適足也【左右刀布爲正右貝減余爲負】

又論曰右行刀布正數也正多於負之數也左行刀布負數也正少於負之數也合此二數則是右正之多於左正者此兩行之刀布也然刀布之數右正𨿽多於左正而貝之數右負亦多於左負故兩行皆適足也然則右正之所多與右負之所多亦必相當適足矣

丙行乘減論曰刀布本同惟右之貝多於左右之貝多則左之貝少左之貝少則刀布多矣然則左之刀布布獨有盈數者正是此相差之貝也

此亦化整爲零而又有整帯零【四色有空之例也】

問品官月俸六品爲五品八之五七品爲六品四之三八品爲七品十五之十三九品爲七品十五之十一倍九品加八品六品七品各一則如五品之倍數而多三石各若干

法以分母各通其原數而正負列之五品通爲八六品通爲四七品通爲十五八品九品以全數原無分母故也【五品倍則爲十六】

先以甲行五品十六分徧乘乙行五品六品得數【余空位無乘】次以乙行五品五分徧乘甲行得數乃對減五品各八十分同名對減盡六品同名對減餘四十四分乙行之負物也爲乙類

七品八品九品並祿米較數皆無對不減皆甲行之負物負數也爲一類分正負列之與丙行相對

如法以減餘六品分徧乘丙行六品七品分得數【余空無乘】

又以丙行六品分徧乘減余得數乃以對減六品得數各一百三十二分同名減盡七品同名減餘四百三十五分丙行之負物也自爲一類其餘三位無減皆減余之負物負數也共爲一類分正負列之與丁行相對

又因丁戊兩行皆有七品是多一算也乃更置之以八品列首位

上

中

下

如法以丁行八品負一徧乘減餘皆如故【首行同名故兩行之正負亦皆不變】又以減餘八品負十五分徧乘丁行八品七品得數乃對減八品同減盡七品同減餘二百四十分右行之正物也爲一類九品三十無減祿米四十五石亦無減皆右行之負物負數也同

名共爲一類乃分正負重列之與戊行相對

如法以左右七品分互徧乘得數【首行同名故兩行之正負皆不變】七品同減盡九品同減餘九十爲法祿米四

百九十五石無減就爲實法除實得五石五斗爲九品月俸置九品俸以相當之七品之十一分除之得五斗爲七品月俸十五分之一而以與八品相當之十三乘之得六石五斗爲八品月俸又以七品之分母十五乘其一分得七石五斗爲七品月俸又置七品俸以相當之六品之三分除之得二石

五斗爲六品四之一而以其分母四乘之得十石爲六品月俸置六品俸以相當之五品之五分除之得二石爲五品八之一而以其分母八乘之得十六石爲五品月俸

計開五品毎月十六石六品毎月十石七品毎月七石五斗八品毎月六石五斗九品毎月五石五斗

論曰此所列有二種六品通爲四分者問原云四之三是可以四分者也七品通爲十五分者原云十五之十三之十一是可以十五分者也五品通爲十六分者原云八之五是可以八分者也又倍之而十六則爲八分者二矣此皆以分立算化整從零之法也八品則只是原數九品亦是原數而又有倍數然

只是原數之倍非如五品倍其分也此兩者皆不用分只用整合而言之乃零整雜用之法也零與整雜似不倫矣然乘除得數則同但用分者所得數亦爲一分之數故必以分母乘之乃合原數而其原不用分者得卽原數更不湏乘能知此理則用分無誤矣

甲乙兩行論曰兩行正數內五品本同而甲有負多於正之較乙則無有是此較數乃甲負多於乙負之較也於是以兩負相減以去其同之分而觀其所不同之處則甲有諸品而乙惟六品之減余然則甲負之獨多此較者乃甲諸品多於乙六品減余之較矣

丙行乘減論曰兩得數對減而六品減盡是其數同也其與六品爲正負者又減去相同之七品分而左仍餘七品之餘分右仍余諸品之全分則是兩行諸數皆同而惟此二者有差也然則右之獨有盈於六品之較者正此二者之差數也

丁行論曰兩行對減而於負數內減去相同之八品惟餘九品於正數內減去相同之七品分惟餘七品之餘分然則右行負數獨有盈於正數者正是右行九品與其七品余分之較也何也與之對減者乃左行適足之數故於較數無闗也【重列三次皆然】

戊行論曰右行內減去左行適足數惟餘九品數則其下盈數必所餘九品之數也此條逓減歸一其理較明學者翫之

此零整雜列也亦五色方程有空例也有減無並可悟偶加奇減之非

問有物一百七十四以三人分之乙所分如甲七之三仍不足單六丙所分如乙七之三而多二數各幾何畣曰甲數一百一十二乙數四十二丙數二十【甲數三因七除得四十八多於乙數六乙數三因七除之得十八少於丙數二】

法列位以甲乙分母七化整爲零丙無分仍用整

【○】

乙之三分【正】丙一【負】負二【此行無甲數存與減余重列】

此三色有空先以和較雜法用兩行甲互徧乘之和數甲全分七乘較行得數【依其正負】以較數甲正三分乘和行得數【從乘法皆命爲正】甲各二十一分同減盡乙異並七十分【正】丙三無減【正】下數同減餘四百八十【正】皆同名不分正負以和數重列與第三行較數求之

上

中

下

如法互乘減並乙同減盡丙異並七十九爲法下數異並一千五百八十爲實法除實得二十

爲丙數丙數同減負二得一十八爲乙七之三乃以三分除之得六爲乙七之一以分母七乘之得四十二爲乙數乙數異加正六共四十八當甲七之三乃以三分除之得十六爲甲七之一以甲分母七乘之得一百一十二爲甲數此亦零整雜用之法也

若依變零從整法則以分子母倒位列之其正負以分母乘之乃與和數列而求之

論曰倒位何也非倒位也分母徧乘則然也以分母七乘子三而皆七之則爲三分者七爲三分七是爲全全數者三矣而其所當者全數也七之則爲全數者七矣是乙以全數當甲七之三者七乘之則七乙當三甲也故如倒位然皆全數也非分也故非倒位正負亦分母乘何也乙一當甲七之三而少六則七乙當三甲而共少七个六爲四十二也丙一當乙七之三而多二則七丙當三乙而共多七个二爲十四也

如法以前兩行徧乘減並又重列之與第三行徧乘減並乙減盡丙異並七十九爲法下數異並一千五百八十爲實法除實得二十爲丙數

七因丙數得一百四十同減負十四餘一百二十六以乙三除之得四十二爲乙數

七因乙數得二百九十四異加正四十二共三百三十六以甲三除之得一百一十二爲甲數

此變零從整而分母同者也亦有分母不同但取其本一行中所用之分母徧乘本行以爲用不必齊同如後條

問有數不知總以三人分之亦不知各所分之數但云甲如乙丙共數二之一乙如甲丙三之二丙如甲乙四之三而不足四又四分之一總數分數各幾何畣曰總數十五甲五乙六丙四乙丙共十其二之一則五如甲甲丙共九其三之二則六如乙甲乙共十一其四之三則八義四之一以丙相較不足四又四之一也

法曰此各行分母不同【如甲有三之二又有四之三乙有二之一又有四之三丙有二之一又有三之二皆有兩分母】宜用變零從整之法以不同同之【用分則不同變而用整則不同而同矣】以分母各徧乘其本行而列之右行分母二中行三左行四

如法互乘減並以三色較數變爲二色而重列之【𨿽減並不同皆仍爲較數不變宜翫】

如法互乘乙同減盡丙同減余負三十四爲法正一百三十六無減就爲實法除實得四爲丙

數六乘丙數得二十四以相當適足之四乙除之得六爲乙數以原列右行乙丙各一共十以相當適足之甲二除之得五爲甲數

論曰甲爲乙丙二之一則是二甲當一乙一丙也皆二因之也乙爲甲丙三之二則是三乙當二甲二丙也皆三因之也丙爲甲乙四之三而不足四又四之一則是四丙以當三甲三乙而不足十七也皆四因之也【甲乙丙各有兩分母若化整爲零當以分母相乘爲原數母互乘子爲所用之分殊多事矣】二因甲得二二因乙丙二之一得乙丙各一

三因乙得三三因甲丙三之二得甲丙各二

四因丙得四四因甲乙四之三得甲乙各三四因正四又四之一得正十七【以一丙與甲乙四之三較不足四又四之一若以四丙與四个甲乙四之三較亦不足四个四又四个四之一是爲十七】

問有數九百六十以四人差等分之乙與甲如二與八丙與乙如三與七丁與丙如四與六各幾何

畣曰甲六百七十二乙一百六十八丙七十二丁四十八

法以共數命爲和相當數命爲較依和較雜法列之乙二而甲八是乙得甲八之二故八乙可當二甲也丙三而乙七是丙得乙七之三故七丙可當三乙也丁四而丙六是丁得丙六之四故六丁可當四丙也【推此知二八三七四六各種差分皆可以方程禦之】

首次兩行如法互乘減並訖重列之取出第三行與之爲耦

如法減並訖又重列之【兩次減餘皆和數可見立負之非】

又取末行與之爲耦而列之

如法乘丙減盡丁並得四百八十爲法正二萬三千○四十無減就爲實法除實得四十八爲丁數六因丁數得二百八十八以相當之四丙除之得七十二爲丙數七因丙數得五百○四以相當之三乙除之得一百六十八爲乙數八因乙數得一千三百四十四以相當之二甲除之得六百七十二爲甲數

試以甲並乙共八百四十以八因之得甲數若二因亦得乙數是乙數甲二八差分也試以丙並乙共二百四十以七因之得乙數若三因亦得丙數是丙與乙三七差分也並丙丁共一百二十以六因之得丙數若四因亦得丁數是丁與丙四六差分也

又試以八除甲數得八十四以二除乙數亦得八十四若以八十四除甲數必得八以八十四除乙數必得二也又試以七除乙數以三除丙數皆得二十四若以二十四除乙數必得七除丙數必得三也以六除丙數以四除丁數皆得十二若以十二除丙數必得六除丁數必得四也

問有數七百四十一以四人分之乙於甲爲三之二丙於乙爲五之三丁於丙爲七之五各防何

畣曰甲三百一十五乙二百一十丙一百二十六丁九十

法曰乙得甲三之二是三乙當二甲也丙得乙五之三是五丙當三乙也丁得丙七之五是七丁當五丙也故皆命以適足而列之

先以孟仲兩行如法互乘減並訖列其餘數取出叔行相對

如法減並又列其餘與季行相較

如法減並丁二百四十七爲法正二萬二千二百三十爲實法除實得九十爲丁數

七因丁數五除之得一百二十六爲丙數五因丙數三除之得二百一十爲乙數三因乙數二除之得三百一十五爲甲數

問有數七百四十一以四人分之乙如甲三之二丙如甲五之二丁如甲七之二各幾何

因前問中有疉數故作此問以互明之

乙三當甲二而丙五又當乙三是丙五亦當甲二也丙五當甲二而丁七又當丙五是丁七亦當甲二也【又丁七亦當乙三今云兩者以甲爲主也】

在西法謂之連比例

上

中

下

首行互乘次行如故次行乘首行皆二之甲減盡乙異並得五【正】丙二【正】丁二【正】正一千四百八十

二皆無減【皆仍爲和同名在一行故也】

次行乘三行因兩首位同不用乘竟以對減甲減盡乙三【次行負也】丙五【三行負也】皆無減命爲正負適足【同名在兩行故爲較數】三行末行首位亦同亦徑減甲減盡乙空丙五【三行負也】丁七【末行負也】皆亦無減命爲正負適足【亦同名在兩行】乃以減余重列之如三色有空之法

如法減並得二百四十七爲法二萬二千二百三十爲實法除實得丁數以次求得甲乙丙數皆如前問之數

問有米三百八十五石五斗二升令二等人戶以四六差分出之甲上等二十六戶乙下等四十戶下戶出率則如上戶六之四

畣曰上戶各七百三斗二升二十六戶共一百九十石○三斗二升下戶各四石八斗八升四十戶共一百九十五石二斗

法以和較列位

如法互乘得四甲同減盡乙異並三百一十六戶爲法米一千五百四十二石○八升無減就爲實法除實得四石八斗八升爲下等戶則例以下等六戶乘其則例得二十九石二斗八升以相當之上等四戶除之得七石三斗二升爲上等戶則例

問有米三百一十七石給與四色人戶甲二十戶乙三十戶丙四十戶丁五十戶丁每戶如丙戶七之三丙每戶如乙戶六之四乙毎戶如甲戶八之二各幾何畣曰甲每戶八石四斗二十戶共一百六十八石乙每戶二石一斗三十戶共六十三石丙每戶一石四斗四十戶共五十六石丁每戶六斗

五十戶共三十石

法列位

首行甲二十戶十倍於次行甲正二但以首行甲退一位作二則齊同矣甲退十爲單其下各位皆退十爲單卽如互徧乘而可以對減矣

乃以減並之餘重與第三行列之

又以減並之餘重與第四行列之

依法求得六百三十四爲法三百八十石○四斗爲實法除實得六斗爲丁戶則例七因丁則得四石二斗丙三除之得一石四斗爲丙則六因丙則四除之得二石一斗爲乙則四因乙則得八石四斗爲甲則

【此條有省算法說見後卷】

此上數條皆變零從整法也

有兩數相較而爲十之八十之七者卽非二八三七差分也有二例見末捲

瓔珞方程例

瓔珞者言其聨綴而垂象瓔珞也謂之疉腳

凡算方程皆以多色逓減至一法一實以先知一色之數然此所先求之一色卻原帶有不同之數則法一而實非一故以一總法而除多實非疉腳之法不可也【亦有以下爲法上爲實者則實一而法有多名在合問者之所求而定之詳刋誤條】

今有大江南北兩處糧艘載米不同因冰程逺近給耗米亦不等但雲南船三隻北船兩隻共運米一千九百七十石外給耗米共六百六十八石又南船一隻北船四隻共運米一千九百九十石外給耗米五百五十六石問各船正耗米數以便稽核

畣曰北船每只正運米四百石給耗米一百石共正耗米五百石每正米一石耗米二斗五升南船每只正運米三百九十石給耗米一百五十六石共正耗米五百四十六石

每正米一石給耗米四斗

法各列位

先以左行南船一徧乘右行各得原數

次以右行南船三徧乘左行得數南船三與右減盡北船十二減去右二餘十隻爲總法

正運米五千九百七十石減去右一千九百七十石餘四千石爲運米實

耗米一千六百六十八石減去六百六十八石餘一千石爲耗米實

以總法除正運米實得四百石爲北船每只運數以總法除耗米實得一百石爲北船每只耗米數【總計正耗得北船毎只米五百石】

任於左行總運米一千九百九十石內減北船四隻該運米一千六百石餘三百九十石爲南船一隻運數【一故不除或於右行運一千九百七十石內減北船二隻運八百石餘一千一百七十石以南船三隻除之亦得三百九十石】

於左行總耗米五百五十六名內減北船四隻該耗四百石餘一百五十六石爲南船一隻運數【或於右行耗六百六十八石內減北船二隻耗二百石餘四百六十八石以南船三隻除之亦得一百五十六石】總計正耗得南船每只米五百四十六石

以北船四百石除其耗米一百石得每石給耗米二斗五升以南船三百九十石除其耗米一百五十六石得每石給耗四斗

此問每船米數故以船爲法米爲實

若問每米一萬石該用幾船則以減餘船十隻用異乘同除以一萬乘得十萬爲總船實以運米減餘四千石爲法法除實得二十五爲每運米一萬石用北船之數於是任以右行北船二隻亦用異乘同除以一萬石乘之二十五船除之得八百石以減共米一千九百七十石餘一千一百七十石又用爲法以右行原列南船三乘一萬石得三萬石爲實法除實得二十五隻又三十九分之二十五爲每米一萬石用南船之數

若問耗米給過五千石該得幾船者則亦用異乘同除以五千石乘減餘十隻爲北船實以減余耗米一千石爲法除實得五十隻爲每耗米五千石給北船之數任以右行北船二隻五千石乘之五十隻除之得二百石以減共耗六百六十八石餘四百六十八石又用爲法以原列南船三乘五千石爲實法除實得三十二隻又三十九分之二爲每耗米五千石給南船之數

假如有南運艘二隻以比北三隻則南船運米不及北四百二十石其南船帶耗米反多於北一十二石若以南船三當北船五則南船運米不及北八百三十石其耗米亦不及北三十二石問各幾何

法以正負列位

上

中

下

如法乘減余北船一隻爲總法

運米同減餘四百石爲運米實卽爲北船每只運數【總法一故不除下同】耗米異並得一百石爲耗米實卽爲北船每只耗數

任以右行北船三乘其運數得一千二百石同減負四百二十石餘七百八十石以南船二除之得三百九十石爲南船運數

以右行北船三乘其耗數得三百石異加正十二石共三百一十二石以南船二除之得一百五十六石爲南船耗數

若問毎米一萬石須幾船運者則以減余北船一以一萬石乘之爲船實以減餘四百石爲運米法法除實得二十五隻爲北船每運一萬石之數又以一萬石任乘右行北船三以二十五隻除之得一千二百石同減負四百二十石餘七百八十石又爲法以一萬石乘南船二爲實法除實得二十五隻又三十九分船之二十五爲南船毎運一萬石之數

若問耗米五千石該給幾船者則亦以五千石乘減余北船一隻爲船實以減餘一百石爲耗米法法除實得五十隻爲北船耗米五千石之船數又以五千石乘右行北船三以五十隻除之得三百石異加正十二石共三百一十二石又爲法以五千石乘南船二爲實實如法而一得三十二隻又三十九分船之二爲南船耗米五千石之船數

此因耗米與正運不同故也若耗米亦以一萬石爲問則北船之實皆同

今有墨一百二十七錠研六十六枚給與修史局六十人校書局六十三人又有墨五十八錠研三十二枚給與修史局二十四人校書局四十二人問各防何畣曰史局每人墨一錠又六分之四【六人十錠也】研四分之三【四人共三研】校書局毎人墨七分之三【七人共三錠】研三分之一【三人共一研】

法各列位

如法乘減余校書一千○○八人爲總法

墨餘四百三十二爲墨實

研餘三百三十六爲研實

以總法除墨實得七分之三爲校書局給墨數【七人得墨三錠】就以七人除右行校書六十三人以墨三錠乘之得二十七錠以減總給一百二十七錠餘一百錠以史局六十人除之得一錠又六分之四【六人得四錠並整數爲六人十錠】爲史局給墨數

又以總法除研實得三分之一爲校書局給研數【三人共一】就以三除校書六十三人得二十一研以減總給研六十六餘四十五研以史局六十人除之得四分之三【四人三研】爲史局給研數

問修艌船隻內有舊船二隻新船一隻共用桐油二百六十斤麻一百三十斤釘十七斤石灰二百一十斤計工兩月有半又舊船一隻新船三隻共用桐油二百八十斤麻一百四十斤釘十六斤灰二百三十斤工兩月有半其新舊船各防何

畣曰每新船一隻用桐油六十斤麻三十斤釘三斤灰五十斤每工一月修兩隻

每舊船一隻用桐油一百斤麻五十斤釘七斤灰八十斤每工一月修一隻

法各列位

先以左舊船一徧乘右行如故

次以右舊船二徧乘左行得數乃相減上位舊船對減盡中位新船減餘五爲總法

下位油相減餘三百斤爲新船油實【以總法除之得六十斤爲新船油數】麻相減餘一百五十斤爲新船麻實【以總法除之得三十斤爲新船麻數】釘相減餘一十五斤爲新船釘實【以總法除之得三斤爲新船釘數】灰相減餘二百五十斤爲新船灰實【以總法除之得五十斤爲新船灰數】

任以左行新船三隻乘其油數得一百八十斤以減總油二百八十斤餘一百斤爲舊船一隻油數

以新船三隻乘其麻數得九十斤以減總麻一百四十斤餘五十斤爲舊船一隻麻數

以新船三隻乘其釘數得九斤以減總釘一十六斤餘七斤爲舊船一隻釘數

以新船三隻乘灰數得一百五十斤以減總灰二百三十斤餘八十斤爲舊船一隻灰數

此爲以船求油麻等故以船爲法以麻油等爲實

乃以減余新船五隻爲總實

以減余工兩月半爲法法除實得二隻爲每工一月修新船之數就以二隻除左行新船三隻得一月有半以減總工兩月半餘一月以除舊船一隻如故得每工一月修舊船一隻

此以工求船故以工爲法船爲實與前相反

重審方程例

凡算方程皆以有總數無各數故逓減以求之然有並其總數亦隠者此當用兩次求之故曰重審

假如品官祿米不知數但云甲支三品俸四个月又帶支四品俸五个月乙支三品俸六个月又帶支四品俸五个月亦不知甲乙各得數但云以甲十三分之一益乙則三百五十石若以乙十一分之三益甲亦三百五十石問兩品祿米各幾何

答曰三品毎月俸三十五石

四品每月俸二十四石

法曰此當先求出甲乙兩家支過祿米再求各品月俸謂之重審先以帶分法列位

上

中

下

左甲之一分徧乘右行如故

右甲之十三分徧乘左行得數

甲減盡乙減餘一百四十分爲法餘俸四千二百石爲實法除實得三十石爲乙之一分以乙分母十一乘其一分得三百三十石爲乙支過米數以乙支過米數減總三百五十石餘二十石爲甲之一分以甲分母十三乘其一分得二百六十石爲甲支過米數

旣得兩家支過米數乃重列之以求品俸

如法左右乘減餘四品十月爲法餘俸米二百四十石爲實法除實得二十四石爲四品每月俸以四品五月計一百二十石減甲支二百六十石

餘一百四十石以甲支三品四月除之得三十五石爲三品每月俸

假如品官支俸本折兼支不知數但云甲支一品俸四个月又帶支二品俸五个月乙支一品俸六个月又帶支二品俸十个月亦不知甲乙支過數但云取乙本色三分之一以益甲共五百六十六石若取甲本色三分之二以益乙則八百六十五石取乙折色五分之二以益甲共四百九十八石若取甲四分之一以益乙則五百七十九石問各幾何

畣曰一品月俸八十七石

內實支本色一半四十三石五斗折色鈔一半數同二品月俸六十一石

內實支本色六分三十六石六斗折鈔四分二十四石四斗

法當重審先求本色依帶分法列位

上

中

下

如法乘減余乙之七分爲法余本色一千四百六十三石爲實實如法而一得二百○九石爲乙本色之一分以減右行共本色五百六十六石餘三百五十七石爲甲支過本色數又以乙分母三乘其一分得六百二十七石爲乙支過本色數

計開

甲支過本色三百五十七石【內一品俸四个月二品俸五个月】乙支過本色六百二十七石【內一品俸六个月二品俸十个月】

次求折色亦依帶分列位

如法左右乘減乙餘十八分爲法余折色一千八百一十八石爲實法除實得一百○一石爲乙折色之一分以乙分母五乘之得五百○五石爲乙支過折色數以乙之二分乘其一分得二百○二石以減共折色四百九十八石餘二百九十六石爲甲支過折色數

計開甲支過折色二百九十六石【內亦一品俸四个月二品

俸五个月】

乙支過折色五百○五石【內亦一品俸六个月二品俸十个月】

旣得甲乙兩家支過本折然後乃求各品月俸

依疊腳法列其所得本折而重測之

如法徧乘得數上位一品減盡中位二品餘十个月爲總法下位本色餘三百六十六石爲本色實

折色餘二百四十四石爲折色實

乃以總法除本色實得三十六石六斗爲二品毎月俸本色數以乙二品十个月計三百六十六石減乙共本色六百二十七石餘二百六十一石以乙一品六个月除之得四十三石五斗爲一品月俸本色

又以總法除折色實得二十四石四斗爲二品月俸折色以乙二品十个月計二百四十四石減乙共折色五百○五石餘二百六十一石以乙一品六个月除之亦得四十三石五斗爲一品月俸折色【其右行亦可互求則先得甲數也】

於是以一品本色折色並之得每月俸八十七石【本折各半支】

以二品本折並之得毎月俸六十一石【四六支本色六分折色四分】

歷算全書卷四十一﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

欽定四庫全書

歷算全書卷四十二

宣城梅文鼎撰

方程論卷三

致用

笇之用惟防其說惟詳詳說之斯能捷用省笇列位諸法由是以生也故致用次之

致用有二一者省笇一者列位【例雜見諸卷中故不具列而備論其理】省算法亦有二一者行有空則省算一者數偶同則省乘

凡方程之法去繁就簡同者去之異者存之歸於一法一實而已矣故三色以上有空位則可徑求

若三色方程無空位者必湏乘減得數變爲二色以求之此常法也若內有一行中空一位則以所空之位列於首而先以其餘兩行不空者如法乘減得數卽重列之與原有空位者相對如二色方程也【以兩行無空者相乘對減則減去一色惟餘二色其有空者原只二色故可相對如二色也】則省一笇【原法乘減三次今只兩次故曰省一笇】

凡三色方程不論一行有空或兩行各有空或三行各有空皆只省一算何也其各行中𨿽有空位而不相對故也何以知其不相對若兩行有空而又相對則徑可以二色算之矣卽不成三色方程三色有空例雜見前卷

凡四色五色以至多色有幾行空位者如上省算徑求最爲簡防若中行無空則必如法乘減以五色變四色四色變三色三色又變二色漸次求之不可徑求而省算也今諸書所載皆其各位之有空者耳非通法也而欲以此盡方程可乎

凡四色方程有乘減六次者常也若有一位空則省一算一行中空兩位或兩行各空一位而相對則省二算若一行空兩位又一行空一位則省三算止矣或有四行中各空一位而不相對亦只省一算而已何也惟首位空乃能省算若首位不空而空在下數位則乘減之後自然補實不能省矣亦有兩行各空兩位而只省二算者亦以空位相左乘後補實耳故𨿽四行中各空兩位亦只省三算也

假如四色中有一行空兩位則將此無空之三行如法乘減變爲兩行又將此兩行如法乘並變爲一行此減餘一行卻有二位恰興空兩位之行相對矣便以重列如二色方程取之此最方程中要法而諸書未及也故詳論之

若四色方程有兩行各空一位而又相對則將其無空之兩行如法互乘而減去此不空之位變爲一行與空位之兩行同列如三色法而之尢爲易見

其四色各行空兩位而省三算卽今諸書中所載是也可無更贅然但欲知其爲省算方程而非常法耳

其四色無空乘減六次者竟無其式故誤以省算爲常然旣明其理亦不必一一爲式矣

凡五色方程無空則有乘減十次者常法也【五色變四色則有四算四色又變三色則有三算三色又變二色則有二算二色又一算乃得法實合之爲十算】故五色而爲四圖者亦常法也【原列一圖以減余重列爲四色而三色而二色又各一圖合之爲四圖】

若有空一位則省一算或空兩位而省二算【湏兩位空在一行或兩行俱空首位乃可】空三位而省三算【湏空在一行或三行同空首位或一行首位空一行首次兩空則可】空四位而省四算【湏一行空三位而一行又空一位恰與空三位者同或二行俱空首位而一行又空首次兩位乃可或兩行俱空首次亦可】空五位而省五算【湏兩行空首位而一行空首次三位或兩行空首次而一行空首位或一行空首次而一行空首次三之位乃可】空六位而省六算【湏一行空首位一行空首次一行空首次三行位乃可】

省至六算止矣六算以上𨿽多空位無闗省算也

今諸書有載五色方程者皆其各行空三位者耳總計之有空十五位而其爲法亦必用四算然後得數則所省者亦只六算而竟不知其爲省算之法則習而不察也

假如五色方程內只有行空三位法當以有空之三色列於上而先以其無空之四行如法乘減變爲四色者三行又以乘減變爲三色者二行又以乘減變爲二色者一行則恰與空位之行相對矣再乘減一次得所求矣故曰省三算也【變四色時省一算變三色時省一算變二色時省一算共省三算】

假如五色方程內有兩行各空二位而相對法當以有空之二色列於首次而先以其無空之三行如法乘減變爲四色者二行又以乘減變爲三色者一行則恰與空位之兩行相對矣於是以三色法取之得所求矣故曰省四算也【變四色時省二算變三色時亦省二算】

假如五色方程內有兩行空首位又一行空首次三之三位法當以無空之兩行如法乘減變爲四色者一行則恰與空首位之兩行相對矣乃以原數兩行減餘一行相並列之用相乘減變爲三色者兩行又相乘減變爲二色者一行則又恰與空三位者相對矣乃以原空三位者與減余列而求之卽得之矣故曰省五算也【變四色時省三算變三色與二色又各省一算】

若五色方程內有兩行各空三位者卽如一行空兩位一行空三位也法以無空之三行先用乘減變爲四色者兩行又以乘減變爲三色者一行則恰與空首位次位者對矣取出原空兩位者與減余列而求之變爲二色者一行又恰與空三位者相對矣又取出與減余列而求之卽得所問故亦省五算也【變四色三色時各省二算變二色時又省一算共五】其兩行𨿽各空三位而不相對故也【若各空三位而相對卽成二色方程矣】

若五色方程各行俱有空位不等要之省六算止矣省六算者必一行空首位而省一算一行空首次而省二算一行空首次三之位而省三算其餘空位必不相對不能省算與無空同也

其法先以不空之兩行乘減得數變爲四色與空首位者相對又乘減變爲三色與空首次者相對又乘減變爲二色與空三位者相對再乘減卽得所求諸列不能悉具智者反隅可也

論曰常與變相待而成告方方程省算而特詳其不省之算者欲窮其變先得其常也

以上所論𨿽止五色引而伸之若六色七色八色九色乃至多色其理一也

以常言之二色者一算三色者三算四色者六算五色者十算六色者十五算七色者二十一算八色者二十八算九色者三十六算十色者四十五算十一色五十五算十二色者六十六算

以空位言之三色者有省一算四色者有省一算至三算五色者有省至六算六色者有省至十算七色者省十五算八色有省二十一算九色有省二十八算十色有省三十六算十一色有省四十五算十二色有省五十五算

以省算所用而言之三色者有只用二算四色者有只用三算五色有只用四算六色有只五算七色有只六算八色有只七算九色有只八算十色有只用九算十一色有只十算十二色有只十一算

總而言之二色則只一算三色則有二算或三算四色則有三算以至六算五色則有四算以至於十算六色則有五算至十五算七色則自六算至二十一算八算則自七算至二十八算九色則自八算至三十六算十色則自九算至四十五算十一色自十算至五十五算十二色則自十一算至六十六算

擴而充之猶舉一隅耳然其法不外於和較與和較之雜與變愚故不欲以四色五色等分爲之目也必如此則方程之法乃爲通法若諸書所列四色者必各行空二位五色必各空三位非通法也方程者所以禦雜糅正負也而必逓空相等乃可用算是法有所不及而窮於問也豈古人立法之意哉

此以上論空位省算省算者乘減並俱省之也非若省乘者但省互乘而不省減乘

凡方程互徧乘者取其首位齊同耳故乘減一次則少一色以首位之齊同必減而盡也然亦有其首位之數偶爾相同者法當徑以對減而省其互乘此𨿽省其乘而不省其減並故與前論省算同而微異也

假如和數方程首位同則徑減矣若較數者又湏論其正負之名同數矣而又同名徑對減矣同數而不同名則更其一行之正負以相較而後減並焉此要訣也不則首位𨿽減去而其下之同異淆則加減皆誤矣

若和較雜者首位之數同亦必以較數首位之名名其和數之一行而後減並之但省其互乘可也

以上論同數省乘

亦有首位數𨿽不同而可以分數相命者則以其分數攺其一行之數以從一行則首位齊同而可以對減省其互乘焉可矣

若較數或和較雜皆如前法齊同其首位之名斯減並無誤耳【較數首位同名則仍之異名者攺一行以相從和較雜者以較首位之名名其和數之一行】

假如兩首位爲五與十是倍數也則半之蓋五與十互乘各得五十而其下諸數從之而溢矣今但以首位十半之爲五而其下諸數皆半之以相減並則五之之行可無乘而數亦簡明殊散人懷也

若兩首位爲二十與二是十之一也則以退位之法乘之使二十之一行皆爲十之一若爲八爲四亦倍數也若爲八與二是四之一也四除其八之行則得矣若九與三則三之一也以三除九則亦三而其一行皆三除之則可減倂矣然三除多有不盡不如只以三因其三之行也若爲五與三則六因其五之行而退位五與二則四因退位五與四則八因退位皆同若六十四與八則八之一也八除其六十四之行猶互乘也若此類者不可枚舉得其意者酌而用之可也尢要在首位之必同名亦有不可彊齊者如七與二九與四之類只用互乘爲無獘也省乘者爲省事而設也彊齊之反多事矣此以上論分數省乘

此外又有不拘首位者但數同則徑以對減施之二色爲宜蓋二色方程只湏減去一色其所餘卽一法一實矣然亦湏同名方可減去若異名者攺而齊之可也

假如較數方程其中一色同名而又同數徑減去矣若但同數而不同名則更其一行之正負乃減去之

假如和較雜其中一色同數則以之爲主使和數一行皆與此一色同名乃減去之

若和較則不湏爾但同數者卽減去之此二色捷法

合此三者省算之理備矣

問田糧七則起科甲有上田一畝上次田一畝輸糧七斗乙有上田一畝上次四畝上中一畝糧一石八斗丙有上次上中田各一畝糧五斗丁有上中田中田各二畝糧五斗戊有中田三畝中次五畝中下五畝已有中下八畝下田十三畝庚有中下田下田各十畝皆糧五斗問各則若何

法曰此方程防續法也以甲乙丙借作三色己庚借作二色各如法求得田則則其中兩色自知

先以甲乙兩行徧互乘減去上田余上次田三畝上中田一畝糧一石一斗用與丙行乘減上次田減盡余上中田二畝爲法糧四斗爲實法除實得二斗爲上中田則例

就以上中田則減丙糧五斗餘三斗爲上次田則例以上次田則減甲糧七斗餘四斗爲上田則例【以上三色法也】

又以上中田則例乘丁田二畝得四斗以減丁糧五斗餘一斗以二畝除之得五升爲中田則例

又以戊中田三畝乘其則例得一斗五升以減戊糧五斗餘三斗五升爲戊田中次中下各五畝之共數因此處防而不屬故又先求末兩行

再以二色法用己庚兩行如法徧乘減去中下田餘下田五畝爲法糧一斗爲實法除實得二升爲下田則例【以八因庚行而退位省乘法也】

以庚下田十畝乘其則例得二斗以減庚糧五斗餘三斗以中下田十畝除之得三升爲中下田則例【以上二色法也】

乃以戊中下田五畝乘其則例得一斗五升以減戊中下中次共三斗五升餘二斗以戊中次五畝除之得四升爲中次田則例

計開上田每畝糧四斗

上次田每畝糧三斗上中田每畝糧二斗中田每畝糧五升中次田每畝糧四升中下田每畝糧三升下田每畝糧二升

論曰此𨿽七色因行中防續卽非七色借三色二色之法知其首尾而中行亦見焉所省良多然非省乘其勢則然也以其疑於省算也故附之其末

又有數偶相同不論三色四色但一減之後卽得一法一實者非省算也然亦省算之類故亦附錄一條以見其例

假如縀紗絹不知價但云以縀一匹紗五匹易絹九匹余價二兩六錢又以縀二匹絹八匹易紗四匹余價六兩八錢又以縀三匹易紗六匹絹七匹少價一兩二錢

畣曰縀每匹價銀三兩紗每匹一兩絹每匹六錢

法列位

因中左紗減盡只餘一色卽以絹十九爲法除十一兩四錢得絹價每匹六錢以絹餘二十六匹乘價得十五兩六錢同減負一兩六錢餘十四兩紗價也以紗餘十四匹除之得紗價每匹一兩【用中右減余得之】以原左行紗六匹【價六兩】絹七匹【價四兩二錢】共價十兩

二錢同減負一兩二錢餘九兩縀三匹價也三除之得縀價每匹三兩

論曰此方程之變例也一減之後卽得其數若多色方程除首位外有減盡者先𨿽無空而減余重列卽成有空方程矣【例見本卷齊軍列陳條】

若三色俱減盡則不能成算或三色方程中左三色俱減盡中右只減一色則所餘者二色而無相較乘減無因不能別其二色亦不能成算也

假有問水銀三斤硃砂二斤共價四兩四錢又水銀九斤硃砂六斤共價十三兩二錢問各價若干

畣曰此不可以方程算何也彼𨿽兩宗而其後一宗之物價皆三倍於先一宗互乘之後必湏減盡故也

凡左行之物俱倍於右行或俱半俱四之一等互乘之後得數齊同不能分核具如前論方程立法正以諸物雜糅多寡錯居同異參伍而得其端倪也

又或三色方程而問只二宗則減余仍有二色不能分別故問三色必有三宗問四色必有四宗五色六色以上悉同何也方乘立法乘減一次始能分去一色若少一行則少一次乘減而不能得其一法一實矣故行中可有空位而不可有空行

行中有空者分一行言之也若總列爲圖則位皆無空凡此皆治方程者所當知

知其有不可算斯無疑於算知其有必不可省斯善爲省矣

列位之法亦有二

一者更其上下之位以互求也或爲省算之計

凡方程立法務湏首位齊同以便減去故每徧乘一次則減去一色逓減之則一法一實矣今行中有空則是不待徧乘而其一色已先減去也故取而列之於上位則能省算不則上位不空而下反空則對位無減補成不空而不能省算矣

其法於列位時覆視之有橫列中空位多者取作首位首位空一行則省一算矣

若首位原有空位而欲更定次位者不必攺列但於重列減余時檢防更定之可也

又橫列中有數偶相同或可以分相命者取作首位亦省徧乘或橫列中有單一數多者取作首位省乘【單一數則不湏乘故也】

以上論上下之位

一者更其前後之行也

凡首位多空而其不空者隔逺則更而聨之便乘減也其各行空位不等者不必更列但以與減余相對

者取出對列而乘減之【例見前諸捲】

若各行首位有可以分相命或數偶相同而爲他行所隔亦可更置使之相接

又多色方程有各行中對位總空者取出另列而先乘其他行之不空者乃於重列之時漸次添入可免細書局蹐【例見後卷】

以上論前後之行

法曰凡多色方程先任意列位竟乃覆視之若首位有空而下則無之此不必更置也或首位多空而下則少亦不必更置也

惟首位不空而下反有或首位空少而下反多則更而置之故上下可以互居前後亦可易位或云以末行爲主者非也

問古今曆術屢更其所用日法無一同者如以漢太初歷日法十有一外加四十九則如殷曆日法也若以太初日法二殷曆日法三再加五十八則如唐大衍歷日法也若太初日法十有四大衍日法二相並以比宋紀元歷日法仍少七十六若太初日法九十倍之卽紀元日法其各數若干

法以正負列位

甲太初十一【正】殷七一【負】○

○

負四十九乙太初二【正】殷六三【正】大衍一【負】○

負五十八丙太初十四【正】○

大衍二【正】紀元一【負】負七十六丁太初九十【正】○

○

紀元一【負】適足如右圖太初歷橫列皆滿須用徧乘對減者三而後能減去太初之一色其餘𨿽多空位自然有無減之對位相補不能省算

如法攺列

以最多不空之太初列下爲第四位則殷曆居上而成有空位之方程矣

先如法以甲乙兩行互乘減並殷曆各正十五對減盡大衍負一無減太初異並負三十五下數異並正二百○五【因異並故並從甲行之名而大衍在乙行與下數同名亦攺負爲正】

乃重列之【取出丙行與減余相對】

如法互乘減倂大衍各正二對減盡紀元負一無減太初異倂得正八十四下數異並得負四百八十六

又重列之【以減余與丁行相對】

首位同名同數省互乘紀元各負一對減盡太初同減餘六爲法負四百八十六無減爲實法除實得八十一分爲太初日法以丁行太初九十乘其日法【八十一分】得七千二百九十分爲紀元日法以甲行太初十一乘其日法【八十一分】得八百九十一異加負四十九得九百四十分爲殷曆日法以乙行殷曆三乘日法【九百四十】得二千八百二十又太初二乘日法得【一百六十二】又異加負【五十八】共得三千○四十分爲大衍日法

計開

殷曆日法九百四十分

漢太初歷日法八十一分

唐大衍歷日法三千○四十分

宋紀元歷日法七千二百九十分

又按列位之法原與省乘省算之法相生故共爲一卷合觀之可也今以六色無空者爲例如後

問齊軍千乘其陳有先驅申驅爲前軍有啟與胠爲兩翼有戎車貳廣爲中軍有大殿爲後軍各不知數但以前軍居余陳七之三合兩翼二廣與殿多餘陳四十乘合前軍兩翼與中後較則多二十乘前軍合殿與翼中軍較則少二十乘先驅大殿居與陳二之一而少五乘各若干

畣曰前軍共三乘

內先驅一百四十乘

申驅一百六十乘

兩翼共二百一十乘

內啟與胠各一百○五乘

中軍共三百乘

內戎車一百八十乘【帥】

貳廣一百二十乘【副】

後軍一百九十乘是爲大殿

法以和較雜列位

有七之三二之一依變零爲整以分母各乘而後列之

如法互乘減倂變爲五色有空而重列之

空者偶也若不空亦儼然變爲五色矣

前三行減余首位申驅皆空故不湏乘減但以末二行乘而減之減去申驅卽變四色矣又以申驅數本同故不湏乘而竟以對減乃以四色法重列之四色無空法也𨿽有空而非首位不能省算與無空同

因首末兩行之翼數皆倍於中兩行故省互乘但以首末兩行皆半之使其翼數齊同乃原數對減而變爲三色又重列之

因次行末行戎車同但首行多於次行二之一故省互乘但以次行二分加一與首行對減其次行與末行竟以原數對減變爲二色而重列之

貳廣同故省互乘竟以對減盡大殿異名並得五爲法車同名減餘九百五十乘爲實法除實得一百九十乘爲大殿車數以大殿車數異加正五十乘共二百四十乘以貳廣二除之得一百二十乘爲二廣車數【用末次右行數】二乘大殿車數同減負二十乘戎車二除之得一百八十乘爲戎車公卒數【用第四次三色中行數也】二乘戎車異加正六十乘兩翼二除之得二百一十乘爲兩翼共數【用第三次所列四色之次行】又半之卽啟與胠數合計兩翼【二百一十】戎車【一百八十】貳廣【一百二十】共數【五百一十】同減負三十乘余【四百八十】以申驅三除之得一百六十乘爲申驅數【用第二次所列五色之第四行】合計申驅【一百六十】兩翼【二百一十】戎車【一百八十】貳廣【一百二十】共【六百七十】同減負十乘余【六百六十】又減去大殿二計【三百八十】余【二百八十】以先驅二除之得一百四十乘爲先驅之數【用原列六色之第五行數】

試細攷之合計兩翼【二百一十】戎路【一百八十】貳廣【一百二十】大殿【一百九十】共七百乘合計先驅【一百四十】申驅【一百六十】共三百乘三七差分也故曰前軍爲余陣七之三

合計兩翼【二百一十】貳廣【一百二十】大殿【一百九十】共五百二十乘其餘前軍【共三百】戎路【一百八十】共四百八十乘故曰翼廣殿多餘陣四十乘

合計前軍【共三百】兩翼【二百一十】共五百一十乘以較中軍【共三百】後殿【一百九十】共四百九十乘則多二十乘故正二十乘與前軍翼同名

合計前軍【三百】大殿【一百九十】共四百九十乘以較兩翼【二百一十】中軍【三百】共五百一十乘則少二十乘故負二十乘與前軍殿異名合計先驅【一百四十】後殿【一百九十】共三百三十乘又合計申驅【一百六十】中軍【三百】兩翼【二百一十】共六百七十乘其二之一爲三百三十五乘故曰先驅大殿居余陣二之一而少五乘【以全當其半而少五乘則以倍當其全而少十乘矣此與第一行皆變零爲整詳見帶分條】總計之則千乘矣故以和數參焉

論曰此一例中能兼數法皆省算之捷訣也

其第二圖五色變四色當有互乘減並者四次今以申驅空位省其三次此空位徑求省算之法也其申驅偶爾數同徑以對減與第五圖二色之貳廣數同徑以對減皆省乘定法也但皆和較之雜故𨿽不乘必以較行首位之正負補於和數之行不然則減並誤矣此要訣也

其第三圖四色之首位偶有倍數故半其倍者以相從此亦省乘法也

其第四圖三色之首位爲三與二故加二爲三是二加一也故其下皆二分加一則如徧乘矣然亦首位正負偶同也若不同者湏更其一行以同之首位𨿽同數又必同名然後可減而去之尢省乘之要訣

又論曰方程無空者常法也如第一圖六色是也若不減並五次何以求之亦偶而多有首位相同者故亦能省乘然𨿽省乘不能省減並矣其有空位者偶然也如第二圖五色有空是也空位多若更置列之所省尢多𨿽不更置而減倂之餘自然能補其空亦可見方程之有常法矣

若更置之則自五色起如後圖

因五色始有空也如此圖則省六算戎翼不空故更之下位後行不空者更之前行以先乘

正負列位

甲乙行如法減去申驅以其餘四位重列之與丙行相對【一和一較也】

重列

如法減去貳廣又重列之與丁行相對【皆較數也如後】

如法半減餘數以從丁行乃對減而重列之與戊行相對【又以翼同故更置之】

上

中

下

如法徑以對減余戎路五爲法

倂得正負九百乘爲實

法除實得戎路數

旣得戎路數以次得余重之數

合問

又術以一圖而爲減並如後所列

依法先得戎路亦同但其間和較交變錯然雜陳非深知猝不能了不如前術之爲安穏明白也

歷算全書卷四十二

欽定四庫全書

歷算全書卷四十三

宣城梅文鼎撰

方程論卷四

刋誤

古之爲學也精故其立法也簡而語焉不詳闕所疑而敬存其舊無臆參焉斯善學也已不得其理而彊爲之解以亂其眞古人之意乃不可見矣意不可見而訛謬相仍如金在沙淘之汰之沙盡而金以出故刋誤次之方程之誤厥有數端

一曰立負之誤【立負誤也四色五色期於立負以爲法誤之誤也自騾馬逓借一問諸書沿訛而加減之誤因之矣】

一曰加減之誤

同加異減一誤也【誤沿於牛羊豕相易之一問由不知正負之有更也】

奇減偶加二誤也【誤沿於桃梨問價以不知和較之交變也】

一曰法實之誤【以上爲法下爲實拘也以法必少實必多亦謬也】

一曰倂分母之誤

一曰設問之誤【如井不知深而以除法爲井深問中先已大誤】

立負辧

立負非古人法也何以知之有負則有正今立負而不言正非正負之本防也或曰有正則有負則言負可不言正矣是又不然凡和之變而較也有減其和數而盡者亦有減其和數而餘者其減而盡者命爲適足而無較數則但言此之爲負以見彼之爲正可矣若減而餘者是有較數也而但言負不言正何以知其較數必與正物同名乎卽使同名而竟不明言其爲正何以分別同異而爲加減乎至於以有空位而立之負則又不可何也和之或變而較也固不必以空位也但減余分在兩行而兼用之卽變較數矣今必以有空位者而立之負則無空位者卽不立負乎然則和數之無空位者終於同減而無異並乎將進退失據矣故曰非古人法也

凡言正負者分其物以相較也不言正負者合其物以言數也皆自然而有之名非立之也而立負乎哉夫不知正負之出於自然而彊立之負則同異之防淆而加減之用失種種謬誤緣之以生故謹爲之辧今以諸書所載立負例攷定如左

假如米四石二斗以馬一騾二驢三載之皆不能上坡若馬借騾一騾借驢一驢借馬一則各能上坡問馬騾驢力各幾何

畣曰馬力二石四斗騾力一石八斗驢力六斗

法各以和數列位【馬借騾一則一馬一驢也騾借驢一則二騾一驢也驢借馬一則三驢一馬也各以其本數加借數而列之乾方程法則和數而已】

此三色有空法也中行無馬原只二色故不湏乘減但先以左右兩行首位不空者對乘又因兩行馬數皆一乘皆如故故徑以對減馬減盡右騾一左驢三皆無對不減米各四石二斗亦對減而盡乃視減余騾一在右行驢三在左行分在兩行是有正負也米亦減盡是正負適足也重列之

論曰此和數變爲較數也何以言之兩行之馬相若而其載物又相若則其所偕以共載之騾一與驢三其力亦自相若矣故命之適足適足者以兩相較而成故曰變爲較數也然謂之適足可也謂一行俱減盡則不可也減盡者同類之物而其數又同故物與數俱減盡也適足者物非同類而其物之積數則同故其物不能減盡而數則減盡也物不同而數同故曰適足也適足者存之爲用也物數俱減盡者淸出其一色而不復用也如此三色中𨿽不能遽知各力然已知驢三騾一之適相當矣則已淸出馬之一色而變爲二色矣此逓減立法之意也

又論曰減余適足則有正負矣其原列只是和數無正負也諸書以逓借一匹之故而列之曰借又別其本數曰正不知正與負對非與借對也𨿽逓借一匹其實是本有之頭匹與所借之頭匹共載此米故曰和數逮減余乃變爲較耳故減余適足宜言正負也而諸書但立負原列和數無正負也而忽分正借又不立負於減之後而立於其先正也借也立負也三者相亂而靡有指實古人之法固如是乎哉

次以中行原數與減余對列因中行馬空故徑求也

此和較雜也減余分正負中行原無正負

以減余騾負一徧乘中行如故【較乘和也數𨿽如故但皆以乘法之名名之爲負】又以中行騾二徧乘減余得數【和乘較也故仍其正負之名】騾同減盡驢異並得七爲法四石二斗無減就爲實法除實得六斗爲一驢之力三因驢力得一石八斗爲一騾之力【適足故也】以騾力一石八斗減四石二斗餘二石四斗爲一馬之力【原右行數】

論曰減余原是騾一與驢三力等乘後得數則騾二與驢六亦等也然則於中行共力中減去二騾而以相等之六驢益之其共之四石二斗亦必與原載等也故並此六驢與原列一驢共七爲法以除此四石二斗而驢力可知也驢三與騾一旣等則三驢之所載卽騾力也騾與馬各一共四石二斗則減騾力卽馬力也

又論曰此因中行有空故徑求也使其不空自當與左行或右行徧乘而減去其馬與其數乃列兩減餘如二色求之此常法也今中行馬空原只二色恰與減余之二色相對故徑相乘減是省一算也諸書皆言因左行騾空故立負騾一與中行對乘不知左行騾空而右之騾一無減猶右之驢空而左之驢三無減也其與中行相對乃用此兩色之減余非獨用左行也蓋左行有馬中行無馬原無對乘之理亦猶之右與中不可對乘惟減余是二色可以對乘𨿽云徑求實自然之理勢也而彊立之負以用左行乎

有正斯有負立負騾於左行爲與何物相對耶以馬一爲正耶驢三爲正耶其馬一驢三皆正耶旣無所指則負爲徒立矣

凡言正負者其下數必爲正與負之較今所用左行之四石二斗者爲是騾一與驢三相較之數耶騾一與馬一相較之數耶將合馬一驢三與騾一相較之數耶則皆無一合矣

凡物有正負者其較數亦有正負此四石二斗者正耶負耶若無正負卽是和數不應立負騾矣

若以四石二斗爲和數則更非理夫以馬一驢三之共數加一騾力而其數如故理所無也若去一馬用一騾而與驢三共此米抑又不能馬與騾之力原不同乃去一馬加一騾而其數如故理所無也然則此四石二斗安屬耶彼惟不知四石二斗之減盡卽爲適足故誤至此也

又謂右行俱減盡不知減盡必兩行數同如馬一與米四石二斗也若騾一驢三固未嘗有減也況盡乎方程立法原以對減有盡不盡而得其朕兆若三色俱減而盡其算不立矣惟不知有空位者可以徑求而誤以所用之減余爲是左行之原數故也

凡減盡者兩俱減盡不應右減盡而左行獨存若謂復用左行之原數何以不用原列之馬一而加一負騾以爲馬一減去故不用則四石二斗何旣減而復存耶故以立負騾減馬一爲用減余之法則四石二斗不宜存四石二斗爲用原列之法則馬一不宜減負騾不宜立破兩法而參用之一不成矣承譌者遷就多岐抑奚足怪

今試以減余更置則先得騾力如後圖

如前法以一和一較徧乘得數驢同名減盡騾異並得七爲法正十二石六斗無減就爲實實如法而一得一石八斗爲騾力以驢三除相當一騾之力得六斗爲驢力【任於原列左行或右行如法減驢力或騾力得馬力】

論曰凡減余重列之數皆可更置互求何則皆實數也三色減去一色卽二色法矣若干減余之適足加以四石二斗則不可以互求故知其誤

又試以原列更置之先減去騾如後圖

如法先以右中徧乘騾減盡中行驢一右行馬二皆無減分正負列之載米餘四石二斗在右行與馬同名左行騾空故徑與減余相對依和較雜法乘之驢同減盡馬異並七爲法載米異倂十六石八斗爲實法除實得二石四斗爲馬力以馬力減四石二斗餘一石八鬥得騾力以馬

力倍之同減四石二斗餘六鬥得驢力

試又更之如後圖

如前法先以右中兩行徧乘減去驢余馬一騾六皆無減分正負載米餘八石四斗在右與騾同名乃重列之如前法徑與左行相對徧乘馬同減盡騾異並七爲法載米異並十二石六斗爲實實

如法而一得騾力以次得驢馬力皆如前

論曰凡諸色方程其上下皆可互更如上二圖以空位徑求之法求之無所不合也

又試以原列無空而減余適足者爲例如後

假如有三車三槖駝七牛各欲載物六十四石而皆不能勝若車借駝牛各一駝借車牛各一牛借車駝各一則皆能載問三者力若干

畣曰車二十四石槖駝十二石牛四石

法以和數列位

如法乘車皆減盡甲乙兩行減餘皆在乙行和數也乙丙相減余乙駝二丙牛六是有正負也載物減盡適足也【乙丙載物減盡則不但對減去之物適相當而其減余之駝二牛六其力亦適相當也𨿽欲不命之適足不可得矣】

乃以和較雜重列之

依一和一較法求得牛三十二爲法載物一百二十八石爲實法除實得四石爲牛力牛六共力二十四石以相當之駝二除之得十二石爲駝力以牛力駝力減六十四石餘四十八石車二除之得二十四石爲車力【用右行原數】

論曰此亦以和變較而有適足之數也豈以有空位而立之負乎可以悟其非矣

試更以較數求之

假如運糧以象馬牛車三種但云接運時以三象所載與四牛車二十四馬載之則餘三十六石以八牛車所載與二象十二馬載之亦餘三十六石以七十八馬所載與二象二牛車載之亦餘三十六石問各若干畣曰象七十二石牛車二十七石馬三石

法以較數列位

如法互乘減並重列其餘【中行每加二分一則首位象與右齊同可對減矣其中左象本同徑以對減皆省算法也】

依省算法求得馬三十載九十石以馬除載得三石爲馬力馬九十載二百七十石牛車十除之得二十七石爲牛車力合計牛車四馬二十四共載一百八十石異加正三十六石象三除之得七十二石爲象力【用右行原數】

論曰此原列較數也而其較數亦有減而適足者然則先無適足減之而成適足者往往有之矣

惟適足故分正負非以空位而立負也故知減余之亦有適足而復用左行者非矣知用減余而非用左行則立負之非不攻而破矣

同加異減辧

同名相減則異名相加矣諸書所載忽而同減者忽而異減忽而異加者忽而同加豈不謬哉又爲之說曰以正爲主則同減而異加以負爲主則異減而同加又爲之說曰同名相乘則其下同減而異並異名相乘則其下異減而同並言之縷然用之紛然而要之非是也夫同名相減卽如盈朒章兩盈兩朒相減也異名相並卽如盈不足相並也豈有同加異減之理乎所以誤者不知正負交變之法也正負宜變而不變則首位之異名者何以能對減而盡乎不得不遷就其法同加異減矣苟知其變則首位必同名首位旣同名則凡減皆同名凡加皆異名較若畫一何必紛紛彊爲之說乎

凡減余重列有仍其負正如故者亦有更其正負絕非其故者且有先無正負及其重列而有正負者有先分正負及其重列之而反不分者若但以初名爲定則加減皆舛矣

假如同減之餘分在兩行而爲同名【或左余正右亦余正或左余負右亦余負】則重列必爲異名矣必變其一行之名而列之而其下所餘數必是此二異名物之較數也若無餘數必是此二異名物相當適足也【此以三色言之若四色以上減餘位數多者皆仿此論之】

若同減之餘分在兩行而爲異名【或左余正而右余負或左余負而右余正】則重列必爲同名矣而其下所餘數必是此二同名物之和數也【此亦以三色言之其減余只二色故也】則其原列正負之名皆不用矣

若異倂者尢爲易見何也凡異並者正與負並也正與負並則如一物矣故重列之際必以一行爲主而定其名【或爲正或爲負或變和數則無正負】若但守初名而不知所變將一物而名之正又名之負乎必不然矣兼此數端知正負之交變出於自然非彊名也【不知正負之變亦不知和較之變矣故又有奇減偶加之誤也】

今以諸書所載同加異減例考定如左

假如以牛二羊五作價易豬十三剰價五兩以牛一豬一易羊三適足以羊六豬八易牛五不足三兩問價各若干

畣曰牛價六兩羊價二兩五錢豬價一兩五錢

列所問數

先以右行牛正二徧乘中左兩行得數【中右首位同名故正負不變右左首位異名故變左行之正負以從右亦爲以少從多】

次以中行牛正一徧乘右行皆得原數乃以中右兩得數對減牛各正二同名減盡羊異名【右正五中負六】並得十一豬異名【右負十三中正二】並得十五價無減【右正五兩中適足】仍得五兩於是分正負以價與羊爲同名而重列之【羊右正中負豬右負中正故仍爲較數價與羊同爲正於右行故仍爲同名】次以左行牛負五徧乘右行得數【左行旣變以從右則右行不變仍其正負】乃以左右兩得數對減牛各正十同名減盡羊異名【右正廿五左負十二】並得三十七豬同名【右負六十五左負一十六】減餘四十九【在右】價同名減【右正二十五兩左正六兩】餘十九兩【亦在右】於是亦分正負亦以價與羊同名而重列之羊與余豬原分正負於右故仍爲較數價與羊同爲正於右故同名

列兩減余

如法以兩正羊徧乘得數乃對減羊同減盡豬同減餘十六爲法價同減餘二十四兩爲實法除實得一兩五錢爲豬價以豬十五價二十二兩五錢異加正價五兩【共二十七兩五錢】羊十一除之得二兩五錢爲羊價任於原列中行羊三價七兩五錢內減豬價一兩五錢餘六兩爲牛價

論曰凡列正負可以任意呼之要在知下價之於正負孰爲同名耳若乘後得數則其首列一位必以同名而相減故正負有時變而其價之正負從之變矣故同異加減必以乘後得數而定也如此所列左右行先爲一正一負異名之價而乘後得數必爲同名之價何也兩價皆與牛同名而牛在首列得數必同名故也若以羊更置首列則兩價得數必異名何也價與羊於右同名而於左異名也

試更列之於後

上

中上

中下

下

如法以中行羊與左右兩行互徧乘得數相減羊同減皆盡右中牛異並三十七豬異並一百十八價異並四十五兩【價與牛同名】中左牛同減餘九豬異並三十價九兩無減【與牛同名】

乃以兩減餘各分正負而重列之

如法以牛互徧乘而變左行之正負以相從牛同減盡豬同減餘四十八爲法價同減餘七十二兩爲實法除實得豬價以次得牛羊價合問試又更之

如法以中行豬與左右兩行互徧乘得數相減豬同減皆盡右中羊異並一百十八【右負中正】牛同減餘四十九【余負在中】價同減餘一兩【余負在右】分正負【以價與羊同名】左中羊異並三十【中正而左負】牛異並十三【中負左正】價三兩無減【中之負數】亦分正負【以價與牛同名】皆重列之

如法互乘羊同減盡牛同減餘六十四兩爲法價異並三百八十四兩爲實法除實得牛價六兩以次得羊價豬價

論曰反覆求之皆同減異加別無他術可見古人立法之簡快奇減偶加辧

方程立法只同名相減異名相加盡之【和數有減無並皆同名也較數有減有倂或同名或異名也和較交變故減並相生】不論二色三色四色乃至多色皆一法也今諸書不察偶見瓜梨一例有奇減偶加之形不得其觧遂執爲四色之定法而不知通變使方程一章之法爲徒法而莫可施用深可惜也故覼縷辧之今將梨一問考定如後

假如有二梨四共價四十文又梨二橊七共價四十文橊四桃七共價三十文一桃八共二十四文問各價幾何畣曰八文梨六文橊四文桃二文

法以和數列位依四色有空以省算法求之

惟甲丁兩行有如四色故先以相乘減盡甲梨四丁桃十六皆無減價餘八文分正負【梨甲桃丁故也】以價與桃同名【同在丁行故也】減盡矣而余行皆無則只三色故徑以減余之數與乙行相對

如法互乘梨同減盡橊二十八【左正】桃三十二【右負】皆無減價異並一百七十六文【右負左正】

隔行之異名乃同名也以和數列之不分正負又以余行無梨則只二色徑以減余與丙行列之【於後】

如法乘減橊減盡余桃六十八爲法價一百三十六文爲實法除實得桃價二文以丙行桃七價十四文減共三十文餘十六文悉橊價也橊四除之得橊價四文以乙行橊七價二十八文減共四十二文悉梨價也梨二除之得梨價六文以甲行梨四共二十四文減共四十文除十六文悉價也二除之得價八文

論曰此和數變爲較數而較數復變和數也何以言之初次減余價八文乃桃多於梨之價故曰變爲較數也【桃十六價三十二文梨四價二十四文差八文】何以知之餘數分在兩行也【桃十六在丁行梨四在甲行】何以知桃多於梨桃與價同在丁行故同名也然所用分正負者是甲丁兩行之減余非但以丁行空位而立負也又因乙丙位皆空故用此減余徑與乙行相對是省二算也乃徑求也非專用丁行爲主也減余較也乙行和也一和一較故有異名相並而非以偶行故加也

若第二次減余則復是和數何也其相並一百七十六文乃桃橊之共價【桃三十二價六十四文橊二十八價一百十二文共此數】而非其較數故曰復變和數也何以知之桃與橊𨿽分余於兩行而異名然隔行之異名乃同名也【乙行橊正價亦正減余桃負價亦負兼而用之變爲同名矣】至於立負之非此尢易見蓋旣變和數無正負矣𨿽兩遇空而無減豈得謂之立負乎又因丙行梨亦空故徑用減余與之對減是又省一算非以丁行對丙行也而顧曰立負橊於丁行誤之誤矣減余變和丙行相對是兩和也故有減而無並也而豈以奇行之故而減也乎哉今試以甲丁之行易之則加減全非矣

如法以甲丁行對乘減盡桃十六【甲】梨四【丁】皆無減價相減餘八文【甲】乃分正負以價與桃同名而重列之與乙行相對

如法乘桃同減盡橊六十四【左正】梨二十八【右負】皆無減價同減餘四百二十四文依前論隔行之異名卽同名也不分正負而重列之與丙行相對

如法減橊余梨六十八爲法四百○八文爲實法除實得梨價六文以次得諸物價皆如前

論曰此但更其前後之行耳而價皆同減無異並可見奇減偶加之非通法矣又試以上下之位而更之

如法以甲丁先乘減去梨盡余橊二十八【甲】四【丁】皆無減價相減餘八十文【甲】依前論分正負以價與橊同名而重列之與乙行相對

如法乘減橊盡余桃一百九十六【左正】一十六【右負】皆無減價相減餘五百二十文【左正】依前論復變和數不分正負而徑與丙行重列之

如法減桃余六十八爲法價五百四十四文爲實法除實得價八文以次得諸物價皆如前

論曰此亦有同減無異加固不以奇偶之行而有別也若以甲丁減余更置之則亦有異並之用如後圖

論曰此下價何以倂異名故也何以異名凡一和一較方程在和數行者其得必與較首位同名故其較數之價與首位同名者則亦與和價同名也其與首位異名者與和價亦異名也

先用丙行何也以有故可與余相減亦可見行次之非定也理之不定乃其一定凡事盡然泥一端以定之轉不定矣

又論曰此亦復變爲和數也何以知之正橊正價皆右負桃負價皆左以之並爲一行則無正負矣蓋隔行

如法減桃余橊六十八爲法價二百七十二文爲實法除實得橊價四文以次得諸物價皆如前

論曰兼此數端知加減非闗行數矣

統宗歌曰四色方程實可誇湏存末位作根芽若遇奇行湏減價偶行之價要相加諸書仍訛又推而至於五色六色皆云以末位爲主而自首行以往皆與之加減至其所以加減者又皆以行之奇偶如一行三行五行奇數也則價與末行減二行四行偶數也則價與末行加而不言同異名將奇行者皆同名乎偶行者皆異名乎未可必也不知彼所設問各行逓空兩位勢必挨列𨿽云四色乃四色之有空者耳非四色之本法也【省算捲辧之極詳可以互發】旣挨列矣余行之首一色皆空不湏乘減惟末行首行相對可以互乘非用末行乃用上一色相對之行耳使上一色不空者在中二行而末行反空又當以中行先用矣𨿽欲以末行爲主得乎

至於第二次重列而乘減者乃用首行末行相減之餘也非専用末行也蓋兩行相減乃生餘數若謂之用末行亦可云用首行矣

又因各行多空故徑以減余與次行乘減得數又徑以減余與三行乘減乃省算之法於末行毫不相渉也

且方程之行次非有定也其前後可以互居左右中可以相易亦何從而定之爲末行乎末行無定矣又安有奇偶之可言乎而以是爲加減之定法乎

然則惡乎定曰詳和較以列減余別同異以定加減苟其和數也𨿽空無減不立正負也苟其較數也𨿽無空位分正負也此列減余之法也但同名者不論何行皆減但異名者不論何位皆加此定加減之法也如是而已

法實辧

算家法實皆生於問者之所求如有總物若干總價若干而問每物若干價則是以物爲法價爲實也或問每銀一兩得若干物則是以價爲法以物爲實也諸算盡然則方程可知矣算海說詳曰中余爲法除下實蓋本統宗然其說非也同文算指曰以少除多其說亦非也何以明之曰方程法實猶諸算之法實也故必於問者之所求詳之中下多少非可執也

假如和數方程有物若干又物若干共價若干是物之位在上中而價之位在下也若問每物之價而以物爲法銀爲實是中除下也固也或問每銀一兩之物而以銀爲法物爲實又當以下除中矣不知問者之所求以物求價乎以價求物乎愚故曰中下難執也

又物之價值莫可等計有賤於銀之物以一兩而得數千百斤有貴於銀之物以數十百金而得一物假如有貴物若干又若干共價若干是物之數少而銀之數多也而問每物之價謂之以少除多似也若問每銀之物不又當以多除少乎又如有賤物若干又若干共價若干是物之數多而銀之數少也而問每銀物若干謂以少除多可也若問每物價若干不且以多除少乎惟以多除少故有不滿法之實實不滿法故有以法命之如雲每銀一兩於物得幾分之幾者是也其物多除銀少者則有退除爲錢若分釐故曰多少難拘也

多少中下旣不足以定法實則法實安定曰亦惟於問意詳之而已今具例如後

論曰方程法實只是以下一位與上中數位相湏爲用耳故有實一而法二其三色者則有實一而法三若以下除中者則有法一而實二或法一而實三故用互乘之法以減之及其用也則只是一法一實而已二色者互乘而對減其一則一法一實也三色者對減其一又對減其一亦一法一實也四色五色其法悉同此方程立法之原也

問河工方九百尺以當築城八百尺城多一工以河工七百二十尺當城工七百尺城多二工問每工一日若干尺

畣曰河工每日六十尺城工每日五十尺

如法乘減余城工五萬四千尺爲實工一千○八十爲法法除實得每工五十尺爲城工每日之數以城工五十尺除右行八百尺得十六工同減負一工餘十五工以除河工九百尺得每工六十尺爲河工每日之數

論曰此以下除中也緣所問每工一日土若干尺以工求土也故以工爲法土爲實若拘中法下實則法實反矣

若問每土千尺該用幾工則當以五萬四千尺爲法一千○八十工爲實法除實得百分工之二是爲每城工一尺之數以所問每千尺乘之得二十工是爲城工每千尺用工二十日也若用異同除則以土千尺乘一千○八十工得一百○八萬工爲實以法五萬四千尺除之得二十工爲城工每千尺之數亦同

於是以二十工乘八百尺【用右行原列】千尺除之得十六工減負一工餘十五工河工九百尺數也以九百尺除十五工得百分工之一又三分之二河工每尺數也以問千尺乘之得十六工又三分工之二爲河工千尺之數用異乘同除以千尺乘十五工得一萬五千工九百尺除之得十六工又九之六約爲三之二亦同

問開渠十七工築堡二十工共以立方計者一千六百八十尺又渠三十工堡四十工共三千二百尺今欲計土續工則每百尺得幾工

畣曰開渠每土一百尺【二工半】築堡每土一百尺二工

如法乘減余堡工八十爲實土四千尺爲法法除實得每尺百分工之二以百尺乘之得二工爲築堡每百尺之工【或異乘同除以百尺乘八十工得八千爲實以法四千尺除之亦得每百工二工】以左行堡工四十乘百尺二工除之得二千尺以減共三千二百尺餘一千二百尺渠土數也用除渠工三十得百分工之二半以百尺乘之得二工半爲開渠每百尺之工【或異乘同除以百尺乘三十工得三千以一千二百尺除之亦得每百尺二工半】

論曰此亦以下法除中實也緣所問以土求工故也又爲以多除少蓋土之數原多於工也故退除而得其分秒而所問者每百故又有異乘同除之用也並分母辧

自方程笇失傳有可以方程立算亦可以差分諸法立算者則皆收入諸法而不知用方程如愚末捲所載方程禦雜法是也有實非方程法而列於方程如同文算指所収菽麥畦工諸互乘之法是也有可以方程算而不用方程漫以他法彊合而漫謂之方程如並分母之法是也諸互乘法非方程易知不必辧故専辧分母

問甲乙二窖不知數但云取乙三之一益甲取甲二之一益乙則各足二千石

畣曰甲窖一千六百石乙窖一千二百石

原法曰列位互乘甲得六千石乙得四千石相減餘二千石爲實並兩分母共五爲法除之得四百石以乙分母三乘之得一千二百石爲乙窖以乙窖減二千石餘八百石以甲分母二乘之得一千六百石爲甲窖

論曰此法不然乃偶合耳若分母爲三與四卽不可用或分子爲之二之三亦不可用況方程法原無平列兩色物之理而此獨平列旣平列矣又何以先得乙窖皆不合也今以方程本法禦之則無所不合

依帶分化整爲零法列位

如法乘減甲減盡余乙五分爲法餘二千石爲實法除實得四百石爲乙之一分以乙分母三乘其一分得一千二百石爲乙窖以乙之一分減二千石餘一千六百石爲甲窖

論曰此亦用五分爲法也然爲得數相減之餘非並分母也所用之實亦二千石然爲甲分互乘之數相減非甲乙兩分母互乘相減也

亦先得四百石爲乙三分之一然以乙列於中甲列於上故先減去甲而余乙爲法以先得乙之分若列乙於上則亦先得甲分矣試更列之以先求甲窖

如法乘減乙減盡甲餘五分爲法餘四千石爲實法除實得八百石爲甲之一分以甲分母二乘之得一千六百石爲甲窖

以甲之一分減二千石餘一千二百石爲乙窖

論曰凡方程有各色皆可更列其上下以互求而任先得其一色何也其互乘而對減者皆實數也若並分母爲法則無實數可言故不可以互求

愚於帶分言之備矣或化整爲零【如上所列二例是也】或變零從整或除零附整共有三法凡帶分者皆可施用若並分母爲法則多所不通矣凡此皆諸書沿誤而同文算指亦皆收入未嘗駁正也

試以分母非三與二者求之

假如有句股不知數但云以股四之一益句以句三之一益股則皆二丈二尺問句股各若干

畣曰句一丈八尺股一丈六尺

依化整法列位

上

中

下

如法乘減余股十一分爲法四丈四尺爲實法除實得四尺爲股之一分以股分母四乘其一分得一丈六尺爲股

以股之一分減共二丈二尺餘一丈八尺爲句

論曰此十一爲法也若以股列於上則亦十一分爲法也如並分母將以七爲法其能合乎

又試以分子非之一者求之

假如有股與不知數但云若取六分之二以益股則五丈五尺若取股三分之二以當則少五丈五尺問若干

畣曰股三丈七丈五尺

法以一和一較依化整法列位

如法互乘股同名減盡異名並得二十二分爲法數異名並得二十七丈五尺爲實法除實得一丈二尺五寸爲之一分以分母六乘其一分得七丈五尺爲以之二分二丈五尺減共五丈五尺餘三丈爲股

論曰此以二十二爲法也若以列於上則亦二十二爲法也而並分母是將以九爲法矣豈不毫釐千里乎

以上數則皆不可並分母爲法

問者或云甲乙倉粟不知數但知共二千石其甲二之一與乙三之一等各若干

畣曰甲八百石乙一千二百石

法以和較雜列位亦用化整爲零

徧乘甲同減盡乙異並五分爲法二千石無減爲實法除實爲乙之一分以乙分母三乘其一分得一千二百石爲乙倉因適足故乙之一分猶甲之一分也以甲分母二乘之得八百石爲甲倉

論曰惟此有似於並母然實非並分母乃並得數之異名者也又按並母法與方程不同

假如有倉粟取三之一又二之一共計二千石問原數若干

畣曰原數二千四百石

法以兩母互乘其子而並之得五爲法以兩母相乘得六以乘二千石得一萬二千石爲實法除實得二千四百石爲原倉之粟

論曰此卽並母法也因兩分子皆一故並母用之實並兩分母互乘其子之數也蓋旣曰三分二分其原數必可以三分之又二分之者也故以兩分母相乘得六借爲原數之衰原數六則三之一卽二也二之一卽三也並而用之借爲所取之分如雲取原數六分之五而二千石也六分之五爲二千石則其全數必二千四百石矣此通分法非方程

設問之誤辧

算家設問以爲規式意𨿽引而不發數則實而可稽苟其稽之而無有眞實可言之數則其意不能自明而何以爲式乎至其立法之多違於古皆以不深知算理而臆見橫生又相因而必至也故以設問爲之目

今將同文算指所載井不知深例考定如後餘如此者尙多不能一一爲辧也【錢塘吳信民九章比類亦載是例非同文創立也蓋方程之沿誤久矣】

問井不知深以五等繩度之用甲繩二不及泉借乙繩一補之及泉用乙繩三則借丙一用丙繩四則借丁一用丁繩五則借戊一用戊繩六借甲一乃俱及泉其井深若干五等繩各若干

原法曰列五行以五繩之數爲母借繩一爲子先取甲二乘乙三得六以乘丙得二十四以乘丁得一百二十以乘戊得七百二十並入子一共七百二十一爲井深積列位

一甲二乙一

○

○

○七百二十一二○

乙三

丙一○

○七百二十一三○

○

丙四丁一

○七百二十一四○

○

○

丁五

戊一七百二十一五甲一○負一○負一○負一戊六七百二十一乃取五行爲主而以一二三四俱與相乘

先以一行甲二徧乘五甲【甲一得二戊六得十二積七百二十一得一千四百四十二】

五行甲一亦徧乘一行對減【甲得二減盡乙得一因五行乙空立負一積七七百二十一本數以減五行仍餘七百二十一】

次以二行乙三乘五行【乙負一得負三戊正十二得三十六積七百二十一得二千一百六十三】

五行乙負一亦乘二行【乙三得三對減盡丙一得一因五行丙空立負一積七百二十一得本數並入五行積共二千八百八十四】

再以三行丙四乘五行【丙負一得四戊正三十六得一百四十四積二千八百八十四得一萬一千五百三十六】

五行丙負一亦乘三行【丙四得四減盡丁一得一因五行丁空立負一積得本數與五行對減餘一萬○八百一十五】

又以四行丁五乘五行【丁負一得五戊正一百四十四得七百二十積一萬○八百一十五得五萬四千○七十五】

五行丁負一亦乘四行【丁五得五減盡戊一得一並入五行戊正七百二十共七百二十一積得本數並入五行積五萬四千○七十五共五萬四千七百九十六】

乃以最後所得求之以積五萬四千七百九十六爲實戊七百二十一爲法除之得戊繩七尺六寸以減四行總積【七百二十一】餘六百四十五以丁五除之得丁繩一丈二尺九寸以減三行積【七百二十一後同】餘五百九十二以丙四除之得丙繩一丈四尺八寸以減二行積餘五百七十三以乙三除之得乙繩一丈九尺一寸以減一行積餘五百三十以甲二除之得甲繩二丈六尺五寸

論曰此一例中有數誤一者以末行爲主而以一二三四與之相乘此由不知和較交變而沿奇減偶加之失誤一一者謂末行有空故立負由不知有空徑求而沿立負之非誤二一者以除法命爲井深而設問不明言丈尺誤三又輒立母逓相乘加借子一之法誤四一例中誤至數端將令學者何所措意乎

前之兩誤【謂以未行爲主而奇減偶加反立負之法】業於梨諸例辧之綦詳可以互見今特明後兩誤之非具如後論

凡言百十者皆虛位也其實數以單位爲端故單位爲寸則十者尺百者丈若單位爲尺則十者丈百者十丈若單位爲丈則十者十丈百者百丈七百二十一以爲井深不知其所謂一者尺乎寸乎丈乎若七百二十一尺七百二十一寸七百二十一丈相去甚懸然其爲七百二十一者不殊也先不明言尺寸𨿽得數何以命之

詳觀問意乃借井深以知各繩故井深者和數也在各行中皆所列諸繩之共數必先知此共數然後以乘減之法求之而各數乃見矣而不先言井深轉借各繩以求之方程中無此法也故其所得但爲七百二十一之虛率而不能防其爲丈尺何等亦固然耳

七百二十一亦非井深定率何也倍七百二十一則一千四百四十二若三其七百二十一則二千一百六十三推之以至於無窮凡可以七百二十一除之而盡者皆可以五等繩相借而及泉也故使其井爲一丈四尺四寸二分之深則戊繩必一尺五寸二分丁繩必二尺五寸八分丙繩必二尺九寸六分乙繩必三尺八寸二分甲繩必五尺三寸矣使其井爲二十一丈六尺三寸之深則戊繩二丈二尺八寸丁繩三丈八尺七寸丙繩四丈四尺四寸乙繩五丈七尺三寸甲繩七丈九尺五寸矣皆甲二偕乙一若乙三則偕丙一若丙四則偕丁一若丁五則偕戊一若戊六則偕甲一而及泉故曰七百二十一非井深之定率也

七百二十一者除法也以此爲法除井深乘並之數而得一繩因以知各繩卽不得以此命爲井深

除法法也井深實也而以法爲實乎

以七百二十一爲除法乃繩也如所求先得戊繩之數則此七百二十一者卽是戊繩也其五萬四千七百九十六者乃七百二十一戊繩之共數也以戊繩七百二十一爲法除其共數而得七十六則是一戊繩之數也故七百二十一者繩也五萬四千七百九十六者井深也【假如一井深七丈二尺一寸則七十六井共深五百四十七丈九尺六寸井無此深乘並而有也數猶戊繩之七百二十一亦以乘並而得也】而顧以繩之積爲井深之積乎

假如井深一丈四尺四寸二分依法求之其爲戊繩之共數必一百○九丈五尺九寸二分而其戊繩亦必七百二十一以七百二十一爲法除一百○九丈五尺九寸二分得一尺五寸二分則一戊繩之數矣故曰七百二十一者非井深也乃除法也繩也繩之爲除法者有定而其所除之井深無定也

又輒立母子乘並之法夫以各繩爲母而借繩爲子未大失也蓋於三繩中取一卽是三之一於四繩取一亦卽四之一也乃謂七百二十一爲母相乘而加借子則非也蓋位旣疊空除首位減去外皆母與相乘乘子與相乘而不相遇至第四次乃相遇而又適當其變爲一和一較之時異名相並故得此數以爲除法耳固不得立此以爲通法也

假如問五色方程而各行不空則和較之變多端豈預知其減並卽使各行有空如所列而或爲較數則有減而無並亦將以借子加之乎

又所加之一乃子相乘之數若遇借子爲之二之三則皆不能徑用其原借之子數也故曰非通法也今試以井深一丈四尺四寸二分者舉例如後

假如有井深一丈四尺四寸二分以甲乙丙丁戊五等繩汲之皆不及泉若甲借乙三之一乙借丙四之一丙借丁五之一丁借戊六之一戊借甲二之一皆及泉問繩各長若干

法以帶分和數列位

上上上下中上中下下上

下下

依空位省算先以一行與五行對乘甲減盡乙一戊十二皆無對不減和數餘一丈四尺四寸二分乙在首行戊與一丈四尺四寸二分在五行分正負列之和變較也余行無甲繩不湏減

徑以減余與次行相對

依和較相雜法互乘乙繩同減盡丙一【左正】戊三十六【右負】皆無減和較數異並五丈七尺六寸八分【右負左正】復變和數不分正負【隔行異名並故也】

依和數乘丙繩減盡丁繩一【左】戊繩一百四十四【右】皆無減和數減餘二十一丈六尺三寸【右】又復變和數也分正負列之

余行又無丙繩徑以減余與第四行相對

上

中

下

依和較相雜乘丁同減盡戊異並七百二十一爲法和較數異並一百○九丈五尺九寸二分爲實法除實得一尺五寸二分爲戊繩六之一以減共一丈四尺四寸二分得一丈二尺九寸爲丁繩五除丁繩得二尺五寸八分爲丁繩五之一以

減共一丈四尺四寸二分餘一丈一尺八寸四分爲丙繩四除丙繩得二尺九寸六分爲丙繩四之一以減共一丈四尺四寸二分餘一丈一尺四寸六

分爲乙繩三除之得三尺八寸二分爲乙繩三之一以減共一丈四尺四寸二分得一丈○六寸爲甲繩二除之得五尺三寸爲甲繩二之一以減共一丈四尺四寸二分得九尺一寸二分爲戊繩

計開

論曰此亦七百二十一爲除法也減並之用與前無異而井深旣別繩數迥殊不先言丈尺何以定之試又以較數明之

今有數不知總其五人所分亦不知各數但云取乙三之一以當甲取丙四之一以當乙取丁五之一以當丙取戊六之一以當丁取甲二之一以當戊皆不足七百一十九問若干

畣曰甲一千○三十四乙九百四十五丙九百○四丁九百二十五戊一千二百三十六

法以較數列位

依帶分法化整爲零

如法乘甲同減盡乙一【左負】戊十二【右負】皆無減同名在隔行仍分正負較數異並與戊同名余行無甲徑以減余對第三行

如法乘乙同減盡丙一【左負】戊三十六【右負】皆無減以隔行同名分正負較數異並與戊同名余

行無乙徑以減余對第四行

如法乘丙同減盡丁一【左負】戊一百四十四【右負】皆無減以隔行同名分正負較數異並仍與戊同名余行無丙徑以減余對末行

如法乘丁同減盡戊同減餘七百一十九爲法較數異並一十四萬八千一百一十四爲實法

除實得二百○五爲戊之一分加正七百一十九共九百二十五爲丁數五除丁數得一百八十五爲丁之一分加正七百一十九共九百○四爲丙數四除丙數得二百二十六爲丙之一分加正七百一十九共九百四十五爲乙數三除乙數得三百一十五爲乙之一分加正七百一十九共一千○三十四爲甲數二除甲數得五百一十七加負七百一十九共一千二百三十六爲戊數六除戊數仍得二百○六爲戊之一分

計開

論曰此其母與母相乘子與子相乘與前略同但末後相遇爲同減故不以七百二十一爲法而以七百一十九爲法無他較數也若依母相乘而並子豈不誤哉

且四次乘減其下較皆異倂亦足見奇減偶並之非又以法同而得數迥異者明之

今有數五宗不知其總但云以乙三之一當甲以丙四之一當乙以丁五之一當丙以戊六之一當丁皆適足若以甲二之一偕戊則共數七百二十一問各若干

法以和較帶分列位化整爲零

甲同減盡乙一【左負】戊一十二【右正】皆無減一千四百四十一亦無減隔行異名卽同名也變爲和數重列之與次行對

乙同減盡丙一【左負】戊三十六【右正】四千三百二十六【右正】皆無減皆隔行異名亦變和數重列與第三行對

丙同減盡丁一【左負】戊三十六【右正】一萬七千三百○四【右正】皆無減隔行異名仍變和數重列與第四行對

丁同減盡戊異並七百二十一爲法八萬六千五百二十無減就爲實法除實得一百二十爲戊六之一卽丁數五除之得二十四爲丁五之一卽丙數四除之得六爲丙四之一卽乙數三除之得二爲乙三之一卽甲數半之得一爲甲二之一以減共七百二十一餘七百二十爲戊數

計開

甲二乙六丙二十四丁一百二十戊七百二十論曰此亦以七百二十一爲法而其各數迥不相類則以下數之爲和爲較迥不相同也然則井深者卽和數也而不先言其丈尺顧以除法命之可乎

又試以分子逓借而非之一者明之

今有甲乙丙丁船各十隻以載鹽九千七百七十六引俱不足若甲借乙一乙借丙二丙借丁三丁借甲四則各能載問各船若干

法以和數列位

列後

甲減盡乙四【右】丁一百【左】皆無減以兩行故分正負載鹽餘五萬九千八百五十六【左】與丁同名甲空與減余對次行

乙同減盡丙八【左正】丁一千【右負】俱無減引異並六十三萬八千四百六十四【右負左正】異名在隔行復變和數無正負乙空以減余對三行

丙減盡丁餘九千九百七十六爲法引餘六百三十萬○四千八百三十二爲實法除實得六百三十二引爲丁船數以丙借丁船三乘丁數得一千八百九十六以減共九千九百七十六引餘八千○八十丙所載也以丙十除之得八百○八引爲丙船數以乙借丙船二乘丙數得一千六百一十六以減共九千九百七十六引餘八千三百六十乙所載也以乙十除之得八百三十六引爲乙船數以乙船數減共九千九百七十六餘九千一百四十甲所載也以甲十除之得九百一十四引爲甲船數計開各船每只載數

甲船九百一十四引

乙船八百三十六引

丙船八百○八引

丁船六百三十二引

論曰此四色方程逓借法與諸書所載馬騾載米同亦與同文算指井不知深同但彼誤以除法爲井深又誤立各母逓乘加借子法故設此問以顯其理

此所用除法丁船九千九百七十六猶彼所用除法戊繩七百二十一也乃除法也非井深也除法有定而井深無定卽如此問九千九百七十六之除法有定而鹽之數無定也何言乎無定假如以九千九百七十六引而倍之則各船之所載亦倍矣以引數半之船所載亦半矣然其除法之九千九百七十六如故也若不先言引數何知之

共載九千九百七十六引者鹽數也以九千九百七十六爲法而除者船數也船爲法者算家虛立之率鹽列位者問者現據之實數數𨿽偶同爲用迥別

以各原數爲母借數爲子是也如甲借乙船一而乙船原有十卽十分之一也謂母相乘而加借子一則非法也如此所用除法九千九百七十六何以處之又如後條馬步舟師各借二分者又何以處之數𨿽似不可施之他數非通法矣

又試以三色例亦用異加得除法者觀之

假如有馬步舟師不知數但云取騎兵五分之二益步取步卒三分之二益舟取舟師七分之二益騎則皆得六千七百八十名

畣曰步卒四千五百名騎兵五千七百名

舟師三千七百八十名

法以和數帶分列位

依省笇以左行加二分之一步卒減盡騎二分【右】舟師十分○半【左】皆無減共數減餘三千三百九十【左】分余兩行變較數也以較數與舟師同名中行步卒原空徑以減余作二色列之

依省算四因左行而退位騎同減盡舟師異並十一分三釐爲法和較數異並六千一百○二爲實法除實得五百四十爲舟師之一分以分母七乘之得三千七百八十名爲舟師數

以舟師數減共數六千七百八十餘三千所借步卒之二分也二除之分母三乘之得四千五百爲步卒數

以步卒數減共數六千七百八十餘二千二百八十所借騎兵之二分也二除之分母五乘之得五千七百名爲騎兵數

論曰此𨿽以異加而得除法然不得竟以子之二加也故以分子一加者非通法也

歷算全書卷四十三﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

欽定四庫全書

歷算全書卷四十四

宣城梅文鼎撰

方程論卷五

測量

測量非方程事也方程者算術算術恃計測量恃目實惟兩途測量之不能兼算術猶算術之不能兼測量𨿽曰能兼非其粹矣今略具其所兼其不能兼者有句股諸法在

測量在方程有二

一曰陰雲測量

陰雲者不見宿度而云影微薄之處猶能見五緯若見二星則有其相距之度而可以方程取之矣

一曰宿度測量

宿度者𨿽無陰翳而無儀器故借宿距一定之度以取之必有二星同見或星與太陰同見則成方程之算矣

陰雲測法

假如陰雲不見宿次但於云隙測得辰星在太白後一度又二日熒惑與二星同在一度又二日太白在熒惑前三度而辰星雲翳又一日辰星在房初度余不可見又十二日熒惑始至房初問各行率若干畣曰辰星每日行二度太白每日行一度有半熒惑每日行半度

解曰此辰星行二日太白亦二日而辰星多一度熒惑與太白同行三日而太白多三度辰星行四日熒惑十六日而行度相當也

法曰以較數列位

依省算以左行半之與右相減辰星同減盡太白二日【右負】熒惑八日【左負】皆無減分正負【同名在隔行卽異名也】正一度亦無減【與熒惑同名】

重列減余與中行

依省算以左行減三之一乃對減太白同減盡熒惑同減餘六日爲法行度異並三度爲實法除實得半度爲熒惑每日行率以右減餘八日乘之得四度同減負一度餘三度以太白二日除之得一度半爲太白日行率以右行太白二日行三度異加正一度共四度以辰星二日除之得二度爲辰星每日行率

假如測得辰星在金星後二度陰雲不知宿次但於四日後見二星同行在一度亦未知宿次又三日辰星行至房初度而金星雲翳至第四日金星亦至房初而水星未見問兩星每日行率若干

解曰此兩星各行四日而辰星多二度辰星行三日金星行四日而其度相當

法以較數列位

二色者有一色偶同依省算徑以對減金星同減盡辰星同減餘一日爲法正二度無減爲實法一省除徑以二度爲辰星每日行率以辰星三日行六度金星四日除之得每日行一度半

若欲知前兩測某宿度者以金星四日行六度爲二星同度距房初之數又加金星同行四日六度共十二度爲前測金星距房之度又加辰星在金星後二度爲辰星前測距房之度各以距度與房初度相求得前兩測星躔宿度

如順行者前所測之宿在房後也氐宿亢宿也各置距度以氐宿亢宿度疊減之不盡者以轉減前宿之度得星所在宿度如逆行者前所測之度在房前也心宿尾宿也各置距度以房度心度逓減之減不及者卽命爲後宿星所在之度

假如甲子日金星夕見乙丑日水星夕見至丁卯日水星行及金星但不及半度至戊辰日二星同度皆以陰晦不能細知宿次問各率若干

解曰此金星行四日水星三日相當

金星行三日水星二日則水星不及半度

法以較數列位

依省算左行二分加一水同減盡金同減余半日爲法空度七分半爲實法除實得金星日行一度半金三日行四度半同減負半度餘四度以水星二日除之得日行二度

假如廣福二船哨海福船先發行五日廣船行三日遇於中途其泛地相距二千五百里遂又同往一島廣船行四日先至候六日福船始至問各船每日行率解曰此廣船疾福船遲也廣船三日福船五日共行水面二千五百里廣船四日福船十日而水程相當

畣曰廣船日行五百里

福船日行二百里

法以一和一較列位

如法徧乘廣船同減盡福船異並五十日爲法正一萬里無減爲實法除實得二百里爲福船

毎日行率福船十日行二千里以廣船四日除之得五百里爲廣船每日行率

又如自東䢐西共二千里先乘車行五日換舟行八日至其國其舟與車復同往一處車先行六日舟乃發行四日逐及問舟車行率

畣曰舟每日二百里車每日八十里

解曰舟疾車遲舟八日車五日共行二千里舟四日車十日行適相當

依省算半右行數舟同減盡車異並十二日半爲法正一千里無減爲實法除實得八十里爲車率以舟四日除車十日所行八百里得二百里爲舟行率

假如甲乙二船哨海同泊一山同用正卯酉字風東行但甲船先發解防七日乙船後行解防五日追及於一島又自此島用正子午字風南行但甲又先發解防九日泊於南洋乙後發解防七日泊於又南洋其二洋相距二百里問道裏各數

法以較數列位

甲船同減盡乙船餘四日爲法負一千四百里爲實法除實得三百五十里爲乙船每日率以甲船七日除乙船五日所行一千七百五十里得二百五十里爲甲船率其一千七百五十里卽山島相去之程以甲船九日行二千二百五十里爲島去南洋之程又加二百里爲又南洋之程合問計開

甲船每日行二百五十里

乙船毎日行三百五十里

山島之距一千七百五十里

島距南洋二千二百五十里

距又南洋二千四百五十里

自山至又南洋共水程四千二百里

又假如二人同往西番公幹一人車一人騎車自某山西行九日騎自某河西行十日及之於一城其河在山之東相距三百里又自此城西行八日騎先至一國駐札候一日車至問道裏各如幹

法以較數列位

如法徑減余騎二日爲法三百里爲實法除實得一百五十里爲騎行率並騎前後共十八日行二千七百里爲所駐西國距河之程騎所行也減河距山三百里餘二千四百里爲西國距山之程車所行也並前後車行十八日除之得一百三十三里又三分裏之一【卽一百二十步也】爲車行每日裏率用車行裏率乘九日得一千二百爲城距山之程以減總距余亦一千二百里爲西國距城之程計開

騎日行一百五十里前後共行二千七百里車日行一百三十三里又三分裏之一前後共行一千四百里

城距山一千二百里距河一千五百里

國距城一千二百里距山二千四百里距河二千七百里

此上數則近事易知用明測量之理

宿度測法

凡測量之法有測器又有水漏則𨿽陰雲可以所見者得其度若但有測器而無水漏可以所見兩星之距度取之如前所列陰雲不知宿度之法是也乃又無測器而但據目見則當以宿度取之蓋宿有一定之度借以爲兩星之和度較度因所知以求不知此則方程之法可爲測量者助也至於諸星行率古今曆術不同學者通其意無拘其數焉其可

若一星單行非儀器比量莫知其遲疾之度然晴雨難期則亦有因所見以測所不見之時故算術不可廢也

五星錯行多有相遇則和度較度可施若太陰毎月經行廿八宿一次與五星相遇亦每月有之精於推步者𨿽非假此定星然用與曆術相參有不借儀器而知遲疾使看者引驗見效亦算家之樂也

其五星各有遲疾畱逆故測量比例當於相近日數內求之則所差亦不多也

其遲疾變行湏查七政歷以約其日則一星單行亦自可考其進退之數

兩星相較例

假如兩宿原有定距【如房距心】若干度有一緯星在其間【如金在房心間】以旁星記之越若干日緯星行至東宿【如心】又別一緯星【如火星】在西宿【如房】越若干日行至先所記旁星之處

此因無儀細測故借宿度用之如上所舉乃以宿距爲二星和度也一緯星若干日【如金】一緯星若干日【如火】共行天若干度【如房度】故曰和度

又如以一宿爲主【如心】有緯星在其西【如木】以旁星記之越若干日緯星行過宿東至後一宿【如尾】又或異日別一緯星【如土】亦在前記緯星處所越若干日行至所借爲主之宿【如心】

此則以宿距爲二星較度也一緯星若干日【如木】一緯星若干日【如土】相差若干度也【如心度】故曰較度

凡此皆可以方程禦之

若得兩較度或兩和度或一和一較卽二色方程術也若三星四星以上各得三兩宗測數以三色四色等方程求之無不可見

如木星在一宿之西【如井鬼之間】越若干日行至其宿【如鬼】火星原在木星之西越若干日行至木星原處金星又在火星之西而恰當西宿【如井】越若干日行至火星原處又若干日亦至木星原處

此亦借宿度爲用而中有二和一較如雲金星若干日火星若干日木星若干日共行若干度也【如井度】又金星若干日木星若干日共行若干【亦用井度】此二者和度也又金星若干日火星若干日而其行適等【用火星至木星元處之日及金星自火星元處至木星元處之日】此則較度也【適足卽較數也度無較其日則有較】

又如火星在房宿之西越若干日行過房抵心宿而木星自火星元處越若干日至房宿又有金星或先或後亦自火星元處越若干日行至房又若干日逐及木星於房心之間

此以宿距爲較度者三如雲以火星若干日較木星若干日而火星之行多一房度也以火星若干日較金星若干日而火星亦多一房度以金星若干日較木星若干日而行度相等【用兩星逐及於房心之間日數】

此上二則以三色取之凡所測不必兩星同在一度但欲有旁星可記異日有他星復至所記旁星之處卽成同度之算右皆順行星例

又如一星順行自房行幾日一星逆行自心行幾日相遇同度於房心間自此分行又幾日其逆行星至氐此用一較度一和度也順行星幾日逆行星幾日共行房宿度此爲和度順行星幾日逆行星幾日而逆行星多一氐宿度此爲較度【用逆行星相遇後至氐宿之日數】

又如一星自建星順行至幾日遇逆行星又幾日至牛宿其逆行星自相遇處行幾日至建星又幾日至斗宿距星

此亦一和一較順行星幾日逆行星幾日而行度相當【用二星兩相遇處至建星之日數】此較度也順行星幾日逆行星幾日而共行斗宿度【用兩相遇後順行星至牛逆行星至斗之日數】此和度也

右逆行星例

問金火二星在房宿之西同度越九日金星行過房東至一處有星可記又一日金星行至心宿又八日火星始至房又九日火星始至前所記金星之處其二星行度各若干

解曰此金星行九日火星廿七日而行度相等金星行十日火星十八日而金星多六度【房宿六度故也】

法以較數列位

依省算以右行加九之一乃對減餘火星一十二日爲法六度無減爲實法除實得半度爲火星率以金九日除火廿七日行十三度半得一度有半爲金星率

假如太陰自尾宿初度行三日遇木星於鬥牛間又三十日木星行至牛

此太陰三日木星三十日共行四十五度【借尾至牛之度約略其數後仿此】

木星自牛初行三十日與羅防遇於牛女間又一百二十日羅防退至牛

此木星行三十日羅防一百二十日而度等【羅防計都月孛有數無形借逆行之用】

羅防自牛初退行一百日遇土星於箕鬥間又五十日土星行至牛

此羅防一百日土星五十日行度等

土星自牛初行三十日火星逐及遇於牛女間又三十日火星行至虛此土星三十日水星三十日而共行十八度

火星自虛初行五十日水星逐及遇於危室間又十日水星行至奎

此火星行五十日水星十日共行四十五度

水星自奎初行十五日逐及金星遇於昴畢間又十七日金星行至畢

此水星十五日金星十七日共行五十五度半

金星自畢初行二十日遇計都於井鬼間又四十日計都退至井此金星二十日計都四十日而金星多二十八日【借畢至井之距爲兩星之較】

計都自井初逆行二十日遇月孛於參井間又十日月孛行至井

此計都二十日月孛十日而行度等

月孛自井初行八十日太陰逐及遇於井鬼間又二日太陰行至栁

此月孛八十日太陰二日共行三十四度

問各行率若干【凡此所設不必其同日在一度謂之相遇但與宿值或有星可記卽如同度之理】如法列位【九色和較之雜】

因九色行中擠廹旣多空位取出其行次相對者列而先乘此捷法也

先以甲壬太陰對減【兩行相對只三色余俱兩空省不書俟重列時以次添入】

用省算法以甲行三之一壬行二之一列之【因甲行可三除壬行可二除而除之則太陰皆一日故除而列之】徑對減太陰盡餘木星十日【右】月孛四十日【左】減餘二度【左】分正負太陰減去尋原列中乙行有木星徑與減余對列

用前法以左乙行三之一與減余列之木星徑同減羅四十日【左負】孛四十日【右負】負二度【右負】皆無減【以隔行同名仍分正負】

木星減盡尋丙行有羅防徑與減余重列

用前法以減餘二之一丙行五之一列之羅防同名徑減餘三位無減以隔行皆負分正負而孛與較同名

羅防減盡尋丁行有土星徑對餘數

和較列位

用前法以丁行三之一列之而命之爲正土同減盡余無減度異並七度皆左正右負復變和數土星減去尋戊行有火星徑對餘數

用前法以戊行五之一列之火徑減水

【左】孛【右】

無減分正負復爲較餘二度

【左】與水星同名火星減盡尋已行有水星以對餘數【又因巳行不便省算攺用辛行月孛相對】

用前法以減余半而列之孛同減余俱無減隔行同名仍爲較

月孛減盡尋庚行有計都以對餘數【水與較度皆右行負同名】

用前法以庚行半而列之

計同減水【右負】金【左負】無減仍爲較

餘十三度【左負】與金同名

計都減盡尋巳行恰皆二色以相對

如法乘水同減盡金余異倂一百六十七日爲法度異並二百五十○半度爲實法除實得每日一度半爲金星率

以巳行金星十七日行二十五度半減共五十五度半餘三十度以水星十五日除之得每日二度爲水星率

以戊行水星十日行二十度減共四十五度餘二十五度以火星五十日除之得毎日半度爲火星率

以丁行火星三十日行十五度減共十八度餘三度以土星三十日除之得每日十分度之一爲土星率

以丙行土星五十日行五度以羅防一百日除之得每日二十分度之一爲羅防率

以乙行羅防一百二十日行六度以木星三十日除之得每日五分度之一爲木星率

以甲行木星三十日行六度以減共四十五度餘三十九度以太陰三日除之得每日十三度爲太陰率

再以庚行金星二十日行三十度同減去正二十八度餘二度以計都四十日除之得每日二十分度之一爲計都率【與羅防同】

以辛行計都二十日行一度以月孛十日除之得每日十分度之一爲月孛率

以壬行月孛八十日行八度減共三十四度餘二十六度太陰二日除之仍得毎日十三度爲太陰率

論曰各星遲疾畱逆每叚不同然其各叚中行率大約相等故可以方程立算亦湏稍查時歷以知其變

若太近畱叚行率甚微難見其在合伏左右行甚疾毎日不同難與他星相較則以一星遲疾之較取之具如後例

一星遲疾相較例

凡木火土三星𨿽有遲疾之行大約皆在一度以下而土木之變尢緩其數十日中行率僅差秒忽兩星相較之法頗可施用惟金水二星遲疾之差懸逺其疾也有在一度以上而水星有二度其遲也不及一度遲之甚則畱故可以其遲疾而自相較也

假如金星疾叚測得甲乙丙三日共行四度二十九分己庚兩日共行二度有半問各日行率【此因前測以陰雲用儀得其度分而不知宿次故𨿽後測能知宿次而中數日不可知是惟方程能禦之也】

法以和數列所測以較數列中日【因挨日進退故倍中日爲前後兩日而命之適足蓋已知測日同在一叚故也】

如法互乘逓減余庚廿七日爲法三十三度廿一分爲實法除實得一度廿三分爲末日行率【庚】以庚日行率減共二度五十分餘一度廿七分爲第六日行率【己】倍己日行率減去庚日行率餘一度三十一分爲第五日行率【戊】倍戊日行率減去己日行率餘一度三十五分爲第四日行率【丁】倍丁日行率減去戊日行率餘一度三十九分爲第三日行率【丙】倍丙日行率減去丁日行率餘一度四十三分爲次日行率【乙】倍乙日行率減去丙日行率餘一度四十七分爲初日行率【甲】

累計甲乙丙日共四度廿九分己庚日共二度半合問或倍庚日行率共二度四十六分以減共二度半余○度○四分爲日差以日差累加庚日得各日行率

總論曰凡步五星旣得其叚日以爲日率則以其盈縮之歷加減星行而得其叚所行之宿次以爲度率以日率除度率而得其平行則又以初末日率相求使之陞降有等以爲日差而加減之故日差者步五星之要事也

右例不拘日數但在遲疾本叚則可用此法

亦不拘定是宿次所見或儀器所測但有兩宗宿度則其餘日皆可倍中日以較其前後兩日命爲正負適足而求之何則其加減皆相挨而有序故知倍中日卽同前後兩日也

假如金星晨疾測得甲日之寅距地平一度至丙日之卯距地平三十度○七十五分至己日之卯距地平三十度問各日行率

解曰此是甲乙兩日共行二度二十五分丙丁戊三日共行三度七十五分也

法以丙日距三十度○七十五分減寅至卯差三十度余○度七十五分與甲日距一度相減余○度二十五分爲金星疾行過平行一度之數加甲乙兩日太陽行二度是爲兩日內金星行二度二十五分又以己日距三十度與丙日距度相減余○度七十五分爲金星疾於平行之度加丙丁戊三日太陽行三度是爲三日金星行三度七十五分

論曰此因陰雲不能細測每日之度故五日中僅有三測也或𨿽無陰雲而儀器不具惟此三日有所當宿次可借以爲行度之據則所得者皆爲前兩日後三日之和度也

如法以兩和三較列位【因逓差補作三適足而列之】

如法乘減得丁三日爲法共三度七十五分爲實法除實得一度二十五分爲丁日行率【此因末兩行減餘三色減去二色只一法一實故徑用以求也】

以丁減餘七日行八度七十五分同減負二度二十五分餘六度五十分以戊減餘五日除之得一度三十分爲戊日行率【此用三四兩行減余】

以丁戊兩日行率相減余○度○五分爲日差以日差減丁日行率得丙日行率累減之得甲乙日行率

計開

甲日行一度十分

乙日行一度十五分

兩日共行二度二十五分

丙日行一度二十分

丁日行一度二十五分

戊日行一度三十分

三日共行三度七十五分合計之五日共行六度此六度者乃金星行於黃道之度寔數也寔數者以宿度徴之如甲日之晨在某宿某度至己日之晨已進六度也其距太陽之數則五日共差一度此一度者乃金星漸近太陽之距亦卽漸近於地平之距也目所見也謂之視差則以儀器度而知之如甲日之卯距地平三十一度至己日之晨卯刻則距地平三十度爲較前相近一度也今所測爲甲日之寅寅與卯相差三十度故寅之星距地平一度者至卯則距三十一度也其時刻以水漏或中星得之若寅正與卯初則只差十五度每刻則差三度太此以儀測星者所當知

論曰凡加減日差湏明進退之理如戊日之行率多於丁日則其疾爲進也而先得末日則以日差累減之而得初日

若先得初日則當以日差累加之而得末日

如前一例庚日之率少於己日則其疾爲退也而先得庚日則以日差累加之而得初日若先得甲日則當以日差減之而得末日

其遲叚則皆反之如末日多於初日其遲爲退也則減末加初

若初日多於末日其遲爲進也則減初加末

論曰凡七政盈縮古今曆術綦詳所設立差平差之術尢宻至於太陰遲疾時刻迥異授時立法以三百三十六限更非逓加挨減所能定惟五星旣得叚日定星其日差可以循次加減而方程測量之法可施也

又方程測量爲艸澤不能具儀器而偶有所見設此禦之使獨見者可以共曉若從事推步則有歷學諸書幸勿以管窺爲誚

歷算全書卷四十四

欽定四庫全書

歷算全書卷四十五

宣城梅文鼎撰

方程論卷六

方程禦雜法

算術之有方程猶量法之有句股必深知諸算術而後能言方程猶之必深知諸量法而後能治句股故以是終

諸方田少廣凡屬量法者往往有可以句股立算而諸法不能治句股方程之於粟布差分也亦然故雜法不能禦方程而方程能禦雜法

例如後

假如有糧一萬九千石與甲乙丙三縣各以其人戶多少米價貴賤僦值逺近舟車險易而均輸之甲縣戶三萬米價毎石一兩四錢逺輸二百里用車載二十石行一里僦值一錢三分乙縣戶二萬米價一兩二錢逺輸五百里用舟載二十五石行一里僦值三分丙縣戶一萬米價一兩二錢逺輸二百里道險可用負擔每負六斗行五十里顧值一錢八分

法曰各以其縣米價並僦值之數命其戶以方程較數列之以甲縣車載二十石除其僦值一錢三分得六釐五毫【每載一石行一里數也】以乘二百里得一兩三錢並米價一兩四錢共二兩七錢以乙縣舟運二十五石除其僦值三分得一釐二毫以乘五百里得六錢倂米價一兩二錢共一兩八錢

以丙縣負擔六斗除其顧值一錢八分以乘一石得三錢又以五十里除之二百里乘之得一兩二錢並米價共二兩四錢

原法以各縣米價並僦值之數以除其戶爲衰列而並之並衰爲法各衰乘總米爲實法除實得各縣米今用方程則不湏爾竟以二兩七錢命甲縣之衰爲二十七戶以一兩八錢命乙縣之衰爲一十八戶以二兩四錢命丙縣之衰爲二十四戶以三縣衰命爲適足而列之

如三色有空法乘余丙縣異倂一百一十四戶爲法正三十四石二斗爲實法除實得丙縣每戶糧三斗以丙一戶三斗減共一石九斗餘一石六斗乙縣四戶除之得每戶糧四斗

以乙二戶八斗甲縣三戶除之得每戶二斗又三分斗之二各以每戶率乘其縣之戶總得各縣轉

計開

甲縣三萬戶共糧八千石共僦車值一萬○四百兩毎戶糧二斗六升六合又三之二每三戶糧八斗每戶僦值三錢四分又三之二每三戶僦值一兩○四分總計米價與其僦值每戶共銀七錢二分

乙縣二萬戶共糧八十石其僦船值四千八百兩每戶糧四斗僦值二錢四分

總計米價僦值每戶亦七錢二分

丙縣一萬戶共糧三千石共顧擔夫銀三千六百兩毎戶糧三斗僦值三錢六分

總計米價僦值每戶亦七錢二分

以米言之

論曰此因米價不等加以僦值不同故以法均之糧𨿽不均而每戶所出之銀數則均若但均其米乃不均矣是故均之以不均斯謂能均

問官米二百六十五石令三等人戶出之甲上等二十戶每戶多中等七斗乙中等五十戶每戶多下等五斗丙下等一百一十戶其則例各若干

法以和較列位【依省算以和數十之一列之】

如法乘減得丙戶十八爲法二十一石六斗爲實法除實得一石二斗爲下等每戶則例加正五斗爲中等則又加七斗爲上等則

計開

甲上等毎戶二石四斗二十戶共四十八石

乙中等毎戶一石七斗五十戶共八十五石

丙下等每戶一石二斗一百一十戶共一百三十二石合計之共二百六十五石

問有米六百七十四石以四等里甲輸納乙爲甲十之八丙爲乙十之七丁爲丙十之六其甲乙各八十戶丙丁各七十戶問各若干

解曰十之八卽非二八差分十之七十之六卽非三七四六差分故與帶分條所設不同合而觀之可也

法以和較列位

如法乘減而重列其餘與三行對

又以餘數與四行平列

數益多用省算法四除減余然後列之

如法乘減餘丁六百七十四爲法五萬六千六百一十六石無減爲實法除實得八十四石爲丁共數十因丁數六除之爲丙共數十因丙數七除之爲乙共數十因乙數八除之爲甲共數

計開

甲共數二百五十石以八十戶除之得毎戶三石一斗二升五合乙共數二百石爲甲十之八以八十戶除之得毎戶二石五斗丙共數一百四十石爲乙十之七以七十戶除之得每戶二石丁共數八十四石爲丙十之六以七十戶除之得每戶一石二斗總計之共六百七十四石

論曰此所問是總數相差非毎戶相差也故原列者總戶而得亦總戶之米若云問毎戶之差則當以毎戶列之而所得者亦毎戶米也如後例

假如共米六百七十四石以四色人戶出之甲八十戶乙亦八十戶乙毎戶如甲十之八丙丁各七十戶丙毎戶如乙十之七丁毎戶如丙十之六

問各戶則例

法以戶細數列位

依省算以首行退位十而一與次行對減而重列之又半其減余然後列之與三行對

又列減余以對末行

如法乘減異並一千二百九十二爲法一千四百一十五石四斗無減爲實法除實得一石○九升又三百二十三之一百七十八爲丁毎戶則例【法實皆四約之】

十因丁則六除之得一石八斗二升又三百二十三之一百八十九爲丙每戶則例

十因丙則七除之得二石六斗○又三百二十三之二百七十爲乙每戶則例

十因乙則八除之得三石二斗六升又三百二十三之十四半爲甲每戶則例

計開

甲每戶三石二斗六升又三百二十三之十四半八十戶共二百六十石○八斗三升又三百二十三之一百九十一

乙每戶二石六斗○又三百二十三之二百七十爲甲每戶十之八

八十戶共二百○八石六斗六升又三百二十三之二百八十二

丙每戶一石八斗二升又三百二十三之一百八十九

爲乙每戶十之七

七十戶共一百二十七石八斗○

又三百二十三之三百一十

丁每戶一石○九升又三百二十三之一百七十八爲丙每戶十之六

七十戶共七十六石六斗八升又三百二十三之一百八十六

合計共六百七十四石【凡六百七十三石九斗七升又九百六十九分以三百二十三収之爲升得此數】

問有均分兩銀庚以其五之二與甲則甲之數多於庚一百六十八兩若以甲二十一之九與庚則庚之數多於甲一百八十兩原數幾何

法以所用益彼之分與此所存之餘分相減而列之【庚與甲五之二庚自存五之三】相減餘五之一【是爲以庚五之一較甲全分而甲多一百六十八兩也】

【甲與庚廿一之九甲自存廿一之十二】相減餘二十一之三【是爲以甲二十一之三較庚全分而庚多】【一百八十兩也】

庚𨿽自存五之三而甲股內有庚所與之二故以相減而余之一分與甲相較

甲𨿽自存二十一之一十二而庚股內有甲所與之九故以相減而余之三分與庚相較

甲一百○二分爲法除實一千○二十兩得十兩爲甲之一分二十一分共二百一十兩減負一百六十八兩餘四十二兩爲庚之一分五分亦共二百一十兩

計開

【庚甲】各原銀二百一十兩【庚五之二計八十四兩其五之三仍一百二十六兩甲二十一之九計九十兩其二十一之十二仍一百二十兩】

庚以八十四與甲【甲共有二百九十四庚仍餘一百二十六】相較甲多一百六十八

甲以九十與庚【庚共有三百

甲仍餘一百二十】相較庚多一百八十此設問之意也

以【庚之一分四十二甲全分二百一十】相較甲亦多一百六十八

以【甲之三分計三十庚全分二百一十】相較庚亦多一百八十

此列位之理也

論曰右例以此之分益彼而轉與此之餘分相較與帯分條所設不同帶分條此之分較彼全分其全分卽是原數今則一損一增以相較非原數也故曰不同

及其相減而列爲較數也則亦是此之分較彼原數矣是之謂尾同而首異

相減列位亦有變爲和數者如後所設

問有兩銀庚以其五之三與甲則甲之數多於庚二百五十二兩若以甲廿一之十三與庚則庚之數多於甲二百六十兩

法亦以所與彼之分與其餘分相減列之

庚【與甲五之三自存五之二】相減餘五之一【此爲所用之分多於存分是變和數也庚五之一偕甲全分共二百五十二兩也】

甲【與庚二十一之十三自存二十一之八】相減餘二十一之五【此亦用分多存分少是變和數也甲二十一之五偕庚全分共二百六十兩也】

甲所以多如許者不惟其全數之故其所得於庚之分又多於庚之餘分者一也故甲所多之數乃是甲全數偕庚之一分所共也

庚所以多如許者亦不惟其全數之故其所得甲之分又多於甲之存分者五也故庚所多數亦是庚全數偕甲之五分所共也

甲一百分爲法除實一千而得十兩爲一分以甲五分計五十兩減共二百六十兩餘二百一十兩爲庚原銀五除之得四十二兩爲一分以減共二百五十二兩亦得二百一十兩爲甲原銀

庚五之三計一百二十六兩以加甲銀共三百三十六兩內減去庚自存五之二計八十四兩仍多二百五十二兩卽是甲全數偕庚一分之數也

甲二十一之十三計一百三十兩以加庚銀共三百四十兩內減去甲自存二十一之八計八十兩仍多二百六十兩卽是庚全數偕甲五分之數也

論曰右例以此之分偕彼全分而爲和數亦與帶分和數同然以相減而得之亦是尾同首異帶分條和數較數據問而分今則設問只是較數相減列位乃有和較之分

依例推之亦有變爲一和一較者皆以所用之分與所存分相減而得之列位時巳變不待其重列減余也故又與尋常較變和者異

總論曰此二條者皆一損一益例也

問金九錠銀十一錠其重適等若交易其一則銀多十三兩其原重若干

法以相差十三兩半之得六兩五錢爲一錠之較解曰交易一錠而差是一多一少故半之爲一錠之較銀得較而增重故與金同名

銀二錠除實得銀每錠重二十九兩二錢半加正六兩五錢得金每錠三十五兩七錢半

計開

金每錠三十五兩七錢五分金九錠【得三百二十一兩七錢五分】銀每錠二十九兩二錢五分銀十一錠【亦得三百二十一兩七錢五分】金八錠二百八十六兩加銀一錠共三百一十五兩二錢半

銀十錠二百九十二兩半加金一錠共三百二十八兩二錢半

共多一十三兩若交易二錠而差二十六兩則以二錠倍作四錠除之亦得六兩五錢爲一錠之較餘可類推【或半相差二十六兩爲一十三兩命爲金二錠銀二錠之較尢爲平穏】

論曰此條舊列差分同文算指攺立借衰互徴之法皆不知宜入方程也

凡以兩家之數相交易而差若干皆半其所差而列之爲所交易之較何也一增一減而差若干則原所差者其半也

問甲有硃砂銀七錠壬有鑛銀九錠相較甲原多十五兩今以甲二錠易壬三錠則甲多二十七兩

法以原多十五兩今多二十七兩相減餘十二兩半之得六兩爲甲二錠壬三錠之較【甲得較而增重故與壬同名】

壬三錠除七十二兩得壬每錠二十四兩以九錠乘得二百一十六兩加正一十五兩共二百三十一兩甲七錠除之得每錠三十三兩

計開

甲以二錠與壬餘五錠一百六十五兩加易得壬三錠七十二兩共二百三十七兩

壬以三錠與甲餘六錠一百四十四兩加易得甲二錠六十六兩共二百一十兩

相較甲多二十七兩

此問意也

問甲銀七錠壬九錠相較壬原少十五兩今以一錠相交易壬多三兩

法以原少十五兩今多三兩並得十八兩而半之得九兩爲一錠之較【壬得之而變輕爲重故與甲同名】

壬二錠除四十八兩得每錠二十四兩加九兩得甲每錠三十三兩

計開

甲六錠一百九十八兩加壬一錠二十四兩共二百二十二兩壬八錠一百九十二兩加甲一錠三十三兩共二百二十五兩相較壬多三兩此交易一定之數餘同前問

論曰此三問皆同法第一問盈偕適足故卽用原數第二問兩盈故相減第三問盈偕不足故相並然皆半之爲較故三法一法也

又按於七錠中取一卽七之一同帶分之理故又作問明之

問有金不知總任意分爲二而較之則庚多八兩湏令辛以金還庚如庚存數三之二庚亦以金還辛如辛存數四之三則其數適均

法以庚自存三分今添二分共五以辛自存四分今添三分共七通爲兩家適足數之分

又以多八兩半之四兩命爲庚所添二分辛所添三分之較【辛失之而減重故與辛同名】

解曰合而觀之庚以五之二辛以七之三相交易則庚多八兩若還其原數庚仍爲五分辛仍爲七分則適足也

辛一分得二十兩七分共一百四十兩五除之得庚之一分二十八兩

計開

其相易【庚二分五十六兩辛三分六十兩】較之辛多四兩卽相易幾錠之理

總論曰此皆兩相交易也又與庚甲損一益一者不同凡損一益一者損庚之幾分與甲則甲有增數而轉以甲之旣增者與庚之餘數相較也損庚益甲以相較是明有增損

今兩相交易則損庚之分與辛亦損辛之分與庚然後以旣損且增之庚與亦增之辛相較也

兩相交易則末嘗明有增損但以相易之數不同而增損隠寓於其中以上四條皆同此論

問兩數不知總但云取甲之九加乙則乙與甲等若取乙之九加甲則甲倍於乙其原數各若干

畣曰甲六十三乙四十五

解曰云取甲之九加乙是損甲之九而益乙以九也取乙之九加甲是損乙之九而益甲以九也與刋誤條所舉甲乙二倉法不同彼是取甲倉幾何以益乙而共得幾何不言與甲倉較取乙倉幾何以益甲而共得幾何亦不言與乙倉較是所益者有增數而所取者

無損數如雲以此之全數偕彼之幾分而共得幾何乃和數也今所列者乃較數也益此損彼則相較幾何故不同也然又與帶分條較數不同彼是取彼幾分與此全數較今所列者是取彼幾數加此而轉與彼之餘數較當細辧之

又此是以數相增損而得其相較之分

前數條則是以分相損增而得其相較之數

二者大異不但與帶分條別也

法以所加之九數命甲乙所相當之數乘之爲較數列位

甲倍乙是甲二乙一合之則三以乘九得二十七爲較甲得此而當倍乙故與乙同名

甲乙等是各一也合之則二以乘九得十八爲較乙得此而與甲等故與甲同名

余乙一爲法

並四十五爲實

法一卽以四十五命爲乙數

異加十八得六十三爲甲數

試更列之

同減餘甲一爲法異並六十三爲實法一卽以六十三爲甲原數異加正二十七共九十乙二除之得四十五爲乙原數

論曰此難題設問也算法統宗收入均輸另有求法算海說詳推論借銀相當加半倍者不可通用因別立術然復未確不如用方程之爲無獘

又論曰甲與乙九而相等是甲多於乙者二九也乙與甲九而甲倍於乙是倍乙多於甲者三九也何也甲得乙九數而後當倍乙則倍乙中各除九數共二九而甲又添九數豈非三九乎

問甲乙銀不知數但云甲借乙六錢五分則比乙一有半乙借甲六錢五分則乙與甲等各原銀若干

法以甲一乙一有半並之共二半以乘六錢五分得一兩六錢二分半爲乙一有半多於甲之較

以甲乙相等各一並之共二以乘六錢五分得一兩三錢爲甲多於乙之較

乃列之

同減余半乙爲法異並二兩九錢二分半爲實法除實得五兩八錢五分爲乙銀異加正一兩三錢共七兩一錢五分爲甲銀

計開

甲原銀七兩一錢五分

乙原銀五兩八錢五分

相差一兩三錢若損甲之六錢五分以加乙則各得六兩五錢是相等也

若損乙六錢五分餘五兩二錢益甲六錢五分得七兩八錢是甲之數如乙一有半也

若以乙原銀加半得八兩七錢七分半以與甲原甲原銀相較則多一兩六錢二分半

論曰甲以六錢五分借與乙而相等是甲原多乙兩个六錢五分也乙以六錢五分借與甲而甲如乙一有半是一个半乙原多於甲兩个半六錢五分也何也甲取乙六錢五分而後能當乙有半則此一个半乙共減去一个半六錢五分甲又加一个六錢五分豈非共差兩个半六錢五分乎

又論曰此卽算海說詳所設之問以駁統宗者彼自立術以爲當矣不知其宜用方程也

試更設問以明之

今有二數不知總但云丙與丁二數則相等若丁與丙二數則丙如三丁問原數各若於

依前術列位【合丙丁各一共二以乘二得四爲丙多於丁之較合丙一丁三共四以乘二得八爲三丁多於一丙之較】

同減余丙二爲法異並二十爲實法除實得一十爲丙數同減負四餘六爲丁數

計開

丙原數十原多於丁者四

丁原數六三之則十八多於丙者八

若損丙之二以益丁則各得八故相等

若損丁之二以益丙則丙得十二丁得四故丙如三丁

論曰丙以二與丁而等是丙多於丁者兩个二也丁以二與丙而丙如三丁是三丁之數共多於丙者四个二也何也丙增一个二其三个丁各少一个二共四个二也

又論曰因算海說詳立術未確故復設此以相攷用方程能合彼問而彼所立術殊不能通之此問

問戊己銀不知數但戊以五十兩與己則己如戊之倍己以五十兩與戊如三己

依前術列位【並戊二己一共三以乘五十得一百五十爲二戊多於一己之較並戊一己三共四以乘五十得二百爲三己多於一戊之較】

同減余己五爲法異並五百五十兩爲實法除實得一百一十兩爲己銀異加正一百五十兩共二百六十兩戊二除之得一百三十兩爲戊銀計開

戊原銀一百三十兩倍之二百六十兩多於己一百五十兩

己原銀一百一十兩三之得三百三十兩多於戊二百兩

此列位之理

戊加五十兩得一百八十兩己損五十兩得六十兩則戊如三己己加五十兩得一百六十兩戊損五十兩得八十兩則己如戊之倍

此則問意

問香鑪二座不知重有一蓋重百兩以加甲鑪則甲多於乙兩倍以加乙鑪則乙多於甲一倍其鑪各重若干

解曰多乙兩倍是三倍也甲得蓋如三乙也多甲一倍是兩倍也乙得蓋如兩甲也

法以蓋重爲較而列之甲得蓋如三乙是三乙之重於甲者如蓋也故與乙同名乙得蓋如倍甲是兩甲之重於乙者如蓋也故與甲同名

鑪同減余乙鑪五爲法較異並三百兩爲實法除實得六十兩爲乙鑪重

異加一百兩共一百六十兩甲二除之得八十兩爲甲鑪重

計開

甲鑪八十兩加蓋共一百八十兩則如乙鑪重者三乙鑪六十兩加蓋共一百六十兩則如甲鑪重者倍論曰此與前所設戊己銀數以五十兩損戊益己而己倍於戊以五十兩損己益戊而戊如二己異何也以五十兩損彼益此𨿽亦相差一百兩然非眞有一百兩之益乃因彼之所損而合成其數耳此之加蓋則實增一百兩矣而於彼又無所損因鑪蓋乃兩家公物非若戊己之銀必取諸彼以與此也故其法不同若攺問各鑄鑪而均鑄蓋則必於鑪重各加半蓋乃合原金得數與戊己銀同矣

問調兵徵倭內有南北西三處兵馬南兵已知四萬其北兵爲南兵與西兵二之一西兵爲南兵與北兵三之一各若干

法以南兵爲西北之較而列之

西兵得南兵而數倍於北是倍北數而多於西兵者數如南兵也

北兵得南兵而數如三西兵是三其西兵而多於北者亦如南兵也

余北兵五爲法倂十六萬爲實法除實得三萬二千爲北兵數異加正四萬共七萬二千西兵三除之得二萬四千爲西兵數

計開

南兵四萬

西兵二萬四千偕南兵則六萬四千其二之一則如北兵也北兵三萬二千偕南兵則七萬二千其二之一則如西兵也論曰此與香鑪借蓋爲較同其所用較乃是南兵而非取於西北兵故得之有增而不得無損與借物於彼而轉與其所借之餘物相較者不同

問二人擕銀不知數但減乙六兩與甲則甲倍於乙減甲三兩與乙則相等其原數若干

解曰此所損益又是不同之數然其理則一故亦依前術乘其較數而列之【合甲一乙二共三以乘六兩得十八兩爲倍乙多於一甲之較合甲乙各一共二以乘三兩得六兩爲甲多於乙之較】

列位

同減余乙一爲法異並二十四兩爲實法一卽以實爲乙數異加六兩爲甲數

計開

乙二十四兩倍之得四十八兩多於甲一十八兩甲三十兩原多於乙六兩

若損乙六兩得十八兩加甲六兩得三十六兩是甲如乙之倍

若損甲三兩加乙三兩各得二十七兩則相等

問二商各攜母銀但云取乙十二兩與甲則乙有甲六之一取甲十五兩與乙則甲有乙十之一

依前術列位【並六與一共七以乘十二兩得八十四兩爲六乙多於一甲之較並十與一共十一以乘十五兩得一百六十五兩爲十甲多於一乙之較】

同減餘甲五十九爲法異並一千○七十四兩爲實法除實得一十八兩又五十九之一十二爲甲數異加正八十四兩共一百○二兩【又五十九之一十二】乙六除之得一十七兩【又五十九之二】爲乙數

計開

甲銀一十八兩【又五十九之一十二】十之則一百八十二兩【又五十九之二】多於乙者一百六十五兩

乙銀一十七兩【又五十九之二】六之則一百○二兩【又五十九之一十二】多於甲者八十四兩

若損乙一十二兩與甲則甲有三十兩【又五十九之一十二】乙僅有五兩【又五十九之二】而乙於甲爲六之一

若損甲一十五兩與乙則乙有三十二兩【又五十九之二】甲僅三兩【又五十九之一十二】而甲於乙爲十之一【以五十九通二兩得一百一十八加子二從之共一百二十是三十兩又五十九之一百二十豈非十倍於甲乎】

論曰乙得甲六之一是六乙當一甲也然必損乙之十二兩與甲而後成此數是於一甲中添十二兩而於六乙中各減十二兩也一添一減共七个十二兩是爲八十四兩也

甲得乙十之一是十甲當一乙也然必損甲之十五兩與乙而後成此數是於一乙中添十五兩而其十甲中皆各減十五兩也一添一減共十一个十五兩是爲一百六十五兩也

損乙之十二兩與甲而乙爲甲六之一若其原數則以六乙當一甲而乙多八十四兩矣

損甲之十五兩與乙而甲爲乙十之一若其原數則以十甲當一乙而甲多一百六十五兩矣

問有兩數不知總但損甲六數與己則甲如己四之三而多二數若以己之二十損與甲則己如甲四之三而少五數其原數各幾何

法以四甲三己共七乘六得四十二又以四甲乘多二數得八而益之共五十爲四甲多於三己之數【損甲六益己故較與甲同名其二數甲所多也故以之益數】

以四己三甲共七乘二十得一百四十又以四己乘少五數得二十以相減餘一百二十爲四己多於三甲之較【損己二十益甲故較與己同名其五數巳所少也故以之減較】

己同減餘七爲法異並六百三十爲實法除實得九十爲己原數四因己數同減一百二十餘二百四十甲三除之得八十爲甲原數

計開

甲八十

己九十

以列位之理言之

甲四共三百二十己三共二百七十是甲多五十甲三共二百四十己四共三百六十是己多一百二十

以問之意言之

甲損六數餘七十四己加六數共九十六以九十六四分之而取其三得七十二是爲甲如己四之三而多二數

己損二十餘七十甲加二十共一百以一百四分之而取其三得七十五是爲己如甲四之三而少五數

論曰以甲當己四之三是四甲當三己也然必以六數減甲增己而成則是四甲中各減六而三己中各增六共四十二也以甲當己四之三而多二數則以四甲當三己而共多八數也合而觀之此四十二者四甲多於三己之數也此八數者亦四甲多於三己之數也故皆與甲同名而列其較爲五十也

以己當甲四之三是四己可當三甲也然必以二十減己增甲而成則是四己中各減二十而三甲中各增二十共一百四十也以己當甲四之三而少五數則以四己當三甲而共少二十也合而觀之此一百四十者四己多於三甲之數也與己同名也而其二十者則四己少於三甲之數也與己異名也故以相減而餘者列爲己同名之較也

損甲六數與己而甲如己四之三仍多二數若其原數則以四甲當三己而共多五十矣

損己二十與甲而己如甲四之三卻少五數若其原數則以四己當三甲而共多一百二十矣

問有三數損甲一百益乙則甲如乙六之二若損乙五十益丙則乙如丙十五之九若損丙三十益甲則甲如丙二之一而少五數各若干

法以甲六乙二共八以乘一百共八百爲六甲當二乙之較【損甲益乙故與甲同名】

以乙十五丙九共二十四乘五十得一千二百爲十五乙當九丙之較【損乙益丙故與乙同名】

以丙一甲二共三乘三十得九十又以甲二乘少五數共十而加之共一百爲一丙當二甲之較【損丙益甲故與丙同名其甲所少五數卽丙所多也故亦與丙同名】

如法逓減余丙五十四爲法異並三萬七千八百爲實法除實得七百爲丙數丙數同減一百餘六百甲二除之得三百爲甲數六因甲數一千八百同減八百餘一千乙二除之得五百爲乙數十五乘乙數得七千五百同減一千二百餘六千三百丙九除之仍得七百爲丙數【反覆相求列位之理著矣】

計開

甲三百

乙五百

丙七百

甲損一百餘二百乙增一百得六百是甲爲乙六之二乙損五十餘四百五十丙增五十得七百五十是乙爲丙十五之九

丙損三十餘六百七十其二之一則三百三十五甲增十得三百三十是甲爲丙二之一而少五數

問二人共數一百原所得之數不均今以甲三之一與乙五之一相易則適均其原所得若干

法以三分通甲數損一與乙而存其二分又以五分通乙數損一與甲而存其四分

乃以和數列之

乙七爲法餘五十爲實法除實得七又七之一爲乙之一分以乙分母五乘之得三十五又七之五【爲乙數】以減一百得六十四又七之二爲甲數計開

甲六十四【又七之二】其三之一爲二十一【又七之三】其三之二爲四十二【又七之六】

乙三十五【又七之五】其五之四爲二十八【又七之四】其五之一爲七【又七之一】以甲三之一加乙五之四五十也以乙五之一加甲三之二亦五十也

論曰此以分相增損而爲和數亦與刋誤條甲乙二倉異彼是以其全數偕彼防分此則以所存之餘數偕彼幾分也旣云相易則實有增損非如甲乙倉虛借增率而無損也

問二人物數不均若於甲取三之一於乙取四之一以和合而平分之以湊原存數則各五十而適均其原數各若干

法以三分通甲數而倍之爲六分損其一與乙餘五分以四分通乙數而倍之爲八分損其一與甲餘七分以和數列位

解曰以四之一與三之一和合而平分之是各取其數之半也於三之一取其半是六之一以與乙而甲余其五也於四之一取其半是八之一以與甲而乙余其七也

偏乘對減以得法實法除實得五又十七分之十五爲乙八之一以乙分母八乘之得四十七又十七分之一爲乙原數以兩五十共一百減乙原數餘五十二又十七分之一十六爲甲原數

計開

甲原數五十二【又十七分之十六】三除之得十七【又十七分之十一】爲甲三之一以三之一轉減甲餘三十五【又十七分之五】爲甲所存三之二

乙原數四十七【又十七分之一】四除之得十一【又十七分之十三】爲乙四之一以四之一轉減乙餘三十五【又十七分之五】爲乙所存四之三

以甲三之一乙四之一和合之共二十九【又十七分之七】半之得十四【又十七分之十二】爲和合平分之數以加甲乙存數各得五十

論曰甲去三之一乙去四之一所存之數已均矣故以平分之數加之而適均

又法

以甲分母三通甲爲三分以乙分母四通乙爲四分又總計各得五十六共一百爲和數

以甲取三之一餘三之二乙取四之一餘四之三命爲適足【甲取三之一乙取四之一以和合平分而等則其所存者亦等也故命之適足】乃以和較雜列位

如法乘甲同減盡乙異並一十七分爲法正二百無減就爲實法除實得一十一又十七之十三爲乙之一分以分母四乘之得四十七又十七分之一爲乙原數以乙原數減共數一百餘五十二又十七分之十六

按此所得與前無異而較捷故並存之

問甲乙丙三人共博甲贏乙金二之一乙贏丙金三之一丙又贏甲金四之一事畢各剰金七百其原攜金若干

法以各分母通其原數又各減其贏去之一而列之【以七百爲和數】

和數列位

如法減並丙七分爲法二千一百爲實法除實得三百爲丙之一分以丙分母三乘之得九百爲丙原金以丙之一分減乙剰七百餘四百爲乙所餘二之一二因之得八百爲乙原金以乙二之一減甲剰金七百餘三百爲甲自剰四之三三除之得一百爲甲三之一四乘之得四百爲甲原金

計開

甲原金四百加贏乙四百【二之一也】共八百除丙又贏去甲一百【四之一也】仍餘七百

乙原金八百加贏丙三百【三之一也】共一千一百甲贏去四百【乙二之一也】仍餘七百

丙原金九百贏甲一百【四之一也】共一千乙贏去三百【丙三之一也】亦仍餘七百

論曰此與刋誤條騾馬逓借一匹同但馬一騾二驢三卽是原物偕所借之一而爲和數今乙一丙二甲三卻是各所存之餘分偕所贏之一分而爲和數也得數大異者馬騾卽是全數今則用分故丙之全數轉多於乙若以一分計則乙之分自多於丙如馬力之於騾矣

又論曰此三條皆是兩相交易而又是和數與前數條金銀交易幾錠不同

難題歌曰一條竿子一條索索比竿子長一托雙折索子去量竿卻比竿子短一托

解曰一托者五尺也

法以零整雜列位因雙折是二之一故以二通索

法一卽以實一丈命爲繩之一分分母二因之得繩長二丈減負五尺餘得竿長一丈五尺

假如有繩長不知數但云比竿長六尺若三折其繩則短於竿八尺

法二除實三丈得竿長一丈五尺加正六尺得繩長二丈一尺

論曰原法別有求法然不如方程穏捷故作此問以明之若用難題法不能通矣故方程能禦雜法而雜法不能禦方程此條統宗原入均輸今攺正

問井不知深先將繩折作三條入井汲永繩長四尺復將繩折作四條入井亦長一尺其井深繩長各若干

法以兩母【三四】相乘得十二分爲繩母數以母【三四】互乘其子【之一之一】得【四三】是爲以繩十二分之四汲水而長四尺以繩十二分之三汲水而長一尺也

餘一分爲法卽以實三尺命爲繩十二分之一以十二分乘一分得三十六尺爲繩長以繩之三分計九尺同減負一尺得八尺爲井深

計開

井深八尺

繩長三十六尺

三折之得一十二尺比井多四尺

四折之得九尺

比井多一尺

論曰此條原屬盈朒今以方程禦之尢簡易故曰方程能禦雜法也

試更之則先得井深

法一省除卽以八尺命爲井深加正四尺共十二尺繩之四分除之得三尺爲一分一十二分母乘之得繩長三十六尺

論曰此餘八尺者卽物實也前以餘三尺爲繩長實者卽人實卽此可悟盈朒章作法之原要之是二色方程法耳【人實物實不同而除法則同故皆可以互求】

今有絹一疋欲作帳幅先折成六幅比舊帳長六寸攺折作七幅卻又短四寸其絹並舊帳幅各長若干【折作六幅以較長卽六之一七幅卽七之一】

法如前以【六七】幅相乘得四十二分爲總母以【六七】互乘其【之一之一】得【之七分之六分】爲所用之分而列之【以絹四十二之七則長於帳六寸以絹四十二之六則短於帳四寸】爲較數

法一實一尺卽爲絹之一分以分母四十二乘之得絹長四丈二尺以絹之七分計七尺減負六寸餘六尺四寸爲舊帳之長

計開

舊帳幅六尺四寸

絹長四丈二尺

均作六幅得七尺比帳長六寸

均作七幅得六尺比帳短四寸

論曰此與井不知深皆是以一物之細分與一整物較皆零整雜用之法也

又以上三條盈朒章舊有求法然皆因所較之井深與舊帳幅皆爲一數而不變故可用盈朒之法若亦有分數不同則非盈朒所能禦此方程之用能包盈朒諸法而諸法不能禦方程

今有臺不知髙從上以繩縋而度之及臺三之二而餘六尺雙折其繩度之及臺之半而不足三尺問臺之髙及繩之長若何

法以臺【三二】之【二一】用母相乘爲母之法通臺爲六分又用母互乘子爲子之法變臺三之二爲六之四臺之半爲六之三又以雙折通繩爲二皆以化整爲零而列之

余繩二分爲法並三十尺爲實因二爲分母與法同省除與乘徑以實三十尺爲繩長減負六尺餘二十四尺以臺之四分除之母六乘之得三十六尺爲臺髙

計開

臺髙三十六尺

繩長三十尺

臺三之二髙二十四尺以繩度之餘六尺

臺之半髙一十八尺

以半繩一十五尺比之短三尺

今有井不知深以乙繩汲之餘繩二尺以庚繩汲之亦余繩四尺雙折庚繩三折乙繩以相續而汲之適足問井深及二繩各長若何

法以乙繩通爲三庚繩通爲二

以三色列之井整數乙庚用分

以隔行之同名仍爲較數列之餘較皆與庚同名

余庚一分爲法卽以實一丈命爲庚二之一倍之得庚繩二丈減負二尺得乙繩一丈八尺【用減余之右行蓋乙正三卽全數也】

又減負二尺得井深一丈六尺【用原列之右行亦以乙負三卽全數故】計開

井深一丈六尺

乙繩一丈八尺比井多二尺

庚繩二丈

比井多四尺

三折乙繩六尺加雙折庚繩一丈共一丈六尺卽同井深

論曰此二條與前井深絹帳同理然卽非盈朒所能禦又按田之橫直亦可以繩折比量水面亦然

今有直田欲截一段之積只云截長六步不足積七步截長八步又多積九步問所截之積及原濶

法以較數列之【其原濶卽截長每一步之積】

上

中

下

長二步除積十六步得原濶八步以截長六步乘濶得四十八步加不足七步得截積五十五步

論曰此盈朒中方田也然無闗於方田之實用故入盈朒然不知宜入方程也

試更作問

今有方田欲截橫頭之積攺爲直田但云截濶五步則不足十二步截濶九步則如所截之積一有半問所截直田積並原田之方

如法列位

濶一步半爲法積十八步爲實法除實得原方一十二步以濶五步乘方得六十步加不足十二步得截直田七十二步

計開

原方田方十二步積一百四十四步

截直田七十二步宜截濶六步

若此條則盈朒不能禦

今有米換布七疋多四斗換九疋適足問原米若干及布價

法列位

上

中

下

布二疋爲法四斗爲實法除實得布價每疋二斗以九疋適足乘布價得原米一石八斗

論曰此盈朒中粟布法也

試更設問

今有谷換絹十疋餘三石以谷之半換絹六疋不足五斗問原谷若干及絹價

法列位

法一免除得絹每疋價二石以十疋乘價加餘三石得原糓二十三石

若此條則非盈朒所能禦

論曰直田截積及米換布盈朒本法也愚所設方田截積及糓換絹非盈朒本法也乃帶分盈朒之變例也【如舊法芝蔴糶銀是其例也】𨿽盈胸亦有求法頗多轉折非其質矣不如用方程之省約

今有芝蔴不知總但云取麻八分之三糶銀十兩不足二石取麻三分之一糶銀八兩適足問原麻總數及每銀一兩之麻

法先以麻【八之三三之一】用母相乘得二十四爲母母互乘子得【之九之八】爲所用之分而列之依省算左加九之一而徑減

法一兩省除卽以麻二石命爲銀每兩之麻以銀八兩麻八分適足省乘除徑以二石爲麻之一分以二十四分乘得原麻四十八石

計開

原麻四十八石

銀毎兩麻二石

其八之三計一十八石銀十兩該二十石故不足二石

其三之一計一十六石銀八兩恰該一十六石故適足

若問麻每石之銀則以二石爲法轉除一兩得每石價五錢

按此條宜入方程舊列帶分盈胸之末

問者若云有銀買麻以麻八之三與之則餘二石以麻三之一與之適足問原麻及銀所買

依法求得二石爲麻之一分以總母廿四分乘之得原麻四十八石以九分乘二石減負二石得銀所買麻十六石

論曰此所設問則盈朒帶分本法也然不能知每價以方程法求之亦同觀此益見前條之宜入方程也

今有黃連木香不知數但云取連三之一換木香七之二則連多二斤取連四之三換木香五之四則連少一斤若於五之四內減去木香三斤則連多一斤

法先以通分齊其分

乃列位

如法乘減餘木香二十二分爲法異並黃連二十二斤爲實法除實得每木香一分【卽三十五分之一】換黃連一斤以木香十分換黃連十斤異加正二斤共十二斤以黃連正四分除之得黃連每三斤爲一分以分母十二乘之得總黃連三十六斤

另並黃連多一斤少一斤共二斤爲法除減木香三斤得每黃連一斤換木香一斤半【原少連一斤減木香三斤而轉多連一斤故知其數】

此連所換之木香一斤半卽其三十五分之一分也以三十五分乘之得木香五十二斤半

計開

黃連三十六斤

木香五十二斤半

每黃連一斤換木香一斤半

三分三十六斤而取其一得一十二斤爲黃連三之一七分五十二斤半而取其二得十五斤爲木香七之二該換連十斤今連有十二斤是連多二斤也

四分三十六斤而取其三得二十七斤爲黃連四之三五分五十二斤半而取其四得四十二斤爲木香五之四該換連二十八斤今連只二十七斤是連少一斤也

若於木香五之四減三斤餘三十九斤該換連二十六斤今連有二十七斤是連多一斤也

論曰凡較數方程有若干物共幾色又有其所較之價銀若錢之類今所用較數卽用其物之斤兩而無銀若錢微有不同乃古者貿遷有無交易之術也專用銀若錢以權物價後世事耳

問綾每尺多羅價三十六文今買綾六尺羅八尺其共價綾比羅少三十六文

畣曰綾每尺一百六十二文羅每尺一百二十六文

羅二尺除二百五十六尺得羅價每尺一百二十六文加多三十六文得綾價每尺一百六十二文

問銀二千九百二十八兩買綾一百五十疋羅三百疋絹四百五十疋只云綾每疋比羅多四錢七分羅每疋多絹一兩三錢五分畣曰綾每疋四兩三錢二分羅每疋三兩八錢五分絹每疋二兩半

絹九百疋爲法除實二千二百五十兩得絹價二兩五錢加多一兩三錢半得羅價三兩八錢半又加多四錢七分得綾價四兩三錢二分

今有兄弟三人不知年小弟謂長兄曰我年比汝四之三次兄比汝六之五比我多八歳

法以帶分別之皆變零從整

季弟二除一百四十四歳得年七十二歳加八歳得仲兄年八十六因仲年五除之得伯年九十六歳

計開

伯九十六歳仲八十歳【爲伯年六之五】季七十二歳【爲伯年四之三】今有四人分錢但云乙得甲六之五丙得甲四之三丁得甲二十四之十七其丁與丙差四文

甲正五

乙負六

空

空

適足【此行不用乙無對故也】

丁四除二百七十二得丁錢六十八文

加四文得丙錢七十二文

四乘丙錢三除之得甲錢九十六文

五乘甲錢六除之得乙錢八十文

計開

甲九十六文

乙八十文

丙七十二文

丁六十八文

甲六之一得一十六以五因得八十文爲六之五乙數也甲四之一得二十四以三因得七十二爲四之三丙數也甲二十四之一得四以一十七因得六十八爲二十四之一十七丁數也

論曰此𨿽四色實三色也故徑以三色取之

今有七人逓差分錢但知首二人共七十七文次二人共六十五文不知各數亦不知餘人數

法以逓差故知倍乙當甲丙倍丙當乙丁而列之

重列減余與三行減余變較

重列減余與四行

丁八爲法除實二百四十八文得三十一文爲丁數倍丁數與六十五文相減得逓差三文以差逓

加得甲乙丙數以差逓減得戊己庚數皆加減丁數得之

計開甲四十文乙三十七文丙三十四文丁三十一文戊二十八文己二十五文庚二十二文

今有銀二百四十兩以四人逓差分之只云甲多丁一十八兩

如前法以倍乙當甲丙倍丙當乙丁又依省算移甲於丁位

和較列位

重列兩減余

又重列減余與末行

甲四除二百七十六兩得甲數六十九兩甲數內減十八兩得丁數五十一兩以甲數減二百四十兩餘一百七十一兩丙三除之得丙數五十七兩並丙數甲數一百廿六兩半之得乙數六十三兩計開

甲六十九兩乙六十三兩丙五十七兩丁五十一兩逓差六兩

今有米二百四十石五人逓差分之其甲乙二人與戊丁丙三人共數等

如前法列位依省算倒甲位自下而上

重列減余與三行

又重列減余與四行

又重列減余與末行

甲十五除九百六十得甲數六十四石倍甲數減一百廿石餘得逓差八石以差逓減各數得乙丙丁戊數

計開

細分之逓差八石

論曰凡差分章竹筒七節盛米之類皆可以此法求之玆不煩列

歷算全書卷四十五﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

欽定四庫全書

歷算全書卷四十六

宣城梅文鼎撰

句股闡微卷一

句股正義

首題

句股者橫曰句縱曰股【亦可云勾縱股橫】斜曰三綫相聨而成句股形也

如圖甲乙丙形甲乙爲股乙丙爲句甲丙爲亦可云【甲乙爲句乙丙爲股】也凡三角形或三角俱鋭或兩鋭一鈍或兩鋭一

正【鋭鈍正說具三角形算法中】句股形者兩鋭一正形也其句股兩綫縱橫相遇而成者爲正角如乙防句兩綫及股兩綫相遇而成者爲鋭角如甲丙兩防此三綫者或三綫俱不等其最大者必或兩綫等其等者必句股而無三綫等何者以句股形一角正故也

一題

句股求

法曰句股各自乘並之開方得

如圖甲乙句自乘得乙丁方乙丙股自乘得乙戊方兩方相並卽甲巳方開之得甲丙

論曰試移庚實形補辛虛形移丑實形補卯虛形移壬實形補子虛形移卯午實形補壬辰虛形所移者恰盡所補者恰足得乙丁與乙戊兩方並恰與甲巳方等又論曰更以句與股相等之形觀之夫句與股旣等則句股各自乘固方也卽句股互相乘亦方也【凡句股不等則句股互相乘必是矩形】如丁戊大方平分方邊於方形中縱橫作綫中分四

小方形必等又句與股旣等則上方邊爲句股各自乘兩方之對角綫亦爲句股互相乘兩方之對角綫如於四小方形中作四對角綫相聨而成一中方形也此中方形者割小方形四之半卽涵小方形二之全就此圖觀之尢爲明顯

又法曰句與股相乘倍之另以句股差自乘並入倍數開方得

論曰甲乙股乙丙句相乘得乙丁矩形中分爲庚戊兩形夫庚形卽辛形也倍之者再加癸卯兩形也乙丙爲句丙巳

爲股乙巳爲句股差自乘得乙子方並入倍數共成甲壬方爲甲丙上方也

又法曰句自乘倍股依長濶相差法求之得股差加股爲

論曰甲乙丙句股形甲丙也丁已亦也丁戊上方也乙丙股也乙壬亦股也乙子股上方也余乙戊子磬折形卽句自乘之數也而已壬矩與乙丑矩等卽丙戊矩亦

句自乘之數也此丙戊矩形中乙丙爲股加乙壬爲倍股曰長濶相差者丙午爲長午戊爲濶與壬午等卽壬丙倍股爲長濶之差也依法求之得壬午爲股差

二題

句求股

法曰自乘內減句自乘余開方得股

論曰一題句股求苐一法句股各自乘並之卽自乘數則自乘數中有句股各自乘之數也今於自乘數中減去句自乘所存者卽股自乘數矣就一題之圖觀之自見

又法曰句相並得數相減得數兩數相乘得數開方得股

如圖甲乙丙句股形乙丙句甲乙股甲丙與乙丙相並卽乙丁綫相減卽乙巳綫【乙巳與乙子等】兩綫【乙丁乙子】相乘得子丁矩卽

甲乙股上方

論曰己午方者已丙綫上方卽甲丙上方也內減子午形爲乙丙句上方所存卯巳未磬折形卽甲乙股上方矣而巳未矩又與丁卯矩等則丁子矩形卽卯巳未磬折形矣亦卽甲乙股上方矣

又法曰句自乘倍依長濶相和法求之得股差用減得股

論曰甲乙丙句股形甲丙也丁己亦也丁戊上方也乙丙股也乙壬亦股也乙子股上方也余乙戊子磬折形

卽甲乙句自乘之數也而己壬矩與乙丑矩等卽丙戊矩亦甲乙句自乘之數也此丙戊矩形中乙午爲乙丙並午戊爲倍曰長濶相和者丙午爲長午戊爲濶卽丙午午戊並爲長濶相和也依法求之得壬午爲股差

三題

股求句

法同二題句求股

附長濶相和法

如圖丁乙矩形積九百七十二尺丁甲爲長乙甲爲濶兩邊之和共六十三尺求甲丁甲乙二邊各若干法以和數

自乘得三千九百六十九尺次以積四倍之得三千八百八十八尺與和自乘相減存八十一尺開方得九尺【卽丁甲乙甲二邊之較數】以與和【六十三尺】相並折半得三十六尺爲甲丁長邊又與和相減折半得二十七尺爲甲乙矩邊長濶相差法【圖同上】

丁乙矩形積九百七十二尺甲乙爲濶戊乙爲長丙戊九尺【乙丙卽甲乙】爲長濶相差數甲乙戊乙二邊各若干法以較數【九尺】自乘得八十一尺次以積四倍之得三千八百八十八尺與較自乘相並得三千九百六十九尺開方得六十三尺【卽戊乙甲乙二邊之和數】以與較九尺相並折半得三十六尺爲戊乙長邊又與較【九尺】相減折半得二十七尺爲甲乙短邊

解曰甲午矩形作乙丙對角綫成甲乙丙句股形甲丙長句也甲乙濶股也丙丑長濶和也【甲丑卽乙甲】自乘得丙

子大方四倍矩積也並大方內戊丁

庚辛四矩形之積【大方內所容四矩俱與元形等如丙

壬矩卽甲午矩其八句股形亦俱等元形】相減存己壬小

方開方得巳未邊卽甲乙甲丙二邊之較數也【卯亥卽甲乙股卯壬卽甲丙句則壬亥爲兩邊較數卽長濶相差也】旣得較數與所有和數相加減得甲乙甲丙二邊矣

若長濶相差法是先有巳未較數故以上法反用之求得丙丑和得丙丑亦得甲乙與甲丙矣

四題

與句股較求句股

法曰自乘倍之較自乘用減倍數余開方得句股和於是和加較半之得長股和減較半之得短句

論曰甲乙丙句股形甲乙句也乙丁句上方也乙丙股也丙戊股上方也兩方並共爲上方辛壬亦句上方

庚已亦股上方兩方並亦共爲上

方此卽自乘倍之之數也而兩句

方兩股方並爲丙己大方則中間重

疊庚戊方矣此何方乎曰戊子卽句股較也庚戊方卽較上方也減之而重疊者去矣所存者爲句股和上方矣故開之得丙丑爲句股和也

又法曰自乘內減較自乘余半之以較爲長濶相差法求之得短句加較得長股

論曰甲乙丙句股形甲丙也甲丁上方也巳子較也己丑較上方也兩方相減余壬辛午未四形半之餘午未二

形而午形又卽戊形則是余未戊二形也此未戊二形者句股矩內形也故以巳子較用長濶相差法求之得子丙短句句加較得巳丙長股

五題

股與句較求句

法曰股自乘內減較自乘余半之以較爲法除之得句句加較得

論曰甲乙丙句股形甲丙也甲丁上方也甲巳較也甲戊較上方也庚甲辛磬折形股自乘數也內減甲戊較上

方所餘丙戊戊壬兩形卽爲句與句較矩內形者二矣取其一如丙戊形以戊己較除之得己丙句【或不用折半倍較爲法除之亦同】

又法曰股自乘以較爲法除之得句和於是加較折半得減較折半得句

論曰甲乙丙句股形甲丙也甲丁上方也丙己亦句也丁戊句上方也所餘庚甲辛折形卽股自乘數也而壬辛形與戊丙形等卽壬己矩形亦股自乘數也以甲巳較除之得甲壬爲句和也

又法曰股自乘較自乘相並倍較爲法除之得減較得句

論曰甲乙丙句股形甲丙也甲丁上方也丁己爲句上方卽戊甲辛磬折形爲股上方矣又己丙矩與庚壬矩等

卽甲辛子磬折形亦股上方也加甲子較上方共得辛丑矩形其庚辛邊卽是倍較

六題

句與股較求股

法同五題

七題

與句股和求句股

法曰自乘倍之內減句股和自乘余開方得句股較於是較加和半之得長股較減和半之得短句

論曰甲乙丙句股形丙丁句股和也丁子和上方也丁午未子兩句上方丙丑壬巳兩股上方此卽自乘倍之之數

也以較丁子和上方則其中重疊一壬丑方矣而此方之邊卽是句股較

又法曰句股和自乘內減自乘余半之以句股和用長濶相和法求之得句股

論曰丙丁爲句股和丁巳爲和上方午乙壬磬折形卽上方兩方相減余午丑壬磬折形分爲午醜及丑壬兩形形

之兩邊卽句股

八題

股與句和求句

法曰句和自乘內減股自乘余半之以句和除之得句用減句和得【或不用折半倍句和除之亦同】

論曰甲乙丙句股形甲丁爲句和甲巳爲和上方又甲午爲上方甲子爲句上方卽未午壬磬折形爲股自乘而子丙矩與午辛矩等卽戊辛矩形亦股自乘也於和方中減之所存者爲未丁及戊己兩矩形矣形之一邊如甲丁卽句和其一邊如甲未卽句

又法曰股自乘得數以句和除之得句較於是用加句和半之得用減句和半之得句

論曰甲乙丙句股形甲丁句和也甲戊上方也戊己句上方也卽午甲未磬折形爲股自乘矣而卯巳矩與午丁

矩等卽甲子矩形亦股自乘矣形之甲丁邊卽句和丁子邊卽句較

又法曰句和自乘股自乘相並倍和爲法除之得減和得句

論曰甲丁爲句和甲戊爲和自乘

戊醜爲句今試依庚戊矩作丁卯矩

卽卯甲丑磬折形亦和自乘矣又甲

巳爲上方未壬爲句上方卽未己壬磬折形爲股自乘矣而壬子矩與子丑矩等卽未丑矩亦股自乘矣然此猶在和自乘數中也今另加一股自乘如丑卯矩並

前卯甲丑磬折形共成一庚癸矩形

卽爲兩自乘相並之數形之甲癸邊

卽句和之倍形之甲庚邊卽是

也

九題

句與股和求股

法同八題

十題

句較股較求句股

法曰先以兩較相減得卽爲句股較次以兩較各自乘相並內減句股較自乘余開方得和較【和句股和也】於是加股較得句加句較得股以句較加句或以股較加股得

論曰甲乙丙句股形甲丙也甲巳卽股也巳丙股較也甲壬卽句也壬丙句較也壬己句股較也今試引甲壬句至丁令甲丁爲句股和卽丙丁爲和較也次作甲戊爲和上方午未爲句較上方午子爲股較上方【卽庚辰方】兩較上方相並共爲午未辰磬折形內減

未子句股較上方余辰午癸磬折形

卽戊午和較上方何則試觀丑午

已磬折形句上方也子戊形亦句上

方也今於丑午已磬折形中減丑申及辛巳兩矩形卽是於子戊形中減卯子亥磬折形也然則所餘之辰午癸磬折形非卽戊午方乎

又法曰兩較相乘倍之開方亦得

和較以下同前法

論曰甲乙丙句股形試引甲丙至丁

得甲丁爲句股和甲戊爲和上方【甲未股未丁句】丁子己子句也丁辛己壬也子辛子壬句較也未子亥子股也未申亥卯也子申子卯股較也然則卯辛與申壬兩矩形卽是兩較相乘倍之之數也此兩矩形者卽戊午和較上方【丙丁爲和較】何則未申亥磬折形句實也子戊方形亦句實也今試於未午亥磬折形減辛丙庚亥兩矩形【辛未及亥壬皆是和較】及子午方卽是於戊子方中減癸子丑磬折形也然則卯辛與申壬兩矩形非戊午方乎

十一題

句股較句較求句股【句短股長看此題】

法曰先以兩較相減得卽爲股較次以兩較各自乘相減余爲實倍股較爲法用長濶相差法求之得句句加句股較得股句加句較得

論曰甲乙丙句股形丙乙股丙戊句

丙巳戊乙句股較戊己句較乙

巳股較乙丁亦爲句丙丁爲句股

和丙庚爲和上方辛壬爲句股較上方辛子爲句較上方兩較上方相減余丑子午磬折形夫乙子卯磬折形句實也壬庚方亦句實也今於壬庚方中作未庚未申兩矩形與己丑寅卯兩矩形等卽所餘壬申形與丑

子午磬折形等矣於是依壬申形作

壬亥形此形壬酉爲長壬癸爲濶與

壬辰等卽辰未未酉爲股較之倍

爲長濶之差

按此法句股較句較相減得股較卽三較皆備矣十題第一法句較股較相減得句股較卽三較亦皆備矣旣皆備三較則法可互用特以就題立法則法固各有攸屬耳

十二題

句股較股較求句股【股短句長看此題】

法同十一題

十三題

句和股和求句股

法曰兩和各自乘相並兩和相減卽爲句股較自乘用減相並數余開方爲和和【和也句股和也和和與句股和相並也】於是內減句和得股內減股和得句內減句股得

論曰甲乙丙形甲乙股也丁乙股

和也乙午股和上方也乙丙

句也丙子句和也丙未句和

上方也甲丙也丙丑股也醜巳

句也甲己和和也甲壬和和

上方也乙午丙未兩方並較甲壬

方則兩方多一句股較自乘之數何則試觀甲壬方中股句三方卽乙午丙末兩方中句股三方也甲壬方中股矩二句矩二卽乙午丙未兩方中股矩二句矩二也無或異也所異者惟甲壬方中餘句股矩二與乙午丙未兩方中余方一則方一與句股

矩二其較爲句股較上方何則試

觀另圖甲丙也甲丁上方也

甲乙股也乙丙勾也甲乙丙形句

股矩形之半也而丙巳丁丁子丑

丑午甲三形皆與甲乙丙形等共

四形卽得句股矩之二也中余乙巳子午方卽句股較上方然則乙午丙未兩方並較甲壬方不多一句股較上方乎故於兩方中減之卽得甲壬方也

又法曰兩和相乘倍之開方得

和和以下同前法

論曰甲乙丙形乙丁股和也丁

午句和也乙午兩和矩內形也丙子句和也丙辛股和也丙未兩和矩內形也甲丙也丙醜股也醜

巳句也甲己和和也甲壬和

和上方也乙午丙未兩矩形與甲

壬方形等者兩矩形中有兩方

甲壬形中有方一股方一句方

一亦卽兩方也兩矩形中有股

矩二句矩二句股矩二甲壬形亦有股矩二句矩二句股矩二也然則乙午丙未兩矩形不與甲壬方形等乎

十四題

句股和句和求句股

法曰先以兩和相減得卽爲股較次以兩和各自乘相減余爲實倍股較爲法依長濶相差法求之得句句減句股和得股句減句和得

論曰甲乙丙形甲丁句和也甲戊句和上方也巳丁句股和也子戊句股和上方也兩和之較爲甲巳兩方之較

爲壬甲醜磬折形此形中午甲未磬折形句實也癸戊方形亦句實也夫癸戊方形與壬甲醜磬折形其餘爲辛未午丁兩矩形今試作癸寅寅申兩矩形與之等卽戊申矩形與壬甲醜磬折形等矣此戊申矩形戊庚爲濶卽句與庚癸等癸卯卯申爲倍數爲長濶之差

十五題

句股和股和求句股

法同十四題

十六題

句股形中求容方

先論曰凡於句股形中依句股兩邊作方形或矩形則作形之外所餘之角形二自相似亦與元形相似如圖甲乙丙元形作壬丁乙子方形則此形之外所餘甲丁壬及壬子丙兩角形自相似何則謂甲丁與壬子相似丁壬與子丙相似也若

作壬丁乙子矩形亦然又此兩形之各兩邊與元形之兩邊相似何則謂甲丁壬子兩邊與甲乙邊相似丁壬子丙兩邊與乙丙邊相似也於是遂生求容方之法如左【獨不能生求容矩之法者以容方則甲丁丁壬兩邊卽甲乙邊壬子子丙兩邊卽乙丙邊也若容矩則否】

法曰句股相乘爲實並句股爲法除之得方邊

論曰甲乙股乙丙句相乘得甲丙矩卽未午矩矩之甲

午邊甲乙股乙午卽句乙子卽方

邊何則甲丙爲甲丙矩形之對

角綫亦爲甲壬壬丙矩形之對角綫則甲乙丙與甲丑丙甲丁壬與甲未壬壬子丙與壬亥丙各角形自相等今於甲乙丙甲丑丙相等之兩形中各減去相等之角形所餘之乙壬方與壬丑方必等次於兩方各加一同用之子亥矩則乙亥矩與子丑矩亦必等而子午矩與乙亥矩等亦卽與子丑矩等然則甲丙矩不與未午矩等乎

又法曰句自乘爲實並句股爲法除之得餘句用減句余卽方邊

論曰甲乙丙句股形乙丙句自乘

得乙丁方卽未已矩形形之戊丙

卽股丙巳卽句丙子卽餘句乙子卽方邊何則丑丁形卽子巳形也壬乙形卽壬戊形也然則乙丁方卽未巳矩也

十七題

句股形中求容圓

法曰句股相乘倍之爲實句股共爲法除之得容圓徑【或句股相乘爲實句股共爲法除之得容員之半徑或句股相乘半之爲實句股並而半之爲法除之得容圓之半徑】

論曰試於形之三邊截取己子未

三防令乙子與乙巳等甲巳與甲

未等丙未與丙子等次於已子未

三防各作己丁未丁子丁三綫爲

形三邊之垂綫必相遇於丁而相

等何則試先就己甲未丁四邊形論之甲巳甲未兩邊等己未兩角皆正卽巳丁未丁兩綫必等依顯未丁與子丁兩綫子丁與巳丁兩綫亦必各等然則丁卽圓心三綫卽圓之半徑矣果何術以求之乎曰試作甲丁丙丁乙丁三對角綫平分甲乙丙三角及丁角因平分三个四邊形爲六个三邊形各兩相等次引乙丙至壬令丙壬與甲已等則乙壬綫爲甲乙丙三邊之半何則乙子者乙子乙巳之半丙子者丙子丙未之半丙壬者甲未甲巳之半然則乙壬者甲乙丙三邊之半矣次引長巳丁綫至亥令己亥與乙壬等必相與爲平行次作壬亥丙午兩綫與子丁綫等而相與爲平行末作丙亥對角綫則乙亥矩形與甲乙丙元形等何則乙巳丁子方形在元形之內丙子丁角形亦在元形之內丁午丙角形𨿽不全在元形之內然卽丙未丁形而倒置之湊合丙子丁形而成子午矩形者也至於壬午矩形全在元形之外然亦卽甲巳丁甲未丁兩形顚倒湊合而成者也然則乙亥矩形與甲乙丙元形等矣於是以句股相乘半之得甲乙丙元形卽乙亥矩形以乙壬三邊之半分之得子丁爲圓半徑或以三邊之全分元形之倍亦

得圓之半徑或三邊之全分元形

之四倍得全圓徑也

又法曰句股三邊半之內減

得圓之半徑【或倍用減三邊之全得全圓徑】論曰甲乙丙元形之乙角旣是正

角乙子丁乙已丁兩角又是正角卽子丁己亦必正角然則子丁己乙形必是正角方形而四邊等矣卽乙巳乙子兩邊必與丁己丁子圓之兩半徑等矣此乙已乙子之兩邊果何術以求之乎依前論乙壬綫爲三邊之半而丙壬卽甲未也丙子卽丙未也則子壬綫卽甲丙也於是子壬減乙壬三邊之半得乙子卽圓之半徑若倍數用減三邊之全得全圓徑

又法曰句股並以減之得全圓徑

論曰如前圖乙丙句也丙壬與乙巳並卽甲乙股也何則以丙壬與甲巳等故也壬子卽甲丙也何則以丙壬與甲未等丙子與丙未等故也於是以子壬減壬己句股並得子巳爲圓之全徑何則以乙子與子丁等乙巳又與乙子等故也

巳上十七題除求方求圓二題餘十五題已盡句股之蘊矣然論其題則不止於己上十五題也今反覆推之凡得一百四十四題𨿽究其歸不出於己上十五題之法要亦不可不備使習者得以按題而索之逐類而通之也

勾股較勾股和句股較句和句股較股和句較句和句較句股和句較股和股較股和股較句股和股較句和已上共九題

【句】和和

較較

句較較

股較較

和較

句和較

股和較

較和

句較和

股較和

巳上十則各以

【股】三則配之得三十題

各以

【股和】三則配之得三十題

各以

【股較】三則配之得三十題

又巳上十則

【股】和和爲一則以下九則配之得九題較較爲一則以下八則配之得八題句較較爲一則以下七則配之得七題股較較爲一則以下六則配之得六題和較爲一則以下五則配之得五題句和較爲一則以下四則配之得四題股和較爲一則以下三則配之得三題較和爲一則以下二則配之得二題句較和爲一則以下一則配之得一題

已上共一百四十四題學者按題而索之逐類而通之要不出於前所列之十五題也

又一題【後十四題盡句股之變】

容方與餘句求余股與余股求餘句因得全句全股法曰方邊自乘以餘句除之得余股以余股除之得餘句各以所得加方邊因得全句全股

論曰乙丁方邊也自乘得乙壬方

卽壬醜矩【論詳前十六題】故以己壬【卽丙未余】

【句】除之得子壬【卽甲丁余股】以子壬除之得己壬因以己壬加壬丁共已丁卽句以子壬加壬未共子未卽股又法曰以餘句除方邊【餘句小於方邊】得數卽用以乘方籩得余股或以方邊除余股【余股大於方邊】得數卽用以除方邊得餘句

論曰方邊爲餘句余股連比例之中率以前率餘句比中率方邊則方邊爲幾倍大卽以中率方邊比後率余股則余股亦必爲幾倍大又以後率余股比中率方邊

則方邊爲幾倍小卽以中率方邊

比前率餘句則餘句亦必爲幾倍

小故得數者得其幾倍大幾倍小之數也大用乘小用除

又二題

餘句余股求容方因得全句全股

法曰餘句股相乘開方得方邊各以餘句股加之得全句股

論曰子壬卽余股也己壬卽餘句

也醜壬矩卽乙壬方也【論詳前十六題】因

以甲丁【余股】丙未【餘句】加之得全股【甲乙】全句【乙丙】

又法曰以餘句除余股【以小除大】得數開方得中率之比例於是以中率之比例除余股得方邊或以中率之比例乘餘句亦得方邊

論曰餘句余股之於方邊爲連比例之前後率今以己壬餘句比子壬余股得子壬爲幾倍大卽是以己壬綫上方比己壬綫與子壬綫上矩得醜壬矩爲幾倍大也而醜壬矩又與乙壬方等開方得連比例之中率者以方則邊等邊等則比例連故也旣得連比例之中率則方邊可得而知矣

右兩題宜附前十六題之後

又三題

句股形句股較求句股

法曰形四倍之另以較自乘相並開方得次依前四題法求句股

論曰甲乙丙形四倍之卽丁已甲子午丁丙未子與甲乙丙四形也乙巳爲句股較

乙午爲較上方四形與一方相並成甲子方開方得甲丙

又法曰形八倍之另以較自乘相並開方得句股和於是和加較折半得股和減較折半得句論曰甲乙丙形八倍之卽甲丙丙丁丁己己甲四矩形也乙子爲句股較乙午

爲較上方四矩形與一方並成丑未方開方得醜壬爲句股和

又法曰形倍之以句股較用長濶相差法求之得句句加較得股

論曰甲乙丙句股形倍之得乙丁矩形甲乙股乙丙句已甲較卽乙已與乙丙句等丙巳爲句上方丁句爲句與較矩內形今試商

得乙丙爲句乙巳加已甲爲股

又四題

句股形句股和求句股

法曰形四倍之另以句股和自乘相減開方得次依前七題法求句股

論曰甲乙丙形四倍之者甲乙丙丙戊丁丁己辛辛壬甲四形並也乙壬爲句股和乙巳爲和上方內減四形並餘甲

辛丁丙方開方得甲丙

又法形八倍之另以句股和自乘相減開方得句股較於是用加和折半爲股用減和折半爲句

論曰甲乙丙形八倍之者卽甲丙丙丁丁辛辛甲四矩形並也午戊爲和戊壬爲和上方內減四矩形並餘子乙未丑

方開方得子乙爲句股較

又法曰形倍之以句股和用長濶相和法求之得句句減和得股

論曰甲乙丙句股形倍之得乙巳

矩形甲乙股乙丙句並之爲和今試

商得乙丙爲句用減和餘甲乙卽股

又五題

句股形中求從直角【句股相聯處】至作垂綫【與相交爲直角】分元形爲兩句股形

法曰上方句上方並之內減股上方余半之以除之得數爲上作垂綫之處於是以所得數與句依句求股法作垂綫

論曰甲乙丙元形求從直角作乙午綫爲甲丙之垂綫甲丙也甲丑上方也乙丙句也乙己句上方也

甲乙股也乙辛股上方也夫乙辛方中之子未方乙午

綫上方也乙巳方中之丁申方亦

乙午綫上方也卽兩方等矣又乙

辛方中之子辛未磬折形甲丑方

中之午壬方也今於甲丑乙巳兩

方中減乙辛方卽於兩方中減丁申方與午壬方也兩方中所存者爲申巳丁磬折形午丑壬磬折形矣而申巳丁磬折形又與丑卯方等半之卽得午丑矩故以丙醜除之得丙午【若乙辛方與甲丑方並內減乙巳方余半之以除之得甲午同上論按此法不但可施諸句股直角形凡鋭角鈍角形俱可用此法求垂綫】

又法曰句股相並得數相減得數兩得數相乘以除之得數用減余半之得數爲上作垂綫之處

如圖甲乙丙形甲乙股乙丙句相

加得甲丁相減得甲巳甲丁與甲

巳相乘得數以甲丙除之得甲

子用減余丙子半之於午卽午防爲上作垂綫之處一論曰甲丁偕甲已矩內形及乙巳上方形並與甲乙上方形等如圖壬丁矩甲丁偕甲巳矩內形也【甲壬與甲巳等】辛甲未磬折形卽壬丁矩也【壬未矩與辛丁矩等】未辛方

乙巳上方也並之得甲戊方卽甲乙上方

二論丁已甲綫貫圜心於乙庚甲綫切圜周於庚乙庚甲爲直角夫丁甲偕巳甲矩內形與甲庚綫上方形等何則乙庚庚甲兩綫上方形與乙甲綫上方等而丁甲

偕巳甲矩內形及乙已上方並亦與

乙甲綫上方等【一論之圖可見】此兩率者每

減一相等之乙庚乙巳兩綫上方則

甲丁偕甲巳矩內形與甲庚綫上方形必等

三論曰丙甲綫不貫圜心於乙庚甲

綫切圜周於庚乙庚甲直角形乙午

甲亦直角形兩形合一乙甲則乙

庚庚甲兩綫上方並與乙午午甲兩綫上方並必等又乙午子直角形則乙午午子兩綫上方並與乙子綫上方等夫午甲上方形中原有【一論之圖可見】丙甲偕子甲矩內

形及午子上方形今於乙甲上方形

中減乙庚上方形卽減去同乙庚之

乙子上方同乙子之乙午午子兩綫

上方然則所餘之丙甲偕子甲矩形與甲庚上方形必等四論曰前甲丁偕甲巳矩內形與庚甲上方等【二論之圖】甲丙偕甲子矩內形與庚甲上方亦等【三論之圖】則兩矩形自

相等而等角防之各兩邊彼此互相

視何則試引戊子壬己兩綫相遇於

醜而成甲醜形夫甲戊與甲醜兩形

同在戊醜丙己兩平行綫內等髙則兩形之比例若其底甲丙與甲己之比例依顯甲壬與甲醜兩形之比例亦若其底甲丁與甲子之比例夫甲戊與甲壬兩矩形元等則甲戊形與甲醜形卽甲壬形與甲醜形也卽甲丙與甲己之比例亦卽甲丁與甲子之比例也更之則甲丙與甲丁之比例亦若甲己與甲子之比例

於是以甲丙爲一率甲丁爲二率

甲己爲三率二三率相乘一率除

之得四率甲子也旣得甲子用減

甲丙余丙子半之於午得午防爲上作垂綫之處何則試作乙子綫與乙丙同爲圜之半徑卽等而成乙丙子兩邊等角形則午點折丙子之半必是直角【此法不但可施諸句股形凡鋭角鈍角形俱可用此法求垂綫】

右旣得乙午垂綫卽分甲乙丙原形爲甲午乙乙午丙兩句股形此兩形者自相似亦與元形相似

又六題

句股形中求依一邊容方

法曰先依又五題法求形中垂綫次以與垂綫相乘得數並與垂綫爲法除之得方邊

論曰甲乙丙元形乙丁爲垂綫求依甲乙作方邊如子丑而成子午方形夫甲乙丙元形與己乙午分形相似何則以己午與甲丙平行故也次觀己午與未丁等卽乙未

與己午並是乙丁垂綫也然則乙丁偕甲丙並而與甲丙若乙未偕己午並【卽乙丁垂綫】而與己午

又法曰垂綫自乘並與垂綫爲法除之得數用減垂綫得方邊

論曰乙丁偕甲丙並【一率】而與乙丁【二率】若乙未偕己午並【三率卽乙丁】而與乙未【四率】於是以乙未減乙丁余未丁卽方邊【此法不但可施諸句股形凡鋭角鈍角形俱可用】

又七題

句股形中求分作兩邊等三角形二

法曰半之卽是兩邊等之一邊

論曰甲乙丙形半於丁於是以丁爲心甲丙爲界作圜必切乙角得乙丁與

半等因成乙甲丁乙丙丁兩形皆兩邊等三角形也

又八題

斜三角形中求作中垂綫分元形爲兩句股形

法具又五題

又九題

斜三角形中求積

先分別是銳角形或是鈍角形【若是正角形法以句股相乘半之卽得】法曰大中小三邊用小中兩邊依句股求法求之若求得數小於大邊卽是鋭角形大則是鈍角形

鋭角形求積法曰任取一角依又五題求中垂綫【鋭角形求中垂綫任取一角皆在形內】分元形爲兩句股形次以兩分形句與股各相乘半之得積

論曰甲乙丙鋭角形先求得乙丁中垂綫分爲甲丁乙乙丁丙兩句股形次以

甲丁與丁乙丁乙與丁丙各相乘得丁戊與丁己兩矩形各半之得甲乙丙形之積【或以乙丁因甲丙之半亦得或以甲丙因乙丁之半亦得】鈍角形求積法【於鈍角至對邊作垂綫則垂綫在形內法同前】於鋭角至對邊作垂綫則垂綫在形外而引對邊出形外湊之曰大邊上方內減中小兩邊上方余半之以中邊除之得引湊數與小邊爲股求句得垂綫【或以小邊除半數得引湊數與中邊爲句求股亦得垂綫】旣得垂綫則與引湊數湊成一小句股形又以垂綫與引湊數偕元形之邊湊成一大句股形大小兩句股形相減得所求

論曰甲乙丙鈍角形【乙爲鈍角】求從丙鋭角作丙丁垂綫而引乙丁綫以湊之【從甲角作垂綫亦在形外玆不備述】夫甲丙上方元包

丙丁與甲丁兩邊上方今於甲丙上

大方中減乙甲乙丙上兩方卽是減

丙庚與子午兩方爲乙丙上方減甲

子方爲甲乙上方也而所存者爲丁

子子辛兩矩形矣半之爲子丁一矩

形以中邊乙子除之得乙丁爲引數

也丙丁乙爲小句股形丙丁甲爲大

句股形兩形相減得甲乙丙斜三角形積

又法曰三邊數並而半之以每邊數各減之得三較數三較連乘【任以二較相乘得數又以一較乘之】得數又以半數乘之得數開方得積

如後圖甲乙丙元形求其積

一圖

一論曰壬乙矩形與元形等

論同前十七題所論乙亥矩

形與甲乙丙元形等

二論曰丁心方與乙戊相乘又與乙戊相乘開方與乙

二圖

壬矩形等如圖子壬二丑壬三相

乘得六爲子丑矩形今以子壬二

自乘得四爲子卯方卽壬寅邊以

醜壬三乘之得十二爲丑寅矩形又以三乘之得三十六爲辰寅矩形卽午丑方形故開方得辰午六與子丑

三圖

矩形等

三論曰丁心偕戊庚矩形與乙丁相乘其所得數與丁心方偕乙戊相乘所得

數等何則乙丁心形與乙戊庚形相似之形也戊庚與丁心若乙戊與乙丁則戊庚偕丁心矩形【卽庚未矩形】與丁心方【卽己戊方形】亦若乙戊與乙丁也

四論曰丙丁偕丙戊矩形與丁心偕戊庚矩形等【就一圖觀之】何則心丁丙形與丙戊庚形相似之形也夫庚乙綫平分丁乙甲角庚戊爲丙戊之垂綫則戊爲直角次依丙戊綫截取丙卯綫作卯庚綫爲丙卯之垂綫則卯爲直角此庚乙庚戊庚卯三綫必相交於庚防三綫旣相

交於庚點則丙庚綫必平分

卯丙戊角而卯丙戊角又卽

己心丁角因得心丁丙形與

丙戊庚形爲相似之形也兩形旣相似則丁心與丁丙若丙戊與戊庚也

解庚乙庚卯庚戊三綫必相交於庚點所以然之故庚心乙界作圈次依甲乙丙形作丙丁辛形次引乙丁綫至癸引辛甲綫至壬乙庚綫平分丙乙甲角則

庚防必是圈心戊防折乙癸綫之

半則戊防必直角卯防折壬辛

綫之半則卯防必直角乙癸與

乙己等乙丙辛丙爲大邊甲丙

丁丙爲中邊甲壬丁癸卽小邊

總論曰二論丁心方與乙戊相乘又與乙戊相乘所得數開方與乙壬矩形等夫乙戊半數也亦旣得之矣次欲求丁心與乙戊相乘而丁心不可得三論丁心戊庚矩形與乙丁相乘所得數與丁心方偕乙戊相乘所得數等夫乙丁三較之一也則又得之矣次欲求丁心與戊庚兩綫而兩綫又不可得四論丁丙偕丙戊矩形與丁心偕戊庚矩形等夫丁丙丙戊三較之二也則盡得之矣今法於四論用丁丙偕丙戊二較相乘於三論用乙丁一較乘之於二論用乙戊半數乘之開方得數與乙壬矩形等

又十題

斜三角形中求容圓

法曰先依又九題求積次取三邊數並而半之用除積得員之半徑【或置二較連乘數以半數除之得開方亦得圓半徑】

論曰先依又九題求得乙壬矩

形爲甲乙丙元形積次以乙戊

除之【卽三邊數之半也】得丁心卽圓之半徑【若以三邊之全除元形之倍亦得圓半徑若以三邊之全除元形之四倍得圓全徑】

又十一題

斜三角形中求容方

法同又六題

又十二題

斜三角形有三和數求三邊

法曰三和數相減得三較數各置三較數各以非所較之邊加減之各半之其加而半者得大邊或中邊減而半者得小邊或中邊

如圖戊己庚爲三和數【戊爲大中兩和數己爲大小兩和數庚爲小中兩和數】甲爲戊庚兩和之較乙爲己庚兩和之較丙爲戊己兩和之較於是置甲較數以己爲非所較之邊加而半之得大邊減而半之得小邊置乙較數以戊爲非所較之邊加而半之得大邊減而

半之得中邊置丙較數以庚爲非所較之邊加而半之得中邊減而半之得小邊

論曰戊者大中兩和數也加減用乙者乙爲己庚兩和之較庚者小中兩和數己者大小兩和數此兩和數中皆有相等之小數而余爲大中兩數矣此乙所以爲大中兩數之較也餘仿此

又十三題

句股測髙【測逺測廣測深同法】

法曰先準地平【地平者必令所測地面自所測之處至髙之根如水之平也】次立表與地平爲垂綫退後立望竿令所測髙表尖竿頭參相直末自竿至髙根量得若干逺然後以表竿差與逺相乘而以表竿相去若干除之加竿長若干得所求之髙如圖丙乙髙乙甲逺丁甲竿己戊表己子爲表竿差戊甲爲表竿相去夫丁子己形與丁辛丙形相似故丁子與己子若丁辛

與丙辛也

又十四題

句股重測髙逺【測廣測深同法】

法曰若無髙根之可量者則用重測法謂一次立表竿令表竿與髙參相直二次立表竿令表竿與髙防相直【兩表兩竿要各相等又要或前或後立成一直綫】然後以表竿之較乘兩表相去而以兩表竿相去之較除之加表髙若干得所求之髙又以前表竿相去乘兩表相去而以兩表竿相去之較除之加前表竿相去得所求之逺

如圖甲乙髙乙丙逺各不知數用重

表測之丁子爲前表己丙爲望竿

子丙爲表竿相去甲丁己三防參相

直午壬爲後表醜辛爲望竿壬辛爲

表竿相去甲午丑三防參相直丁亥爲表竿之較子壬爲兩表相去未辛爲兩表竿相去之較己上用以測髙借丁卯【元是表竿相去】爲表竿相差借卯己【元是表竿相差】爲表竿

相去辰戊亦借爲表竿相差戊癸亦借爲表竿相去甲辰癸三防亦參相直丁辰亦借爲兩表相去與丁午等卽庚癸亦爲兩表竿相去之較與辛未等以上用以測逺解庚癸綫與辛未綫必等所以然之故

如圖甲乙矩內形甲乙爲對角綫丙丁及戊己兩綫與

矩形之邊爲平行而交角綫

於庚次任作辛壬綫亦交

角綫於庚次截甲癸綫與

甲辛綫等作癸子綫亦交角

綫於庚則子乙綫與壬乙綫必等

論曰試作午丑及午未兩綫與甲辛及甲癸相綫爲平行夫庚甲辛及庚午丑兩角形相似之形也則庚甲與庚午若甲辛與午丑依顯庚甲與庚午若甲癸與午未然則甲辛與甲癸亦若午丑與午未夫午丑與午未如是則子乙與乙壬亦如是矣

先論甲乙矩形此形甲己爲對角綫寅卯申亥兩綫交於角綫上之丁防則卯申矩形與亥寅矩形等

次論甲醜矩形此形甲醜爲對角

綫寅酉房壬兩綫交於角綫之午

點則房酉矩形與寅心矩形等

末總論曰夫房酉矩形與寅心矩

形旣等而午井形又與卯申形等卽亦與亥寅形等然則房酉矩形中所餘之井酉形與寅心矩形中所餘之丁心形必等

於是以丁亥表竿相差乘丁午兩表相去得丁心矩形卽井酉形而以井女兩表竿相去之較除之得女酉加酉辛表共女辛卽甲乙髙

先論甲己矩形同前

次論甲癸矩形此形甲癸爲對角綫申氐戊亢兩綫交於角綫之辰防則亢氐矩形與戊申矩形等

末總論曰夫亢氐矩形與戊申矩形旣等而辰牛形又與亥寅形等卽亦與卯申形等然則亢氐矩形中所餘之牛氐形與戊申矩形中所餘之丁戊形必等

於是以丁卯表竿相差乘丁辰兩表相去得丁戊矩形卽牛氐形而以牛危兩表竿相去之較除之得危氐加氐癸表竿差共危癸卽乙丙逺也

求髙又法旣得危氐綫卽以亢牛乘之得牛辰形此形卽寅亥矩形亦卽申卯矩形也故以丁卯除之得丁申髙

求逺又法旣得女酉綫卽以房井乘之得井午矩形此形卽申夘矩形亦卽寅亥矩形也故以丁亥除之得丁寅逺

歷算全書卷四十六

欽定四庫全書

歷算全書卷四十七

宣城梅文鼎撰

句股闡微卷二

句股積求句股句股積與較較求諸數

第一法

假如句股積【一百二十】較較【十二】

法以積四之得【四百八十】較較自之【一百四十四】兩數相減余【三百三十六】折半【一百六十八】爲實較較【十二】爲法除之得句股較【十四】以加較較【十二】共得【二十六】爲【有有句股較卽諸數可求】論曰甲乙丙丁合形爲自乘大方冪甲小方爲句股較冪冪內減句股較冪所餘丙乙丁磬折形原與四

句股積等於中又減去乙小方

爲較較自乘冪仍餘丁丙二

長方並以句股較爲其長以

較較爲其濶故折半而用其一

爲實以較較爲法除之得句股較矣【是以濶求長】

第二法

置四句股積【四百八十】與較較自冪【一百四十四】相加得共【六百二十四】折半【三百十二】爲實較較【十二】爲法除之得【二十六】爲內減去較【十二】得余【十四】爲句股較

論曰乙丙丁磬折形原與四句股積等今加一小方形如己爲較自乘冪與乙等又丁丙二長方原相等於是合丁己爲一長方合乙丙爲一長方必亦相等矣【並以

較較爲濶以爲長】故折半而用其一

爲實以較較爲法除之卽得

矣【亦是以濶求長】

第三法

置四句股積【四百八十】爲實較較【十二】爲法除之得【四十】爲較和以較較【十二】加較和四十得【五十二】折半【二十六】爲以較較【十二】減較和【四十】得【二十八】折半【十四】爲句股較於前圖乙丙丁磬折形卽四句股積移丁長方置於戊

爲乙丙戊長方其長如

較和其闊如較較故以

較較除之得較和【若以

較和除之亦得較較】

又簡法

置句股積【一百二十】爲實以較較【十二】半之得【六】爲法除之得【二十】爲半較和以半較較【六】加半較和【二十】得【二十六】爲又以半較【六】減半和【二十】得【十四】爲句股較

論曰長方形濶【十二】如較較長【四十】如較和其積如四

句股今只用一句股積是四

之一也積四之一者其邊必

半觀圖自明

句股積與較和求諸數

第一法

假如句股積【一百二十】較和【四十】

法以積四之得四百八十較和自之得【一千六百】兩數相減余【一千一百二十】折半得【五百六十】爲實較和【四十】爲法除之得【十四】爲句股較以減較和得【二十六】爲自乘【六百七十六】加四句股積【四百八十】得【一千一百五十六】平方開之得【三十四】爲句股和以與句股較【十四】相加得【四十八】折半【二十四】爲股又相減得【二十】折半得【一十】爲句

句【一十】

股【二十四】

【二十六】

句股和【三十四】句股較【十四】較和【四十】

較較【十二】

論曰總方爲較和【四十】自乘

之冪內分甲戊己方爲自

乘冪乙小方爲句股較自乘

冪於冪內減去戊己磬折

形卽四句股積則所餘者甲

小方卽句股較冪與乙方等以甲小方合丁長方卽與乙丙長方等【以丁丙小長方原相等故】此二長方並以句股較【十四】爲濶以較和爲長【四十】故折半而用其一爲實較和【四十】爲法除之卽得句股較【是爲以長求濶】

第二法

較和自乘【一千六百】與四句股積【四百八十】兩數相加【二千○八十】折半【一千○四十】爲實較和【四十】爲法除之得【二十六】爲以減較和得【十四】爲句股較餘如前【觀後圖自明】

第三法

置四句股積【四百八十】爲實較和【四十】爲法除之得【十二】爲較較餘同較較第三法

又簡法

句股積【一百二十】爲實較和【四十】半之得【二十】爲法除之得【六】爲較較之半余並同較較簡法

論曰乙丁丙甲戊己合形爲

較和【四十】自乘之大方外加一庚

辛長方爲四句股積與戊己磬

折形等於是中分之爲兩長方

【乙丁庚辛合爲左長方丙甲己戊合爲右長方】並以爲濶【二十六】較和【四十】爲長故折半爲實以較和除之得【亦爲以長求濶】借此圖可解第三法之理何則庚辛長方形旣爲四句股積而其濶【十二】如較較其長【四十】如較和是【十二】與【四十】相乘之積也故以較較除之得較和若以較和除之卽復得較較

若庚辛長方橫直皆均剖之成四小長方則其濶皆【六】加半較其長【二十】如半和而其積皆【一百二十】爲一句股積矣此又簡法之理也

句股積與和較求諸數

第一法

假如句股積【六千七百五十】和較【六十】

法以和較自之得【三千六百】與四句股積【二萬七千】相減余【二萬三千四百】折半【一萬一千七百】爲實和較【六十】爲法除之得【一百九十五】爲加較【六十】得句股和【二百五十五】冪內減四句股積開方得句股較以加句股和折半得股以減句股和折半得句

句【七十五】

股【一百八十】

【一百九十五】句股和【二百五十五】句股較【百○五】和和【四百五十】較和【三百】

和較【六十】

較較【九十】第二法

以和較自乘【三千六百】與四句股積【二萬七千】相加得【三萬○六百】折半【一萬五千三百】爲實和較【六十】爲法除之得【二百五十五】爲句股和內減和較【六十】得【一百九十五】爲

論曰丁丙方爲句股和自乘方冪

內減甲戊方爲自乘冪其餘丁

戊丙磬折形四句股積也內減戊

乙小方爲和較自乘積則所餘

丁戊長方與戊丙長方等而並以

爲長和較爲濶故以和較除之得此第一法減四句股積之理也

若於丁戊丙乙磬折形外加一己丙小方與戊乙等乃並之爲庚戊長方與辛乙等並以句股和爲長和較爲濶此第二法加四積之理也【兩法並以濶求長】

第三法

置四句股積【二萬七千】爲實和較【六十】除之得【四百五十】爲和和以與和較相加折半爲句股和又相減折半爲此如有句股積有容圓徑而求句股乃還元之法也

論曰前圖中辛乙長方並戊丙

長方是四句股積聯之爲辛丙

長方則其濶丁辛和較也其長丁丙和和也

又簡法

置句股積【六千七百五十】爲實半和較【三十】除之得【二百二十五】爲半和和以與半和較相加得二百五十五爲句股和又相減得【一百九十五】爲此如有容圓半徑以除句股積而得半和和句股積與和和求諸數

第一法

假如句股積【六千七百五十】和和【四百五十】

法以積四之得【二萬七千】和和自之得【二十○萬二千五百】兩數相減余【十七萬五千五百】折半【八萬七千七百五十】爲實和和【四百五十】爲法除之得【一百九十五】爲以減和和得【二百五十五】爲句股和

第二法

以四句股積與和和冪兩數相加得【二十二萬九千五百】折半得【十一萬四千七百五十】爲實和和【四百五十】爲法除之得【二百五十五】爲句股和以減和和得【一百九十五】爲

論曰甲乙大方和和自乘也內分甲丁方自乘也

與丁丙方等丁乙方句股和

自乘也於丁乙內減去丁丙

冪則所餘者四句股積卽

壬乙丙戊二小長方也而己

辛小長方與丙戊等則己乙

長方亦四句股積也今於甲乙大方內減去己乙則所餘者甲戊己戊二長方並以爲濶和和爲長故以和和除之而得此第一法減四句股積之理也是爲以長求濶

又論曰若於甲乙大方外增一甲庚長方與己乙等而中分之於癸戊則癸乙與癸庚兩長方等並以句股和爲濶和和爲長故以和和除之而先得句股和此苐二法加四句股積之理也亦是以長求濶

第三法

置四句股積【二萬七千】爲實和和【四百五十】除之得和較【六十】此如並句股除四倍積而得容員徑

又簡法

置句股積【六千七百五十】爲實半和和【二百二十五】除之得半和較【三十】此如合半句半股半除積得容員半徑欲明加減用四句股之理當觀古圖

甲乙丙句股形甲丙句六

甲乙股八乙丙十

甲丁句股和十四壬辛句

股較二甲己大方句股和自

乘冪也其積一百九十六丙戊次方自乘冪也其積一百壬庚小方句股較自乘冪也其積四甲己和冪內減冪所餘者四句股也冪內減較冪所餘者亦四句股也句股之積並二十四

甲丁句股和十四癸丁十子丁句股較二甲丙方爲句股和自乘冪【一百九十六】內減癸辛冪【一百】余【九十六】爲甲己丙磬折形【亦卽四句股積】內分甲己直形移置於丙戊成乙戊長方卽爲【和較乘和和】又壬丁小方爲句股較自乘其冪四以減冪一百餘九十六爲癸壬辛巳磬折形【亦卽

四句股積】內分癸壬直

形移置於辛庚成

己庚長方卽爲

較較乘較和

假如方環田有積有田之濶問內外方各若干

法以積四之一爲實田濶除之得數爲內外二方半和與田濶相加得外方又相減得內方【蓋田濶卽如半較】若但知外方及內小方及環田積法卽並大小方邊爲和以除積得數爲較較與和相加折半爲外周大方又相減折半爲小方以兩方之較折半爲環田濶

若方田內有方墩法同或方墩不居正中其法亦同但只可求大小方邊不能知濶

總論曰較較乘較和之積與和較乘和和之積等爲四句股乃立法之根也而其理皆具古圖中學者所宜深玩

又如有辛庚壬圓池不知其徑法於乙作甲乙直綫切員池於庚又乙丙橫綫切圓池於壬乙爲正方角又自

丙望甲作斜綫切員池於辛

乃自丙取乙丙之度截斜綫

於丁又自甲取甲乙之度截

斜綫於戊末但量丁戊有若

幹尺卽圓池徑

解曰此卽句股容員法也丙乙句截甲丙於丁則丁甲爲句較甲乙股截於戊則戊丙爲股較而丁戊爲和較故卽爲圓徑其句股不必問其丈尺但取三直綫並切員而乙爲方角足矣故爲測員簡法【凡城堢墩臺錐塔員柱之類形正員者並同一法也】

句股容方【系鮑燕翌法】

句股形引股綫法

卽依正角作方形於形外又卽引小形成大形甲乙丙句股形今欲引甲乙股至丁甲丙至戊而令

乙丁與戊丁等

法曰以乙丙分甲乙得數減一餘

用歸甲乙得之

解曰乙丙與甲乙原若丁戊與甲

丁故以乙丙分甲乙與以丁戊分甲丁所得之分數等然則減一者𨿽似於甲乙分數內減乙丙之一分實於甲丁分數內減丁戊之一分也【卽乙丁之一分】故以減余分甲乙而得

【勿庵又法句股相乘爲實句股較爲法除之亦卽得所引乙丁與乙戊同數】

句股形截股法

卽依正角作方形於形內又卽截大形成小形甲丁戊句股形內今欲截甲丁股於乙甲戊於丙而

令乙丁與乙丙等

法曰以丁戊分甲丁得數加一共

用歸甲丁得之【勿庵又法句股相乘爲實句股

和爲法除之亦卽得所截乙丁與丁丙同數卽句股容方法】

解曰丁戊與甲丁原若乙丙與甲乙故以丁戊分甲丁與以乙丙分甲乙所得之分數等然則加一者𨿽似於甲丁分數外加丁戊之一分實於甲乙分數外加乙丙之一分也【卽乙丁之一分】故以加共分甲丁而得

若欲令丙戊與丁戊等或欲令乙丙與丙戊等依法推之按後一法卽句股容方也原法簡易今鮑燕翼先生所設殊新要其理亦相通耳【勿庵補例】

設甲乙股十六乙丙句八今引甲乙股長出至丁

而令引出之乙丁股分與所當之丁

戊句等問若干答曰乙丁十六

法以乙丙句【八】甲乙股【十六】相乘得【一百】

【廿八】爲實句股相減得較【八】爲法除之得乙丁引出一十六與丁戊句相等若如鮑法以句【八】除股【十六】得【二】內減去一仍餘一用爲法以除股【十六】仍得【十六】爲乙丁又設甲乙股【四十八】乙丙句【十二】依法引出乙丁股【十六】與丁戊句等

法以句十二乘股【四十八】得積【五百

七十六】爲實句減股得較【三十六】爲

法除之得【十六】爲乙丁

或以句【十二】除股【四十八】得數【四】內減【一】余【三】爲法以除股【四十八】亦得【十六】爲乙丁

又設甲乙股【六】乙丙句【四】依法引出乙丁股【十二】與丁戊句等法以句乘股得【二十四】爲實句股較【二】爲法除之得【十二】爲乙丁

或以句【四】除股【六】得【一半】內減一餘【半】爲法以除股【六】

亦得【十二】爲乙丁

解曰半爲除法則得倍數此畸零除

法也詳別捲

又設甲乙股【三十】乙丙句【十二】依法引出乙丁股【二十】與丁戊句等

法以句乘股得【三百六十】爲實句股較【十八】爲法除之得乙丁【二十】

或以句【十二】除股【三十】得【二半】內減

一餘【一半】爲法以除股【三十】亦得乙

丁【二十】

解兩法相同所以然之故蓋此是依句股正角【卽乙角】作正方形於形之外也本法以句較爲法除句股形倍積【卽句股相乘】今不用句股較之本數而用其除過之句股較爲法【以句除股則股內所原帶句數及句股較數並爲句所除而減去其一卽減去除過之句也用減余爲法卽是用其除過之句股較爲法也】故亦不用句股形之倍積而用其除過之倍積爲實【倍卽是句股相乘之數若以句除之必仍得股今徑以股數受除卽是用其除過之倍積爲實也】法實並爲除過之數則其理相同而得數亦同矣

以上補第一條之例

設甲丁戊形甲丁股【廿八】丁戊句【廿一】甲戊【三十五】欲截甲

丁股於乙截甲戊於丙而令所截

之乙丁與乙丙等問其數若干

答曰乙丁一十二

法以甲丁股【二十八】丁戊句【二十一】相乘得【五百八十八】爲實並句股得和【四十九】爲法除之得【一十二】爲所截乙丁與乙丙截句等

如鮑法以句【二十一】除股【二十八】得一【又三之一】又外加一數共二【又三之一】爲法【通作七】用以除股二十八【通作八十四】亦得【十二】爲乙丁截股

設甲丁股【三百四十五】丁戊句【一百八十四】甲戊【三百九十一】欲截乙丁與乙丙等該若干答曰一百二十

法以句【一百八十四】股【三百四十五】相乘得【六萬三千四百八十】爲實句股和【五百二十九】爲法除之得所截乙丁【一百二十】與截句乙丙等

或以句【一百八十四】除股【三百四十五】得一【又八之七】又外加一共二【又八之七】通作【二十三】爲法以股【三百四十五】通作【二千七百六十】爲實法除實亦得【一百二十】爲乙丁截股

解兩法相同所以然之故蓋此是依句股形正角作方形於內【卽句股容方】也本法以句股和爲法除句股形倍積【卽句股相乘】今不用句股和本數而用其除過之句股和爲法【股被句除旣變爲除過之股而得數中之一其本數皆與句同今於得數又加一是又加一除過之句合之則共爲除過之句股和矣】故卽用股爲實以當除過之倍積法與實並爲除過之數則其理相同而得數亦同矣以上補第二條之例

按數度衍有在逺測正方形之算立破句名色不穏圖亦不眞今於此第一例中生二法補之

分角綫至對邊【亦系鮑法】

甲乙丙句股形今平分乙方角作乙丁綫至對邊欲知丁防之所在

法曰先依句股求方求得己丁戊乙正方形

次用丁戊丙形或丁己甲形求得丁丙或甲丁卽得

甲乙丙句股形今平分乙鋭角作綫至甲丙股欲知丁防所在

法以甲丙股乙丙句相乘得丙庚長方亦卽乙辛長斜

方其辛戊小長斜方又卽戊壬長斜

方取甲子癸小句股形補壬寅丑虛

句股形成甲寅長方此卽句股相乘

實以句和除之也【甲乙爲乙壬卽句】得壬寅邊

丙甲辛句股形中【卽甲乙丙原設形】作甲卯垂綫至丙辛【法另具】於是一率甲卯二率甲辛三率甲子四率甲癸【卽丁己】成丁己乙戊四斜方形

次用丁戊丙形或丁己甲形依句求股求得丁丙或丁甲卽得

按上鮑法此寅甲長方爲句和除句股形倍積所得壬寅邊必小於句股容方之邊其內容丁己乙戊四斜方形之丁己邊又必大於句股容方之邊二者之間可以得容方邊矣【容方邊除倍積得句股和以減句和得股較卽其他可知】

求丁己綫法一率甲丙股二率甲乙三率壬寅四率丁己【卽壬丑】

甲乙丙鋭角形求分乙角作綫至甲丙邊之丁防

法於形中求得辰丙垂綫【丙辛甲形卽甲乙丙

形故其垂綫等】用丙長綫乘乙丙所得卽辛

乙長斜方形自此以下至成丁己乙

戊四斜方【並同前法】

次用比例法一率甲乙二率甲丙三率丁戊四率得丁丙

或一率甲乙二率甲丙三率甲己四率甲丁甲乙丙鈍角形法先從形外求得甲辰外垂綫引乙丙綫與之相遇次以甲辰垂綫乘乙丙得乙辛長

斜方形餘同前法

甲乙丙鈍角形甲辰垂綫在形外

與右圖同法

鼎按若依幾何六卷三題法甚防

句股容員

甲乙丙句股形求容員徑卯戌【卽丁辛】

法於甲丙上截丁丙如句【乙丙】又截甲辛如股【乙甲】因得丁辛卽容員之徑

試依所截丁丙爲句作戊丁丙句股形【自丁作之垂綫至戊又引乙丙句遇於戊卽成此形】又依所截甲辛爲股作甲辛氐句股形【自辛作之垂綫長出至氐引甲乙股遇於氐】又作戊戌房句股形【引戊丁股至房如之度自房作垂綫至戌卽成】乃自甲自戊各爲分角綫遇於己成十字則己卽容員心也又引十字綫透出而以甲己爲度截之於癸於女乃自癸作綫與丙戊平行至辰又自女作

辛氐及房戊之垂綫穿而

過之與癸辰綫遇於辰又

引氐辛綫至癸引房戌綫

至女得女辰女房癸辰癸

氐四綫皆如甲丙女卯

女亢癸丑癸未四綫皆如

甲乙股卯辰房亢丑氐辰未四綫皆如乙丙句又成女卯辰女亢房癸未辰癸丑氐四句股形共八句股形縱橫相疊並以容員心己防爲心此同心八句股形各綫相交成正方形二其一卯戌丑乙形依原形之句股而立其乙方角卽原形之所有也其一丁辛亢未形依原形之而立卽所謂和較也此兩形者皆相等而其方邊並與容員徑等卽容員徑上之方冪也

然則何以又爲和較試卽以原論之甲丙上所截之丁丙卽句也甲辛卽股也句股相並卽重疊此丁辛一邊是句股和多於之數古人以和較爲容員徑蓋謂此也八句股形卽有相等之八每一上各有此重疊之綫以成兩四方形相等之八邊可以觀矣【因鮑圖攺作之彼原有八角形外小句股形輳成一等面八角形之論但圖欠明顯】

相似兩句股並求簡法

假如癸辛己大形癸壬乙小形其癸角等則爲相似之兩句股形今欲求兩形之兩句合綫【兩句者一爲己辛大句一爲壬乙小句卽辛甲也則己甲爲兩句合綫】

法以兩【一癸己大一癸乙小】並之爲三率以癸角之正【兩癸

角等只用其一】爲二率二三相

乘爲實半徑全數爲法

實如法而一得四率己

甲卽【己辛壬乙】兩句之合

數

何以知之曰試引癸己

至丁截己丁如癸乙則丁癸卽兩合數也乃以癸角之正乘之半徑【全】除之卽得丁丙而丁戊卽壬乙【以己丁卽癸乙也亦卽甲辛】戊丙卽己辛【同在直綫限內也】則所得丁丙亦卽己甲矣

有句股和有求句求股【量法】乙甲句股和丙甲

原法以甲爲心作乙己卯

象限又以丙甲半之

於丁以丁爲心作甲戊丙

半圓

次於丙戊半員上任以辛爲心丙爲界作丙己小員屢試之令小員正切象限如己乃作己辛甲及辛丙二綫則辛丙爲句辛甲爲股如所求按此法不誤但己防正切處難眞今別立法求己防

法曰自丁防作垂綫分半圓於戊以戊爲心用丙爲界作丙己庚丑甲全員全員與象限相割於己從己向甲作直綫割半員於辛乃作辛丙爲句卽辛甲爲股合問如此則徑得辛防不用屢試得數旣易且眞確矣論曰凡平員內作兩通至員徑兩端必爲句股而員徑常爲今旣以丙甲爲半員徑則其辛丙與辛甲兩通必句與股也而己辛甲綫與乙甲等卽句股和也今以辛爲心作小員而其邊正切己則己辛與丙辛等爲小員之半徑卽等爲句綫矣於己甲句股和內截己辛爲句則辛甲必爲股故此法不誤也

又論曰半員內所容句股形以半方形爲最大【卽甲戊丙也其餘皆半長方形之句股故小】其句股和亦最大【丙戊句甲戊股相等其和甲戊庚爲最大其餘股長者句反甚小故其和皆小於甲戊庚】卽上方冪之斜徑也【甲未庚丙爲上平方冪甲戊庚爲其斜徑】以此爲象限之半徑【如辰庚亥象限其半徑辰甲及亥甲並與庚戊甲等】則能容上平方【如甲未庚丙平方必在辰庚亥象限內】又戊心所作平方外切之平圓亦能容上平方【此員以戊爲心以平方四角爲界其全徑甲戊庚卽平方之斜徑也】三者相切於庚防惟相切不相割其餘句股和並小【如乙甲和必小於辰丙】不能包平方之角卽不能外切平員而與之相割矣【如乙甲和爲半徑作乙己卯象限不能包庚防卽與平員相割如己】其自庚至丙並可爲相割之己防而四十五度之句股具焉【八綫表所列之句股只四十五度互相爲正餘句爲正股卽余也分言正則初度小而九十度最大也若合正余爲和數則初度與九十度皆最小惟四十五度最大】己足以盡句股之變態矣【若過庚向末亦四十五度己防至此其和數反小而與前四十五度爲正余】句股和之最大者以略小於上斜綫而止【凡句股有和有較皆長方形之半非正半方也若半方形則有和無較可無用算非句股所設】其最小者以稍大於綫而止【若同綫卽無句股】無有不割平圓故可以己防取之也

又論曰以方斜爲半徑作象限則能容平方以方斜爲半徑作半圓則能容方斜上平圓【如庚己丙甲未平圓其徑甲戊庚方斜是卽方斜上之平圓也若以甲戊庚半徑作大半圓卽能容之】凡半圓內所容之圓度每以兩度當外周半圓之一度何則論度必以角惟在心之角一度爲一度若在邊之角則兩度爲一度【如辰庚亥半圓從甲心出兩綫一至庚一至辰作辰甲庚角其度辰庚四十五度是一度爲一度也若庚己丙甲未圓從甲邊出兩綫一遇戊至庚一至丙作庚甲丙角其度庚己丙象限只作四十五度是兩度當一度以同用甲角故也】凖此論之則上半圓所作之戊甲丙角亦必四十五度矣【旣同用甲角則戊辛丙象限亦兩度當一度】若是則庚己丙之度與

戊辛丙等【並同用甲角以庚辰爲度故也】而

己防所割之己丙弧及辛丙

弧亦必等度矣【己丙爲方外切員之度辛

丙爲方內切員之度大小不同而同用甲角以己乙爲其

度角等者度亦等】

又引辛丙至寅則寅丑甲與辛戊甲兩弧亦必等度【以同用丙角故也】而同爲甲角之餘【丙角原爲甲角之餘乃甲角減象限是以己甲乙減象限得己甲卯角與辛丙甲角等也其度則兩度爲一度乃甲角之倍度減半周是以寅庚減半周得寅丑甲以丙辛弧減半周得辛戊甲也】又己庚丑未弧原爲己丙減半周之餘卽與寅丑甲等於此兩弧內各減寅丑未則己庚寅與未癸甲亦等於是作己寅綫與未甲等亦卽與丙甲等而寅己丙與甲丙己又等【於寅己及甲己各加一己丙】則丙辛寅及己辛甲兩直綫亦等【皆句股和也】兩和綫相交於辛則交角等【皆十字正角】

又作己丙綫成己辛丙三角形而己角丙角等【己甲丙三角形與己寅丙等則對丙甲之己角對己寅之丙角亦等】則角所對己辛邊丙辛邊亦等矣凖上論己辛與丙辛必等故用己防以求辛防而和數中句股可分也

又論曰凡句股和所作象限與斜方上平員相割有二防其一爲己其一爲醜自醜作直綫至甲心【象限心也】割半員於壬作丙壬綫卽成丙壬甲句股形與甲辛丙等【丑甲丙角爲丙甲壬角之餘與壬丙甲角等而其度丑卯與己乙等是丙甲辛角與壬丙甲等也辛壬又皆正角又同以丙甲爲是兩句股形等也】凖此論之凡半員內所作句股皆兩兩相似【句股之正角必負員周亦兩兩相對如辛防在戊丙象限內卽有壬防在戊甲象限與之相對皆與象限上己防丑相應其所作句股形亦兩相似】故四十五度能盡句股之變也【戊丙與戊甲兩象限並兩度當一度其眞度在庚辰及庚亥兩半象限中故皆四十五度】試以壬爲心醜爲界作員界必過丙是丙壬股卽醜壬而丑甲爲和也丑壬股大於戊丙而丑甲和小於庚甲以是知和數之大至庚甲而極也

凖上論又足以證己庚丑癸員能盡割員句股之理

句股和較

與句股較【相和卽加句卽減股卽內減存較和股和句較句股較相較卽減句卽加股卽用減存較較股較句和句股較】

與句股和【相和卽減卽減股卽減句卽和和句股和句和股和相較卽加句加股加句較股和較較卽股較卽句較卽】

與句較相和

【加句卽減句卽兩減卽兩

句較

句較】

相較【卽句】

句與股較【相和卽加句股

減股加句較減句較和較卽

較卽句股較卽股相較卽加句股較股加股加句股較股句較較較卽股

較卽句較較卽】

句與股和【相和卽減卽減股卽減句卽句和和句股和句和股和

相較卽減股卽減卽加句卽句和較句較句股較股和】

句與句股較【相和卽股】

相較

【加句股加兩句股較卽句較卽股】

句與句股和相和

相較【卽減股卽加股卽兩股兩句

句股和】

句與句較相和【卽】

相較【加句加兩句較卽句較卽】

句與句和相和

相較【卽】

句股較句較【相較卽股較】

句股較股較【相較卽句和內減兩句又兩股較

相和卽股

相和卽和內減兩句

句較】

句較股較【相較卽句股較】

【相和卽兩內減一句一股】

句股和句和【相較卽股較】

句股和股和【相較卽句較

相和卽兩句

相和卽兩股一股一

一句一】

句和股和【相較卽句股較】

【相和卽兩一句一股】

句股較與【句股】和【相和卽兩股】句股較與【句】和【相和卽股和】句股較與股和相和

【相較卽

相較卽兩句

句和】

句較句和【相和卽兩】句較與【句股】和【相和卽股和】句較與股和相和

【相較卽兩句】

相較

【相較卽句股和】

和較和和【相和半之爲句股和】和較較和【相和半之爲股

相較半

相較半之之爲

爲句較】

和較較較【相和半之爲句】

和較句較和【相和半之爲句

相較半之

相較半之爲股較

爲股較】

和較句和較【相和半之爲句】

和較句較較【相和半之仍爲和較

相較半之爲股較】

相較卽減盡

和和較和【相和半之爲股和】和和較較【相和半之爲句和

相較半之爲句】

相較【半之爲股】

和和句較和【相和半之爲句和】和和句和較【相和半之卽股和

相較半之爲股】

相較【半之爲句】

和和句較較【相和半之卽句股和】較和較較【相和半之爲

相較半

相較半之之爲

爲句股較】

較和句較和【相和半之爲】

較和句和較【相和半之爲股與句較或與句股較】

【相較半之爲句股較】

相較恰盡

較和句較較【相和半之爲股】

較較句較和【相和半之爲句與股較

相較半之爲句較】

相較恰盡

較較句和較【相和半之爲】

較較句較較【相和半之爲句

相較半之

相較半之爲句股較

爲股較】

句較和句和較【相和半之爲】句較和句較較【相和半之爲句

相較半之

相較半之爲句股較

爲股較】

句和較句較較【相和半之爲股】

【相較半之爲句較】

歷算全書卷四十七

欽定四庫全書

歷算全書卷四十八

宣城梅文鼎撰

句股闡微卷三

句股法解幾何原本之根

句股羃與羃相等圖

甲乙丙句股形乙辛大方爲羃羃內兼有句股二羃

論曰試於羃作對角之乙

子綫與甲丙股平行而等又

作丙丁對角綫與甲乙句平

行與乙子綫遇於子成十字

正角則丙子與甲乙句相等

成乙子丙句股形與甲乙丙句股形等又作辛癸及庚戊兩綫皆與丙丁等亦與乙子等而皆與甲丙股等又辛丁及癸庚及戊乙皆與丙子等卽皆與甲乙句等則冪內所作四句股形皆與原設句股形等於是以丙丁辛形移作乙壬庚以癸庚辛形移作甲乙丙成甲丙

丁癸庚壬磬折形末引丁癸

至巳截成大小二方形則丙

巳方形卽股冪癸壬小方卽

句冪也

若先有丙巳股冪癸壬句冪

則聯爲磬折形而移乙壬庚

句股補於丙丁辛之位移甲乙丙句股補於癸庚辛之位卽復成乙辛大方而爲冪

又法

甲乙丙句股形乙丙其冪乙戊丁丙

甲丙股其冪甲壬辛丙甲乙句其冪乙庚癸甲法於原形之甲正角作十字綫分冪爲兩長方【一爲丑子丁丙】凖股冪【一爲丑子戊乙】凖句冪又引之至己又自庚癸自壬辛並引之至巳而成方角

次移甲醜丙句股補巳子丁虛形又移巳壬甲句股補丁辛丙虛形卽成股冪而與丑子丁丙長方等積又移甲醜乙句股補己子戊虛形再移己卯戊句股補戊癸寅虛形又移戊卯甲癸形補癸寅乙庚虛形卽成句冪而與丑子戊乙等積

解幾何二卷第五題第六題

甲丙爲丁丙爲句

丁甲句和乙丁句

較【丁甲同丁壬甲癸並同】

庚辛戊己冪也己句

冪也戊庚辛較乘和之

長方冪也

移戊補戊移庚辛補庚辛而冪內淨多一己形卽句冪也故冪內有和較相乘之長方又有句冪也論曰凡大小方形相減則其餘必爲兩形邊和較相乘之長方是故己形者句自乘之小方也戊庚辛句較乘句和之長方也合之成戊庚辛巳形卽自乘之大方矣

幾何二卷第五題以倍爲甲乙原綫以甲丙爲平分之綫以甲丁和乙丁較爲任分之兩綫以丁丙句爲分內綫其理一也

第六題以子丁倍句爲原綫以丁丙句爲平分綫以句較乙丁【卽子甲】爲引增綫以丁甲句和爲全綫其理亦同

以數明之甲丙八丁丙句五乙丁較三丁甲和十三和較相乘三十九句自乘二十五以句冪加和較長方共六十四與甲丙冪等

又論曰用股和較亦同

解幾何二卷第七題

甲丁股冪【卽甲乙元綫上方】子戊

句冪【卽甲乙方內所作已辛方乃任分綫甲丙

上方也】並之成癸寅冪【卽所

謂兩直角方形並也】

冪內有戊甲股【卽甲乙原綫】戊癸句【卽任分之甲丙綫】相乘長

方形二【卽己甲長方及丁辛長方亦卽甲乙偕甲丙矩形二也】及句股較乙丙上方一【卽壬丙小方亦卽所謂分余綫上方也】

何以明之曰試於戊癸綫引長至醜令醜癸如已丁較【卽乙丙】遂作子丑小長方【與丁庚等】以益亥癸成亥丑長方【與丁辛等亦與已甲等】

次於癸寅內作甲酉寅辰午未癸卯四綫皆與甲乙股等自然有甲卯寅酉午辰癸未四綫皆與戊癸句等又自有未卯卯酉等句股較與乙丙較等卽顯

冪內有句股形四較冪一也

試於鼏內移午辰寅句股補癸戊甲之位成戊卯長方【與己甲等】又移癸未午句股補甲戌寅之位成戌酉長方【與亥丑等】而較冪未酉小方元與壬丙等又子丑小長方元與丁庚等

合而觀之豈非丁甲股冪及子戊句冪並卽與己甲亥丑兩長方及壬丙小方等積乎

解幾何二卷第八題

庚甲乙句股形取丁乙如

庚甲句則丁甲爲句股和

和之冪爲丁己大方【卽元綫甲乙偕

初分綫上直角方也】於大方周綫取戊

丑己子皆與庚甲句等卽醜

丁戊子己庚皆與甲乙股等【卽甲乙元綫也句綫則初分綫】

次作醜癸庚辛乙壬子卯四綫皆與外周四股綫平行而等

自有丑壬子癸庚卯乙辛四綫皆與外周四句綫平行而等

又有壬癸癸卯卯辛辛壬四句股較綫自相等【卽分余綫也】丁已和冪內有長方形四皆句乘股之積【卽元綫偕初分綫矩內形四也】又有句股較自乘冪一卽分余綫上方形也

解幾何二卷第九題

甲丙爲股丁丙爲句

丁甲句股和乙丁句股

較壬庚爲句冪辛丙

爲股冪醜丁較冪丁

癸和冪戊巳綫上方爲

句冪之倍戊甲上方爲

斜綫上方倍於元方圖

股冪之倍並和較冪倍大於句冪股冪之並古法倍冪內減句股和冪開方得較若減較冪亦開方得和卽其理也

論曰己丁較上方與丁

甲和上方並之卽己甲

上方也戊巳綫上方與

戊甲綫上方並亦卽巳

甲上方也而戊巳爲句冪斜綫戊甲爲股冪斜綫凡斜綫上方形倍於原方故較冪並和冪亦倍大於句冪股冪之並也而句冪股冪並之卽冪古人所以用倍冪也

此第十題與前題同法甲

丙卽句丁丙卽股丁甲

全綫卽和丁乙引增綫卽

較

準前論丁庚【卽丁乙】較上方冪與丁甲和上方冪並成庚甲綫上冪而庚甲冪內原兼有丙丁股【卽巳戊亦卽己庚】及丙甲句二冪【己壬爲股冪辛丙爲句冪】之倍數【庚戊爲股斜綫其冪必倍於股冪戊甲爲句斜綫其冪必倍於句冪】故庚甲冪內能兼戊庚及戊甲二冪

丙丙綫皆也丙丙方冪

也甲丙之長者皆股也【亦卽丙丁

丁】甲丙之短者皆句也【亦卽丙丁】丁丁綫句股較也丁丁小方

較冪也甲丙甲句股和也甲甲大方和冪也

丁甲長方皆句股相乘卽倍句股形積也

合而觀之則冪內有句股積四及較冪一也和冪內有句股積八及較冪一也若倍冪則有句股積八及較冪二也故以和冪減倍冪得較冪若以較冪減之亦得和冪矣

以句股法解理分中末綫之根

卽幾何二卷第十一題六卷第三十題四卷第十第十一題

古法句較

癸庚其鼏庚乙丙癸

乘句和開

句其鼏丙戊

方得股之圖

引庚甲至壬使甲壬如丙

癸句則庚壬爲句和丙庚

原爲句較以較乘和成

丙壬長方長方內截甲丁

小長方與戊辛等其餘庚辛

合而觀之是鼏內兼有句較乘和之積及句鼏也

夫鼏內原有句股二鼏而今以句較乘和之積可代股鼏是句較乘和卽同股鼏也

句和及股

用法

及句較爲

有句和有句較

連比例圖

求股法以較乘和開方得股

或有股有句和求句求

法以股自乘爲實以句

和除之得較以較減和

半之得句句加較得若

先有較以除股鼏亦得和矣

如圖丙戊丁句股形丙丁與丁乙等【亦與丁庚等】丁戊句亥戊爲倍句乙戊爲句較與庚亥等戊庚爲句和與亥乙等

亥巳爲句股和乘句較之

積與戊癸等

丙戊股其方鼏甲丙

準前論甲丙方與亥巳長方

等積【戊癸亦同】則庚戊和與丙戊股若丙戊股與戊乙較也一句和庚戊

二股

丙戊

三股

丙戊

四句較戊乙

以戊乙較減亥乙和余亥戊倍句折半爲句【丁戊或丁亥】或戊乙較與丙戊股若丙戊股與庚戊和也

一句股較戊乙

二股

丙戊

三股

丙戊

四句股和庚戊

又論曰以二圖合觀之凡倍句加句較卽句和以倍句減句和余卽句較

此不論句小股大如前圖或句大股小如後圖並同此可以明倍句與句較必爲句和之兩分綫故以句和爲全綫則其內兼有倍句及句較之兩綫矣但倍句有時而大於較有時而小於較故不能自爲

連比例而必借股以通之

今於句和全綫內取倍句如股則先以股綫爲和較之中率者今以如股之倍句當之而倍句原系句和全綫之大分於是和與倍句之比例若倍句與較亦卽爲全與大分若大分與小分此理分中末綫所由出也下文詳之

丙戊綫上取理分中末綫

先以丙戊綫命爲股以丙戊折半成丁戊命爲句取丙丁與丁乙等則戊乙爲句較

變股爲倍句成

亥戊倍句與丙戊股等以理分中末綫圖

加較成亥乙卽句和

亥巳爲和較相乘積與丙亥

股鼏等【丙亥爲丙戊股之方卽爲亥戊倍句之方】準前論亥乙和與丙戊股

若丙戊股與戊乙較

今亥戊卽丙戊則又爲亥乙

和與亥戊倍句若亥戊倍句與戊乙較也

夫亥乙者全綫也亥戊其大分戊乙其小分也合之則是全綫與其大分若大分與其小分

論曰此以丙戊股綫爲理分中末之大分而求得其全綫亥乙與其小分戊乙也而大分與小分之比例原若

理分中末綫

全綫與大分故卽可以丙戊

比例圖

大分爲全綫而以小分戊子

【卽戊乙也】爲大分則子丙自爲小

分矣

以亥乙爲全綫【亥戊大分卽丙戊亦卽乙】

【甲戊乙小分卽戊子】

亥乙與乙甲【卽亥戊大分】若亥戊與子戊也【卽亥戊與戊乙】

理分中末綫

此用亥乙甲大句股比亥戊

相生不窮圖

子小句股

若丙戊爲全綫

則又戊子爲大分【亦卽子巳】子丙

爲小分【亦卽巳甲】爲亥戊與戊子

【卽丙戊與戊子】若子巳與巳甲也【卽子戊與子丙】

此用亥戊子大句股比子巳甲小句股

亥戊與戊乙若戊子與子丙又相視之理也

又若子巳爲全綫

則子庚又爲大分庚巳又爲小分

其法但於大分子巳內截取子庚如小分丙子作丙庚小方則戊子【卽子巳】與子丙若子庚與庚巳

似此推之可至無窮

解幾何三卷第二十七題

甲乙丙句股形以乙丙句

折半於巳作已戊綫與股

平行平分甲丙於戊又

作戊庚綫與句平行平分甲

乙股於庚成巳庚長方此卽半句乘半股爲句股積之半也

凡句股形內依正角作長方惟此爲大若於形內別作長方皆小【皆不及句股半積也】

今仍作卯丁形則小於巳庚何以知之曰試作醜戊綫與丙巳半句平行而等又作醜丙綫與戊巳半股平行而等又引壬辰至寅引壬卯至午卽顯壬醜形與壬巳形等又乙辰原與巳寅等則以巳寅加壬丑而成丑午壬辰巳之磬折形卽亦與卯丁形等矣夫磬折形在丑巳方形內而缺午辰之一角卽相同磬折之卯丁形以較已庚半積方形亦缺戊未之一角也蓋丑巳等巳庚而所缺之午辰小方亦等戊未也準此言之卽凡作長方於丙戊界內者皆小於巳庚半積形也

又作子癸形則亦小於巳庚何以知之曰試作戊乙對角綫引之至酉卽顯癸未形與卯未形等卽卯丁形與子癸形亦等而其小於巳庚形爲所缺之戊未小方亦等矣準此言之卽凡作長方於甲戊界內者皆小於巳庚半積形也

又知句股內容方之積亦皆小於半積惟句股相等如半方者容方卽爲半積

論曰此磬折形依綫而成蓋卽幾何所謂有闕依形也所闕之小方午辰及戊未皆與丑巳形相似而體勢等以有綫爲之對角也然以句股解之殊簡

又論曰若壬角在綫上去戊角更逺則所缺之午辰小方亦更大而其形皆相似而體勢等辛角亦然

解幾何三卷三十五題

甲丙乙句股形以

甲乙爲半徑作員

則甲丙股爲正

丙乙句爲余

己丙矢爲句較丁

丙大矢爲句和

依句股法較乘和開方得甲丙股而丙戊亦甲丙也故甲丙乘丙戊與巳丙乘丁丙等積也

幾何三卷第三十五題言員內兩綫相交則其各分之綫相乘等積卽此理也

巳丁過員心綫

有庚壬斜綫相交

於丙【分丙巳及丙丁又丙庚及

丙壬】皆分爲兩法自

員心乙作十字綫

至辛平分庚壬爲兩【辛庚辛壬】皆斜綫之半

辛庚半綫內又分辛丙爲小綫

以辛丙減辛庚余庚丙爲較以辛丙加辛壬成丙壬爲和

以大小二方相較之理言之庚辛方內有庚丙較乘丙壬和之積及辛丙方

乙辛庚句股形以乙庚爲冪內兼有庚辛及乙辛句股二冪卽兼有庚丙乘丙壬之積及辛丙乙辛二方也又乙辛丙小句股形以乙丙爲則乙丙方內兼有辛乙辛丙二方而甲丙乙句股形以同庚乙之甲乙爲冪內兼有甲丙及乙丙二方此兩者旣等其冪必等而其所兼之辛丙乙辛二方又與乙丙方等則各減等率而其所餘之庚丙乘丙壬積亦必與甲丙方等矣

而已丙乘丙丁原與甲丙方等則巳丙乘丙丁亦必與庚丙乘丙壬等矣

辛戊綫庚壬綫

相交於丙則戊丙

乘丙辛與庚丙乘

丙壬亦等

何以知之曰試作

一丁巳過心綫與

兩綫交於丙凖前論戊丙乘丙辛之積及庚丙乘丙壬之積皆能與丁丙乘乙丙之積等則亦必自相等矣

丁巳員徑有

庚壬斜綫相交

於丙則庚丙乘

丙壬與巳丙乘

丙丁等

如法作乙辛及

乙庚綫成乙辛庚句股又成乙辛丙小句股以丙辛句減庚辛句余庚丙爲較以同丙辛句之辛戊加庚辛句成庚戊爲和【卽丙壬】

又以乙丙【卽乙子亦卽乙癸】減庚乙餘子庚爲較又兩相加成庚癸爲和【卽子丑】以庚子較乘庚癸和與庚丙較乘丙壬和之積必等【詳後條】而巳丙卽庚子丙丁卽子丑【亦卽庚癸】故巳丙乘丙丁與庚丙乘丙壬亦等

又大小方相減之理庚乙方內兼有庚子乘庚癸之積及乙子方卽如兼有庚丙乘丙壬之積及乙丙方也【乙丙卽乙子】

而同庚乙之甲乙冪內原兼有甲丙方及乙丙方此庚乙甲乙兩積內各減去乙丙方則所存者一爲庚丙乘丙壬之積一爲甲丙自乘積此所餘兩積亦必相同可知矣

又巳丙乘丙丁之積原與甲丙方等則亦與庚丙乘丙壬等矣

先解兩方相減

寅辛大方內減子巳小方【寅辰爲兩方邊之較卯辰爲兩方之和卽子辛】法以小方邊【乙子】爲度於大方邊截取【乙長乙戊】作辰午綫及

戊未綫成辰戊

小方與巳子等

爲減去之積其

余爲寅午長方

【卽二方較綫寅長乘大方邊之

積】及未辛長方

【卽較綫午未乘小方邊之積】

末取未辛長方移補丑卯之位成卯寅長方【卽較乘和之積】又庚甲大方內減己癸小方【丁辛爲兩方較已辛爲兩方和亦卽辛丙】如法作丁壬癸戌二綫減去丁癸小方與已癸等其餘辛壬壬癸兩長方又移癸壬爲丙壬成丁丙長方卽較乘和之積也

凖此論之凡大小二方相減其所餘者必皆爲較乘和之積

次解兩句股形相減凡兩句股同髙卽可相加減【謂股數同也】

乙庚辛句股內減乙庚丁句股則以丁庚句減辛庚句余【辛丁】爲兩句之較又以同【丁庚】之巳庚句加辛庚句成辛已爲兩句之和和乘較成丁丙長方

又以乙丁減辛乙余辛戊爲兩之較又兩相加成辛子爲兩之和【戊乙子乙並同丁乙】和乘較成卯寅長方

此兩長方者其積必等【無論乙爲正角或鈍角或鋭角並同】

何以明其然也曰依句股法乙辛上方兼有乙庚庚辛上二方又乙巳上方兼有乙庚庚巳上一方今旣以乙巳上方減乙辛上方則各所兼之乙庚方巳相同而減盡故乙辛上方之多於乙巳上方者卽是庚辛上方多於庚巳上方之數也

又所用者是兩分之乙庚辛句股及乙庚已句股【卽乙庚丁】故不論乙角銳鈍其法悉同也

解幾何三卷三十六三十七題

甲乙丙句股形以丙乙

句爲半徑作員則甲丙

股爲切綫甲乙爲割

綫

甲乙割綫內減丁乙半徑

則甲丁爲句較甲乙割綫加戊乙半徑成甲戊爲句和和較相乘平方開之得甲丙股

幾何三卷第三十六題三十七題之理蓋出於此若割員綫不過乙心如甲庚則以他句股明之法自乙心向割員綫作乙巳爲十字正交綫則割綫之

在員內者平分爲兩【子巳巳庚】並爲員內綫子庚之半

又作乙子半徑成子巳乙

小句股則子乙小上方

冪兼有子巳小股乙巳小

句兩冪又甲庚總綫旣分於巳則甲巳大綫內減子巳小綫其餘甲子在員外者爲較以小綫巳庚加大綫甲巳成甲庚總爲和

凡大小二方相較則大方內兼有較乘和及小方之積

則是甲巳冪內必兼有甲

子乘甲庚之長方及子巳

方也

又甲巳乙亦句股形其甲

乙內原兼有甲巳及乙已句股二冪卽是兼有甲子乘甲庚之長方及子巳方與乙巳方也而子巳及巳乙二方原合之成一子乙方子乙卽丙乙也是合丙乙方與甲子成甲寅之長方而成甲乙方也

又甲丙乙句股形同以甲乙爲原合丙乙方與甲丙方而成甲乙方

兩形之甲乙方內各去其相等之丙乙方則其餘積一爲甲子乘甲寅之長方一爲甲丙自乘方是二者不得不等矣

用法

凡測平員形旣得甲丙切綫自乘爲實以甲丁之距爲法除之得甲戊之距以甲丁距減之得丁戊員徑

若欲測庚物之在員周者亦以甲丙切綫自乘爲實以甲子爲法除之卽得甲庚之距

又法用兩句股相加減

甲乙丙句股形以乙丙句爲半徑作員又以甲乙爲半徑作外員自外員任取甲防作過心員徑至戊又任作一不過心斜綫入內員至庚則以兩員

間距綫乘其全綫皆與

股冪等而亦自相等

如以甲丁乘甲戊或甲

壬乘甲庚其積皆等又

皆與甲丙切綫上方冪等

法以兩句股相加減

先自乙心作乙辛十字正綫平分壬庚綫於辛成乙辛甲句股

又作乙壬乙庚二綫成乙辛壬小句股與乙辛庚等法以辛壬與甲辛相減餘甲壬爲兩句之較

又相加成甲庚全綫爲兩句之和則以甲壬乘甲庚爲句之較乘和也

又以乙壬與甲乙相減餘甲丁爲兩之較

亦相加成甲戊全綫爲兩之和則以甲丁乘甲戊爲之較乘和也

此句與之和較相乘兩積必等

而甲丁乘甲戊原與甲丙自乘等【以甲丙乙句股言之也】故三積俱等

凖此論之凡自甲防任作多綫入內員其法並同不但此也但於外員周任作綫入內員亦同如於醜作醜戊綫則丑卯乘丑戊亦與甲丙冪等

何以知之曰試於丑作丑寅過心綫卽諸數並同甲戊矣而丑卯戊之於丑辰寅猶甲壬寅之於甲丁戊故也

簡法

庚壬斜綫交丁巳員徑於

丙如法作乙辛綫成

乙辛庚句股形及乙辛丙

小句股形

又以丙辛小句與辛庚大句相減得庚戊較又相加成庚丙和

再以乙丙小【卽乙癸亦卽乙子】與庚乙大相減得子庚較又相加成癸庚和

依大小兩句股相加減法庚戊較乘庚丙和與子庚較乘庚癸和同積

而壬丙原同庚戊又巳丙原同子庚而丁丙亦同癸庚則壬丙乘庚丙亦必與巳丙乘丁丙同積矣

又簡法

壬庚綫斜交已丁員徑於丙依法作乙辛又作乙壬綫成乙辛壬句股及乙辛丙小句股皆如前

今自庚別作一過乙心綫如

庚戊則乙辛庚與乙辛壬成

相同之兩句股卽顯壬丙爲

大小兩句之較而丙庚爲其

和

又顯戊癸爲兩之較而與巳丙等則巳丙亦較也又癸庚爲兩之和而與丙丁等則丙丁亦和也是故壬丙乘丙庚較乘和也已丙乘丙丁亦較乘和也而其積必等

歷算全書卷四十八

欽定四庫全書

歷算全書卷四十九

宣城梅文鼎撰

句股闡微卷四

幾何增解

方斜較求原方【幾何約論綫第十四條有用法今解其理】

甲乙丙丁正方形甲乙其對角綫戊乙爲方斜之較於戊乙上作庚癸乙戊小方則丙庚與庚戊等

論曰法於方之一角甲

作員而以丙甲方徑爲

員之半徑則乙丙爲切

員綫乙辛爲自員外割

員之全綫乙戊較爲割

員在外之餘綫而兩綫

皆出一防則乙戊乘乙

辛之矩形與乙丙切綫方形等

夫乙丙卽原設方也今以同乙戊之癸乙爲橫乙辛爲直作乙已長方【卽乙戊乘乙辛之矩】又移切甲己長方爲子甲長方又移卯補午移辰補酉移丑補寅則復成乙丙甲丁方形矣而丑卯午酉等斜剖半方形皆以乙戊較爲半方形之邊是庚戊及丙庚皆與乙戊等而亦自相等又何疑焉

用法有方斜之較乙戊求原方形之一邊法以乙戊較作小方形取其斜乙庚再引長之截丙庚如乙戊得乙丙如所求

從此圖生一測員之法假有員城八面開門正西門如戊門外有塔如乙其距如乙戊西南門如丙距塔若干步如乙丙問城徑

法以乙丙之距自乘得數爲實以乙戊之距爲法法除實得乙辛於乙辛內減去乙戊卽員城之徑防法但倍乙丙卽得城徑

有員城正西之門如戊西南之門如丙人立於庚可兩見之而庚丙與庚戊皆等問城徑

法以庚戊自乘成戊癸小方以方斜之法求其斜距爲乙庚以乙庚加庚丙爲乙丙卽城半徑

按此卽幾何約之用法也

又以句股法解之

又論曰試於庚丙上作丙子較綫上方引庚戊至丁則丁庚又爲丙子方之斜而丁戊與乙丙等從丁戊作丁壬甲戊爲元方如所求

又論曰此卽句和較相乘

開方得股也乙甲丁甲皆

如戊甲甲辛【甲丙甲壬】皆如

句乙戊如句較【丁丙同】乙辛如句和和較相乘

成癸辛長方開方得丁戊

股【乙丙同】

切綫角與員周角交互相應【幾何三卷三十二三十三增題】

乙丙丁三角形在員內有甲乙切員綫則所作丙乙甲

角與丙丁乙角同大又丁乙戊

角與丁丙乙角同大所謂交互

相應也

論曰丁角以乙丙弧分論度而

丙乙甲角亦以乙丙弧分之度爲度故丙乙甲角卽丁角也丙角以丁乙弧分爲度而丁乙戊角亦以丁乙弧分爲度故丁乙戊角卽丙角也凡用員周度爲角度皆以兩度爲一度詳後第三增題

若丁爲鈍角則丙乙甲亦鈍角兩鈍角同以丙辛乙弧爲度故也其丙銳角與丁乙戊銳角則同以丁乙弧爲

度

又增題員內三角形一角移

動則餘二角變而本角度分不

變交互相應之角度亦不變

如上圖【三圖】丁角移至辛則丙

角加大而相應之辛乙戊角亦

從之而大以辛丁乙弧大於丁

乙弧也辛乙戊大則辛乙丙小

矣其較皆爲丁辛弧若丁角𨿽移至辛而其度不變相應之丙乙甲角亦不變以所用之丙乙弧不變也又丙角移至壬則丁角加大相應之壬乙甲亦從之而大以壬丙乙弧大於丙乙弧也壬乙甲大則壬乙丁小矣其較皆爲丙壬弧若丙角𨿽移至壬其度不變相應之丁乙戊亦不變以所用之丁乙弧不變也

此圖同論但丁角移則丙角變

小丙角移亦然

又增題切員綫作角與員周弧度相應圖

有子甲戊員有乾艮綫相切於子從子防出綫與切綫作角必割員周之度其大小皆相應但皆以員周兩度當角之一度

如用子午正綫則所作兩防子角皆正角【百八十度分兩正角各皆九十度】而亦剖員爲半周【兩半員並百八十度】是兩度當一度又如用子辛綫作辛子艮鈍角【四十五度】而本綫割員周於辛爲九十度象限亦兩度當一度

又如用子辛綫作辛子幹鈍角形【百三十五度】而綫割辛午幹員分【爲二百七十度】三象限亦兩度當一度

又如於員內任作辛子乙角形乙辛子角所乘之子甲乙弧六十度幹子乙角同用子甲乙弧亦六十度然其實度是坎寅弧實只三十度亦兩當一也

又子乙辛角乘子癸壬辛弧【一象限】艮子辛角亦割子癸壬辛弧【一象限】然其實度爲震酉弧只四十五度亦兩當一也所以者何曰試作辛乙綫移角於辛則所乘弧【子甲

乙】六十度皆實度也今也

角在心是員周也非員心

也凡員周之角小於員心

一倍故也

論曰員周至員心正得員

徑之半故所作角爲折半

比例試作乙丙綫成辛乙

丙句股形又從心作心周

綫與辛乙平行則所作周心丙角與乙辛丙等而此心周綫平剖乙丙句亦平分乙周丙於周而正得其半矣系句股形平分綫作點從此作綫與股平行卽平分句綫爲兩

又論曰查角度之法皆以切點爲心作半員卽見眞度此不論半員大小或作於員內或作於員外並同作於員外其度開明易於簡查

又論曰試於所切圈心作橫徑綫與切綫平行如辛丙綫引長之出員外而以查角度之綫割員周而過之則皆成大小句股形而所過橫綫上防皆卽八綫中之切綫爲句股形之股角度斜綫爲橫綫所截處卽八綫中割綫常爲而切點至員心之半徑常爲句

如子辛角度綫割橫綫於辛成辛心子句股形其所當角度爲酉中四十五度則辛心卽四十五度之切綫辛子卽四十五度之割綫余並同其子心卽半徑也又論曰角度半員有大小而子心半徑常爲句者以所作橫綫在員心欲用員度相較也若於半員之端【如中如外】作橫綫與切綫平行其所作切綫割綫亦同比例而卽以各半員之半徑爲句矣

不但此也卽任於子心外直綫上任作一橫綫其所作句股並同但皆以十字交處距子防之度命爲半徑此八綫割員之法所由以立也

量無法四邊形防法

甲乙丙丁形求其容先作

乙丁對角綫分爲兩三角形

次自丙作丙戊橫綫與乙

丁綫相交於醜爲十字正角

而取戊防與甲齊平則戊醜卽甲庚也次以丙戊防折半於己次作壬癸綫與乙丁平行而等又作壬辛癸子二綫皆與己丙平行而等得辛癸長方卽原形之容

取平行綫簡法

法曰乙丙綫欲於甲防作

綫與之平行法於綫外任

取巳防爲心甲防爲界作

辛甲丁庚圈分次以庚爲

心取甲辛之度爲界截員分得丁防末自丁作戊丁甲綫此綫必與乙丙平行矣

論曰凡圈內兩直綫相距之度等則其綫必平行如【丁甲】與【庚辛】兩綫俱在一圈之內而所距之【甲辛】圈分與【庚丁】圈分等是相距之度等而其綫平行也因讀數度衍得此法似較他處爲防

補測量全義斜坡用切綫法【系勿庵補】

斜三角形有一角兩邊求余邊

法用切綫分外角求得余

角卽以得邊可不用垂綫

如甲乙己斜角形有乙

甲及己甲二邊有甲角求乙己邊

法以己甲綫引長之成乙甲丙角爲原有甲角之外角【以元有甲角減半周得】次分外角之度而半之爲半外角而求其切綫爲三率並乙甲己甲二邊爲首率又以二邊相較爲次率次率乘三率爲實首率爲法除之得半較角之切綫以查表得半較角之度以減半外角得己角末用正法得己乙邊法爲己角正與乙甲若甲角正與乙己

三率法

一兩綫之和

己丙

二兩綫之較

己丁

三半外角之切綫戊癸

四半較角之切綫壬戊

用外角者乙己兩角之和度而較角者乙己兩角之較度【以用切綫故半之也】

論曰又如後圖己甲引至丙而乙甲亦引至辛則乙甲丙及丁甲寅兩角皆原有甲角之外角再作甲戊綫平分外角則丁甲戊及寅甲戊皆半外角又作甲壬綫

與乙已平行則壬

甲癸角卽同己角

壬甲辛角卽同乙

角再於甲戊半徑

之端作癸戊辛十

字綫切員於戊則

戊癸及戊辛皆半外角之切綫也再以壬甲癸角減壬甲辛角其較爲壬甲子角則壬甲戊卽半較角而壬戊其切綫也

其比例爲己丙【二邊和】與己丁【二邊較】若癸辛【外角全切綫卽乙己丁角和度之全切】與壬子【較角度之全切綫】則亦若癸戊【半外角切綫】與壬戊【卽半較角之切綫】何也全與全若半與半也

理分中末綫

甲乙綫求作理分中末綫

法以甲乙全綫折半於庚乃

作垂綫於甲端爲丙甲如半

綫甲庚之度爲句全綫爲

股次作丙乙綫爲

次以丙爲心乙爲界作乙丁圈界次引丙甲句至丁則丙丁卽丙乙也末以甲爲心丁爲界作丁戊己圈分則甲己爲理分中末之大分己乙爲小分其比例爲甲乙與甲己若甲己與己乙也

逓加法借右圖以乙爲心甲爲界運規截丁已圈分於戊自戊作綫向甲成甲戊綫與甲丁等乃自戊作戊乙綫與乙甲等成甲乙戊三角形

此形甲戊兩角悉倍於乙角乃平分戊角作戊辛綫此綫與甲戊並大亦與乙辛同大成辛戊甲相似三角形則甲乙與乙辛【卽戊辛】若乙辛與辛甲也又平分辛角作

辛壬綫與壬戊與辛甲

皆同大則成甲辛壬三

角形與辛戊甲相似則

乙辛【卽戊辛亦卽戊甲】與辛甲

【卽辛壬戊壬】若辛甲與壬甲

也如此逓半則其角比例並同

一【乙甲】

二【乙戊卽戊辛戊甲】三【辛甲卽辛壬戊壬】四【辛癸卽壬癸壬甲】五【癸甲卽癸子壬子】六【癸丑卽丑子子甲】七【丑甲卽丑寅寅子】八【丑卯卽卯寅寅甲】九【卯甲】若能知其數則以大分逓乘全數除之得細數

先得甲乙爲大分而求乙己全分及

乙庚小分用此圖亦爲半圓內求

容方法則以乙巳全分加乙庚小分

折半於戊得戊己爲半徑若先得戊

己則以戊己【卽戊丁】爲作丁甲戊句股使戊甲句半於丁甲股則丁甲卽爲戊己理分中末之大分

解曰甲庚【卽乙己】全數與丁甲【大分】若丁甲【大分卽甲乙】與甲己小分【卽乙庚】也

以量分

甲乙綫十數求作理分中末綫

先依甲乙綫作甲乙丁丙正

方形【四面皆十數】次任用一面

平分之如甲丙平分於壬【甲壬

及壬丙皆五數】甲乙之半數也【甲丙與甲】

【乙等其分亦等】次自壬向乙角作乙壬斜綫其數一十一【一八○三三九】次自壬量甲壬或丙壬之度【卽甲乙之一半】移置於乙壬綫上截壬癸如甲壬則其餘癸乙卽理分中末之大分其數六【一八○三三九】末以癸乙之度移置於甲乙綫上如乙戊則乙戊爲大分戊甲爲小分其數三【八一九六六○】

簡法

作句股形令甲壬句如甲乙股之

半乃以壬爲心甲爲界作虛綫圓分

截乙壬於癸

末以乙爲心癸爲界作圓分截甲乙綫於戊

則乙戊爲大分甲戊爲小分

又簡法

以甲乙全綫爲半徑作半圓形則乙庚乙辛皆與甲乙等

次平分乙辛於己

次以己爲心庚爲界運規割甲乙

綫於戊【戊己之度卽同己庚】

則乙戊爲大分甲戊爲小分

又簡法

作子寅丑卯十字綫相交於乙

次以乙爲心甲爲界運規截十字

綫於甲於庚於辛則乙庚乙辛皆

與設綫甲乙等乃折半【乙辛】於己

以己爲心庚爲界運規截甲乙於戊則乙戊大分甲戊小分皆得矣此法可於平面圓器上求之

附長方變正方法

甲乙丙丁長方形欲變正方以長方形之橫邊【乙丙】直邊【丙丁】二綫取其中比例卽所求

取中比例法以丙丁乙丙【卽戊

丙】聯爲一直綫【丁戊】而折半於

己以己爲心丁若戊爲界作

半圓次引乙丙橫綫至圓界

截圓界於庚成丙庚綫卽乙

丙及丙丁二綫之中比例綫

次於丙庚綫上作小方形其容與甲乙丙丁長方形等如右圖丙庚綫上方形爲丙壬乃子壬癸句股形內之容方也而甲丙長方形則子壬癸句股外之餘方也余方與容方等積

簡法

先引丁丙邊至午引乙丙邊至

未次以丙角爲心乙爲界作小

員界虛綫截引長綫於戊

次以丁戊綫折半於己次引乙丙至未次以己爲心戊爲界運規作小圓界截引長綫於庚則丙庚卽所變方形之一邊末依丙庚綫作方形與甲乙丙丁長方形等積其法以丙爲心庚爲界運規截丙辛與丙庚等

理分中末綫用法

一用以分平圓爲十平分

法爲半徑與三十六度之分圓若全分與理分中末之大分也

一用以分平圓爲五平分

曆書言以全分爲股理分中末之大分爲句求其卽半徑全數爲股三十六度之分圓爲句求得七十二度之分圓爲

一用以量十二等面體

法爲立方邊與所容十二等面邊若理分中末之全分與其小分也又十二等面體之邊與內容立方邊若理分中末之大分與其全分也又立方內容十二等面體其內又容小立方則外立方與內立方若理分中末之全與其大分也

一用以量二十等面體

法爲立方邊與所容二十等面邊若理分中末之全與其大分也

一用以量圓燈

法爲圓燈邊與其自心至角綫若理分中末之大分與其全分也此自心至角之綫卽爲外切立方立圓及十二等面二十等面之半徑又爲內切八等面之半徑圓燈爲有法之形卽此可見

用理分中末綫說

言西學者以幾何爲第一義而傳只六卷其有所祕耶抑爲義理淵深翻譯不易而姑有所待耶測量全義言有法之體五其面其積皆等其大小相容相抱與球相似幾何十一十二十三十四卷諸題極論此理又幾何六卷言理分中末綫爲用甚廣量體所必需幾何十三卷諸題全賴之古人目爲神分綫又言理分中末綫求法見本卷三十題而與二卷十一題同理至二卷十一題則但云無數可解詳見九卷其義皆引而未發故𨿽有此綫莫適所用疑之者十餘年辛未嵗養病山阿遊心算學於量體諸法稍得窺其奧爰證曆書之誤數端於十二等面二十等面得理分中末之用及諸體相容之確數故以立方爲主其內容十二等面邊得理分綫之末二十等面邊得理分綫之中反覆推求了無凝滯始信幾何諸法可以理解而彼之祕爲神授及吾之屏爲異學皆非得其平也其理與法詳幾何補編

遙量平面法

甲乙庚辛爲

所欲量之平

面而不能到

如仰視殿

上承塵而人

在殿外又如峭壁懸崖之上有碑若碣凡平面之物人從地面斜視灼然可見而不能到

或平面在下如田池之類人從臺上俯視可見或臨深崖瞰谷底其理不異但倒用其圖卽是

欲量甲乙庚辛平面而不能到可到者丙丁則先知丙丁之距及丙丁所作各角卽可以知之

先求甲乙綫法於丙於丁各安平圓儀各以指尺向甲向乙又自相向各作角成甲丙丁甲丁乙乙丁丙凡三角形者三依第一法用甲丙丁形此形有丙丁綫【兩測之距】有丙角有丁角自有甲角可求甲丁綫法爲甲角之正與丙丁若丙角之正與甲丁也

次仍依第一法用乙丁丙形此形亦有丙丁綫【兩測之距】有丙角有丁角自有乙角可求乙丁綫

法爲乙角之正與丙丁若丙角之正與乙丁也【此丙角與前形之丙角不同】

次仍依第一法用甲丁乙形此形有甲丁乙丁兩綫及兩綫間所作之丁角【與前形丁角不同】可求甲乙綫爲所測之一邊法自甲角作甲戊垂綫至戊分乙丁綫爲兩而甲丁乙三角形分爲兩句股形其一甲戊丁句股形有丁角有甲丁綫爲可求甲戊句戊丁股

法爲全數與甲丁若丁角之正與甲戊句又全數與甲丁亦若丁角之餘與戊丁股也

其一甲戊乙句股形有甲戊句有乙戊股【戊丁減乙丁得之】可求甲乙

法以甲戊句乙戊股各自乘而並之開方得甲乙卽所測平面之一邊

第二求庚辛綫法亦於丙於丁各安平員儀【卽先所安之元處】各以指尺向庚向辛又自相向各作角成庚丙丁庚丁辛辛丙丁凡三角形亦三

依第一法用庚丙丁形此形有丙丁綫【兩測之距】有丙角有丁角自有庚角可求庚丁綫

法爲庚角之正與丙丁若丙角之正與庚丁也【此丙角與前兩丙角不同】

依上法用辛丙丁形此形有丙角【此丙角又與上不同】有丁角自有辛角可求辛丁綫【丁角與前不同】

法爲辛角之正與丙丁若丙角之正與辛丁也仍依上法用庚丁辛形此形有庚丁辛丁兩綫及兩綫間所作丁角【此丁角又不同】可求庚辛綫爲所測之又一邊法自庚角作庚己垂綫至己分辛丁綫爲兩而庚丁辛三角形分爲兩句股形

其一庚己丁句股形有丁角有庚丁綫爲可求庚己句己丁股

法爲全數與庚丁若丁角之正與庚己句亦若丁角之餘與己丁股也

其一庚己辛句股形有庚己句有辛己股【己丁減辛丁得之】可求庚辛

法以庚己句辛己股各自乘而並之開方得庚辛爲所測平面之又一邊【卽甲乙之對邊】

第三求甲庚綫

法於丁防側安平儀以指尺向甲向庚作甲丁庚角成甲丁庚形此形有甲丁庚丁兩綫及兩綫所作之丁角【此丁角在甲丁庚丁兩綫間】可求甲庚綫爲所測形之側邊

法自庚角作甲丁之垂綫至壬分甲丁綫爲兩而甲丁庚三角形分爲兩句股形

其一庚壬丁句股形有庚丁綫爲有丁角可求庚壬句壬丁股【法同前用丁角之正余】

其一庚壬甲句股形有庚壬句甲壬股【丁壬減甲丁得甲壬】依句股法可求甲庚綫爲所測平面之側邊

第四求乙辛綫

法亦於丁防側安平儀指尺向乙向辛作乙丁辛角成乙丁辛形此形有乙丁辛丁兩綫及兩綫所作之丁角此【丁角在辛丁乙丁兩綫間】可求乙辛綫爲所測形之又一側邊法自辛角作乙丁之垂綫至癸分乙丁綫爲兩而乙丁辛三角形分爲兩句股形

其一辛癸丁句股形有辛丁綫爲有丁角可求辛癸句癸丁股【法亦同前用丁角之正余】

其一辛癸乙句股形有辛癸句乙癸股【癸丁減乙丁得乙癸】依句股法可求乙辛綫爲所測平面之又一側邊

如此則所測形之四邊皆具乃用後法求其冪

第五求乙庚綫

法仍於丁防斜立平儀以指尺向乙向庚作乙丁庚角成乙丁庚形此形有庚丁乙丁兩綫及兩綫所作之丁角【此丁角又在乙丁庚丁兩綫間】可求乙庚綫爲所測形內之對角斜綫

乙庚丁角形內自庚角作乙丁之垂綫至卯分乙丁綫爲兩而乙庚丁三角形亦分爲兩句股形

其一庚卯丁句股形有庚丁綫爲有丁角可求庚卯句卯丁股【依上法用丁角之正余】

其一庚卯乙句股形有庚卯句有卯乙股【卯丁減乙丁得卯乙】依句股法可求乙庚綫爲所測平面形內對角之斜綫

旣有乙庚綫則所測甲乙辛庚平面形分爲兩三角形可以求其冪積

其一乙甲庚形有乙庚底有甲庚甲乙兩腰法以兩腰相減爲較相並爲和和乘較爲實乙庚底爲法除之得乙午以減乙庚得午庚半之得子庚乃用句股法以甲庚子庚各自乘相減爲實開方得甲子垂綫垂綫半之以乘乙庚底得乙甲庚形平積

其乙辛庚形有乙庚底有乙辛辛庚兩腰如上法以乙辛辛庚相減爲較又相並爲和和乘較爲實乙庚底爲法除之得乙辰爲底較以減乙庚得辰庚半之得醜庚乃用句股法以醜庚庚辛各自乘相減爲實開方得醜辛垂綫垂綫半之以乘乙庚底得乙辛庚形平積末以兩三角形積並之爲所測甲乙辛庚平面四不等形之總積

右法可以不用丈量而遙知畝步卽有種種異態以三角禦之足矣新法曆書言測量詳矣然未著斯法意者其在幾何后數卷中爲未譯之書歟

庚午蠟月旣望晤逺西安先生談及算數云量田可以不用履畝初聞之甚不以爲然歸而思之得此法然未知其所用者卽此與否而此法固己足用矣若用有縱衡細分之測器指尺一量卽得無煩布算矣

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷四十九﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷四十九﹥

測量用影差義疏

凡方形內從角剖成兩句股形必相似而等【正方或長方並同】

方形內作對角斜綫分爲兩句股又於斜綫上任取一防作直綫縱橫相交如十字而悉與方邊平行分方形爲大小四句股形此四句股形各兩兩相似而等【大形丙與丁等小形庚與辛等】

則其四句股旁之兩余方形𨿽不

相似而其容必等

解曰於原斜綫所分相等句股內

各減去相等之大小兩句股則其餘亦等【丙戊庚形內減去大形丙小形庚余戊又於丁己辛形內減去大形丁小形辛余己原形旣等所減又等則其餘必等故戊己兩長方𨿽不相似而其容必等也】

句股測逺

有甲乙之距人在戊立

表又立表於丁使戊丁

乙爲一直綫再於丙立

表使丙丁與乙戊如十字之半而與甲乙平行則丁戊小股與丙丁小句若丙庚大股與甲庚大句也

法以丙丁小句爲二率乙丁大股爲三率【卽丙庚】相乘爲實戊丁小股爲一率爲法法除實得大句甲庚再以庚乙加之得甲乙

假如丙丁兩表相距【三步】人在戊窺丁到乙逺【戊丁十二步丁乙十八步】欲求甲乙之距

法以丙丁【三步】乘乙丁【十八步】得【五十四步】爲實戊丁【十二步】爲法除之得【四十五步】爲甲庚加丙丁【三步卽乙庚】共四十八步爲甲乙

解曰此以乙丙長方形變爲丙癸也依前論乙丙實形丙癸虛形不相似而容積等故也

重測法

有巽乙甲井方池欲遙望測其甲乙之一面方並乙丁之距

法立表於丁望測方池之東北角乙至東南角巽使丁乙巽爲一直綫再於丁橫過立一表於丙使丙丁爲乙丁之橫立正綫【丙丁橫六步四分】次從丁退而北行至【戊】量得【十二步】從戊斜望池西北隅【甲】不能當【丙】表而出其間如【戌】又於戌立表【戌丁】之距【四步】再退而北行至【己】從【己】窺【甲】正過【丙】表己丙甲爲一直綫量得己丁之距【三十六步】

法以【丙丁六步四分】爲一率【丁己三十六步】爲二率【戊丁四步】爲三率二三相乘得【一百四十四步】爲實一率【六步四分】爲法除之得【二十二步半】爲辛己於辛己內減丁戊【十二步】余【十步半】爲壬己是爲景差

次以【戌丁四步】減【丙丁六步四分】余【丙戌二步四分】以戊丁【十二步】乘之得【二十八步八分】爲句實景差【十步半】爲法除句實得二步【八分弱】爲甲申大句之距加丙丁【六步四分卽申乙】得共【九步二分弱】爲甲乙卽方池一面之濶

次以辛己【二十二步半】減丁己【三十六步】余【十三步半】辛丁爲二率丁戊【十二步】爲三率相乘得【一百六十二步】爲股實景差【十步半】爲法除之得【十五步八分半弱】爲乙丁大股之距

解曰此以四表重測攺爲三表乃巧算也若測髙則重測本爲前後二表者亦攺用一表故當先知本法然後明其所以然下文詳之

試先明四表本法

有甲乙之濶先立【丁】表從戊測之戊【人目】丁【表】乙【逺物之末端】三者參相直次於【丁】表橫過與【甲乙】平行作戊丁乙直綫之橫直綫此綫上取戊立表人目從【戊】過【戌】表窺甲逺物之西端亦參相直但於戊丁乙綫爲斜成句股形量得戌丁兩表橫距【四步】丁戊【人目距東表】直距【十二步】

次於丁戊直綫退而北行至己又於西表戌作戌幹癸直綫與丁戊平行此平行綫內取癸立西後表人目從【己】過【癸】至甲參相直成己甲癸斜亦從【癸】橫行至【丁己】綫尋【辛】立東後表此後兩表【癸辛】之距爲前表【戌丁】等【四步】又量得【辛己】爲東後表距人目之數【辛丁二十二步半】次以丁戊【十二】減辛己【二十二半】得【十步半】爲壬己景差末以己辛【二十二半】減【己丁三十六】余【十三步半】爲前後表間之距以表橫距【四步】乘之得【五十四步】爲表間積【卽丁癸長方】置表間積爲實以景差【十步半】爲法除之得【五步一半弱】加表橫距【四步】

得共【九步二分弱】爲所測逺物甲乙之濶解曰前表測得成【戊乙甲】句股形內有戌乙余方與形外戌坤余方等積後表測得【己乙甲】句股形內有癸乙余方與形外酉癸余方等積於【癸乙】內減【戌乙】於【酉癸】內減【寅癸卽丑戌】則所餘之【癸丁】及【酉辰】兩余方亦必等積也故以【丁癸】變【辰酉】而得【辰寅】亦卽【甲庚】也

次明攺用三表之理

用三表者於【丙丁】兩表間增一【戌】表其實則於【戌丁】兩表外增一【丙】表也前增一表而無後表則無從而得景差故以三率法求而得之其實【癸辛】卽後表也其理與四表同

然不用【癸子】形而用【戌子】形何也曰準前論【辰酉】形與【丁癸】形等積而【午癸】形與【丁癸】形亦等積【兩余方在己丙丁句股形內外故等】則【酉辰】與【午癸】亦等積矣各減同用之【卯未】則所餘之【酉卯】與【卯癸】二形亦自相等積而【卯癸】原與【戌子】等故用【戌子】變爲【卯酉】而得【卯寅】卽得【甲申】矣是故【戌子】可名句實也

其以【辛丁】乘【戊丁】爲股實何也曰此三率法也【丁乙】外加【丁辛】前後兩測之表距故【辛壬卽戊丁】外亦加【壬己】兩測之景差法爲壬己與辛丁若戊丁與丁乙也凖此測髙可用一表而成兩測【卽借前測逺之圖而以橫爲直】

假如有【甲乙】髙立【丙丁】表人目在【戊】測之則表之端不相值而參相直於表之若干度如【戊】退若干步至【己】測之正對表端【丙】其法並同

因看數度衍中破勾測逺條疑其圖不眞因作此以證明其說

測量圖說

一測股六十四尺

八寸【壬丁】二測

句四十三尺二寸

【丙丁】三大股三

千六百八十五尺

二寸【乙丁卽丙午】四大

句二千四百五十

六尺八寸【甲午】加【午乙】

得二千五百尺爲甲乙之髙

解曰癸丁長方形卽古人所謂表間積也以景差壬辛【卽丑子】除之變爲寅子形是寅子與癸丁同積也而申癸形原與癸丁同積則寅子與申癸亦同積也於內各減同用之申子而寅未與未癸亦同積矣夫未癸卽氐己也是戊丁【卽亥己】乘丙己之積也故可命爲句實而以景差壬辛【卽申未】除之得甲午句也【甲午卽戌酉】其取股實何也曰三率法也表在丁其景丁戊後表在庚則其景庚壬後表之逺於前表者爲庚丁故後景之大於前景者爲辛壬則其比例爲辛壬與庚丁若丁戊【卽庚辛】與丁乙也

試引癸庚至箕截庚箕如庚壬又截尾箕如壬辛於尾於箕各作與庚乙平行綫而於乙作垂弧爲乙牛聯之作長方形又作丁心綫截之作箕乙綫斜分之則其理著矣

三角形求外切圓法

設如銳角形有甲丙邊七十五尺甲乙邊六十一尺

乙丙邊五十六尺問外切

圓徑若干畣曰外切圓半

徑三十八尺一寸二分五犛

法先求得甲丁中長綫六十

尺爲一率甲乙邊六十一尺

爲三率甲丙邊折半得戊甲三十七尺五寸爲三率二率與三率相乘一率除之得四率【三八一二五】爲甲乙圓半徑

解曰此甲丁乙三角形與甲己戊三角形同式故其綫爲相比例率也若甲爲鈍角其理亦同

以甲丙折半爲三率故四率亦爲半徑若以甲丙全綫爲三率則四率必得甲辛爲全徑矣蓋甲辛丙形與甲乙丁形同式也何以見甲乙丁形與甲辛丙形同式蓋兩形之乙角辛角同當甲庚丙弧分則二角必相等而丁丙又同爲直角則兩甲角亦必等而爲同式無疑矣又界角比心角所當之弧大一倍今己心角所當甲庚弧適當乙界角所對甲庚丙之一半則兩角爲等可知而戊爲直角與丁角等則兩甲角必等故甲己戊與甲乙丁亦爲同式形也

三角舉要有量法未著算例因作此補之

又如甲乙丙鈍角形求外切員徑【甲辛】半徑【甲己】法先求得中長綫【乙丁】得【乙丁丙】句股形

次作【乙辛】綫成【甲乙辛】大句股

形

又甲乙半之於戊從員心

【己】作直綫過戊至庚又成

【甲戊己】句股形

一率乙丁股【形內垂綫】

三率甲戊股【卽甲乙之半】

四率甲辛【卽外切員徑】

四率甲己【卽切員半徑】解曰三句股形皆相似故可以三率比例求之

問何以知其爲相似形也曰原設形之丙角與甲乙辛形之辛角所當者同爲甲庚乙員分則兩角等而乙丁丙形之丁角與甲乙辛大形之乙角又皆正角則余角亦等而爲相似形

又甲己爲甲辛之半甲戊爲甲乙之半戊正角與大形乙正角等又同用甲角則己戊亦乙辛之半而爲相似形

一系凡三角形求得形內垂綫爲法垂綫左右兩原邊相乘爲實法除實得外切員徑銳鈍同法假如甲乙丙鈍角形求得中垂綫乙丁六分爲法左右兩斜邊【甲乙十八分乙丙十分】相乘【一百八十分】爲實法除實得外切員徑甲辛三十分卽可借用前圖【分寸畸零稍爲整頓】

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷四十九﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷四十九﹥

歷算全書卷四十九

欽定四庫全書

歷算全書卷五十

宣城梅文鼎撰

三角形舉要法卷一

測算名義

古用句股有割員弧背矢諸名今用三角其類稍廣不可以不知爰摘綱要列於首簡

防

防如鍼芒無長短濶狹可論然算從此起譬如算日月行度只論日月中心一點此防所到卽爲躔離眞度綫

綫有弧直二種皆有長短而無濶狹自一防引而長之至又一防止則成綫矣

如測日月相距度皆自太陽心算至太陰心是爲弧綫如測日月去人逺近皆自人目中一防算至太陽太陰天是爲直綫

凡句股三角之法俱論綫綫兩端各一防故綫以防爲其界

面

面有方員各種之形皆有長短有濶狹而無厚薄故謂之冪冪者所以冒物如量田疇界域只論土面之大小

面之方員各類皆以綫限之故面以綫爲界【面之綫亦曰邊】惟員面是一綫所成乃弧綫也若直綫必三綫以上始能成形體

體或方或員其形不一皆有長短有濶狹又有厚薄【或淺深髙下之類】員體如球如柱方體如櫃如防或如員塔方塔皆以面爲界【圖後】

以上四者【謂防綫面體】略盡測量之事矣然其用皆在綫如論防則有距綫論面則有邊綫論體則有稜綫【面與面相得則成稜綫】凡所謂長短濶狹厚薄淺深髙下皆以綫得之三角法者求綫之法也

長短濶狹厚薄等類皆以量而得而量者必於一綫正中若稍偏於兩旁則其度不眞矣故凡測量所求者皆綫也三角形

欲明三角之法必詳三角之形

兩直綫不能成形成形者必三綫以上而三綫相遇則有三角故三角形者形之始也

多綫皆可成形析之皆可成三角至三角則無可析矣故三角能盡諸形之理

凡可算者爲有法之形不可算者爲無法之形三角者有法之形也不論長短斜正皆可以求其數故曰有法若無法之形析之成三角則可量故三角者量法之宗也角

三角法異於句股者以用角也故先論角

兩綫相遇則成角【平行兩直綫不能作角何也綫旣平行則𨿽引而長之至於無窮終無相遇之理角安從生是故作角者必兩綫相遇必不平行也】

角有三類一正方角一銳角一鈍角

如右圖以兩綫十字縱橫相遇皆爲正方角【亦曰直角亦曰方角】

如右圖以兩綫斜相遇則一爲銳角一爲鈍角

凡銳角必小於正方角凡鈍角必大於正方角

正方角止一銳角鈍角則有多種而算法生焉

弧

角在小形與在大形無以異也故無丈尺可言必量之以對角之弧

法以角之端爲員心用規作員員周分三百六十度乃視本角所對之弧於全員三百六十度中得幾何度分其弧分所對正得九十度者爲正方角【九十度者全員四之一謂之象限】若所對弧分不滿九十度者爲銳角【自八十九度以至一度並銳角也】所對弧分在九十度以上者爲鈍角【自九十一度至百七十九度並鈍角也】

如圖丁爲角卽用爲員心以作員形

其庚丁丙角【凡論角度並以中一字爲所指之角此言庚丁

丙卽丁爲角也】所對者庚丙弧在全員爲四

之一正得象限九十度是爲正方角

若乙丁丙角所對者乙丙弧在象限庚丙弧之內小於象限九十度是爲銳角

又乙丁壬角所對乙庚壬弧過於壬庚弧【壬庚亦象限九十度弧故庚丁壬亦方角】大於象限九十度是爲鈍角

角之度生於割員

割員弧矢

有弧則有矢弧矢者古人割員之法也

如圖以乙子直綫割平員則成弧

矢形

所割乙丙子員分如弓之曲古謂

之弧背以弧背半之則爲半弧背

【如乙丙】

通正

割員直綫如弓之謂之通【如乙子】

通半之古謂之半弧今曰正【如乙甲】

矢綫

正以十字截半徑成矢【如丁丙橫半徑爲乙甲正所截成甲丙矢】謂之正矢

【以上二條俱仍前圖】

正弧余弧正角余角

所用之弧度爲正弧以正弧減象限

爲余弧【如庚丙象限內減乙丙正弧則其餘乙庚爲余弧】

正弧所對爲正角【如正弧乙丙對乙丁丙角則爲正角】

以正角減正方角爲余角【如以乙丁丙正角去減庚丁丙方角則其餘乙丁庚角爲余角】

正余正矢余矢

有正弧正角卽有正【如乙甲】有正矢

【如甲丙】亦卽有餘【如乙己】有餘矢【如己庚】

正正矢余余矢皆乙丙弧所有亦卽乙丁丙角所有

自一度至八十九度並得爲乙丙並得爲正弧卽正余矢畢具

若用乙庚爲正弧則乙丙反爲余弧

角之正余亦同

割綫切綫

每一弧一角各有正余正矢余矢己成四綫於平員內【古人用句股割員卽此法也蓋此四綫己成倒順二句股】

再引半徑透於平員之外與切員直綫相遇爲割綫切綫而各有正余復成四綫【正割正切余割余切復成倒順二句股】共爲八綫故曰割員八綫也

如圖庚乙丙平員切戊丙直綫於丙

又引乙丁半徑透出員周外使兩綫相

遇於戊則戊丙爲乙丙弧之正切綫

亦卽爲乙丁丙角之正切綫而戊丁

爲乙丙弧之正割綫亦卽爲乙丁丙角之正割綫又以平員切庚辛直綫於庚與乙丁透出綫相遇於辛則庚辛爲乙丙弧之餘切綫亦卽爲乙丁丙角之餘切綫而辛丁爲乙丙弧之餘割綫亦卽爲乙丁丙角之餘割綫割員八綫

凡用一弧卽對一角用一角亦對一弧故可互求凡一弧卽有八綫【正正矢正割正切余余矢余割余切】角亦然

凡一弧之八綫卽成倒順四句股角亦然

如圖庚丙象弧共九十度庚丁丙

爲九十度十字正方角

任分乙丙爲正弧乙丁丙爲正角

則乙庚爲余弧乙丁庚爲余角

正【乙甲同丁己】正矢【甲丙】正切【戊丙】正割【戊丁】余【乙己同丁甲】余矢【庚己】余切【辛庚】余割【辛丁】

以上八綫爲乙丙弧所用亦卽爲乙丁丙角所用【自一度至八十九度並同】若用乙庚弧亦同此八綫但以余爲正以正爲余

乙甲丁句股形乙丁【半徑】爲乙甲【正】爲

股丁甲【余】爲句戊丙丁句股形戊丁

【正割】爲戊丙【正切】爲股丙丁【半徑】爲句

以上兩順句股形同用乙丁甲角故其

比例等【凡句股形一角等則余角並等】

乙己丁倒句股形乙丁【半徑】爲己丁【正】爲

股乙己【余】爲句辛庚丁倒句股形辛丁

【余割】爲丁庚【半徑】爲股辛庚【余切】爲句以上兩

倒句股形同用乙丁巳角故其比例亦等

乙甲丁句股形乙丁【半徑】爲乙甲【正】爲股甲

丁【余】爲句丁己乙倒句股形乙丁【半徑】爲

己丁【正】爲股乙己【余】爲句此倒順兩句股形等邊又等角【倒形之丁角卽順形丁角之餘倒形之乙角卽順形乙角之餘】竟如一句股也凖此論之則倒順四句股之比例亦無不等矣

角度

凡三角形並三角之度皆成兩象限【共一百八十度】

假如乙甲丁句股形其丁角五十五

度【當乙丙弧】則乙角必三十五度【當乙庚余弧】兩角共一象限九十度其甲角正方

原系九十度合三角成一百八十度

乙角何以必三十五度也試引乙丁過心至夘則夘丁醜角與丁乙甲角等【夘丁乙同爲一綫丁丑綫又與乙甲平行則所作之角必等】而夘丁丑固三十度也則乙角亦三十度矣

又假如丙乙丁三角形從乙角作乙

甲直綫至丁丙邊分爲兩句股形【乙甲

丁乙甲丙】凖前論乙甲丁句股形以乙分

角與丁角合之成一象限九十度又

乙甲丙句股形以乙分角與丙角合之成一象限九十度然則以乙全角【卽兩分角之合】與丁丙兩角合之必兩象限一百八十度矣【乙爲鈍角並同】

以此推知三角形有兩角卽知余角【並兩角以減半周一百八十度得之】句股形有一角卽知余角【句股原有正方角九十度則余兩角共九十度故得一可知其二】相似形

旣知角可以論形有兩三角形其各角之度相等則爲相似形而兩形中各邊之比例相等【謂此形中各邊自相較之比例亦如彼形中各邊自相較之比例也】

比例

兩數相形則比例生比例者或相等或大若干或小若干乃兩數相比之差數也有兩數於此又有兩數於此數𨿽不同而其各兩數自相差之比例同謂之比例等或兩小數相等又有兩大數相等是爲相等之比例數𨿽有大小其相等之比例均也或兩小數相差三倍又有兩大數亦相差三倍是爲三倍之比例或兩小數相差爲一倍有半又有兩大數相差亦一倍有半是爲一倍有半之比例數𨿽有大小其爲三倍之比例及一倍有半之比例均也

論八綫之比例有二

一爲八綫自相生之比例

乙甲丁小句股形與戊丙丁大句

股形相似【見前條】故以半徑乙丁比

正乙甲若割綫戊丁與切綫戊

丙之比例也【此爲以小比小股若大與大股】股

求亦同

又以半徑丙丁比正切戊丙若余甲丁與正乙甲之比例也【此爲以大句比大股若小句比小股】股求句亦同餘仿此以故凡八綫中但得一綫則餘皆可求觀圖自明一爲八綫算他形之比例

乙丁甲角所有八綫爲表中原設之數亢丁房句股形爲今所算之數

或先有丁角有亢丁而求房丁句則爲以乙丁半徑

比甲丁余若亢丁與房丁句

也【以角與句求亦同】以上是用八綫以求

他形

或先有亢丁有亢房股而求丁

角則爲以亢丁比亢房股若乙

丁半徑與丁角之正乙甲也【得乙

甲得丁角矣】或先有亢房股與房丁句

而求丁角則爲以亢房股比房丁

句若丁庚半徑與庚辛余切也【得庚辛亦得丁角】以上二者是用他形轉求八綫

總而言之皆以先有兩數之比例爲後兩數之比例其乘除之法皆依三率也

三率

三率算術古謂之異乘同除今以句股解之

丁戊大股【十四尺】丙戊大句【十一尺二寸】截丁乙小股【十尺】問乙甲截句

答曰八尺

術以所截小股乘大句得數

爲實以大股爲法除之卽得截句

若先以原股【十四尺】除原句【十一尺二寸】得八寸爲每一尺之句再以截股【十尺】乘之亦得八尺但先除後乘多有不盡之數故攺用先乘後除乃古九章中通用之綱要也

先乘後除何以又謂之異乘同除曰今但有截股而不知句故以原有之句乘之股與句異名故曰異乘然後以原有之股除之股與股同名故曰同除然則又何以謂之三率曰本是以原有之股與句比今截之股與句共四件也然見有者只三件【原有之股與句及今截之股】故必以見有之三件相爲乘除而得所不知之第四件故曰三率

三率乘除圖式

一率原有股十四尺

爲法

二率原有句十一尺二寸【相乘】

三率今截股十尺

【爲實】

四率所求截句八尺

法除實得所求

術曰以原股比原句若截股與截句也

凡言以者爲一率言比者爲二率言若者爲三率言與者爲四率

二率三率常相乘爲實一率常爲法法除實得四率四率乃所求之數其三率者所以求之也三率與異乘同除非有二理但以橫列爲異然數旣平列卽可以四率爲法除二三相乘之實而得一率並可以一率四率相乘爲實用二率爲法除之而得三率或用三率爲法除之亦得二率是故一四二三之位可以互居【四可爲一二可爲三】法實可以疊用【二與三可居一四之位一與四可居二三之位】變動不居惟用所適而各有典常於異乘同除之理尢深切而著明者也

三率互用圖

反之

更之

又反之

一句八尺

一股十尺

一句十一尺二寸二股十尺

二句八尺

二股十四尺三句十一尺二寸三股十四尺

三句八尺

四股十四尺

四句十一尺二寸四股十尺

右並以二率三率相乘爲實一率爲法除之而得四率

八綫表

八綫爲各弧各角之句股所成故八綫表者卽句股形之立成數也古人用句股開方巳盡測量之理然句股皆邊綫耳邊之數無方放之則彌四逺近之則陳几案故所傳算術皆以一端示例而已不能備詳其數也今變而用角則有弧度三百六十以限之而以象限盡全周有合於舉一反三之防又析象限之度各六十分凡爲句股形二千七百角度五千四百【九十度之分五千四百而句股形並有兩角故其形二千七百而角數倍之】爲正爲切綫爲割綫共一萬六千二百【三項各五千四百正余互用也】而句股之形略備用之殊便也銳角分兩句股鈍角補成句股然惟有八綫表中豫定之句股故但得其角度則諸數歷然可於無句股中尋出句股矣

半徑全數

全數卽半徑也不言半徑而言全數者省文也凡八綫生於角度而有角有弧則有半徑八綫之數皆依半徑而立也半徑常爲一【或五位則爲一萬或六位則爲十萬】則正常爲半徑之分【正必小於半徑】而不得爲全數惟半徑可稱全數也【割切二綫皆依正而生亦皆有畸零不得爲全數】

用全數爲半徑有數善焉一立表時易於求數也一用表時便於乘除也【三率中全數爲除法則但降位可省一除若全數爲乘法則但升位可省一乘】

曆書中多言全數【或但曰全】以從省便今算例中直云半徑以欲明比例之理故質言之

補遺

正爲八綫之主

割圜之法皆作句股於圜內以先得正故古人祗用正亦無不足今用割切諸綫而皆生於正

平圜徑二尺【卽戊壬】半之一尺【卽戊丙庚

丙等】爲圜裏六孤之一面【卽乙戊】半徑

【戊丙】爲半面【戊丁】爲句句求股得

股【丁丙】轉減半徑【庚丙】得余【庚丁】爲小句

半面【戊丁】又爲小股句股求得小【戊庚】是爲割六弧成十二弧之一面如是累析爲二十四弧四十八弧至九十六弧以上定爲徑一尺周三尺一寸四分有奇論曰九章算經載劉徽割圜術大略如此其以半徑爲六弧之一面與八綫理合半徑恆爲一卽全數半面爲股則正也

平方徑十寸其積百寸內作同徑之平圜平圜內又作平方正得外方之半其積五十寸平方開之得七寸○

七有奇【卽離震等四等面之通】乃自

四隅之旁增爲八角曲圜

爲第一次【卽八等面通】至第二

次則爲曲十六【卽十六等面通】第三次爲曲三十二每次

加倍至十二次則爲曲一

萬六千三百八十四於是方不復方漸變爲圜矣其法逐節以大小句股冪相求至十二次所得小以一萬六千三百八十四乘之得三十一寸四分一五毫九絲二忽爲徑十寸之圜周與祖衝之徑一百一十三周三百五十五合

論曰元趙友欽革象新書所撰乾象周髀法大略如此所得周徑與西術同其逐節所求皆通所用小股皆正也

又論曰劉徽祖衝之以割六孤起數趙友欽以四角起數今西術作割圜八綫以六宗率則兼用之可見理之至者先後一揆法之精者中西合轍西人謂古人但知徑一圍三未深攷也

又論曰中西割圜之法皆以句股法求通通半之爲正割圜諸率皆自此出總之爲句股之比例而巳鈍角正

鈍角不立正而卽以外角之正爲正

鈍角之正在形外卽外角之正也故乙丙已鈍角與乙丙甲外角同以乙丁爲正【以鈍角減半周得外角假如鈍角一百二

十度其所用者卽六十度之正】乙丁綫能爲乙

丙甲角正又能爲乙丙已鈍角

正八綫表止於象限以此【因鈍角與

外角同正故表𨿽一象限而實有半周之用】

鈍角余

鈍角旣以外角之正爲正卽以外角之餘爲余如前圖乙庚爲外角【乙丙甲】余而卽爲鈍角【乙丙己】余

捷法以正角【戊丙巳】減鈍角【乙丙巳】得余角【戊丙乙】卽得余

過弧

鈍角之弧爲過弧

巳戊爲象限弧而乙戊巳爲乙丙

巳鈍角之弧是越象限弧而過之

也故曰過弧

大矢

鈍角之矢爲大矢

如前圖以乙丁辛分全圜卽全徑亦分爲二則丁甲爲小半圜【乙甲辛】之徑謂之正矢丁巳爲大半圜【乙已辛】之徑謂之大矢大矢者鈍角所用也鈍角與外角同用乙丁正乙庚余所不同者惟矢【乙丙巳角用大矢丁已乙丙甲角用正矢丁甲】

捷法以乙庚【卽丁丙】余加已丙半徑卽得【丁巳】大矢【若以余減半徑亦得正矢】

正角以半徑全數爲正

八綫起○度一分至八十九度五十九分並有正而九十度無正非無正也蓋卽以半徑全數爲其正故凡算三角

有用半徑與正相爲比例者皆正

角也【其法與銳角形鈍角形用兩正爲比例同理並詳後卷】八十九度奇之正至九九九九九

而極迨滿一象限始能成半徑全數是故半徑全數者正角九十度之正也其數爲一○○○○○

歷算全書卷五十

欽定四庫全書

歷算全書卷五十一

宣城梅文鼎撰

三角法舉要卷二

算例

三角形有三類

一曰句股形

卽直角三邊形也有正方角一餘並銳角

一曰銳角形

三角並銳

一曰鈍角形

三角內有鈍角一餘並銳角

以上三類總謂之三角形其算之各有術

句股形第一術有一角一邊求余角余邊

內分二支

一先有之邊爲

一先有之邊爲句【或先有股亦同】

假如【壬癸丁】句股形有丁角【五十七度】壬丁【九十一丈八尺】

求余角余邊

一求癸丁邊

術曰以半徑全數比丁角之餘

若壬丁與癸丁句【半徑卽丁乙余卽甲丁

以丁乙比甲丁若壬丁比丁癸】

一率【原設】半徑

一○○○○○爲法

二率【原設句】丁角【五十七度】余五四四六四【相乘】

三率【今有】壬丁邊

九十一丈八尺【爲實】

四率【今所求句】癸丁邊

五十丈

法除實得所求一求壬癸邊

術曰以半徑比丁角之正若壬丁與壬癸股

一率【原設股】半徑

一○○○○○爲法二率【原設股】丁角【五十七度】正八三八六七【相乘】三率【今有】壬丁邊

九十一丈八尺【爲實】四率【今所求股】壬癸邊

七十七丈

法除實得所求一求壬角

以丁角【五十七度】與象限九十度相減得餘三十三度爲壬角

計開

先有之三件

癸正方角【九十度】丁角【五十七度】壬丁【九十一丈八尺】

今求得三件

癸丁旬【五十丈】壬癸股【七十七丈】壬角【三十三度】

右例先得以求句股也是爲句股形第一術之第一支

假如【壬癸丁】句股形有丁角【六十二度】癸丁句【二十四丈】求余角余邊

一求壬角

以丁角【六十二度】與象限相減得餘二十八度爲壬角

【戊丙丁句股形以戊丙切綫爲股丙丁半徑爲句戊丁割綫爲

是丁角原有之綫】

【今壬癸丁句股形旣同丁角則其比例等】

一求壬丁邊

術爲以半徑比丁角之割綫若癸丁句與壬丁

一【原設句】半徑

一○○○○○爲法二【原設】丁角【六十二度】割綫二一三○○五【相乘】

三【今有句】癸丁邊

二十四丈

【爲實】

四【所求】壬丁邊

五十一丈二尺法除實得所求一求壬癸邊

術爲以半徑比丁角之切綫若癸丁句與壬癸股

一【原設句】半徑

一○○○○○爲法

二【原設股】丁角【六十二度】切綫一八八○七三【相乘】

三【今有句】癸丁邊

二十四丈

【爲實】

四【所求股】壬癸邊

四十五丈一尺法除實得所求計開

先有之三件

癸正方角丁角【六十二度】癸丁句【二十四丈】

今求得三件

壬角【二十八度】壬丁【五十一丈一尺】壬癸股【四十五丈一尺】右例先得句以求及股也或先得股以求及句亦同是爲句股形第一術之第二支

句股形第二術有邊求角

亦分二支

一先有二邊

一先不知正方角而有三邊【新增】

假如【壬癸丁】句股形有壬丁【一百零二丈二】癸丁句【尺四十八】

求二角一邊

一求丁角

術爲以壬丁比癸丁句若半

徑乙丁與丁角之餘甲丁

一壬丁邊

一百○二丈二尺今有之爲法二癸丁邊

四十八丈

今有之句【丈相】三半徑

一○○○○○

原設之【乘爲】四丁角余

四六九六六

法除實得所求原設句

依術求得丁角六十二度【實以所得余撿表卽】

一求壬角

以丁角【六十二度】與象限相減得餘二十八度爲壬角一求壬癸邊

術爲以半徑比丁角之正若壬丁與壬癸股

一半徑

一○○○○○

二丁角【六十二度】正

八八二九五

三壬丁邊

一百○二丈二尺

四壬癸邊

九十丈○二尺三寸

計開

先有之三件

壬丁【一百○二丈二尺】癸丁句【四十八丈】癸正方角

今求得三件

丁角【六十二度】壬角【二十八度】壬癸股【九十丈○二尺三寸】

右例以邊求角而先知方角故只用二邊也是爲句股形第二術之第一支【此先有二邊爲與句故用正余若先有者是句與股則用切綫其比例之理一也】

假如【壬癸丁】三角形有壬丁邊【一百○六丈】壬癸邊【九十丈】癸丁邊【五十六丈】求角

一求癸角

術以壬丁大邊與丁癸邊相加得【一

百六十二丈】爲總又相減得【五十

丈】爲較以較乘總得【八千一百丈】爲實以壬癸邊【九十丈】爲法除之

仍得【九十丈】與壬癸邊數等卽知

癸角爲正方角

依術求得癸角爲正方角定爲句股形

一求丁角

術爲以丁癸邊比壬癸邊若半徑與丁角之切綫

一丁癸句

五十六丈

二壬癸股

九十丈

三半徑

一○○○○○

四丁角切綫一六○七一四

依術求得丁角五十八度○六分【以所得切綫撿表卽得】

一求壬角

以丁角【五十八度○六分】與象限相減得餘三十一度五十四分爲壬角

計開

先有三邊

壬丁邊【一百零六丈】壬癸邊【九十丈】癸丁邊【五十六丈】

求得三角

癸正方角丁角【五十八度零六分】壬角【三十一度五十四分】右例亦以邊求角而先不知其爲句股形故兼用三邊是爲句股形第二術之第二支

銳角形第一術有兩角一邊求余角余邊

假如【乙丙丁】銳角形有丙角【六十度】丁角【五十度】丙丁邊【一百二十尺】

先求乙角

術以丙角【六十度】丁角【五十度】相

並得【一百一十度】以減半周一百

八十度餘七十度爲乙角

次求乙丁邊

術爲以乙角正比丙丁邊若丙角正與乙丁邊

一乙角【七十度】正九三九六九

二丙丁邊【卽乙角對邊】一百二十尺

三丙角【六十度】正八六六○三

四乙丁邊【卽丙角對邊】一百一十尺○六寸

次求乙丙邊

術爲以乙角正比丙丁邊若丁角正與乙丙邊

一乙角【七十度】正九三九六九

二丙丁【乙角對邊】

一百二十尺

三丁角【五十度】正七六六○四

四乙丙【丁角對邊】

九十七尺八寸

計開

先有之三件

丙角【六十度】丁角【五十度】丙丁邊【一百二十尺】

今求得三件

乙角【七十度】乙丁邊【一百一十尺零六寸】乙丙邊【九十七尺八寸】右例先有之邊在兩角之間也若先有之邊與一角相對亦同蓋三角形有兩角卽有第三角故無兩法

銳角形第二術有一角兩邊求余角余邊

此分二支

一先有之角與一邊相對

一先有之角不與邊相對

假如【甲乙丙】銳角形有丙角【六十度】甲丙邊【八千尺】甲乙邊【七千零三十四尺】

先求乙角

術爲以甲乙邊比甲丙邊若丙角

正與乙角正

一甲乙【丙角對邊】

七千○三十四尺

二甲丙【乙角對邊】

八千尺

三丙角【六十度】正八六六○三

四乙角

正九八四九六

撿正表得乙角八十度○三分

次求甲角

以丙角乙角相並得【一百四十度○三分】以減半周餘三十九度五十七分爲甲角

次求乙丙邊

術爲以乙角之正比甲角之正若甲丙邊之與乙丙邊

一乙角【八十度○三分】正九八四九六

二甲角【三十九度五十七分】正六四二一二

三甲丙【乙角對邊】

八千尺

四乙丙【甲角對邊】

五千二百一十五尺計開

先有之三件

丙角【六十度】甲丙邊【八千尺】乙甲邊【七千○三十四尺】

今求得三件

乙角【八十度○三分】甲角【三十九度五十七分】乙丙邊【五千二百一十五尺】右例有兩邊一角而角與一邊相對是爲銳角形第二術之第一支

假如【甲乙丙】銳角形有甲丙邊【四百尺】乙丙邊【二百六十一尺○八分】丙角【六十度】角在兩邊之中不與邊對求甲乙邊

先求中長綫分爲兩句股形

術爲以半徑比丙角正若甲

丙邊與甲丁中長綫

一半徑

一○○○○○

二丙角【六十度】正○八六六○三

三甲丙邊

四百尺

四甲丁中長綫

三百四十六尺四寸一分次求丙丁邊【卽所分甲丁丙形之句而甲丙爲之】

術爲以半徑比丙角余若甲丙邊與丙丁邊

一半徑

一○○○○○

二丙角【六十度】余

五○○○○

三甲丙邊

四百尺

四丙丁邊

二百尺

次求乙丁邊【卽所分甲丁乙形之句而甲丁爲之股】

以丙丁與丙乙相減餘六十一尺○八分爲乙丁次求丁甲乙分角【卽分形甲丁乙句股之甲角】

術爲以甲丁中長綫比乙丁分邊若半徑與甲分角切綫

一甲丁中長綫三百四十六尺四寸一分

二乙丁分邊

六十一尺○八分

三半徑

一○○○○○

四甲分角切綫

一七六三三

撿切綫表得一十度爲甲分角

末求甲乙邊

術爲以半徑比甲分角割綫若甲丁中長綫與甲乙邊

一半徑

一○○○○○

二甲分角【十度】割綫一○一五四三

三甲丁中長綫

三百四十六尺四寸一分

四甲乙邊

三百五十一尺七寸五分求甲全角

以丙角【六十度】之餘角三十度【卽分形甲丁丙之甲分角】與求到甲分角【一十度】相並得四十度爲甲全角

求乙角

以甲分角【一十度】減象限得八十度爲乙角【或並丙甲二角減半周亦同】

計開

先有之三件

甲丙邊【四百尺】乙丙邊【二百六十一尺○八分】丙角【六十度】

今求得三件

甲乙邊【三百五十一尺七寸五分】甲角【四十度】乙角【八十度】右例有兩邊一角而角在兩邊之中不與邊對故用分形以取句股是爲銳角形第二術之第二支

又術【新增】用切綫分外角

假如【甲乙丙】銳角形有甲丙邊【四百尺】乙丙邊【二百六十一尺○八分】丙角【六十度】此卽前例但求甲角

術以【甲丙乙丙】兩邊相並爲總相減爲

較又以丙角【六十度】減半周得外

角【一百二十度】半之得半外角【六

十度】撿其切綫依三率法求得半

較角以減半外角得甲角

一兩邊總

六百六十一尺○八分

二兩邊較

一百三十八尺九寸二分

三半外角切綫一七三二○五

四半較角切綫

三六三九七

撿切綫表得【二十度】爲半較角轉與半外角【六十度】相減得甲角四十度

次求乙角

並甲丙二角共【一百度】以減半周得餘八十度爲乙角次求甲乙邊

一甲角【四十度】正六四二七九

二丙角【六十度】正八六六○三

三乙丙邊

二百六十一尺○八分

四甲乙邊

三百五十一尺七寸五分

銳角形第三術有三邊求角

假如【甲乙丙】銳角形有乙丙邊【二十丈】甲丙邊【一十七丈五尺八寸五分】乙甲邊【一十三丈○五寸】

術曰任以【乙丙】大邊爲底從甲角

作甲丁虛垂綫至底分爲兩句股

形

一甲丁丙形以甲丙邊爲丁丙

爲句

一甲丁乙形以甲乙邊爲丁乙爲句

兩相並爲總相減爲較兩句相並【卽乙丙邊原數】爲句總求兩句相減之數爲句較

術爲以句總比總若較與句較也

一兩句之總【卽乙丙】二十丈

二兩之總

三十丈○六尺三寸五分三兩之較

四丈五尺三寸五分

四兩句之較【卽丙戊】六丈九尺四寸六分

求分形之兩句

以句較【六丈九尺四寸六分】減句總【二十丈卽乙丙】余乙戊【一十三丈○五寸四分】半之得丁乙【卽戊丁】六丈五尺二寸七分爲【甲丁乙】分形之句

又以戊丁【六丈五尺二寸七分】加句較【六丈九尺四寸六分卽戊丙】得丁丙一十三丈四尺七寸三分爲【甲丁丙】分形之句

求丙角

術爲以甲丙比丁丙句若半徑與丙角之餘

一甲丙邊

一十七丈五尺八寸五分

二丁丙分邊一十三丈四尺七寸三分

三半徑

一○○○○○

四丙角余

七六六一六

撿余表得丙角四十度

求甲角

術先求分形大半之甲角

以丙角【四十度】減象限餘五十度爲【丁甲丙】分形之甲角

次求分形小半之甲角

術爲以甲乙比丁乙句若半徑與分形甲角之正

一甲乙邊

一十三丈○五寸

二丁乙分邊

六丈五尺二寸七分

三半徑

一○○○○○

四甲分角正

五○○一五

撿正表得三十度爲【丁甲乙】分形之甲角

並分形兩甲角【先得五十度後得三十度】得共八十度爲甲全角求乙角

倂丙甲二角共【一百二十度】以減半周得餘六十度爲乙角計開

先有三邊

甲丙邊【一十七丈五尺八寸五分】乙丙邊【二十丈】乙甲邊【一十三丈○五寸】

求得三角

丙角【四十度】甲角【八十度】乙角【六十度】

鈍角形第一術有兩角一邊求余角余邊

假如【乙丙丁】鈍角形有丙角【三十六度半】乙角【二十四度】丁乙邊【五十四丈】

先求丁角

術以丙乙二角並之共【六十度半】以減半周得餘一百一十九度半

爲丁鈍角

次求乙丙邊

術爲以丙角正比丁角正若乙丁邊與乙丙邊

一丙角【三十六度二十分】正五九四八二

二丁角【一百十九度三十分】正八七○三六

三乙丁邊

五十四丈

四乙丙邊

七十九丈○一寸

右所用丁角正卽六十度半正以鈍角度減半周用之凡鈍角並同

求丁丙邊

術爲以丙角正比乙角正若乙丁邊與丁丙邊

一丙角【三十六度三十分】正五九四八二

二乙角【二十四度】正四○六七四

三乙丁邊

五十四丈

四丁丙邊

三十六丈九尺二寸

計開

先有之三件

丙角【三十六度半】乙角【二十四度】丁乙邊【五十四丈】

今求得三件

丁鈍角【一百一十九度半】乙丙邊【七十九丈○一寸】丁丙邊【三十六丈九尺二寸】

鈍角形第二術有一角兩邊求余角余邊

亦分二支

一先有對角之邊

一先有二邊皆角旁之邊而不對角

假如【甲乙丙】鈍角形有乙角【九十九度五十七分】甲丙對邊【四千尺】甲乙邊【三千五百一十七尺】

求丙角

術爲以甲丙對邊比甲乙邊若

乙角正與丙角正

一甲丙邊

四千尺

二甲乙邊

三千五百一十七尺三乙角【九十九度五十七分】正九八四九六【卽八十度三分正】

四丙角

正八六六○三

撿表得丙角六十度

求甲角

並乙丙二角【共一百五十九度五十七分】以減半周得餘二十度○三分爲甲角

求乙丙邊

術爲以乙角之正比甲角之正若甲丙對邊與乙丙邊

一乙角【九十九度五十七分】正九八四六九

二甲角【二十○度三分】正三四二八四

三甲丙邊

四千尺

四乙丙邊

一千三百九十二尺計開

先有之三件

乙鈍角【九十九度五十七分】甲丙邊【四千尺】甲乙邊【三千五百一十七尺】

今求得三件

丙角【六十度】甲角【二十度○三分】乙丙邊【一千三百九十二尺】右例有兩邊一角而先有對角之邊是爲鈍角形第二術之第一支

假如【乙丁丙】鈍角形有乙丁邊【一千零八十尺】乙丙邊【一千五百八十二尺】乙角【二十四度】角在兩邊之中不與邊對

術先求形外之虛垂綫補成正方角

從不知之丙角作虛垂綫於形外

如丙戊亦引乙丁綫於形外如丁

戊兩虛綫遇於戊成正方角

術爲以半徑比乙角正若乙丙邊

與丙戊

一半徑

一○○○○○

二乙角【二十四度】正

四○六七四

三乙丙邊

一千五百八十二尺

四丙戊邊【卽虛垂綫】

六百四十三尺

又以半徑比乙角之餘若乙丙邊與乙戊

一半徑

一○○○○○

二乙角【二十四度】余

九一三五五

三乙丙邊

一千五百八十二尺

四乙戊邊【卽乙丁引長綫】一千四百四十五尺

以原邊乙丁【一千○八十尺】與引長乙戊邊相減得丁戊【三百六十五尺】爲形外所作虛句股形之句【則先得丙戊垂綫爲股而原邊丁丙爲之】

求丁丙邊

依句股求術以丙戊股自乘【四十一萬三千四百四十九尺】丁戊句自乘【一十三萬三千二百二十五尺】並之得數【五十四萬六千六百七十四尺】爲實平方開之得七百三十九尺爲丁丙邊

求丙角

術爲以丁丙邊比丁乙邊若乙角正與丙角正

一丁丙邊

七百三十九尺

二丁乙邊

一千○八十尺

三乙角【二十四度】正四○六七四

四丙角

正五九四四二

撿表得丙角三十六度二十九分

求丁角

並乙丙二角共【六十度二十九分】以減半周得餘一百一十九度三十一分爲丁鈍角

計開

先有之三件

乙丁邊【一千零八十尺】乙丙邊【一千五百八十二尺】乙角【二十四度】

今求得三件

丁丙邊【七百三十九尺】丙角【三十六度二十九分】丁鈍角【一百一十九度三十一分】

右例有兩邊一角而兩邊並在角之兩旁不與角對是爲鈍角形第二術之第二支

又術【新增】用切綫分外角

假如【乙丙丁】鈍角形有丁乙邊【五百四十尺】丙乙邊【七百九十一尺】乙角【二十四度】角在兩邊之中不與邊對求丙角

以【丁乙丙乙】兩邊相並爲總相減爲較又以乙角【二十四度】減半周得外角【一百五十六度】半之得半外角【七十八度】撿其切綫得四七○四六三

術爲以邊總比邊較若半外角切綫與半較角切綫

一兩邊之總

一千三百三十一尺

二兩邊之較

二百五十一尺

三半外角切綫四七○四六三

四半較角切綫

八八七一九

撿表得半較角【四十一度三十五分】以轉減半外角【七十八度】得餘三十六度二十五分爲丙角

求丁角

並乙丙二角共【六十度二十五分】以減半周得一百一十九度三十五分爲丁鈍角

求丁丙邊

術爲以丙角正比乙角正若乙丁邊與丁丙邊

一丙角【三十六度二十五分】正五九三六五

二乙角【二十四度】正四○六七四

三乙丁邊

五百四十尺

四丁丙邊

三百六十九尺九寸八分計開

先有之三件

丁乙邊【五百四十尺】丙乙邊【七百九十一尺】乙角【二十四度】

今求得三件

丙角【三十六度二十五分】丁鈍角【一百一十九度三十五分】丁丙邊【三百六十九尺九寸八分】

鈍角形第三術有三邊求角【新式】

假如【乙丙丁】鈍角形有乙丙邊【三百七十五尺】乙丁邊【六百○七尺】丁丙邊【三百尺】

術自乙角作虛垂綫至甲又引丁

丙綫橫出遇於甲而成正方角則

成乙甲丁句股形

又引橫綫至辛使甲辛如丙甲成

乙甲辛句股形則丁辛爲兩句之

總而所設丁丙邊爲兩句之較

又乙丁邊爲大形【乙甲丁】之乙丙邊爲小形【乙甲辛卽乙甲丙】之兩相並爲總相減爲較

術爲以句較比較若總與句總

一句較【卽丁丙邊】

三百尺

二較【卽乙丁內減乙丙之餘】二百三十二尺

三總【卽乙丁乙丙二邊相並】九百八十二尺

四句總

七百五十九尺四寸

以句較【三百尺】減所得句總【七百五十九尺四寸】餘數【五百二十九尺四寸】爲大形之句甲丁

求丁角【用乙甲丁大形】

術爲以乙丁比丁甲句若半徑與丁角之餘

一乙丁

六百○七尺

二甲丁句

五百二十九尺七寸

三半徑

一○○○○○

四丁角余

八七二六五

撿表得丁角二十九度一十四分

求丙角【用乙甲丙小形】

術爲以甲丙句比乙丙若半徑與丙角之割綫

一甲丙句

二百二十九尺七寸

二乙丙

三百七十五尺

三半徑

一○○○○○

四丙角割綫一六三二五六

撿表得丙角【五十二度一十四分】爲本形之丙外角以減半周得丙鈍角一百二十七度四十六分

求乙角

並丁丙二角所得度分【共一百五十七度】以減半周得餘二十三度爲乙角

計開

先有三邊

乙丙邊【三百七十五尺】乙丁邊【六百七尺】

丁丙邊【三百尺】

求得三角

丁角【二十九度一十四分】丙鈍角【一百二十七度四十六分】乙角【二十三度】

右例鈍角形三邊求角作垂綫於形外徑求鈍角乃新式也若以大邊爲底從鈍角分中長綫同銳角第三術

歷算全書卷五十一

欽定四庫全書

歷算全書卷五十二

宣城梅文鼎撰

三角法舉要卷三

內容外切【三角測量之用在邊與角而其內容外切亦所當明故次於算例之後】內容有二曰本形曰他形

一三角求積

積謂之冪亦謂之面乃本形所有

一三角容員

一三角容方

以上皆形內所容之他形

外切惟一

一三角形外切之員

三角求積第一術

底與髙相乘折半見積

內分二支

一句股形卽以句股爲底爲髙

一銳角鈍角形任以一邊爲底而求其垂綫爲髙

假如句股形甲乙股【一百二十尺】乙丙句【三十五尺】求積

術以甲乙股乙丙句相乘【四千二百尺】折半得積

凡求得句股形積二千一百尺

如圖甲乙股與乙丙句相乘成甲

乙丙丁長方形其形半實半虛故

折半見積

或以句折半【十七尺半】乘股亦得積【二千

一百尺】

如圖乙丙句折半於戊以乙戊乘

甲乙成甲乙戊丁形是移丙戊己

補甲丁己也

或以股折半【六十尺】乘句亦得積【二千

一百尺】

如圖甲乙股折半於己以己乙乘

乙丙成己乙丙丁形是移甲己戊

補戊丁丙也

右句股形以句爲底以股爲髙若以股爲底則句又爲髙可互用也

句股形有立有平若平地句股以句爲濶以股爲長其理無二

論曰凡求平積皆謂之冪其形如网目又似窓櫺之空皆以橫直相交如十字亦如機杼之有經緯而成布帛故句股是其正法何也句股者方形斜剖之半也折半則成正剖之半方形矣其他銳角鈍角或有直無橫有橫無直必以法求之使成句股然後可算故句股者三角法所依以立也

假如銳角形甲乙邊【二百三十二尺】甲丙邊【三百四十尺】乙丙邊【四百六十八尺】求積

術先求垂綫用銳角第三術任以

乙丙邊爲底以甲丙甲乙爲兩

兩之較數【一百零八尺】總數【五百七十二尺】相乘【六萬一千七百七十六尺】爲實以乙丙底

爲法除之得數【一百三十二尺】轉減乙丙餘數【三百三十六尺】半之得乙丁【一百六十八尺】依句股法以乙丁自乘【二萬八千二百二十四尺】與甲乙自乘【五萬三千八百二十四尺】相減餘數【二萬五千六百尺】平方開之得甲丁垂綫【一百六十尺】以甲丁垂綫折半乘乙丙底得積凡求得銳角形積三萬七千四百四十尺

如圖移辛補壬移庚補癸則成長

方形卽垂綫折半乘底之積

右銳角形任以乙丙邊爲底取垂

綫求積若攺用甲乙或甲丙邊爲

底則所得垂綫不同而得積無異故可以任用爲底假如鈍角形甲乙邊【五十八步】甲丙邊【八十五步】乙丙邊【三十三步】求積

術求垂綫立於形外用鈍角第三

術以乙丙爲底甲乙甲丙爲兩

總數【一百四十三步】較數【二十七步】相乘【三千八百

六十一步】爲實乙丙底爲法除之得數

【一百一十七步】內減乙丙餘數【八十四步】折半

【四十二步】爲乙丁【卽乙丙引長邊】依句股法乙丁自乘【一千七百六十四步】甲乙自乘【三千三百六十四步】相減餘數【一千六百步】平方開之得甲丁【四十步】爲形外垂綫以乙丙底折半【十六步半】乘之得積

凡求得鈍角形積六百六十步

如圖甲乙丙鈍角形移戊補庚移

庚己補壬癸又移壬子補辛成辛

癸丑長方卽乙丙底折半乘中長

甲丁之積

右鈍角形以乙丙爲底故從甲角作垂綫若以甲乙爲底則自丙角作垂綫亦立形外而垂綫不同然以之求積並同若以甲丙爲底從乙角作垂綫則在形內如銳角矣其垂綫必又不同而其得積無有不同故亦可任用一邊爲底

凡用垂綫之髙乘底見積必其綫上指天頂底綫之橫下應地平兩綫相交正如十字故其所乘之冪積皆成小平方可以虛實相補而求其積數鈍角形引長底綫以作垂綫立於形外則兩綫相遇亦成十字正方之角矣

總論曰三角形作垂綫於內則分兩句股鈍角形作垂綫於外則補成句股皆句股法也

三角求積第二術

以中垂綫乘半周得積謂之以量代算

假如鈍角形乙丙邊【五十八步】甲乙邊【一百一十七步】甲丙邊【八十五步】求積

術平分甲乙兩角各作綫防於心從

心作十字垂綫至乙甲邊【如心庚】卽中

垂綫也乃量取中垂綫【心庚】得數【一十八步】

合計三邊而半之【一百三十步】爲半周以半周乘中垂綫得積

凡求得鈍角形積二千三百四十步

又術如前取中垂綫【心庚】爲濶半周爲

長【如乙癸及丁壬】別作一長方形【如乙壬丁癸】卽

與【甲乙丙】鈍角形等積

解曰凡自形心作垂綫至各邊皆等故中垂綫乘半周爲一切有法之形所公用方員及五等面六等面至十等面以上並同故以中垂綫爲濶半周爲長其所作長方形卽與三角形等積

又解曰中垂綫至邊皆十字正方角卽分各邊成句股形以乘半周得積卽句股相乘折半之理

附分角術有甲角欲平分之

術以甲角爲心作虛半規截角旁兩

綫得辛壬二防乃自辛自壬各用爲

心作弧綫相遇於癸作癸甲綫卽分

此角爲兩平分

三角求心術

如上分角術於甲角平分之於乙角

又平分之兩平分之綫必相遇成一

防此一防卽三角形之心

解曰試再於丙角如上法分之則亦

必相遇於原防

三角求積第三術

以三較連乘又乘半總開方見積

假如鈍角形甲乙邊【一百一十六尺】甲丙邊【一百七十尺】乙丙邊【二百三十四尺】求積

術合計三邊而半之【二百六十尺】爲半總

以與甲乙邊相減得較【一百四十四尺】與甲

丙邊相減得較【九十尺】與乙丙邊相減

得較【二十六尺】三較連乘【以兩較相乘得數又以餘一較】

【乘之也】得數【三十三萬六千九百六十尺】又以半總較之得數【八千七百六十萬零九千六百尺】平方開之得積

凡求得鈍角形積九千三百六十尺

若系銳角同法

解曰此亦中垂綫乘半周之理但所得爲冪乘冪之數故開方見積詳或問

三角容員第一術

以與句股求容員徑【此術惟句股形有之凡句股相並爲和以和與並爲和和以和與相減爲和較】

假如【甲乙丙】句股形甲丙句【二十步】乙甲股【二十一步】乙丙【二十九步】求容員徑

術以句股和【四十一步】與相減得數爲容員徑

凡求得內容員徑一十二步

解曰此以和較爲容員徑

如圖從容員心作半徑至邊又作

分角綫至角成六小句股形則各

角旁之兩綫相等【如丙戊丙庚兩綫在丙角旁則

相等乙庚乙己在乙角旁甲戊甲己在甲角旁並兩綫相等】

其在正方角旁者【甲戊甲己】乃和較也【於乙丙內分丙庚以對丙戊又分乙庚以對乙己則其餘爲甲戊及甲己此卽句股和與乙丙相較之數也】然卽爲內容員徑何也各角旁兩綫並自相等而正方角旁之兩綫又皆與容員半徑等【正方角旁兩小形之角皆平分方角之半則句股自相等而甲戊等心戊甲己等心己】然則和較者正方角旁兩綫【甲戊甲己】之合卽容員兩半徑【心戊心己】之合也故和較卽容員徑也

試以甲戊爲半徑作員則戊心亦

半徑而其全徑【癸戊甲】與容員徑【丁心

己】等以甲己爲半徑作員則己心

亦半徑而其全徑【辛己甲】與容員徑

【戊心壬】亦等

三角容員第二術

以周與積求容員徑

內分二支

一句股形以和和爲用【亦可用半】

一銳角鈍角形以全周半周爲用

假如【甲乙丙】句股形甲丙句【一十六步】甲乙股【三十步】乙丙【三十四步】求容員徑

術以句股相乘得數【四百八十步】爲實並句股數【共八十步】爲法除之得數倍之爲容員徑

凡求得容員徑一十二步

解曰此以和和除句股倍積得容員半徑也

如圖從容員心作對角綫分其形爲三【一甲心丙一甲心乙一丙心乙】乃於甲丙句綫兩端各引長之截子甲如乙甲股截丙醜如丙乙則子丑綫卽和和也乃自員心作癸壬直綫與丑子平行兩端各聫之成長方又作辛丙綫分爲三長方形其濶並如員半徑其長各如句如股如

而各爲所分三小形之倍積【甲辛長方

如甲丙句之長而以心戊半徑爲濶卽爲甲心丙分形之倍甲癸長

方如乙甲股之長而以同心己之半徑爲濶卽爲乙心甲形之倍丙

壬長方如丙乙之長而以同心庚之半徑爲濶卽爲乙心丙形之

倍】合之卽爲本形倍積與句股相

乘同也【句股相乘爲倍積見求積條】故以和

和除句股相乘積得容員半徑

假如【甲乙丙】句股形甲丙句【八十八尺】甲乙股【一百零五尺】乙丙【一百三十七尺】求容員徑

術以句股相乘而半之得積【四千六百二十尺】爲實並句股數而半之【一百六十五尺】爲法除之得數倍之爲容員徑凡求得內容員徑五十六尺

解曰此以半周除句股形積而得容員半徑也【半周卽和和之半】

如圖從容員心分本形爲六小句股則同角之句股各

相等可以合之而各成小方形【同甲角之

兩句股成丁己小方形同丙角之兩句股可合之成丁辛長方形以心辛

丙形等丙戊心也同乙角之兩句股可合之成己庚長方形以乙庚心形

等心戊乙也】乃移己庚長方爲辛癸長方

則癸甲卽同半周而癸己大長方卽

爲半周乘半徑而與句股積等也【六小形之句皆原形之周變爲長方則兩兩相得而各用其半是半周也癸甲及壬己之長並半周壬癸及己甲辛丙之間並同心丁是半周乘半徑也辛癸長方與己庚等積卽與乙角旁兩句股等積又丁辛長方與丙角旁兩句股等積再加丁己形卽與原設乙甲丙句股形等積矣】然則以句股相乘而半之者句股形積也故以半周除之卽容員半徑矣

或以和和除四倍積得容員全徑並同前論

論曰句股形古法以和較爲容員徑與和和互相乘除乃至精之理測員海鏡引伸其例以爲測望之用其變甚多三角容員蓋從此出故爲第一支

假如【甲乙丙】銳角形乙丙邊【五十六尺】甲丙邊【七十五尺】甲乙邊【六十一尺】求容員徑

術以乙丙邊爲底求得甲丁中長綫【六十尺○法見求積】以乘底得數【三千三百六十尺】倍之【六千七百二十尺】爲實合計三邊【共一百九十二尺】爲法除之得容員徑

凡求得內容員徑三十五尺

解曰此以全周除四倍積得容員

徑也

如圖自容員心作對角綫分爲

小三角形三各以員半徑爲髙

各邊爲底若於各邊作長方而

各以邊爲長半徑爲濶必倍大

於各小三角形【如壬丙長方倍大於丙心乙形

丙丑長方倍大於丙心甲形甲丁長方倍大於甲心乙形】又

作加一倍之長方則四倍大於

各小三角【如未乙長方倍大於丙壬長方必四倍於】

【丙心乙三角則夘甲亦四倍於丙心甲而甲酉亦四倍於甲心乙】於是而通爲一大長方【移夘甲長方爲亥丙移甲酉爲乙辰則成亥午大長方形矣】必四倍原形之冪而以三邊合數爲長以容員之徑爲濶然則以中長綫乘底而倍之者正爲積之四倍也以三邊除之豈不卽得員徑乎

或以全周除倍積得容員半徑

或以半周除積得容員半徑並同

若鈍角形亦同上法

論曰銳角鈍角並以周爲法此與句股形用和和同但必先求中長綫故爲第二支

三角容員第三術

以中垂綫爲員半徑曰以量代算

假如【甲乙丙】三角形求容員徑【旣不用算故不言邊角之數】

如求積術均分甲乙二角之度各

作虛綫交於己卽己爲容員之心

次以己爲心盡一邊爲界運規作

員此員界必切三邊

於是從己心向三邊各作十字垂綫必俱在切員之防而等爲員半徑知半徑知全徑矣【半徑各如己庚綫】

論曰此容員心卽三角形之心【故以容員半徑乘半總卽得積也】又案此術亦句股及銳鈍兩角通用

三角容員第四術

用三較連乘

假如【甲乙丙】鈍角形乙丙邊【四百三十二尺】甲丙邊【五百尺】甲乙邊【一百四十八尺】求容員徑

術以半總【五百四十尺】求得乙丙邊較

【一百○八尺】甲丙邊較【四十尺】乙甲邊較

【三百九十二尺】三較連乘得數【一百六十九萬三千

四百四十尺】以半總除之得數【三千一百三十】

【六尺】四因之【一萬二千五百四十四尺】爲實平方開之得容員徑凡求得內容員徑一百一十二尺

銳角同法

解曰此所得者爲容員徑上之自乘方冪故開方得徑

三角容方第一術

合底與髙除倍積得容方徑

內分二支

一句股形卽以句股爲底爲髙【卽句股和也其容方依正方角】一三角形以一邊爲底求其垂綫爲髙【句股形以爲底銳角形三邊皆可爲底鈍角形以大邊爲底其容方並依爲底之邊】

假如【甲乙丙】句股形甲丙股【三十六尺】乙丙句【一十八尺】求容方依正方角而以容方之一角切於

術以句股相乘得數【六百四十八尺】爲實以句股和【五十四尺】爲法除之得所求

求到內容方徑一十二尺

如圖作寅乙綫與股平行作寅甲

綫與句平行成寅丙長方爲句股

形倍積

次引寅甲綫橫出截之於癸引乙

丙句橫出截之於夘使引出兩綫

【甲癸及丙夘】皆如甲丙股仍作夘癸綫聫之

乃從癸作斜綫至乙割甲丙股於戊則戊丙爲所求容方之邊又從戊作申未橫綫與上下兩綫平行割甲乙於己則己戊爲所求容方之又一邊末從己作午辛立綫割丙乙句於辛則己辛及辛丙又爲兩對邊而四邊相等爲句股形內所容之方

解曰寅夘大長方以癸乙斜綫分兩句股則相等而寅戊與戊夘兩長方等則寅丙長方與申夘長方亦等【寅丙內減寅戊而加相等之戊夘卽成申夘】夫寅丙者句股倍積而申夘者句股和乘容方徑也【乙丙句丙夘股合之爲申夘形之長申乙及未夘並同方徑爲濶】故以句股和除倍積得容方徑

又解曰寅丙長方分兩句股而等則寅戊與午丙兩長方等【寅己與己丙旣等則於寅戊內減寅己而加相等之己丙卽成午丙】而寅戊原等戊夘則午丙亦與戊夘等夫午丙形之丙甲與戊夘形之丙夘皆股也則兩形等積又等邊矣其長等其濶亦等【甲丙與丙夘旣等則辛丙與戊丙亦等】而對邊悉等卽成正方形

論曰此以句爲底股爲髙也若以股爲底句爲髙所得亦同其容方依正方角乃古法也三角以底濶合中長除積蓋生於此是爲第一術之第一支

假如【甲乙丙】句股形乙丙二十八尺其積一百六十八尺求容方依綫而以容方之兩角切於句股術以除倍積【三百三十六尺】得對角綫【一十二尺】與相並【四十尺】爲法倍積爲實法除實得所求

求到容方徑八尺四寸

如圖作寅丑綫與乙丙平行又作

寅丙及丑乙與甲丁對角綫平行成

丑丙長方爲句股形倍積

次引乙丙至夘引寅丑綫至癸使

癸丑及夘乙並同甲丁仍作癸夘綫

聫之

次從癸向丙作斜綫割丑乙綫於子遂從子作申未綫與乙丙平行割甲乙股於庚割甲丙句於己則庚己爲容方之一邊末從庚作辰壬綫從己作午辛綫並與甲丁平行而割乙丙於壬於辛則辛壬及庚壬及己辛三綫並與庚己等而成正方

解曰寅子長方與子夘長方等積【癸丙綫分寅夘形爲兩句股而等則兩句股內所作之方必等】午壬長方又與寅子等【寅丁形以甲丙綫分爲兩句股則寅己與己丁等又丑丁形以甲乙綫分爲兩句股則醜庚與丁庚等若移寅己作己丁移丑庚作丁庚則午丁等寅戊而辰丁等丑戊合之而午壬等寅子】則午壬亦與子夘等而午壬之邊【午辛及辰壬】子夘之邊【夘乙及未子】並等甲丁對角綫則兩形【午壬子夘】等積又等邊矣其長等其濶亦等【辰壬旣等夘乙則辛壬亦等子乙而庚壬及己辛亦不得不等】故四綫必俱等也

又解曰寅子旣與子夘等則寅乙必與申夘等【於寅乙內移寅子居子夘之位卽成申夘】而寅乙者倍積也申夘者底偕中長乘容方徑也【乙丙也夘乙卽甲丁對角中長綫也合之爲丙夘之長其兩端之濶申丙及未夘並同方徑】故合與對角綫爲法以除倍積得容方徑

論曰此以一邊爲底中長綫爲髙也旣以一邊爲底其容方卽依此一邊而以兩方角切餘二邊也句股形故以爲底若銳角形則任以一邊爲底但依大邊則容方轉小亦如句股形依方角之容方必大於依綫之容方也鈍角形但可以大邊爲底其求之則皆一法也是爲第一術之第二支

三角容方第二術

以圖算

內分二支

一以法截中長綫得容方徑【句股形卽截其邊】

一以法截兩斜邊得容方邊【句股形卽截其】

假如銳角形求容方任以一邊爲底

如圖以乙丙最小邊爲底先從對角甲作中長垂綫至丁又從乙角作丑乙立綫與甲丁平行而等乃從甲角

作橫綫過醜至癸截丑癸亦如甲

丁乃從癸向丙角作斜綫割醜乙

立綫於子末以子乙之度截中長

綫【甲丁垂綫】於戊卽戊丁爲容方之徑

【從戊作己庚又從己作綫至辛從庚作綫至壬成庚己辛壬卽所求

容方】

解曰甲戊與戊丁若甲丁與乙丙【子丑癸句股與子乙丙形有子交角必相似則丑子句與子乙句若丑癸股與乙丙股而丑子原與甲戊等子乙與戊丁等丑癸與甲丁等則甲戊與戊丁亦若甲丁與乙丙】又甲戊與己庚若甲丁與乙丙【甲己庚三角爲甲丙乙之截形必相似則甲戊與己庚若甲丁與乙丙】

合兩比例觀之則甲戊與戊丁若甲戊與己庚而己庚卽戊丁

以上並銳角形

凡銳角三邊並可

爲底而皆一法

假如句股形求容方以股爲底則於句端甲作橫綫與股平行而截之於癸使癸甲如甲乙句乃自癸向丙作斜綫割甲乙句於戊則戊乙卽容方之一邊末作己戊與股平行作己辛與句平行卽成容方【或以句爲底則從股端丙作丙癸橫綫與股等亦作癸甲斜綫割丙乙股於戊其所得容方亦同圖如左】

論曰銳角鈍角皆截中長綫爲容方徑句股形以爲底亦然惟句股形以句爲底卽截其股爲容方徑【用股爲底卽截句】不另求中長而與截中長之法並同是爲第二術之第一支

假如乙丙丁三角求容方依乙丙邊爲底

如圖以乙丙底作正方形【卽甲乙丙戊方】又作丁辛對角綫次作甲辛及戊

辛兩斜綫割原形之兩斜綫於己

於庚乃作己庚綫爲所求容方之

一邊【末作己壬及庚癸兩綫成小方形於形內卽所求】

解曰甲戊與己庚若子辛與午辛也【己庚辛三角形爲甲戊辛之切形則其橫與直之比例相等】而甲戊與子辛同爲方徑而等則己庚與午辛亦同爲小方徑而等

若底上方形大則其徑亦大於對

角綫則如第二圖引丁辛綫至子

其理亦同

有此二法則三邊並可爲底

鈍角形用大邊爲底句股形用爲底並同第二圖

若句股形以句爲底求容方如圖卽用乙丙句作【丙辛庚乙】方形從方角庚向丙作斜綫割丁乙於壬從壬作癸

壬及甲壬二綫卽所容方【或用股上方則

引出句邊如股】

解曰庚丙綫分丙角爲兩平分則

其橫直綫自相等【壬癸與癸丙相等壬甲與甲丙】

【相等則四綫皆等】而成正方嘉禾陳防庵用分角法求容方與此同理

論曰此皆以底上方形爲法而得所求小方也故不論頂之偏正其所得容方並同惟句股容方依正方角則中長綫與原邊合而爲一法𨿽小異其用不殊是爲第二術之第二支

三角形外切平員第一術

句股形以爲徑

假如甲乙丙句股形乙丙長四尺五寸二分求外切員

術以折半取心得半徑二尺二寸六分其長四尺五寸二分卽外切平員全徑以平員周率三五五乘之徑率一一三除之得員周一十四尺二寸

如圖乙丙員徑卽句股形之折半於丁卽員心也以

乙丁半徑爲度從丁心運規作員

必過甲而句股形之角皆切員周

矣

論曰凡平員徑上從兩端各作直綫至員周相防則成正方角【如乙丙徑之兩端於丙於乙各作直綫防於甲則甲角必爲正角】而爲句股形【假令兩綫相遇於庚卽成庚乙丙句股形於辛亦然以其皆正角故也】故不問句股長短而並以其爲外切員之徑

又論曰徑一百一十三而周三百五十五此鄭端淸世子所述祖衝之術也【見律呂精義】按古率周三徑一李淳風等釋古九章以爲術從簡易舉大綱而言之誠爲通論諸家所傳徑五十周一百五十七則魏劉徽所攺謂之徽率徑七周二十二則祖衝之所定謂之宻率由今以觀衝之自有兩率【一爲七與二十二一爲一一三與三五五】蓋以其捷者爲恆用之須而存其精者明測算之理亦可以觀古人之用心矣

三角形外切平員第二術

分邊取員心內分二支並以圖算

一句股形但分一邊卽得員心【其心在】

一銳角形鈍角形並分二邊可得員心【銳角形員心在形內鈍角形員心在形外】

假如甲乙丙句股形求外切員

術任於句或股平分之作十字正綫此綫過綫之防卽爲員心

如圖甲乙丙形以甲乙股平分於

戊從戊作庚丁正十字綫至乙丙

卽分爲兩平分而丁卽員心

從丁運規作外切員則甲乙丙三

防並切員周而乙丁丙丁庚丁皆半徑

論曰若平分甲丙句於辛從辛作十字正綫亦必至丁故但任分其一邊卽可得心

又論曰若依第一術先得丁心從丁心作直綫與句平行卽此綫能分股綫爲兩平分【如丁庚綫與甲丙句平行過甲乙股卽平分股綫於戊】若與股平行而分句綫亦然【如丁辛綫與甲乙股平行卽分句綫於辛】右句股形外切平員之心在綫中央

假如銳角形求形外切員

術任以兩邊各平分之作十字綫引長之必相遇於一防卽爲員心

如圖甲乙丙銳角形任以甲丙邊

平分之於戊作庚戊丁十字綫又

任以乙丙邊平分之於壬作癸壬

丁十字綫兩直綫稍引長之相遇

於丁以丁爲心作員則甲乙丙三角並切員周而丁癸丁庚皆半徑

論曰試於餘一邊再平分之作十字正綫亦必防於此防故此防必員心【如甲乙邊再平分之於辛作子辛丁十字綫亦必相遇於丁防】

右銳角形外切平員之心在形之內

假如鈍角形求形外切員術同銳角

如圖甲乙丙形甲爲鈍角任分甲

丙於戊分甲乙於辛各作十字綫

防於丁心從丁作員則丁庚丁癸

皆半徑而三角並切員周若用大

邊平分於壬作壬丁子綫亦同

論曰試於丁心作綫至丙至乙至甲必皆成員半徑與丁庚丁癸同故丁爲員心也

右鈍角形外切平員之心在形之外

總論曰此與容員之法不同何也內容員之心卽三角形之心故其半徑皆與各邊爲垂綫而不能平分其邊然從心作綫至角卽能分各角爲兩平分此分角求心之法所由以立也外切員之心非三角形之心其心或在形內或在形外距邊不等而能以十字綫剖各邊爲兩平分此分邊求心之法所由以立蓋卽三防串員之法也

附三防串員

有甲乙丙三防欲使之並在員周

術任以甲爲心作虛員分用元度

以丙爲心亦作虛員分兩員分相

交於戊於辛作戊辛直綫又任以

乙爲心以丙爲心各作同度之虛員分相交於庚於壬作庚壬直綫兩直綫相遇於丁以丁爲心作員則三防並在員周

員周有三防不知其心亦用此法

歷算全書卷五十二﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

欽定四庫全書

歷算全書卷五十三

宣城梅文鼎撰

三角法舉要卷四

或問【三角大意略具首卷中而入算取用仍有疑端喜同學之好問事事必求其所以然故不憚爲

之詳復以暢厥防】

一三角形用正爲比例之理

一和較相求之理

一用切綫分外角之理

一三較連乘之理

附三較求角

問各角正與各邊皆不平行何以能相爲比例曰凡三角形一邊必對一角其角大者正大而所對之邊亦大角小者正小而所對之邊亦小故邊與邊之比例如正與正也

兩正爲兩邊比例圖

乙丙丁三角形丁乙邊大對丙角

丁丙邊小對乙角術爲以丁乙邊

比丁丙邊若丙角之正與乙角

之正

解曰試以丁丙爲半徑作丁甲綫爲丙角正又截戊乙如丁丙半徑作戊己綫爲乙角正丁甲正大於戊己故丁乙邊亦大於丁丙

問丁甲何以獨爲丙角正也曰此以丁丙爲半徑故也若以丁乙爲半徑則丁甲卽爲乙角之正如圖用丁乙爲半徑作丁甲綫爲乙角正又引丙丁至戊令戊丙如丁乙半徑作戊己綫爲丙角正

卽見乙角之正丁甲小於戊己

故丁丙邊亦小於丁乙

解曰正者半徑所生也故必兩

半徑齊同始可以較其大小前圖

截戊乙如丁丙此圖引丁丙如丁乙所以同之也

三正逓相爲三邊比例圖

乙丁丙鈍角形丁鈍角對乙丙大邊丙次大角對乙丁次大邊乙小角對丁丙小邊其各邊比例皆各角正之比例

試以乙丁爲半徑作丁甲綫爲乙

小角之正又引丙丁邊至戊使

戊丙如乙丁作戊己綫爲丙角之

正又展戊丙綫至庚使庚丙如乙

丙作庚辛綫爲丁鈍角之正【如此則三邊皆若三正皆若股】其比例爲以乙丙大邊【同庚丙】比乙丁次邊【同戊丙】若丁鈍角之正庚辛與丙角之正戊己

又以乙丁次大邊【同戊丙】比丁丙小邊若丙角之正戊己與乙角之正丁甲

又以丁丙小邊比乙丙大邊【同庚丙】若乙小角之正丁甲與丁鈍角之正庚辛

問庚辛何以爲丁角正曰凡鈍角以外角之正爲正試作乙癸綫爲丁角正【乙丁癸角外角也故其正卽爲丁鈍角正】必與庚辛等何也庚丙辛句股形與乙丙癸形等【庚丙旣同乙丙又同用丙角辛與癸又同爲方角故其形必等】則庚辛必等乙癸而乙癸旣丁角正矣等乙癸之庚辛又安得不爲丁角正乎【凡取正必齊其半徑此以丁甲爲乙角正是用乙丁爲半徑也而取丙角正戊己必引戊丙如乙丁其丁角正庚辛又卽外角之正乙癸是三半徑皆乙丁也】

試取壬丙如丁丙作庚壬綫卽同

乙丁半徑則壬角同丁角壬外角

卽丁外角而庚辛正之半徑仍

爲乙丁【庚壬同乙丁故】

此以庚壬當乙丁易乙丁丙形爲

庚壬丙則庚辛正亦歸本位與前圖互明

試以各角正同居一象限較其弧度

如圖甲乙丙形丙角最大其正乙丁亦最大所對甲乙邊亦最大甲角次大其正醜壬亦次大所對

乙丙邊亦次大乙角最小其正

丙夘亦小所對丙甲邊亦最小【丙乙

二角正並乙丙爲半徑甲角取正截醜甲如乙丙亦以乙丙爲

半徑】乃別作一象弧【如戊己】仍用乙丙

爲半徑【取戊庚如乙丙】而以先所得各角

之餘取度於丁作乙丁爲丙角

之正於壬作醜壬爲甲角之正

於夘作丙夘爲乙角之正卽

如元度而各角之差數覩矣【戊庚半徑旣同乙丙則丁庚卽丁丙而爲丙角余又壬庚卽甲壬爲甲角余夘庚卽夘乙爲乙角余】

解曰角無大小以弧而知其大小今乙丁正其弧乙己是丙角最大也醜壬正其弧醜己是甲角次大也丙夘正其弧丙己是乙角最小也而對邊之大小亦如之故皆以正爲比例也

或疑鈍角之度益大其正反漸小而其所對之邊則漸大何以能相爲比例乎曰此易知也凡鈍角正卽外角之正而外角度原兼有餘兩角之度故鈍角之正必大於余兩角而得爲大邊之比例也如乙丙甲鈍角形丙鈍角最大其正乙丁亦最大而所對乙甲邊亦最大乙角次大其正丙夘亦次大而所對甲丙邊亦次大甲角最小其正醜壬亦小而所對乙丙邊亦最小【截甲醜如乙丙從丑作醜壬卽甲角正】

乃從乙作乙庚弧【以丙爲心乙丙爲半徑】爲

丙外角之度又作辛丙半徑與甲

乙平行分乙庚弧度爲兩則辛庚

卽甲角之弧度其餘辛乙亦卽乙

角之弧度從辛作辛未正與丑

壬等又自庚截癸庚度如辛乙則

癸庚亦乙角之弧作癸子正與丙夘等此顯丙外角之度兼有乙甲兩角之度其正必大於兩角正也𨿽丙鈍角加大而外角加小則乙甲兩角必又小於外角又何疑於鈍角正必爲大邊比例乎

試更以各角切員觀之則各角之對邊皆爲其對弧之通

如圖三角形以各角切員則乙丙邊爲丙戊乙弧之通而對甲角甲丙邊爲丙己甲弧之通而對乙

角甲乙邊爲乙庚甲弧之通而

對丙角則是各角之對邊卽各角

對弧之通也夫通者正之

倍數則三邊比例卽三正之比

例矣

又試以各邊平分之則皆成各角之正

於前圖內更以各邊所當之弧皆平分之【丙戊乙弧平分於戊防丙己甲弧平分於己防乙庚甲弧平分於庚防】自員心【丁】各作半徑至其

防卽分各邊爲兩平分【以丁壬戊

半徑分乙丙邊於壬以丁辛己半徑分甲丙邊於辛以丁

癸庚半徑分甲乙邊於癸則所分之邊皆爲兩平分】則

弧之平分者卽原設各角之

度而邊之平分者卽皆各角

之正【丙丁戊角以丙戊爲弧丙壬爲正而丙

丁戊角原爲丙丁乙角之半必與甲角同大故丙戊半弧

卽甲角之本度丙壬半邊卽甲角之正乙丁戊角亦然】

【凖此論之則甲丁己角原爲甲丁丙角之半必與乙角同大故甲己半弧卽乙角之本度甲辛半邊卽乙角之正己丁丙角亦然又乙丁庚角原爲乙丁甲角之半必與丙角同大故乙庚半弧卽丙角之本度乙癸半邊卽丙角之正庚丁甲角亦然】夫分其邊之半卽皆成正則邊與邊之比例亦必如正與正矣【全與全若半與半也】

問三角之本度皆用半弧何也曰量角度必以角爲員心眞度乃見今三角皆切員邊則所作通之弧皆倍度也故半之乃爲角之本度

如圖以甲角爲心甲丁爲半徑作員則其弧丑丁子乃甲角之本度也而平分之丙戊及戊乙兩弧並與丑丁子弧等【試作戊丙及乙戊兩必相等又並與丑子等凡等者弧亦等】故乙

戊丙弧必爲甲角之倍度

【余角類推】

問三邊求角何以用和較相乘也曰欲明和較之用當先知和較之根凡大小兩方以其邊相並謂之和相減謂之較和較相乘者兩方相減之餘積也

如圖甲癸小方丁癸大方於大方

內依小方邊作己庚橫綫又取己

辛如小方邊作辛壬綫成己壬小

方與甲癸等大方內減己壬小方

則所餘者爲乙庚及庚壬兩長方

形夫乙己及丁庚及庚辛並兩邊之較也甲己庚則和也若移庚壬長方爲乙甲長方卽成丁甲大長方而爲較乘和之積故凡兩方相減之餘積爲實以和除之得較以較除之亦得和矣

依此論之若有兩方形相減又別有兩方相減而其餘積等則爲公積故以此兩方之和較相乘爲實而以彼兩方之和爲法除之得彼兩方之較或以彼兩方之較爲法除之亦必得和

【如圖有方二十九之冪八百四十一與方二十七之冪七

百二十九相減成較二乘和五十六之積

又有方十六之冪二百五十六與方十二之冪一百四十

四相減成較四乘和二十八之積

兩積同爲一百一十二故以先有之較二和五十六相乘】

【爲實以今有之和二十八爲法除之卽得較四爲今所求數】

是故三角形以兩之和乘較爲實以兩分底之和爲法除之得較者爲兩和較相乘同積也兩和較相乘同積者各兩方相減同積也

何以明之曰凡三角形以中長綫分爲兩句股則兩形同以中長綫爲股而各以分底綫爲句是股同而句不同也句不同者不同也大者句亦大小者句亦小故兩上方相減必與兩句上方相減之餘積等而兩和較相乘亦等

如圖甲乙丙三角形以甲丁中長綫分爲兩句股形則丙乙爲兩句之和【未寅及子夘並同】丙戊爲兩句之較【未子及寅夘並

同】未夘長方爲兩句之較乘

和也又丙己爲兩之和【辰壬

同】酉丙爲兩之較【辰癸及辛庚壬

午並同】癸壬長方爲兩之較

乘和也此兩長方必等積

問兩上方大於兩句上方何以知其等積曰依句股法上方冪必兼有句股上方冪是故甲丙冪內【卽癸甲大方】必兼有甲丁股丙丁句兩冪乙甲冪內【卽辛己小方】亦兼有甲丁股乙丁句兩冪則是甲丁股冪者兩冪所同也其不同者句冪耳【股冪旣同則冪相減時股冪俱對減而盡使非句冪不同巳無餘積】然則兩冪相減之餘積【於癸甲大方內減己辛相同之申甲小方所餘者癸辛申丙兩長方成磬折形】豈不卽爲兩句冪相減之餘積乎【於丁子方內減丁寅相同之戊丑小方所所餘者丑子及戊未兩長方成磬折形】由是言之兩和較相乘之等積信矣【於冪相減之癸辛申丙磬折形內移申丙補庚壬卽成和較相乘之癸壬長方又於句冪相減之丑子未戊磬折形內移戊未補丑夘卽成和較相乘之未夘長方兩磬折形旣等積則兩長方亦等積】

問和較之列四率與諸例不同何也曰此互視法也同文算指謂之變測古九章謂之同乘異除乃三率之別調也何則凡異乘同除皆以原有兩率之比例爲今兩率之比例其首率爲法必在原有兩率之中互視之術則反以原有之兩率爲二爲三以自相乘爲實其首率爲法者反系今有之率與異乘同除之序相反故曰別調也

然則又何以仍列四率曰以相乘同實也三率之術二三相乘與一四相乘同實故可以三率求一率【二三相乘以一除之得四以四除之卽仍得一若一四相乘以二除之亦可得三以三除之亦仍得二】互視之術以原有之兩率自相乘與今有之兩率自相乘同實故亦以三率求一率【原兩率自相乘以今有之率除之得今有之餘一率若今兩率自相乘以原有之率除之亦卽得原有之餘一率】但三率之術以比例成其同實互視之術則以同實而成其比例旣成比例卽有四率故可以列而求之也

如圖長方形對角斜剖成兩句股則相等而其中所成

小句股亦相等【甲壬戊與甲己戊等則甲

乙丙與甲辛丙等丙丁戊與丙庚戊等並長方均剖故也】卽所成長方之積亦必相等

【於甲壬戊句股形內減去相等之甲乙丙及丙丁戊兩小】

【句股存乙丙丁壬長方又於甲己戊句股形內減去相等之甲辛丙及丙庚戊兩小句股存辛己庚丙長方所減之數等則所存之數亦等故兩長方𨿽長濶不同而知其必爲等積】今以甲乙爲首率乙丙爲次率丙丁爲三率丁戊爲四率則乙丁長方【卽乙丙丁壬形】爲二三相乘之積【此形以乙丙二率爲濶丙丁三率爲長是二率三率相乘也】辛庚長方【卽辛己庚丙形】爲一四相乘之積【此形以辛丙爲長丙庚爲濶而辛丙原同甲乙乃一率也丙庚原同丁戊乃四率也是一率四率相乘也】旣兩長方相等則二三相乘與一四相乘等實矣此列率之理也

一

甲乙

二

丙乙

三

丙丁

四

戊丁

在異乘同除本術則甲乙及丙乙爲原有之數丙丁爲今有之數戊丁爲今求之數其術爲以原有之甲乙股比原有之丙乙句若今有之丙丁股與戊丁句也故於原有中取丙乙句與今有之丙丁股以異名相乘爲實又於原有中取同名之甲乙股爲法除之卽得今所求之丁戊句是先知四率之比例而以乘除之故成兩長方【二率乘三率成乙丁長方以首率除之必變爲辛庚長方】故曰以比例成其同實也

互視之術則乙丙與丙丁爲原有之數甲乙爲今有之數丁戊爲今求之數術爲以乙丙較乘丙丁和之積若丙庚較【卽丁戊】乘丙辛和【卽甲乙】之積故以原有之乙丙較丙丁和自相乘爲實以今有之甲乙和【卽辛丙】爲法除之卽得今所求之丁戊較【卽丙庚】是先知兩長方同積而以四率取之故曰以同實成其比例也

然則又何以謂之互視曰三率之用以原有兩件自相比之例爲今有兩件自相比之例是視此之差等爲彼之差等如相慕效故大句比大股若小句比小股【大句小於大股幾倍小句亦小於小股幾倍又大句大於小句幾倍大股亦大於小股幾倍】互視之用以原有一件與今一件相比之例爲今又一件與原又一件相比之例是此視彼之所來以往彼亦視此之所往以來如互相酬報故之較比句之較反若句之和比之和【之和大於句故句之較反大於若和之數大於句幾倍則較之數句大於亦幾倍】是以別之爲互視也

如圖以甲乙爲一率丙乙爲二率丙丁爲三率丁戊爲四率作甲戊成兩句股次引甲乙及丁戊防於壬成

乙丁長方爲二三相乘之積

亦引乙丙至庚引丁丙至辛

作甲辛及戊庚綫並引長之

防於己成辛庚長方爲一四

相乘之積是先有比例而成

同實之長方

如圖乙丙乘丙丁爲乙丁長

方辛丙乘丙庚爲辛庚長方

兩長方以角相連於丙次引

己辛及乙壬防於甲引己庚

及壬丁防於戊乃作甲戊綫

則辛丙與丙丁若乙丙與丙

庚是先知同實而成其比例

也

問三角形兩又術用外角切綫何也曰此分角法也一角在兩邊之中則角無所對之邊邊無所對之角不可以正爲比例今欲求未知之兩角故借外角分之也然則何以用半較角曰較角者本形中未知兩角之較也此兩角之度合之卽爲外角之度必求其較角然後可分而較角不可求故求其半知半較知全較矣此用半較角之理也

如圖甲丙乙形先有丙角則甲丙丁爲外角外角內作

丙辛綫與乙甲平行則辛

丙丁角與乙角等辛丙甲

角與甲角等

其辛丙庚角爲兩角之較而辛丙己角其半較也己丙丁及己丙甲皆半外角也以半較角與半外角相減成乙角【於丁丙己內減辛丙己其餘丁丙辛卽乙角度】若相加亦成甲角【於己丙甲加辛丙己成辛丙甲卽甲角度】

半較角用切綫何也曰此比例法也角與所對之邊並以正爲比例今旣無正可論而有其所對之邊故卽以邊爲比例【角之正可以例邊則邊之大小亦可以例角】是故乙丁者兩邊之總也乙癸者兩邊之較也而戊己者半外角之切綫也壬己者半較角之切綫也以乙丁比乙癸若戊己與壬己故以切綫爲比例也

然則何以不徑用正曰凡一角分爲兩角則正因度離立不同在一綫不可以求其比例其在一綫者惟切綫耳而邊之比例與切綫相應切綫比例又原與正相應故用切綫實用正也

如圖甲丙丁外角其弧甲

己丁於辛作辛丙綫分其

角爲兩則小角之弧丁辛

其正夘丁大角之弧辛

甲其正甲醜【小角正當乙角之

對邊甲丙大角正當甲角之對邊乙丙】

今欲移正之比例於一綫先作甲丁通割分角綫於子則子甲與子丁若甲丑與夘丁【甲丑子與丁夘子兩句股形有子交角等丑夘皆正角卽兩形相似而比例等然則子甲者大形之子丁者小形之而甲醜者大形之股夘丁者小形之股也與若股與股故子甲比子丁若丑甲與夘丁】而甲丁卽兩正之總【甲丁爲子甲子丁之總亦卽爲甲醜夘丁之總】辰子卽兩正之較【以子丁減子甲其較辰子是辰子爲子甲子丁之較亦卽爲甲醜夘丁之較】平分甲丁半之於酉則酉丁爲半總酉子爲半較其比例同也【全與全若半與半故甲丁與辰子爲兩正之總與較則半之而爲酉丁與酉子亦必若兩正之總與較】

於是作午戊切員綫【引平分綫丙酉至己分甲己丁弧於己自己作午戊綫與己丙爲十字垂綫卽此綫爲切員綫】與甲丁平行引諸綫至其上【引丙甲至午引丙丁至戊引丙辰割庚防至未引丙夘割辛防至壬】則午戊切綫上比例與甲丁通等而正之比例在切綫矣【先以甲丁與辰子當兩正之總與較今午戊與未壬亦可當兩正之總與較則先以酉丁與酉子爲半總半較者今亦以己戊與己壬爲半總半較矣】故曰用切綫實用正也【切綫與正所以能同比例者以有通作之合也】問三較連乘之理曰亦句股術也以句股爲比例而以三率之理轉換之則用法最精之處也故三較連乘卽得容員半徑上方乘半總之積

假如甲乙丙三角形甲丙邊

一百五十甲乙邊一百二十

二乙丙邊一百一十二術以

半總一百九十二較各邊得

甲丙之較四十二甲乙之較

七十乙丙之較八十三較連

乘得數二十三萬五千二百

卽容員半徑自乘又乘半總

之積也

置三較連乘數以半總除之得數【一千二百二十五】平方開之得容員半徑【三十五】倍之得容員徑【七十】

置三較連乘數以半總乘之得數【四千五百一十五萬八千四百】平方開之得三角形積【六千七百二十】

若如常法求得中長綫【一百二十】以乘乙丙底而半之所得積數亦同

然則何以見其爲句股比例曰試從形心如法作綫分爲六句股形【形心卽容員心】又引甲丙邊至夘使夘丙如乙戊引甲乙邊至辰使乙辰如己丙則甲夘甲辰並半總【六小句股形之句各於其兩相同者而取其一卽成半總】而丙夘爲甲丙邊

之較【卽乙戊或乙辛】乙辰爲甲乙邊

之較【卽己丙或辛丙】甲己爲乙丙邊

之較【己丙同辛丙又丙夘同乙辛則夘己同乙丙而

甲己爲其較若用辰戊以當乙丙則甲戊爲較亦同】又

從夘作夘壬十字垂綫至壬

【此綫與丁己員半徑平行】引甲丁分角綫出形外遇於壬成甲夘壬大句股形與甲己丁小句股之比例等【從辰作辰壬綫成甲辰壬大句股與甲戊丁小句股爲比例亦同】術爲以丁己比壬夘若甲己與甲夘也次以丁己自乘方爲一率以丁己乘壬夘之長方爲次率則其比例仍若甲己三率與甲夘四率也【乘之者並丁己故所乘之丁己與壬夘比例不變也】

以數明之甲己八十甲夘一百九十二爲二倍四分比例丁己三十五壬夘八十四亦二倍四分比例丁己自乘一千二百二十五丁己乘壬夘二千九百四十亦二倍四分比例故曰比例等

又移辛防至癸截丙癸如丙夘則乙癸亦如乙辰引丙夘至午使夘午同乙辰【亦同乙癸】引乙辰至未使辰未同丙夘【亦同丙癸】則午丙及未乙並同乙丙又作丙壬乙壬午壬未壬四綫成午丙壬及乙未壬及乙丙壬各三角形皆相等【丙夘壬句股形與未辰壬等則丙壬必等未壬又午夘壬句股形與乙辰壬等則午壬等乙壬而午丙壬及乙未壬兩三角形必等矣其乙丙壬三角形旣以乙丙與兩三角形同

底又同用丙壬乙壬兩亦不得不等】於是自

癸作癸壬垂綫【夘壬辰壬並垂綫故癸壬

亦必垂綫】成丙癸壬句股形與丙

夘壬形等卽成癸丙夘壬四

邊形與丁己丙辛小四邊形

爲相似形【夘與癸俱方角而小形之己與辛亦方】

【角則大形之丙角與壬角合之亦兩方角也而小形之丙角原爲大形丙角之外角合之亦兩方角也則小形之丙角與大形之壬角等而小形之丁角亦與大形之丙角等是大小兩形之四角俱等而爲相似形】則丁己丙句股形與丙夘壬形亦相似而比例等【大小兩四邊形各均剖其半以成句股則其相似之比例不變全與全若半與半也】術爲以丁己比己丙若丙夘與夘壬也

一丁己

二己丙

三丙卯卽甲丙之較戊乙

四卯壬

凡三率法中二三相乘一四相乘其積皆等則己丙乘丙卯之積卽丁己乘卯壬之積可通用也先定以丁己自乘比丁己乘卯壬若甲己與甲卯今以三率之理通之爲以丁己自乘比己丙乘丙卯亦若甲己與甲卯

一丁己自乘方

卽容員半徑自乘

二己丙乘丙卯長方卽甲乙之較乘甲丙之數

三甲己

卽乙丙之較

四甲卯

卽半總

復以三率之理轉換用之則三較連乘之積【以己丙較乘戊乙較爲二率又以甲己較爲三率乘之是二三相乘卽三較連乘】卽容員半徑自乘方乘半總之積也【以丁己半徑自乘爲首率以甲卯半總爲四率乘之是一四相乘也凡一四相乘必與二三相乘之積等】

以數明之丁己【三十五】卯壬【八十四】相乘得二千九百四十己丙【七十】丙卯【四十二】相乘亦二千九百四十故可通用

己丙乘丙卯【二千九百四十】又以甲己【八十】乘之得二十三萬五千二百丁己自乘【一千二百二十五】又以甲卯【一百九十二】乘之亦二十三萬五千二百故可通用

問三較之術可以求角乎曰可其所求角皆先得半角卽銳鈍通爲一術矣

術曰以三邊各減半總得較各以所求角對邊之較乘半總爲法以余兩較各與半徑全數相乘又自相乘爲實法除實得數平方開之爲半角切綫撿表得度倍之爲所求角

假如甲乙丙三角形甲丙邊

七十五甲乙邊五十六乙丙

邊六十一與半總九十六各

相減得甲丙之較二十一甲

乙之較四十乙丙之較三十

五

今求乙角術以乙角所對邊

甲丙之較【二一】乘半總【九六】得數

【二○一六】爲法以余兩較【甲乙較四○乙

丙較三五】各乘半徑全數又自相

乘得數【一四○○○○○○○○○○○○】爲

實法除實得數【六九四四四四四四四四】平方開之得數【八三三三三】爲半

角切綫撿表【三十九度四十八分一十九秒】倍之得乙角【七十九度三十六分三十八秒】

次求丙角術以丙角所對邊甲乙之較【四○】乘半總得數【三八四○】爲法余兩較【甲丙二一乙丙三五】各乘半徑全數又自相乘得數【七三五○○○○○○○○○○】爲實法除實得數【一九一四○六二五○○】平方開之得半角切綫【四三七五○】撿表【二十三度三十七分五十二秒半】倍之得丙角【四十七度一十五分四十五秒】

次求甲角術以甲角所對邊乙丙之較【三五】乘半總得數【三三六○】爲法余兩較【甲丙二一甲乙四○】各乘半徑全數又自相乘得數【八四○○○○○○○○○○○】爲實法除實得數【二五○○○○○○○○】平方開之得半角切綫【五○○○○】撿表【二十六度三十三分五十三秒】倍之得甲角【五十三度○七分四十六秒】

問前條用三較連乘今只用一較爲除法何也曰前條求總積故三較連乘今有専求之角故以對邊之較爲法也然則用對邊何也曰對邊之較在所求角之兩旁爲所分小句股形之句今求半角切綫故以此小句爲法也

如求乙半角則所用者角旁小句股【心戊乙或心丁乙】其句【乙戊或乙丁】並二十一卽對邊甲丙之較也術爲以乙戊比心戊若半徑與乙角【小形之角卽半角也】之切綫

其與半總相乘何也曰將以半

總除之又以小形句【卽對邊之較】除

之今以兩除法【一半總一對邊之較卽小形句】相乘然後除之變兩次除爲一

次除也【古謂之異除同除】

用兩次除亦有說乎曰前條三較連乘必以半總除之而得容員半徑之方冪今欲以方冪爲用故亦以半總除也然則又何以對邊之較除曰非但以較除也乃以較之冪除也何以言之曰原法三較連乘爲實今只以兩較乘是省一乘也旣省一對邊之較乘又以對邊之較除之是以較除兩次也卽如以較自乘之冪除之矣余兩較相乘先又各乘半徑何也曰此三率之精理也凡綫與綫相乘除所得者綫也冪與冪相乘除所得者冪也先旣定乙戊句爲首率心戊股【卽容員半徑】爲次率半徑爲三率乙角切綫爲四率而今無心戊之數惟三較連乘中有心戊【卽容員半徑】自乘之冪【卽三較連乘半總除之之數】故變四率並爲冪以乙戊句冪爲首率【卽對邊之較除兩次】心戊股冪爲次率【卽半總除連乘數】半徑之冪爲三率【卽半徑自乘】得半角切綫之冪爲四率【卽分形之乙角】

一乙戊

今用乙戊自乘

二心戊

心戊自乘

三半徑

半徑自乘

四乙角切綫

切綫自乘

故得數開方卽成切綫

又術

以三較連乘半總除之開方爲中垂綫【卽容員半徑】以半徑全數乘之爲實各以所求角對邊之較除之卽得半角切綫

一乙戊【乙角對邊之較】丙戊【丙角對邊之較】甲己【甲角對邊之較】二心戊中垂綫心戊中垂綫心己中垂綫【亦卽心戊】三半徑全數

半徑全數

半徑全數四乙半角切綫丙半角切緣甲半角切綫

此卽用前圖可解乃本法也

論曰常法三邊求角倘遇鈍角必於得角之後又加審焉以鈍角與外角同一八綫也今所得者旣爲半角則無此疑實爲求角之防法

補遺

問以邊求角【句股第二術】因和較乘除而知正角乃定其爲句股形何也曰古法句較乘句和開方得股今大邊【壬丁】與小邊【癸丁】以和較相乘爲實癸壬邊爲法除之而仍得癸壬是適合開方之積也則大邊小邊之和較卽句之和較而癸爲正角成句股形矣【凡句股形爲大邊而對正角今丁壬邊最大卽也故所對之癸角爲正角】

試再以丁壬與壬癸之和較求之

如法用丁壬壬癸相加得和【一百九十

六丈】相減得較【一十六丈】較乘和【三千一百三十

六丈】爲實丁癸【五十六丈】爲法除之亦仍

得五十六丈何則股較乘和亦

開方得句故也

然則句股和較之法又安從生曰生於割圜

試以丁壬爲半徑作戊丁丙己圜全徑二百一十二半徑一百○六乙丁正九十【卽癸壬股】乙壬余

五十六【卽癸丁句】丙乙正矢五

十【卽句較】乙庚大矢一百六十

二【卽句和】正矢乘大矢得數八

千一百開方得正【卽句和乘較開方

得股】

然則此八千一百者旣爲正矢大矢相乘之積又爲正自乘之積故以正自乘爲實而正矢除之可以得大矢大矢除之亦得正矢【卽乙丁股自乘爲實而以句較丙乙除之得乙庚爲句和若以句和除之亦得句較】

更之則正矢乘大矢爲實以正除之仍得正矣【卽句較丙乙乘句和乙庚爲實以乙丁股爲法除之而仍復得股】

論曰句股形在平圜內其半徑恆爲若正余則爲句爲股可以互用故其理亦可互明【以丁壬及丁癸二邊取和較求壬癸邊爲句求股以丁壬及壬癸二邊取和較求丁癸邊爲股求句一而已矣】

問數則合矣其理云何曰仍句股術也

如上圖於圜徑兩端【如丙如庚】各作通綫至正【丁乙】之銳

【如庚乙丙乙】成丙乙庚大句股形又

因中有正成大小兩句股形

【乙丁庚爲大形乙丙丁爲小形】而相似【以乙丁綫分正

角爲兩則小形乙角爲大形乙角之餘而與庚角等卽大形乙

角亦與小形丙角等故兩形相似】則乙丁正

旣爲小形之股又爲大形之句其比例爲丙丁【小形句】與乙丁【小形股】若乙丁【大形句】與丁庚【大形股】也故正矢【丁丙】乘大矢【丁庚】與正【乙丁】自乘等積【丙庚全徑爲正所分其一丁丙正矢爲小形之句而乙丁正爲其股其一丁庚大矢爲大形之股而乙丁正爲其句】

一丁丙正矢小形句

凡二率三率相乘與一二乙丁正小形股

四相乘等積故乙丁自三乙丁正大形句

乘卽與丁丙丁庚相乘四丁庚大矢大形股

等積也

論曰凡割圜算法専恃句股古法西法所同也故論句股者必以割圜而論割圜者仍以句股如根株華實之相須乃本法非旁證也

或疑切綫分外角以正爲比例恐不可施於鈍角作此明之

甲丙乙鈍角形先有丙角及丙甲丙乙二邊求余角一率丁乙【邊總】二率癸乙【邊較】三率己戊【半外角切綫】四率壬己【半較角切綫】

論曰試作壬丙綫與乙甲平行分外角爲兩則壬丙丁卽乙角其正卯丁又甲丙壬卽甲角其正甲醜以兩句股【丑子甲卯子丁】相似之故能令兩正【丑甲卯丁】之比例移於通以成和較【丑甲與卯丁旣若子甲與子丁則丁甲卽兩正之和辰子卽兩正之較】而半外角半較角之算以生【半外角爲和半較角爲較並與兩正之和較同比例卽與兩邊之和較同比例】並如銳角

又論曰此所分大角爲鈍角故甲醜正作於形外然𨿽在形外而引分角綫至醜適與之防卽能成丑子甲句股形與卯子丁相似而生比例

【丙乙甲形先有丙角求余角法爲邊總丁乙與邊較乙癸若半外角切綫戊己與半較角切綫未己此亦因所分爲鈍角故卯丁正在形外又大邊爲半徑故乙癸較亦在形外而丁乙爲和余並同前】

【丙甲乙形先有丙角求余角法爲邊總丁乙與邊較乙癸若半外角切綫己戊與半較角切綫己壬此因先得鈍角故所分之內反無鈍角而正所作之小句股並在外角之內同銳角法矣】

【丙甲乙形先得丙角及丙甲句乙丙如法作丙壬綫與乙甲股平行分外角爲兩則句和丁乙與句較癸乙若半外角切綫己戊與半較角切綫己壬此以丙甲爲半徑作外角弧而卽用丙甲爲正知所得爲正角】

【甲乙丙形先得丙角求余角如法作丙庚綫與乙甲句平行次截辛丁如庚甲作辛丙綫分外角爲兩則小角之正卯丁大角之正卽丙甲而成兩句股相似爲切綫比例法爲句和丁乙與句較乙癸若半外角切綫己戊與半較角切綫己壬此以丙甲爲半徑作外角弧而卽用丙甲爲正知辛丙甲爲正角而丁辛同庚甲卽辛丙甲同丁丙庚又卽同丙乙甲而乙爲正角矣以乙正角減外角余爲甲角】

論曰右並以先不知其爲句股形故求之而得正角凡正角之弧九十度別無正而卽以半徑全數爲正得此明之

【甲乙丙形先有正角求余角法爲句股和丁乙與句股較癸乙若半外角切綫戊己與半較角切綫己壬】論曰此因先得者爲正角故其外角亦九十度而半外角四十五度之切綫卽同半徑全數余並同前

又論曰句股形求角本易不須外角而外角之用得此益明

【以大邊爲半徑作外角弧分角綫丙未與次大邊平行邊總乙丁與邊較乙癸若半外角切綫戊己與半較角切綫壬己】

【以次大邊爲半徑作外角弧分角綫丙未與小邊乙甲平行大邊總丁癸與邊較乙癸若半外角切綫己戊與半較角切綫己壬】

問平三角形以一邊爲半徑得三正比例不識大邊亦可以爲半徑乎【小邊次邊爲半徑已具前條故云】曰可

如乙丙丁鈍角形引乙丁至辰如

乙丙大邊而用爲半徑以丁爲心

作丑辰亥半弧從辰作辰午爲丁

鈍角正又作丁斗半徑與乙丙

平行則鬥牛爲丙角正又截女

丑弧如辰斗作女丁半徑則女亢

爲乙角正合而觀之丁角正【辰午】最大故對邊乙丙亦大丙角正【鬥牛】居次故對邊乙丁亦居次乙角正【女亢】最小故對邊丁丙亦小

又問若此則三邊任用其一皆可爲半徑而取正是已然此乃同徑異角之比例也若以三邊爲三正爲股則同角異邊之比例也兩比例之根不同何以相通曰相通之理自具圖中乃正理非旁證也試於前圖用乙丁次邊爲其股乙癸與鬥牛平行而等則丙角

正也又截酉丁如丁丙小邊爲

其股酉壬與女亢平行而等則

乙角正也又辰丁大邊爲【卽乙

丙】其股辰午原爲丁大角正也

於是三邊並爲三對角之正

並爲股成同角相似之句股形而

比例皆等可以相求矣

一大邊【乙丙卽辰丁】

一丁角正【辰午】

二丁角正【辰午】

二大邊乙丙

三次邊乙丁小邊【丁丙卽酉丁】三丙角正【乙癸】乙角正【酉壬】四丙角正【乙癸】乙角正【酉壬】四次邊乙丁小邊丁丙此如先得大邊【乙丙卽辰丁】與所對大角【丁】故用辰午丁大句股形爲法求餘二句股也【乙癸丁酉壬丁】皆同用丁角而形相似故法可相求其實三正皆大邊爲半徑所得故其理相通未有理不相通而法可相求者故曰皆正理非旁證也

又試於乙丙丁形【或鈍角或鋭角同理】以丁丙小邊爲半徑作房箕壁象弧【以乙爲心】如上法取三正【以尾壁弧爲丁角度其正尾虛又箕壁弧爲丙角度其正箕危又戍壁弧爲乙角度其正戍申】成同徑異角之比例又如法用三邊爲三正爲股【乙戍卽丁丙小邊配乙角正戍申原如與

股又本形乙丁次邊爲則丁甲爲股與箕危平行而等

丙角正也又引乙丁至子成子乙卽乙丙大邊以爲

則子寅爲股與尾虛平行而等丁角正也】則並

爲相似之句股形而比例等

一小邊丁丙【卽戍乙】

二【乙角正】戍申

三大邊乙丙【卽乙子】次邊丁乙

四【丁角正】子寅【卽尾丙角虛

正】丁甲【卽箕危】

此如先得小邊【丁丙】與所對小角【乙】故以戍申乙小句股形爲法求兩大句股也【丁甲乙子寅乙】皆同用乙角而形相似又試以乙丁次邊爲半徑作象限如前【以丙爲心】取三正【張婁爲丁角弧度張井其正氐婁爲丙角弧度氐參其正室婁爲乙角弧度室奎其正】成同徑

異角之比例又仍用三邊爲三正

爲股【引丁丙至翌與大邊乙丙等成翌丙其股翌胃與張井

平行而等丁角正也又乙丁次邊成氐丙其股氐參原爲丙角正

又丁丙小邊爲其股丁柳與室奎平行而等乙角正也】卽復

成相似之句股形而比例等

一次邊乙丁【卽氐丙】

二【丙角正】氐參

三大邊乙丙【卽翌丙】小邊丁丙

四【丁角正】張井【卽翌乙角胃

正】丁柳【卽室奎】

此如先得次邊【乙丁】及所對丙角故以氐參丙句股爲法求大小二句股也【求翌胃丙爲以小求大求丁柳丙爲以大求小】皆同用丙角而比例等

問員內三角形以對弧爲角倍度設有鈍角小邊何以取之【或問內原設銳角兩邊並大於半徑故云】曰法當引小邊截大邊作角之通【如圖乙甲丙鈍角形在平員內以各角切員而乙甲邊小於半徑則引乙甲出員周之外乃以甲角爲心平員心丁爲界作子丁丑弧截引長邊於子截大邊於丑則醜甲子甲並半徑與丁甲等而丑子爲

通】又平分對邊作兩通【從員心作

丁乙丁丙兩半徑截乙戊丙員周爲甲角對邊所乘之弧而半

之於戊作乙戊丙戊二綫成兩通】則此兩通

自相等又並與丑子通等夫

子丁丑弧甲角之本度也丙戊

弧乙戊弧皆對弧之半度也而今乃相等【通等者弧度亦等】是甲角之度適得對弧乙戊丙之半而乙戊丙對弧爲甲角之倍度矣

歷算全書卷五十三

欽定四庫全書

歷算全書卷五十四

宣城梅文鼎撰

三角法舉要卷五

測量【三角用法算例已具玆則舉髙深廣逺以徴諸實事亦與算例互相補備也】

一測髙

一測逺

一測斜坡

一測深

附隔水量田

附解測量全義

三角測髙第一術

自平測髙

假如有塔不知其髙距三十丈立表一丈用象限儀測得髙二十六度三十四分弱依切綫術求得塔髙一十六丈

一半徑

一○○○○○

二戊角切綫

五○○○○

三距塔根【丙乙卽戊丁】

三十丈

四塔頂髙【甲丁是截算表端以上】十五丈

加戊丙表一丈【卽丁乙】共得塔髙十六丈【甲乙】

凡用象限儀以垂綫作角與用指尺同理【指尺卽闚衡亦曰闚管亦曰闚筩】若戊丙表立於髙所當更加立處之髙以爲塔髙

省算法從表根丙平安象限

以一邊指塔根乙一邊指癸

乃順丙癸直綫行至癸得三

十丈與丙乙等復於癸平安

象限作癸角與戊角等邊指

丙尺指壬則壬丙逺卽甲丁之髙【亦加丁乙爲塔髙】

論曰癸角同戊角丙癸同丙乙丙

與乙並正角則兩句股形等立面

與平面一也

又術自丙向癸卻行以象限平安

邊指丙尺指乙求作戊之餘角得

己丙之距卽同甲丁之髙

又省算法用有細分矩度自戊數至癸令其分如丙乙

之距【或兩倍三倍】從癸數壬癸直綫之

分卽甲丁之距也【先以二分爲丈或三分爲丈今

亦同之】

用矩度以垂綫作角其用亦同

三角測髙第二術

平面則不知逺之髙法用重測

假如有山頂欲測其髙而不知所距之逺依術立二表相距一丈二尺用象限儀測得髙六十度十九分退測後表得五十八度三十七分查其兩余切綫以相減得

較數爲法表距乘半徑爲實算

得山髙三十一丈

一餘切綫較○○四○○○

二半徑

一○○○○○

三表距戊己一丈二尺

四山髙甲丁三十丈

加表一丈共三十一丈

省算法用矩度假令先測指綫

交於辛後測指綫交於庚成辛

庚戊三角形法於兩指綫中間

以兩測表距【卽戊己】變爲分如壬

癸小綫引長之至丙卽丙戊所當測髙

論曰此卽古人重表法也或隔水量山或於城外測城內之山並同

三角測髙第三術

從髙測髙又謂之因逺測髙

假如人在山顚欲知此山之髙但知山左有橋離山半里用象限測橋得逺度一十八度二十六分彊依切綫法求得山髙一里半

一甲角切綫半徑【一○○○○○】二半徑

甲角余切【三○○○二八】三橋逺【戊丁】一百八十步

四山髙【甲丁】五百四十步【○五尺】省算法用矩度作壬癸綫以當

戊丁則己壬當甲丁

三角測髙第四術

從髙測不知逺之髙法用重測

假如人在山上欲知本山之髙然又無可防之逺但山有樓或塔量得去山二十一丈以象限儀指定一處於樓下測得五十五度二十六分又於樓上測得五十三度五十分用余切綫求得山髙三百四十四丈五尺

一兩余切較

四二

二下一測余切六八九

三樓髙【兩測之距】二十一丈

四山髙

三百四十四

丈五尺

省算法用矩度上測交庚下測

交辛成辛己庚三角形法於兩

指綫中間以上下兩測之距變

爲分如壬癸小綫引長之至丙

卽壬丙當所測本山之髙

三角測髙第五術

若山上無兩髙可測則先測其【但山上有兩所可以並見此物卽可測矣】

甲乙爲山上兩所【不拘平斜但取直綫】任

指一處如戊於甲於乙用噐兩

測之成甲乙戊形此形有甲乙

兩角又有甲乙之距爲兩角一

邊可求甲戊邊法爲戊角之正

與甲乙邊若乙角之正與甲戊

再用甲戊丁句股形爲半徑與甲戊若甲角余與甲丁卽山之髙也

三角測髙第六術

借兩逺測本山之髙

有山不知其髙亦無距山之逺但山前有大樹從此樹向山而行相去一百八十五丈又有一樹人在山上可見兩樹如一直綫卽於山上以象限儀測此二樹一測逺樹四十三度三十二分一測近樹三十度○七分用切綫較得本山髙五百丈

一切綫較

三七○○○

二半徑

一○○○○○

三兩逺之較一百八十五丈

四本山髙

五百丈

省算作壬癸小綫當兩逺之距【己戊】而丙甲當本山髙【甲丁】

三角測髙第七術

用山之前後兩逺測髙

甲爲山顚可見戊己兩樹其樹

與山參相直【如山南樹直正子北樹直正午】而

不知其距但山外有路與此樹

平行爲庚辛其長三里【如兩樹正南北

此路亦自南向正北行】卽借庚辛之距爲

兩樹之距以兩切綫並爲法求之

先從甲測巳得甲角一十七度○四分又從甲測戊得甲角三十四度三十四分法爲兩切綫並與己戊若半徑與甲丁也

一率兩切綫並【○九九六○○】二率半徑【一○○○○○】三率己戊卽庚辛【三里】求得四率甲丁【三里○四步又三之一彊】

三角測髙第八術

測山上之兩髙

甲山上有塔如乙欲測其髙如

乙甲之距於戊安儀噐測乙測

甲得其兩戊角之度【一乙戊丁二甲戊丁】各取其切綫相減得較法爲半

徑比切綫較若戊丁與乙甲

省算法數戊丙之分以當戊丁作壬癸丙小綫則壬癸之分卽當乙甲

用矩度亦同

三角測髙第九術

隔水測兩髙之橫距

有甲乙兩髙在水外欲測其相

距之逺任於丙用儀噐以邊向

丁窺筩指甲得甲丙丁角【一百二十

五度】又指乙得乙丙丁角【五十度】次

依丙丁直綫行至丁【得一百步】再用

儀噐以邊向丙窺筩指甲得甲丁丙角【三十九度】又指乙得乙丁丙角【一百零八度】又甲丁乙角【六十九度】得三角形三【一甲丁丙二乙丁丙三甲丁乙】

今算甲丁丙形有丁丙邊丁丙二角求甲丁邊

一率甲角【一十六度】正【二七五六四】二率丁丙【一百步】三率丙角【一百二十五度】正【八一九一五】求得四率甲丁邊【二百九十七步】

次乙丁丙形有丁丙邊丙丁二角求乙丁邊

一率乙角【二十二度】正【三七四六一】二率丁丙邊【一百步】三率丙角【五十度】正【七六六○四】求得四率乙丁邊【二百○四步】

末乙丁甲形有甲丁邊【二百九十七步】乙丁邊【二百○四步】丁角【六十九度】先求甲角

一率兩邊之總【五百○一步】二率兩邊之較【九十三步】三率半外角【五十五度半】切綫【一四五五○一】求得四率半較角切綫【二七○○九】查表得一十五度○七分弱以減半外角得甲角四十度二十三分彊

次求甲乙邊

一率甲角正【六四七九○】二率乙丁邊【二百○四步】三率丁角正【九三三五九】求得四率甲乙邊二百九十四步弱

論曰此所測甲丁及乙丁皆斜距也或甲乙兩髙並在一山之上於山麓測之或甲乙分居兩峯於兩峯間平地測之或甲在水之東乙在水之西於一岸測之並同若用有度數之指尺並可用省算之法

三角測髙第十術

隔水測兩髙之直距

有兩髙如乙與甲於戊於庚測

之

先以乙庚戊形求乙庚斜距次

以甲庚戊形求甲庚斜距末以

乙甲庚形【有乙庚邊甲庚邊及庚角】求乙甲邊卽所求

三角測髙第十一術

若山之髙顚爲次髙所掩則用逓測

山前後左右地勢不同則用環

測環測者從髙測下與測深同

太髙之山則用屢測

癸極髙爲甲次髙所掩則先測

甲復從甲測癸謂之逓測

乙丁與子丑居癸山之下爲地

平而各不等則從癸四面測之如測癸辛之髙以辛乙爲地平又測癸戍之髙以戌子丑爲地平則乙丁與子丑之較爲戍辛謂之環測

若山太髙太大則於乙測甲又於甲測癸或先測卯又測寅又測丑測子再從子丑測癸細細測之則眞髙自見而地之髙下亦從可知矣謂之屢測

三角測逺第一術

平面測逺

有所測之物如乙於甲立表安象限以邊指乙餘一邊對丁從甲乙直綫上任取九步如丁於丁復安象限以邊對甲闚管指乙得丁角七十一度三十四分用切綫算得乙距甲二十七步

一半徑

二丁角切綫

三丁甲

四乙甲

若欲知丁乙之距依句股法甲丁甲乙各自乘並而開方卽得乙丁

若徑求乙丁則爲以半徑比丁角之割綫若甲丁與丁乙也是爲以句求

省算用矩度自丁數自癸取丁癸之分如丁甲之距【或以

分當步或二分或三分當一步皆可】作壬癸丁小

句股則壬癸之分卽乙甲也【或一

分當步或二分三分並如丁癸之例】而丁壬亦卽

當丁乙【若尺上有分數卽徑取之】

若先從丁測測以測噐向甲指尺向乙作丁角次依丁甲直綫行至甲務令測噐之一邊順丁甲直綫餘一邊指乙則甲爲正方角如前算之卽得【若甲非正方角則於丁甲直綫上或前或後移測求爲正方角乃止】

三角測逺第二術

省算法

人在甲欲測乙之逺於甲置儀

噐一邊向乙一邊向丁成正方

角乃依甲丁直綫行至丁以邊

向甲闚管指乙作四十五度角

卽甲丁與甲乙等

若用矩度以乙丁綫正對方角則丁角爲正方角之半而甲丁等乙甲

論曰丁角爲正方角之半則乙角亦正方角之半而句與股齊故但量甲丁卽知甲乙

又省算法

於甲置儀噐以邊向丁闚管指

乙作六十度角順甲丁直綫行

至丁復作六十度角則甲丁等

甲乙

論曰甲角丁角俱六十度則乙角亦六十度矣故三邊俱等

若丁不能到則於甲丁綫上取丙以儀噐二邊對甲對乙成正方角則甲丙爲乙甲之半

三角測逺第三術

平面測逺用斜角

人在甲測乙而兩旁無餘地可

作句股則任指一可測之地如

丁量得丁甲二十丈於丁安儀

噐以邊向甲窺筩指乙得丁角

【四十六度】又於甲安儀噐以邊指丁窺筩指乙得乙甲庚角【二十一度】加象限【九十度】得甲鈍角【一百一十一度】法爲以乙角之正【二十三度乃甲丁二角減半周之餘】比丁甲若丁角之正與乙甲算得乙甲三十六丈八尺二寸

若求乙丁則爲以乙角之正比丁甲若甲角之正與乙丁算得乙丁四十七丈七尺八寸【甲爲銳角法同】

省算法於儀噐作壬甲綫與乙丁平行作壬癸綫與乙甲平行成壬癸甲小三角形與丁乙甲等則甲癸當甲丁而壬癸當甲乙又壬甲當乙丁用矩度同【但於象限內作橫直分用同矩度】

論曰壬角旣同乙角【壬甲與乙丁平行壬癸與乙甲平行則作角必相等】癸鈍角又同甲角則兩三角相似而比例等

銳角形於甲測乙用矩度之邊指

丁作甲角另用一矩度【其矩須於兩面紀度】從丁測之以邊向甲闚筩指乙作

丁角末移丁角作癸角於噐上作

壬癸綫與乙丁平行則癸甲當丁

甲而壬甲當乙甲壬癸當乙丁

三角測逺第四術

平面測逺借他綫爲比例

甲乙爲兩所順甲乙直綫行任取

若干步至丙又於丙任作直綫至

丁得若干步於丁安儀噐以邊對

甲闚衡指丙作丁角順此直綫至

戊復安儀噐邊對乙衡指丙作戊

角令與丁角等則丙丁比丁戊若丙甲與甲乙

省算法於乙甲直綫上取丙

又從丙作丙戊直綫截丁丙

如乙丙於丁用象限闚乙作

丁角再於戊闚甲作戊角令

與丁角等則丁戊卽甲乙

又法甲置儀噐指乙指丁作

角以減半周成外角【己戊爲甲角之

度丙庚戊爲外角之度】於丁置儀噐指

甲指乙使丁角如半外角之度但量甲丁卽得甲乙論曰凡外角能兼內餘二角【乙丁】之度丁角旣爲外角之半則乙角亦外角之半矣角等者所對之邊亦等故甲丁等甲乙

三角測逺第五術

平面測逺借他形爲比例法

從甲測乙任立一表於丙從甲

用儀噐以邊向乙闚管指丙得

甲角復於丁加儀噐以邊向戊

闚管指丙使丁丙甲爲一直綫

而作丁角與甲角等乃順儀噐邊取直綫至戊令戊丙乙爲一直綫則丁丙與丁戊若丙甲與甲乙【鈍角形句股形並同一理】

論曰丙戊丁與丙甲乙兩三

角形相似以兩形之丙角爲

交角必相等而丁角又等甲

角則戊角亦等乙角矣故其

比例等

三角測逺第六術省算

有甲乙兩所欲測其距如前立丙

表以噐測得甲丙乙角之度又順

乙丙直綫行至戊令丙戊之距同

甲丙而止再從戊行至丁從丁闚

丙至甲成一直綫於此直綫上進退移測使乙丁丙角爲乙丙甲角之半則但量丁戊卽同乙甲【甲爲鈍角或丙爲鈍角並同】

論曰甲丙與丙戊旣相等乙

丁丙角爲乙丙甲外角之半

則丙乙丁角亦外角之半是

乙丙與丁丙亦等也而丙交

角又等是甲丙乙三角形與

戊丙丁形等角等邊也故丁

戊卽乙甲

三角測逺第七術重測

甲乙爲兩所欲測其距而俱不能

到則兩測之於戊於丁量得戊丁

之距【十六步半】用噐測得戊角【五十度四十三

分】丁角【三十六度一十分】兩角之餘切綫

較【五五○○○】爲一率半徑【一○○○○○】爲二率戊丁【十六步半】爲三率得四率爲乙甲之距【三十步】

若求戊甲之距以兩測之餘切較【五五○○○】爲一率先測戊角之餘切【八一八○○】爲二率丁戊【十六步半】爲三率得四率戊甲【二十四步五四】

論曰此卽古人重表測逺法也必丁戊甲直綫與乙甲綫橫直相遇使甲爲正角其算始眞假如乙甲正南北距則丁戊甲必正東西斯能橫直相交而成正角也

三角測逺第八術

分兩處重測

乙岸在河東欲測其距西岸之逺

如甲則任於甲之左右取丁戊兩

所與甲參相直而距河適均測得

丁角【五十度四十三分】戊角【五十五度四十三分】用

兩角度之餘切綫並【一五○○○○】爲一

率半徑【一○○○○○】爲二率丁戊之距【九十六步】爲三率求得四率乙甲之距【六十四步】爲兩岸闊

論曰此法但取丁戊直距與河岸平行則不必預求甲防而自有乙甲之距爲丁戊之垂綫尢便於測河視用切綫較更簡捷而穏當矣

三角測逺第九術

用髙測逺

甲乙爲兩所不知其逺而先知丁

乙之髙於甲用儀噐測丁乙之髙

幾何度分卽知甲乙法爲半徑比

甲角之餘切若丁乙髙與甲乙之逺

若人在髙處如丁用髙測逺則爲半徑比丁角之切綫若丁乙與甲乙其理並同但於丁加儀噐而用正切三角測逺第十術

用不知之髙測逺

欲知丁乙之逺而不能至乙乙之

上有庚又不知庚乙之髙法用重

測先於丁測之得丁角【三十八度一十三分】又依丁乙直綫進至甲測之得甲

角【五十三度五十二分彊】兩余切較【○五四○○一】

爲一率丁角余切【一二七○○一】爲二率丁甲之距【二十步】爲三率得四率丁乙【四十七步○三】或丁後有餘地退後測之亦同

省算作壬癸丙綫以壬癸分當丁甲之距壬丙當丁乙之逺

若人在髙處如庚於庚測丁測甲以求丁乙其法亦同但於庚施儀噐而用正切【法爲以兩庚角之切綫較比丁庚乙之切綫若丁甲與丁乙】

三角測逺第十一術

用髙上之髙測逺

甲乙爲兩所而乙之根爲物所掩

【如山麓有小阜坡陀礨砢林木蔽虧或島嶼盤糾荻葦深阻】難

得眞距若用兩測甲外又無餘地

但取其髙處如戊爲山顚山上又

有石臺臺上有塔如丁丁戊之髙

原有定距以此爲用從甲測丁又測戊得兩角【一丁甲乙二戊甲乙】求其切綫法爲以切綫較比半徑若丁戊與乙甲省算作壬癸丙小綫以壬癸當丁戊則甲丙當甲乙矩度同

若從髙測逺則於丁於戊兩用儀噐測甲用丁戊兩角之餘切較以當丁戊而半徑當甲乙其理亦同

三角測逺第十二術

從髙測兩逺

甲乙兩逺人從髙處測之於丁用

儀器測甲測乙得兩丁角【一甲丁丙二乙

丁丙】法爲以半徑比兩角之切綫較

若丁丙髙與乙甲也

又法旣得兩角則移儀噐窺戊作

戊丁甲角如甲丁丙之倍度又移窺己作己丁乙角如乙丁丙之倍度則但量己戊卽知乙甲

三角測逺第十三術

連測三逺

丙乙爲跨水長橋甲乙爲橋端斜岸今於丁測橋之長

並甲乙岸闊及其距丁之逺近

法於丁安儀噐以邊指戊衡指

甲指乙指丙作丁角五【一甲丁戊二乙

丁戊三乙丁甲四戊丁丙五乙丁丙皆丁角而有大小】次順儀噐邊直行至戊得丁戊

之距於戊復用儀噐以邊指丁衡指丙指乙指甲作戊角三【一丁戊丙二乙戊丙三甲戊丁皆戊角而有大小】

一甲丁戊形有丁角戊角有丁戊邊可求甲丁邊一乙丁戊形有丁角戊角有丁戊邊可求乙丁邊一戊丁丙形有戊角丁角有丁戊邊可求丁丙邊以上並二角一邊求余邊得甲乙丙三處距丁之逺近

一乙丁丙形有丙丁邊乙丁邊有丁角可求乙丙邊一乙丁甲形有甲丁邊乙丁邊有丁角可求乙甲邊以上並二邊一角求余邊得岸闊與橋長

三角測斜坡第一術

斜坡上平面測兩所之距

斜坡上有甲乙兩所欲量其相距

之數任立丙表測得乙丙甲角度

乃順甲丙直綫進退闚乙至戊得

乙戊丙角爲乙丙甲角之半又橫

過至丁從丁闚丙至乙成一直綫順此直綫進退闚甲至丁得甲丁丙角亦爲丙角之半則丁戊卽乙甲又法不必立表但任指一防爲丙而於甲丙直綫上任取己防乙丙直綫上任取庚防作庚丙己三角形有己角庚角卽知丙角末乃如上作丁戊兩角爲丙角之半卽所求

論曰此因乙甲在斜面髙處而不能到故借用丁丙戊形測之以丁丙戊乙丙甲兩形相等故也何則丙交角旣等而乙丙甲外角原兼有丙乙戊乙戊丙兩角之度戊角旣分其半乙角亦半則兩角等而乙丙戊丙兩邊亦等矣凖此論之則甲丁丙角爲丙外角之半者丁甲丙角亦必爲丙外角之半而甲丙丁丙亦等矣兩形之角旣等各兩邊又等則三邊俱等而戊丁卽乙甲若甲乙兩所在下而丁戊兩測在上亦同

三角測斜坡第二術

斜坡測對山之斜髙

對山之斜髙如甲戊乙於對

山之斜坡測之如丙丁先量

得丙丁之距於丙安儀噐得

丙角二【一乙丙丁二戊丙丁】於丁安儀

噐得丁角四【一乙丁丙二乙丁戊三戊丁丙四乙丁甲】成各三角形

先用乙丙丁形【有丙角丁角及丁丙邊】測乙丁邊次用戊丙丁形【有丙丁二角及丁丙邊】測丁戊邊三用乙丁戊形【有乙丁戊丁二邊及丁角】測乙角及乙戊邊四用乙丁甲形【有乙角丁角及乙丁邊】測乙甲邊乙甲內減乙戊得戊甲邊【乙戊甲爲垂綫之髙法同】

三角測斜坡第三術

測對坡之斜髙及其巖洞

從丙從丁測對面之斜坡戊甲及乙戊

一乙丙丁形【有丙丁兩測之距丙角丁角】可求乙丁邊二戊丙丁形

【有丙丁邊丁角丙角】可求丁戊丙戊二

邊三乙丁戊形【有乙丁邊戊丁邊丁

角】可求乙戊邊爲所測對山

上斜入之巖四丙丁甲形【有丁角丙角丙丁邊】可求丙甲邊五甲丙戊形【有丙戊邊丙甲邊丙角】可求戊甲邊爲所測對坡斜髙

或戊爲髙處基址乙爲房檐亦同

三角測深第一術

測井之深及濶

甲乙爲井口之濶於甲作垂綫至丁【或用磚石投之以識其處】從乙

測之得乙角成甲乙丁句股

形卽以甲乙井口爲句得甲

丁股爲井之深旣得乙丙

深【卽甲丁】卽可用乙己戊形得

己戊爲底濶法以半徑當井

深【乙丙】以兩乙角【一戊乙丙二己乙丙】之

切綫並當井底之濶【己戊】若不知井口則立表於井口

如庚甲求庚甲二角成庚甲

丁形測之

三角測深第二術

登兩山測谷深

先於二山取甲乙之平而得其距

數爲橫綫卽可用三角形求丙丁

垂綫爲谷之深與測髙同理【亦可用以】

【測髙也】法爲甲乙兩角之餘切綫並比半徑若甲乙與丙丁論曰深與髙同理測深之法卽測髙之法也存此數則以發其例有不盡者於測髙諸術詳之可也

附隔水量田法

甲乙丙丁田在水中不可

得量於岸上戊庚兩處用

儀噐測之得諸三角形算

得其邊【一甲乙二乙丙三丙丁四丁甲】次

求乙丁對角綫分爲兩三

角形【一甲乙丁二丙乙丁】末用和較法求得分形之兩垂綫【一甲癸二壬丙】並兩垂綫而半之以乘乙丁卽得田積

或用三較連乘法求三角形積並之亦同

凡有平面形在峭壁懸崖之上及屋上承塵可以仰觀者並可以此法測之

解測量全義一卷十二題加減法

甲寅象限弧甲乙半徑全數

爲首率

丙寅弧之正丙辛爲一率

丁寅弧之正丁庚爲三率

戊己爲四率

二三相乘爲實首率爲法法除實得四此本法也今以加減得之則不用乘除

丙寅加丁寅【卽辰丙】爲辰寅總弧其餘辰卯【卽子癸】丙寅內減丁寅爲丑寅【卽丙丁】存弧其餘癸丑以子癸減癸丑餘子丑平分之於壬爲壬子或壬丑卽

四率【其壬子壬丑皆與戊己等】此因總弧

不及象限故以兩余相減

甲寅象限弧甲乙半徑全數

爲首率

丙寅弧之正丙辛爲二率

丁寅弧之正丁庚爲三率

戊己爲四率

以上皆與前同

丙寅加丁寅【卽辰丙】爲辰寅總弧【此總弧大於象限】其餘卯辰【卽子癸】丙寅內減丁寅【卽丙丑】余丑寅爲存弧其餘醜癸

以子癸加丑癸爲子丑半之於壬分爲壬子及壬丑二綫皆與戊己同卽爲四率如所求

此因總弧過象限故以兩余相加

今訂本書之譌

甲寅皆象限弧甲乙半徑

一○○○○○爲首率

丙辛○五九九九五爲二率

丁庚○二五○一○爲三率

以三率法取之得○一五○

○四爲四率

今用加減法

以丙辛綫爲正查其弧得丙寅三十六度五十二分亦以丁庚綫爲正查其弧得丁寅十四度二十九分以丙寅弧與丁寅弧相加得總弧辰寅五十一度二十一分其餘○六二四五六如辰卯【卽子癸】

又以丙寅弧與丁寅弧相減得存弧丑寅二十二度二十三分其餘○九二四六六如醜癸

因總弧小於象限當以兩余相減其較○三○○一○如子丑【於丑癸內減子癸得之】乃平分子丑於壬其數○一五○○五爲壬丑或壬子皆與戊己同卽爲四率此所得與三率所推但有微差而不相逺

按此以加減代乘除依其法宜如此今刻本相減相並訛爲並而相減又於相並之弧訛爲五十度二十分相減之存弧訛爲二十二度二十四分故其正皆訛而所得之四率只一四三一與三率所推不合矣

又按以加減代乘除之法不過以明圖法之妙其中又有此用耳若以入算終不如乘除之便何也設問毎多整數而正之數皆有畸零不能恰合一也先用設數求弧度必用中比例始得相合則於弧度亦有畸零二也弧度旣有畸零則其查余又必用中比例三也兩余有用加之時有用減之時易至於訛四也及其所得四率以較三率法之所得終有尾數之差五也蓋論數學則宜造其防而施之於用則貴其簡易若可以簡易者而故引之繁重又何貴乎故曰不如乘除之便也觀設例之時便有訛錯如此則其不便於用亦可見矣又按此加減法卽測量全義第七卷

所言加減也其以總存兩余相加減而半之者卽初得數也然彼以兩正相乘得之此以加減得之而省一乘矣實弧三角中大法而彼但舉例而隠其圖姑示其端於此而又不直言其卽弧度之初得數此皆譯書者祕惜之故耳向後二圖發明所以然之故

甲寅象限弧乙丙半徑爲首率

丙寅弧之正丙辛爲次率

丙醜弧之正醜戊爲三率【辰丙弧同丙丑其正辰戊亦同丑戊】得戊巳爲四率【丑壬及壬子並同】

論曰戊巳辰【或丑壬戊亦同】句股形與

丙辛乙句股形相似故其比例

等法爲乙丙與丙辛若丑戊與

醜壬也【或辰戊與戊巳亦同】

又論曰凡兩十字垂綫相交作

句股則其形俱相似如辰丑綫卽丙丑及丙辰之正與丙乙半徑相交於戊防一十字也辰午綫【辰寅弧之正也】醜癸綫【丑寅弧之餘】相交於子防一十字也此兩十字相交而成諸句股形則俱相似矣故戊壬庚與醜壬戊相似而戊壬庚原與丙辛乙相似則丑壬戊與丙辛乙不得不爲相似之形矣

解曰乙丙首率半徑也丙辛正爲次率其弧丙寅丑戊正爲三率其弧丙醜丙丑旣與丙辰同則以丙醜【三率之弧也】加丙寅【次率之弧】成辰寅總弧而辰卯則總弧之餘也以丙醜【三率之弧】減丙寅【次率之弧】其餘丑寅爲存弧而醜癸則存弧之餘兩余相減其較爲子丑【子癸同辰卯故以子癸減癸醜得較子丑】子丑折半於壬而壬丑與壬子皆同戊巳是爲所求之四率也

如此以量法代算法的確不易但細數難分耳

若以酉丙爲過象限之大弧丙醜爲小弧則酉丑爲總弧其正醜丁余丑癸【卽丁乙】

酉辰爲存弧其正辰午餘辰卯【卽子癸】算法略同但先所用者存弧之正小於總弧今則總弧正小於存弧正大則余小正小則余反大加減之用以小從大其理無二故其圖可通用也

又按壬醜卽初得數也兩正相乘以半徑除之者也乙亥卽次得數也兩余相乘以半徑除之者也今攺用加減則以兩弧相並爲總弧而相較之餘爲存弧存總兩余相加減而半之成初得數省兩正乘矣又以初得數去減余成次得數省兩余乘矣

兩余加減例

凡總存二弧俱在象限內或俱出象限外則兩余相減若存弧在象限內總弧在象限外則兩余相加

初得數減余弧例

凡存弧之正小於總弧卽用存弧之餘在位以初得數減之餘爲次得數若總弧之正小於存弧卽用總弧之餘在位以初得數減之餘爲次得數蓋

小者余大其餘內

皆兼有初得次得兩數詳

見環中黍尺

甲寅象限弧乙丙半徑

爲首率

丙寅弧之正【丙辛】爲次率

丙醜弧之正醜戊爲三

率【辰丙弧同丙丑其正辰戊亦同丑戊】

求得戊巳爲四率【丑壬壬子並同】

以上皆與前圖同

論曰凖前論丙辛乙句股形與醜壬戊句股形相似法爲乙丙與丙辛若丑戊與醜壬也【或辰戊與戊巳亦同】

解曰乙丙首率半徑全數也丙辛正爲次率其弧丙寅丑戊正爲三率其弧丙醜而丙醜【三率】卽丙辰以加丙寅【次率之弧】成辰寅總弧而辰卯亦總弧之餘也以丙醜【三率之弧】減丙寅【次率之弧】其餘丑寅爲存弧而醜癸則亦存弧之餘也兩余相加成子丑【子癸同辰卯皆總弧余】子丑折半於壬而壬丑同壬子亦同戊巳則所求之四率也

歷算全書卷五十四

欽定四庫全書

歷算全書卷五十五

宣城梅文鼎撰

解八綫割圓之根

八綫割圓說

天體至圓最中一防爲心過心直綫爲徑圓面諸圏爲弧弧與徑古用徑一圍三之比例【有宻術徽術各家不同】然終非弧度之眞蓋圓爲曲綫徑爲直綫兩者爲異類亙古無相通之率夫日月星辰之道皆弧綫也人目測視之綫皆直綫也苟非由直綫以得曲綫縱推算極精皆非確數於推步測量諸用所關甚鉅其可略歟西儒幾何等書別立數法求得弧與徑相凖之率更以逐度之弧準逐度之綫內用矢外用割切於是始則因弧而求綫繼則因綫而知弧交互推求𨿽分秒之弧度盡得其準立法之善卽首商髙復生無以易也苐割圓八綫表𨿽久傳於世而立法之根未得専書剖晰大測中如十邊五邊形之理皆缺焉弗講薛靑州作正解亦僅依式推衍未能有所發明予於歷算生平癖嗜凡有奧義必欲直窮其所以然而後快竊思割圓八綫乃歷算之本源豈可習焉不察因反覆抽繹耿耿於心者數年積思之久乃得漸次防通遂著其圖衍其算理之隠賾者明之法之缺略者補之防而成帙以備好學者之采擇云爾

立表之根有七

一大圓中止有徑綫初無邊角可尋乃作者慿空結撰求得七弧之通而全割圓表卽從此推出又絕無假借紐合之病割圓之巧孰有加於是焉

表根一圓內作六等邊切形求得六十度之通法曰六十度之通與圈之半徑等作表時命爲十萬亦曰全數

解曰如圖辛爲心作甲丙丁圈甲丁爲全徑辛丁爲半徑次取丁爲心辛爲界作戊庚辛圈與原圈相交於丙於戊次引長丁辛綫至庚必平分丙戊弧於丁亦平分戊丙弧於辛【以丁爲戊庚圈心故】次作辛丙丙丁丁戊戊辛四綫成丁辛丙丁辛戊二形必皆三邊等三角形何則丁爲

心辛爲界則丁辛與丁丙皆

爲戊庚圏之半徑仍用辛丁

爲度辛爲心丁爲界則辛丁

又爲甲己圈之半徑辛丙亦

同則辛丁丁丙辛丙三綫俱等而辛丁丙爲三邊等形丁辛丙三角俱自相等每角六十度夫辛角在心者也則丙丁弧爲六十度丙丁卽六十度之通與辛丁半徑等矣丁戊辛形仿此

次以丙辛引至己戊辛引至乙其甲辛己乙辛甲交角俱與丙辛丁戊辛丁角等角等弧亦等卽平分大圈爲六分次作丙丁等六綫相連成六等邊內切形等邊等角蓋乙辛己丙辛戊兩交角之弧旣當六分圈之四則中間己戊乙丙二弧亦必各爲六分圈之一故成六等邊形皆以半徑爲邊此天地自然之數也

表根二圈內作四等邊切形求得九十度之通法曰半徑上方形倍之開方得九十度之通

解曰圈內四等邊切形卽內切

直角方形也如圖甲癸丁圏

庚爲心作丁癸全徑又作甲己

全徑與丁癸十字相交爲湊心

四直角卽平分大圓爲四分每分九十度次作甲癸己癸己丁甲丁四綫相連成四邊等形其切圏之甲丁己癸四角俱爲直角【以各角俱乘半圈故】所容之癸甲丁己爲正方形甲癸等爲九十度之通用甲庚癸直角形甲庚半徑上方與庚癸半徑上方並開方得甲癸句股求術也

巳上二根並仍曆書之舊

表根三圈內作十等邊切形用理分中末綫求得三十六度之通

法曰圏徑上作理分中末綫其大分爲十邊等形之一邊卽三十六度之通今欲明十邊形之理先解理分

中末綫欲明理分中末綫先解方形

及矩形

一解曰凡正方形內【如乙庚戊丙方】依一角

復作正方形【如丁庚方】以小方之各邊引長之如甲午辛壬卽分元方戊庚爲四分小方之各邊與大方之各邊俱兩兩平行其與小方丁庚相對之丁戊形亦必正方形左右所截之午壬甲辛二形必皆矩形而恆自相等一解曰任設一綫如甲戊兩平分之於乙又任引長之爲戊庚【長短不論】其全綫甲庚偕引長綫戊庚【卽子庚】矩內形

【甲子矩】及半元綫甲乙【癸丑等】上

方形【癸辛方】並成子丑壬甲磬

折形此形與半元綫【乙戊】偕引

長綫乙庚上之乙丙方形等

何則乙庚上方乙丙與磬折形子丑壬甲共用乙子矩形今試以此兩率各試去乙子矩形兩所餘爲乙壬矩及丑丙矩夫此兩矩形邊各相等【辛丙與乙辛等辛丑與壬辛亦等以壬丑爲正方故】其冪亦必等則於乙子形加丑丙得乙丙方於乙子形加乙壬得子甲壬磬折形亦無不等矣又己辛亦正方形以相對之己庚爲正方故己辛方與壬丑方亦等以同在甲庚癸子兩平行綫內又甲乙乙戊相等故也分中末綫

解理分中末綫明上二圖可論理分中末綫矣法曰如圖任作甲戊綫兩平分於乙以甲戊綫自之作戊卯方從乙平分處向丁作乙丁綫次以甲戊引至庚令乙庚與乙丁等於乙庚上作乙丙方又取庚子與戊庚等作癸子綫分戊丁於己則戊己爲戊丁元綫之大分己丁爲小分戊己丁己戊丁三綫成連比例戊丁與戊己若戊己與己丁而戊己爲中

解曰依上二圖之論甲庚綫偕戊庚矩形及乙戊【卽甲乙】上方形並與乙庚上方等今乙庚綫旣令與乙丁等則

乙丁上方亦與乙庚上方等是

甲庚偕戊庚矩形及乙戊上方

並與乙丁上方等而乙丁上方

與乙戊丁戊上兩方之並等此

二率者共用乙戊上方試以此二率各減去乙戊上方則所存之戊卯方與甲子矩形必等矣夫戊卯方旣與甲子矩等又共用甲己矩形試各減去甲己矩形則所存戊子方與卯巳矩形必等矣卯巳與戊子兩矩形旣等又以巳直角相連則兩形之邊爲互相似之比例癸己與巳子若戊己與己丁夫癸己卽戊丁也則戊丁與戊己若戊己與己丁爲連比例而戊己爲中率戊己上方【二三率】與戊丁【一率】偕己丁【四率】矩形等戊丁全綫爲首率戊己大分爲中率減戊丁【甲戊同】存己丁小分爲末率蓋理分中末綫云者於一直綫上作連比例之謂也求之法以所設甲戊半於乙爲句甲戊爲股【卽戊丁】求乙丁卽乙庚也減乙戊句存戊庚卽戊己大分減戊丁元綫存己丁小分

又甲戊引長綫止於庚者欲令乙庚等乙丁也若不爲連比例戊庚可任意引長之如前二圖之論然理分中末綫法實從二圖之理推出其關鍵全在乙庚乙丁二綫等也

解理分中末綫大分爲三十六度之通觀上諸論可明理分中末綫之法然何以知其大分能爲十等邊形之一邊如圖任作甲乙綫用上法分之於內爲理分中末綫甲乙與甲丙若甲丙與丙乙甲丙其大分丙乙其小分次用甲乙全綫爲半徑甲爲心乙爲界作圏又從乙作乙丁合圏綫令與甲丙等末從圏心作甲丁綫相連其甲乙甲丁兩半徑等卽甲丙丁爲兩腰等三角形夫此三角形其腰間之甲乙丁甲丁乙二角必各倍大於底上甲角何則試從丙作丙丁綫於甲丙丁角形外作甲丙丁外切圏其甲乙偕乙丙矩內直角形與甲丙上方形等【因連比例等】亦卽與至規外之乙丁上方等而乙丁切小圏於丁爲切綫卽乙丁切綫偕丁丙綫所作乙丁丙角與負丁甲丙圏分之甲角交互相等【見幾何三卷三

十二】此二率者每加一丙丁

甲角卽甲丁乙全角與丙

甲丁丙丁甲兩角並等夫

乙丙丁外角與丁甲相對

之內兩角並等卽乙丙丁

角與甲丁乙全角等而與相等之甲乙丁亦等丙丁與乙丁兩綫亦等夫乙丁原與甲丙等卽丙丁與丙甲亦等因丙甲丁丙丁甲兩角亦等又甲角旣與乙丁丙角等卽乙丁丙甲丁丙兩角亦相等是甲丁乙倍大於丙丁甲亦卽倍大於相等之丙甲丁角也而甲乙邊與甲丁等則甲乙丁角亦倍大於甲角也

次解曰丙丁乙角何以知其與丙甲丁角交互相等試作未丁全徑與乙丁爲直角又作未丙綫成未丙丁直角夫丙未丁丙丁未二角並與一直角等乙丁未亦一直角此二率者各減去未丁丙角所存丙丁乙丙未丁二角必等夫丙未丁負圏角也丙甲丁亦負圏角也同負丙丁弧則丙甲丁角與丙未丁角等夫未角與丙丁乙角等也今旣與丙甲丁等則丙甲丁角亦必與丙丁乙角等

依上論顯甲乙丁形之乙丁二角俱倍大於底上甲角形內之丙丁乙形與甲乙丁原形相似其丙乙二角亦倍大於乙丁丙角乙丁丙丁甲丙三綫俱等夫甲丁乙形之甲乙丁三角並等兩直角今乙丁二角旣倍大於甲角是合乙甲丁角而爲五分兩直角矣則乙甲丁角該五分兩直角之一爲三十六度夫五分兩直角之一與十分四直角【全周】之一等則乙甲丁角或乙丁弧卽十分圏之一分乙甲丁甲又各爲半徑則乙丁卽十等邊形之一邊夫乙丁與丙丁等丙丁與甲丙等則甲丙與乙丁亦等而甲丙卽理分中末綫之大分故圏徑上作理分中末綫其大分爲三十六度之通

圏內作十等邊切形法先依上作甲丁乙兩腰等三角形以甲乙甲丁各引至圏界爲乙己丁戊其己戊弧與乙丁等次以戊乙弧半於庚作乙庚戊庚二綫各半之於辛於壬又作癸丑子寅卯庚諸綫俱過甲心各抵圏界卽平分大圓爲十分末作戊己等十綫相連卽所求十邊形之理據曆書見幾何十三卷九題而幾何六卷巳後之書未經翻譯不可得見考之他書未有發明其義者余特作此解之

表根四圈內作五等邊內切形求得七十二度之通法曰六邊形上方形及十邊形上方形並開方得七十二度通

解內切五等邊形法法曰甲乙丁圈於圈內作甲丙

丁兩腰等乘圈角形令腰間丙丁

二角各倍大於甲角卽甲角所乘

之丙丁弧爲全圈五分之一何則

甲丙丁形之三角並等兩直角今丙丁二角旣各倍大於甲角則甲角爲五分兩直角之一又甲爲乘圈角所乘之丙丁弧必更倍大於甲角之度爲全圏五之一矣【七十二度】夫丙於二角又倍大於甲角則其所乘甲丙甲丁二弧亦必倍大於丙丁爲全圈五分之二卽作丙戊丁乙二綫平分丙丁二角亦平分甲丁甲丙二弧分大圈爲五平分丙丁綫卽五等邊之一末作丁戊等四綫相連成五等邊內切形等邊等角此系曆書原法新增作五等邊形法

甲庚壬平圓內作五邊等形法任作

切圓直綫如子丑切平圓於甲乃以

切防甲爲心任作半圈如子寅丑次

勻分半圓周爲五平分如子辰等次

從半圓上取五平分之各防作直綫至切防甲此直綫必過半圓周【如甲辰綫必過庚寅甲綫必過戊餘仿此】末於平圓內聯各防作通卽成五等邊形【庚甲乙甲本爲通補作戊庚丁戊乙丁三綫並與庚甲乙甲

等皆七十二度通也】

解曰卯甲寅負圈角正得丁心戊

分圓角之半卯甲寅旣爲十等面

湊心之角必三十六度也則丁心

戊角必七十二度而爲五等邊角矣或作半圓於外如下圖亦同前論

解六邊十邊兩方並等五邊上方形法曰依前理分中末綫法作己丁丁丙二邊爲十分圏之一乙己乙丙甲乙三綫俱爲中末綫之大分與十邊形之一等乙丁

其小分次取己丁

弧之倍至丙作甲

丙綫得己丙七十

二度爲五分圏之

一【己丁丙爲十分圏之二卽五分

圏之一矣】作丙己綫卽

五等形之一邊也

己甲丙爲七十二度之角次取己爲心己丁大分爲界作丁未庚圏又以丙爲心丙甲半徑爲界作子甲丑圖兩圏相交於辛末從丙心向交防【辛】作丙辛綫從己心向交防【辛】作己辛綫成丙己辛三角形此形辛爲直角丙辛六邊形之邊【卽子丙】爲股己辛十邊形之邊【卽己丁】爲句己丙五邊形之邊爲用句股術得己丙七十二度之通

解曰丙辛己形何以知辛防必爲直角試觀乙己丁乙丙丁俱爲兩腰等形又自相等合之成己乙丙丁四等

邊斜方形則丙己綫必平分

乙丁小分於壬甲丁綫因己

丙弧爲己丁之倍亦平分丙

己於壬壬防爲直角又形

內所分之乙壬己乙壬丙丁壬己丁壬丙四句股形俱自相等夫丙己邊上方形爲壬己上方形之四倍【幾何言全綫上方形爲半元綫上方形之四倍】而壬己上方乃乙己上方減去乙壬上方之數【句求股】是以乙己上方四倍之【卽己乙己丁丙丁丙乙四綫上方之並】減去乙丁小分上方【乙丁上方爲乙壬上方之四倍以乙壬爲乙丁之半故也卽乙壬等四小句方之並】所餘卽與丙己上方等矣而此四乙己方減乙丁上方之餘又與全數上方及中末綫大分之方並等【卽十邊形之一】何則試觀二圖【卽理分中末綫圖】甲丁爲全數甲戊爲全數上方丁乙爲大分丁子爲大分上方兩方之並成甲壬子戊磬折形此形內容丁子大分方形之四則重一庚己小分之方【取丙丁與乙丁等則己丁壬乙俱爲大分之方而庚壬矩與丁子方等甲壬矩又與庚壬矩等是共有大分上方形之四倍而庚己小方則重疊在內庚己乃辛己小分之方也】今試於磬折形內減去重疊之方【癸辛方】是卽於四个大分方內減一小分上方亦猶之前圖四乙己方內減去乙丁上方而所餘必等矣夫此磬折形旣與前四乙己方內減乙丁上方之餘冪等而此余冪又與丙己上方等則此磬折形亦與五等邊之一丙己上方等而磬折形乃甲戊丁子兩方之並也甲戊方之根甲丁卽前丙辛己形之丙辛邊丁子方形之根丁己卽前丙己辛形之己辛邊今丙辛己辛上兩方並旣等於丙己上方是丙辛己爲句股形而辛爲直角矣丙辛半徑股也己辛大分句也丙子弧六十度之邊子丙卽丙辛股己丁弧三十六度之邊丁己卽己辛句而丙辛己辛丙己三邊適湊成句股形故曆書言六邊上方並十邊上方與五邊上方等蓋以此也

若作戊乙綫成戊丁乙句股形與前丙辛己形等戊乙卽五邊形之一益可見辛之必爲直角矣

求七十二度通法取逕甚奇大測止具算術未著其理【據云見幾何十三卷十題】薛書及孔林宗說殊多牽附余此圖與原算脗合乃知古人立法之簡奧也因更推衍四法如下

如圖午丁大圈依理分中末綫法作十邊等內切形丁午等俱大分次從癸昴諸防【癸甲昴甲俱爲大分】作癸昴昴壁等綫俱爲小分各連之則中末綫之大小兩分成內外兩十邊等形俱各兩兩平行一切於周一切於徑次任取

戊爲心甲爲界作圈

亦依上法用其大分

小分作內外兩十邊

等形末作乙丙乙丑

等五綫爲五邊形之

各邊諸綫交錯得求

乙丙邊之法有五

一丁乙丙形有丁丙全徑有丁卯全數及卯乙大分並爲丁乙【丁乙與午戊必平行】乙爲直角用股求句法得乙丙邊二乙丙寅形有乙寅小分爲句有丙戊戌寅兩大分並得丙寅爲求得乙丙股

三乙甲丙形用其半甲壬丙形有甲丙全數有甲辛大分有辛壬爲辛戊小分之半並爲甲壬求壬丙勾倍之得丙乙邊

四乙壬戊形有乙戊大分爲有壬戊小分之半爲句求乙壬股倍之得乙丙邊

又形中兩圈相交內有甲卯乙戊未爲小五邊形其各邊卽大分甲辰戊丙庚形同又有甲卯乙戊丙庚爲小六邊形其各邊亦卽大分又小五邊形與午丑乙丙氐大五邊形相似而體勢等則其各邊俱成比例乙甲全數與甲卯大分若乙午與午丑則以甲卯與午乙相乘全數除之亦得五邊形之一其午乙綫以乙亢午直角形用句求股術取之

表根五圈內作三等邊內切形求得一百二十度通

半之爲六十度正

法曰全徑上方形內減六邊形

上方形開方得一百二十度之

通

解曰甲爲圏心甲乙爲半徑作圏次乙爲心仍用乙甲爲半徑作弧與大圏相交於丁於戊其所截之丁乙戊弧卽三分圏之一何則依前六邊形之論丁乙戊乙二弧俱爲六分圈之一今丁乙戊弧乃倍大於丁乙必三分圈之一矣【一百二十度】卽作丁戊綫爲三等邊形之邊次以乙甲引至丙必平分丁丙戊大半圏於丙以丙乙爲過心綫旣平分丁戊弧於乙亦必平分丁丙戊弧於丙也從丙作丙戊丙丁二綫成丁丙戊三邊等內切形求之用乙丁丙三角形丁爲直角【以丁角乘丙戊乙半圏故】丁乙爲六邊形之一丙乙全徑上方減去丁乙半徑上方【丁乙卽乙甲】余開方得丙丁邊句求股術也

表根六圏內作十五等邊內切形求得二十四度之通

法曰三邊等形與五邊等形之較卽十五分圏之一可求二十四度通

解曰戊丙大圈醜爲心作丙子全徑取丙防爲宗依前法作丙甲辛三邊等形又作丙戊乙己庚五邊等形丙甲弧爲三分圈之一【一百二十度】丙戊乙弧爲五分圈之二【七十二度】相較得甲乙弧二十四度卽十五分圈之一也其求甲乙之邊以五邊形之邊乙己半於癸三邊形之邊甲辛半於壬得乙癸與甲壬相減【丁壬卽乙癸】存甲丁爲股次作乙丑甲丑兩半徑成乙丑癸甲丑壬二直角形以

乙丑半徑上方減乙癸半

上方余開方得癸丑邊又以

甲丑半徑上方減甲壬半

上方余開方得醜壬邊次以

醜癸與丑壬相減得壬癸【卽乙丁】爲句末用甲丁乙直角形甲丁上方與丁乙上方並開方得甲乙爲十五等邊內切形之邊

又解曰甲乙弧何以知爲十五分圏之一凡一圏內作三邊等形又作五邊等形以其邊數三與五相乘得十五卽知可爲十五等邊切形其兩弧之較必有十五分圏之一如甲乙也餘仿此推此亦曆書原法

表根七圈內作九等邊內切形求得四十度之通【新增】求內切九等邊形法曰甲爲圓心於圓內先作庚子辛三邊等形【法見前】平分大圓爲三分次用甲庚爲度作

庚己綫與庚辛爲直角庚爲

心己爲界作己壬弧爲全圏

六之一【六十度】次於己壬弧上

任取癸防向甲心作癸甲直

綫與庚辛交於戊其自癸至戊之度令與甲乙半徑等次癸爲心戊爲界作圏與大圏相交於丙於庚【庚防爲己壬弧圏心又癸戊半徑與庚己等必相交於庚】從癸又作癸庚癸丙二綫得庚戊丙圈所割之庚乙丙弧必爲庚辛弧三之二辛丙爲三之一卽全圏九分之一也末作丙辛綫爲內切九等形之邊依此作丙乙乙庚諸綫成九等邊內切形等邊等角解曰癸戊綫旣等甲乙半徑則兩圈相交之庚戊丙庚乙丙兩弧必等又癸甲綫旣過兩心【甲大圓心癸庚戊丙圈心】試作庚丙通必平分通於丁亦平分庚丙弧於乙與丙庚弧於戊而庚乙與丙乙等庚戊與丙戊等又兩弧【庚乙丙庚戊丙】共用庚丙通則丙戊與丙乙庚戊與庚乙亦各相等其丙戊丙乙庚戊庚乙四綫亦等又癸丙癸戊癸庚三綫俱卽半徑【癸爲庚戊丙圈心故】則癸庚戊癸丙戊爲兩腰等三角形而兩癸角又等【庚戊丙戊二弧等故】則兩形之邊角俱自相等又丙戊辛形其戊辛二角亦等何則戊角之餘爲丙戊庚角而丙戊庚乃庚戊癸丙戊癸兩角之並亦卽癸丙戊癸戊丙兩角之並【癸戊庚角與癸戊丙等因兩形爲等形亦與癸丙戊角等】是丙戊辛角必與戊癸丙角等其丙辛戊角乘庚丙弧則辛角必得庚丙之半與乙丙弧等亦與丙戊等是丙辛戊角亦與戊癸兩角等而辛丙戊爲兩腰等形因得戊丙與辛丙兩邊亦等夫丙戊邊本與戊庚等則醜丙與戊庚亦等而丙戊卽丙乙庚戊卽庚乙是辛丙丙乙乙庚三綫等也而辛丙丙乙乙庚三圈分亦等矣前庚乙辛弧乃全圈三之一今庚乙又爲庚辛三之一卽全圈九之一爲四十度而庚乙卽四十度通按癸丙綫必與庚甲平行其交己壬弧之丑防必居癸壬弧之中而壬醜醜癸癸己爲三平分各得十二度

求九邊形之邊法曰取十邊形相較可得九分圏之

邊如圖乙辛戊圓甲爲心取

辛丙弧爲十邊形之一【三十六度】戊乙弧爲九邊形之一【四十度】辛丙爲十邊形之邊乙戊爲

九邊形之邊二綫令平行則其較弧辛乙與丙戊相等【各二度】次作辛乙丙乙諸綫成辛乙戊丙四邊形此形有丙辛邊【前第五根所得】有辛乙邊【一度正之倍用後法所得】先求丙乙綫用丙辛乙鈍角形作辛丁垂綫以辛丙半之因乙辛得辛丁次以辛丁上方減辛乙上方開方得乙丁又以減辛丙上方開方得丁丙並之得乙丙綫與辛戊等次以乙丙自乘方內減去辛乙自乘方余以辛丙除之得乙戍爲九邊形之邊卽四十度通也【上圖之庚乙綫】

解曰丙辛綫旣與戊乙平行則丙乙辛戊兩綫相等辛乙與丙戊亦等從辛從丙作辛己丙午二垂綫所截戊乙綫之戊午己乙爲丙辛戊乙二綫相較之半亦必等夫丙乙自乘得丙乙上方形辛乙自乘得丙戊上方形【辛乙與丙戊等故】而丙乙上方乃丙午乙午上兩方之並丙戊上方又丙午戊午上兩方之並則試於丙乙上方減去丙午上方所餘爲乙亥方丙戊上方減去丙午上方所餘爲午未方而午未方卽己子方也今於丙乙上方形減丙戊上方形是減去丙午上一方又減去巳子一方【卽戊午上方形】所餘爲午卯丑亥磬折形夫午乙與己戊二綫相等則午丑與巳酉兩方形亦等因得卯午矩與申酉矩等移卯午補申酉則丑未矩形與午卯丑亥磬折形等矣故以子丑除之【子丑卽丙辛以卯亥爲正方故】得子未邊卽乙戊四十度通也

按九邊形法諸書所無然缺此則九十度之正不備壬寅秋客潤州魏副憲官署時魏公鋭意歷學因作此圖補之

附求一度之通【一度爲全圓三百六十之一亦可名三百六十等邊內切形】法曰一度之通取相近之數用中比例法得之如圖庚乙弧爲一度先設甲庚一度三十分依前法【表根六及表法一】求其正甲癸○度○二六一七六八九又求其通得○度○二六一七九二半之得○度○一三

○八九六爲己庚四十五

分弧正己辛也三分之

得己寅○度○○四三六

三三爲十五分弧略大綫

加己辛【卽未丑】得壬醜○度○一七四五二八爲一度弧略大之正次於甲癸綫內減己辛【卽戊癸】余戊甲亦三分之得丙戊○度○○四三六二四爲十五分弧略小綫加戊癸得丙癸○度○一七四五二卽丁午也爲丁庚一度略小弧之正夫大小兩其差八數爲壬亥半之得四壬申也【申亥同】加小減大得乙子○度○一七四五二四爲乙庚一度之正若求其通用正與正矢爲句股求之【此薛儀甫歷學防通法】

再細求一度正【系作枚法】

前四十五分弧之正○度○一三○八九六法以四十五分半之爲廿二分三十秒求其正得六五四四九又半之爲十一分十五秒求得正三二七二四五夫廿二分三十秒之弧倍於十一分十五秒而其亦倍則知二十分以內之弧正若平分數【縱有參差非算所及】法以廿二分三十秒爲一率正六五四四九爲二率十五分爲三率得四率十五分正○度○○四三六三二六次以十五分正與四十五分余○度九九九九一四三相乘得○度○○四三六二八八六○六八六爲先數以十五分余○度九九九九九○四八與四十五分正○度○一三○八九六相乘得○度○一三○八九四七五三八爲後數【相乘之理見表法六】兩數相並得○度○一七四五二三六一四五爲一度正與薛書略同但此法似宻

論曰弧與非平分數然一度以內弧相切曲直之分所差極微故可以中比例法求也

按上七根所求者皆各弧之通表中所列俱正蓋論割圓必以通便算則惟正然正卽通之半全與分之比例等其理一也

作表之法有七

用上根數於大圓中求七弧之通以爲造端之始而各度之尙無從可得爰立六種公法或折半或加倍或相總或相較轉輾推求以得象限內各度之正蓋上諸法乃其體此則其用也二者相資表以成焉

表法一有一弧之正求其餘及半本弧之正與余

解曰如圖甲爲圈心乙丙戊弧爲全圈四之一【九十】乙甲戊甲俱半徑設有戊丁丙弧其正爲丙庚卽從丙作丙甲綫成丙庚甲直角形法甲丙全數上方減丙庚正上方余開之得甲庚與丙辛等卽丙戊弧之餘也又用甲庚減甲戊半徑得庚戊矢又作丙戊綫成丙庚戊直角形法庚戊矢上方與丙庚上方並開方得丙戊爲戊丁丙弧通半之得丙己或戊己卽半本弧丙丁或丁戊之正又以丙甲己形【戊甲己形同】用句求股

術求己甲得半本弧之餘【癸丙等】若

再以丙己丁己二邊求丙丁半之

又得半丙丁弧之正餘仿此逓求

之

論曰丙戊弧旣平分於丁其丙戊

亦必平分於巳故半丙戊爲半本弧

之正試作丁甲壬象限則丙己正己甲余尢了然矣

表法二有一弧之正余求其倍本弧之正與余解曰甲丙象限內設有甲戊弧其正戊己余己乙今求倍甲戊之甲丁弧正丁癸與余癸乙法先作丁甲綫爲丁戊甲倍弧之通此綫必爲乙戊綫平分

於壬則壬甲亦爲甲戊弧正與

戊己等丁壬亦等夫壬甲旣等戊

己則其餘壬乙亦必等己乙法

用己戊乙庚壬乙兩形乙戊全數

與戊巳正若乙壬余【卽乙己】與壬庚而壬庚卽辛癸倍之得丁癸爲倍弧甲丁之正

論曰乙戊己乙壬甲兩形相等戊乙等甲乙戊己等甲壬己乙等壬乙故壬乙得爲余又乙戊己乙壬庚兩形相似故第四率可求壬庚【卽辛癸】而壬庚必爲丁癸之半以丁癸甲直角形丁甲旣平分於壬從壬作壬辛垂綫亦必平分其股於辛也故倍癸辛得丁癸爲倍弧甲戊丁正又壬庚綫亦平分甲癸句於庚用甲壬庚形依句股術求甲庚倍之以減甲乙存癸乙或丁子卽倍弧之餘也

表法三求象限內六十度左右距等弧之正解曰六十度左右距等弧之正與其前後弧兩正之較等如圖乙丙象限內設丙戊爲六十度【不動】有丙己小弧【須在三十度以上】丙巳丁大弧其大弧與丙戊六十度之較戊丁令與丙己小弧與戊丙六十度之較戊己等其大小兩弧正一爲己辛一爲丁庚相較爲丁癸此丁癸與己壬丁壬等則丁癸爲戊丁戊己距等弧之正壬甲爲余

論曰試從巳向子作巳子綫則丁巳子爲三邊等形何則形中壬子丁壬子己兩形相等【丁子壬己子壬兩角本等又同用壬子邊則兩形自等】而丁子壬角與乙甲戊角等【以丁庚與乙甲平行故】爲三十度【乙甲戊爲丙戊甲角六十度之餘】則丁子巳角爲丁子壬之倍必六十度又丁子壬巳子壬兩角等則其餘壬丁子壬巳子二角亦必各六十度而與丁子巳角等則丁子巳爲

平邊三角形夫丁子巳旣爲平邊

三角形其巳癸垂綫必平分丁子

於癸子壬垂綫必平分丁巳於壬

兩分之丁癸與丁壬必等而丁癸

乃己丙丁丙大小二弧兩正【一巳辛一丁庚】之較

按此須先求得象限內六十率之正依上法可求左右三十率之正外此卽不可用以六十度之餘止三十度故也

表法四任設兩弧之正余求兩弧並及較弧折半之正

解曰戊壬象限內任設不齊之兩弧一置在上如戊丙

一置在下如丁壬中間所容丙丁

弧卽戊丙丁壬兩弧並之餘今求

半丙丁弧丙乙【丁乙同】之正法作

丁壬弧正丁辛余丁癸戊丙

弧正丙壬【卽癸己】余丙子又作丙丁綫爲較弧之通成丙己丁直角形次以丁壬弧正【丁辛巳子同】減戊丙弧余【丙子】得丙己爲股丁壬弧余【丁癸】減戊丙弧正【癸己】得丁己爲句句股求得丙丁邊半於庚得丙庚或庚丁爲丙丁半弧丙乙之正

巳上俱系曆書原法

表法五有一弧之正求倍本弧之矢因得余解曰設戊乙弧其正乙丁戊丙爲戊乙弧之倍其正丙己正矢戊己丙戊爲倍弧通半於辛其辛戊與乙

丁等法用戊丙己戊辛甲兩直角

相似形【二形同用戊角故相似】甲戊與戊辛

若丙戊與戊己倍弧矢夫四率之

理二三相乘之矩內形與一四相

乘之矩等則丙戊乘辛戊卽甲戊乘戊己而丙戊乘辛戊所得矩形爲辛戊上方形之倍【戊辛自乘得辛庚方倍之爲丙庚矩卽丙戊與戊庚相乘之冪也戊庚卽戊辛】而全數【甲戊也】又省一除故以乙丁正【卽辛戊】自乘倍之退位卽得戊己倍弧矢用減半徑得倍弧余己甲若反之以戊己矢折半進位開方卽得半本弧之正【丁乙】此孔林宗術勿庵稱爲正簡法余作此圖以著其理

表法六任設不齊之兩弧求兩弧相並之正及相較之正

解曰寅巳未圏甲爲心寅巳爲一象限設寅已弧內有己辛弧若干度爲前弧又有己戊弧小於己辛爲後弧戊子爲後弧正子甲其餘午辛爲前弧正午甲

其餘次取辛丑弧與己戊後

弧等則己戊丑爲前後兩弧之

並弧丑亥卽並弧之正次作

醜壬綫爲醜辛弧正與戊子

等其餘壬甲亦與子甲等辛壬亦與子巳等法用甲午辛甲壬丁二相似形以後弧之餘壬甲因前弧之正辛午全數【甲辛】除之得壬丁爲初數【卯亥等】寄位次用甲辛午丑壬卯二相似形【甲辛午形之辛角與丑乙辛角等因丑壬乙爲直角其丑壬卯角亦與丑乙壬角等則亦與甲辛午角等又二形之卯午俱爲直角則兩形相似】甲辛與甲午若丑壬與丑卯則以前弧之餘甲午因後弧之

正醜壬全數【辛甲】除之得醜

卯爲次數末以五卯與初數

卯亥相並得丑亥爲已戊丑

兩弧相並之正若求兩

弧相較之正法以後弧醜壬正引長之抵圈界於癸則丑癸爲丑辛癸弧之通因壬防爲直角其癸壬與丑壬必等因得醜辛癸辛兩弧亦等夫醜辛弧原與戊巳後弧等則辛癸與戊己弧亦等卽以辛癸減辛己前弧得癸己爲兩弧之較癸庚卽較弧之正癸酉其餘法用丑辰癸形此形內之癸申壬丑卯壬二直角形相等【丑癸辰句股形丑癸旣平分於壬則從壬作壬卯壬申二垂綫亦必平分丑辰句於卯癸辰股於申而癸申壬丑卯壬兩形必等】因得壬申卽丑卯次數【壬申等卯辰卯辰卽丑卯】用以減初數壬丁存申丁卽癸庚也爲較弧癸巳之正亦與戊辛弧正等

若兩弧相並在象限外如次圖巳寅丑弧理亦同【鈐記同前】有不齊之兩弧求相並相較弧正又法

法曰兩弧【小甲丙大甲戊】相並曰總弧【甲癸】相減曰多弧【戊丙】置大小兩弧以大弧正【戊辛】因小弧較【子庚】曰先數【庚乙】以大弧較【辛庚】因小弧正【庚午】曰後數【午未】視兩弧在象限內者以後數【亥壬】減先數【亥丙也以午亥丙形與庚乙子形等故】爲多弧正【壬丙】以後數卯丑加先數【丑已以庚巳醜形與庚乙子形等故】爲總弧正【卯巳也以卯午巳形與庚酉癸形等故卯己卽酉癸】若兩弧過象限者加減各異

又或置大小兩弧【同上】以

大弧正【戊辛】因小弧正

午庚曰先數【庚未】以大

弧較【庚辛】因小弧較

【庚子】曰後數【子乙】視兩弧在象限下以後數【午亥】加先數得多弧較【壬庚】以後數【庚醜】減先數【庚未】得總弧較【丑未卽午卯亦卽庚酉】若兩弧象限內外不等加減亦異

此法詳三角會編五卷梅勿庵先生環中黍尺亦著其法然彼所論者弧三角形此則平圓中求正也

表法七圓內有五通錯互成四不等邊形求不知一弧之通

解曰甲爲圓心戊庚爲圓徑戊丙丙丁丁庚俱爲通成戊庚丁丙四不等形丁戊丙庚爲對角綫法丁戊偕丙庚相乘之矩形內減丁庚偕丙戊相乘之矩形余爲戊庚與丙丁相乘之矩形蓋丁庚丙戊相乘之矩與戊庚丁丙相乘之矩並與丁戊丙庚兩對角綫相乘之矩

等也若有丙戊丁庚戊庚丙

庚丁戊五通用此可得丙

丁弧之通

論曰庚戊丁形與庚丙丁形

其戊丙兩角等【同乘丁庚弧故】若以

丙丁引至己作庚己丙直角形則庚戊丁庚己丙兩直角形相似庚戊與戊丁若庚丙與丙己夫四率之理二三相乘矩形與一四相乘之矩等則庚丙與丁戊相乘所得卽庚丙與丙己相乘之己壬矩也【取己癸與庚戊徑等】次作丁辛綫與己癸平行割圈於子其子庚弧與丙戊弧等何則戊丁庚爲直角丙丁子亦爲直角同用戊丁子角【子戊弧】則丙丁戊庚丁子兩角必等其所乘之丙戊庚子兩弧亦等矣因得庚子邊卽丙戊通又庚子丁角與庚戊丁角等【同乘丁庚弧故】於庚作庚乙垂綫與己丙平行成子庚乙直角形與庚戊丁直角形相似戊庚與庚丁若子庚與庚乙依四率之理庚子【卽丙戊】與丁庚相乘所得卽庚戊與庚乙相乘之己辛矩也【丁辛卽庚戊己丁卽庚乙】用以減己壬矩形餘丁壬矩形乃庚戊與丁丙相乘之冪故以庚戊除之得丁丙爲丁丙弧之通

若戊丙丁庚非半圈【或大或小不論】則庚

戊爲戊丙庚弧之通理亦同但

己壬爲斜方形如上圖戊丁庚爲

小半圈成己壬斜方其庚乙綫不

與丁己平行法作己庚乙角令與

丁己庚角等則腰間相對丁乙二角亦等因得庚乙丁己爲等邊而庚乙子鈍角爲丁乙庚之餘與丁己庚角自等亦卽與圓內戊丁庚角等而庚乙子庚戊丁爲相似形庚乙卽丁己

此上古多羅某法諸書未有能言其故者得余此圖庶不昧古人精意已上二法系余所增

用上七法交互推求可得象限內各度之正細推之又可每隔十五分【四分度之一】得一正十五分以下用中比例法以十五分正爲實十五爲法而一得一分之正逓加之得每度內各分之正立割圓表又此正算一象限巳足以適滿一直角故也

求切綫角綫矢綫

割圓正而外又有切割矢三綫並正爲四綫合其餘爲八綫蓋以八綫凖一弧弧之曲度得其眞矣切綫止切圈以一防全在圏外割綫從圈心過規半在內半在外正與矢全在圈內如圖甲爲圈心庚丁爲象限庚甲丁甲俱半徑設有庚乙正弧卽戊乙爲正乙辛【戊甲同】爲余次於圏外作庚己綫與戊乙平行切圈於庚又從甲心過所截弧乙防作甲己綫與庚己交於己成甲己庚直角形此己庚爲乙庚弧正切綫己甲其正割綫也而甲己庚直角形與圓內戊甲乙形相似甲戊與戊乙若甲庚與庚己故以余除正半徑因之得本弧正切又戊甲與甲乙若庚甲與甲己故以余除半徑全數因之得本弧正割以戊甲余減甲庚半徑得庚戊本正矢此皆庚乙弧相當之綫也夫庚乙旣爲正弧則乙丁爲余弧作乙辛綫爲余弧之作丙丁綫切圏於丙爲余弧之切甲乙引出之遇於丙甲丙爲余弧之割成甲丙丁直角形與圓內甲乙辛形相似甲

辛與辛乙若甲丁與丁丙得

余切甲辛與甲乙若甲丁與

甲丙得余割乙戊【卽甲辛】正

減甲丁半徑得辛丁余矢此

又丁乙余弧相當之綫也一正一餘共有八綫若或以丁乙爲正弧卽庚乙反爲余弧其八綫正余之名亦互易蓋此爲正彼自爲余耳

論曰庚乙正弧之各綫爲甲庚己甲戊乙兩句股形所成乙丁余弧之各綫爲甲丁丙甲辛乙兩句股形所成而甲庚己形與甲丁丙形相似【一爲順句股一爲倒句股】又圓內之乙甲辛甲戊乙二句股形俱自相似亦與甲丁丙甲庚己二形相似是庚乙弧相當之綫成相似之直角形四設算可以用正亦可以用余是一弧而能兼用八綫此八綫表所由名也

按表中不列矢綫者以矢綫用正余減半徑卽得且不常用故省之又按割圓之難全在求正若切割綫俱以比例得之

附求割綫省法【用加減算】

如乙己弧爲二十度其切綫乙戊求割綫甲戊法先以余己丙七十度半於丁得丁己三十五度丁丙等次

以戊乙切綫引長之令與戊甲

等作甲戊辛兩腰等三角形而

乙庚弧必與丁丙等卽查乙庚

弧之切乙辛並乙戊得戊辛卽甲戊割也

解曰乙庚弧何以與丁己弧等蓋甲辛戊旣爲兩腰等三角形則甲角之己庚弧必爲丙己余弧【己壬也】之半壬庚與己庚等而庚防居己壬弧之中夫丙己與己壬並等兩直角則己庚弧之不滿直角者必爲丙己之半今丙己旣半於丁則以丁己益己庚丁甲庚必爲直角而乙甲丙亦直角也共用乙甲丁角【或丁乙弧】則丙己與乙庚等

求矢綫余減半徑得正矢正減半徑得余矢求切綫余除正半徑因之得正切正除余半徑因之得余切

求割綫余除半徑半徑因之得正割正除半徑半徑因之得余割

按圓內矢二綫當正弧初度則無九十度極大卽半徑圈外切割二綫切綫當正弧初度亦無割綫卽半徑至九十度俱極大且切與割平行不能相遇名曰無窮之度然至此亦無切割之可言矣惟將近九十度防有極大之切割綫

定八綫正余之界

庚戊丙半圓甲爲心戊丙爲象限設丙乙正弧在九十度內則乙壬爲正壬丙爲正矢甲丁爲正割丙丁爲

正切其戊乙余弧乙己爲余己

戊爲余矢甲辛爲余割戊辛爲余

切若設庚戊乙爲正弧在九十度

外亦以乙壬爲正丁丙爲正切

甲丁爲正割壬丙爲正矢而庚壬亦爲正矢又名大矢其餘弧仍用戊乙【非乙丙】在庚戊象限之外乙己爲余戊己爲余矢戊辛爲余切甲辛爲余割蓋乙壬正爲丙乙庚乙兩弧共用故總以戊乙爲余弧也凡算三角形取用正余諸綫以此爲凖

歷算全書卷五十五﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

欽定四庫全書

歷算全書卷五十六

宣城梅文鼎撰

方圓冪積一卷

方圓冪積說

曆書周徑率至二十位然其入算仍用古率【十一與十四之比例本祖衝之徑七周二十二之宻率】豈非以乘除之際難用多位歟今以表列之取數殊易乃爲之約法則徑與周之比例卽方圓二冪之比例【徑一則方周四圓周三一四一五九二六五而徑上方冪與員冪亦若四與三一四一五九二六五尾數八位並以表爲用】亦卽爲立方立圓之比例【同徑之立方與圓柱若四與二一四有奇則同徑之立方與立員若六與三一四有奇】殊爲簡易直截癸未歳匡山隠者毛心易幹幹偕其壻中州謝野臣惠訪山居共論周徑之理因反覆推論方員相容相變諸率庚寅在吳門又得錫山友人楊昆生定三方員訂注圗說益覺精明甚矣學問貴相長也

方圎相容

新法曆書曰割圓亦屬古法蓋人用圭表等測天天圎而圭表直與圎爲異類詎能合歟此所以有割圎之法也新法名爲八綫表云

又云徑一圍三絕非相凖之率然徑七圍二十二則盈徑五十圍百五十七則朒或詳繹之則徑一萬圍三萬一四五九𨿽亦小有奇零不盡然用之頗爲相近今算得平方與同徑之平圓其比例若四○○與三一四五九平方內容平員平員內復容平方則內方與外方內員與外員之冪皆加倍之比例

假如戊己庚辛平方內容甲乙丙丁

員員內又容甲乙丙丁小平方小方

內又容壬丑癸子小平員如此逓互

相容則其冪積皆如二與一也

假外大平方【戊己庚辛】之積一百則內小平方之積【甲丁乙丙】必五十平員亦然

若求其徑則成方斜之比例大徑如斜小徑如方假如內小平方積一百以甲丁或丙乙爲徑【甲丙或丁乙並同】開方求一百之根得徑一十其外大平方積二百以甲乙或丁丙爲徑【或用戊庚或己辛或己戊或辛庚爲徑並同】開方求二百之根得徑一十四一四有奇

甲乙爲甲丁方之斜故斜徑自乘之冪與其方冪若二與一而其徑與斜徑若一十與一十四【一四奇】也折半則爲五與七【○七奇】故曰方五則斜七有奇也

三邊形內容平員平員內又容三邊則其冪之比例爲

四與一甲乙丙三邊形內容丁戊己

平員平員內又容丁戊己小三邊則

內小三邊形爲外大三邊形四之一

內外兩平員之冪其比例亦爲四與一

若有多層皆以此比例逓加

渾員內容立方立方內又容渾員如此逓互相容則外員徑上冪與內員徑上冪爲三倍之比例外立方與內立方之徑冪亦然丙庚丁渾員內容丙甲丁乙立方丙戊及戊甲皆立方邊【丙辛及甲辛並同丙乙及甲丁等亦同】丙戊甲辛爲立方面【餘六面並同】丙甲【爲方面斜綫】丙丁【爲立方體內對角綫】卽渾員徑【乙甲同其辛壬及己戊皆亦對角若作綫亦同】丙乙及甲丁等又皆爲立楞【戊壬及辛己同】解曰立方面上斜徑之冪爲方冪之倍【句股法也

斜爲方爲句又爲股並句股實成實故倍方冪卽成斜徑之冪】又以斜徑

爲股立方之立楞爲句求得立方體內両對

角之斜徑爲此實內有股實【卽面上斜徑之冪爲

方冪者二】有句實【卽立楞之冪立楞原卽方邊故其冪卽立方面冪】共得方

冪三而此丙對角斜徑卽渾員之徑內小員徑又在立方體內卽以方徑爲徑其徑之冪卽立方面也故曰三倍比例也立方內又容立員則內員徑卽立方之徑

若求其徑則外徑大於內徑若一十七有奇與一十內徑之冪百開方得一十爲徑則外徑之冪三百開方得一十七【又三十五之一十一】爲徑若有幾層互容皆以此比例逓加卽得若求其體積則爲五倍有奇之比例【若有多層亦以此比例逓加】假如內容立方積一千則外大立方積五千一百九十四有奇解曰立積一千則其徑冪一百而外大立積之徑冪三百又以徑一十七【又三十五之一十一】乘之得五千一百九十四【又七之二】此言大方積又在圗上渾員之外

積之比例

立方同徑之立員其比例爲六○○與三一四

立方同徑之員柱其比例爲四○○與三一四

員柱與同徑之立員其比例爲三與二

方圎周徑相求

同積較徑爲方變員員變方之用

凡方圎同積則員徑大方徑小其比例若一一二八三七九與一○○○○○○

解曰員徑一一二八三七九則方徑一○○○○○○也法曰有員徑求其同積之方徑當以一○○○○○○乘以一一二八三七九除

有方徑求其同積之員徑當以一一二八三七九乘以一○○○○○○除

凡方員同積則員徑上平方與方徑上平方其比例若四○○○○○○○○與三一四一五九二六五解曰員徑自乘四○○○○○○○○則方徑自乘三一四一五九二六五

法曰有員徑求其同積之方徑當以三一四一五九二六五乘之四○○○○○○○○除之得數平方開之得方徑

有方徑求其同積之員徑當以四○○○○○○○○乘三一四一五九二六五除得數平方開之得員徑凡方員同積則員徑與方徑若一○○○○○○與○八八六二二六

解曰員徑一○○○○○○則方徑八八六二二六也法曰有員徑求同積之方徑以八八六二二六乘員徑一○○○○○○除之卽得方徑

有方徑求同積之員徑以一○○○○○○乘方徑八八六二二六除之卽得員徑

約法

以一一二八二七九乘方徑去末六位得同積之員徑以○八八六二二六乘員徑去末六位得同積之方徑同積較周

凡方員同積則員周小方周大其比例若一○○○○○○與一一二八三七九亦若八八六二二六與一○○○○○○

解曰員周一○○○○○○則方周一一二八三七九也

方周一○○○○○○則員周八八六二二六也約法

以一一二八三七九乘員周去末六位得同積之方周以○八八六二二六乘方周去末六位得同積之員周凡方員同積則其徑與徑周與周爲互相視之比例解曰方周與員周之比例若員徑與方徑也

論曰凡同積之周方大而員小同積之徑則又方小而員大所以能互相爲比例

約法

以方周乘方徑爲實員周除之得員徑若以員徑除實亦得員周

以員周乘員徑爲實方周除之得方徑若以方徑除實亦得方周皆用異乘同除例如左

一員周一○○○○○○

一方周一○○○○○○二方周一一二八三七九

二員周○八八六二二六三方徑○二八二○九四【七五】三

員徑○二八二○九四【七五】四員徑○三一八三○九【八八】四

方徑○二五○○○○積七九五七七【四四八

○○○○○○】

積六二五○○○○○○○○

一員徑一○○○○○○

一方徑一○○○○○○二方徑○八八六二二六

二員徑一一二八三七九三方周三五四四九○四

三員周三五四四九○四四員周三一四一五九二

四方周四○○○○○○積七八五三九【八一六

○○○○○○】

積一○○○○○○○○○○○○

第四率並與一率乘得四倍積四除之得本積

論曰以上皆方員周徑互相求乃同積之比例方員交變用之卽比例規變面綫之理

同徑較積較周卽方內容員員外切方

凡方員同徑則方積大員積小周亦如之其比例若四○○○○○○○○與三一四一五九二六五

方徑一○○○○周四○○○○積一○○○○○○○○員徑一○○○○周三一四一五奇積○七八五三九八一六方徑二○○○○周四○○○○積四○○○○○○○○員徑二○○○○周六二八三一奇積三一四一五九二六五凡徑倍者周亦倍而其積爲倍數之自乘亦謂之再加比例授時歷謂之平差

徑二倍周亦二倍而其積則四倍徑三倍周亦三倍而其積九倍乃至徑十倍周亦十倍而積百倍徑百倍周亦百倍而積萬倍皆所加倍數之自乘數亦若平方謂之再加也

同周較積較徑

凡方員同周則員積大方積小徑亦如之其比例若四○○○○○○○○與三一四一五九二六五

方周一○○○○○○徑○二五○○○○積六二五○○○○○○○○員周一○○○○○○徑○三一八三○九八八積七九五七七四七○○○○方周四○○○○○○徑一○○○○○○積一○○○○○○○○○○○○員周四○○○○○○徑一二七三二三九五四積一二七三二三九五四○○○○論曰周四則徑與積同數但其位皆陞皆視周數之位今用百萬爲周則積陞六位成萬億矣故𨿽同而實不同不惟不同而且懸絕定位之法所以當明也

問位旣大陞而數不變何耶曰周徑相乘得積之四倍於是四除其積卽得所求平積此平冪之公法也玆方員之周旣爲四則以乘其徑而復四除之卽還本數矣惟周數之四或十或百或千萬億無定而除法之四定爲單數故無攺數而有進位也

又論曰周四倍之徑與周一之徑爲四倍其積則十六倍所謂再加之比例

渾圎內容立方徑一萬寸求圎徑法以方斜一萬四千一百四十二寸爲股自乘得二億爲股實以方徑一萬寸爲句自乘得一億爲勾實並勾股實爲三億爲實開方得一萬七千三百二十○半寸命爲渾圎之徑

又以渾圎徑求圍得五萬四千四百十四寸弱周徑相乘得九億四千二百四十七萬六九九四寸爲渾冪以四除渾冪得二億三千五百六十一萬九千二百四十八寸奇爲大平圎冪卽立方一萬寸外切渾圎之腰圍平冪也

圎柱積四萬○千八百十○億四三一八四九八四寸以渾圎徑乘平圎冪得之

倍圎柱積以三除之得渾圎積二萬七千二百○六九五四五六六五六寸

約法立方徑一千尺其積一十尺外切之渾圎徑一十七尺三二○五渾圎積二千七百二十○尺六九五四約爲二千七百二十一尺弱

試再用徑上立方求渾圎積法【卽立方內求所容渾圎】以渾圎徑自乘再乘得渾圎徑上立方以圎率【三一四奇】乘之得數六除之得渾積並同

立方與員柱若四○○與三一四奇【同徑之員柱也】

立方爲六方角所成員柱爲六員角所成其所容角體並六而方與員異故其比例如同徑之周此條爲積之比例

員周上自乘之方與渾員面冪若三一四奇與一○○渾員面冪與員徑上平方形亦若三一四奇與一○○皆員周與徑之比例

渾員面冪與員徑上平員若四與一

員柱面冪與員徑上平員若六與一【六員角之底皆外向合成此數】平員並爲一而員柱冪爲其六倍渾員冪爲其四倍渾員爲員柱三之二卽此可徴積之比例如其面也以上四條並面冪之比例渾員體與員角體若四與一渾員面旣爲平員之四倍從面至心皆成角體故體之比例亦四倍

立方面與徑上平方若六與一【六面故也】

立方體與渾員體若六○○與三一四奇

渾員面與徑上平方旣若三一四奇與一○○而立方面與徑上平方若六與一平方同爲一○○而立方面爲其六倍渾員面爲其三倍一四奇故立方之面與渾員之面亦若六○○與三一四奇也而體之比例同面故亦爲六○○與三一四奇

立員得員柱三之二

論曰凡員柱之面及底皆立員徑

上平員也旁周似員筩亦如截竹

周圍並以員徑爲髙卽員徑乘員

周冪也爲徑上平員之四倍與渾

員面冪同積【半徑乘半周得平員則全徑乘全周必平員之四倍】合面與底共得平員之六倍而渾員面冪原系平員之四倍是員柱冪六而渾員冪四也而體積之比例凖此可知亦必爲三之二矣【三之二卽六之四之半】

問體積之比例何以得如面冪曰試於員柱心作員角

體至面至底成員角體二皆以半

徑爲髙平員爲底其餘則外如截

竹而內則上下並成虛員角於是

縱剖其一邊而令員筩伸直以其

冪爲底以半徑爲髙成長方錐【底濶

如全徑直如員周髙如半徑錐只一防】此體卽同四

員角【或縱剖爲四方錐亦同皆以周四分之一爲底濶以全徑

爲底長以半徑爲髙其體並同員角何也以周四之一乘全徑與半

徑乘半周同故方底同員底而其髙又同則方角同員角】合面

底二員用共六員角矣而渾員體

原同四員角【渾員面爲底半徑爲髙作員錐卽同四員

角】是員柱渾員二體之比例亦三

與二也

員角體得員柱三之一凡角體並同

凖前論員柱有六員角試從中腰平截爲兩則有三員角而員筩體原當四員角今截其半仍爲二員角或面或底原系一員角合之成三員角以爲一扁員柱然則員角非員柱三之一乎

若立方形各從方楞切至心則成六方角【皆以方面爲底半徑爲髙】從半徑平切之爲扁立方則四周之四方角皆得一半成兩方角而或底或面原有一方角亦是三方角合成一扁立方而方角體亦三之一矣

渾員體分爲四則所分角體各所乘之渾冪皆與員徑上平員冪等

甲戊丙丁渾員體從丑乙辰乙癸乙子乙卯乙寅乙等各半徑各自其渾冪透至乙心而以半徑旋行而割切之則成上下兩員角體一甲卯辰丑乙【以甲丑卯辰割渾員之面爲底乙爲其銳此割員曲徑自丑而甲而辰居員周三之一】一丙癸寅子乙【以子丙寅癸渾員之割面爲底乙爲其銳此割員曲徑亦

三之一如三百六十之一百二十】此上下兩角體

相等皆居全渾體四之一中腰成

鼓形而上下兩面並穵空各成虛

員角【其外則周遭皆凸面如丑戊子及辰丁癸之割員狀此割

員曲徑自辰而丁而癸居員周六之一爲三百六十之六十】

此鼓形體倍大於上下兩角體居渾員全體之半若從戊乙丁腰橫截之爲二則一如仰盂一如覆碗而其體亦渾員四之一也

如此四分渾體而其割員之面冪卽各與員徑上之平員冪等故曰渾員面冪與徑上平員若四與一也問何以知中腰鼓體能倍大於上下兩角體曰試於子丙乙癸角體從子寅癸橫切之則成子未癸午小員面

爲所切乙子寅癸小員角體之底

乃子寅小半徑乘子未癸小半周

所成也然則以子寅小半徑乘子

未癸小半周又以乙寅半半徑爲

髙乘之而取其三之一卽小角體矣

試又於中腰鼓體從丑子及卯寅

及辰癸諸立綫周遭直切之脫去

其外鼓凸形卽成員柱體之外周

截竹形又從酉乙申橫切之爲兩

【一仰盂一覆碗】則此覆碗體舉一式爲例

可直切斷而伸之亦可成方角體

此體以乙寅半半徑乘子未癸午

小員全周爲底【其形長方】又以小半徑

子寅【子寅卽乙申】爲髙而乘之取三之

一爲長方角體此長方角體必倍

大於小員角體何也兩法並以小

半徑及半半徑兩次連乘取三之

一成角體而所乘者一爲小員全

周一爲小員半周故倍大無疑

也

又丙癸寅子亦可成角體與乙子

寅癸等覆碗體旣倍大則兼此兩

角體矣

凖此而論仰盂體必能兼甲丑卯辰及乙辰卯丑兩角體亦無疑也

又角體內旣切去一小角體又穵

去一相同之小角體則所餘者爲

丙癸寅子員底仰盂體

鼓體內旣穵去如截竹之體則所

餘者爲內平【如丑子及辰癸】外凸【如子戊丑及辰

丁癸】之空圈體而此體必倍大於員

底仰盂體何以知之蓋兩體並以

半徑爲平面【丑子與癸丙並同】並以員周

六之一爲凸面而腰鼓之平面以

半徑循員周行員底仰盂之平面則以半徑自心旋轉周行者兩頭全用旋轉者在心之一頭不動而只用一頭則只得其半矣故決其爲倍大也

凖此而甲丑卯辰亦爲穵空之員覆碗體而只得鼓體之半矣由是言之則上下角體各得中腰鼓體之半而鼓體倍大於角形渾體平分爲四夫復何疑

曰渾體四分如此眞無纎芥之疑體旣均分爲四則其渾體外冪亦勻分爲四亦無可復疑但何以知此所分四分之一必與徑上平員相等耶曰此易明也凡割渾員一分而求其冪法皆從其所切平面員心作立綫至凸面心而以其髙爲股員面心至邊之半徑爲勾勾股求其斜用爲半徑以作平員卽與所割圎體之凸面等冪假如前圗所論上下兩角體從丑夘辰橫綫切之則以甲夘爲股夘醜爲句求得甲醜與半徑同以作平員與丑夘辰甲凸面等然則此角體之凸面豈不與徑上平員等冪乎

甲亢半徑與甲醜同以作醜

亢平員與甲丑夘辰凸面等

冪

試又作甲戊綫爲半徑之斜綫【甲乙與戊乙皆半徑爲句爲股故也】以爲半徑而作平員必倍大於半徑所作之平員而渾員半冪與之等則渾員半冪不又爲平員之倍乎

【如圖甲醜爲半徑作乙庚房平員與丙戊甲平員等亦與甲辰夘丑

割員凸面等爲渾冪四之一也】

【甲戊爲半徑作戊心亥平員與甲丁乙戊半渾冪等而倍大於乙庚

房亦倍大於丙戊甲平員則平員居渾冪四之一】

如是宛轉相求無不脗合則平員爲渾員冪四之一信矣取渾冪四之一法

當以半徑爲通以一端抵圎徑之端爲心旋而防之則所割渾冪爲四之一而其渾冪與圎徑上平員冪等

甲辰【卽丁乙】之自冪一百辰夘之自

乘冪【七十五】如四與三則辰丑通

爲徑以作平員亦丁戊全徑上平

員四分之三也大小兩平員各爲

底以半徑爲髙而作員角體其比

例亦四與三也

今渾員徑上平員【卽下戊徑上平員】所作之員角體旣爲渾積四之一則辰丑通徑所作之員角體卽渾體十六之三矣【卽甲丑夘辰角體及乙丑夘辰角體之合】若以丑辰通上平員爲底半半徑爲髙而作角體卽渾體三十二之三

分渾體爲四又法

甲乙丙渾員體從員周分爲三【一丑甲辰一辰癸丙一丙子丑各得周三之一】又從辰從丙從丑依各半徑【辰乙丙乙丑乙皆是】至乙心旋而

切之則成三角體者三各得渾體

四之一【一辰甲丑乙一丑子丙乙一丙癸辰乙說見前】則

其所餘亦渾體四之一也【此余形有三平

員面以辰丑丑丙辰丙爲員徑而並穵空至乙心如員錐之冪有兩】

【凸面以辰丑丑丙辰丙之員周爲界以乙爲頂皆弧三角形三角並銳】兩凸面各得渾員冪八之一按辰丑卽一百二十度通也凖前論以此通爲圎徑作平員爲底半半徑爲髙而成員角體此員角體積卽爲渾員體積三十二分之三【卽先所論員角體八之三】

若依此切渾員體成半平半凸之體其積爲渾積三十二之五【卽員角體八之五】

環堵形面冪錐形面冪

有正方正員面欲於周作立圍之堵墻而冪積與之倍法於方面取半徑爲髙卽得

甲乙丙平方於其周作立起之

方圍形如環堵取平方乙丙半

徑爲髙則方圍面冪倍大於平方

論曰從平方心乙對角分平方爲四成四三角形並以方根爲底半徑爲髙於是以此四三角形立起令乙銳上指則皆以乙丙半徑爲髙而各面皆半冪故求平方以半徑乘周得冪也然則依方周作方墻而以半徑爲髙豈不倍大於平方冪乎

凖此論之凡六等邊八等邊以至六十四等邊𨿽至多邊之面而從其各周作墻各以其半徑爲髙則其冪皆倍於各平冪矣然則平員者多邊之極也若於其周作立圈如環而以其半徑爲髙則環形冪積亦必倍大於平員有方錐員錐於其周作圍墻而冪積與之倍

法於錐形之各斜面取其至銳之中綫【如乙丙】以爲環墻之髙卽得

方墻如環堵底用方周髙如乙

丙卽斜面自銳至底之斜立中

綫

解曰此以錐體之斜面較冪也

論曰凡方錐皆有稜兩稜交於銳各成三角面而斜立從此斜立之三角面自銳至根濶處平分之得中綫【乙丙】於是自稜剖之成四三角面而植之則中綫直指天頂而各面皆圭形爲半冪故凡錐體亦可以中綫乘半周得冪也然則於底周作方墻而以中綫爲髙四面補成全冪豈不倍大乎

凖此論之凡五稜六稜以上至多稜多面之錐體盡然矣而員錐者多稜多面之極也則以其斜立綫爲髙而自其根作員環則其員環之冪亦必倍大於員錐之冪前條所論切渾員之算得此益明蓋員仰盂員覆碗及穵空之鼓形其體皆一凸面一平面相合而成其凸面弧徑皆割渾員圈六之一其平面之濶皆半徑然而不同者其內面穵空之平冪一爲錐形【仰盂覆碗之內空如笠】一爲環形也【鼓體之內空如截竹】準前論穵空之環冪必倍大於錐形之冪則其所負之割渾員體亦必環形所負倍大於錐形而穵空之鼓體必能兼員覆碗員仰盂之二體

撱圎算法【訂曆書之誤】

偶查撱圎求體法見其截小分之法有誤今以數考之假如撱圎形長徑爲一千四百尺短徑七百尺大分截長徑一千○五十尺

甲己三百五十戊乙七百相並得

一千○五十以此乘

己乙一千○五十尺以此除

兩數相同

右依曆書先求得庚壬甲圎角形爲苐三率再用截大分軸己乙爲法爲苐一率以截小分軸甲己並戊乙半長徑爲苐二率求得小分之容與圎角形等夫小分之容形外爲弧綫圎角之容形外爲直綫小分必大於圎角而今等是不合也況自此而截小分漸小則乙己大分軸反大於甲己小軸及戊乙並之數而求小分之容反將更小於圎角矣有是理哉【小分漸小如辛癸甲則其甲己小於己戊而己乙者己戊與戊乙並也則其數亦大於甲己與戊乙並矣】

又如截大分長七百二十分己乙

爲其軸甲己爲其小分軸六百八

十分

依曆書法甲己小分軸【六百八十】爲一率甲乙長徑【一千四百】並戊乙短徑【七百】共【二十一百】爲二率求到庚壬乙圎角體爲三率則所得四率爲大分之容者比圎角容大三倍有奇亦恐無是理也何也圎角在圎柱形爲三分之一而撱形必小於柱形不宜有三倍之比例也【𨿽壬庚略小於丙丁在中腰相近可以不論】今試求之【用苐一圗】依勿庵攺法

假如截己乙大分軸一千○五十尺求庚己壬平圎面法先求庚己依勿庵補法以己戊【三百五十尺】自乘【一十二萬二千五百尺】與甲戊【七百尺】自乘【四十九萬尺】相減余【三十六萬七千五百尺】開方得己庚相當之原數再以丙戊【三百五十尺】乘之甲戊【七百尺】除之爲己庚實數倍之爲庚壬綫

再以壬庚綫上方變爲平員今用簡法【因長徑甲乙與短徑丙丁原是折半之比例故也】竟以減余【三十六萬七千五百尺】命爲庚壬綫上方以十一乘之得【四百○四萬二千五百尺】又以十四除之得【二十八萬八千七百五十尺】爲庚壬綫上所截撱體之平圎面

法以平圎面各乘其【大分小分】之軸【一千○五十尺三百五十尺】皆成圎柱形乃三除之爲【大小】分內所容之【大小】圎角形

再以長徑【一千四百尺】乘大圎角爲實小軸【三百五十尺】除之爲所截撱形之大分

以長徑【一千四百尺】乘小圎角爲實大軸【一千○五十尺】除之爲所截撱形之小分

今用簡法置平圎面三除之得【九萬六千二百五十尺】以小分軸【三百五十】乘之得庚甲壬小圎角形【三千三百六十八萬七千五百尺】置小圎角四因三除之得【四千四百九十一萬六千六百六十六又三之二】爲所截小圎分

又置圎面三除之積【九六二五○】以大分軸【一千○五十尺】乘之得庚子乙大圎角形【一億○一百○六萬二千五百尺】

置圎角形【一○一○六二五○○】用四因之得【四億○四百二十五萬尺】爲所截大圎分

小圎分大圎分兩形並之【共四億四千九百一十六萬六六六六】爲撱形全積

另求撱形全積

置短徑【七百】自乘得【四十九萬】以長徑【一千四百】乘之得【六億八千六百萬】以十一因之二十一除之得【三億五千九百三十三萬三三三】爲眞撱圎全積

以眞撱圎積與兩截形並相較其差爲九十分之一而弱

若用曆書法求得截小分【二千三百六十八萬七千五百尺】與小圎角同

截大分【六億○六百三十七萬五千】爲大圎角之六倍

相並得【六億四千○○六萬二千五百尺】爲撱圎全積與撱圎眞積相較其差更甚

如是輾轉推求則知撱體大截分不可算今別立法凡撱體皆先如法求其全積再如法求其小分截積以小分截積減全積余爲大分截積此法無可存

歷算全書卷五十六

幾何補編自序

天學初函內有幾何原本六卷止於測面其七卷以後未經譯出蓋利氏旣歾徐李云亡遂無有任此者耳然曆書中往往有雜引之處讀者或未之詳也壬申春月偶見館童屈爲燈詫其爲有法之形【其制以六圈成一燈每圈勻爲六折並周天六十度之通故知其爲有法之形而可以求其比例然測量諸書皆未言及】乃覆取測量全義量體諸率實攷其作法根源【法皆自楞剖至心卽皆成錐體以求其分積則總積可知】以補原書之未備而原書二十等面體之算向固疑其有誤者今乃徴其實數【測量全義設二十等面體之邊一百則其容積五十二萬三八○九今以法求之得容積二百一十八萬一八二八相差四倍】又幾何原本理分中末綫亦得其用法【幾何原本理分中末綫但有求作之法而莫知所用今依法求得十二等面及二十等面之體積因得其各體中稜綫及輳心對角諸綫之比例乂兩體互相容及兩體與立方立圓諸體相容各比例並以理分中末綫爲法乃知此綫原非徒設】則西人之術固了不異人意也爰命之曰幾何補編

欽定四庫全書

歷算全書卷五十七

宣城梅文鼎撰

防何補編卷一

四等面形算法

先算平三角形平三角形

三邊同者求中得中長綫

【乙甲】其三之一卽內容平圓

半徑【心甲】其三之二卽外切

圓之半徑【乙心或心丙】

又法以邊半之【丙甲】自乘得數【丙庚方】取其三之一開方【甲壬小方】得容圓之半徑【壬癸或甲癸俱與心甲等】又取自乘數【丙庚方】三分加一【丙庚方加壬甲小方】並而開方得外切圓之半徑【丙心】

論曰三邊角等則半邊之角六十度【丙心甲角】其餘角三十度【心丙甲角】內容圓半徑爲三十度之正【心甲】外切圓半徑如全數【丙心】其比例爲一與二故內容圓半徑【心甲】正得外切圓半徑【丙心】之半也【此論可解前一條】

形內丙心甲與乙心丁兩小句股形相等又並與乙甲丙大句股形相似【何則乙角丙角並分原等角之半丁甲等爲正角則三角皆等而邊之比例等】而大形之句【丙甲】旣爲其【乙丙】之半則小形之句【心丁亦卽心甲】自必各爲其【心乙亦卽心丙】之半故知心甲【原同心丁】爲乙甲之半也

心甲旣爲心丙之半則心甲一心丙必二而丙戊必三矣【乙甲同】何也以乙心與丙心同爲二心甲與心戊同爲一也聯心乙二與心甲一豈不成三

今以內圓半徑爲股【心甲】外圓半徑爲【心丙】三邊之半爲句【丙甲】成心甲丙句股形則心丙自乘內【冪】有心甲【股冪】及甲丙【句冪】兩自乘之積也而心甲股與心丙旣爲一與二之比例則心甲之冪一心丙之冪必四也以心甲股冪一減心丙冪四其餘積三卽丙甲句冪矣故心甲之冪一則丙甲之冪三心丙之冪四今先得邊故以丙甲三爲主而取其三之一爲心甲股冪又於丙甲三加三之一爲四卽成心丙冪也【此論可解後一條】

以上俱明三等邊平面之比例

今作四面等體求其心

法自乙頂向子向甲剖切之成乙子甲三角面

心者面之心中者體之心

前圖所謂心者面之心也今

所求者體之心卽後圖所謂

中也故必以剖而後見

次求甲醜綫

乙子邊平分於醜從醜向甲

得垂綫此醜甲垂綫在體中

必小於乙甲在外之垂綫故

乙甲如丑甲如股乙丑如句也法以甲乙自乘內減乙丑句冪余爲股冪開方得醜甲

又法凖前論乙丑之冪三【卽丙甲皆半邊故】則乙甲之冪九【乙甲三倍大於心甲故心甲冪一則乙甲冪九】以三減九餘六亦卽甲醜股冪矣以開方得甲醜

捷法倍原半邊【甲丙】自乘數以開方得【甲乙】中垂綫或半原邊【丙己】自乘之數開方亦得【甲醜】丙甲之冪三【乙丑同】則甲醜之冪六而丙己之冪十二也【甲醜與丙己冪積之比例爲一與二】次求心中綫

捷法但半心甲自乘卽心中冪

論曰心甲與心中猶甲醜與乙丑也甲丑冪與乙丑冪爲六與三則心甲與心中之冪亦如二與一

又捷法心中之冪一心甲之冪二則乙丑之冪六【卽丙甲】而心丙之冪八【亦卽乙心】俱倍數

但以半邊【乙丑或丙甲】之冪取六之一卽心中冪開方得心中卽四等面形內容小渾圓之半徑也【心中綫者卽各面之心至體心也故爲內容小渾圓半徑】

以心中之冪一【句】加乙心之冪八【股】並之爲冪九開方得中乙【或中子或用前總圖則爲甲丙爲甲己並同】是卽四等面形外切渾圓之半徑也外切圓之冪九【中乙】內切圓之冪一【心中】得其根之比例爲三與一故四等面形內容渾圓之徑一則其外切渾圓之徑三又捷法但以乙丑半邊之冪加五【卽二之一】爲中乙【或中子等】冪開方得外切圓之半徑【蓋乙丑之冪六中乙之冪九其比例爲一有半也】

此四邊不等形【又爲三角立錐形】爲

四等面形四之一各自中切

至邊綫成此形其底三邊等

卽四等面形之一面其髙爲中心卽內容小渾圓之半徑其中乙等三楞綫三倍大於中心之髙卽外切渾圓之半徑

取四等面形全積捷法

先取面冪【卽前圖乙己丙平面依前比例求其冪】以內容圓半徑【心中】乘之得數四因三歸見積

法曰丙甲半邊之冪三則甲乙中長之冪九開方得中長【乙甲】以乘丙甲得乙己丙三等邊之冪積卽四等面形之一面也

次求本積四之一【卽各面輳心剖裂之形如右圖】

丙申半邊之冪六則中心之冪一開方得中心髙以乘所得面冪而三分取其一卽爲四等面形四之一於是四乘之卽爲全積也

又防法以丙甲乘心甲又以中心乘之卽得本形四之一【卽同三除以心甲爲乙甲三之一故也】

此帶縱小立方形與右圖四等面形四之一等積

又防法以丙己全邊【亦卽丙乙】乘

乙心再以中心乘卽得本形

全積【乙心爲心甲之倍數丙己爲丙甲之倍數用以】

【相乘則得丙甲乘心甲之四倍數也】

邊設一百

依上法求容

丙己邊一百其冪一萬丙甲半邊五

十其冪二千五百三因之得七千五百

爲乙甲中垂之冪【丙甲股冪減丙己冪得句冪也丙己亦卽丙乙】平方開之得八十六【六○二五】爲乙甲其三之一得二十八【八六七五】爲心甲其三之二得五十七【七三五○】爲心乙又置丙甲冪二千五百取六之一爲心中冪得四百一十六六六不盡開方得心中之髙二十零四一二四亦卽內容渾圓之半徑

依上法以丙己全邊一百乘乙心五十七【七三五○】得五千七百七十三半又以心中二十零【四一二四】乘之得全積一十一萬七千八百五十一弱【與曆書微不同】

四等面體求心捷法

準前論心中冪一則心甲冪

二中乙冪九乙丑冪六以句

股法考之則中甲與中醜之冪俱三也

何也心中甲句股形以中甲爲故心中句冪一心甲股冪二並之爲中甲冪三也而乙中丑句股形以中醜爲句故乙中冪九內減乙丑股冪六其餘爲中醜句冪亦三也

由是徴之則中醜與中甲正相等但如法求得甲醜綫折半得中防卽爲體心

又捷法取乙丑冪【卽原設邊折半自乘】半之爲中丑冪開方得中醜亦得甲中【或乙子全邊自乘取八之一爲甲中冪亦同】

中醜卽原邊乙子距體心之度甲中卽原邊丙己距體心之度而中爲體心

想甲防在丙己邊折半之處今從側立觀之則綫化爲防

而丙己與甲成一防故從丙

己原邊依楞直剖至乙子對

邊卽成甲醜綫其綫卽所剖

面之側立形

此圖卽前圖甲醜綫所切之

面蓋面側視則成綫矣

原設四等面全形今依子丑

乙楞剖至甲則成縱剖圖故

甲防內有丙己綫若依丙甲

己楞剖至醜則成橫剖圖故

丑防內有子乙也

縱剖有三依子乙楞剖至甲而平分丙己邊於甲一也依丙乙楞剖而平分子巳邊二也依己乙楞剖而平分子丙邊三也

橫剖亦三依丙己楞剖至醜而平分子乙邊於丑一也依子丙邊剖而平分乙己邊二也依子巳楞邊剖而平分丙乙邊三也其所剖之面並相似皆以中防爲三對角垂綫相交之心

一率一一七八五一

例容

二率一○○○○○○

例邊之立方積

三率一○○○○○○

設容

四率八四八五二九○

設邊之立方積

開方得根二百○四弱爲公積一百萬之四等面體楞與比例規解合

若商四數則其平廉積四十八萬長廉積九千六百其隅積六十四共得四十八萬九千六百六十四不足四千三百七十四爲少百分之一弱故比例規解竟取整數也

計開

四等面諸數

邊一百

積一十一萬七八五一

積一百萬

邊二百○三九六

內容渾圓半徑二十○【四一二四】

內容渾圓全徑四十○【八二四八】

外切渾圓半徑六十一【二一○○】

外切渾圓全徑一百念二【四二○○】

互剖求心之圖

設邊一百其冪一萬【丙己乙子乙丙

乙己子丙子己並同爲外切渾圓徑冪三之二】半邊五十其冪二千五百【丙甲

甲己乙丑丑子等並同爲邊冪四之一】

斜垂綫之冪七千五百【乙心甲子

角甲丙亢醜己氐丑並同爲邊冪四之三】

其根八十六六○二五

斜垂綫三之一二十八八六

七五其冪八百三十三三三

【卽外切渾圓徑冪十八之一爲邊冪十二之一】卽各

面內容平圓半徑【心甲角甲亢醜氐醜並同】

斜垂綫三之二五十七七三五○其冪三千三百三十三三三【乙心子角丙亢己氐並同】

內容渾圓半徑二十○四一二四其冪四百一十六六六不盡【爲邊冪二十四之一卽外切渾圓三十六之一】卽分體中髙【心中角中亢中氐中並同】若內圓全徑之冪則一千六百六十六六六【爲邊冪六之一外切渾圓徑冪九之一】

外切渾圓半徑六十一二三七二其冪三千七百五十卽分體之立面楞【乙中子中丙中己中並同】四因之爲渾圓全徑冪一萬五千其徑一百二十二四七四四

又外切正相容之立方其冪五千爲四等面邊冪之半卽斜方之比例又爲外切渾圓徑冪三之一

一率外切渾圓徑一百二十二四七四四

二率四等面之邊一百

三率渾圓徑一百

四率內容四等面邊八十一六四九六

又捷法渾圓徑冪一萬五千則內容四等面邊冪一萬或內容立方面之斜亦同爲渾圓徑冪三之二

若設渾圓徑一百其冪一萬則內容四等面邊之冪六千六百六十六六六亦三之二也

平方開之得八十一六四九六爲四等面邊卽內容立方之斜內容立方面冪三千三百三十三三三爲渾圓徑冪三之一卽方斜之半冪亦卽四等面邊冪之半平方開之得五十七七三五○是爲渾圓徑一百內容立方之邊亦卽渾圓內容立方立方又容小圓之徑若於四等面內又容渾圓則其徑冪一千一百一十一一一爲渾圓徑冪九之一爲四等面冪六之一立方面冪三之一

開得平方根三十三三三不盡【冪九之一則其根必三之一也】爲內容小渾圓之徑以徑乘冪得三萬七千○三十七爲徑上立方積以十一乘十四除得二萬九千一百○○半爲圓柱積柱積取三之二得一萬九千四百爲小渾圓積得大渾圓二十七之一以小渾圓積二十七因之得五十二萬三千九百爲四等面外切大渾圓積【卽徑一百之渾圓積也】

互剖求心法

凡四等面體任以一尖爲頂則其垂綫爲自尖至相對之平面心【亦卽平面容圓之心】而以餘三尖爲底其垂綫至底之防旁距三尖皆等【卽乙心丙心己心三綫之距心皆等而以子尖爲頂其垂綫爲子中心其底爲乙丙己平三角面餘仿此】此爲正形【各尖皆可爲頂其法並同】若以子中心垂綫爲軸而旋之則成圓角體

凡四等面體任平分一邊而平分之防爲頂以作垂綫則其垂綫自此防至對邊之平分防而以對邊爲底底無面但有邊底邊與頂邊相午直正如十字形假如以子乙邊平分於醜以綫綴而懸之則其垂綫至所對丙己邊之平分正中爲甲防其綫爲丑中甲而子乙邊衡扵上則丙己邊縱於下正如十字無左右之欹亦無髙下之微差也

若以丑中甲垂綫爲軸旋之則成圓柱體

凡四等面體以其邊爲斜綫而求其方以作立方則此立方能容四等面體

何以知之曰準前論以一邊衡於上而爲立方上一面之斜則其相對之一邊必縱於下而爲立方底面之斜

矣又此二邊之勢旣如十字

相午直而又分於上下爲立

方上下兩面之斜綫然則自

上面之各一端向底面之各一端聯爲直綫卽爲四等面之餘四邊亦卽立方餘四面之斜如此則四等面之六邊各爲立方形六面之斜綫而爲正相容之體如前所論圓角體圓柱體𨿽亦能容四等面形而垂綫皆小於圓徑故不得爲正相容

捷法四等面之邊自乘折半開方卽正相容之立方根【卽倍句股意】設邊一百其冪一萬折半五千卽爲立方一面之積求其立方根得七十○七一○六卽丑中甲垂綫之髙

若以此作容四等面之圓柱則其髙七十○七一○六同立方之方根而其圓徑一百同立方面之斜此圓柱內可函立方

其乙中子中等爲自四等面體心至各角之綫又爲立方心至各角之綫又爲外切渾圓之半徑又爲四等面分爲四體之楞綫又爲立方分爲六方錐之楞綫又捷法以四等面之邊冪加二分之一開方卽外切正相容之渾圓徑亦卽立方體內對角綫【如自乙至震】折半爲自心至角綫四等面設邊一百其冪一萬用捷法二分加一得一萬五千爲外切正相容之渾圓全徑冪開方得一百二十二四七四四爲渾圓全徑折半得六十一二三七二爲渾圓半徑

立方內容四等面圖

設立方邊一百其積百萬內

容四等面邊一百四十一【四二

一三】其積三十三萬三千三百

三十三【三三三三】爲立方積三之

一干坤震防立方【乾丙坤己乙防子震與中心之醜甲同髙】內容子乙丙己四等面爲立方積三之一

何以明之凡錐體爲同底同髙之柱體三之一今自立方之乙角依斜綫剖至丙巳成乙丙巳防三角錐以丙巳防立方之半底爲底又自子角斜剖至丙巳成子丙巳震錐以丙巳震立方之半底爲底合丙半底則與立方同底矣而子震與乙防之髙卽立方髙也是此二錐得立方三之一矣

又自子乙斜綫斜剖至巳角成倒錐以子乙坤立方之半頂爲底以坤巳立方髙爲髙又自子乙斜剖至丙角亦成倒卓之錐以子乙幹立方之半頂爲底以干丙立方髙爲髙與前二錐同亦三之一也

合此二錐共得立方三之二則其餘爲子乙丙巳四等面體者必立方三之一矣

準此論之凡同邊之八等面積四倍大於四等面積何以知之以此所剖之四錐體合之則爲八等面之半體皆以剖處爲面而其邊其面皆與四等面等是同邊之體也而八等面之半體旣倍大於四等面則其全體必四倍之矣

設八等面邊一百四十一【四二一三】與四等面同邊則八等面之積一百三十三萬三千三百三十三【三三不盡】爲四等面之四倍

若設四等面邊一百則其外切之立方面冪五十立方根七十○【七一○六】以根乘冪得立方積三十五萬三千五百五十三四等面積一十一萬七千八百五十一爲立方積三之一

推得八等面邊一百其積四十七萬一千四百○四此同邊之比例

若立方內容之八等面則其積爲立方內容之四等面二之一何以知之八等面與立方同髙則其積爲立方六之一故也

設立方邊一百內容八等面邊七十○【七一○六】其積一十六萬六千六百六十六爲四等面之半若設立方邊七十○【七一○六】則內容八等面積五萬八千九百二十五半其邊五十

四等面體又容小立方小立

方內又容小四等面體則內

容小立方徑爲外切立方三

之一內小四等面在小立方

內其徑亦爲四等面三之一

而其積皆二十七之一

何以知之凡三等邊平面之心皆居垂綫三之一假如子巳丙爲四等面之一面其平面之心必在癸而子甲垂綫分三之一爲癸甲其餘三面盡同而內容之小立方必以其下方之兩角縱切子巳丙之癸心及乙己丙之壬心其上方之兩防必橫切於子乙己之卯心及子乙丙之申心而立方內容之小四等面亦必以其四角同切此四防也今壬癸兩防旣下距丙己綫爲其各斜垂綫三之一而卯申兩防又上距子乙綫之斜垂綫亦三之一則其中所餘三之一必爲立方所居也而內小立方不得不爲子乙與丙己相距綫三之一矣

問癸防爲三之一者斜面之垂綫也小立方者直立綫也何以得同爲三之一乎答曰癸防所居三之一𨿽在斜面而子乙縱綫與丙己橫綫上下相距必有垂綫直立於其心此直立垂綫卽前圖之甲醜與外切立方綫同髙者也醜甲中垂綫以上停三之一之上防與卯申平對以下停三之一之下防與壬癸平對依句股法與股比例同也然則醜甲綫之中停卽小立方之所居矣

又醜甲者卽外切立方之髙也故知小立方徑爲外切立方徑三之一

又小四等面在小立方內以其邊爲小立方之斜而縱橫邊相午對如十字其中心亦以醜甲綫之中停爲其軸其斜面之勢一切皆與大四等面同而醜甲者亦大四等面之軸也小四等面之中軸旣爲醜甲三之一其餘一切皆三之一矣

夫體積生於邊者也邊爲三之一者面必爲九之一體必爲二十七之一無疑也

準此論之渾圓在四等面內者亦必爲外切渾圓二十七之一其徑亦三之一也何也渾圓之切防與小立方小四等面之切防並同也

以此推知小立方與小四等面在大四等面內或居小渾圓內以居大四等面內其徑積並同

求體積

渾圓徑一百其徑上立方一百萬依立圓法以十一乘十四除得七十八萬五千七百一十四爲圓柱積仍三分取二得五十二萬三千八百○九爲渾圓積

內容立方面冪三千三百三十三【三三】其邊五十七【七三五○】以邊爲髙乘面得一十九萬二千四百五十○爲內容立方積

內容四等面體邊冪六千六百六十六【六六】其邊八十一【六四九六】

依前論四等面體爲立方三之一得六萬四千一百五十○爲四等面積

立方內容小渾圓以立方之邊爲徑五十七【七三五○】依立圓法以立方積十一乘十四除得一十五萬一千二百一十爲圓柱積取三之二得一十○萬○八百六十六爲小立圓積

四等面內容小渾圓徑冪一千一百一十一【一一】其徑三十三【三三】以徑乘冪得徑上立方積三萬七千○三十七以十一乘十四除得二萬九千一百○半爲圓柱積又三分取一得一萬九千四百爲立方內之四等面內容小渾圓積爲大渾圓積二十七之一若先有內小渾圓積但以二十七因之得大渾圓積

依此論之凡渾圓內容立方立方內又容四等面體四等面內又容小渾圓其內外相似之大小二體皆二十七之比例也

又捷法用方斜比例

立方面之斜設一百其冪一萬則其方冪五千用三

因之得一萬五千開方得立

方對角斜綫卽爲外切渾圓

全徑

立方面之斜一百卽立方內容四等面之邊

立方體對角斜綫一百二十二【四七四四】卽立方外切渾圓之全徑亦卽四等面外切渾圓全徑半之得六十一【二三七三】卽立方外切渾圓半徑亦卽立方體心至各角之綫亦卽四等面體心至各角之綫

八等面形圖注

第一合形

甲丁甲丙甲己甲戊

丁丙丙己己戊戊丁

戊乙己乙丁乙丙乙

以上形外之楞凡十有二卽根

數也其長皆等

或設一百爲一楞之數則十二楞皆一百也

甲丁戊甲戊己甲己丙甲丙丁丙丁乙己丙乙戊己乙丁戊乙

以上形周之分面凡八皆等邊平三角形也其容積其邊皆等

或設一百爲邊數則三邊皆一百而形周之分面八皆三邊邊皆一百也

第二橫切形【二】

甲丁丙己戊爲上半俯形

丁丙己戊乙爲下半仰形

右二形各得合形之半皆從

丁戊楞橫剖至己丙

一俯一仰皆方錐扁形丁丙

己戊爲方錐之底其邊皆等

其從四角湊至頂之楞皆與

底之邊等

第三直切形【四】

從甲尖依前後楞直剖過丁

己至乙尖成左右兩形

從甲尖依左右楞直剖過丙

戊至乙尖成前後兩形

此四形者一切皆與仰俯二

形同但彼爲眠坐之體故爲

方錐【仰者卽倒卓方錐】而此則立體卽如打倒方錐之形也第四橫切之面一直切之面二

因橫剖得正方平面在立方錐以此

爲底倒方錐以此爲面在合形則爲

腰圍其己丁及丙戊兩對角斜綫相

交於心卽兩直切之界也【心卽合形中心】因直剖得斜立方面二其己丁及戊

丙橫對角綫卽橫切之界其從甲至

乙垂綫卽直剖之界如立面在前後

互剖之形則此綫爲左右直剖之界

彼此互爲之也亦卽爲全形之中髙

徑綫

以此知八等面之中髙綫爲方斜之

比例

第五分形

因橫剖及兩直剖分總形爲八皆

三角錐形也

皆以等邊平三角形面爲錐形之

底而以橫直剖綫相交處之點爲

其銳頂卽合形之中心也

其自頂心至角之楞皆等皆邊綫

之方斜比例也【底綫爲方則此綫爲其斜之半】而

此楞綫又卽爲八等面形之外切

圓之半徑

設己戊邊一百其冪一萬則心戊

楞之冪五千【倍戊庚半邊之冪爲半斜冪也】戊心之冪五千內減戊庚冪二千

五百則其餘二千五百爲心庚之

冪故心庚必與戊庚等

從心頂對己庚楞直剖至庚分形爲兩則其中剖處成三角平面

己庚者乙己戊等邊三角平面之

中垂綫也其冪爲邊四之三設邊

一百之冪一萬則己庚之冪七千

五百

庚辛者平面三角容圓之半徑也得己庚三之一其冪則九之一也己庚之冪七千五百則庚辛之冪八百三十三【三三】辛防卽各三角平面之中心

以庚辛冪八百三十三【三三】減心庚冪二千五百得心辛冪一千六百六十六開方爲心辛卽分形之中髙也求得分形中髙四十○【八二四七】

依平面三等邊法設邊一百其中長綫八十六【六○二五】其冪積得四千三百三十○【一二五○】取平冪三之一得一千四百四十三【三七五○】以乘中髙得分形積五萬八千九百二十五【三五一三】再以八因之得總積四十七萬一千四百○二【八一○四】與總算合

設八等面之邊一百其冪一○○○○卽橫剖中腰之正方半之爲每角輳心之綫之冪得○五○○○此綫卽分形自底角輳頂心之楞【如心戊心己心乙】又爲八等面形外切渾圓之半徑又半之爲分形每面自頂至邊斜垂綫之冪【卽心庚】得○二五○○此綫卽設邊之半其冪爲設邊四之一

設半邊之冪取其三之二爲分形中髙綫之冪【卽心辛】得○一六六六不盡又爲八等面形內容渾圓之半徑防法取八等面設邊之冪六而一爲八分體中髙之冪開方得中髙

假如設邊一百其冪一萬則分體中髙之冪一千六百六十六不盡求其根得四十○【八二四八】以中髙乘三角平面冪三除之得分體八因之得全積

又捷法八等面設邊之冪取三之二爲體內容渾圓之徑冪開方得內容渾圓徑折半爲八分體中髙

假如設邊一百其冪一萬則內容渾圓之徑冪六千六百六十六不盡求其根得八十一【六四九六】折半爲分體中髙

或竟以內容渾圓全徑乘設面三角平冪四因三除之得全積

又捷法此方斜之比例

八等面設邊之冪倍之爲體外切圓徑冪開方得徑以乘設邊之冪【卽腰廣平方】得數三歸見積

假如設邊一百其冪一萬其斜如之冪倍方冪得二萬求其根得一百四十一【四二一三】以乘腰廣一萬得一百四十一萬四千二百一十三三除之得總積四十七萬一千四百○四

一系八等面體之邊上冪與其外切渾圓之徑上冪

其比例爲一與二【方斜比例】

一系八等面體之邊上冪與其內容渾圓之徑上冪

其比例爲三與二

一系八等面體外切渾圓之徑上冪與其內容渾圓之徑上冪其比例爲三與一

準此而知八等面內容渾圓渾圓內又容八等面其渾圓外切之八等面邊或徑上冪與內容之八等面邊或徑上冪其比例亦必爲三與一也

計開

八等面形諸數

設邊一百其積四十七萬一四○四【與曆書所差甚微】其體外切渾圓之徑一百四十一【內外兩渾圓之徑冪爲三與一其根約爲四與七而彊】體內容渾圓之八十一

八等面外切立方徑一百四十一【方斜比例也與外切渾圓同】八等面內容立方徑四十七

內外切大小立方之徑之比例爲三與一

內外兩立方之積之比例爲二十七與一

若渾圓內容立方立方內容八等面體八等面體內又容渾圓則大小兩渾圓之徑亦若三與一其積亦若二十七與一

一率

四七一四○四

例容

二率

一○○○○○○例邊之立方

三率

一○○○○○○設積

四率

二一二一三二二設邊之立積

開立方得根一百二十八爲公積一百萬之八等面根【與比例規解合】

防何補編卷二

二十等面形自腰切之成十等邊平面

先求甲丁乃十等邊平面

從心對角之綫亦卽二十

分形各三角立體一面之中

垂斜綫

法爲甲乙【卽切形十等邊之半在原設二十等面形邊爲四之一】與甲丁若十八度之正與全數也【十等邊各三十六度其半十八度】

設邊一百所切十等邊平面之邊五十其半甲乙二十五

一率十八度正○三○九○

二率全數

一○○○○

三率甲乙

二五

四率甲丁

八○【九○六一】

用等邊三角求容圓法

設邊一百其內容圓半徑二十八【八六七五】爲心甲

以心甲爲句二十八【八六七五】其冪八百三十三【三三二五】以甲丁爲八十○【九○六一】其冪六千五百四十五【七九七○】

句冪減冪餘五千七百一十二【四六四五】爲心丁股冪開方得心丁七十五【五八○八】此卽各面切形自各面之心至切體尖之髙也其切體之尖卽原設二十等面總形之體心爲丁點

用後法得乙己丙平面冪積四千三百三十○【一二五○】又依三等邊角形設邊一百【丙己】其半五十【丙甲】求到乙甲中長八十六【六○二五】用其三之一卽心甲二十八【八六七五】以與丙甲五十相乘得一千四百四十三【三七五○】爲各等面平積三之一【三因之得平面冪】

又以丁心七十五【五八○八】乘之得一十○萬九千○九十一【四三七二】爲二十等面形分切每面至心之積又以二十乘之得全積

依上法求到二十等面全積

設邊一百其積二百一十八萬一千八百二十八【查比例規解差不多惟測量全義差逺】

按此法以本形分爲二十各成三角立錐形而各以分形之髙乘底取三之一以爲分形積然後以等面二十爲法乘而並之得總積可謂的確不易矣然與曆書中比例規解及測量全義俱不合何耶

計開

二十等面形

設邊一百其每面中長綫八十六【六○二五】

其每面冪積四千三百三十○【一二五○】

其每面容平圓之心作綫至形心之丁七十五【五八○八】卽心丁心丁卽內容渾圓之半徑

其分形各以每面之冪積爲底心丁爲髙各得三角立錐積一十萬九千○九十一【四三七二】

其立錐積凡二十合之得總積二百一十八萬一千八百二十八

用上法求形內容渾圓

其心丁七十五【五八○八】卽內容渾圓半徑【以心丁綫與各平面作垂綫而丁防卽體心故】倍之得一百五十一【一六一六】爲內容渾圓全徑置小渾圓徑一百五十一零自乘得二萬二千八百○一以十一乘十四除得一萬七千九百一十五爲圓冪置內容渾圓之平圓冪一七九一五以圓徑一百五十一取三之二得一百彊以乘平圓冪得一百八十○萬二千二百四十九爲二十等面內容渾圓之積

置內容圓徑一百五十一自乘得【二萬二千八百○一】再乘【三百四十四萬二千九百五十一】以立員捷法【○五二三五九八七七】乘之得渾圓積一百八十○萬二千七百二十五

先用宻率【十四除十一乘】得渾圓一百八十萬二千二百四十九以較立圓捷法所得少尾數四百七十六約爲一萬

八千之五弱不足爲差也

依立圓法以圓率三一四一五九二乘立圓法六而一得五十二萬三五九八爲徑一百之渾圓積

依法求得立方邊五十七【七三五○】立方積一十九萬二四五○四等面積六萬四千一百五十○並合前算小渾積一○○七六六若用捷法以渾圓率五二三五九八乘立方積得數後去末六位亦得一十○萬○七六六

內容渾圓尙且如此之大況二十等面之形又大於內圓乎然則曆書之率其非確數明矣

二十等面

一率

二一八一八二八

例容

二率

一○○○○○○

例根一百之體積三率

一○○○○○○

設容

四率

○四五八三三二

所求根立積

如法算得二十等面之容一百萬其根七十七

比例規解作七十六尙差不多測量全義云二十等邊設一百其容五二三八○九則大相懸絕矣久知其誤今乃得其確算己未年所定之率以兩書酌而爲之究竟不是今乃得之可見學問必欲求根也

二十等面分體之圖

亥子戌爲二十等面之一面

亦卽各分體之底

亥子子戍戍亥皆其邊卽根

也半之爲亥甲

甲乙丙爲橫邊切處卽橫切成十等邊形之一邊丁爲體心亦卽切十等邊平面之中心

甲乙丙丁卽橫切十等邊平面之分形心爲二十等面每面之正中心丁爲體周各平面至體心之垂綫亦卽分體之中髙亦卽體內容渾圓之半徑丁亥丁子丁戌皆分體之楞綫乃自各分面角輳體心之稜也亦卽爲外切渾圓之半徑丁甲丁丙皆橫切平面各角輳心之綫亦卽分體各斜面之中垂斜綫也

求法以丁甲爲股亥甲爲句【卽根之半】兩冪相並開方得卽丁亥也【丁子丁戌同】

求二十等面外切渾圓之半徑

依句股法以丁甲股八十○【九○六一】自乘冪六千五百四十五【七九七○】亥甲句五十○自乘冪二千五百相並爲亥丁冪九千○四十五【七九七○】平方開之得亥丁九十五【一○五二】爲外切渾圓半徑亦卽二十分形自其各角輳心之稜倍之得一百九十○【二一○四】卽外切渾圓全徑

計開二十等面體諸數

設邊一百其容二百一十八萬一千八百二十八其內容渾圓徑一百五十一其外切渾圓一百九十其每面中心至體心七十五半【卽內容渾圓之半徑】

其每面各角至體心九十五【卽外切渾圓之半徑】

計開二十等面體諸用數

設邊一百外切立方之半徑八十○【九○一七】爲體心至邊之半徑【卽寅中卯中辰中等】

倍之爲邊至邊一百六十一【八○三四】卽外切立方全徑外切渾圓之半徑九十五【一○五六】爲體心至各角尖之半徑【卽甲中戊中心中等】

倍之爲角尖至角尖一百九十○【二一一二】卽外切渾圓全徑

內容渾圓及內容十二等面之半徑七十五【五七六一】爲體心至各面之半徑【卽己中庚中等】

倍之爲內容渾圓全徑一百五十一【一五二二】爲面至面內容十二等面之邊五十三【九三四四】

每面之冪四千三百三十○【一二五○】

二十等面之冪共八萬六千六百○二半

分體積一十○萬九千○八十四【六五】爲二十等面體積二十之一

合之得全積二百一十八萬一千六百九十三

內容小立方之邊八十七【二六以內容立圓徑自乘七七乏冪取三之一開方得之】

內容燈體邊五十【卽原邊之半】

立方內容二十等邊算法

亢卯寅房爲立方全徑一百

中寅中卯爲半徑五十

寅卯二點爲二十等面邊折

半之界

寅卯綫爲二十等面邊之半

中爲體之中心寅中卯角爲三十六度

中寅半徑當理分中末之全數寅卯卽理分中末之大分

甲戊戊心心甲皆寅卯之倍數卽

二十等面之邊其數六十一【八○三三九八】

甲辰半邊三十○【九○一六六九與寅卯同】

心辰垂綫五十三【五二三三】半垂綫心箕二十六【七六一六】甲辰冪九百五十四【九一五○】三因甲辰冪爲心辰冪二千八百六十四【七四五○不盡】

計開

立方徑設一百半徑五十

理分中末綫大分六十一【八○三三九八】卽二十等面之邊論曰以中寅半徑五十求寅卯正得理分中末大分之半而甲戊邊原倍於寅卯寅房全徑亦倍於寅中是全數與大分皆倍也故徑以全數當寅房全徑以理分中末之大分當甲戊等二十等邊之全邊也

又立方邊設一百【卽寅房徑】半之五十【卽中寅】

內容二十等面之邊六十一【八○三三九八卽甲戊等】

面之中垂綫五十三【五二三三卽心辰】

中垂綫之半二十六【七六一六卽心箕】

面之冪一千六百五十三【九五七八甲戊心面】

中垂綫三之一得一十七【八四一一卽心己】

內容立圓半徑四十六【七○八六卽己中】全徑九十三【四一七二】二十等面全積五十一萬五千○二十六【九五九七】

約法

立方根與所容二十等面之邊若全數與理分中末之大分面冪三之一以乘容圓全徑得數十之爲全積中垂綫三之一心己爲句【卽平面容員半徑】自乘得句冪三百一十八【三○四八四九】以減中寅冪二千五百○○余己中股冪二千一百八十一【六九五一五一】開方得己中根四十六【七○八六】

二十等面邊設一百用理分中末綫求其外切之立方一率二十等面邊六十一【八○三三九八】

二率外切立方一百○○

三率二十等面邊一百○○

四率外切立方一百六十一【八○三四】

依法求得二十等面邊一百其外切立方一百六十一【八○三四】與先所細算合

半圓內容正方

法以圓徑爲三率【丙丁】理分中末之小分爲二率【庚辛】理分中末全綫加小分爲首率【丁辛爲全綫再加庚辛爲小分共得爲丁庚總綫也】二三相乘一率除之得四率【丙乙卽甲丁】爲全徑之小

分以減全徑余【乙丁】乃於乙作

正十字綫至圓界【如己乙】卽以

此綫自乘作正方【己甲】如所求

論曰己乙卽丙乙與乙丁之中率而丙乙旣爲乙丁全徑之小分則己乙卽大分也而甲乙亦爲大分甲丁亦爲小分矣若自甲作甲戊必與己乙甲乙等而其形正方

半渾圓內容立方

法以乙甲圓徑自乘之冪取其六之一開方得容方根【丙丁方丙戊邊】

論曰試倍甲丙乙庚半渾圓爲全渾圓體亦倍丙丁正方形作丙己長立方形亦必能容矣然則丙己綫在長

立方形之內爲斜綫者亦卽

渾圓之徑也【與甲乙徑等】

試於長立方面作戊己斜

則己壬爲之句戊壬爲之股

而戊己冪內有己壬冪與

戊壬冪矣

而丙己綫爲則戊己又爲

股丙戊又爲句而丙己自冪內又兼有戊己冪及丙戊冪矣【丙戊亦卽己壬】

又戊壬爲己壬【卽丙戊亦卽戊癸】之四倍則戊壬股冪內有己壬句冪四合之爲戊己冪則戊己冪內有己壬冪五矣

而丙己冪內復兼有戊己股冪及丙戊句冪是丙己冪內有丙戊冪六也丙己旣同圓徑則取其冪六之一開方必丙戊容方邊矣

立方內容十二等面其內又容立方【此相容比例】

立圓內容十二等面其內又

容立方此立方之面冪爲外

圓徑上面冪三之一而立方

之各角卽同十二等面角以切於立圓之面

法以外切渾圓徑上冪取三之一爲十二等面內小立方冪平方開之得小立方根根乘冪見積

又簡法以十二等面之面冪求其橫剖之大綫此綫卽

十二等面內容小方之邊

如圖作甲乙綫剖一面爲二

此綫在面中最大卽爲內小

立方根以此自乘而三之卽

小立方外切渾圓徑冪

凡立方內容二十等面二十等面內又容渾圓圓內又容小立方此小立方之各角能同渾圓之切點以切於二十等面之平面心

法以內容渾圓徑之冪取三

之一爲內小立方之冪平方

開之得切點相距卽小立方

根以根乘冪見積

簡法取內容渾圓之內小立方邊求其理分中末之大分爲內容十二等面邊

又簡法如前求得二十等面內容十二等面之一面乃求其橫剖之大綫卽二十等面內容小立方之根以根自乘而三之卽二十等面內容渾圓之徑冪開方得根卽內容渾圓徑折半爲分體之中髙

此二十等面之面作三分之

一橫剖

此十二等面之面在二十等

面內

此五等面邊卽前橫綫所成

凡五等邊平面其邊卽七十二度之通橫剖大綫卽一百四十四度之通各折半爲正可以徑求一率

三十六度正

二率

七十二度正

三率

五等邊之一邊

四率

橫剖之大綫

凡十二等面體與二十等面體可互相容而不窮十二等面體有二十尖二十等面體有十二尖其各尖之相距必均其互相容也皆能以其在內之尖切在外各面之中心而徧

凡二十等面內容立圓仍可以容二十等面

二十等面內容立圓仍可以容十二等面

甲心乙乙心丙丙心丁

丁心戊戊心甲皆二十

等面之一面其各三邊皆等

各以庚辛壬癸己爲其面之

心若內容十二等面體則十二等面之各尖必切於庚辛壬癸己等心點

今求內容十二等面之邊則必以庚辛等心點聮爲直綫卽成五等邊面之邊而與十二等面之形相似而可

以相容矣

法當以邊【如甲戊】半之【如甲辰】作

對心垂綫【如辰心】成心辰甲句

股形旣得己卯倍之爲己庚卽內容十二等面之一邊二十等面體內容十二等面之圖

第一圖原形如五面扁錐心

尖鋭起甲心戊等三等邊平

面凡五共輳而成一心尖乃

二十等面四之一

其己庚辛壬癸五點皆三等邊平面之中心亦卽內容十二等面之稜尖所切故必先求此點

簡法曰以甲戊邊半之於辰作辰心對角斜垂綫又以心甲心戊各取三分之二爲心子心丑乃聮子丑爲綫與甲戊邊平行與辰心垂綫十字交於己點則己點卽甲心戊平面之心再從子至午作與邊平行綫綫之半卽庚點餘三面盡如此作平行綫則辛點在午未綫壬點在未酉綫癸點在酉丑綫但半之皆得心矣

第二圖剖形是五等邊平面

因前圖所作子丑等平行綫

橫剖之去其中髙之尖成子

午未酉丑五等邊平面此平

面之心點在前圖心頂之內

惟子丑等邊綫是原形所作平行綫在體外可見餘皆以剖而成乃從各角作綫至心如子心等分形爲五皆平面三角形而心子等綫皆小於子丑邊因子己原邊及子心醜角求得心己垂綫及子心對角綫

第三圖正用之形卽內容十二等面之一面

因前第二圖各平分其邊得

己庚辛壬癸五點卽原形之

平面心又聮此點作己庚等

直綫則成此形以此形爲內容十二等面之一面則己庚等五點爲十二等面之鋭角而皆切二十等靣之平面心矣

求己庚綫法因心子對角綫及心己垂綫子己原半邊得己卯倍之爲己庚

第一圖

設二十等面邊一百甲戊等五邊甲心等五輳頂綫並同則子心六十六【六六】子丑平行綫同皆爲原邊三之二心己斜垂綫五十七【七三五○】爲心辰斜垂綫三之二

以上用第一圖乃斜立面也

第二圖

子己半邊三十三【三三】子心對角綫五十六【七○九九】己心垂綫四十五【八七九二】

法爲全數與五十四度之割綫【一七○一三○】若子己邊與子心也子己乘割綫以全數十萬而一得子心

又全數與五十四之切綫【一三七六三八】若子己邊與己心也子己乘切綫以全數十萬而一得己心凡全數除降五位

第三圖仍從第二圖生

己庚等兩平面心相距綫五十三【五八一六】其半己卯二十六【七九○八】

法爲子心對角綫與己子半邊若己垂綫與己卯也倍己卯得己庚

求得二十等面邊一百內容十二等面其邊五十三【五八一六】

防法但用法聮兩平面之中心點卽爲內容十二等面之邊兩平面心相聮爲直綫之圖

乙心甲及戊心甲兩等邊平

三角面以甲心邊爲同用之

邊而甲心隆起如屋之山

兩平面之中心爲己爲庚聮

爲己庚綫與甲心爲十字然

不相切何也甲心旣隆起

則甲心折半之卯在己庚折

半之栁點上其距爲卯栁

試側視之則甲心戊面變爲

戊卯綫甲心乙面變爲卯乙

綫而甲卯心綫變爲卯點己

庚點在平面原近甲心點爲

卯戊卯乙三之一則卯栁之距亦爲垂綫三之一矣二十等面從腰橫剖之圖

凡二十等面體其面之邊皆

等而皆斜交故邊皆髙於面

面之中心如己如庚是距體

心最近之處故爲內容渾圓

及十二等面所切之點也

邊之兩端又髙於其折半之處邊所輳爲尖如甲如戊如乙如心等是距體心最逺之處故爲外切渾圓及外切十二等面之尖也其各邊折半之點如寅如卯其距體心在近逺酌中爲外切立方之半徑其內切之己庚外切之甲戊乙心等賴寅卯距心之綫爲用然後可知故其用最要

橫剖所成之面【十二等面從腰橫剖其根亦同】

問各邊旣髙於面而又斜交

何以能橫切成平面乎曰從

右圖觀之甲戊尖最髙則其

所對之乙心等邊似平矣而

乙心等尖亦髙則其所對之甲戊等邊又平一髙一平彼此相制而成相等之距故寅卯等折半之處其距體心皆等聯之爲綫卽成相等之綫而皆平行也

然則何以知其爲十等邊平面曰準右圖上下各五面其腰圍亦上下各五面而尖牙相錯成十面今各從其半邊剖之則必爲十邊平面無疑也

如圖奎卯寅十等邊平面以中爲心

中寅中卯皆原體心與其邊

折中處相距之半徑亦卽爲

外切立方之半徑也於前圖

作外切之奎角卯寅平圖則

寅卯等卽爲分圓綫乃全圈十分之一當三十六度理分中末綫圖

奎中爲全徑井中爲半徑以半

徑【設五十】爲句全徑【設一百】爲股

求其得一百一十一【八○三三】

【九八】爲井奎以井爲心中爲界作圓分如中斗截井奎綫於斗則井斗亦半徑也以井斗減井奎其餘斗奎卽爲理分中末綫之大分【亦卽奎牛】以奎牛爲度作點於倍徑之圈周而徧卽成十平分圈周之點聮其點爲綫卽成寅卯等十等邊故十等邊之寅卯等卽木圈半徑之理分中末大分也若奎中爲半徑則井中爲半半徑亦同

奎中全數【半徑】設一百寅卯必六十一【八○三三九八】卽半徑理分中末之大分【奎牛卽奎斗】

理分中末綫法以全數一百之冪一萬爲股冪其半五十之冪二千五百爲句冪並得一萬二千五百爲冪開方求其根得一百一十一【八○三三九八】以半數五十減之得六十一【八○三三九八】爲理分中末之大分卽三十六度之分圓綫也

半之爲十八度之正三○九○一六九九【八綫表作三○九○二】二十等面分體之圖

甲戊心爲二十等面之一面

其三邊等中爲體心

甲中戊中心中皆各面之鋭

角距體心之綫又爲體外切

渾圓及外切十二等面之半

徑

以甲戊心面爲底依甲中戊

中心中三綫剖至體心中成

三角錐體爲二十等面體二

十之一

錐體之底各以其三邊半之

於寅於辰於卯從此三點作

綫而體心之中點皆爲錐體各立面之斜垂綫如辰中卽爲甲中戊立面之斜垂綫寅中爲甲中心立面之斜垂綫卯中爲戊中心立面之斜垂綫並同

又聮寅卯辰三點爲寅卯卯辰辰寅三綫成寅卯辰小等邊平三角面以此爲底依寅中卯中辰中三斜垂綫剖至體心之中點成小三角錐體其積爲大三角錐四之一其寅卯等邊爲原邊二之一原設邊一百則寅卯五十

其己點爲三角面之中心【大小並同】己中卽分體之中髙【大小錐體同】是卽內容渾圓之半徑亦卽內容十二等面體各尖距其體中心之半徑

其辰中卯寅中卯卯中辰皆立三角面皆爲橫剖成十等邊平面之分形故寅卯與寅中之比例若理分中末綫之大分與其全數也

今求寅中綫【卽外切立方半徑卯中亦同】

一率理分中末之大分

六十一【八○三三九八】

二率全數

一百

三率寅卯【剖形十等邊之一卽原邊之半】

五十

四率寅中

八十○【九○一七】按寅中綫爲量體之主綫旣得此綫卽可以知余綫而此綫實生於理分中末綫幾何原本謂分中末綫爲用最廣蓋謂此也

次求己中【卽內容渾圓及十二等面之半徑】

甲戊原邊設一百半之於寅

作寅己垂綫至己心【乃平靣心】己寅二十八【八六七五】爲句其冪

八百三十三【三三三三】用防法

以邊冪一萬取十二之一得

之

寅中八十○【九○一七】爲其冪

六千五百四十五【○八五○】句冪減冪餘五千七百一

十一【七五一七】開方得股爲己中

七十五【五七六一】

訂定寅中綫

一率理分中未綫大分六十一【八○三三九八】

二率全數

一百

三率寅卯【剖形十等邊之一卽原邊之半】五十

四率寅中【卽外切立方之半徑】

八十○【九○一七】

訂定己中綫

甲戊邊原設一百【半之於寅作寅己綫】

己寅句二十八【八六七五】冪八百三十三【三三三三】

寅中八十○【九○一七】冪六千五百四十五【○八五○】己中股冪五千七百一十一【七五一七】根七十五【五七六一】末求己庚綫【兩平面心相聮卽內容十二等面之邊】

一率寅中八十○【九○一七】爲大

二率己中七十五【五七六一】爲大股

三率寅己二十八【八六七五】爲小

四率己星二十六【九六七二】爲小股

倍己星得五十三【九三四四】爲己庚

解曰中寅己大句股形與己寅星小句股形同用寅角則其比例等而爲相似之形故也

己庚等綫相聮成五等邊平靣圖

準前論甲心戊等三角平面

合二十面爲二十等面體則

甲心等邊綫皆髙於平面而邊

綫之端五相輳卽爲尖角【如心

點】依此推知甲乙丙丁戊點

皆必與他綫五相輳而成尖角矣

其己庚辛壬癸各點爲各平面之最中央在體爲最平之處故內容之渾圓及內容之十二等面各尖必切此點

今依前法求得己庚等點相聯爲直綫則凡五平面相輳爲尖必有各中央之點相聯爲綫而皆成五等邊平面形矣【此平面形正與心尖相應】依此推知甲乙丙丁戊各點皆能爲尖則其周圍相輳之五平面亦必各以其中央之點相聯爲綫而皆成五等邊平面形二十等面體以五邊綫相輳之尖凡十有二每一尖之周圍皆有五平面卽皆有中央之點相聯而成五等邊平面亦十有二如此而內容十二等平面體己成故曰但聯己庚二

點爲綫卽內容十二等面之邊也

求甲中綫【卽外切渾圓及十二等面之半徑心中戊中並同】

寅甲爲原邊之半設五十其

冪二千五百爲句冪

寅中爲外切立方半徑八十

○【九○一七】其冪六千五百四十

五【○八五○】爲股冪並句股冪九千○四十五【○八五○】平方開之得甲中

依法求得甲中九十五【一○六五】

求體積

設邊一百其半五十斜垂綫八十六【六○二五】相乘得面冪四千三百三十○【一二五○】

又以己中髙七十五【五七六一】乘面冪得柱積三十二萬七千二百五十三【九六○○】

三除之得分體積一十○萬九千○八十四【六五○○】以二十乘之得全積二百一十八萬一千六百九十三十二等面分體之圖

戊辛庚己壬五等邊形卽十二等面立體之一面亦卽分體形之底【乃五面立錐形之底】丙爲平面心

丙丁爲平面心至體心之垂綫亦卽分體形之中髙又爲體內切渾圓之半徑亦卽爲內切二十等面之半徑丁爲全體之中心又爲十二分體之上鋭卽五等面立錐形之頂

戊辛壬庚等皆各面之外周綫【卽邊也】爲體之稜亦名之

爲根

自分面之心丙作垂綫至邊

【如癸丙甲丙】分各邊爲兩其分處

爲癸爲甲【卽各邊折半處】

乃自癸至甲聮爲癸乙甲綫又自此綫向丁心平剖之成甲丁癸三角形面各分形俱如此切之成十等邊平面形故丁癸丁甲皆分體形自頂鋭至各邊之斜垂綫在所切之十等邊平面形卽爲自丁心至平面角之綫【甲癸等點在各邊爲折中在切形之平面則對角】

又自丁至體周各角之綫【如丁辛丁庚丁戊等】在分體卽爲自底角至頂鋭之稜又爲外切渾圓之半徑又爲外切二十等面之半徑

先算十二等面之面【卽戊辛庚己壬】

法爲全數與五十四度之切綫若甲辛與甲丙也以甲丙乘甲辛又五乘之得戊辛庚己壬五角面積【甲丙辛角爲五等邊之半角三十六度其餘角甲辛丙必五十四度】

次算面上大橫綫【卽甲癸】

又全數三十六度之正若甲丙與甲乙也倍甲乙得甲癸

次算中髙綫【丙丁】

法爲全數與七十二度之割綫若甲乙與甲丁也【因平切十等邊爲三十六度半之爲十八度其餘角七十二度卽乙甲丁角】

乃以甲丁爲甲丙爲句兩冪相減開方得股卽丙丁也

次算分體之積

法以中髙丙丁乘戊辛庚己壬底而取其三之一爲分形積

末以十二爲法乘分形積得總積

簡法以分形中髙乘底又四乘之卽得總積【三歸三因對過省用】算甲丙

一率全數

一○○○○○

二率五十四度切綫一三七六三八【相乘得六八】

三率設根之半【甲辛】

五○【八一九○○】

四率甲丙

六八【以全數除之減五位爲畸零】算甲乙

法爲全數與三十六度之正若甲丙與甲乙也

一率全數

一○○○○○

二率三十六度正○五八七七九

三率甲丙

六八八一九○

四率甲乙

四○四五一一

甲癸爲橫切十等邊平面之一

其半爲甲乙丁卽總形之心

亦橫切平面之心

算甲丁

法爲全數與十八度之餘割若甲乙與甲丁也

一率全數

一○○○○○

二率七十二度割綫三二三六○七

三率甲乙

四○四五一一

四率甲丁

一三○九○二五

算丙丁中髙綫

法以甲丁爲甲丙爲句求得股爲丙丁

算得丙丁一百一十一【三五二六】爲中髙綫亦卽十二等面形內渾圓之半徑

算五等邊面冪

法以甲丙乘甲辛五十得三千四百四十○九半又五乘之得一萬七千二百○四七五爲五等邊【邊各一百】之平冪亦卽十二等面分形之底積

算總積

用簡法以底積一七二○四七五四因之得六八九九○以乘中髙得七百六十八萬二千二百一十五八七四○爲十二等面之積

計開十二等面

一率七六八二二一五

例容

二率一○○○○○○

例邊上立積

三率一○○○○○○

設容

四率○一三○一七○

求得設邊上立積立方法開之得其根五十

與比例規解合與測量全義差四千一百七十四爲二百分之一

算辛丁【庚丁戊丁並用】又卽爲外切渾圓半徑

法以甲丁股冪【一七一三五】甲辛句冪【○二五○○】並爲冪【一九六三五】求得數一百四十○爲辛丁卽外切圓半徑計開

十二等面之數

設邊一百其容積七百六十八萬二二一五

內容渾圓徑一百二十二外切渾圓徑二百八十防法十二等面邊求外切內容之立方及外切之立圓置十二等面邊爲理分中末之小分求其大分爲內容立方邊內容立方邊自乘而三之開方得外切立圓全徑

又置十二等面邊爲理分中末之小分求其全綫爲外切立方邊

一率理分中末之小分【三十八一九六六○一】理分中末之大分二率理分中末之大分【六十一八○三三九八】理分中末之全分三率十二等面之邊

四率內容小立方邊卽大橫綫

又

一率理分中末之小分

二率理分中末之全分

三率十二等面之邊

四率外切立方邊

以十二等面邊減外切立方邊余爲內容立方邊以內容立方邊加十二等面邊卽外切立方邊

又防法但以十二等面邊加大橫綫【卽小立方邊】卽外切立方邊

立方內容十二等面算法用理分中末綫

此五等邊面爲十二等面之

一

巳爲平面心中爲體心

寅卯爲戌亥大橫綫之半【三十】

【○九○一六九九】卯中寅中爲外切立方半徑【五十】戌亥爲面之大橫綫【六十一八○三三九八】爲理分中末之大分亦卽內容小立方之根

巳寅巳卯俱平面容圓半徑

巳中爲內容立圓半徑卽分體中髙

丑中爲外切立圓半徑【亥中戌中並同】

設立方根一百爲徑半徑五十爲寅中卯中理分中未大分之半爲寅卯【三十○九○一六九九】又半之爲寅子【一十五四五○八四九五】爲理分中末大分四之一

一率全數

一○○○○○

二率五十四度之割綫一七○一三○

三率寅子

【一十五四五○八四九五】

四率寅巳【卽卯巳】

二六二八六五

求得卯巳爲平面中垂綫

一率全數

一○○○○○

二率三十六度之切綫○七二六五四

三率卯巳

二十六二八六五

四率卯丑【卽半邊】

一十九○九八二

倍卯醜得丑亥邊三十八【一九六四】卽十二等面邊乃理分中末大分之大分也以此知大橫綫與五等邊爲理分中末之全分與其大分之比例也

卯巳句冪【○六九○九八】卯中冪【二五○○○○】相減爲股冪一八○九○二開方得巳中【四十二五三二五】爲內容渾圓半徑

卯丑句冪【○三六四七四一二四三】卯中股冪【二五○○】相並爲冪【二八六四七四一二四三】開方得丑中【五十三五二三二】爲外切渾圓半徑

丑亥巳卯相乘五因二除爲面冪以乘巳中而四因之得十二等面積

簡法

十二等面內容小立方【六十一八○三三九八】卽理分中末之大分蓋戌亥大橫綫倍大於寅卯故也大橫綫卽小立方之邊

以大橫綫之冪三因之開方得亥中爲外切渾圓半徑【丑中同】

又立方根與所容十二等面邊若全數與理分中末之小分

約法

立方根與其所容十二等面體內小立方之根若全數與理分中末之大分

凡立方外切渾圓則徑上冪三倍於方冪

計開

立方設徑一百

內容十二等面邊三十八【一九六六○一】

內容小立方邊六十一【八○三三九八】

外切渾圓徑一百○七【○四六六二五】卽丑中亥中倍數外切渾圓半徑【五十三五二三三】卽丑中亥中

內容渾圓半徑四十二【五三二五】卽已中爲分體中髙內容渾圓全徑八十三【○六五一】

內容二十等面邊四十四【七二一一】

幾何補編卷三

十二等面體分圖用理分中末綫

辛戌亥五等邊形爲十二等面之一

寅卯防爲邊折半處中爲體心

卯中爲外切立方半徑【設五十】

卯亢爲外切立方全徑【設一百】

寅卯綫與卯中半徑若理分中末之大分與其全數也在圓內爲三十六度之分圓辛癸辛戌等俱七十二度之分圓

乙巳爲半徑【己丑同】乙癸爲三十六度之通

乙已半徑與乙癸亦若理分中末一之全數與其大分也故乙已癸三角形與卯中寅相似

若取乙丙切綫如乙癸之度則丙巳必同亥癸邊【卽七十二度通】折半於甲則甲乙爲十八度正再於寅卯綫取子壬如乙甲取壬癸如乙己半徑引已子至癸中末乃自卯作綫至中與壬癸平行因得寅中與卯中等則寅中卯卽爲橫切之半面

一率全數

一○○○○○

二率三十六度割綫一二三六○七

三率子寅

一十五【四五○八四九五】

四率丑寅半邊

一十九【○九八三】

倍丑寅得丑戌三十八【一九六六】與簡法合

論曰凡十二等面從其半邊之防【如寅如卯】聮爲綫以剖至體之心【中防】則所剖成寅中卯三角形平面必爲全圓十之一卽寅中卯角必三十六度而中寅或中卯兩與寅卯底若理分中末之全分與其大分矣

又十二等面在立方形內必以卯中【或寅中】自心至邊之綫當立方之半徑是立方半徑與十二等面之寅卯綫亦若理分中末之全與其大分也若設立方半徑一百則寅卯必六十一【八○三三九八】如理分中末之大分也今設立方全徑一百其半徑五十則寅卯亦必三十○【九○一六九九】如大分之半矣寅卯二防旣在【丑戌丑亥】兩邊之折半則戌亥大橫綫必倍大於寅卯而與理分中末大分之全相應爲六十一【八○三三九八】此皆設立方半徑五十之數也而半徑五十其全徑必一百故知設徑一百則十二等面之大橫綫必六十一【八○三三九八】而竟同理分中末大分之數也旣得此大橫綫則諸綫可以互知

試先求邊法爲酉戌【半大橫綫】與丑戌等邊若全數與三十

六度之餘割綫也

一率全數

一○○○○○

二率三十六度割綫一二三六○七

三率酉戌半大橫綫三十○【九○一六九九】

四率丑戌全邊

三十八【一九六六】

論曰五等邊各自其角作綫至心分形爲五則各得七十二度角【如丑巳戌等其巳角皆七十二度】其半必三十六度【如寅已丑之巳角得戊已醜之半正三十六度】而丑戌酉與丑巳寅皆句股又同用醜角則戌角與巳角等爲三十六度

十二等面求積

平面中垂綫【卯己】二十六【二八六五】

邊【卽丑亥丑戌等】三十八一九【六六】半邊【卽丑卯丑寅】一十九【○九八三】一面之平冪二千五百一十○【一三七○】

內容渾圓半徑四十二【四三二五】卽分體五面立錐之中髙【已中】中髙三之一一十四【一四四一】

分積三萬五千四百九十五【八四七三】其形爲五面立錐其體積爲十二之一

全積四十二萬五千九百五十○【一六七六】

外切立方根一百其積一百萬

外切渾圓徑一百○七【○四六六】

內容立方根六十一【八○三三九八】

外切立方與體內容立方徑之比例若理分中末之全分與其大分

又若外切立方之外又切十二等面體體外又切大立方則大立方之徑與今所算外切立方徑亦若理分中末之全分與其大分而外切之十二等面與其內十二等面徑亦必若理分中末之全分與其大分也

孔林宗云外立方與內立方之徑爲理分中末綫全分與大分之比例是矣若內立方之內又容立圓則小立圓之徑與小立方之徑同而外渾圓與外立方之徑不似未可以前比例齊之

若十二等面外切大立方大立方之外又切大立圓大立圓外又切十二等面則大立圓與內容小立圓亦必若理分中末之全分與其大分而外切十二等面與十二等面亦必若理分中末之全分與其大分何則皆外切立方與內容立方之比例也

十二等面容二十等面圖

第一圖

割十二等面之三平面一尖

成此形癸丑丙丑戊醜俱五

等邊平面皆十二等面之一

【已庚辛各爲其中心一防】

醜爲三平面稜所聚之尖亥丑戌丑乙丑俱平面邊各爲兩平面所同用之稜中爲體心巳中辛中庚中皆內切渾圓半徑亦內容二十等面自尖至體心半徑巳卯庚卯巳寅辛寅辛壬俱平面中垂綫寅卯壬皆平面邊折半之防

第二圖

內容二十等面體各自其邊

剖至心成此分體爲內容體

二十分之一辛庚巳三角

尖卽十二等面之中心原防

此防以外俱剖而得甲防與卯防同在卯中綫而甲在卯之下丁在寅下辰在壬下俱同

第三圖

自卯防起依卯己卯庚二綫

剖至體心中成此平面形卯

卽原邊折半處卯中卽原體

外切立方之半徑中卽體心

已庚卽原兩平面之中心防今聯爲【已庚】綫卽內容二十等面之一邊

已中庚卽內切二十等面分體之立面乃三角錐體之一面甲中爲內切二十等面分體之斜垂綫觀第二圖可明【第二圖角防居剖內三角之中心正對原體之醜尖而在其下故角中爲內容分體之正髙而甲中爲斜垂綫也】

今求已庚綫【卽內容二十等面之邊】

法於卯中【外切立方半徑】內求甲中以相減得卯甲爲股用與卯已【原體之面上中垂綫】兩冪相減開方得句爲已甲倍之得巳庚

卯已中三角形

卯中卽外切立方半徑設五十爲底

卯已卽原體之平面中垂綫二十六【二八六五】

巳中卽內容渾圓半徑亦卽

內容二十等面分體之斜稜四

十二【五三二五】

以卯巳巳中兩相減爲較

相並爲總以總乘較爲實卯中底五十爲法除之得亢中二十二【三六○六】以減卯中餘二十七【六三九四】爲亢卯折半得一十三【八一九七】爲卯甲

計開

立方根設一百其半五十【卽卯中】亦爲十二等面自體心至邊

十二等面之平面中垂綫【卽卯巳】二十六【二八六五】

十二等面內容渾圓半徑【卽已中】四十二【五三二五】亦爲內容二十等面自尖角至體心分體以爲錐體之稜

卯巳已中之較一十六【二四六○】總六十八【八一九○】

較總相乘一千一百一十八【○三三四】爲實卯中五十爲法除之得中亢二十二【三六○六】以中亢減卯中五十餘二十七【六三九四】爲亢卯折半得一十三【八一九七】爲卯甲以卯甲減卯中餘三十六【一八○三】爲甲中卽內容二十等面分體之斜垂綫

卯巳自乘得六百九十○【九八○○】爲冪

卯甲自乘得一百九十○【九八

四一】爲股冪相減餘四百九

十九【九九五九】爲勾冪開方得

巳甲二十二【三六○五】倍之得

巳庚四十四【七二一一】卽爲內容二十等面邊

此法甚確亦且甚防無可疑者偶於枕上又思得一法借燈體分形之三角錐以求十二等面內容二十等面分體之三角錐是以錐體相截而知其所截之

邊卽爲內容二十等面之邊

第一圖

醜爲三平面所聚之尖醜

戌丑亥丑乙皆兩平面同用

之稜巳庚辛皆五等邊平

面之心己寅己卯等皆平面心至邊垂綫已牛醜爲平面心對角綫寅卯壬皆平面邊折半之防寅中卯中壬中爲體心至邊綫卽外切立方半徑中爲心

第二圖

聮寅卯卯壬壬寅三綫爲平

三角面橫剖之又各依寅中

卯中壬中綫剖至體心中則

成三角錐體二其一爲丑寅

卯壬體是三角錐而稍扁者也其一爲寅卯壬中體是三角錐而稍長者也其寅卯壬三角平面爲扁形之底又爲長形之面其寅卯等綫與寅中卯中之比例皆若理分中末之大分與其全分也其扁形錐旣剖而去則成圓燈所存長錐卽燈形分體之一平面心之防爲斗在丑尖下與牛防平故丑牛爲則鬥牛如勾而丑牛之距如股也

第三圖

又於圓燈分體剖去辰甲丁

之一截則成甲丁辰中三角

錐乃十二等面內容二十等

面分體中之分體其辰甲丁面與巳庚辛脗合爲一蓋巳庚辛者內容二十等面之一面各於邊折半爲甲丁辰而聮之爲綫則成小三角於中故辰丁等綫皆居巳庚綫之半而甲中原爲二十等面分體之斜垂綫者今則爲三角錐之楞

第四圖

己牛丑卽原平面從心至角

尖之綫醜鬥角中卽原體自

尖至中心之綫又爲外切渾圓半徑

依第二圖截丑巳於牛而橫剖之亦截丑中於斗成丑鬥牛勾股形又依第三圖截斗中於角成醜角巳勾股形此兩勾股相似而比例等

法爲丑牛與丑鬥若醜巳與醜角也

第五圖

寅中卯三角形爲圓燈分體

之立面截爲甲丁中三角形

此兩形相似而比例等法爲卯中與卯寅若甲中與甲丁也

又斗中爲圓燈分體之中髙其平面爲寅卯壬角中爲截體之中髙其平面爲丁甲辰此兩體相似而綫之比例等法爲斗中髙與寅卯濶若角中髙與甲丁濶先求丑斗髙

用截去扁三角錐以牛卯【卽寅卯之半】自乘冪三分加一以減丑卯冪爲丑斗冪開方得醜斗髙

次求醜角髙

用巳丑對角綫乘丑斗以醜牛除之得醜角髙其丑牛綫以牛卯冪減丑卯冪開方得丑牛巳寅丑寅兩冪並開方爲己丑

末求巳庚綫

用醜角減丑中得角中又用醜斗減丑中得斗中以角中乘寅卯以斗中除之得甲丁倍甲丁得己庚爲內容二十等面之邊

理分中末綫以量代算

先以巳爲心作圖而勻分其

邊爲五作甲庚乙丙丁五等

邊平面【卽十二等面之一面】

乙丁爲大橫綫設一百甲庚

等邊必六十一【八○三三九八】爲大橫綫理分中末之大分若乙丁大橫綫設六十一【八○三三九八】則甲庚等邊必三十八【一九六六】亦爲大橫綫理分中末之大分

設立方一百內容十二等面邊三十八【一九六六】爲理分中末之小分亦卽大分之大分

十二等面內又容小立方其邊與十二等面之大橫綫等六十一【八○三三九八】爲大立方邊一百與十二等面邊三十八【一九六六】之中率何也大立方一百乘十二等面邊三十八【一九六六】開方得根卽小立方及大橫綫六十一【八○三三九八】

若大橫綫自乘之冪以十二等面邊除之卽仍得外立方根而以外立方根除大橫綫冪必仍得十二等面之邊矣

求理分中末綫防法用前圖

作五等邊平面求其大橫綫【乙丁】聮兩角爲綫卽得之

次以大橫綫之一端【如乙】爲心其又一端【如丁】爲界作丁戊圓分乃引五等邊與圓分相遇【如引乙丙至戊與圓分遇於戊】則相遇處【如戊】至圓心【如乙】爲全分【卽乙戊亦卽乙丁大橫綫】原邊爲大分【卽乙丙】引出余邊爲小分【卽丙戊】

又法

作平三角使兩角【如戊如丁】俱倍大於一角【如乙】末乃破一倍

角平分之作綫至一邊【如平分丁

角爲兩作丁丙綫至乙戊邊】則其斜綫卽

爲理分中末之大分【卽丁丙也】

解曰倍破角則與小角等【如破丁角爲兩皆與乙角等】而乙丙丁形之乙丁兩角同大則【乙丙丁丙】兩亦同大而乙丙旣爲大分丁丙亦爲大分矣準此又破丙角可以遞求於無窮諸體比例

凡諸體之比例有三

一曰同邊之比例可以求積

一曰同積之比例可以求邊

一曰相容之比例可以互知

內相容之比例亦有三

一曰立圓內容諸體之比例所容體又容立圓一曰立方內容諸體之比例所容體又容立方一曰諸體自相容之比例【卽同徑同髙之比例】或或兩體互相容或數體遞相容

等積之比例比例規解所用今攷定

立方積

一○○○○○○其邊一百

四等面積

一○○○○○○其邊二百○四八等面積

一○○○○○○其邊一百二十八十二等面積一○○○○○○其邊五十

二十等面積一○○○○○○其邊七十七方燈

圓燈

凡方燈依楞剖之縱橫斜側皆六等邊平面凡圓燈依楞剖之縱橫斜側皆十等邊平面故皆有法形體

等邊之比例測量全義所用今攷定

立方邊

一○○

積一○○○○○○方燈體邊○七○七一○六積○八三三三三三

邊一○○

積二三五七○二一

八等面邊○七○七一○六積○一六六六六六

邊一○○

積○四七一四○四

四等面邊一○○

積○一一七八五一

十二等面邊一○○

積七六八二二一五

二十等面邊一○○

積二一八一八二二圓燈體邊○三○九○一七積○二九○九二九

邊一○○

積○九八五九一六

等徑之比例

皆立方所容

立方徑

一○○積一○○○○○○邊【一○○】內容方燈徑

一○○積○八三三三三三邊【○七○七一○六】內容四等面徑一○○積○三三三三三三邊【一四一四二一三】內容八等面徑一○○積○一六六六六六邊【○七○七一○六】內容立圓徑

一○○積○五二三八○九

內容二十等面徑一○○積○五一五二二六邊【○六一八○三四】內容十二等面徑一○○積○四二五九五○邊【○三八一九六六】內容圓燈徑一○○積○二九○九二九邊【○三○九○一七】右以立方爲主而求諸體

內立方及燈體之徑爲自面至面

四等面十二等面二十等面之徑皆自邊至邊【以邊折半處作垂綫至對邊折半處形如工字四等面則上下邊遙相午錯如十字】

八等面之徑爲自尖至尖然皆以其徑之兩端正切於立方方面之中心一立方面其相切亦必六求積約法

凡立方內容諸體皆與立方之六面同髙同濶則燈形積爲立方積六之五四等面積爲立方積三之一八等面積爲立方積六之一以上三者皆方斜比

例

燈形及八等面皆以方求斜法以邊自乘倍之開方得外切立方徑以徑再自乘得立方積取六之五爲燈六之一爲八等面積

四等面則以方求其半斜法以邊自乘半之開方得外切立方徑以徑再自乘爲立方積取三之一爲四等面積

立圓在立方內則其積爲立方積二十一之十一謹按方圓比例祖率圓徑一百一十三圓周三百五十五見鄭世子律學新說較徑七周二十二之率爲宻又今推平圓居平方四百五十二分之三百五十五較十四分之十一爲宻又推得立圓居立方六百七十八分之三百五十五較二十一分之十一爲宻

準立方比例以求各體自相比皆以同髙同闊同爲立方所容者較其積

燈內容同髙之八等面爲八等面得燈積五之一又立圓內容同髙之八等面爲八等面得圓積六十六之二十一【卽二十二之七】二者皆同髙而又能相容用課分法母互乘子得之

準此而知立圓內容八等面其積之比例若圍與徑也

又立方內容十二等面其內又容八等面又立方內容二十等面其內又容八等面二者亦同髙而能相容

同髙之四等面積爲燈積五之二【卽十之四以燈面四因退位得四等面積】同髙之八等面積爲四等面積二之一

同髙之四等面積爲立圓積十一之七

此三者但以同髙同爲立方所容而不能自相容若相容則不同髙

凡立方之燈形內又容立方則內小立方邊與徑得外立方三之二體積爲二十七之八面冪爲九之四凡燈容立方以其邊爲方而求其斜爲外切之立方邊取方斜三之二爲內立方邊

立方邊一○○

面冪一○○○○

體積【一○○○○○○】

燈邊

○七○七一○六面冪○五○○

體積【○八三三三三三】小立方邊○六六六六六六面冪○四四四四四四體積【○二九六二九六】凡方內容圓圓內又容方則內小方之冪得大方三之一防法以小方根倍之爲等邊三角形之邊而求其中垂綫卽外切立圓之徑亦卽爲外大方之邊

如圖三邊旣等則乙丙得甲丙之半若乙丙一其冪亦一而甲丙二其冪則四以乙丙句冪一減甲丙冪四所餘

爲甲乙股冪三

內方之冪一而外切渾圓之

冪三故其根亦如乙丙與甲

乙也或以小立方之根爲句倍根爲求其股爲外切渾圓徑亦同【渾圓徑卽外方邊】

若以量代算則三角形便

如以大方求小方者則以大方爲中垂綫而作等邊三角形其半邊卽小方根也

或用大方爲股而作句股形使其句爲之半卽得之防法句股形使甲角半於丙角則倍於句而句與股如小立方根與大方根

或以甲角作三十度而自乙作垂綫引之與甲丙綫遇於丙則乙丙卽圓所容方之根

又按先有大方求小方者取大方根倍之爲等邊三角形之邊而求其中垂綫以三歸之卽得

凡立方內容方燈燈內又容立圓圓內又容圓燈燈內又容八等面凡四重在內其外切於立方也皆同防【切立方有六處所同者皆在其方面之最中一防若從此一防刺一鍼則五層悉透內惟方燈以面切面不可言防若言防則有十二皆切在立方邊折半處】

凡立方內容方燈燈內又容十二等面體體內又容圓燈燈內又容八等面凡四重在內其切於立方也皆同處【凡六處皆在立方面內方燈體以面切面十二等面以邊切餘皆以尖切尖切者皆每面之最中防】凡立方內容方燈燈內又容二十等面體體內又容圓燈燈內又容八等面同上

凡立方方燈立圓十二等面二十等面圓燈內所容之八等面皆同大

凡立方內容四等面體體內又容八等面其切立方皆同處【四等面以邊切爲立方六面之斜八等面以尖切居立方各面中心卽四等面邊折半處】準此而知立方內所容之八等面與四等面所容之八等面亦同大且同髙各體中所容八等面皆同大因此可知

凡立圓內容十二等面體又容立方其立方之角同十二等面之尖而切於立圓故立圓內所容之立方與十二等面內所容之立方同大

凡二十等面體內容立圓內又容立方立方之角切立圓以切二十等面之面故立圓所容之立方與二十等面內所容之立方必同大

凡二十等面體內容立圓內又容十二等面體體內又容立方此立方之角切十二等面之角以切立圓而切於二十等面之面皆同處

凡諸體能相容者其相容之中間皆可容立圓此立圓爲外體之內切圓亦爲內體之外切圓

惟八等面外切二十等面十二等面四等面及圓燈其中間難著立圓何也八等面之切圓燈以尖切尖而其切四等面十二等面二十等面則以尖切邊故其中間不能容立圓

其他相切之中間能容立圓者皆以內之尖切外之面凡諸體在立方內卽不能外切他體惟四等面在立方內能以其角同立方之角切他體故諸體所容四等面之邊皆與其所容立方之面爲斜綫

凡諸體相容其在內之體爲所容其在外之體爲能容能容與所容兩體之相切必皆有一定之處

凡相容兩體之相切或以尖或以邊【卽體之稜】或以面渾圓在立方內爲以面切面其相切處只一防皆在立方每面之中央【立方六面相切凡六防】

立方在渾圓內爲以尖切面【立方之角有八故相切有八防】有一防不相切者卽非正相容也

渾圓在諸種體內皆與在立方內同謂其皆以面切諸體之面而切處亦皆一防也然其數不同如四等面則切防有四方燈則切防有六八等面則切防有八十二等面及圓燈則切防有十二二十等面則切防有二十其切防之數皆如其面之數而皆在其面之中央也方燈則以其方面爲數圓燈則以其五等邊之面爲數而不論三角之面者何也三角之面距體心逺故不能內切立圓也

諸體在渾圓內皆與立方在渾圓內同謂其皆以各體之尖切渾圓之面也其數亦各不同如四等面則切防亦四方燈則切防十二八等面則切防六十二等面則切防二十二十等面則切防十二圓燈則切防三十皆如其尖之數也

四等面在立方內以邊稜切立方之面四等面有六稜以切立方之六面皆徧其四尖又皆切於立方之角十二等面二十等面在立方內皆以其邊稜切立方之面兩種各有三十稜其切立方只有其六以立方只有六面也

此三者爲以楞切面

八等面在立方內以尖切面凡六防圓燈在立方內亦以尖切面有六防皆在立方面中尖與八等面同方燈在立方內則以面切面皆方面也方燈之方面六亦與立方等也其十二尖又皆切於立方之十二邊楞皆在其折半處爲防

十二等面與二十等面逓相容皆以內體之尖切外體之面

十二等面在八等面內以其尖切八等面之面體有二十尖只用其八也

方燈在八等面內亦以面切面而皆三角面方燈之三角面有八數相等也又其尖皆切於八等面各稜之中央折半處稜有十二與燈之尖正等也

圓燈在十二等面內以面切面皆五等邊平面也圓燈體之五等邊平面原有十二故也又皆以其尖切十二等面之邊楞而皆在其中半

圓燈在二十等面內亦以面切面皆三角平面也圓燈體之三角平面原有二十故也又皆以其尖切二十等面之邊楞而皆在其中半

問十二等面與二十等面體勢不同而圓燈之尖皆能切其楞邊何也曰圓燈有三十尖而兩等面體皆有三十楞故也

凡能容之體皆可攺爲所容之體遞相容者亦可遞攺如立方容圓卽可刓方爲圓渾圓容方卽可削圓爲方遞相容者如立方內容渾圓圓內又容十二等面體體內又容二十等面卽可遞攺

凡所容之體皆可補爲能容之體皆以數求之

如立方外切立圓以其尖角則求立方心至角之綫爲立圓半徑

凡以面切面者其情相通

如方燈以其方面切立方面又能以其三角切八等邊面則此三者皆方斜之比例也

又如圓燈以其五等邊面切十二等面又能以其三角面切二十等面則此三者皆理分中末之比例也若反用之而令立方在方燈之內則立方之尖所切者必三角面若八等面在方燈之內則其尖所切又必方面也若令十二等面在圓燈內則所切者必三角面而二十等面居圓燈內所切者又必五等邊面也故曰其情相通

諸體相容

凡立圓立方皆可以容諸體

凡立圓內容立方立方內又可容立圓兩者不雜他體可以相生而不窮

凡立圓內容立方此立方內又可容四等面四等面又可容立圓三者以序進亦可以不窮

凡立圓內容立方又容四等面四等面在立方內以其尖切立圓與立方尖所切必同防

凡立圓容四等面在立圓所容立方內必以其楞爲立方面之斜依此斜綫衡轉成圓柱形必爲立圓之所容而此柱形又能含立方

外圓者柱之底若面內方者

立方之底若面直而斜者四

等面之邊

凡四等面體在立圓內任以一尖爲頂以所對之面爲防旋而作圓錐此錐體必爲立圓之所容而不能爲立方之容

此兩體𨿽非正相容體然皆有法之體

凡立方內可容八等面八等面又可容立方而相與爲不窮

凡立方有六等面八尖八等面有八等面六尖故二者相容則所容體之尖皆切於爲所容大體之面之中央而等

凡立方內容立圓此立圓內仍容八等面其八等面尖切立圓之防卽可爲切立方之防

八等面內容立圓此立圓內仍容立方則立方尖切立圓之防亦卽可爲其切八等面之防

凡立圓可爲諸等面體所容其在諸體內必以圓面一防切諸體之各面此一防皆在其各等面之中心而等而徧

凡八等面內容立圓仍容立方立方內仍容四等面而四等面以其角切立方角卽可同立方角切立圓以切八等面疊串四體皆一防相切必在八等面各面之中心

立方設一百內容二十等面邊六十一【八○三三九八】內又容立圓也十三【四一七二】

簡法取內容立圓徑冪三之一開方得內容小立方再以小立方爲理分中末之全分而求其大分得內容十二等面邊

凡十二等面二十等面皆能爲立圓之所容皆以其尖切渾圓凡十二等面二十等面皆能容立圓皆以各面之中心一防正與渾圓相切

凡十二等面與二十等面可以互相容皆以內體之尖切外體之各面中心一防

凡十二等面內容渾圓渾圓內又容二十等面與無渾圓者同徑二十等面內容渾圓渾圓內又容十二等面亦與無渾圓同徑何也渾圓在各體內皆以其體切於外體各面之中心防而此防卽各內體切渾圓之防故也以上皆可以疊串相生而不窮

凡十二等面內容渾圓渾圓內又容十二等面亦可以相生不窮

二十等面與渾圓遞相容亦同

凡立方內容十二等面皆以十二等面之邊正切於立方各面之正中凡六皆遙相對如十字

假如上下兩面所切十二等

面之邊橫則前後兩面所切

之邊必縱而左右兩面所切

之邊又橫若引其邊爲周綫

則六處相交皆成十字

立方內容二十等面邊亦同

凡各體相容皆以內之尖切

外之面惟立方內容四等面

則以角而切角立方內容十

二等面二十等面則以邊而

切面

歷算全書卷五十七﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

欽定四庫全書

歷算全書卷五十八

宣城梅文鼎撰

防何補編卷四

方燈

凡燈形內可容立方立方在燈體內必以其尖角各切於八三角面之心

如圖

燈體者立方去其八角也平

分立方面之邊爲防而聯爲

斜綫則各正方面內成斜綫

正方依此斜綫斜剖而去其

角則成燈體矣此體有正方

面六三角面八而邊綫等故

亦爲有法之體

凡燈體內可容八等面八等面在燈體內又以其尖角各切於六方面之心

凡燈體內可容立圓此立圓內仍可容八等面此八等面在立圓內可以各角切立圓之防同防於燈體之六方面而成一防

凡燈體容立圓其內仍可容諸體然惟八等面在立圓內仍能切燈體余不能也按圓燈在立圓內亦能切燈體與八等面同

凡諸體相容皆有一定比例以其外可知其內

燈體之邊設一百其冪一萬○倍之二萬開方得一百四十一【四二一三】爲燈之髙及其腰廣【邊如方面髙廣如斜故倍冪求之】以髙一百四十一【四二一三】乘方斜之面冪二萬得二百八十二萬八千四百二十六爲方斜之立方積

立方積五因六除得二百三十五萬七千○二十一爲燈積

燈積爲立方六之五

以燈積減立積餘四十七萬一千四百○五爲內容八等面積此八等面在立積內亦在燈積內皆同腰廣同髙其積之比例爲立積六之一爲燈積五之一此相容比例

八等面與燈積不惟同髙廣亦且同邊故五之一亦卽爲八等面與燈積同邊之比例也

燈形內容立方其邊爲燈體髙廣三之二設燈體邊一百其髙廣一百四十一【四二一三】則內容立方邊九十四【二八○八】立方積八十三萬八千○五十一

燈髙廣自乘之冪二萬如左圖甲乙方去其左右各六之一餘三之二如丙丁矩又去其兩端六之一餘三之

二如戊正方丙丁矩一萬三千

三百三十三【三三】戊正方八千

八百八十八【八八】爲內容正方

之一面冪其根九十四【二八○八】以根乘面得八十三萬八千

○五十一

凡等邊平三角之心依邊剖

之皆近大邊三之一燈內容

立方之八角皆切於平三角

之心燈攺立方則所去者皆

四圍斜面三之一於前形爲六之一四圍皆六之一合之爲三之一而所存必三之二矣

凡立方體各自其邊之中半斜剖之得三角錐八此八者合之卽同八等面體

依前算八等面體其邊如方其中髙如方之斜若以斜徑爲立方則中含八等面體而其體積之比例爲六與一

何以言之如己心辛爲八等

面之中髙庚心戊爲八等面

之腰廣己庚己戊戊辛辛庚

則八等面之邊也若以庚心

戊腰廣自乘爲甲乙丙丁平面又以己辛心中髙乘之爲甲乙丙丁立方【立方一面之形與平面等】則八等面之角俱正切於立方各面之正中而爲立方內容八等面體矣夫己心辛庚心戊皆八等面【己庚等面】爲方之斜也故曰以其斜徑爲立方則中含八等面體也

又用前圖甲乙丙丁爲立方之上下平面從己庚庚辛辛戊戊己四綫剖至底則所存爲立方之半而其所剖

三角柱體四合之亦爲立方之

半也

此方柱也其髙之度如其方之斜

立方之四隅各去一立三角

柱則成此體其積爲立方

之半爲八等面之三倍其中

仍容一八等面體

八等面體在方柱體內

柱形從對角斜綫【如己辛戊庚】剖

至底又從對邊十字綫【如丑尾卯

箕】剖至底又從腰綫【角申亢】橫

截則剖爲三角柱一十六【卽皆

如心辛申未丑之體】

三角柱眠視之則塹堵也

塹堵從一尖【卽心尖】斜剖至對

底【未申】則鼈臑也鼈臑居塹堵

三之一

塹堵立則爲三角柱鼈臑立

則爲三角錐

八等面體從尖心剖至對角

亦剖至對邊而皆至底【子】又

從腰【角申亢】橫剖之則成三角

錐十六

夫方柱爲塹堵十六而八等

面爲鼈臑亦十六則塹堵鼈

臑之比例卽方柱八等面之

比例矣鼈臑爲塹堵三之一

則八等面亦方柱三之一矣方柱者立方之半也八等面旣爲方柱三之一不得不爲立方六之一矣

立方內容燈體

甲庚立方體六面各平分其

邊【如壬丑癸卯及子未酉午辰諸防】而斜剖

其八角【如從丑癸剖至子從從癸卯剖至酉從酉

剖至午未則立方去其八角】成燈體

燈體立方六之五

何以知之立方所去之八角

合之卽成八等面八等面旣

爲立方六之一則所存燈體

不得不爲立方六之五矣

凡立方內容燈體皆以燈之邊綫爲立方之半斜立方內之燈體又容八等面則以內八等面之邊綫爲立方之半斜與立方竟容八等面無異推此燈內容八等面其邊綫必等其中徑亦等

剖立方之角成此

以剖處爲底則三邊等以立

方之角丁爲頂成三角扁錐

扁錐立起則成偏頂錐爲八

等面分體

凡八等面容燈體皆以燈體

之邊綫得八等面之半八等

面內之燈體又容立方則亦

方斜比例與八等面竟容立

方無異也

甲丙丁丙丁乙甲丁戊戊丁

乙皆八等面之一己子卯等

小三角在甲丁丙等大三角

面內卽燈體之八斜面正切

於八等面者也其中央心防

卽內容立方角所切

等徑之比例

立方徑一

其邊一

其積一

一○○○○○○內容燈徑一

其邊○七其積六之五○八三三三○○內容八等面徑一其邊○七其積六之一○一六六六○○凡立方內容燈體燈內又容立圓圓內又容八等面其切於立方之面之中央凡六處皆同一防若立圓內容燈體燈內又容立方方內又容八等面其相切俱隔逺不能同在一防

凡燈體皆可依楞橫剖如方燈橫剖成六等邊面故其外切立圓之半徑與邊等如圓燈橫剖成十等邊面故其外切立圓之半徑與其邊若理分中末之全分與其大分

凡諸體攺爲燈皆半其邊作斜綫剖之

凡燈體可補爲諸體皆依其同類之面之邊引之而防於不同類之面之中央成不同類之錐體乃虛錐也虛者盈之卽成原體所以化異類爲同體也

如方燈依四等邊引之補其八隅成八尖卽成立方若依三等邊引之補其六隅成六尖卽成八等面如圓燈依五等邊引之補其二十隅成二十尖卽成十二等面若依三等邊引之補其十二隅成十二尖卽成二十等面

增異類之面成錐則攺爲同類之面而異類之面隱此化異爲同之道也

凡燈體之尖皆以兩綫交加而成故稜之數皆倍於尖【方燈十二尖二十四稜圓燈三十尖六十稜】

凡燈體之稜【卽邊】皆可以聯爲等邊平面圏如方燈二十四稜聯之則成四圏每圏皆六等邊如六十度分圓綫圓燈六十楞聯之則成六圏每圏皆十等邊如三十六度分圓綫此外惟八等邊聯之成三圏每圏四楞成四等面而十二稜成六尖有三稜八觚之正法其餘四等面十二等面二十等面皆不能以邊正相聯爲圏

燈體亦有二

其一爲立方及八等面所變其體有正方之面六三角之面八有邊稜二十四而皆同長稜尖凡十有二其一爲十二等面二十等面所變其體有五等邊之面十二有三角等邊之面二十有邊楞六十而皆同長稜尖凡三十

立方及八等面所變是刓方就圓終方勢謂之方燈十二等面及二十等面所變是削圓就方終帶圓體謂之圓燈方燈爲立方及八等面所變其狀並同而比例同

甲乙立方體丙丁戊己庚辛

壬癸子皆其邊折半處各於

折半防聯爲斜綫【如丙戊丙己等】依

此燈體斜綫剖而去其角則

成燈形矣

燈形之丁辛髙丙丁濶皆與立方同徑其邊得立方之半斜【假如立方邊丁辛一百則燈體邊丁壬七十有奇】其積得立方六之五【假如立方邊一百其積百萬則燈體邊七十有奇其積八十三萬三千三百三十三三三】此爲立方內容燈體之比例也若燈與立方同邊必反小於燈【假如燈體邊亦一百則其積二百三十五萬七千○二十一而立方一百之積只一百萬是反小於燈也】解曰燈體邊一百【如前圖之丁壬】其外切立方必徑一百四十一【四二一三如前圖之丁辛】其自乘之冪二萬以徑乘冪得二百八十二萬八四二六爲立方積再五因六除得燈積二百三十五萬七千○二十一

又法以燈邊自乘倍之開方得根仍以根乘倍冪再五因六除

見積亦同

甲乙爲八等面體甲乙丙

丁戊皆其邊稜所輳之尖

甲丙丁面三邊皆等其三邊

折半於辛於庚於己

甲丁戊面其邊折半於辛於

壬於癸乙丙丁面其邊折半

於寅於己於丑乙丁戊面其

邊折半於丑於癸於子各以折半防聯爲斜綫則各成小三等面如甲丙丁面內又成庚辛己三等邊面其邊皆半於原邊如庚辛得丁丙之半餘三邊同

各自其小三角之面之邊剖之而去其錐角則成燈形矣

如依辛巳己丑丑癸癸辛四邊平剖之而去其丁角【以丁角爲尖辛巳丑癸爲底成扁方錐甲丙乙戊尖並同】則所剖處成辛巳丑癸平方面【去甲壬辛庚錐成卯壬辛庚面去丙庚己寅錐成庚酉寅己面並同一法餘可類推】

八等面體有六角皆依法剖之成平方面六而剖之後各存原八等面中小三角等邊面八與立方剖其八角者正同

燈形之髙濶皆得八等面之半

如辛丑髙得甲乙之半

己癸濶得丙戊之半

其邊亦爲八等面原邊之半

其積得八等面八之五

何以知之曰同類之體積以

其邊上立方積爲比例故邊

得二之一其積必八之一也

今所剖去之各尖俱以平

方爲底而成方錐兩方錐合

爲一八等面體皆等面等邊

與原體爲同類而其邊正得

原邊二之一則其積爲八之

一也原體六尖各有所成之錐體皆相等合之成同類八等面之體凡三其積共爲原積八之三以爲剖去之數則所存燈體得八之五也

如上圖甲乙二錐合爲八等面體一丙戊二錐合爲八等面體一丁尖及所對之尖其二錐合爲八等面體一通共剖去同類之形三

假如八等面之邊一百則其積四十七萬一千四百○四其所容燈體邊五十其積必二十九萬四千六百二十七五以八等面積五因八歸之見積

或用捷法竟以十六歸進位所得燈積亦同

右法乃八等面內容燈體比例也

若燈體之邊與八等面同大則其積五倍大於八等面假如燈體邊一百則其積二百三十五萬七千○二十以八等面邊一百之積四十七萬一千四百○四加五倍得之此法則燈體與八等面同爲立方所容之比例亦卽爲燈內容八等面之比例

準此而知燈內容八等面八等面又容燈則內燈體爲外燈體八之一

燈體內容八等面五之一【用畸零乘法化大分爲小分以八等面母數八乘五之一】八等面內容燈體八之五【得八乘母數五得四十】

外燈體四十八等面體八內燈體五合之爲內體得外體四十之五約爲八之一

又八等面容燈燈又容八等面內八等面亦爲外八等面八之一其體之比例旣同則其所容之比例亦同也立方內容燈體燈內又容立方則內立方邊得外立方邊三之二內立方積得外立方積二十七之八

以三之二自乘再乘爲三加之比例也

六之

五一百三十五

二十七之八四十八

準此而知燈內容立方則內立方積得燈積一百三十五之四十八若燈容立方立方又容燈則內燈積亦爲外燈積二十七之八其爲所容者之比例卽能容者之比例故也求方燈所去錐體

三角錐稜皆五十卽原邊之

半【甲乙甲丙甲丁】底之邊皆七十

○【七一○七】卽燈體之邊【丙乙乙丁丁丙】其半三十五【三五五三乙戊戊丁】

求甲戊斜垂綫

法曰乙丁爲甲乙之方斜綫則甲戊爲半斜與乙戊戊丁等皆三十五【三五五三】其冪皆一千二百五十

求丙戊中長綫

以戊丁冪三因之爲丙戊冪平方開之得六十一【二三七二】爲丙丁乙等邊三角形中長綫

求甲己中髙綫

法以戊丁冪【一千二百五十】取三之一爲己戊冪【四百一十六六六六六】與甲戊冪【卽丁戊冪】相減余【八百三十三三三三三】爲甲己中髙冪開方得甲己中髙二十八【八六七五】

又以己戊冪開方得己戊二十○【四一二四】以己戊【二十○四一二四】乘戌丁【三十五三五五三】得【七百二十一六八六五】又三因之得【二千一百六十四○五七五】爲乙丙丁三等邊冪

又以中髙甲己【二十八八六七五】乘之得數三除之得三角錐積二萬○八百二十三【六六三五】又八乘之得一十六萬六千五百八十七【三○】爲所去八三角錐共積卽立方一百萬六之一與前所推合【本該一十六萬六千六百六十六六六不盡因積算尾數有欠然不過萬分之一耳】

圓燈爲十二等面二十等面所變體勢並同而比例亦別

公法皆於原邊之半作斜綫相聯則各平面之中成小平面此小平面與原體之平面皆相似卽爲內容燈體之面依此小平面之邊平剖之去原體之銳角此所去之銳角皆成錐體錐體之底平割錐體則原體挫銳爲平亦成平面於燈體原有若干銳亦成若干面而與先所成之小平面不同類然其邊則同

如圖

十二等面每面五邊等今自

其各邊之半聯爲斜綫則成

小平面於內亦五等邊爲同

類

依此斜綫剖之而去其角所

去者皆成三角錐錐體旣去

卽成三等面爲異類

原有十二面故所存小平面

同類者亦有十二

原有二十尖故所剖錐體而

成異類之面者亦二十

求燈體邊

法以十二等面邊爲理分中末之大分求其全分而半之卽爲內容燈體之邊

一率理分中末之大分

六十一【八○三三九八】二率理分中末全分之半五十○

三率十二等面之邊

一百○○

四率內容燈體之邊

八十○【九○一七】

燈體邊原爲大橫綫之半十二等面邊與其大橫綫若小分與大分則亦若大分與全分也而十二等面邊與燈邊亦必若大分與全分之半矣

總乘較爲實戊丙底爲法法

除實得丙辛以丙辛減戊丙

得戊辛折半爲戊己

法當以所得戊己自乘爲句

冪用減甲戊冪余爲甲己冪

開方得一十七【八四一一】爲中髙

今攺用捷法【省求丙辛】取戊丙冪

九之一爲戊己冪【戊己爲戊內三之一

故其冪爲九之一】得五百四十五【四二

三七】

或徑用戊丁冪三之一亦同

又捷法不求甲戊斜垂綫但以戊丁冪三分加一以減甲丁【卽甲丙或甲乙】冪爲甲己冪開方卽得甲己中髙比前法省數倍之力

戊丁冪一千六百三十六【二七一二】

三之一

五百四十五【四二三七】

並得

二千一百八十七【六九四九】

甲丁【卽甲丙冪】二千五百○○

相減余【甲乙冪】三百一十八【三○五一】

與前所得同解曰原以戊丁冪減甲丁冪得甲戊冪復以戊丁冪三之一減甲戊冪得甲己冪今以戊丁三分加一而減甲丁冪卽徑得甲己冪其理正同

前之捷法有求丙辛及較總相乘後用底除諸法可謂捷矣今法徑不求甲戊斜垂綫捷之捷矣凡三角錐底濶等者當以爲式

訂定三角錐法【圓燈所去】

用捷法以戊丁冪三分加一減甲丁冪爲甲己冪

甲丁【甲乙甲丙】皆設五十

丙丁【丁乙乙丙】皆八十○【九○一七】其

半【戊丁戊乙】四十○【四五○八半】丙戊七十○【○六二九】爲底之垂綫

甲己一十七【八四一一】爲中髙

丙乙丁底冪二千八百三十四

【一○三八】

法以半邊【戊丁】乘中長【丙戊】得底冪【丙乙丁】以中髙【甲己】乘底冪【丙乙丁】得三角柱積五萬○五百六十三【五二九三】三除之得錐積一萬六千八百五十四【五○九七】又以二十乘之爲燈體所去之積三十三萬七千○九十○【一九四○】十二等面邊設一百前推其積爲七百六十八萬三千二百一十五今減去積三十三萬七千○九十存燈積七百三十四萬五千一百二十五內容燈體邊八十○【九○一七】

依測量全義凡同類之體皆以其邊上立方爲比例可以推知二十等面所變之燈體

二十等面邊設一百則燈體之邊五十

捷法求得一百七十三萬三千九百四十八爲設邊五十之燈積

一燈體邊八十○【九○一七】之立方五十二萬九千○百○八【五】二燈體積七百三十四萬五千一百二十五

三燈體邊五十之立方一十二萬五千

四燈體五十之積一百七十三萬三千九百四十八圓燈

邊設三十○【九○一七卽理分中末之大分乙丁】外切立圓半徑五十【卽理分中末之全分丁中乙中】外切立圓全徑一百【卽外切立方】體積四十○萬三千三百四十九

內有三角錐計二十共計一十二萬

八千七百五十二

五稜錐計十二共積二十七萬四千

五百九十六

丁中丙乙三角錐爲圓燈分體之一乙丁丙三等邊面巳爲平面心中爲體心中巳爲分體之中髙戊丁爲半邊丁中自體心至角綫爲分體之稜戊中爲斜垂綫

乙癸中辛五稜錐亦圓燈分體之一乙丁癸壬辛五等邊面庚爲平面心中庚爲分體中髙其戊丁半邊丁中分體稜戊中斜垂綫與前三角錐皆同一綫何以知兩種錐形得同諸綫乎曰乙戊丁邊兩種分體所同用而兩種錐體皆以體心中爲其頂尖故諸綫不得不同觀上圖自明

先算三角錐【共二十】

半邊一十五【四五○八五】戊丁冪二百三十八【七二八七】

平面容圓半徑【卽戊巳】○八【九一○五】其冪七十九【五七六二用捷法取戊丁冪以三除得之】

平面積【乙丙丁面】四百一十三【四八七九】

中髙【卽己中】四十六【七○七五本法以戊丁冪減丁中冪爲戊中冪又以戊丁冪三之一當戊己冪減之爲巳中冪今徑以戊丁冪加三之一減丁中冪爲己中是捷法也】

三角錐積六千四百三十七【六六二○】

二十錐共積一十二萬八千七百五十三【三四】

次算五稜錐【共十二】

半邊一十五【四五○八五戊丁】

半周七十七【二五四二五用半邊五因得之】

平面容圓半徑二十一【二六六三戊庚】

五等邊平積一千六百四十二【九一二○】

中髙四十一【七八五三庚中】

五稜錐積二萬一千九百六十二【六六】

十二錐共積二十七萬四千五百九十六

求戊庚半徑

一率三十六度切綫○七二六五四

二率全數

一○○○○○

三率半邊戊丁

一十五【四五八五】

四率平面容圓半徑【戊庚】二十一【二六六二】

戊丁句冪二百三十八【七二八七】丁中冪二千五百○○

戊中股冪二千二百六十一【二七一三】

戊庚句冪四百五十二【二五五五】戊中冪二千二百六十一【二七一三】庚中股冪一千八百○九【○一五八】

戊丁半邊冪四因之爲全邊三十○【九○一七】之冪

一燈體邊五十之立方一十二萬五千

二燈體邊五十之體積一百七十三萬三千九百四

十八

三燈體邊三十○【九○一七】之立方二萬九千五百○八

【四九八七】

四燈體邊三十○【九○一七】之體積四十○萬九千三百二十九與細推者只差五千九百八十爲八十分之一

柱積六萬八千六百四十九

錐積二萬二千八百八十三

十二錐共積二十七萬四千五百九十六

孔林宗附記

方燈可名爲二十四等邊體圓燈可名爲六十等邊體

四等面體又可變爲十八等邊體爲六邊之面四爲三邊之面四凡十二角

又可變爲二十四等面體面皆三邊凸邊二十四凹邊十二十字之交六凡八角如蒺藜形

六等面體又可變三十六等邊體爲八邊之面六爲三邊之面八凡二十四角

八等面體亦可變三十六等邊體爲六邊之面八爲四邊之面六凡二十四角

又可變四十八等邊體爲四邊之面十八爲三邊之面八凡二十四角

大圓容小圓法平渾

甲大圓內容乙戊丙三小圓

法以小圓徑【如乙戊戊丙】爲邊作

等邊三角形而求其心如丁

乃於丁戊【三角形自心至角綫】加戊甲

【小圖半徑】爲大圓半徑【丁甲】

凡平圓內容三平圓四平圓五平圓六平圓皆以小圓自相扶立若平圓內容七平圓以上皆中有稍大圓夾之

甲大渾圓內容丙戊乙己四

小渾圓法以小渾圓徑【如乙戊戊

巳等】爲邊作四等面體而求其

體心如丁次求體心至角

綫【如丁戊丁己丁乙丁丙又爲外切立圓半徑】加小渾圓半徑【卽戊甲】爲大圓半徑【如丁甲】

凡渾圓內容四渾圓或容六渾圓或容八渾圓十二渾圓皆直以小渾圓自相扶若渾圓內二十渾圓則中多餘空必內有稍大渾圓夾之

甲大平圓內容乙戊丙己四

小平圓法以小圓徑【如乙戊等】爲

邊作平方【如乙戊丙己方】而求其斜

【如丁乙卽方心至小圓心綫】加小圓半徑

【如乙甲】爲大圓半徑【如丁甲】

若先有大圓【甲】而求所容小圓則以三率之比例求之一率方斜並數二四一四

二率方根

一○○

三率所設之渾圓半徑丁甲

四率所容之小圓半徑乙甲

推此而知五等邊形於其銳角爲心半其邊爲界作小圓而以五等邊之心至角如半邊以爲半徑而作大圓則大圓容五小圓俱如上法

若六等邊於其鋭作小圓仍可於其心作圓共七小圓何也六等面之邊與半徑等也其法只以小圓徑【卽六等邊】

二分加一爲大圓半徑

甲大渾圓內容乙丙等六小

渾圓

法以小渾圓之徑爲邊作八

等面虛體如乙己丙辛戊皆

小立圓之心聯爲綫則成八

觚乃求八等面心【丁】至角

之度【如丁乙等】加小圓半徑【如甲乙】爲大渾圓半徑【如甲丁】

捷法以小渾圓徑爲方【卽乙己丙

辛平方】求其斜【如丁乙】加小圓半

徑【如甲乙】爲大圓半徑或以小渾圓徑自乘而倍之開方得根加小圓半徑爲大圓半徑亦同

或先得大圓而求小圓徑則用比例

一率方斜並二四一四

二率方根

一○○

三率所設大渾圓之徑

四率內容六小渾圓之徑

甲渾圓內容乙丙戊已庚壬辛及癸丑子寅卯十二小圓

法以小立圓徑【如乙丙等】作二十

等面虛體之稜【如乙丙等俱小圓之心聯

爲綫則成二十等面之稜】次求體心【丁】至

角【卽小圓心】之綫【如乙丁】加小圓半

徑【如甲乙】爲大圓半徑【如甲丁】按體心至角綫卽二十等面

外切圓半徑

二十等面之例邊一百【卽小渾圓

例徑】

外切渾圓例徑二百八十八

【一三五五】

二十等面邊一百者其外切渾圓徑一百八十八奇又加小渾例徑得此數

若先有大渾圓而求所容之十二小渾圓則以二率爲一率四率爲三率

一外切渾圓之例徑二百八十八【一三五五】

二二十等面之例邊一百【卽小渾圓例徑】

三設渾圓之全徑一百

四內容十二小渾圓之徑三十八【六九其比例如全四八分與小分】甲庚大平圓內容七小圓

法以甲庚圓徑取三之一【如丁

乙庚辛等】爲小圓徑若容八圓以

上則其數變矣假如以七小圓

均布於大圓周之內而切於

邊則中心一小圓必大於七

小圓而後能相切【以上仿此】

甲大渾圓內容八小立圓

法以小圓徑作立方【如乙庚方】求

其立方心至角數【卽外切渾圓半徑如

乙丁】再加小圓半徑【如甲乙】爲大

渾圓半徑【如甲丁】

按八小員半徑十【甲乙】則其全徑二十內斜綫【乙丁】十七加【甲乙】共二十七內減小圓徑二十餘七倍之得十四是比小圓半徑爲小其比例爲十之七安得復容一稍大小圓在內乎

又二十等面有十二尖可作十二小圓以居大渾圓之內而爲所容

又八等面有六尖可作六小圓爲大渾圓所容四等面有四尖可作四小圓

又方燈亦有十二尖可作十二小圓爲大渾圓所容其中容空處仍容一小圓爲十三小圓皆等徑也

十二等面有二十尖用爲小渾圓之心可作二十小立圓以切大渾圓內有稍大渾圓夾之

圓燈尖三十可作三十小球亦皆以內稍大渾圓夾之公法皆以心至尖爲小渾圓心距體心之度皆以小渾圓徑爲所作虛體邊

如作內容二十小渾圓聯其心成十二等面虛體虛體之各邊皆如小渾圓徑也虛體之各尖距心皆等此距心度以小渾圓半徑加之爲外切之大渾圓半徑以小渾圓半徑減之爲內夾稍大渾圓半徑

渾圓內容各種有法之體以查曲綫弧面之細分公法凡有法之體在渾圓體內其各尖必皆切於渾圓之面

凡渾圓面與內容有法體之尖相切成防皆可以八綫知其弧度所當

內惟八等面皆以弧綫十字相交爲正角餘皆鋭角其十二等面則鈍角

十二等面每面五邊等析之從每面之角至心成平三

角形五則輳心之角

皆七十二度半之三

十六度卽甲心乙角

其餘心乙甲角必五

十四度倍之爲甲乙

丁角則百○八度故

爲鈍角

凡渾圓面切防依內切各面之界聯爲曲綫以得所分渾體之弧面皆如其內切體等面之數之形

如四等面則其分爲弧面者亦四而皆爲三角弧面十二等面則亦分弧面爲十二而皆成五邊弧形八等面則弧面亦分爲八二十等面弧面亦分二十而皆爲三角弧形內惟六等面爲立方體所分弧面共六皆爲四邊弧形

凡渾圓面上以內切兩防聯爲綫皆可以八綫知其幾何長

其法以各體心到角之綫命爲渾圓半徑以此半徑求其周作圈綫卽爲圓渾體過極大圈以八綫求兩防所當之度卽知兩防間曲綫之長

凡渾圓面以曲綫爲界分爲若干相等之弧面卽可以知所分弧面之冪積

假如四等面外切渾圓依切防聨爲曲綫分渾圓面爲四則此四相等三角形弧面各與渾圓中剖之平圓面等冪何也渾圓全冪得渾體中剖平圓面之四倍今以渾冪分爲四卽與渾圓中剖之平圓等冪矣

推此而知六等面分外切渾圓冪爲六卽各得中剖平圓三之二

八等面分渾圓冪爲八卽各得中剖平圓之半冪十二等面分渾圓冪爲十二卽各得中剖平圓三之一二十等面分渾圓冪爲二十卽各得中剖平圓五之一凡依等面切渾所剖之圓冪又細剖之皆可以知其分冪

假如四等面所分爲渾圓冪

四之一而作三角弧面若中

分其邊而防於中心則一又

剖爲三爲渾圓冪十二之一

與十二等面所分正等但十

二等面所剖爲三邊弧綫等此所分爲四邊弧綫形如方勝而邊不等若自各角中防於心成三邊形其冪亦不等也

再剖則一剖爲六爲渾圓面冪二十四之一【皆得十二等面所剖之半而邊不等】若但一剖爲二則得渾圓冪八之一與八等面所剖正等但八等面三邊等又三皆直角此則邊不等又非直角

假如八等面所剖爲渾冪八

之一若一剖爲二則十六之

一剖爲四則三十二之一可

以剖爲六十四至四千九十

六若以三剖則渾冪二十四之一如十二等面之均剖亦如四等面之六剖也再細剖之可以剖爲九十是依度剖也可以剖爲五千四百則依分剖也再以秒防剖之可至無窮

惟八等面可以細細剖之者以腰圍爲底而兩防於極其形皆相似故剖之可以不窮

又以此知曲面之容倍於平面何也八等面所剖之渾體腰圍卽平圓周也以平圓周之九十度爲底兩端皆

以平徑爲兩以防於平圓

之心則其冪爲平圓四之一

若渾體四面以腰圍九十度

爲底兩端各以曲綫爲兩

以防於渾圓之極則其冪爲

平圓二之一矣

假如六等面【卽立方】在渾圓內

剖渾冪爲六得渾冪六之一

若一剖爲二則與十二等面

所剖等剖爲四則二十四之

一再剖則一爲八而得四十

八之一

假如十二等面剖渾冪爲十

二各得渾冪十二之一若剖

一爲五則得六十之一再剖

一爲十則得百二十之一而

與八等面所剖爲十五之一

假如二十等面剖渾冪爲二十各得渾冪二十之一若一剖二則四十之一若一剖三則六十之一若一剖六則百二十之一皆與十二等面所剖之冪等而邊不必等也

凡球上所剖諸冪以爲底直剖至球之中心成錐形卽分球體爲若干分

如四等面之冪得球冪四之一依其邊直剖至球心成三角錐其錐積亦爲球體四之一推之盡然

防何補編【補遺】

平三角六邊形之比例

平三角等邊形

甲丁丙三邊等形其邊【丁甲】折半

【丁乙】自乘而三之卽爲對角中

長綫冪開方得中長綫丙乙

旣得中長綫丙乙以乘丁

乙半邊卽等邊三角形積若以丙乙冪丁乙冪相乘得數平方開之得三等邊形之冪積

防法不求中長綫但以丁乙冪三因之與丁乙冪相乘開方得根卽三等邊冪積或用原邊丁甲自乘得數乃四分之取四之一與四之三相乘得數開方得三等邊積亦同

論曰邊與邊橫直相乘得積若邊之冪乘邊之冪亦必得積之冪矣故開方得積

法曰以原邊之冪三因四除之又以原邊之半乘之兩次爲實平方爲法開之得三等邊形冪積

解曰原邊冪四之三卽中長冪也半邊乘二次以冪乘也又法以原邊與半邊冪相減相乘開方見積平三角等邊形冪積自乘之冪與平方形冪積自乘之冪若三與十六【理同前條】

解曰甲戊庚丁爲平方形丁

丙甲爲等邊三角形其邊同

爲甲丁題言丁甲綫上所作

三等邊形與所作正方形其積之比例若平積三與十六之平方根也【卽一七奇與四○】

防法於分面綫上取三點爲等邊三角形積其十六點卽正方積若以邊問積則以邊之方冪數於分面綫之十六點爲句置尺取三點之句卽得三等邊積其設數得數並於平分綫取之【此用比例尺算】

又法作癸卯辰半員辰癸爲徑於徑上勻分十七分而盡一端取其四分如醜癸【丑癸爲辰癸十七分之四則丑子爲辰子十六分之三】

折半於丁以丁爲心丁癸爲

半徑作癸壬丑小半員又以

丁癸折半於子作卯子直綫

【與辰癸徑爲十字埀綫】割小員於壬則

壬子與卯子之比例卽三等

邊冪與正方冪積比例

用法有三等邊形求積法以甲丁邊上方形【卽庚甲】積作卯子直綫如句四倍之作橫綫如辰子爲股次引橫綫取子癸爲卯子四之一又取丁子如癸子次以丁癸爲半徑丁爲心作半員截卯子於壬卽得壬子爲三等邊積

防法不作辰子綫但於子作半十字綫如癸丁次於子點左右取癸取丁各爲卯子四之一乃任以丁爲心癸爲界作割員分卽割卯子於壬而爲三等邊形之積論曰此借用開平方法也平方求根有算法有量法此所用者量法也量法有二其一以兩方之邊當句當股而求其是爲並方法也其一用半員取中比例此所用者中比例也【詳比例規觧】

附三等邊求容圓

法曰以原邊之冪十二除之爲實平方開之得容圓半徑

解曰原邊冪十二之一卽半邊三之一也

附三等邊形求外切圓

法曰以原邊之冪三除之爲實平方開之得外切圓半徑一法倍容圓半徑卽外切圓半徑

新增求六等邊法

法曰六等邊形者三等邊之六倍也【以同邊者言】用前法得三等邊積六因之卽六等邊積

依前法邊上方冪與三等邊形冪若四○與一七奇因顯邊上方冪與六等邊形冪若四○與十○二奇【亦若一○○與二五五】

今有六等邊形問積法以六等邊形之一邊自乘得數再以二五五乘之降兩位見積

解曰置四○與一○二各以四除之則爲一○○與二五五之比例也

若問員內容六等邊形者卽用員半徑上方冪爲實以二五五爲法乘之得數降二位見積亦同【降二位者一○○除也】依顯平員積與其內容六等邊形積之比例若三一

四與二五五

論曰六等邊形之邊與外切員形之半徑同大故以半

徑代邊其比例等【半徑上方與六等邊

形亦若一與二五五】然則員全徑上方

形與內容六等邊形必若四

○○與二五五【全徑上方原爲半徑上方】

【之四倍】而員面冪積與六等邊形積亦必若三一四與二五五矣【員徑上方與員冪原若四○○與三一四故也】

用尺算用平分綫求同根之冪

平方冪四○○

八十○

【皆倍而退位之數】平員冪

三一四

約爲六十三弱【實六二八】

六等邊冪

二五五

五十一

三等邊冪

一七○

三十四

右皆方內容員員內又容六角之比例其六等邊與員同徑乃對角之徑也於六等邊之邊則爲倍數三等邊則只用邊

若六等邊形亦卽用邊與平方平員之全徑相比則如後法

平方

四○○

平方一○○○○平員

三一四

平員

七八五四六角

一○二○

六角二五五○○三角

一七○

三角

四二五○論曰以平方平員之徑六角三角之邊並設二○則爲平方四○○之比例若設一○○則如下方平方一○○○○之比例也

量體細法

四等面體求積

法曰以原邊之冪三除之得數以乘邊冪得數副寘之又置邊冪二十四除之得數以乘副平方開之卽四等面積也

又法置半邊冪三除之得數以乘半邊冪得數副寘之又以六爲法除半邊冪得數爲實平方開之卽四等面積四分之一也【卽三角扁錐】

算二十等面

二十等面之稜綫甲丁設一百七十八【原設一百一十因欲使外切立方與十二等面同故攺此數】心乙一百四十四【卽原切十等邊之半徑又爲外切立方之半徑】外切立方徑二百八十八

求中心爲分體之髙法先

求乙中【乃各稜折半處至三角面中央一點之距】依防何補編半甲丁得八

十九爲甲乙自乘【七千九百二十一】取三之一【得二千六百四十又三之一】爲

乙中句冪又以心乙【一四四】自乘【二○七三六】爲冪相減余【一萬八千○九十五又三之二】爲股冪開方得心中一百三十四半彊爲分體鋭尖之髙倍之得二百七十九半弱爲內容立員徑

求甲心爲分體斜稜法以甲乙爲句其冪【七九二一】以乙心爲股其冪【二○七三六】並之【二八六五七】爲冪開方得甲心一百六十九二爲分體自角至鋭之斜稜倍之三百三十八半弱爲外切渾員之徑

或取理分中末綫之大分【如心乙】爲股小分【如甲乙或丁乙】爲句取其【甲心或丁心】爲二十等面自角至心之楞綫合

之成甲心丁形卽二十等面分形之

斜立面也甲丁則原形之楞也

如【甲心丁】之面三皆以心角爲宗以甲

心等合之【三面皆有此】則甲丁等底【三底

並同甲丁】以尖相遇而成三等邊之面卽

二十等面之一面也以此爲底則成

三角尖錐矣尖錐之立三角面皆等皆稍小於底解曰乙戊與甲乙等而甲心與戊心【卽乙心】不等如與股【乙戊卽十等邊之一邊乃二十等面橫切之面之邊】今欲求心中正立綫中卽

二十等面一面之中自此至

心成心中綫則其正髙也

法先求甲中爲句取其冪以

減甲心冪卽心中股冪開

方得心中

簡法取乙甲【卽原楞之半又卽小分】自冪三之一以減乙心【卽大分又卽原楞均半處至形心卽斜立面中綫】之冪卽心中冪

又解曰原以甲乙半楞【又卽二十等面中剖所成之楞卽十等邊之一邊故爲小分】爲句【在形內爲小分乃乙戊也今形外之甲乙與甲乙同大故亦爲小分】乙心【卽二十等面中切成十等邊自角至心之故爲大分又卽爲二十尖錐各立面三角形之中長綫】爲股則甲心爲【自各角至體心之綫】而甲心冪內有乙心股甲乙句兩冪今求心中之髙則又以甲中爲句自各角至各面心也而仍以甲心爲冪內減甲中句冪則其餘心中股冪也依防何補編甲乙冪三分加一爲甲中冪故但於乙心冪內減去甲乙冪三分之一卽成心中股冪又解曰若以乙心爲則中乙爲句而心中爲股依補編中乙冪爲甲乙冪三分之一故直取去甲乙冪三之一爲句冪以減心乙冪卽得心中股冪開方得心中此法尢防

作法以二十等面之楞【如甲丁】折半【如甲乙或丁乙亦卽甲戊】爲理分中末之小分求其大分【如乙心卽二十等面各楞綫當中一點至心之綫亦卽外切立方之半徑】再以大分爲股【乙心】小分爲句【甲乙亦卽甲戊亦卽戊乙】取其【甲心卽二十等面自各角至心之綫謂之角半徑亦卽切員半徑】再以原楞【甲丁】爲底切員半徑爲兩【甲心及丁心】成兩等邊之三角形卽二十等面體自各角依各楞綫切至體心而成立錐體之一面三面盡如是則成三角立錐矣如是作立錐形二十聚之成二十等面體

立錐體之中髙綫【心中】以乘三體面之冪而三除之得各錐積二十乘錐積得立積其中髙綫【心中】卽內容立員之半徑

立方內容二十等面體其根之比例若全分與大分立方內容十二等面體其根之比例若全分與小分二十等面體之分體並三楞錐以元體之面爲底原體之楞【甲丁】折半【甲乙】爲小分爲句取其大分【心乙】爲股句股求得自角至心爲外切員之半徑【心甲】

假如【甲丁】原楞一百一十半之得甲乙半楞五十五自乘【三千○二十五】爲句冪其大分乙心【卽外切立方半徑】八十九自乘【七千

九百二十一】爲股冪並二冪【一萬○九

百四十六】平方開之得【一○四又六二

不盡約爲一○四半彊】爲角至體心之

綫【心甲】卽外切立員之半徑

算二十等面之楞於渾天度

得防何分

法以心甲爲渾天半徑甲乙

爲正法爲心甲與甲乙若

半徑與甲心乙角之正查正表得度倍之爲丁甲通所當之度

算十二等面

五等邊面爲十二等面之一面有五邊在體之面則爲五楞錐其一楞設一百一十【甲丙】半之五十五【乙丙】以甲丙爲小分求其大分得一百七十八丙戊也【卽丙丁壬丁壬戊丁角爲丙中甲角之半與平圓十等邊之一面等】半之八十九已丙也【卽乙辛以丙巳乙爲兩腰等形辛巳乙亦兩腰等形故辛乙與巳丙等丙巳乙形與元形丙戊甲形相似巳角卽戊角而乙丙爲小分乙巳或辛乙爲大分】爲內作小五等邊之一邊【乙辛】亦卽十二等面從腰圍平切之十等邊面也

又以乙辛爲小分求得大分一百四十四心乙也【分圖辛心乙形卽前圖辛心乙形乙辛爲心壬之小分心乙爲大分乙心綫卽五等面一邊折半處至體心之距丙防卽五等面邊兩楞相湊之角

乙丙辛虛綫形卽前圖乙丙辛形】爲甲丙半楞【乙丙】之全分何則前圖之丙巳乙形乙丙爲小分丙巳爲大分試於辛乙心形內【分圖】作庚辛乙形與丙巳乙形等【庚乙卽乙丙五等面一邊之半乙辛庚辛卽丙巳乙巳爲小五邊形之一邊】則乙庚爲小分乙辛爲大分【心庚同】今又以乙辛爲小分求其大分壬癸而壬癸卽心乙也【乙癸同】夫心乙乃庚乙【小分】辛乙【大分卽心庚】之並則乙心爲庚乙之全分矣其比例心乙與心庚若心庚與庚乙而乙心卽外切立圓半徑也

右法楊作枚補

今求心中綫爲五等邊最中一防【中】至體心【心】之距亦卽內容渾員半徑

先求乙中綫爲五等邊各楞折半處至最中之距法爲甲乙比乙中若半徑與五十四度之切綫

一半徑

一○○○○○

二乙甲中角【五十四度】切綫一三七六三八

三半楞甲乙

五十五

四中乙

七十五【七○】

用句股法以心乙【一百四十四】爲中乙【七十五七】爲句句各自乘相減得心中股冪平方開之得中髙綫【心中爲容員半徑】求得容員半徑一百二十二半弱【心中】

又求甲心綫爲各角至體心之距【卽外切渾員半徑】用句股法以甲乙【五五】爲句心乙【一四四】爲股並句股冪求甲心

求得外切圓半徑一百五十四彊【甲心】

十二等面根一一○【甲丙】

外切立員半徑一四四【心乙】全徑二八八○

內容渾員半徑一二二半【心中】全徑二四五【弱】

外切渾員半徑一五四【甲心】全徑三○八【彊】

十二等面之分體並五楞錐並以五等邊面爲底原體之楞甲丙設一百一十半之乙甲五十五爲小分求其全分乙心一百四十四【卽外切立方半徑】乙甲【五十五】自乘【三千○二十五】爲句冪心乙【一百四十四】自乘【二萬○七百三十六】爲股冪並之得【二萬三千七百六十一】平方開之得【一百五十四彊】爲自角至心之綫甲心卽外切員半徑

作法以五等面之一邊爲

底楞【甲丙】以外切員半徑【角至心之】

【綫】爲兩之楞【甲心及丙心】而防於心五邊悉同則爲十二分體之一如是十二枚則成十二等面體

變體數

求渾圓積

設渾圓徑一○○○自乘得一○○○○○○又十一【古法】乘之得一一○○○○○○爲實十四除之得○七八五七一四爲平圓面冪或用舊徑七圍念二之比例亦得圓面七八五七一四以四因之得渾圓之冪三一四二八五六

置渾圓之冪以半徑五○○因之得一五七一四二八○○○是爲以渾圓面冪爲底半徑爲髙之圓柱形積置圓柱形積以三爲法除之得五二三八○九三三三是爲以渾圓面冪爲底半徑爲髙之圓角形積亦卽渾圓之積

渾圓根一○○○體積五二三八○九三三三用爲公積

立方

置公積卽渾圓積【五二三八○九三三三】立方開之得立方根八○六二○二七一七是爲與渾圓等積之立方

方錐

置公積【五二三八○九三三三】以三因之得數立方開之得髙濶相等之方錐形根一一六二二四四四四七是爲與渾圓等積之方錐

方

錐

圓柱

置公積【同上】十四因之十一除之爲實立方開之得髙濶相等之圓柱形根八七四二三九四二是爲與渾圓之積之圓柱

【圓柱】

圓錐

置公積【同前】以三因之【變圓錐形積爲圓柱積】再以十四因之十一除之爲實【變圓柱積爲立方積】立方開之得髙濶相等之圓錐形根一二五九四七五九是爲與渾圓等積之圓錐或置積以四十二因之十一除之立方開之亦同

【圓錐】

按變體綫本法有四等面八等面十二等面二十等面諸數表皆未及其同者惟有渾圓立方二形其餘三形皆比例規解及測量全義之所未備今以法求之則皆長濶相等而不爲渾圓立方者耳夫不爲渾圖立方而仍可以法求者以其長濶相等則仍爲有法之形也然而與今西書所載合者二不合者一意者其傳之有誤耶或其所用非徑七圍二十二之率耶俟攷

渾圓以徑求積

置徑自乘又以半徑乘之又四因之又以十一乘之以十四除之又以三除之見積

解曰平圓與平方之比例知其周與周假如七則方周二十八圓周二十二兩率各折半爲十四與十一徑自乘則爲平方形以十一乘十四除則平方變爲平圓矣以平圓爲防半徑乘之成圓柱形再以三歸之成圓角形【卽圓錐】渾圓面冪爲防半徑爲髙之角形四倍大於此圓角形故又四因之卽成渾積也

防法徑自乘以乘半徑乃以四十四因四十二除見積或徑上立方形二十二因四十二除或用半數十一因二十二除見積並同

渾圓以積求徑

置積以三因之四除之又以十四因之十一除之再加一倍立方開之得圓徑

解曰圓積是圓角形四今三因之變爲圓柱形四矣故用四除則成一圓柱此圓柱形是半徑爲髙全徑之平圓爲防今以十四乘十一除則變爲全徑之平方爲防半徑爲髙矣故加一倍卽成全徑之立方

防法積倍之以四十二因四十四除立方開之得圓徑或用本積以八十四乘四十四除立方開之或用半數以四十二乘二十二除立方開之或又折半以二十一乘乘十一除立方開之得積並同

按徑七圍二十二者乃祖衝之古法至今西人用之可見其立法之善𨿽異城有同情也𨿽其於眞圓之數似尙有盈朒然所差在防忽之間而已吾及錫山楊昆生柘城孔林宗另有法其所得之周俱小於徑七圍二十二之率則其所得圓積亦必小於古率矣

楊法立圓徑一○○○○積五二三八○九二五六四孔法立圓徑一○○○○積五二三五九八七七五

約法

立方與立圓之比例若二十一與十一平圓與外方若十一與十四平圓與內方若十一與七

圓內容方之餘【卽四小弧矢形】若七與四圓外余方【卽四角減弧矢】若十一與三準此則余圓【卽小弧矢】與余方若四與三而小弧矢與其所減之餘方角若一與七五亦若四與三也

歷算全書卷五十八

少廣拾遺序

少廣爲九章之一其開平方法爲薄海內外測量家所需非隸首不能作也平方而外有立方以爲鑿築土方之用課工作者猶能言之若三乘方以上知之者蓋已尠矣嘗見九章比類歷宗算會算法統宗俱載有開方作法本原之圖而僅及五乘並無算例同文算指稍變其圖具七乘方算法而不適於用詮釋不無譌誤西鏡錄演其圖爲十乘方而舉數僅詳平立三乘一式而已餘皆未及康熙壬申余在都門有友人傳逺問屬詢四乘方十乘方法蓋諸乘方法獨此二端不可以借用他法而問者及之竊喜朋儕中固自有畱心學問之人遂稍取古圖防繹發其指趣爲作十二乘方算例頗覺詳明然後知今日所用開平方法廼算數家徑捷之用而不及古圖之簡括精深也宣城梅文鼎

欽定四庫全書

歷算全書卷五十九

宣城梅文鼎撰

少廣拾遺

開方求亷率作法本原圖

自開平方至開八乘方

古圖附說

圖最上書一者本數也本數者卽大方也大方無隅無乘除之可言而數從此起也次並列【一一】者方邊也西法謂之根數卽一十一也左一卽本數因有次商而進位成一十爲初商之根右單一爲次商之根旣有根數卽有平冪故第三層者冪積也西法謂之面卽一百二十一也左一百爲初商自乘之冪卽大方積也右單一爲次商自乘之冪卽隅積也小平方也中二十則兩亷積也並長方也

如圖大小兩方冪以

一角相聫必得兩亷

以輔之而其方始全

故平方亷積二也

第四層者立方積也西法謂之體積卽一千三百三十一也左一千初商再乘之積大立方也右單一爲次商再乘之積隅積也小立方也中三百三十皆亷積也三百爲三平亷積扁立方也三十爲三長亷積長立方也

如圖析觀之則初商大立方體與次商隅積小立方體相連於一角必得三平亷之扁立方體補於大立方之三面又有三長亷之長立方體補於小立方之三面及三平亷之隙而方體始全故立方之亷積有二等而其數各三也

第五層者三乘方也卽一萬四千六百四十一也左一萬者大三乘方也初商方積也右單一者小三乘方也次商隅積也大方積旣以三乘之故而積陞至萬小

【隅𨿽

三

乘】

【仍單一也其相隔已三位故必有第一亷爲】【千數第二亷爲百數第三亷爲十數以補之其數始足其理亦如平方立方也三乘方以】【上不可爲圖諸書有彊爲之圖者非也然其理則有可言者焉以其相生之序言之則皆】【加一算法也初商次商如十與一而其冪則如百與一故於之下各加卽成如十一之自】【乘也此平方率也又以十一乘之成卽立方率也又以一十乘之成卽三乘方率四乘】【以上凖此加之皆加一法也曰若是則諸乘】【方皆以十一逓乘而得非十一者何以處之】【曰根非十一而其理皆如十與一何則凡增一乘積陞一等而亦增一亷亷與亷之積亦】【皆如十與一也冪冪舊名方法舊名上亷舊名下亷一一一一音覓周禮冪人掌共巾冪說文覆也開平方四邊俱等中函縱橫之積亦如覆物之巾有經緯縷文故謂之冪亦謂之面同上省文也見張參五經文字書或小寫】

亷率立成附說

凡開方一位除盡者無亷隅也亷隅皆生於次商次商之根必小於初商一等而其小隅之體必與初商之大方同狀【如再乘之隅卽小立方三乘方之隅卽小三乘方】此可借初商表而降等求之不必更立隅法也亷法則不然每增一乘則亷增一等【如平方但有亷立方則有平亷長亷三乘方則有三種亷四乘方則有四種亷其亷之等並與其乘數同增】而亷亦加多【如平方只二亷立方則平亷長亷各三三乘方則三種亷共有十四乘以上則更增而多如圖所列】此亷率所由立也

問亷旣有等【如平方亷爲十立方亷爲十爲百之類】而今亷率只作單數用何也曰此亷之數也非亷之積也亷積有等則旣於其次序分之矣挨次乘之其等自見【如第一亷必小於初商大方一等第二亷又小一等其最末之亷必大於小隅一等各乘方皆如是】若同一等中應各有若干亷必先知之而後可用故立成中所列皆單數問古圖以右爲隅法其序自左而右今亷率之序自右而左何也曰旣皆作單數用則左右一也今依筆算自右而左便於取用故也【亷法相生之序左右同數如立方平亷三長亷亦三也三乘方第一亷四第三亷亦四也其近大方有若干亷則其近小隅亦有若干亷故左右並同可以左爲初商大方右爲小隅亦可以右爲大方而左爲小隅此亦見古圖之妙也】

問舊有方法亷法之目今防曰亷法何也曰開方法有方有亷有隅其初商自乘卽方也次商自乘卽隅也方與隅之間次商初商相乘而得者皆亷也舊以立方之平亷有似扁方故名之方法而三乘方因之遂又有上亷下亷之目故不如一切去之但以一二三四爲序較畫一耳

問平方之亷皆平冪也立方之平亷長亷皆體積也不知三乘方以上之亷積亦能與方隅並狀乎曰凡諸乘方之亷積無不與方隅之乘數等也試以三乘方言之其第一亷有四皆初商之再乘積而又以次商根乘之是三乘也其第二亷有六皆初商自乘之平冪也而又以次商之平冪乘之第三亷有四皆初商之根數而又以次商之立積乘之皆三乘也又以四乘方言之其第一亷有五皆初商三乘積也又乘次商根是四乘也其第二亷有十皆初商再乘積也又以乘次商冪亦四乘也其第三亷亦十皆初商冪積也又以乘次商再乘積其第四防有五皆初商根也又以乘次商之三乘積皆四乘也五乘方以上俱如是觀後算例自明

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷五十九﹥﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷五十九﹥

諸乘方根同而積不同本易知也惟根之一者積同爲一似乎無別矣然有冪積之一有體積之一有三乘以上諸乘方之一𨿽曰積同爲一其實不同也今以方根之爲單一爲一十爲一百者爲例如右

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷五十九﹥

因有續商故方根以十數見例方積以尾○定位無次商者去尾○用之則方根只爲單數

多【如第一亷用初商立積二亷則初商冪逓減以至三亷則初商只用根】近小隅者次商乘之徧數多【如第一亷只用次商根第二亷則次商亦用冪三亷則逓加而用次商立積】各乘方皆如是

開諸乘方大法

諸乘方法惟平方爲用最多因有専法今自平方立方推之三乘以上至於多乘而通爲一法是爲大法【諸乘方大法可以開平方而平方専法不可以開諸乘方】

總法凡諸乘方皆先列實次作防分段次查表以定初商次求亷隅以定續商

列實之法依勿庵筆算作平行兩直綫以設積紀於右直綫之右皆自上而下至單數止無單數者作○存其位

作防分段之法皆於原積末位單數作一防起【凡減隅積必至單位故分段之法以此爲宗同文算指但言起末位殊混】依各乘方宜以若干位爲一段卽隔若干位防之【或作實防丶或作虛防�俱可然虛防尢便以減商積時有借上位之防免淩雜也】如平方以每兩位爲一段則隔一位防之立方以三位爲一段則隔兩位防之乃至十二乘方以十三位爲一段則隔十二位之並同一法

謹案作防分段其用有二一以定開方有若干次也如有一防則只開一次有兩防則開二次三防則開三次之類一以定開方所得爲何等數也如只有一防則初商卽單數二防則初商是十數三防則初商是百數之類是故初商減積必至於最上防而止也次商減積必至於次防而止也每開一次必減積一次而所減之數必各盡於其作防之位亦可以驗開方之無誤也又最上防以上初商實也次以上次商實也每商皆以防位截實此法於初商尢爲扼要

又案開方分段古人舊法之精錢塘吳信民九章比類山陰周述學歷宗算防悉著其說而同文算指西鏡錄本其意以作防定之施於筆算爲極善也【鼎於三十年前見同文算指作防之法驚嘆其奇後讀諸書始知其有所祖述非西人創也】

初商之法皆以最上一防截原積若干位爲初商實乃查初商表視本乘方下數有與實相同或較小於

實者錄之紀於左綫之左【皆以表數末位對右綫上原實最上紀之】是爲初商應減之積卽於本表旁行查方根紀於左綫之右【皆對所紀表數首位進一位紀之】是爲初商數

以初商應減之積【左行所紀】與初商實【右行最上防所截原實】對位相減【皆以左減右須依筆算從小數減起如左行減數大右行實數反小而不及減則作防於上一位借十數減之】減不盡者爲余實以待續商

凡原實有二則初商爲十數而有次商有三防初商爲百數而有次商及三商以上仿論如實只一防則初商卽是單數無續商

次商之法皆以第二截余實爲次商實

凡初商皆爲方積次商以後則有亷積隅積

先求亷率查亷率立成本乘方亷率有若干等等有若干數平列之爲若干行謂之定率【如平方只一種亷其定率二立方有二種亷曰平亷曰長亷其定率並三若三乘方則有三種亷曰一亷曰二亷曰三亷其定率曰四四六曰四詳後式】每增一乘卽亷增一等而定率增一行【有亷之等有亷之數如平方有二亷立方有三平亷三長亷此亷之數也平方之兩亷同積共爲一等立方之三平亷同積爲一等三長亷同積爲一等共爲二等此亷之等也亷率中兼此二義】

求亷泛積以各亷定率乘初商應有各數各依本乘方減小一等用之亷多者又遞減挨次乘之至根數止是爲泛積【有初商數卽各帶有自乘冪積二乘立積乃至三乘以上各積是爲應有各數也今求泛積當依本乘方減小一等用之如平方只用根數立方用初商冪積乃至十二乘方用初商十一乘此爲減小一等也至第二亷則立方用初商根三乘方用初商再乘乃至十二乘方用初商十乘此爲亷多者二亷以上又逓減挨次乘之也逓減至初商根則爲末後一亷矣故曰至根數止】

求防商數以泛積約余實得之

求亷定積以各亷泛積乘次商數亷多者逓增一等挨次乘之至本乘方減小一等止是爲定積【凡第一亷泛積皆乘次商根而得定積有第二亷則以次商自乘積乘之有三亷則以次商立方積乘之是爲逓增一等也然增不得至本乘方但增至本乘方減小一等數卽爲末後一亷矣】

求隅積以次商數查初商表各依本乘方取之【以次商對橫行根數以本乘方對直行縱橫相遇得之】列於亷積之後一行是爲隅積【小隅體勢並同初商大方如平方則隅卽小平方立方則隅卽小立方三乘方之隅亦爲小三乘方四乘以上並同故可借初商表用之】

求亷隅共積以所得各亷定積及隅積用並法並之卽得

求次商定數以所得亷隅共積紀左綫之左【又在表數之左以末位對第二防紀之爲次商應減之數】與次商實【右行第二防所截】對位相減【以左減右】減不盡者又爲余實以待三商遂紀次商數於初商之下爲次商定數如亷隅共積大於次商實不及減則攺次商至及減而止乃爲次商定數

三商以後並同上法

不論三商四商乃至多商其亷定率不變但求泛積時三商則並初商次商兩位商數合而用之四商則並前三次商數皆取其應有各數以乘定率而得泛積亦如上法之用初商其求定積則三商卽用三商之數四商卽用四商之數以乘泛積而得定積亦如上法之用次商余法並同次商

審○位之法凡亷泛積大於余實或僅相等而無隅不能商一數是次商爲○位也卽紀○位於先商之次而並下一防余實爲續商余實

次商單一之法凡泛積與實僅同而有隅一是商得一數也卽以泛積爲定積不必更乘次商【惟單一則然若商得一十一百一千仍須如法乘之】

開平方【卽一乘方】

設平方積三千三百四十四萬三千○八十九問方根若干

答曰五千七百八十三

列實法【先作兩直綫次以方積三三四四三○八九列

右綫之右】作【法於實末位單數作一防起逆上每

隔一位防之有四防宜商四次初商是千】初商法曰

【用最上一防截原實兩位三三爲初商實查表有小於實三三】

【者是二五其方根五卽以五爲初商對實首上一位書於左綫之右卻以表數二五對實三三書左綫之左與原實對減先於實次位減五實系三不足減作防借上一數爲十三減去五餘八攺書八於實三之右次於實首減二原實是三因借下去一隻得二減盡乃作綫抹去三三存八以待次商亦於左作綫抹去減數二五】

求次商用第二防上余實八四四爲次商實

隅

次商自乘四九○○○○

亷隅共積

並

得

七四九○○○○次商法曰【置亷率立成內定率二乘初商五千得一萬爲泛積乃約實作七百定爲次商卽以泛積乘之得定積七百萬再用次商自乘爲隅其積四十九萬並定積成七百四十九萬卽亷隅共積也俱如式列之於是將次商七續書初商五之下又將共積七四九對實八四四書左綫之左以減實餘九五乃作綫抹去八四四亦於左作綫抹去七四九】

求三商用第三防上余實九五三○爲三商實

隅

三商自乘

六四○○

亷隅共亷

並

得

九一八四○○三商法曰【復置定率二以乘初商次商合數五千七百得一萬一千四百爲泛積乃約實作八十爲三商卽以泛積乘之得定積九十一萬二千三商亦自乘爲隅得積六千四百以並定積成九十一萬八千四百爲亷隅共積俱如式列之再將三商八十挨書次商七百之下而以其亷隅積九一八四對實九五三○書於左綫之左去減實餘三四六卽攺書之以待四商作綫抹去九五三○左亦作綫抺去九一八四】

求四商用第四防上余實三四六八九爲四商實

隅

四商自乘

九

亷隅共積

並

得

三四六八九四商法曰【用定率二乘初商次商三商合數五千七百八十得一萬一千五百六十爲泛積乃約實可商三定爲四商卽以泛積乘之得定積三萬四千六百八十四商三自乘得九爲隅積並定積成三萬四千六百八十九是爲亷隅共積各如式列訖再將四商三挨書於三商八十之下而以其亷隅積三四六八九對第四防實書於左綫之左就以減四商實恰盡乃作綫抹去之左減數亦抺去】初商五千有四防故初商是千位

次商七百

三商八十

四商單三

凡開得平方根五七千百八十三

還原法置方根五千七百八十三自乘得積三千三百四十四萬三千○八十九合原積

開立方【卽再乘方】

設立方積一千○○七萬七千六百九十六尺問每面方若干

答曰二百一十六尺

依法列實作防【自末位單數作一防起逆

上每隔兩位防之有三防宜商三次】

求初商【用最上一防截原實兩位一○爲初商實查初

商表有小於一○者是○八其方根二卽以二定爲初商對實】

【首上一位書左綫之右而以其積數○八對實一○書左綫之左對減初商實餘二攺書之以待次商】初商二百尺【有三防初商是百】

求次商用第二防上余實二○七七爲次商實

依法求得次商一十尺【書於初商二百之下而以其亷隅共積一百二十六萬一千減防商實餘八一六攺書之以待三商】

求三商用第三防上余實八一六六九六爲三商實

隅

三商

再乘

二一六

亷隅共積

並

得

八一六六九六依法求得三商六尺【續書次商一十之下而以亷隅共積八十一萬六千六百九十六減三商實恰盡】

凡開得立方根二百一十六尺

還原置方根【二百一十六尺】自之得【四萬六千六百五十六尺】爲平冪又置平冪以方根乘之得一千○○七萬七千六百九十六合原數

開三乘方

設三乘方積一億三千六百○四萬八千八百九十六問方根若干

答曰一百○八

依法列實作防【自末位單數作一防

起逆上每隔三位防之】

求初商用最上一防截實

首位一爲初商實

凡積一者其根亦一不必查表竟以一爲初商【其積與實對減恰盡】

初商一百【有三防初商是百】

求次商用第二防余實三六○四爲次商實

隅

次

商

三

乘

一○○○○

亷隅共積

並

得

四六四一○○○○依法求得亷隅共積四千六百四十一萬爲次商一十之積大於次商實不及減是無次商也法於初商一百下書○

求三商用第三防合上第二防余實三六○四八八九六共八位爲三商實【三商減積至末位第三防故合八位爲其實】凡求三商當合初商次商兩數乘定率以求泛積今次商故只用初商數

隅

三商

自乘

三次

四○九六

亷隅共積

並

得

三六○四八八九六依法求得三商八【續書次商○之下而以其亷隅共積三千六百○四萬八千八百九十六與余實相減恰盡】

凡開得三乘方根一百○八

還原置方根【一○八】自乘得【一一六六四】爲平冪平冪又自乘得一億三千六百○四萬八千八百九十六合原積

或以方根一百○八自乘三次亦同

開方簡法置三乘方積【一三六○四八八九六】以平方法開之得【一一六六四】再置【一一六六四】以平方開之得方根一百○八合問

開四乘方

設四乘方積一十三億五千○一十二萬五千一百○七問方根若干

答曰六十七

依法列實作【自末位單數作一防

起逆上每隔四位防之共兩防宜商兩次】

求初商用最上一防截原

實一三五○一爲初商實【查表有七】

【七七六小於實其根六卽以六爲初商而以其積七七七六對減初商實餘五七二五攺書之以待次商】初商六十【有兩防初商是十】

求次商用第二防上余實五七二五二五一○七爲次商實

隅

次商

四

乘

一八六○七

亷隅共積

並得

五七二五二五一○七依法求得次商七【書於初商六十之下而以亷隅共積五億七千二百五十二萬五千一百○七減次商實】凡開得四乘方根六十七

還原置方根【恰盡六】自乘四次得積一十三億五千○一十二萬五千一百○七合原數

開五乘方

設五乘方積一兆七千五百九十六萬二千八百七十八億○一百萬問方根若干

答曰五百一十

列實【數以單位

爲根今原積尾位是

百萬故補六○列之】作防【自末單位】

【○上作一防起逆上每隔五位防之】求初商【用最上一截原實五位一七五九六爲初商實入表得五爲初商對實首上一位錄左綫右卽以其積數對實列左綫左相減餘一九七一攺書之以待次商】初商求到五百【有三防故初商是百】

求次商【用第二防上余實一九七一二八七八○一爲次商實】

隅

次

商

五

乘

一○○○○○○亷隅共積

並

得

一九七一二八七八○一○○○○○○依法求得次商一十【書初商五百之下再將亷隅共積一千九百七十一萬二千七百七十八億○一百萬去減次商實恰盡】

原實三宜有三商而次商已減實盡無可商作○於次商下

凡開得五乘方根五百一十○

還原置方根【五百一十○】自乘五次復得一兆七千五百九十六萬二千八百七十八億○一百萬合原積

開六乘方

設六乘方積三百四十三億五千九百七十三萬八千三百六十八問方根若干

答曰三十二

依法列實作防【自末位單數作

防起逆上每隔六位防之共兩防宜商兩次】求初商用最上截原

實三四三五爲初商實【查表】

【得三爲初商書左綫右而以其積數二一八七書左綫之左對減初商實餘一二四八攺書以待續續商】初商三十【有兩防故初商是十】

求次商用第二防上余實【一二四八九七三八三六八】爲次商實

隅

次

商

六

乘

一二八

亷隅共積

並

得

一二四八九七三八三六八依法求得次商二【書初商三十之下再以亷隅共積與次商實對減】

凡開得六乘方根三十二

還原置方根【恰盡三】自乘六次得積【十二三四三五九七三八三】合原數

開七乘方

設七乘方積一千一百○○億七千五百三十一萬四千一百七十六問方根若干

答曰二十四

依法列實作【自末位單

數作防起逆上每隔七位再作一防】求初商用最上防截

原實一一○○爲初商

實【查表得二爲初商卽以二書左綫之右而以其積二五六書左綫之左對減初商實餘八四四攺書之以待續商】

初商二十【有兩防初商是十】

求次商用第二防上余實【八四四七五三一四一七六】爲次商實

亷隅共積

並

得

八四四七五三一四一七六依法求得次商四【書初商二十之下再將亷隅共積八四四七五三一四一七六與次商實對減恰盡】

凡開得七乘方根二十四

還原置方根【二十四】自乘七次復得【一一○○七五三一四一七六】合原數

或以根【二十四】自乘得【五百七十六】爲平冪平冪又自乘得【三十三萬一千七百七十六】爲三乘方積三乘方積又自乘得【一一○○七五三一四一七六】亦合原數

開方簡法置設積【一一○○七五三一四一七六】以平方法開之得【三三一七七六】又置爲實以三乘方法開之得方根二十四

或置設積【一一○○七五三一四一七六】用平方法連開三次亦得方根二十四

開八乘方

設八乘方積一千六百二十八萬四千一百三十五億九千七百九十一萬○四百四十九問方根答曰四十九

列實【法同前】作防【自末位單數作

防起逆上每隔八位防之】求初商【用最上一】

【防截原實一六二八四一三爲初商實查表得八乘方積二六二一四四其根四卽以四定爲初商書左綫右而以其積數書左綫左對減初商實餘一三六六二六九以待次商】

初商四十【有兩防初商是十】

求次商用第二防上余實【一三六六二六九五九七九一○四四九】爲次商實

隅

次

商

八

乘

三八七四二○四八九亷隅共積並

得一三六六二六九五九七九一○四四九依法求得次商九【書初商四十之下再將亷隅共積對減次商實恰盡】

凡開得八乘方根四十九

還原置方根【四十四】自乘八次復得【一六二八四一三五九七九一○四四九】合原積

開九乘方

設九乘方積八十三兆九千二百九十九萬三千六百五十八億六千八百三十四萬○二百二十四問方根若干

答曰六十二

列實【法同前】作【自末位單數作

起逆上每隔九位之】

求初商【如法用最上一原積八位截爲初商實查表得九乘方根六卽以六爲初商而以其積數六○四六六一七六減初商實餘二三四六三七六○待續商各如法書之】

初商六十【冇兩初商是十】

求次商用第二上余實二三四六三七六○五八六八三四○二二四爲次商實

隅

次商九乘

一○二四

亷隅共積

並得

二三四六三七六○五八六八三四○二二四依法求到次商二【書於初商六十之下乃以其亷隅共積二十三兆四千六百三十七萬六千○五十八億六千八百三十四萬○二百二十四減次商實恰盡】

凡開得九乘方根六十二

又法置九乘方積【八三九二九九三六五八六八三四○二二四】以平方法開之得【九一六一三二八三二】爲四乘方積再以四乘方法開之得方根【六十二】

或置九乘方積【八三九二九九三六五八六八三四○二二四】以四乘方開之得【八三四四】再以平方開之得方根【六十二】並同

還原以方根【六十二】自乘九次得原積

或以原根【六十二】自乘四次得【九一六一三二八三二】爲四乘方積再以四乘積四乘得原積亦同

開十乘方

設十乘方積七千四百三十○億○八百三十七萬○六百八十八問方根

答曰一十二

依法列實作防【自末位單

數作一防起逆上每隔十位再作一防】求初商【用最上防截實首位七爲初商

實查表得十乘方根一定爲初商卽以其積一】

【減初商實七餘六攺書之以待續商】

初商一十【有二防初商是十】

求次商用第二防上余實六四三○○八三七○六八八爲實

﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹐卷五十九﹥

隅

次商

十

乘

二○四八

亷隅共積

並得

六四三○○八三七○六八八依法求得次商二【書初商一十之下再將亷隅共積減次商實恰盡】

還原置方根【一十二】自乘十次復得七千四百三十○億○八百三十七萬○六百八十八合原積又法置方根【一十二】自乘【一四四】爲平冪平冪自乘【二○七三六】爲三乘方積三乘方又自乘得【四二九九八一六九六】爲七乘方積再以根再乘之立積【一七二八】乘之得十乘方積

開十一乘方

設十一乘方積七千三百五十五萬八千二百七十五億一千一百三十八萬六千六百四十一問方根若干

答曰二十一

列實【法同前】作防【自末位單數作防起

逆上每隔十一位防之】

求初商用最上一防截實七三五五爲初商實查表得十一乘方根二定爲初商【以其積四○九六對減初商實餘三二五九以俟續商皆各如法書之】

初商二十【有二防初商是十】

求初商用第二防上余實【三二五九八二七五一一三八六六四一】爲次商實

亷隅共積

並得

三二五九八二七五一一三八六六四一依法求得次商一【書初商二十之下其亷隅共積三千二百五十九萬八千二百七十五億一千一百三十八萬六千六百四十一減余實恰盡】

凡開得十一乘方根二十一

還原用方根【二十一】自乘十一次復得原積

又法置方根自乘再乘得【九二六一】爲立方積立方積自乘得【八五七六六一二一】爲五乘方積五乘方積又自乘得十一乘方原積

開方簡法置設積【七三五五八二七五一一三八六六四一】以平方法開之得五乘方積【八五七六六一二一】又置爲實以五乘方法開之得根二十一

開十二乘方

設十二乘方積一十五兆四千四百七十二萬三千七百七十七億三千九百一十一萬九千四百六十一問方根若干

依法列實作防【自末位單數作防起逆上隔十二位防之】

求初商用最上一防截原實一五四四七爲初商實查表得十二乘積【八一九二】其方根二卽以二定爲初商【其積數與實對減餘七二五五再俟續商】

求初商用第二防上余實七二五五三三七七七三九一一九四六一爲次商實

亷隅共積

並

得

七二五五二三七七七三九一一九四六一依法求得次商一【書於初商二十之下再將亷隅共積七兆二千五百五十二萬三千七百七十七億三千九百一十一萬九千四百有六十一以減余實恰盡】

凡開得十二乘方根二十一

還原置方根二十一自乘十二次復得原積或以方根【二十一】自乘得【四四一】再乘得【九二六一】三乘得【一九四四八一】爲三乘方積卽以三乘方積自乘得【三七八二二八五九三六一】再自乘得【七三五五八二七五一一三八六六四一】爲十一乘方積又置爲實而以方根【二十一】乘之得十二乘原積又法以方根自乘再乘得【九二六一】爲立方積就以立方積自乘三次得【七三五五八二七五一一三八六六四一】爲十一乘方積如前再以方根乘之亦得原積

又法以根【二十一】自乘之平方【四四一】爲法自乘四次得九乘方積【一六六七九八八○九七八二○一】再以根【二十一】再乘之立方【九二六一】乘之得十二乘原積並同

論諸乘方簡法

凡開平方二次卽三乘方也是爲方之方開平方立方各一次五乘方也可名爲立方之平方亦可名爲平方之立方

開平方三次七乘方也或三乘方平方各開一次亦同可名爲平方之三乘亦可名爲三乘方之平方

開立方二次八乘方也可名爲立方之立方

開四乘方平方各一次九乘方也可名爲四乘方之平方

開平方二次立方一次十一乘方也或三乘方立方各一次亦同可名爲三乘方之立方亦可名爲立方之三乘方

按惟四乘方六乘方十乘方不能借用他法同文算指謂四乘方開二次爲六乘方又謂四乘方開三次爲十乘方非也且四乘方平方各一次已爲九乘方矣安得有開四乘方二次而反爲六乘開四乘方三次而止爲十乘乎必不然矣

演諸乘方逓增通法

平方積自乘爲三乘方立方積自乘爲五乘方三乘方積自乘爲七乘方四乘方積自乘爲九乘方五乘方積自乘爲十一乘方六乘方積自乘爲十三乘方七乘方積自乘爲十五乘方八乘方積自乘爲十七乘方九乘方積自乘爲十九乘方十乘方積自乘爲二十一乘方十一乘方積自乘爲二十三乘方十二乘方積自乘爲二十五乘方十三乘方積自乘爲二十七乘方十四乘方積自乘爲二十九乘方十五乘方積自乘爲三十一乘方【以上並超兩位】平方積再自乘爲五乘方立方積再乘爲八乘方三乘方積再乘爲十一乘方四乘方積再乘爲十四乘方五乘方積再乘爲十七乘方六乘方積再乘爲二十乘方七乘方積再乘爲二十三乘方八乘方積再乘爲二十六乘方九乘方積再乘爲二十九乘十乘方積再乘爲三十二乘方【以上並超三位】

平方積自乘三次爲七乘方立方積自乘三次爲十一乘方三乘方積自乘三次爲十五乘方四乘方積自乘三次爲十九乘方五乘方積自乘三次爲二十三乘方六乘方積自乘三次爲二十七乘方七乘方積自乘三次爲三十一乘方【以上並超四位】

平方積四乘爲九乘方立方積四乘爲十四乘方三乘方積四乘爲十九乘方四乘方積四乘爲二十四乘方五乘方積四乘爲二十九乘方【以上並超五位】平方積五乘爲十一乘方立方積五乘爲十七乘方三乘方積五乘爲二十三乘方四乘方積五乘爲

五十九乘方【以上並超六位】

平方積六乘爲十三乘方立方積六乘爲二十乘方三乘方積六乘爲二十七乘方四乘方積六乘爲

三十四乘方【以上並超七位】

平方積七乘爲十五乘方立方積七乘爲二十三乘方三乘方積七乘爲三十一乘方【以上並超八位】

平方積八乘爲十七乘方立方積八乘爲二十六乘方三乘方積八乘爲三十五乘方【以上並超九位】

平方積九乘爲十九乘方立方積九乘爲二十九乘方【以上並超十位】

【平方至十二乘方已有初商表其十三乘以後不及詳列推以根之爲二爲三者演之至三十二乘以見其意】

根二【至三十二乘則有十位】

根三【至三十二乘則有十六位】

【十三乘】

一六三八四

四七八二九六九

【十四乘】

三二七六八

一四三四八九○七

【十五乘】

六五五三六

四三○四六七二一

【十六乘】

一三一○七二

一二九一四○一六三

【十七乘】

二六二一四四

三八七四二○四八九

【十八乘】

五二四二八八

一一六二二六一四六七

【十九乘】

一○四八五七六

三四八六七八四四○一

【二十乘】

二○九七一五二

一○四六○三五三二○三

【二十一乘】

四一九四三○四

三一三八一○五九六○九

【二十二乘】

八三八八六○八

九四一四三一七八八二七【二十三乘】

一六七七七二一六

二八二四二九五三六四八一【二十四乘】

三三五五四四三二

八四七二八八六○九四四三【二十五乘】

六七一○八八六四

二五四一八六五八二八三二九

【二十六乘】

一三四二一七七二八

七六二五五九七四八四九八七【二十七乘】

二六八四三五四五六

二二八七六七九二四五四九六一【二十八乘】

五三六八七○九一二

六八六三○三七七三六四八八三【二十九乘】一○七三七四一八二四

二○五八九一一三二○九四六四九【三十乘】

二一四七四八三六四八

六一七六七三三九六二八三九四七【三十一乘】四二九四九六七二九六一八五三○二○一八八八五一八四一【三十二乘】八五八九九三四五九二五五五九○六○五六六五五五五二三

附開多乘方求次商防法

列實作防截實求初商如常法旣得初商減一等自乘爲亷積【加五乘方則用四乘】又以本乘方數加一爲亷數【如五乘方則用六】亷數乘亷積得數爲法以除余實爲次商遂合初商次商數依本乘方數乘之【如五乘方亦自乘五次】得積合原數定所得爲方根【如原積數少不及減則攺次商及減而止】

假如三乘方積五百七十六萬四千八百○一問方根若干

答曰四十九

如法於初商表取三乘方積二五六

減原實定初商爲四十餘實【三二○四八○

一】爲次商實法置初商四○自乘

再乘得【六四○○○】爲亷積【本方三乘故亷積用再乘爲減一等】又以四爲亷數【三乘方故用四爲亷數爲加一數】亷數乘亷積得【二五六○○○】爲法以除次商實得九爲次商【得數可進一十因欲存第二亷以下亷隅積數不得滿除只商作九數待酌】遂合初商次商共四十九依法自乘得【二四○一】又以【二四○一】自乘得【五七六四八○一】以較原實相同減盡卽定四十九爲三乘方根

歷算全書卷五十九﹤子部﹐天文算法類﹐推步之屬﹐歷算全書﹥

欽定四庫全書

歷算全書卷六十

宣城梅文鼎撰

壍堵測量二

總論

塹堵測量者句股法也以西術言之則立三角法也古九章以立方斜剖成塹堵其兩端皆句股再剖之則成錐體而四面皆句股矣任以錐體之一面平寘爲底則其鋭上指環而視之皆成立面之句股而各有三角三邊故謂之立三角也

立三角之法以測體積方圓斜側靡所不通其測渾圓之弧度則有二理其一用視法如弧三角所詮用三角三弧之正切綫移於平面【謂渾圓立剖之平面】卽成三層句股相似之比例今謂之渾圓容立三角也其一不用視法而用實數如句股錐形等法用三弧三角之割綫余各於其平面自成相似之句股以爲比例【三弧直剖至渾圓之心卽各成句股形之面】今謂之塹堵測量也【渾圓內容之立三角亦塹堵之分形而塹堵測量所測亦渾圓之度因書匪一時所爲而意各有屬其名遂別二而一一而二者也】

以上通論立三角及塹堵測量命名之意並其同異之處【因立三角有塹堵之名因渾圓內三層句股生塹堵之用故存此二者以爲塹堵測量基本】

凡數之可算者皆可作圖以明之故渾圓可變爲平圓如古者蓋天之圖是也數之可算可圖者皆可制器以象之故渾圓可剖爲錐體塹堵測量之儀器是也凡測算之器至今日大備且益精益簡古者渾儀經緯相結爲儀三重至郭太史之簡儀立運儀則一環而已足今則更省之爲象限儀是益簡益精之效也至於渾象無與於測而有資於算所以證理也西法之簡平渾蓋以平寫渾亦可謂工巧之至獨未有器以證八綫夫用句股以算渾圓其法莫便於八綫然八綫之在平圓者可以圖明在渾圓者難以筆顯【鼎】蓋嘗深思其故而見渾圓中諸綫犁然有合於古人塹堵之法乃以堅楮肖之爲徑寸之儀而三弧三角各綫所成之句股了了分明省筆舌之煩以象相告於作圓布算不無小補而又非若渾象之難成因名之曰塹堵測量從其質也塹堵形析渾象之一體亦如象限儀割渾儀之一隅環而測之則象限卽渾儀之全周也周徧析之則塹堵卽渾象之全體也是故塹堵形可析爲兩可合爲一其析者一爲句股錐【亦曰立三角儀】則起二分訖二至一爲句股方錐【亦曰方直儀】則起二至訖二分起二分者西率起二至者古率也是兩者九十度中皆可爲之【自分訖至九十度並可爲句股錐自至訖分九十度並可爲句股方錐】然至半象以上割切三綫太長溢出於方塹堵之外故又有互用之法也其合者近分度用句股錐近至度用句股方錐以黃道四十七度赤道四十五度爲限過此者互用其餘如是則兩錐形合之成方塹堵矣

方塹堵內又成圓塹堵二其一下爲赤道圓象限而一爲撱形之象限距度之割切二綫所成也其一下爲撱形象限而上爲黃道之圓象限距度正黃道半徑所成也【兩圓塹堵之用已括於兩錐形內】兩圓塹堵內又以黃道正距度正成小方塹堵之象則郭太史圓容方直本法也於是又有圓容方直儀簡法而立三角之儀遂有三式【一句股錐其形四鋭一方直儀其底長方一圓容方直簡法儀其底爲渾圓冪之分】

之三者或兼用割切或專用正而並不用角合渾圓內三層句股觀之可以明立法之根

以上論塹堵測量儀器【句股錐形及句股方錐形二種爲塹堵測量正用而圓容方直形專用正成小塹堵尢正用中之正用也此小塹堵在兩重圓塹堵內故兼論之又此小塹堵足闡授時弧矢之祕因遂以郭法附焉】

問八綫生於角用八綫而不用角何也曰角與弧相應故用角卽用弧也用弧卽用角也明於斯理而後可以用角渾圓內三層句股是也明於斯理而後可以不用角塹堵三儀是也用角者西法也而用角卽用弧則通於古法也不用角者古法也而用弧卽用角則通於西法也於是而古法西法可以觀其防通息其煩喙矣

以上論角卽弧解之理

立三角法序

立三角者量體之法也西學以幾何原本言度數而所譯六卷之書止於測面其測體法則未之及蓋難之也余嘗以句股法釋幾何而稍爲推廣其用謂之幾何補編亦曰立三角法本爲體積而設然其中義類頗有與渾圓弧度之法相通者故摘錄之以明塹堵測量之理

立三角法摘錄

總論

一立三角爲有法之形

立三角之面皆平三角也平三角不拘斜正皆爲有法之形故立三角亦不拘斜正而皆爲有法之形

一立三角爲量體之宻率

凡量體者必析之析之成立三角形則可以知其容積可得而量矣若不可以立三角析者則爲無法之形不可以量

一立三角卽錐體

立三角任以一面平安如底則餘三面皆斜立【亦有一面正立者】而鋭必在上卽成三角立錐

一各種錐體皆立三角之合形

凡錐體必上尖下濶任取其一面觀之皆斜立之平三角也凡錐形自其尖切至底則其中剖之立面亦平三角也錐體之底或四邊五邊以至多邊若以對角綫分其底又卽皆成平三角也故四稜錐可分爲兩五稜錐可分爲三六稜以上無不可分分之皆立三角形故知一切錐體皆立三角之合形也

底之邊多至於三百六十又析之爲分爲秒以此爲底皆可成錐體再析之至於無數卽成平員底可作員錐要之皆小平三角面無數以成之者也

一各種有法之形亦皆立三角之合形

如立方體依其稜剖至心成立分體皆扁方錐其斜面輳心皆成立三角長方體亦然

四等面體從其稜剖至心成四分體八等面則成八分體二十等面成二十分體皆立三角錐

十二等面依稜剖至心成十二分體皆五稜錐其立面五皆立三角

渾員形以渾員面冪爲底半徑爲髙作大員錐而成渾積凖前論皆無數立三角所成然則渾員亦立三角也

渾員旣爲立三角所成則半之而爲半渾員【一平員面一半渾員面如員中剖】或再分之而爲一象限或更小於象限之渾員【細分弧面自象限以內至於一度內若干分秒如剖橘瓤並一弧面兩半平員面】以渾員之理通之皆立三角所成

一無法之形有面有稜卽皆爲立三角所成

凖前論各依其楞綫割之至底或依對角綫斜剖之卽皆成立三角而無法之形皆可爲有法之形

一立三角體之形不一而皆有三角三邊

非四面不能成體故立三角必四面非三角三邊不能成面故立三角體之面皆三角三邊

約舉其類有四面相等者卽四等面形也【其面冪等其稜之長短亦等】

有三面相等而一面不等者其不等之一面必三邊俱等餘三稜則自相等

【以上皆形也四等面任以一面爲底其雉尖正立居中三等面形以等邊之一面爲底錐尖亦正立居中】有二面兩兩相等者

有二面相等餘二面不等者

有四面各不相等者

有三面非句股而一面成句股者有兩面成句股者【其句股或等或否】

有四面並句股者句股立錐也

【以上不皆正形而皆爲有法之形】

一立三角形有實體有虛體

實者如臺如墖如堤虛者如井如池又如隔水測物皆自其物之平面角作直綫至人目卽成虛立錐體以人目爲其頂鋭而所測平面則其底也所作直綫皆爲其稜若所測平面爲四邊五邊以上皆可作對角綫分爲立三角錐形【虛體實體並同一法】

立三角又有三平面一弧面者如自地心作三直綫至星宿所居之度則此三星之相距皆弧度也三弧度爲邊卽成弧三角形以爲之底其三直綫皆大員半徑以爲之稜而合於地心以爲之頂鋭亦立三角之虛形【卽弧三角錐體】

若於渾球體作三大圏相交成弧三角形從三角作直綫至員心依此析之卽成實體與上法並同一理

一立三角形有立有眠有倒有倚立者以底平安則其鋭尖上指如人之立

眠者以底側立如堵墻而錐形反橫如人之眠此惟正形之錐則有之【旣定一面爲底則底在下者爲立在旁者爲眠】如虛形則不拘正斜皆以所測爲底

又如弧三角錐以渾員面上所成之弧三角爲底以三直綫輳於渾體之心爲其頂鋭則四面八方皆可爲底而鋭常在心不特能眠能立亦且能倒能欹【亦惟有底有鋭之正形則然若他形底無定名隨人所置】眠體倒體以及他形之欹側不同而皆爲有法之形者三角故也

一古法有壍堵陽馬鱉臑芻甍等法皆可以立三角處之【壍堵一作塹堵】

凡立方體從其面之一稜依對角斜綫剖至其底相對之一稜則其積平分而成壍堵形

【甲乙爲頂有袤無廣丙丁戊己爲方底或長方則丙丁同巳戊爲袤丁己仝丙戊爲廣乙丙同甲丁爲其髙甲丁乙丙爲立面甲乙戊己爲斜面皆長方乙丙戊同甲丁巳爲兩端立面皆句股形而相對相等】

【壍堵形有如屋者甲乙頂袤如屋脊甲乙丙丁及甲乙戊巳兩長方皆斜面而相等丙丁戊己爲底乙丙戊與甲巳丁兩圭形相對而等而以乙辛爲其髙其辛丙及辛戊俱平分而等】

【又或甲乙頂袤不居正中而近一邊然甲乙與丁丙及巳戊俱平行而等其甲丁乙丙及甲巳乙戊兩斜面𨿽有大小而並爲長方形乙辛垂綫不能分丙辛及辛戊爲平分而必與丙戊底爲十字正角則乙辛爲正髙】

以上三者皆壍堵之正形並以髙乘底折半見積何也皆立方之半體其兩端皆立三角形也【第一形兩端爲句股第二第三皆以乙辛中剖成兩句股】

凡壍堵形亦可立可眠立者以甲乙爲頂長丙丁戊己爲底眠者以戊己爲頂長反以甲乙丙丁爲底如隔水測懸崖之類

【又有斜壍堵形其各綫不必平行底不必正方但俱直綫則底與兩斜面皆可作對角綫以分爲三角形而諸數可測實體虛體並有之於測量之用尢多】

斜壍堵本爲無法之形而亦能爲有法之形者可析之成三角也

凡壍堵形從頂上一角依對角綫斜剖之爲兩則成一立方錐一句股錐

【塹堵形從乙角作乙巳乙丁兩對角綫依綫剖之則成兩形】

【立方錐一

句股錐一】

【名陽馬

名鱉臑】

陽馬形【以丙丁戊己方形爲底以乙爲頂鋭而偏居一角故乙丙直立如垂綫以爲之髙其四立面皆成句股形故又名句股立方錐】

論曰陽馬形從壍堵第一正形而分故其髙綫直立於一隅乃立方之楞綫四面句股形因此而成是爲句股方錐之正體若斜壍堵等形之分形則但可爲斜立方錐而不得爲句股方錐亦非陽馬

【斜立方錐者其頂不居正中然又不能正立一隅故非句股立錐而但爲斜立方錐如上二形頂旣偏側底亦非方亦斜立錐形也然其立面皆三角故亦爲有法之形斜立方錐亦可立可眠皆可以立三角法禦之但不如句股立方錐之有一定比例】

鱉臑形【以甲乙爲上袤而無廣以丁巳爲下廣而無袤故稱鱉臑象形也其各面或句股或不爲句股而皆三角故又名三角錐】

句股立錐形【其上有袤而無廣下有廣而無袤並同鱉臑所異者甲角正方故乙甲丁立面乙甲巳斜面並成句股又丁角正方故甲丁已平面乙丁巳斜面並成句股又丁角正方故甲丁巳平面乙丁巳斜面並成句股是四面皆句股也故謂之句股方錐而不得僅名鱉臑】

論曰鱉臑中有句股立錐猶斜立方錐中之有句股方雉也立三角皆有法之形而此二者尢可以明測量比例之理

又論曰立三角所以爲有法形者謂其可施八綫也而八綫原爲句股之比例此二者旣通體皆句股所成故在有法形中尢爲有法矣

又論曰若於句股方錐再剖之卽又成二句股錐而皆等積故陽馬爲立方三之一句股錐則爲六之一皆立方之分體也

又論曰句股方錐及句股錐皆生於塹堵故塹堵形爲測量之綱要

【芻薨形亦如屋而兩端漸殺故頂窄而底寛其丙丁戊己底或正方或長方甲乙頂小於丙丁或居正中或稍偏然皆與丙丁及戊己平行】

芻甍蓋取艸屋之象乃壍堵形之一種亦可分爲三鱉臑

又有芻童者形如方臺皆立方之變體方臺面與底俱正方蒭童則長方而面小底大則同亦皆可分爲立三角

凖前論方臺作對角綫並可爲兩芻甍卽可再分爲六鱉臑卽皆立三角錐也

論曰量面者必始於三角量體者必始於鱉臑皆有法之形也量面者析之至三角而止再析之仍三角耳量體者析之至鱉臑而止再析之仍鱉臑耳面之可以析爲三角者卽爲有法之面體之可以析之爲鱉臑者卽爲有法之體蓋鱉臑卽立三角之異名也量體者必以立三角非是則不可得而量

算法

凡算立三角體須求其正髙以正髙乘底以三而一見積其法有三其一頂居一角其稜直立卽用爲正髙其二頂鋭不居一角而在三角之間其三頂斜出底三邊之外並以法求其垂綫爲正髙

假如巳甲乙丙立三角體甲乙丙爲底已爲頂鋭正居丙角之上巳丙如垂綫爲髙先以乙丙五十六尺甲乙邊【六十一尺】甲丙邊【七十五尺】求

其羃積【一千六百三十尺】以乘已丙髙【四十尺】得【六萬七千二百尺】爲實以三爲法除之得【二萬二千四百尺】爲立三角錐體若欲知已乙甲已兩斜依句股求卽得【已丙旣直立則恆爲股以股自乘冪加乙丙句冪爲冪開方得已乙又以股冪加甲丙句冪爲冪開方得甲乙】若已頂不居一角而在三角之中則已丙非正髙乃斜稜也法當分爲兩形其法依丙已稜直剖至底

以上二形乃中剖爲二之象其中剖之立

面亦成丁已丙三角形如平三角法求得已戊垂綫卽爲正髙如上法先求甲乙丙羃以乘已戊髙得數爲實三除見積

又法不必剖形但於形外任依一楞如丙已於庚作垂綫至丙以法取庚防與已頂平行卽庚丙爲正髙與己戊等【或量得庚已橫距爲句以己丙爲求其股卽得庚丙正髙亦同】

立三角之頂有斜出者或在底外則於已頂作垂綫至庚與甲乙丙底平行乃任用相近一稜如己乙爲量庚乙之距爲句依法求其股得己庚爲其正髙以乘底三除見積

問己頂旣居形外己庚何以得爲正髙也曰此易知也但補作甲庚虛綫成四邊形爲底則爲四稜立錐而己庚爲其正髙甲乙丙底乃其底之分也亦必以己庚爲正髙矣

假如乙庚丙甲爲底丙甲與乙庚等丙乙與甲庚等或斜方或正方其己庚一稜正立如垂則卽爲正髙正髙乘方底三除之卽體積也若從甲乙對角綫分其底爲均

半又依甲己甲乙二稜從頂直剖之至底則分爲兩三角形而各得其積之半矣【底旣平分爲兩則其積亦平分爲兩】其己庚乙甲形與己甲乙丙形旣皆半積則相等而庚乙甲底與甲乙丙底又等則其髙亦等而己庚乙甲形旣以己庚爲髙矣則己甲乙丙形之髙非己庚而何又論曰量體積者必先知面猶量面冪者必先知綫也然則量體者亦先知綫矣是故量體之法可轉用之以求綫也【量體者有先知之面冪有求而得之面冪夫求之而得面者必先求其面冪之界界卽綫也故量體之法可用之以求綫也】何謂以量體之法求綫曰測量是也前論立三角有虛體爲測量之用夫虛體者無體者無體而有綫如實體之有稜故可以量體之法求之也如所測之物有三防卽成三邊三角當以三直綫測之則立三角錐形矣所測有四防當以四直綫測之則四稜立錐形矣兩測則又爲塹堵形矣故測量之法可以求綫也

又論曰用立三角以量體者所用者仍平三角也而用三角以量面者所用者仍句股也吾防是而知聖人立法之精深廣大

渾圜內容立三角體法

全形爲塹堵

分形爲鼈臑卽立三角體又爲句股

立錐西法所用

若內切小塹堵則爲圜容方直形卽

郭太史弧矢法

先解全形塹堵體

亢戊乙夘爲塹堵斜面其形長方

夘乙爲渾圜半徑【夘爲渾圜之心】亢戊爲四十五度切綫與夘乙同度同爲橫邊亢夘爲乙角割綫與戊乙同度同爲直邊

亢氐戊丁爲塹堵立面其形橫長方

亢氐者乙角切綫也與戊丁同度以爲之髙亢戊及氐丁皆四十五度切綫與半徑同度以爲之濶

亢氐夘戊丁乙皆塹堵兩和之墻其形皆立句股氐夘同丁乙皆半徑爲句亢氐同戊丁皆乙角切綫爲股亢夘同戊乙皆乙角割綫爲

夘乙丁氐爲塹堵之底其形正方

夘乙及夘氐皆渾圜半徑其對邊悉同

法曰先爲立方體以容渾球使北極在上南極在下皆正切於立方底蓋之中心則赤道平安而赤道之二分二至亦皆在立方四面之中心矣

次依赤道橫剖方體爲均半而用其上半爲半立方容半渾圜形則二分二至皆在半立方之底綫各中心而赤道全圈居其底

次依二分二至從北極十字剖之又成四小立方各得原立方八之一而小立方內各容渾圜分體八之一此小立方有一角之楞直立爲北極之軸上爲北極下卽渾圜心夘角也其立方根皆渾圜半徑

次依黃赤道大距取切綫爲髙作橫綫於小立方夏至之一邊卽亢戊綫

次依亢戊橫綫斜剖至對邊之足則成塹堵矣【對邊之足卽夘乙也本爲黃赤道半徑今在小立方體爲方底之邊故云足也】

塹堵體有五面其一斜面【亢戊乙夘長方】其三立面【一亢氐戊丁長方二亢氐夘戊丁乙相等兩句股】其一方底【夘乙氐丁平方】

塹堵形面有赤道象弧在方底有黃赤大距弧在立句股邊卽兩和之墻

底形

底形正方其夘角卽黃赤道心

氐甲乙爲赤道一象限乙爲春分

氐爲夏至赤道夘氐及夘乙皆

赤道半徑其對邊氐丁及乙丁皆

四十五度切綫

立句股面形一

立句股之面有二【一亢氐夘一戊丁乙】皆同角

同邊亢氐夘形內有氐癸弧爲夏

至黃赤大距二十三度半彊氐夘

爲赤道半徑癸夘爲黃道半徑

夘角爲黃赤大距角【氐癸弧之角】亢氐

者氐癸弧之切綫【亦卽夘角切綫】亢夘者

氐癸弧之割綫【亦卽夘角割綫】

癸弧之割綫【亦卽夘角割綫】

立句股面形二戊乙丁形卽前圖亢氐夘形之對面

戊丁髙同亢氐切綫【如股】戊乙斜

綫同亢夘割綫【如】丁乙橫綫同氐

夘【如句】乙角同夘角

又有黃道象弧在斜面

斜面形

斜面形長方【其斜立之勢依黃道】其夘角爲

黃道心【卽赤道心】乙丙癸爲黃道一象

限乙爲春分【與赤道同用】癸爲黃道

夏至夘癸及夘乙皆黃道半徑【內夘

乙與赤道同用】亢夘爲二十三度半彊之

割綫【夏至黃赤大距割綫】其相對戊乙邊與亢夘割綫同度亢戊邊與夘乙半徑相對同度乃四十五度之切綫【與底上切綫氐丁相應】

立面形

立面形亦長方其勢直立亢戊及

氐丁二邊爲其濶皆四十五度切綫

與半徑同度亢氐及戊丁爲其髙

皆二十三度半之切綫【夏至黃赤大距切綫】以亢戊邊庋起斜面之亢戊邊而成

角體仍以氐丁邊聯於方底之氐丁

邊則其形直立矣

次解分形立三角體【古謂鼈臑卽句股錐】

內含乙甲丙弧三角形及乙甲丙夘弧三角錐

夘爲渾圜心【黃赤同用】夘乙渾圜半徑【黃赤同用】乙丙弧爲黃道經度丙夘爲黃道半徑乙甲弧爲赤道經度甲夘爲赤道半徑丙甲弧爲黃赤距緯乙爲春

分防酉乙未角爲春分角二十三度半與二至大距之緯度相應此角不動丙爲所設黃道度距春分後之防此防移則丙之交角變而諸數皆從之而變法曰於前圖全形塹堵斜面黃道象弧內尋所設黃道經度自春分【乙】起數設度至丙從丙向圜心夘作丙夘半徑遂依半徑引長至塹堵之邊【酉】成酉夘直綫依酉夘直綫直剖至底【未夘綫爲底酉未綫爲邊】成酉未乙夘立三角體此立三角體有四面而皆句股故又曰句股立錐立句股之錐尖爲酉

其斜面爲酉乙夘句股形【乙正角乙酉爲股乙夘爲句酉夘爲】其立面二

一爲酉未乙句股形【未正角酉未垂綫爲股未乙爲句酉乙爲】一爲酉未夘句股形【未正角酉未垂綫爲股未夘爲句酉夘爲】

其底爲未乙夘句股形【乙正角未乙爲股乙夘爲句未夘爲】

以上四句股面凡楞綫六

夘乙半徑也酉乙黃道丙乙弧之切綫也而酉夘則其割綫也未乙赤道乙甲弧之切綫也而未夘則其割綫也惟酉未垂綫於八綫無當今名之曰錐尖垂綫亦曰錐尖柱亦曰外綫以其離於渾圜之體也

句股面有四而用者一酉未乙也以其能與乙角之大句股爲比例也

楞綫六而用者二酉乙及未乙也以其爲二道之切綫爲八綫中有定數可爲比例也

第一層句股比例圖

酉未乙句股形以黃道切綫【酉乙】赤道切綫【未乙】相連於乙角【成鋭角】則酉乙爲未乙爲句而戊丁乙及牛昴乙二句股形同在一立面又同用乙角故可以相爲比例術爲以赤道半徑【丁乙】比乙角之割綫【戊乙】若赤道切綫【未乙】與黃道切綫【酉乙】也【此爲以句求】又以黃道半徑【牛乙】比乙角之餘【昴乙】若黃道切綫【酉乙】與赤道切綫【未乙】也【此爲以求句】

解曰丁乙與氐昴同大則皆赤道半徑也戊乙與亢夘同大則皆乙角割綫也牛乙與癸卯同大皆黃道半徑昴乙與己夘同大皆乙角余也從乙窺夘則成一防而乙角夘角合爲一角其角之割綫余盡移於塹堵之第一層而同在一立面爲句若【觀總圖自明】

以赤道求黃道

以黃道求赤道

一赤道半徑

一黃道半徑

二乙角割綫

二乙角余

三赤道切綫

三黃道切綫

四黃道切綫

四赤道切綫

若求角者反用其率

又法

四乙角割綫

四乙角余

第二層句股比例圖

子甲丑句股形以黃赤距度之切綫【子甲】赤道之正【甲醜】相連於甲成正角則子甲爲股甲醜爲句而與坎震醜及女婁醜二句股形同在一立面又同醜角故可相求術爲以赤道半徑【震醜】比乙角之切綫【坎震】若赤道正【甲醜】與距度之切綫【子甲】也【是爲以句求股】又爲以乙角之正【女婁】與乙角余【婁醜】若距度之切綫【子甲】與赤道之正【甲醜】也【是爲以股】

【求句】

解曰震醜卽氐夘赤道半徑也坎震卽亢氐乙角之切綫也女婁卽癸己而婁丑卽己夘乙角之正余也從乙窺夘則乙丑夘成一防而合爲一角其角之切

綫正余盡移於塹堵第二層立面爲句與股以赤道求距度以距度求赤道又法

一半徑

一乙角正一乙角切綫半徑二乙角切綫二乙角余二半徑

【乙角余切】三赤道正三距度切綫三

距度切綫四距度切綫四赤道正四

赤道正若求角則反用其率

又法

一距道切綫半徑

一赤道正半徑

二赤道正

二距度切綫

三半徑

【距度余切】

三半徑

【赤道余割】

四乙角余切

四乙角切綫

第三層句股比例圖

丙辛壬句股形以距度正【丙辛】黃道正【丙壬】相連於丙而成鋭角則丙壬爲丙辛爲股而與乾艮壬及奎胃壬二句股同在一立面同用壬角故可相求

術爲以黃道半徑【奎壬】比乙角之正【奎胃】若黃道正【丙壬】與距度之正【丙辛】也【是爲以求股】又爲以乙角之切綫【乾艮】比乙角之割綫【幹壬】若距度之正【丙辛】與黃道正【丙壬】也【是爲以股求】

解曰奎壬卽癸夘黃道半徑也奎胃卽癸己距度正也乾艮卽亢氐而幹壬卽亢夘則乙角之切綫割綫也從乙窺夘則乙丑壬夘半徑因直視成一防而合爲

爲一角其角之正切割綫盡移於塹堵之第三層立面以爲爲股

以黃道求距度

以距度求黃道又法

一半徑

一乙角切綫一

乙角正半徑二乙角正二

乙角割綫二

半徑

【乙角余割】三黃道正三

距度正三

距度正四距度正四

黃道正四

黃道正

若求角則反用其率

又法

一距度正半徑

一黃道正半徑

二黃道正

二距度正

三半徑

【距度余割】

三半徑

【黃道余割】

四乙角正割

四乙角正

弧三角錐體【卽割渾圜體之一分】

法曰依前論從丙防對夘直割至底則截黃道於丙截赤道於甲得丙乙及甲乙二弧所剖渾圜之迹又成丙甲弧【爲兩道距緯】三弧相湊成丙甲乙弧三角面丙夘甲夘乙夘同爲半徑三半徑爲楞輳於夘心夘爲三角之尖乙甲丙弧三角面爲底成乙甲丙夘弧三角錐體爲割渾圜體之一分也

此弧三角錐體含於句股立錐體內凖前論可以明之因此弧三角錐與句股錐同鋭【夘尖】異底【一以弧三角面爲底一以句股平面爲底】故以弧三角變爲句股以求其比例而有三法【卽前條所論三層句股】

其一爲酉未乙句股形

用酉乙【爲黃道丙乙弧切綫】未乙句【爲赤道乙甲弧切綫】以當乙角之與句

其一爲子甲丑句股形

用子甲股【爲距度丙甲弧切綫】甲醜句【爲赤道乙甲弧正】以當乙角之股與句

其一爲丙辛壬句股形

用丙辛股【爲距度丙甲弧在】丙壬【爲黃道丙乙弧正】以當乙角之股與

問兩弧求一弧非句股錐乎與此所用同耶異耶曰形不異也乃法異耳何言乎法異曰句股錐一也而有用角不用角之殊此用角度其句股在錐形之底【以夘心爲錐形之鋭則三層句股皆爲其底】而遙對渾體之心以視法成比例兩弧求一弧不用角度其句股同在錐形之一面無假視法自成比例所以不同然其爲句股之比例一而已矣然則兩弧求一弧惟用割綫余此所用者惟正切綫又何不同若是耶曰角之句股在心【如夘亢氐等形皆依極至交圏平剖渾圜成平面其象始著是在渾圜之心】與爲比例之句股在面【如酉未乙等形皆以一角連於渾圜之面】二者相離以視法相疊如一平面然惟正切綫能與之平行【從凸面平視則設度之正切綫皆與渾圜中割之平面諸綫平行】若割綫余皆非平行因視法而躋縮失其本象【或斜對則長綫成短綫或對視則直綫成一防】不能爲比例無所用之矣若兩弧求一弧則其句股自相垜疊於一平面【平立斜三面各具三句股而如相垜疊並以一大句股橫截成三】皆以本數自相爲比例全不闗於視法故無躋縮而其算皆割綫余所成於正切綫反無所取所以不同若以量體之法言之割綫余爲量立楞斜楞之法正切綫則量底之法也【兩弧求一弧法見二卷】

如圖以卯爲句股立

錐之頂卯乙爲直立之

楞如渾圓半徑夘未夘

酉爲斜面之楞並如割

綫酉乙未乙兩底綫並如

切綫若依底綫平截之成

大小三形則比例見矣

剖渾圜用余度法

乙丙黃道弧在四十五

度以上求甲乙赤道弧

【卽同升度】

依前法半徑【癸卯亦卽庚乙】與乙角【春分】之餘【乙壬亦卽

卯己】若乙丙【黃道】之切綫【尾乙】與乙甲【赤道】之切綫【箕乙】

此法無誤但如此則兩切綫大於塹堵須引之於形外是以小比例例大比例也若至八十度切綫太大不可作圖矣

今攺用余度法自卯渾圜心遇黃道設弧丙作綫至酉【剖至底】

以乙丙黃道之餘弧癸丙取其切綫於斜面如癸斗又以乙甲赤道之餘弧甲氐取其切綫於底如氐

未卽以氐未移至斜面之楞如亢酉變立句股【尾箕乙】爲平斜句股【酉亢卯及斗癸卯兩形皆相似】法爲半徑【癸卯】與乙角之正割綫【乙角卽卯角其割綫戊乙亦卽卯亢】若乙丙黃道之餘切綫【癸斗】與乙甲赤道之餘切綫也【亢酉亦卽氐未】

按此法從亢戊邊剖塹堵成句股方錐之眠體

其剖形以亢氐酉未長方形爲底以卯爲錐尖以斜面之卯亢酉句股形及平面之卯氐未句股形爲相對之二邊又以卯氐亢之立面句股形及卯未酉之斜立面句股形爲相對之二邊其四面皆句股其底長方而以卯爲尖故曰眠形

不直曰方錐者以面皆句股而卯氐綫正立故不得僅云陽馬謂之句股方錐可也亦如句股錐立三角不得僅謂鼈臑

塹堵測量二

句股錐形序【卽兩弧求一弧】

正弧三角之法卽郭太史側視圖也郭法以側視取立句股又以平視取平句股故有圓容方直之法而不須用角西法専以側視之圖爲用故必用角用角卽用弧也惟其用角故所用者皆側立之句股也余此法則兼用平立斜三種句股而其大小句股之比例並在一平面尢爲明白易見而不更言角旣與授時之法相通其兼用割綫起算春分又西曆之理也蓋義取適用原無中外之殊笇不違天自有源流之合敬存此稿以質方來其授時歷側視平視之圖詳具別捲

正弧三邊形以兩弧求一弧法【句股錐形之理】

用割綫余以弧度求弧度而不言角其理與郭法相通

丙甲乙三角弧形甲爲正角

卯爲渾員心丙乙爲黃道距春分之

一弧甲乙爲赤道同升之弧丙甲爲

黃赤距度【卽過極圈之一弧】丙卯爲黃道半

徑甲卯爲赤道半徑卯乙爲黃赤兩

道之半徑壬卯爲丙乙黃道之餘【以丙壬爲其正故】丑卯爲甲乙赤道之餘【以甲醜爲其正故】辛卯爲丙甲距度之餘【以丙辛爲其正故】子卯爲丙甲割綫【以子甲爲切綫知之】酉卯爲丙乙割綫【以酉乙爲切綫如之】未卯爲甲乙割綫【以未乙爲切綫知之】

斜面酉乙卯及子丑卯及丙壬卯皆句股形乙丑壬皆正角又同用卯角角之弧爲丙乙黃道平面未乙卯及甲丑卯及辛壬卯皆句股形乙丑壬皆正角又同用卯角角之弧爲甲乙赤道立面酉未卯及子甲卯及丙辛卯皆句股形未甲辛皆正角又同用卯角角之弧爲丙甲距度【其又一立面酉未乙及子甲丑及丙辛壬三句股形爲切綫正所作玆不論】論曰因諸綫成平面句股形爲底兩立面句股形爲墻斜面句股形爲面則四面皆句股形矣而酉未聯綫及子甲切綫丙辛正皆直立上對天頂下指地心故謂之句股錐形也旣成句股則其相等之比例可以相求用法

半徑與赤道之餘若黃道之割綫與距度之割綫

反之則赤道余與半徑若距度割綫與黃道割綫一甲乙余丑卯小句二

半徑

乙卯大句三丙甲割綫子卯小四

丙乙割綫酉卯大又更之則黃道割綫與半徑若距度割綫與赤道余一丙乙割綫酉卯大二

半徑

乙卯大句三丙甲割綫子卯小四

甲乙余丑卯小句右取斜面酉乙卯子丑卯兩句股形以乙卯半徑爲比例偕一餘兩割綫而成四率

半徑與距度之割綫若黃道之餘與赤道之餘一半徑

丙卯小二

丙甲割綫子卯大三丙乙余壬卯小句四

甲乙余丑卯大句反之則距度割綫與半徑若赤道余與黃道余一丙甲割綫子卯大二

半徑

丙卯小三甲乙余丑卯大句四

丙乙余壬卯小句又更之則黃道余與半徑若赤道余與距度割綫一丙乙余壬卯小句二

半徑

丙卯小三甲乙余丑卯大句四

丙甲割綫子卯大右取斜面丙壬卯子丑卯二句股形以丙卯半徑偕一割綫兩余而成四率

半徑與赤道割綫若距度割綫與黃道割綫

更之則赤道割綫與半徑若黃道割綫與距度割綫一甲乙割綫未卯大句二

半徑

甲卯小句三丙乙割綫酉卯大四

丙甲割綫子卯小又更之則距度割綫與半徑若黃道割綫與赤道割綫一丙甲割綫子卯小二

半徑

甲卯小句三丙乙割綫酉卯大四

甲乙割綫未卯大句右取立面酉未卯子甲卯二句股形以甲卯半徑偕三割綫而成四率

半徑與黃道余若赤道割綫與距弧余

一半徑

乙卯大句二

丙乙余壬卯小句三甲乙割綫未卯大四

丙甲余辛卯小更之則黃道余與半徑若距弧余與赤道割綫一丙乙余壬卯小句二

半徑

乙卯大句三丙甲余辛卯小四

甲乙割綫未卯大又更之則赤道割綫與半徑若距弧余與黃道余一甲乙割綫未卯大二

半徑

乙卯大句三丙甲余辛卯小四

丙乙余壬卯小句右取平面未乙卯辛壬卯二句股形以乙卯半徑偕兩余一割綫而成四率

半徑與距度余若赤道余與黃道余

更之則距度余與半徑若黃道余與赤道余一丙甲余辛卯小二

半徑

甲卯大三丙乙余壬卯小句四

甲乙余丑卯大句又更之則赤道余與半徑若黃道余與距度余一甲乙余

丑卯大句二

半徑

甲卯大三丙乙余

壬卯小句四

丙甲余辛卯小右取平面【甲丑卯辛壬卯】二句股以甲卯半徑偕三餘而成四率

半徑與黃道割綫若距弧余與赤道割綫

更之則黃道割綫與半徑若赤道割綫與距弧余一丙乙割綫酉卯大二

半徑

丙卯小三甲乙割綫未卯大句四

丙甲余辛卯小句又更之則距弧余與半徑若赤道割綫與黃道割綫一丙甲余辛卯小句二

半徑

丙卯小三甲乙割綫未卯大句四

丙乙割綫酉卯大右取立面酉未卯丙辛卯二句股形以丙卯半徑偕兩割綫一餘而成四率

作立三角儀法【卽句股錐形】

法以堅楮依各綫畫成句股而折輳之則各綫之在渾員者具可覩矣任取黃道之一弧爲例則各弧並同

底上甲乙弧赤道同升度

也赤道各綫俱在平面爲

底面上丙乙弧黃道度也

黃道各綫俱在斜面立面

丙甲弧度黃赤距緯也距

緯各綫俱在立面外立面爲黃赤兩切綫之界論曰此卽郭若思太史員容方直之理也太史法從二至起算先求大立句股依距至黃道度取其正半爲界直切至赤道平面截黃赤道兩半徑成小立句股以此爲法求得平面大句股則赤道之正半也其直切兩端下垂之迹在二至半徑者旣成小立句股其在所求本度者又成斜立句股此斜立句股之股則本度黃赤距度之正半也於是直切之迹有黃道正半爲其上下之橫長有黃赤距度之正半爲兩端之直濶成直立之長方形而在渾體之中故曰弧容直濶也此側立長方之四角各有黃赤道之徑爲其楞以直湊渾體之心成眠體之句股方錐句股方錐者底𨿽方而錐尖偏在一楞則其四面皆成句股此郭太史之法也今用八綫之法以句股禦渾體其意略同但其法主於用角故從二分起算遂成立句股錐形立句股錐形亦可以卯心爲錐尖是爲眠體錐形如此則兩錐形之尖皆在員心【一郭法一今法】而可通爲一法是故用郭太史法則以句股方錐爲主而句股錐形其餘度所成之餘形今以句股錐形爲主則員容直濶所成句股方錐又爲余度余形矣然則此兩法者不惟不相違而且足以相法古人可作固有相視而笑莫逆於心者矣余竊怪夫世之學者入主出奴不能得古人之深而輕肆詆訶者皆是也吾安得好學深思其人與之上下其議哉

句股方錐序

塹堵虛形以測渾員原有二法一爲句股錐形一爲句股方錐其句股錐之法向有法方錐之法亦略見於諸篇而未暢厥防故復著之其法以弧求弧而不求角與句股錐同而起算二至則郭太史本法矣方錐與錐形互相爲正余故亦可以算距分之度也

算黃赤道及其距緯以兩弧求一弧又法【用句股方錐形亦塹堵形之分】以八綫法立算起數二至本郭法史員容方直之理而稍廣其用亦不言角

如圖癸爲二至黃道癸丙爲

距至黃道之一弧【如所設】氐爲

二至赤道氐甲爲距至赤道

之一弧【與癸丙黃道相應】癸氐爲二

至黃赤大距弧【二十三度半彊】丙甲

爲所設各度之黃赤距緯【卽過極圈之一弧】卯爲渾圓心黃道癸丙之正丙張余張卯正矢癸張切綫癸斗割綫斗卯

赤道氐甲之正甲庚余庚卯正矢氐庚切綫氐室割綫室卯

大距度癸氐之正癸己余己卯正矢氐己切綫氐亢割綫亢卯

距緯丙甲之正丙辛余辛卯正矢甲辛切綫甲子割綫子卯

論曰因諸綫成各句股形爲句股方錐之面其鋭尖皆防於卯心又成方直形以爲之底遂成句股方錐之眠體

一斜平面有黃道弧諸綫成句股形二【一丙張卯一斗癸卯】又有相應之赤道諸綫亦成句股形二【一壁亢卯一子房卯】四者皆形相似而比例等

一平面有赤道弧諸綫成句股二【一甲庚卯一室氐卯】又有相應之黃道諸綫亦成句股二【一辛井卯一亥己卯】四者皆形相似而比例等

一立面有大距弧諸綫成句股二【一癸己卯一亢氐卯】又有相對之距緯諸綫亦成句股二【一張井卯一房庚卯】四者皆形相似而比例等

一斜立面有黃赤距度諸綫成句股二【一丙辛卯一子甲卯】又有相對之大距度諸綫亦成句股二【一斗亥卯一壁室卯】四者皆形相似而比例等

論曰斜平面平面立面斜立面各具四句股而並爲相似之形者皆以一大句股截之成四也其股與並原綫而所截之句又平行其比例不得不等

一內外兩方直形【一在渾員形內卽郭法所用乃黃道及距緯兩正所成一在渾員形外乃赤道及大距兩切綫所成】有平立諸綫爲各相似相連句股形之句亦卽爲相似兩方錐之底而比例等

一不內不外兩方直形【一跨黃道內外乃赤道正及距緯切綫所成一跨赤道內外乃黃道切綫及大距正所成】有平立諸綫爲各相似相連句股形之句亦卽爲相似兩方錐之底而比例等

論曰方錐眠體以平行之底橫截之【卽四種方直形皆方錐之底】成大小四方錐其錐體之頂鋭【卯】與其四稜皆不動所截之底又平行故其比例相似而等

又論曰黃道在斜平面赤道在平面而其綫互居者以方直形故也大距度在立面距緯度在斜立面而其綫畢具者亦以方直形故也蓋形旣方直則橫綫直綫兩兩相對而等

用法

斜平面比例

黃道半徑與黃道正若距緯割綫與赤道正

更之黃道正與黃道半徑若赤道正與距緯割綫

一丙張小股二丙卯小三子房大股四子卯大又更之距緯割綫與黃道半徑若赤道正與黃道正

一子卯大二丙卯小三子房大股四丙張小股右取斜平面張丙卯房子卯二句股形以丙卯半徑偕一割綫兩正而成四率

黃道半徑與黃道切綫若大距割綫與赤道切綫

更之黃道切綫與黃道半徑若赤道切綫與大距割綫一癸斗小股二癸卯小句三亢壁大股四亢卯大句又更之大距割綫與黃道半徑若赤道切綫與黃道切綫一亢卯大句二癸卯小句三亢壁大股四癸斗小股右取斜平面斗癸卯壁亢卯二句股形以癸卯半徑偕一割綫兩切綫而成四率

平面比例

赤道半徑與赤道正若距緯余與黃道正

更之赤道正與赤道半徑若黃道正與距緯余一甲庚大股二甲卯大三辛井小股四辛卯小又更之距緯余與赤道半徑若黃道正與赤道正

一辛卯小二甲卯大三辛井小股四庚甲大股右取平面井辛卯庚甲卯二句股形以甲卯半徑偕一餘兩正而成四率

赤道半徑與赤道切綫若大距余與黃道切綫

更之赤道切綫與赤道半徑若黃道切綫與大距余一氐室大股二氐卯大句三己亥小股四己卯小句又更之大距余與赤道半徑若黃道切與赤赤道切綫一己卯小句二氐卯大句三己亥小股四氐室大股右取平面亥己卯室氐卯二句股形以氐卯半徑偕一餘兩切綫而成四率

立面比例

黃道半徑與大距正若黃道余與距緯正

更之大距正與黃道半徑若距緯正與黃道余一癸己大股二癸卯大三張井小股四張卯小又更之黃道余與黃道半徑若距緯正與大距正

一張卯小二癸卯大三張井小股四癸己大股右取立面己癸卯井張卯二句股形以癸卯半徑偕一餘兩正而成四率

赤道半徑與大距切綫若赤道余與距緯切綫

更之大距切綫與赤道半徑若距緯切綫與赤道余一氐亢大股二氐卯大句三庚房小股四庚卯小句又更之赤道余與赤道半徑若距緯切綫與大距切綫一庚卯小句二氐卯大句三庚房小股四氐亢大股右取立面房庚卯亢氐卯二句股形以氐卯半徑偕一餘兩切綫而成四率

斜立面比例

黃道半徑與距緯正若黃道割綫與大距正

更之距緯正與黃道半徑若大距正與黃道割綫一丙辛小股二丙卯小三斗亥大股四斗卯大又更之黃道割綫與黃道半徑若大距正與距緯正

一斗卯大二丙卯小三斗亥大股四丙辛小股右取斜立面辛丙卯亥斗卯二句股形以丙卯半徑偕一割綫兩正而成四率

赤道半徑與距緯切綫若赤道割綫與大距切綫

更之距緯切綫與赤道半徑若大距切綫與赤道割綫一甲子小股二甲卯小句三室壁大股四室卯大句又更之赤道割綫與赤道半徑若大距切綫與距緯切綫

一室卯大句二甲卯小句三室壁大股四甲子小股右取斜立面子甲卯壁室卯二句股形以甲卯半徑偕一割綫兩切綫而成四率

以上方錐形之四面每面有大小四句股形卽各成四率比例者六合之則二十有四並以兩弧求一弧而不言角

方直形比例

黃道正與距緯正若赤道切綫與大距切綫

更之距緯正與黃道正若大距切綫與赤道切綫一張井小股二井辛小句三亢氐大股四氐室大句又更之赤道切綫與大距切綫若黃道正與距緯正

一氐室大句二亢氐大股三井辛小句四張井小股再更之大距切綫與赤道切綫若距緯正與黃道正

一亢氐大股二氐室大句三張井小股四井辛小句右取渾體內所容方直形上黃道及距緯兩正偕渾體外所作方直形上赤道及大距兩切綫而成四率

赤道正與距緯切綫若黃道切綫與大距正

更之距綫切綫與赤道正若大距正與黃道切綫一房庚小股二庚甲小句三癸己大股四己亥大股又更之黃道切綫與大距正若赤道正與距緯切綫

一己亥大句二癸己大股三庚甲小句四房庚小股再更之大距正與黃道切綫若距緯切綫與赤道正一癸己大股二己亥大句三房庚小股四庚甲小句右取方直形上黃道切綫大距正偕又一方直形上赤道正距緯切綫而成四率

以上大小方錐形之底各成方直形而兩兩相偕卽各成四率比例者四合之則八並以三弧求一弧而不言角

凡句股方錐形所成之四率比例共三十有二皆不言角內四率中有半徑者二十四並兩弧求一弧四率中無半徑者八以三弧求一弧其不言角則同

問各面之句股形並以形相似而成比例若方直形所用皆各形之大小句然不同居一面又非相似之形何以得相爲比例曰句股形一居平面一居立面而能相比例者以有稜綫爲之作合也何以言之如亢卯割綫爲方錐形之一稜而此綫旣爲斜平面句股形【壁亢卯】之股又卽爲立面句股形【氐亢卯】之故其比例在斜平面爲亢卯與張卯若亢壁與張丙也而在立面爲亢卯與張卯若亢氐與張井也合而言之則亢壁與張丙亦若亢氐卯與張井餘仿此

問此以方直相比非句股本法矣曰亦句股也試平置方錐【以方底著地使卯鋭直指天頂而卯氐稜綫正立如垂】而從其卯頂俯視之則卯井庚己氐稜綫上分段之界因對視而成一防亢卯稜綫與亢氐綫相疉室卯綫與室氐相疊皆脗合爲一惟亢壁室氐直形因平視而得正形其壁卯稜綫則成壁氐而斜界於對角分直方形爲兩句股形矣又其分截之三方直形亦以平視得正形亦各以稜綫分爲兩句股而大小相疉成相似之形而比例等矣

如圖亢氐室壁長方以壁氐

綫成兩句股而張井辛丙長

方【卽張氐辛丙】亦以丙卯綫【卽丙井亦

卽丙氐】成兩句股並形相似則

亢壁與張丙若亢氐與張井【張井卽張氐】

又癸己亥斗長方【卽癸氐亥斗】以斗卯綫【卽斗己又卽斗氐】成兩句股而房庚甲子長方【卽房氐甲子】亦以子卯綫【卽子庚又卽子氐】成兩句股而形相似則癸斗與房子若癸己與房庚【癸己與房庚卽癸氐與房氐】

展形【展之成四句股面一方直底】

合形【合之則成句股方錐】

作方直儀法【卽句股立方錐】

法以堅楮依黃赤大距二十三度半畫成立面再任設赤道距至度畫成平面再依法畫距緯斜立面及黃道距至度斜平面並方直底然後依稜折輳卽渾員上各綫相爲比例之故了然共見

任指黃道或赤道之距至一弧爲式卽各弧可知其所用距至弧或在至前或在至後或冬至或夏至並同一理

方塹堵內容員塹堵法

先解方塹堵

塹堵以正方爲底【氐卯丁乙形】其上有

赤道象限【氐幹乙弧乙春分氐夏至】以長方爲

斜面【亢卯戊乙形】其上有黃道象限【癸巽

乙弧乙春分巽夏至】底與而一邊相連【卯乙邊爲

底與斜面所同用故相連乃黃赤道之半徑】一邊相離

【氐丁邊在底與赤道平行亢戊邊在斜面故相離其距爲亢氐爲戊】

【丁皆大距度癸氐弧之切綫】其形似斧

從斜面作戊卯對角綫切至底【戊丁卯對角綫於底】分塹堵爲兩則赤道爲兩平分【赤道平分於幹幹乙距春分幹氐距夏至各得四十五度】而黃道爲不平分【黃道分於巽則巽乙距春分四十七度二十九分弱而巽癸距夏至四十二度三十一分彊】於是黃道切綫【戊乙】與大距度割綫【亢卯】等而方塹堵之形以成【亢卯爲大距二十三度三十一分半之割綫其數一○九○六五戊乙爲黃道四十七度二十九分之切綫其數亦一○九○六五兩數旣同故能作長方斜面而成塹堵】乃黃道求赤道用兩切綫之所賴也【若赤道求黃道則反用其率】

法曰自黃道四十七度二十九分以前用正切是立面句股比例【戊丁乙句股比例卽亢氐卯或用癸巳卯皆大句股也其酉未乙則爲小句股】

右黃道求赤道爲以求句

一赤道半徑氐卯

大句

二大距割綫亢卯

大

三赤道切綫未乙【甲乙赤道】小句

四黃道切綫酉乙【丙乙黃道】小

右赤道轉求黃道爲以句求

自黃道四十七度二十九分以後用余切是斜平面句股比例【斜面亢虛卯爲大句股癸斗卯爲小句股在平面則爲氐危卯大句股己心卯小句股】一黃道半徑癸卯小股

二大距割綫亢卯大股

三黃道余切癸斗小句【牛乙黃道其餘弧牛癸】

四赤道余切亢虛大句【女乙赤道其餘弧女氐】

右黃道求赤道爲以股求句

一赤道半徑氐卯

大股

二大距余己卯

小股

三赤道余切危氐【卽亢虛】大句【女氐卽女乙赤道之餘】四黃道余切心己【卽癸斗】小句【牛癸卽牛乙黃道之餘】右以赤道轉求黃道亦爲以股求句

論曰赤道求黃道用句股於赤道平面卽郭太史員容方直之理但郭法起二至則此所謂余弧乃郭法之正弧又郭法只用正而此用切綫爲差別耳

又論曰正切綫法亦可用於半象限以上余切綫亦可用於半象限以下此因方塹堵之底正方則所用切綫至方角而止故各用其所宜【云半象限者主赤道而言若黃道以四十七度二十九分爲斷一平一斜故其比例如與句】

又論曰正切綫法卽句股錐形也余切綫法卽句股方錐也以對角斜綫分塹堵爲兩成此二種錐形遂兼兩法

次解員塹堵

方塹堵內容割渾員之分體以癸牛丙乙黃道爲其斜面之界以氐女甲乙赤道爲其底之界而以癸氐大距弧及牛女丙甲等逐度距弧爲其髙髙之勢曲抱如渾員之分斜面平面皆爲平員四之一【其髙自癸氐大距漸殺至春分乙角而合爲一防】

員塹堵者𨿽亦在方塹堵之內然又在所容割渾員分體之外與割渾員體同底亦以赤道爲界而不同面其面自乙春分過子過奎至亢其形卯乙短而亢卯長如割平撱員面四之一其撱員邊之距心皆以逐度距緯【如丙甲牛女等】之割綫所至爲其界【如卯子爲丙甲距弧割綫卯奎爲牛女距弧割綫之類】而以逐度距緯之切綫爲其髙【如子甲爲丙甲距弧切綫奎女爲牛女距弧切綫之類】

法以赤道爲圍作員柱置渾員在員柱之內對赤道橫剖之則所剖員柱之平員底卽赤道平面也又自夏至依大距二十三度三十分半之切綫爲髙斜對春秋分剖至心則黃道半周在所剖之斜面矣

然黃道半周𨿽在所剖斜面而黃道自爲半平員所剖斜面則爲半撱員黃道平員在撱員內兩端同而中廣異【兩端是二分如乙爲平撱同用之防中廣是夏至如黃道癸在撱面亢之內其距爲癸亢】此員塹堵之全體也

於是又從亢癸對卯心直剖到底則成員塹堵之半體卽方塹堵所容也此員塹堵斜面之髙俱爲其所當距緯弧之切綫渾員上弧三角法以距緯切綫與赤道平面之正相連爲句股而生比例是此形體中所具之理

此塹堵體與前圖同惟多一亢奎子乙撱弧以此爲撱員界立剖至底令各度俱至赤道而去其外方則成員塹堵眞體

此員塹堵爲用子甲丑句股形之所賴子甲爲距弧切綫甲醜爲赤道正也又子甲如股甲醜如句法爲子甲與甲丑若亢氐與氐卯

前圖爲從心眎邊此爲從邊眎心蓋因欲顯圓塹堵內方直形故爲右觀之象與前圖一理惟多一己庚辛乙撱弧【前圖亢奎子乙撱弧在黃道斜面此圖己庚辛乙撱弧在赤道平面】

員塹堵有二

若自斜面之黃道象限各度直剖至赤道平面亦成員塹堵象限然又在剖渾員體分之內其體以斜面爲正象限但斜立耳其底在赤道者轉成撱員

此撱員形在赤道象限之內惟乙點相連此卽簡平儀之理

其撱之法則以卯乙半徑爲大徑癸氐距弧之餘卯巳爲小徑小徑當二至大徑當二分與前法正相反然其比例等何也割綫與全數若全數與余也

此員塹堵以撱形爲底象限爲斜面以距度逐度之正爲其髙乃黃道距緯相求用兩正之所賴也此員塹堵內又容小方塹堵乃郭太史所用員容方直也

渾員因斜剖作角而生比例成方員塹堵形其角自○度一分以至九十度凡五千四百則方員塹堵亦五千四百矣【乙角以春分爲例則其度二十三度半彊其實自一分至九十度並得爲乙角合計之則五千四百】

每一塹堵依度對心剖之成立句股錐及方句股錐之眠體自○度一分至大距止亦五千四百

以五千四百自乘凡二千九百一十六萬而渾員之體之勢乃盡得其比例烏呼至矣

每度分有方塹堵方塹堵內函赤道所生撱體赤道撱體內又函黃道所生撱體黃道撱體內又函小方塹堵每度分有此四者則一象限內爲五千四百者四共二萬一千六百【以乙角五四○○乘之則一一六六四○○○○】

每度有正有餘對心斜分則正度成句股錐余度成方底句股錐之眠體一象限凡四萬三千二百【以五四○○乘之則二三三二八○○○○】

員容方直簡法序

古未有預立算數以盡句股之變者有之自西洋八綫表始古未有作爲儀器以寫渾員內句股之形者自愚所撰立三角始立三角之儀分之曰句股錐形曰句股方錐形合之則成塹堵形其稱名也小其取類也大徑寸之物以狀渾員而弧三角之理如指諸掌卽古法之通於弧三角者亦如指諸掌矣𨿽然猶無解於古法之不用割切也故復作此簡法以互徵之而授時歷三圖附焉蓋理得數而彰數得圖而顯圖得器而眞艸野無諸儀象借玆以自釋其疑不敢自私故以公之同好雲爾【句股錐形是以西法通國法句鈠方錐形是以郭法通西法今此簡法是専解郭法而兩法相同之故自具其中】

員容方直儀簡法【卽句股方錐之方直儀而不用割切綫祗以各弧正矢度相求其用己足亦不須用角】

立面中有句股形二其一大句股形【癸巳乙】以黃道半徑【癸乙】爲大距度正【癸巳】爲股大距度余【巳乙】爲句其一小句股形【壬戊乙】以黃道余【壬乙】爲距緯正【壬戊】爲股楞綫【戊乙】爲句

平面中亦有句股形二其一小句股形【庚戊乙】以距緯丙甲之餘【庚乙】爲以黃道正【戊庚】爲股楞綫【戊乙】爲句其一大句股形【甲辛乙】以赤道半徑【甲乙】爲以赤道正【甲辛】爲股赤道余【辛乙】爲句【戊乙綫於弧度無取然平立二形並得此補成句股謂之楞綫】黃道正本在斜平面而能移於平面者有相望兩立綫【丙庚壬戊】爲之限也距度正本在斜立面而能移於立面者有上下兩橫綫【丙壬庚戊】爲之限也此四綫【兩立兩橫】相得成長方其立

如堵故又曰弧容直濶也

有大距有黃道而求距緯更之可求大距反之可求黃道一半徑

癸乙一

黃道余一

大距正二大距正癸己二

距緯正二

半徑三黃道余壬乙三

半徑

三距緯正四距緯正壬戊四

大距正四

黃道余

有赤道有距緯而求黃道更之可求赤道反之可求距緯一半徑

甲乙一

距緯余一

赤道正二赤道正甲辛二

黃道正二

半徑三距緯余庚乙三

半徑

三黃道正四黃道正庚戊四

赤道正四

距緯余

郭太史本法

弧矢割員圖【見授時歷艸下並同】

凡渾員中割成平員任割平

員之一分成弧矢形皆有弧

背有弧有矢割弧背之形

而半之則有半弧背有半弧

有矢因弧矢生句股形

以半弧爲句【卽正】矢減半

徑之餘爲股【卽余】半徑則常爲句股內又成小句股則有小句小股小而大小可以互求或立或平可以互用【平視側視二圖皆從此出】

側視之圖

橫者爲赤道【赤道一規因旁視如一直綫黃

道同】

斜者爲黃道

因二至黃赤之距成大句股

【卽外圈】

因各度黃赤之距成小句股

平視之圖

外大員爲赤道

內撱者黃道【從兩極平視則黃道在赤道內

而成撱形】

有赤道各度卽各其有半弧

以生大句股

又各有其相當之黃道半弧

以生小句股【此二者皆可互求】

授時歷求黃赤內外度及黃赤道差法

置黃道矢【本法用帶從三乘方求各度矢】去減周天半徑【卽立面黃道半徑】余爲黃赤道小【卽黃道余也半徑爲大故此爲小】置黃赤道小以二至內外半弧【卽二至大距度正當時實測爲二十三度九十分】乘之爲實黃赤大【卽周天半徑以其爲立面大句股之故稱大】爲法除之得黃赤道內外半弧【卽各度黃赤距度正也原法以矢度度半背差加入半弧得內外半弧背今省】

又置黃赤道小以黃赤道大股【卽二至內外度余也在立面大句股形爲大股】乘之爲實黃赤道大爲法除之【解見前】得黃赤道小股【卽立面平面兩小句股同用之楞綫在立面與大股相比故稱小股】置黃道半弧【卽黃道正也原法以黃道矢求半背差減黃道度得之】自乘爲股冪黃赤小股自乘爲句冪【卽楞綫也先在立面爲小句股形之股今又爲平面句股形之句故其冪稱句冪】兩冪並之爲實開平方法除之爲赤道小【卽各度黃赤距度余也周天半徑爲平面上大句股之故稱大則此爲小句股當稱小】置黃道半弧以周天半徑乘之爲實赤道小爲法除之得赤道半弧【卽赤道正也原法求半背差以加半弧得赤道今省】

論曰弧矢割員者平員法也以測渾員則有四用一曰立弧矢勢如張弓以量黃赤道二至內外度卽側立圖也一曰平弧矢形如伏弩以量赤道卽平視圖也一曰斜弧矢與平弧矢同法而平面邊髙邊下其庋起處如二至內外之度以量黃道卽平視圖中小句股也一曰斜立弧矢與立弧矢同法而其立稍偏以量黃赤道各度之內外度卽側立圖中小句股也自離二至一度起至近二分一度止一象限中逐度皆有之但皆小於二至之距邢臺郭太史弧矢平立三圖中具此四法卽弧三角之理無不可通言簡而意盡包舉無窮好古者所當珤愛而翫也

又論曰割員之算始於魏劉徽至劉宋祖衝之父子尢精其術唐宋以算學設科古書猶未盡亡邢臺蓋有所本厥後授時歷承用三百餘年未加修攺測箕之講求益稀學士大夫旣視爲不急之務而臺官株守成法鮮諳厥故驟見西術羣相駭詫而不知舊法中理本相同也疇人子弟多不能自讀其書又忌人之讀而各私其本久之而書亦不可問矣攷元史歷成之後所進之書凡百有餘捲【郭守敬傳有修攺源流及測驗等書齊履謙傳有經串演撰諸書明歷法之所以然】今其存軼並不可攷良可浩嘆然天下之人豈無有能藏弆遺文以待後學者庶幾出以相證予於斯圖之義類多通而深有望於同志矣

問元初有回回歷法與今西法大同小異邢臺蓋防通其說而爲之故其法相通若是與曰九章句股作於首爲測量之根本三代以上學有専家大司徒以三物教民而數居六藝之一秦火以後吾中土失之而彼反存之至於流逺分遂以各名其學而不知其本之同也況東西共戴一天卽同此句股測員之法當其心思所極與理相符𨿽在數萬里不容不合亦其必然者矣攷元初有西域人進萬年曆未經試用迨明洪武年間始命詞臣吳伯宗西域大師馬沙亦黒等譯回回曆書三卷然亦粗具算法立成並不言立法之原究竟不知其所用何法或卽今三角八綫或更有他法俱無可攷𨿽其子孫莫能言之攷元史所載西域人晷影堂諸制與郭法所用簡儀髙表諸器無一同者或測量之理觸類增智容當有之然未見其有防通之處也徐文定公言回回歷緯度淩犯稍爲詳宻然無片言隻字言其立法之故使後來入室無因更張無術蓋以此也又據曆書言新法之善系近數十年中所造則亦非元初之西法矣而與郭圖之理反有相通豈非論其傳各有本末而精求其理本無異同耶且郭法用員容方直起算冬至西法用三角起算春分郭用三乘方以先得矢西用八綫故先得又西専用角而郭只用弧西兼用割切而郭只用種種各別而不害其同有所以同者在耳且夫數者所以合理也歷者所以順天也法有可采何論東西理所當明何分新舊在善學者知其所以異又知其所以同去中西之見以平心觀理則弧三角之詳明郭圖之簡括皆足以資探索而啟深思務集眾長以觀其防通毋拘名相而取其精粹其於古聖人創法流傳之意庶幾無負而羲和之學無難再見於今日矣

角卽弧解

問古法只用弧而西法用角有以異乎曰角之度在弧故用角實用弧也何以明其然也假如辰庚己三角形有庚鈍角有己庚辰庚二邊欲求諸數依垂弧法於不知之辰角打綫綫先補求辰辛及辛庚成辰辛庚三角虛形此必用庚角以求之而庚角之度爲丙丁是用庚角者實用丙丁也其法庚丙九

十度之正【卽半徑】與丙丁弧之正弧【卽庚角正】若庚辰正與辰辛正是以大句股之例例小句股也又丙丁弧之割綫【卽庚角割綫】與庚丁九十度之正【亦卽半徑凡角度所當弧其兩邊並九十度】若庚辰之切綫與庚辛之切綫亦是以大句股之例例小句股也

旣補成辰辛巳三角形可求巳角而巳角之度爲乙甲是求巳角者實求乙甲也其法辛己弧之正與辰辛弧之切綫若己甲象弧之正【卽半徑】與乙甲弧之切綫【卽己角切綫】是以小句股例大句股也

又如己辰庚形庚爲鋭角當自不知之辰角打綫分爲二形以求諸數其一辰辛庚分形先用庚角而庚角之度爲丙丁用庚角實用丙丁也法爲丙庚象弧之正【卽半徑】於丙丁弧之正【卽庚角正】若辰庚之正與辰辛之

正又丙庚象弧之正弧【卽半徑】與丙丁弧之餘【卽庚角余】若辰庚之切綫與辛庚之切綫是以大句股例小句股也

其一辰辛己分形【以庚辛減己庚得己辛】有辰辛己辛二邊可求己角而己角之度爲乙甲求己角實求乙甲也法爲己辛之正與辰辛之切綫若己甲象之正【卽半徑】與乙甲弧之切綫【卽己角切綫】是以小句股例大句股也一系用角求弧是以大句股比例比小句股用弧求角是以小句股比例比大句股

歷算全書卷六十

