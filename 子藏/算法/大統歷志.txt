

欽定四庫全書

子部六

大統歷志

天文算法類二【推步之屬】提要

【臣】等謹案大統歷志八卷

國朝梅文鼎撰初元郭守敬作授時歷其法較古爲宻明初所頒大統歷卽用其舊法嵗久漸差知歷者恆有異議至崇禎間徐光啟推衍西法分局測驗疎舛益明欽天監正戈丰年無以復爭乃諉其過於守敬孫承澤作春明夢餘錄又力辧守敬爲歷中之聖惜不能盡用其法聚訟迄無定論康熙丙午開局纂修明史史官以文鼎精於算數就詢明歷得失之源流文鼎因卽大統舊法詳爲推衍注釋輯爲此編以持其平分原書爲法原立成推步三部法原之目七曰勾股測量曰弧矢割圓曰黃赤道差曰黃赤道內外曰白道交周曰日月五星平立定三差曰裏差漏刻立成之目四曰太陽盈縮曰太陰遲疾曰晝夜刻分曰五星盈縮推步之目六曰气朔曰日躔曰月離曰中星曰交食曰五星法源所以取數立成所以作數推步所以紀法皆剖析分明具有條理蓋文鼎於象緯運行實能究極其所以然與疇人子弟沿世業而守成法者所見固不同也歷算之家測未來者當以新法推已往者則當各求以本法知其所以疎而後可以得其宻知其所以舛而後可以得其眞知其所以漸差而後可以窮其至變則是書𨿽明郭氏之法亦測天者前事之師矣乾隆四十六年十月恭校上

總纂官【臣】紀昀【臣】陸錫熊【臣】孫士毅

總校

官【臣】陸

費墀

欽定四庫全書

大統歷志卷一

宣城梅文鼎撰

大統歷法一

法源

史載歷法必載其所以歷法之原如太初諸歷起數鐘律一行大衍求端河洛是也古今歷法惟授時歷獨以測驗算術爲宗以爲與天旣合則律呂之損益易象之奇偶悉在其中不必一一牽附矣攷郭守敬傳有修攺源流一卷儀像法式二卷歷議擬稿三卷二至晷景攷二十卷五星細行考五十卷古今交食考一卷新測二十八捨雜坐諸星入宿去極一卷新測無名星一卷並藏之官又齊履謙傳之授時歷有經串經以著定法串以紀成數履謙又作經串演撰八法一卷以求其法之所以然數之所從出作元史者漫無采摭而僅存履謙之歷議錄歷經之初稿及儀象大略而已其三應攺率及立成之數與夫黃赤道割圓弧矢之法日月五星平立定三差之原盡削不載使作者精意湮沒識者憾焉今據大統歷及通軌及歷艸諸書稍爲銓次著於篇而仍以法原爲首其目七曰勾股測望曰弧矢割圓曰黃赤道差曰黃赤道內外度曰白道交周曰日月五星平立定三差曰裏差刻漏

勾股測望

北京立四丈表冬至日測得正午景長七丈九尺八寸五分以簡儀測到冬至日南至地平二十六度四十六分五十秒爲半弧背求得矢度五度九十一分半置周天半徑截矢餘五十四度九十六分爲股乃本

地去戴日下之度以股別勾術求得勾二十六度一十七分六十六秒爲日下至地度卽冬至日出地半弧北京立四丈表夏至日測得正午景長一丈一尺七十一分【按元史作一丈二尺三寸六分】以簡儀測到夏至日南至地平七十四度二十六分半爲半弧背求得矢度四十三度七十四分少置周天半徑截矢餘一十七度一十三分二十五秒爲勾乃本地去戴日下之度以勾別股術求得股五十八度四十五分半爲日下至地度卽夏至日出地半弧以二至日度相並得一百度七十三分折半得五十度三十六分半爲北京赤道出地度轉減周天四之一餘四十度九十四分九十三秒七十五防爲北京北極出地度

弧矢割圓

周天徑一百二十一度七十五分少

半徑六十○度八十七分半【又爲黃赤道大】

二至黃赤道內外半弧背二十四度【所測就整】

二至黃赤道弧矢四度八十四分八十二秒

黃赤道大勾二十三度八十分七十秒

黃赤道大股五十六度○二分六十八秒

割圓求矢術置半弧背度自之爲半弧背羃周天徑自之爲徑羃又爲上廉二羃相乘得數爲正實徑羃乘徑得數爲益從方半弧背倍之乘徑得數爲下亷置初商爲上法以乘上亷得數以減益從方余爲從方置初商自之以減下廉余以初商乘之得數爲從廉從方從廉相並爲下法下法乘上法以減正寔而定初商有不盡者次第商除則次商又爲上法置初商倍之得數與次商相並以乘上廉得數以減益從方余爲從方並初商次商而自之又以初商自之並二數以減下亷余以初商倍數並次商乘之得數爲從廉從方從廉相並爲下法下法乘上法以減余寔而定次商有不盡者如法商之

皆以商得數爲矢度之數【黃赤道同用】

如以半弧背一度求矢度術曰置半弧背一度自之得一度爲半弧背羃置周天徑一百二十一度太自之得一萬四千八百二十三度○六分二十五秒爲徑羃【又爲上廉】

二羃相乘得一萬四千八百二十三度○六分二五爲正寔徑羃又乘徑得一百八十○萬四千七百○七度八十五分九十三秒七五爲益從方半弧背一度倍之得二度以乘徑得二百四十三度五十分爲下廉初商八十秒【爲上法】置初商八十秒乘上廉一萬四千八百二十三度○六二五得一百一十八度五八四五以減益從方一百八十○萬四千七百○七度八五九三七五餘一百八十○萬四千五百八十九度二七四八七五爲從方又置初商八十秒自之得六十四防以減下廉餘二百四十三度四九九九九三六仍以八十秒乘之得一度九四七九九九四八八爲從廉以從廉從方並之共得一百八十○萬四千五百九十一度二三二八七四四八八爲下法下法乘上法得一萬四千四百三十六度七十二分九七八二九九五九○四以減正寔余寔三百八十六度三十三分二七一七○○四○九六

次啇二秒【爲上法】置初啇八十秒倍之得一分六十秒加次啇二秒得一分六十二秒乘上廉一萬四千八百二十三度○六二五得一分六十二秒乘上廉一萬四千八百二十三度○六二五得二百四十○度一二三六一二五以減益從方餘一百八十○萬四千四百六十七度七二五七六二五爲從方又置初次啇八十二秒自之得六十七防加初啇八十秒自之數得一秒三十一防以減下廉餘二百四十三度四九九八六九以前所得一分六十二秒乘之得三度九十四分四六九七八七七八爲從廉以從廉從方並得一百八十○萬四千四百七十一度六十七分○四六○三七七八爲下法下法乘上法得二百六十○度八九四三三四○九二○七五五六以減余寔仍餘二十五度四三八三八二九一二○二○四四【不足一秒棄不用後同】

凡求得矢度八十二秒

如以半弧背二度求矢度用上法得矢三分二十八秒如以半弧背二十四度求矢度用上法得矢四度八十四分八十二秒

如以半弧背四十四度求矢度用上法得矢一十六度五十六分八十二秒

余度各如上法求到矢度以爲黃赤相求及其內外度之根【數詳後】

黃赤道差

求黃道各度下赤道積度術置周天半徑度分內減去黃道矢度余爲黃赤道小置黃赤道小以黃赤道大股乘之【大股見割圓】爲寔黃赤道大【半徑】爲法寔如法而一爲黃赤道小股置黃道矢自乘爲寔以周天全徑爲法寔如法而一爲黃道半背差以差去減黃道積度【卽黃道半弧背】余爲黃道半弧置黃道半弧自之爲股羃黃赤道小股自之爲勾羃二羃並之以開平方法除之爲赤道小置黃道半弧以周天半徑【亦爲赤道大】乘之爲寔以赤道小爲法而一爲赤道半弧置黃赤道小股【亦爲赤道橫小勾】以赤道大【卽周天半徑】乘之爲寔以赤道小爲法而一爲赤道橫大勾以減半徑余爲赤道橫弧矢橫弧矢自之爲寔以周天全徑爲法而一爲赤道半背差以差加赤道半弧爲赤道積度如黃道半弧背一度求赤道積度術曰置周天半徑六十○度八十六分五十秒【卽黃赤道大】內減黃道矢八十二秒餘六十○度八六六八爲黃赤道小置黃赤道小以黃赤道大股五十六度○二六八乘之得三千四百一十○度一七二○三○二四爲寔以黃赤道大六十○度八七五爲法寔如法而一得五十六度○一分九十二秒爲黃赤道小股【又爲赤道小勾】置矢度八十二秒自之得六十七防以周天徑一百二十二度七五爲法除之得五十五纎爲黃道半背差置黃道背一度內減黃道半弧背差余爲半弧因差在防以下不減卽用一度爲半弧置黃道半弧一度自之得一度爲股羃黃赤道小股五十六度○一九二自之得三千一百三十八度一五○七六八六四爲勾羃二羃並得三千一百三十九度空七六八六四爲寔平方開之得五十六度○二八一爲赤道小置黃道半弧一度以周天半徑【卽赤道大】乘之得六十○度八七五爲寔以赤道小五十六度○二八一爲法除之得一度○八分六十五秒爲赤道半弧置黃赤道小股五十六度○一九二【又爲赤道小勾】以赤道大半徑六十○度八七五乘之得三千四百一十○度一六八八爲寔以赤道小爲法除之得六十○度八十六分五十三秒爲赤道橫大勾置半徑六十○度八十七分五十秒內減赤道大勾六十○度八十六分五十三秒餘九十七秒爲赤道橫弧矢置赤道橫弧矢九十七秒自之得九十四防○九以周天徑爲法除之得七十七纎爲赤道背差置赤道半弧一度○八分六十五秒加赤道背差爲赤道積度今差在防以下不加卽用半弧爲積度凡求得赤道積度一度○八分六十五秒如黃道二度下赤道積度二度一十七分二十八秒

如求黃道二十四度下赤道積度用上法得赤道積度二十五度七十七分五十二秒

如求黃道四十四度下赤道積度用上法得赤道積度四十六度三十○分八十五秒

余度各如上法求到各黃道度下赤道積度乃至後之率其分後以赤道度求黃道及此求之得數並同

黃赤道相求弧矢諸率立成

﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷一﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷一﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷一﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷一﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷一﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷一﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷一﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷一﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷一﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷一﹥

按郭守敬創法五端內一曰黃赤道差此其根率也舊法以一百一度相減相乘授時立術以勾股弧矢方圓斜直所容求其差數合於渾象之理視古爲密顧至元歷經所載甚略又誤以黃道矢度爲積差黃道矢差爲差率今正之

﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷一﹥

按舊史無圖然表亦圖之屬也今勾股割圓弧矢黃赤道推變諸法寔爲歷家測算之本非圖不明因存其要者數端

大統歷志卷一

欽定四庫全書

大統歷志卷二

宣城梅文鼎撰

黃赤道內外度

推黃道各度距赤道內外術置周天半徑內減去赤道小余爲赤道二差【又爲黃赤道小弧矢又爲內外矢又爲股差】置半徑內減去黃道矢度余爲黃赤道小以二至黃赤道內外半弧乘之爲寔以黃赤道大爲法【卽周天半徑】法除寔爲黃赤道小弧【卽黃赤道內外半弧又爲黃赤道小勾】置黃赤道小弧矢自之【卽赤道二差】以周天徑除之爲半背差以差加黃赤道小弧爲黃赤道小弧半背卽黃赤道內外度

求黃道各度去北極逺近術置黃道各度所推黃赤道內外度視在盈初縮末限以加在縮初盈末以減皆加減象限度卽各得太陽去北極度及分秒

如冬至後四十四度求太陽去赤道內外及去極度術曰置周天半徑六十○度八十七分半內減黃道四十四度下赤道小五十八度三十五分六十九秒餘二度五十一分八十一秒爲黃赤道小弧矢【卽內外矢】置半徑六十○度八七五內減黃道四十四度矢一十六度五十六分八十二秒餘四十四度三十○分六十八秒爲黃赤道小置黃赤道小以二至黃赤道內外半弧二十三度七十一分乘之得一千○五十○度五十一分四二三八爲寔以黃赤道大六十○度八七五爲法除之得一十七度二十五分六十九秒爲黃赤道小弧【卽內外半弧】置黃赤道小弧矢二度五十一分八十一秒自之爲寔以圓徑一百二十一度七十五分爲法除之得五分二十一秒爲背差以差加黃赤道小弧一十七度二十五分六十九秒共得一十七度三十○分八十九秒爲二至前後四十四度太陽去赤道內外度置象限九十一度三十一分四十三秒七五以內外度一十七度三○八九加之得一百○八度六十二分三十二秒七五爲冬至後四十四度太陽去北極度

黃道每度去赤道內及去北極立成

﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷二﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷二﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷二﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷二﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷二﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷二﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷二﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷二﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷二﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷二﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷二﹥

白道交周

推白赤道正交距黃赤道正交極數術曰置寔測白道出入黃道內外六度爲半弧又爲大圓弧矢又爲股差置周天半徑六十○度八七五自之得三千七百○五度七六五六二五以矢六度而一得六百一十七度六十三分爲股和加矢六度共六百二十三度六十三分爲大圓徑依法求得容闊五度七十分又爲小勾又以二至出入半弧二十三度七十一分爲大勾以大勾爲法除大股五十六度○六分五十秒得二度三十七【就整】爲度差以度差乘小勾得小股一十三度四十七分八十二秒爲容半長置周天半徑爲大以乘小勾○五度七十分爲寔以大勾二十三度七十一分爲法除之得一十四度六十三分爲小又爲白赤道正交距黃赤道正交半弧依法求得半弧背一十四度六十六分爲白赤道正交距黃赤道正交極數﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷二﹥

裏差刻漏

北京北極出地四十度九十五分【寔測半弧背】

二至黃赤道內外度二十三度九十分【寔測半弧背】

二至黃赤道內外半弧二十三度七十一分【又爲黃赤道大勾又爲小三斜中】

北京二至出入差股一十五度二十九分【又爲小三斜中股又爲小股】

二至出入差半弧一十九度八十七分【又爲小】

二至出入差半弧背一十九度九十六分一十四秒度差八十四分一十九秒

冬至去極一百一十五度二十一分七十三秒

夏至去極六十七度四十一分一十三秒

夏至晝冬至夜六十一刻八十四分

冬至晝夏至夜三十八刻一十六分

求二至差股及出入差術曰置所測北極出地四十度九十五分爲半弧背以前割圓弧矢法推得出地半弧三十九度二十六分爲大三斜中股置測到二至黃赤道內外度二十三度九十分爲半弧背以前法推得內外半弧二十三度七十一分【又爲黃赤道大勾大小三斜】置內外半弧自之爲勾羃周天半徑自之爲羃

二羃相減開方得股以股轉減周天半徑得餘四度八十一分爲二至出入矢卽黃赤道內外矢夏至日南至地平七十四度二十六分半爲半弧背求得日下至地半弧五十八度四十五分半圓徑六十○度八十七分半爲大三斜中置大三斜中股三十九度二十六分以二至內外半弧二十三度七十一分乘之爲寔以半徑六十○度八十七分半爲法除之得一十五度二十九分爲小三斜中股【又爲小股】置小三斜中股一十五度二十九分去減日下至地半弧五十八度四十五分餘四十三度一十六分爲大股以出入矢四度八十一分去減半徑六十○度八十七分半餘五十六度○六分半爲大股法置大股以小股一十五度一九乘之爲寔大股四十三度一六爲法除寔得一十九度八十七分爲小卽爲二至出入差半弧置二至出入差半弧依法求到二至出入差半弧背一十九度九十六分一十四秒置二至出入差半弧背一十九度九六一四以二至黃赤道內外半弧二十三度七十一分除之得八十四分一十九秒爲度差分

求黃道毎度晝夜刻術曰置所求毎度黃赤道內外半弧以二至出入差半弧背乘之爲寔二至黃赤道內外半弧爲法除之爲所求毎度出入差半弧背【又術置黃赤道內外半弧以度差八十四分一十九秒乘之亦得出入差半弧背】置周天半徑內減所求黃赤道內外矢【又術以赤黃道內外矢倍之以減周天全徑餘數三因加一度爲日行百刻度亦同】置毎度出入半弧背以百刻乘之爲實日行百刻度爲法除之得數爲出入差刻置二十五刻以出入差刻黃道在赤道內加之在赤道外減之得數爲半晝刻倍之爲晝刻以減百刻爲夜刻

如求冬至後四十四度晝夜刻術曰置所求冬至後四十四度黃赤道內外半弧一十七度二十五分六十九秒【又爲黃赤道小弧前立成中敍之】以二至出入差半弧背一十九度九十六分一十四秒乘之爲寔以二至黃赤道內外半弧二十三度七十一分爲法除之得一十四度五十二分八十五秒爲所求出入半背【又法置黃赤道內外半弧一十七度二五六九以度差○度八四一九乘之亦得一十四度五二八五爲出入半弧背】置周天半徑六十○度八七五以四十四度黃赤道內外矢二度五十一分八十一秒【又爲赤道二差前條立成中貶之】減之餘五十八度三十五分六十九秒【卽赤道小】倍之得一百一十六度七十一分三十八秒三因之加一度得三百五十一度一十四分一十四秒爲日行百刻度【又術倍黃赤道內外矢得五度○三分六十二秒以減周天全徑一百二十一度七十五分亦得一百一十六度七十一分三十八秒三因加一爲日行百刻度並同】置出入半弧背一十四度五十二分八十五秒以百刻乘之爲寔以日行百刻度三百五十一度一十四分一十四秒爲法除之得四刻一十三分七十五秒爲出入差刻置二十五刻以出入差刻四刻一十三分七十五秒減之【因冬至後四十四度黃道在赤道外故減】餘二十○刻八十六分二十五秒爲半晝刻倍之得四十一刻七十二分半爲晝刻以晝刻減百刻餘五十八刻一十七分半爲夜刻【又術置出入差刻四刻一十三分七十五秒倍之得八刻二十七分半以減春秋分】【晝夜五十刻得四十一刻七十二分半爲晝刻以倍刻加五十刻得五十八刻二十七分半爲夜刻晝減故夜加餘仿此】

大統歷志卷二﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹥

欽定四庫全書

大統歷志卷三

宣城梅文鼎撰

黃道毎度晝夜刻立成

﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷三﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷三﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷三﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷三﹥

右歷艸所載毎度晝夜刻分乃授時原定大都晷漏大都者燕京也夏至晝冬至夜極長六十一刻八十四分冬至晝夏至夜極短三十八刻一十六分元史有云六十二刻者就整數耳明旣都燕不知遵用惟正統己巳年奏準頒歷用六十一刻而羣然非之士大夫旣未攷諸元史疇人子弟失其官守又不能執歷艸以爭遂旋行而罷終明之世皆用南京之軌漏而已﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷三﹥

太陽盈縮平立定三差之原

冬至前後盈初縮末限八十八日九十一刻【就整】離爲六段毎段各得一十四日八十二刻【就整】各段寔測日躔度數與平行相較以爲積差

各置其段積差以其段積日除之爲各段日平差平差與後段日平差相減爲一差置一差與後段一差相減爲二差

日平差

一差

二差

置第一段日平差四百七十六分二十五秒爲泛平積第一段二差一分三十八秒去減第一段一差三十八分四

十五秒餘三十七分○七秒爲泛平積差另置第一段二差一分三十八秒折半得六十九秒爲泛立積差

以泛平積差三十七分○七秒加入泛平積四百七十六分二十五秒共得五百一十三分三十○一秒爲定差以泛立積差六十九秒去減泛平積差三十七分○七秒餘三十六分三十八秒爲寔段日一十四日八十二刻爲法除之得二分四十六秒爲平差

置泛立積差六十九秒爲寔段日一十四日八十二刻爲法除兩次得三十一防爲立差

盈初縮末三差用數

立差三十一防

平差二分四十六秒

定差五百一十三分

夏至前後縮初盈末限九十三日七十一刻【就整】離爲六段毎段各得一十五日六十二刻【就整】各段寔測日躔度數與平行相較以爲積差

推日平差一差二差術與盈初縮末同

日平差

一差

二差

置第一段日平差四百五十一分九十二秒爲泛平積以第二差一分三十三秒去減第一段一差三十六分四十七秒餘三十五分一十四秒爲泛平積差另置第一段二差一分三十三秒折半得六十六秒五十防爲泛立積差以泛平積差三十五分一十四秒加入泛平積四百五十一分九十二秒共四百八十七分○六秒爲定差

以泛立積差六十六秒五十防去減泛平差三十五分一十四秒餘三十四分四十七秒五十防爲寔段日一十五日六二爲法除之得二分二十一秒爲平差

置泛立積差六十六秒五十防爲寔段日一十五日六二爲法除二次得二十七防爲立差

縮初盈末三差用數

立差二十七防

平差二分二十一秒

定差四百八十七分○六秒

凡求盈縮皆以入歷初末日乘立差得數以加平差再以初末日乘之得數以減定差餘數以初末日乘之爲盈縮積凡盈歷以八十八日九○九二二五爲限縮歷以九十三日七一二○二五爲限在其限以下爲初以上轉減半嵗周餘爲末盈初八十八日九○九二二五是從冬至後順推縮末亦八十八日九○九二二五是從冬至前逆溯其距冬至同故其盈積同縮初九十二日七一二○二五是從夏至後順推盈末亦九十三日七一二○二五是從夏至前逆溯其距夏至同故其縮積同

凡布立成盈初縮末置立差三十一防以六因之得一秒八十六防爲加分立差置平差二分四十六秒倍之得四分九十二秒加入加分立差得四分九十三秒八十六防爲平立合差置定差五百一十三分三十二秒內減平差二分四十六秒再減立差三十一防餘五百一十○分八十五秒六十九防爲加分

縮初盈末置立差二十七防以六因之得一秒六十二防爲加分立差置平差二分二十一秒倍之得四分四十二秒加入加分立差得四分四十三秒六十二防爲並立合差置定差四百八十七分○六秒內減平差二分二十一秒再減立差二十七防餘四百八十四分八十四秒七十三防爲加分以上所推皆初日之數其推次日皆以加分立差累加平立合差爲次日平立合差以平立合差減其日加分爲次日加分盈縮並同

其加分累積之卽盈縮積其數並見立成

﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷三﹥

太陰遲疾平立定三差之原

太陰轉周二十七日五十五刻四六測分四象象各七段四象二十八段毎段十二限毎象八十四限凡三百三十六限而四象一周以四象爲法除轉周日得毎象六日八八八六五以分七段毎段下實測月行遲疾之數與平行相較以求積差

積限

積差

各置其段積差以其段積限爲法除之爲各段限平差置各段限平差與後段相減爲一差置一差與後段一差相減爲二差

限平差

一差

二差

第七段六分四五六四

置第一段限平差一十○分七二六爲泛平積置第一段一差四十七秒七六以第一段二差九秒三六減之餘三十八秒四十防爲泛平積差另置第一段二差九秒三十六防折半得四秒六十八防爲泛立積差

以泛平積差三十八秒四十防加泛平積一十○分七二得一十二分一十一秒爲定差

置泛平積差三十八秒四十防以泛立積差四秒六十八防減之餘三十三秒七十二防爲寔以十二限爲法除之得二秒十一防爲平差

置泛立積差四秒六十八防爲寔十二限爲法除二次得三防二十五纎爲立差

太陰遲疾三差用數

立差三防二十五纎

平差二秒八十一防

定差一十一秒一十一

凡求遲疾皆以入歷日乘十二限二十分以在八十四限以下爲初以上轉減一百六十八限余爲末各以初末限乘立差得數以加平差再以初末限乘之得數以減定差余以初末限乘之爲遲疾積

其初限是從最遲最疾處順推至後末限是從最遲最疾處逆溯至前其距最遲疾處同故其積度同

月與日立法同但太陽以定气立限故盈縮異數大陰以平行立限故遲疾同原

布立成法置立差三防二十五纎以六因之得一十九防五十纎爲損益立差置平差二秒八十一防倍之得五秒六十二防再加積益立差一十九防五十纎共得五秒八十一防爲初限平立合差自此以損益立差累加之卽毎日平立合差至八十限下積至二十一秒四一五爲平立合差之極八十一限下差一秒七八○九八十二限下一秒七八○八至八十二限下平立合差與益分中分爲益分之終八十四限下差亦與損分中分爲損分之始至八十六限下差亦二十一秒四一五自此以損益立差累減之卽毎限平立合差至末限與初限周置定差一十一分一十一秒內減平差二秒八十一防再減

立差三防二十五纎餘一十一分○八秒一十五防七十五纎爲加分定差卽初限損益分置損益分以其限平立合差益減損加之卽爲次限損益分

以益分積之損分減之便爲其下遲疾度

以八百二十分爲一限日率加八百二十分爲毎限日率【以上俱詳立成】

五星平立定三差之原

凡五星各以寔測分其行度爲八段以求積差略如日月法

木星

立差二防三十六纎加

平差二秒五十九防一十二纎減

定差一十○分八十九秒七十○防

積日

積差

各置其段所測積差度分爲寔以段日爲法除之爲泛平差各以泛平差與次段泛平差相較爲泛平較

又以泛較與次段泛平較相較爲泛立較

置第一段泛平較三十九秒【一六二一】減其下泛立較六秒二四二二餘三十二秒九一九九爲初段平立較加初段泛平差一十分五六七八○一共得一十○分八十九秒七十○防爲定差【秒置萬位】

置初段平立較差三十二秒九十九九內減泛立較之半三秒一二一一餘二十九秒七九八八以段一十一日五十刻除之得二秒五十九防一十二纎爲平差

置泛立差之半三秒一二一一以段日爲法除二次得二防三十六纎爲立差

以上爲木星平立定三差之原

火星盈初縮末

立差一十一防三十五纎減

平差八十三秒一十一防八十九纎減

定差八十八分四十七秒八十四防

積日

一段七日六十刻

二段一十五日二十五刻

三段二十二日八十七刻五十分

四段三十○日五十○刻

五段三十八日一十二刻五十分

六段四十五日七十五刻

七段五十三日三十七刻五十分

八段六十一日

積差

一段六度二六八二五一二二八一八五五九三七五二段一十一度六○○一七五七四三五九三七五三段一十六度○二五九六三七九二五一九五【三一二五】四段一十九度六六九○一三六二一二五

五段二十二度二七九八九一四七六○七四【二一八七五】六段二十四度一六八二二八六○三二八一二五七段二十五度三三一五五六二四九二六○【一五六二五】八段二十五度六一九五一五六六

泛平差

一段八十二分○六五七三四八四三七五

二段七十六分○六六七二六一六七五

三段七十○分○五八八五八一○九三七五四段六十四分一八二九六九二五

五段五十八分四三九○五九六○九三七五六段五十二分八二七一二九一八七五七段四十七分三四七一七七九八四三七五八段四十一分九九九二○六

泛平較

一段六分一二九八四七二九六八七五二段六分○○七八六八○七八一二五三段五分八七五八八八八五九三七五四段五分七四三九○九六四○六二五五段五分六一一九三○四二一八七五六段五分四七九九五一二○三一二五七段五分三四七九七一九八四三七五

泛立較

一段一十三秒一九七九二一八七五

二段一十三秒一九七九二一八七五

三段一十三秒一九七九二一八七五

四段一十三秒一九七九二一八七五

五段一十三秒一九七九二一八七五

六段一十三秒一九七九二一八七五

泛平較前多後小應扣泛立較取初段下泛平較六分一三九八四七二九六八七五加泛立較一十三秒一九七九二一八七五得六分二七一八二六五一五六二五爲初日下半立較置初段泛平差八十二分二十○秒六五七三四八四三七

五加初日下立平較六分二七一八二六五一五六二五得八十八分四十七秒八十四防爲盈初縮末定差

置初日下平立較六分二七一八二六五一五六二五加泛立較之半六秒五九八九六○九三七五得六分三三七八一六一二五爲寔以一段下積日而一得八十三秒一十一防八十九纎爲盈初縮末平差

置泛立較之半六秒五九八九六○九三七五以一段十七日六十二刻五十分爲法除二次得一十一防三十五纎爲盈初縮末立差

火星縮初盈末

立差八防五十一纎

平差三秒○二防三十五纎損減

定差二十九分九十七秒六十三防

積日

一段一十五日二十五刻

二段三十○日五十刻

三段四十五日七十五刻

四段六十一日

五段七十六日二十五刻

六段九十一日五十刻

七段一百○六日七十五刻

八段一百二十二日

積差

一段四度五三一二五一八五七九六八七五二段九度一○二九六一四五一二五

三段十三度五三一六七○九○一七七三七五四段一十七度四七八九七五○四

五段二十○度八四三六六三○六六四○六二五六段二十三度四三一三三六二四一二五

七段二十五度○九二四三五二八三四六八七五八段二十五度六一八三七四七二

泛平差

一段二十九分七一三一二六九三七五

二段二十九分八四五七七五二五

三段二十九分五七八三五五○六二五

四段二十八分六五四○六四

五段二十七分三三三九五一五六二五

六段二十五分六一八○一七七五

七段二十三分五○六二六二五六二五

八段二十○分九九八六八六

泛平較

一段一十三秒二六四八三一二五

二段二十六秒八四一八○八七五

三段九十二秒四二九一○六二五

四段一分三二○一一二四三七五

五段一分七一五九三三八一二五

六段二分一一一七五五一八七五

七段二分五○七五七六五六二五

泛立較

一段一十三秒五七六九七七五

二段六十五秒五八七二九七五

三段三十九秒五八二一三七五

四段三十九秒四八二一三七五

五段三十九秒三八五一三七三

六段三十九秒五八二一三七五

七段【闕】

取泛立較均停者三十九秒五八二一三七五以較一段下泛平較一十三秒二六四八三一二五餘二十六秒三一七三○六二五爲較較以加一段下泛平差二十九分七一三一二六九三七五得二十九分九十七秒六十三防爲縮初盈末定差置較較二十六秒三一七三○六二五以一段日一十五日

二十五刻而一得一秒七二五七二五再置泛立較之半一十九秒七九一○六八七五以段日而一得一秒二九七七七五兩數並得三秒○二防三十五纎爲縮初盈末平差置泛立較之半一十九秒七九一○六八七五以段日一十五日二五爲法除二次得八防五十一纎爲縮初盈末立差以上爲火星平立定三差之原

土星盈歷

立差二防八十三纎扣

平差四秒一十○防二十二纎減

定差一十五分一十四秒六十一防

積日

積差

一段一十一日五十刻

一度六八三二四五八二【八七五﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷三﹥】置第一段下泛平較內減其下泛立較餘五十○秒九一七九七五爲平立較以平立較加本段泛平差得一十五分一十四秒六十一防爲盈定差

置平立較內減泛立較之半三秒七四二六七五餘四十七秒一七五三以一段日十一日五十刻而一得四秒一十○防二十二纎爲盈平差

置泛立數之半以一段日除二次得二防八十三纎爲盈立差土星縮歷

立差三防三十一纎加

平差一秒五十一防二十六纎減

定差一十一分○一秒七十五防

積日

置一段泛平較內減其下泛立較餘二十一秒七七二三七五爲平立較以平立較加入本段泛平差得一十一分○一秒七十五防爲縮定差

置平立較內減泛立較之半四秒三七七四七五餘一十七秒三九四九以一段日一十一日五十刻爲法除之得一秒五十一防二十六纎爲縮平差

置泛立較之半以一段日爲法除得三防三十一纎爲縮立差以上爲土星平立定三差之原

金星

立差一防四十一纎加

平差三纎減

定差三分五十一秒五十五防

積日

積差

置一段下泛平較與其泛立較相減餘一秒八六八一七五爲平立較以加泛立差得三分五十一秒五十五防爲定差置平立較與泛立數之半一秒八六四七二五相減餘三十四纎以段日一十一日五十刻爲法除之得三纎爲平差置泛立較之半以段日爲法除二次得一防四十一纎爲立差以上爲金星平立定三差之原

水星

立差一防四十一纎加

平差二十一防六十五纎減

定差三分八十七秒七十○防

積日

泛平差

泛平較

泛立較

術同金星求得定差三分八十七秒七十防平差二十一防六十五纎立差一防四十一纎

以上爲水星平立定三差之原

右五星皆以立差爲秒平差爲本定差爲總五星各以段次因秒木土金水四星並本惟火星較本各以積日而積五星皆較總又各以積日乘之得各寔測之度分

五星積日皆以度率除周日得三百六十五度二十五分太各以四分之一爲象限惟火星用象限之一減象限爲盈初縮末限加象限爲縮初盈末限其命度爲日者爲各取盈縮歷乘除之便其寔積日之數卽積度也

大統歷志卷三

欽定四庫全書

大統歷志卷四

宣城梅文鼎撰

立成

旣有法原則數可紀矣故立成次之立成云者依法以日月五星盈縮遲疾之數預爲排定以便推步取用也元志歷經步七政盈縮遲疾皆有二術其一術以三差立算者卽布立成法也其又術云以其下盈縮分乘入限分萬約之以加其下盈縮積者用立成法也而遺立成未載無從入算今依大統歷通軌具錄之其目有四曰太陽盈縮曰太陰遲疾曰晝夜刻曰五星盈縮【余詳法原及推步二卷按元史至元十七年授時歷成十九年王恂卒時歷𨿽頒然立成之數尙皆未】【有定稿郭守敬比類篇次整齊分秒裁爲二卷而今欽天監本載嘉議大夫太史令臣王怐奉敕撰意者王先冇稿而郭卒成之者歟】大統歷依授時算立成上

太陽冬至前後二象盈初縮末限【置八十七日下消息分六分五五六八內減初日四分九三八六餘一分六一八二爲寔八十七日爲法除之得○一八六爲每日之差】

﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷四﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷四﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷四﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷四﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷四﹥

【置本限八十八度九○九二二五加入盈積度二度四千○一十四分恰合得九十一度三一○六二五爲周嵗一象之度】

太陽夏至前後二象縮初盈末限【置九十二日下消息分五分九二六六內減初日四分四三六二餘一分四九○四爲寔九十二日爲法除之得○一六二爲每日之差】

﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷四﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷四﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷四﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷四﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷四﹥

【置本限平行九十三度七一二○二五減去縮積度二度四千○一十四分亦恰合得九十一度三二○六二五爲周嵗一象之度】

布立成法【先依歷經盈縮招差各以其日平差立差求到每日盈縮積次以相挨兩日盈縮積相減余爲每日盈縮加分以其日加分盈加縮減一度卽每日日行度又以相挨兩日加分相減余爲每日消息分再置末日消息分以初日分減之餘爲寔求日日數爲法法除寔卽自然得每日消息之差也】

覆驗法【各以其日消息分減其日加分以加其日加分加其日加分亦卽得先日加分也累積每日加分得其日盈縮積以其日盈縮積減去先日加分亦卽得先日盈縮積也又法盈初置立差三十一縮初置立差二十七各六因之得各消息之差】

勿庵補求盈縮末日法【旣有初入末之日其次朔望但以望策累減卽得次朔望以防減之亦得此法用之寫算尢妙旣逓減訖乃取所得末日加其原列盈縮日卽合半嵗周則知不誤也丙寅十月】髙麗史歷志扵授時歷經後載有日行盈縮月行遲疾五星盈縮立成俱同遂不細鈔惟盈縮立成後有語二條今錄於此盈初縮末限以初日行分至八十八日計得九十一度四○一四二七此盈初冬至休初日行分自一日至後八十八日計得九十一度三五○三四二此縮末秋分

縮初盈末限以初日行分至九十三日計得九十一度五九八七一七此縮初夏至休初日行分自一日至後九十三日計得九十一度六四七二○一此盈末春分

太陰限數遲疾度【十分定三子單分定二子十秒定一子單秒不定】

﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷四﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷四﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷四﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷四﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷四﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷四﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷四﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷四﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷四﹥

【置月平行一十三度三六八七五以每限日行分八百二十分爲法乘之又以萬約之得數一度○九六二三七五是爲每限月平行度也復置在位以各限損益分加減之如在疾歷則益者加之損者減之如在遲歷則益者減之損者加之卽各得每限月行遲疾度數也數止秒勿庵秒以下有零數不拘多少俱收爲秒

注又法置小轉中一十三日七七七三以月平行度爲法乘之得數一百八十四度一八五二七九三七五爲寔以一百六十八限爲法除之得一度○九六三四○九四是爲每限月平行度也復以各限損益分加減之卽各得其限遲疾行度也數止秒秒此法較親以下棄不用○加減同】

布立成法【依歷經垜疊招差各以平差立差求到各限遲疾度次以相挨兩限遲疾度相減余爲每限損益分次各以其限損益分加減每限月平行一度○九六三四○九四得爲各限疾遲行度也秒以下數不用其加減法在疾益加損減在遲反之其八十三四限另有變率求差之法】

勿庵補求限數法【以所得遲疾日及今與立成日率相比而取其日率相似而略少者用之卽得所用限數也不必以十二限二十分乘此法甚防又免退一限減之煩

丙寅十月初十日記】

欽天監祕本

遲疾行度之法○度○○○歌曰天根一度○九分六三三九七五齊【法曰先置天根之數】損益加減爲分秒各限行度自然知【法曰加者加入天根之內減者置天根之數減其損益分也】八十三限前皆益疾加遲減是端的八十四限後皆損疾減遲加更莫疑

又加減差之法○十○百○○○○

大統歷志卷四﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹥

欽定四庫全書

大統歷志卷五

宣城梅文鼎撰

大統歷依授時立成法下

冬至日後每日日出晨分半晝分

法以半晝分轉減五十刻【卽半日周五十分也】余爲日出分日出分內又減去二百五十分爲晨分以晨分減日周一萬分余爲昏分昏分內又減二百五十分爲日入分若順推者以半晝分加半日周爲日入分又加二百五十分爲昏分以昏分減日周爲晨分晨分加二百五十分爲日出分

﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥

查表防法凡晨分昏分相並成日周一萬日出分日入分相並亦成日周一萬又晨分昏分之尾數四位相並成一百分日出分日入分之尾數四位相並亦成一百分【卽一刻】若尾數

三位則晨分同日出而昏分日入並同半晝皆尾數三位不變夏至日後每日日出入晨昏半晝分

﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥

右立成所載日出入半晝夜晨昏分蓋陽城晷刻也凡晷刻長短生於北極出地之髙下極髙則景長差多極卑則景短差平據元史所載當時四海測驗晷景之數二十有七其一爲南京北極出地三十四度太彊其一爲河南府陽城北極出地三十四度太弱其一爲嶽臺北極出地三十五度夏至晝六十刻夜四十刻今立成所載晝夜永短之數於六十則弱於四十則彊故知爲陽城或南京晷刻也今將元志晷差列後

四海測驗

南海北極出地一十五度夏至景在表南長一尺一寸六分晝五十四刻夜四十六刻

衡嶽北極出地二十五度夏至日在表端無景晝五十六刻夜四十四刻

嶽臺北極出地三十五度夏至晷景長一尺四寸晝六十刻夜四十刻

和林北極出地四十五度夏至晷景長三尺二寸四分晝六十四刻夜三十六刻

鐵勒北極出地五十五度夏至晷景長五尺一分晝七十刻夜三十刻

北海北極出地六十五度夏至晷景長六尺七寸八分晝八十二刻夜一十八刻

大都北極出地四十度太彊夏至晷景長一大二尺三寸六分【通軌作一丈一尺七寸一分】晝六十二刻夜三十八刻

河南陽城府北極出地三十四度太弱

州北極岀地一十九度太

大統歷依授時算立成

北京日出入時刻晝夜長短

﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥

大統歷依授時算立成

五星盈縮

木星盈縮同用

火星盈歷

火星縮歷

土星盈歷

﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷五﹥

大統歷志卷五

欽定四庫全書

大統歷志卷六

宣城梅文鼎撰

釋凡四則

印心

歷生於數數生於理理與气偕其中有神頥焉而不亂也變焉而有常也於是聖人以數紀之堯命羲和舜在璣衡皆是物也中遭秦炬先憲略亡自太初以後作者數十家人各效才王郭肇興大成斯集夫天不變理亦不變故歷代賢者往往驗天以立法要皆積有畢生之精力始得其一法之合乎理有聖人𨿽起不復能易者而後之不刋以至今鼎何人也敢與於斯夫創起者難爲功觀成者易爲力昔人緣理以立數今人因數以知理期以信吾心焉耳矣所不能信者不敢知也其或章句繁複往復諄然夫必如是而後自信以信於古人僣越獲罪旣無所逃拘滯固陋貽誚通方幸有以教

存疑

大統歷法所以仍元法不變者謂其法之善可以永久也夫旣仍辛巳之元合用授時之數乃以今所傳較之歷經參伍多違豈別有說愚故不能無疑也按歷經上考往古則嵗實百年長一周天百年消一下驗將來則嵗實百年消一周天百年長一此其據往以知來自堯典徵降而諸史所載可以數求者當時則旣一一驗之矣而今所傳嵗實一無消長此其可疑一也又按歷經諸應等數隨時推測不用爲元固也今則气應仍是五十五日○六百分周應仍是箕十度至於閏應原是二十○萬一千八百五十分今攺爲二十○萬二千○五十分較授時後二百分轉應原是一十三萬一千九百○四分今攺爲一千三萬○千二百○五分較授時先一千六百九十九分交應原是二十六萬○千一百八十七分八十六秒今攺爲二十六萬○千三百八十八分較授時後二百○○分一十四秒或差而先或差而後以之上考辛巳必與元算不諧若據歷經以步今玆亦與今算不合然則定朔置閏月離交防之期又安所取衷也豈當時定大統歷有所測驗而攺之歟夫攺憲則必另立元今气應周應俱同而獨於數者有更此其可疑二也又按歷經盈縮遲疾皆有二術其一術不用立成其一術用立成然只有用之之法而無其圖其遲疾圖則又仍如古式只二十八日日數而無逐限細率意者當時修史者之遺忽歟抑有所禁祕也今據此所載立成以求盈縮二術俱諧以求遲疾則自八十三限以至八十六限與前術有所不合意其所謂立成者有異歟據元史王恂先卒其立成之稿俱未成書郭公守敬爲之整齊意者歷經前術爲王公未定之稿歟此其可疑三也又如日月食開方數乃所求食分橫過半徑之數據歷經皆五千七百四十乘之今攺月食者爲四千九百二十乘是所測闇虛小於原所測者二十分也則其所測月輪圓徑亦小於原所測者一十分也苟非實有測驗於天又何敢據此以非彼歟苟非於交食之際立渾比量周徑縱橫之數何從而定歟苟非於虧復之際下漏刻以驗之定用分之多少何自而知歟此其可疑四也又有自相背馳如立成所載日出入半晝分是自冬至夏至後順數隻問盈縮不言初末而通軌求日出入法又似有初末二圖此皆不可意斷者至於晝夜永短與元史所載大都刻數不同則以北極髙下黃道因之所在而殊理固然也然篇首皆不言郡省撰名復載王恂豈當時九服晷漏之永短皆推有圖而元史止載其一歟然畢竟此所列者據何地爲則也此其可疑五也凡此數端同異出入未敢偏據姑卽所傳略附箋疏去取是非俟之君子

刋誤

大抵一書傳經數手多非其舊或謄冩魯魚或簡編蠧蝕故君子愼闕疑也乃若専守殘文習焉不察有所未解彊入以己意參之遂使斵輪不傳糟粕並失金根輙攺燕郢何憑今於其尢謬亂者是正數條或據歷經或據本書非敢逞私憑臆以重獲罪於古今也一者日月食限乃算家所憑以定食不食者也而今所載或失而出或失而入失而入不過虛費籌策而已失而出則將據此以斷不食其有不合將以疑立法之不詳今皆據陰陽食限極之諸差所變以爲常凖卽據本書以定似爲稍宻脫有不合其必非本算所能禦矣其日食夜刻月食晝刻亦據本書及歷經所載時差並定用分得之其月帶食若據歷經定用分尙有微差亦不多也一者月食時差分據歷經爲定蓋歷考古歷皆與此所載不合故斷以歷經一者黃道定積度原以嵗差推變自大衍以後爲法略同今若定鈐何異膠柱今斷以歷經仍以天啟辛酉一年步定爲式一者月食皆內分據歷經原以旣內分與一十分相減相乘平方開之也今則訛爲一十五分夫月食十分而旣其旣內五分倍之爲十分而止矣安得有所謂旣內十五分乎今以較求句股法求得旣內小平圓積數皆與所求相應一如歷經原法故斷從之別有圖說以證其理一者日月帶食凡日出入分在初虧已上復圓已下是爲帶食而出入也今則訛爲初虧已上食甚已下是得其半而失其半求之歷經亦復仍訛故愚亦不敢全據歷經者謂有此等處也今據後已復光未復光條攺爲復圓分已下厥數實諧於理亦暢又月食通軌前所錄數定望並晨昏分下注誤又月食分秒定子法誤又月食定用分並旣內分定子俱誤又月食更防歸除法並定數法俱誤又逕求次年天正交泛分條誤多有閏無閏每月加數今皆刋正

補遺

算有所必不可略句與字有所必不可無而或無之或略之則非作法者之故爲祕惜也如日食交前後條正交交定度在七度已下數𨿽在正交度下而實則陽曆交後度也法宜加交終度減之此算之所必不可略者也乃此書旣不之載至元歷經亦復闕焉何也夫此亦數之易知當必非所甚祕豈非梨棗鉛槧者之責乎將謂精於算者自能知之而無所用書歟今輙斷之以理重爲補定古人而得見我何以幸教之也又如定子法爲乘除後進退而設甚便於初學其立法立意不可謂不至也乃多有遺去言十定一不滿法去一二語者夫定子所以禦乘除之變而此二語又所以通定子之窮若無此二語則何如不定子之爲愈乎又如求天正赤道黃道度二條皆不用定子夫赤道不定子知其所減者爲度位乎爲分位乎黃道乘除不用定子固也然何以處夫除不滿法與夫減過積度只剰秒微者乎又如食甚入盈縮條遺食甚甚字夘酉前後條遺定望望字凡此皆字與句之所必不可無者也今皆補定

日月交食通軌用數目錄

周天三百六十五度二十五分七十五秒

按此卽周天分渾然本體其數則亦以日度紀之也

半周天一百八十二度六十二分八十七秒半

按此卽周天二象之數乃二分周天之一

半嵗周一百八十二度六十二分一十二秒半

按此乃太陽行天半嵗之數卽不及半周天之七十五秒也

周天象限九十一度三十一分四十三秒七十五微按此乃四分周天之一象者四象陰陽老少也

交終度三百六十三度七十九分三十四秒一十九微六按此以月平行度乘交終之數月入交一轉凡行天度有此數也

交中度一百八十一度八十九分六十七秒○九八按此以月平行乘半交之數月入交一半凡行天度有此數也

正交度三百五十七度六十四分

按此於交終度內減去六度一五有奇也

中交度一百八十八度○五分

按此於交終度內加入六度一五有奇也○日食入交度有加減者日旣髙於月黃道在天亦髙於月道故當其初入陰曆六度時月之行天𨿽在日北而人之見月尙在日南中交度所以有加也及其將入陽曆尙差六度時月之行天𨿽在日內而人之見月已出日外正交度所以有減也此古人測驗之宻也其所以然則亦中國地勢爲之

前凖一百六十六度三十九分六十八秒

按前者交前也入陰曆滿此是在正交前也入陽曆滿此是在中交前也以後凖減交中卽得

後凖一十五度五十分

按後者交後也入陽曆在此數以下是正交後也入陰曆在此數以下是中交後也凖者定也凡月食在交前後以此爲定蓋無論交前交後皆以十五度五十分爲定過此則不食也前凖數𨿽多以減交終度則亦十五度五十分也

日周一萬分

按自子正初刻至夜子初四刻有此分【卽授時日法也唐末民間曽有萬分歷】

半日周五千分

按自子正初刻至午初四刻或自午正初刻至夜子初四刻皆有此分

月平行分一十三度三十六分八十七秒半

按置月行極遲極疾度數一轉之積以月行一轉之日平分之得此數

日行分八分二十秒

按此乃一限之日行分也月行一限在日周一萬內得八百二十分也蓋萬分日之百卽百分度之一分也

刻已上日月皆食【案此句上有缺文後二已字下有脫字】

在○日五千四百五五已日月皆食在二十五日六一五一已上日月不食

在一十二日○○八九已上日月不食在一十四日一五一六已下日月皆食

陰食入交

在一日二十五刻已下不食在一十二日四十二刻已

月食

在一日一八七二已下日食在二十六日○二四九已上日月皆食

在一十二日四一八九已上在一十四日七九三三已下

又在交望一十四日七六五二九六五已下日月皆食又在交終二十七日二一二二二四已下日月皆食又在交中一十三日六○六一一二已下日月皆食右各日月食限如日食視其定朔小餘在夜刻者如月食視其定望小餘在晝刻者卽同不食亦不必推算也又與各交泛者數同則食也不同者不食其已上已下皆指小餘而言凡數自萬已上爲大餘自千已下爲小餘○凡日食視其定朔小餘在一千二四九已下八千八百已上皆在夜刻也起亥初初刻止醜正四刻○凡月食視其定望小餘在三千○一六已上七千○八三已下皆在晝刻也起辰初初刻止申正四刻

日食分二十分

按此置日食十分倍之【並日體月影各十分卽二十分】

月食分三十分

按此置月食一十五分倍之【倂月體十分闇虛二十分共三十分】

陰食限八度

定法八十分

按陰者月入陰曆是在黃道北在日內也在日內則易爲揜故八度食也○陰食八度故陰定法亦八十分以八十分除八度卽得陰食十分也

陽食限六度

定法六十分

按陽者月入陽曆是在黃道南在日外也在日外則難爲揜故六度食較陰食近也○陽食六度故陽定法亦六十分除六度卽得陽食十分也

月食限一十三度○五分

定法八十七分

按以月食定法八七除一十三度○五分卽得月食一十五分也○月旣小於闇虛闇虛所至卽月所至無髙小故不論陰陽曆皆十三度卽食也闇虛者日之影倍大於月故月食十有五分所謂旣內旣外也

日月食限數【凡數滿萬爲日千爲十刻百爲單刻】

陽食入交

在○日五十刻已下日月不食在二十六日○二刻已上日月皆食

在一十三日○○刻已上日月皆食在一十四日七十五

按自定朔之法行而日食必在朔歷家以是驗其疎密者千有餘年矣歷至授時法益密數亦簡𨿽然月有交也逐交步算𨿽簡亦繁許學士之譏世醫謂獵不知兔廣絡原野術已疎矣今通軌所載食限顚倒繆亂殆不可以數求其誤後學將何已乎愚不自揣輙爲訂定如左

今考定日月入交食限

朔泛交入陽曆

在○日五○一六已下爲入食限已上者日不食【月平行乘之得六度七○五七六五爲陽曆距正交後度】

在一十三日一○四五已上爲入食限已下者日不食【月平行乘之得一百七十五度一九○一八四三七五爲陽曆距中交前度】

朔泛交食陰曆

在一十四日不問小餘皆入食限【月平行一百八十七度一六二五】其小餘在一五一六已下一三○七已上者的食

在一十五日一七七九已下爲入食限已上者不食在二十五日六四○四已上爲入食限已下者日不食在二十六日不問小餘皆入食限

其小餘在六六六七已上六八七六已下者的食

又在交終二十七日二一二二二四已下爲入食限又在交中一十三日六○六一一二已上爲入食限望泛交不問陰陽曆

在○日不問小餘皆入食限

其小餘在七九六六已下者月的食

在一日一五五六已下爲入食限已上者不食在一十二日四五○五已上爲入食限已下者不食其小餘在八○九五已上者月的食

在一十四日七六一七已下爲入食限已上者不食其小餘在四○二七已下者月的食

在二十六日○五六六已上爲入食限已下者不食其小餘在四一五六已上者月的食

又在交終二十七日二一二二二四已下月的食又在交中一十三日不問小餘皆的食

右日月食限皆視其朔望入交泛日其入不食限者卽不必布算也其入的食限者必食也其入食限不言的者或食也或不食也是皆以算禦之也凡言已上已下者皆指小餘有不問小餘者則只以大餘命之也又視其定朔小餘如在日入分後及日出分前十分已上者夜刻也定望小餘如在日入分前及日出分後七百三十分已上者晝刻也日食在夜刻月食在晝刻卽不得見初虧復圓同不食限不必布算也○按日食陰曆距交前後二十一度而止以月平行除之得一日五七一八日食陽曆距交前後六度七十一分而止以月平行除之得○日五○一六卽各其食限也其陰曆距交前後七度○一三四至七度二九三四爲日的食限月平行除之得○日五千二百四六至○日五千四百五五也其陽曆則無的食何也蓋日食𨿽有陽食限六度陰食限八度其實總在陰曆陽曆本無蝕法也今所定陽曆食限以諸差得之皆或限也諸差者何一曰盈縮差加減之極至二度四十分一曰南北東西差加減之極至四度四十六分並二數六度八十六分內除未交陽曆前原空有一十五分餘六度七十一分是爲陽曆食限也其陰曆的食起七度○一至七度二九止者正交中交限距交皆六度一十五分而陽食限只六度是原空一十五分也加入盈縮差並南北東西差六度八十六分共七度○一而差變極矣故的限以此起置正交中交距交數加陰食限八度共一十四度一十五分內減去盈縮並減去東西南北差餘七度二九而差變極矣故的限以此終不入此限度皆或限也置正交中交距交數加陰食限共一十四度一十五分又加入盈縮差又加入南北東西差共二十一度是爲陰曆食限也蓋極其變可以得其常執其常可以追其變今所訂定食限皆要其變之極者言之而其常可知也

又按月食不問陰陽曆只距交前後一十五度四十五分而止在月平行得一日一五五六爲食限也其距交前後一十○度六十五分在月平行得○日七九六六爲的食限也夫月食何以不問陰陽曆也月之掩日以形形則有所不周日之掩月以气气則無所不及故日必以陰曆食月不問陰陽曆皆食陽全陰半之理也又月𨿽掩日尙不能直至於日之所也故有東西南北差日以闇虛掩月則直至於月之所也故亦無東西南北差惟其不用東西南北差也故只以盈縮差二度四十分加其食限一十三度○五分而得食限一十五度四十五分或食之數止此而差變極也只以盈縮差二度四十分減其食限一十三度○五分而得的食限一十○度六十五分或不食之數亦至此而變極也

又按夜刻不見日食以時差分與定用分相較知之大約日出入夘正酉正合朔當之時差之多至六百五十分若當二至日出入其差乃極亦不下六百三十分故定朔分若與日出入同者其食甚皆在日出前日入後六百三十分已上也假如日食十分當月行極遲之限定用分極多至六百三十五分止矣故知定朔在日出分前一十分以下者卽不得見未復光定朔在日入分後一十分以上者卽不得見初虧斷爲夜刻無疑也其晝刻不見月食亦以時差分與定用分相較知之依授時時差法望在夘酉正時差之多至一百三十分若當二至日出入其差爲極亦不下八十九分故定望若與日出入分同者其食甚皆在日出前日入後八十九分已上也假如月食十五分當月行極遲之限定用分多至八百一十六分止矣故知定望在日出分後七百三十分已上者卽不得見初虧定望在日入分前七百三十分已上者卽不得見未復光斷爲晝刻無疑也【授時算月食時差法見後時差條】

又按大術歷有九服交食法庚午元歷有裏差自宋以前歷皆有晷漏所在差數今所定只據授時歷經所載大都食法其日出入據立成所載或是順天漏刻也余處再消息之

大統歷志卷六﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹥

欽定四庫全書

大統歷志卷七

宣城梅文鼎撰

日食通軌【按軌者法也算月食者以此爲通行必用之法也】

錄各有食之朔下算

經朔全分

盈縮歷全分

盈縮差全分遲疾歷全分

遲疾限數

遲疾差全分加減差全分

定朔全分

交泛全分

按有食之朔卽所推其朔交泛日入食限者也故其下所有數如經朔等皆全錄之以爲算日食用也蓋數以倚數參伍相求此所錄皆母數原定朔時俱已推定更不必復算只全錄取用也月食仿此

推定入遲疾歷法

置所推或遲歷或疾歷全分以本日下加減差加者加之減者減之得爲定入遲疾歷分也

按原所推遲疾歷是經朔下者今以加減差加減之則是定朔下遲疾歷也

推定入遲疾歷限數法

置所推定入遲疾歷全分依朔下限數法推之得爲定入遲疾限數也

按定朔遲疾歷旣不同經朔則其入轉限數亦異其月行遲疾行度之數亦異故復定之

推定限行度法

視所推定入遲疾限與太陰立成相同限下遲疾行度遲用遲行度疾用疾行度內減去日行分八分二十秒【按此於度下二位減】而得爲定限行度也

按定限行度者卽定朔所入限月行遲疾之數也內減去八分二十秒者月行一限日行八百二十分於度下分卽八分二十秒也蓋日月並行於天皆自西而東其立成遲疾行度月所行於天之數此所推定限行度乃月行所過於日之數假如一限月行一度而日已行八分二十秒則月之合日而過只有九十一分八十秒也

推日出入半晝分法

視有食之朔下是盈初盈末者大餘若干用立成內冬至後相同積日下日出入半晝分全錄之是縮初縮末者大餘若干用立成內夏至後相同積日下日出入半晝分全錄之

按日出入者所以定帶食也以全晝之分半之爲半晝分所以定午也只用經朔盈縮歷不加減者所差半日而極無甚差數也據此則日出入立成當亦如盈縮立成法皆始於二至順逆推之今立成只是順求故其圖爲二也若如盈初縮末縮初盈末法則以二圖爲四圖

推嵗前冬至天正赤道宿次度分法

置嵗差一分五十秒【定二子】爲實以所距積年減一算【十定一百定二】爲法乘之【言十定一】得數【定有四子爲度】以度率十度相減余爲赤道箕宿度分也

按嵗差者日行黃道之度所每嵗遷徙不常者也堯時冬至在虛一度至元冬至在箕十度漸差而西也嵗差一分五十秒者凡六十六年有八月而差一度也原至元冬至在箕十度至今所求年又差防度故以距算乘嵗差而得所差之數以減其宿十度便知退在箕宿防度也嵗差之度自東而西其數爲退故用減也

推嵗前冬至天正黃道宿次度分法

置所推赤道度分內減去黃道立成相同積度下第三格積度全余分【有十定三子有分定二子十秒定一子】爲實以下同度下第四格度率爲法除之【不去子只不滿法去一子】得數【定有三子爲十分二子爲單分一子爲十秒於十分前一位加積度】萬位前加入同度第一格積度得爲天正黃道箕宿度分也

按赤道之勢平黃道較赤道其勢有斜有平當其斜則宿度多於赤道當其平則宿度少於赤道故赤道終古不變而黃道宿度每嵗不同要之以二至平二分斜則無不同也所積赤道度卽箕宿度乃逆推今冬至所距箕宿初度之數也於是以第三格積度減之便知此所距箕宿度已滿黃道有防度也其減不盡者以第四格度率除之便知此未滿於黃道一度者在黃道爲防十防分也於是加入第一格積度便知今冬至距箕初度之黃道凡有防度防十防分也第三格積度至後赤道也第一格積度至後黃道也凡至後赤道積防度防十防分於黃道爲防度整數也第二格度率至後黃道也第四格度率至後赤道也凡至後赤道率一度零防分於黃道爲一度整數蓋至前後黃道平故其數少於赤道如此也原法以黃道度率乘減余然後以赤道度率除之今黃道率是一度乘過仍是本位故不用乘只用除也惟其不用乘故除亦不去子只不滿法去一子也

黃道立成

按此圖原有九十一度以二至二分爲端蓋二分之黃道與赤道相交故其度斜徑而每度之數加多於赤道二至之黃道與赤道相逺故其度平直而每度之數加少於赤道此所存十度乃至後者故其黃道之率皆少於赤道也只用十度者因箕宿只十度故也此算家等按暫時省力之法蓋至後黃赤道率與至前則同此圖原是順推今則用之逆溯其理同其數同也

推交常度法

置有交食之交泛全分【十日定五子單日定四子空日定三子空千定二子空百定一子空十不定子】以月平行一十三度三六八七五【定一】爲法乘之【言十定一乘過定有四子爲單度五子爲十度六子爲百度】卽得所推交常度分也按交常度者以常數言之合朔去交凡有若干度也推交定度法

置所推交常度全分盈加縮減其朔下盈縮差度分得爲交定度分也如遇交常度數少不及減縮差者加交終度三百六十三度七九三四一九減之餘爲交定度分也遇滿交終度去之

按交定度者太陽所在距黃道白道相交之數凡防也以太陽爲主故只用盈縮差加減之而得也月食求闇虛卽日所衝是亦以日爲主也如遇交常度數少不及減縮差者是以常數言之𨿽已在交後計日行盈縮則仍在交前故加入交終度減之卽仍作交前算也愚意交定度當以定朔入盈縮歷求之盈縮差分以加減交常度於理較親也存之以質髙明推日食在正交中交度

視所推交定度全分如在七度已下三百四十二度已上者爲食在正交也如在一百七十五度已上二百○二度已下者爲食在中交也

按正交者月自陰曆入陽曆交之始也中交者月自陽曆復入陰曆交之中也交終之度於此始卽於此終故爲正交也交終之度於此適半故爲中交也七度已下三百四十二度已上者正交食限陽曆距交初七度陰曆距交終二十一度而止也一百七十五度者陽曆距交中亦七度而止爲食限二百○二分者陰曆距交中亦二十一度而止爲食限也【詳見日月食限條】

推中前中後分法

視定朔小餘如在半日周五千分已下者就置五千分內減去定朔小餘而余爲中前分也如在半日周已上者就於定朔小餘內減去半日周餘爲中後分也按中前是以午逆推前所距分也故以小餘減半日周中後是以午順求後所距分也故以半日周減小餘順數逆推皆自午正起算也

推時差分法

置半日周內減去所推或中前或中後分余【千定三百定二】爲實復以中前或中後【千三百二定之】爲法乘之【言十定一】得數又以九十六分【去三子○按九十六分宜去一子今去三子者經所謂退二位也】爲法除之【不滿法去一子除過定有二子爲百分一子爲十分】得爲時差分也中前爲減差中後爲加差

按時差分者食甚之時刻有進退於定朔者也蓋經朔本有一定之期旣以月遲疾日盈縮加減之爲定朔矣而猶有差者則以合朔加時有中前中後之不同者何也大約日在外月在內故能掩之人又在月內故見其掩而有食當其正相當一度謂之食甚如其合朔午正則以人當月以月當日相當繩直故無所差在午前以至於邜則漸差而早假如定朔夘正一刻日月合在一度是日月合朔本等時刻也人自地上觀之則不待其月之至於此度也當其夘初初刻月未及日一度時已見其合於日是差而早六刻有奇也若在午後以至於酉則漸差而遲假如定朔酉正一刻日月合在一度是日月合朔本等時刻也人自地上觀之則月𨿽已至此度尙未見其合也直至戌初一刻月行過於日將一度時始見其合於日是差而遲六刻有奇也其自夘而辰而已所差漸少至午正則復於無差也其自午而未而申積差以漸而多至酉則差而極於六刻有奇也蓋天體至圓其行至健運乎四虛地在其中爲气所團結而不散若卵之有黃夫卵旣圓矣黃安得獨方故地之方者其徳其體則不必正方如碁局也夫日月並附天行而月在日下當其合時去日尙不知有防許人自地上左右窺之與天心所見不同故日月平合在夘酉皆不能見所見食甚日稍在下月稍在上斜所當差近一度在月平行爲六百餘分惟午則自下仰觀所見正當繩直與在左右旁視者異故無差也昔人常云人能淩倒景以瞰日月則晦月之表光應如望吾亦云使人能逐景而行與日相偕則舉頭所見常如在午又使地如琉璃光人居其最中央旋而觀日八靣皆平時差之法可以不設矣是其所差不問盈縮遲疾而只在本日之加時故曰時差

推食甚定分法

視時差分如是中前分推得者置定朔小餘內減去時差分余爲食甚定分也如是中後分推得者置定朔小餘內加入時差分共得爲食甚定分也滿日周去之至入盈縮度再加之

按食甚食而甚也食甚分是自虧至復之中日月正相當於一度之時刻也中前減小餘者差而早也中後加小餘者差而遲也若夜刻不算者恐無滿日周去之之理末二句疑有誤

推距午定分法

置所推中前或中後分內加入時差分共得爲距午定分也

按定距午定分是食甚時刻距午正之數也食甚以時差加減距午則不減只加者蓋食甚原是順推故有加減距午分則一自午順推一自午逆溯總是差而漸逺於午正故也

推食甚入盈縮定度法

置前推或盈歷或縮歷初末全分加入定朔大餘及食甚定分內減去經朔全分余爲食甚入盈縮歷定度分也

按原推盈縮歷是經朔下者故以定朔大餘及食甚分加之減去經朔全分如以經朔大小餘加減作食甚大小餘故卽得食甚所入盈縮歷數也

推食甚入盈縮差度法

置所推食甚盈歷或縮歷全分減去大餘依朔下盈縮差法推入得食甚入盈縮差度分也如遇末限亦用反減半嵗周之數數止秒

按食甚盈縮歷旣異經朔則其所積盈縮之差亦不同故復求也

推食甚入盈縮歷行定度法

置食甚入盈縮歷全分以萬爲度內盈加縮減其所推食甚入盈縮差得爲食甚入盈縮歷行定度分也【末限不用數止秒】

按凡盈歷若干日卽是常數日行距冬至宿之度數也凡縮歷若干日卽是常數日行距夏至宿之度數也以其差加減之卽得所推食甚日躔距二至宿之度數也凡用末限者所以紀其差是逆從二至推至二分其差整齊易知也今不用末限者所以積其度是順從冬至數至夏至從夏至數至冬至也

推南北泛差度法

視所推食甚入盈縮歷行定度如在周天象限九十一度三一四三七五已下者爲初限也如在已上者置半嵗周內減去行定度余爲末限也或得初限或得末限俱自相乘之【初末限有十度上下各定三子單度各定二子言十加定一子】得數以一千八百七十度【去三子】爲法除之【不滿法去一子除過定有四子爲度三子爲十分○按上下各定二子則四子矣故四子爲度】復置四度四十六分【按四度四十六分者卽周天象限自乘復以一千八百七十度除之者】內減去得數條爲南北泛差度分也

推南北定差度法

置所推南北泛差全分【度定四子十分定三】以所推距午定分【千定三子百定二子】爲法乘之【言十定一】得數復以其所錄半晝分【去三子】爲法除之【不滿法去一子除過定有四子爲度三子爲十分也】仍置泛差減去得數余爲南北定差也若遇泛差數少不及減者反減之而得也又視其盈縮歷及所推正交中交限度如是盈初縮末者食在正交爲減差中交爲加差也如是縮初盈末者食在正交爲加差中交爲減差也若遇反減泛差者應加作減應減作加不可忽略也

按南北差者古人所謂气差也易之曰南北所以著其差之理也蓋日行盈初縮末限則在赤道南其逺於赤道也至二十三度九十分日行縮初盈末限則在赤道北其逺於赤道也亦二十三度九十分日之行天在月之上而髙故月道與黃道相交之度有此差數以南北而殊也假如盈初縮末限一日空日間日行赤道外極南去人極逺去地益近日道所髙於月道之中間人皆以旁觀之易得而見故月道之出黃道而南也較常期【所謂常期皆主春秋分日道而言卽所定中國正交度中交度也】早四度有奇其入黃道而北也較常期遲四度有奇由是以漸而至於盈初縮末八十八日行天漸滿一象限之時黃道之在赤道南者去赤道以漸而近去地之數以漸而逺其日髙月下相去之數人所從旁見者以漸而少故其所差四度有奇以漸而殺也又如縮初盈末限一日空日間日行赤道內極北去人益近去地益逺日道所髙於月道之中間人仰靣視之難得而見故月道之出黃道南而爲正交也較常期遲四度有奇其入黃道北而爲中交也較常期早四度有奇由是以漸而至於縮初盈末九十三日行天漸滿一象限之時黃道之在赤道北者去赤道以漸而近去地之數亦以漸而近其日髙月下相懸之數人所從旁見者又以漸而多故其所差四度有奇亦以漸而殺也四度四十六分者據其極差者言也以得數減之便是今所有差也然此皆據午地而言故以距午分乘之以半晝分除之便知今距午之地應分得差數凡防許而今已距午防許則此所有之差已不可用故以減原得泛差而知其尙餘防許之差爲定差也蓋於天則冬至夏至之黃道爲南北於地則加時在正子午爲南北今泛差之數近二至則多近二分則少是以天之南北而差定差之數近午正則多近日出沒時刻則少是以加時之南北而差也故曰南北差○月自黃道北出黃道南謂之正交卽經所謂交前陰曆交後陽曆也月自黃道南入黃道北謂之中交卽經所謂交後陰曆交前陽曆也○其南北泛差不及減反減者此帶食出入方有之何也此必是食甚定分在日入分已上或曰出分已下則其距午定分多於半晝分故乘除後得數亦多於泛差也不則以多除以少乘其數且不能與泛差相等況能多於泛差也愚故斷其爲帶食也泛差數少不及減是距午定分已過於半晝是在夜刻故反算其距子之數夫距子與距午其盈縮南北逺近並旁觀仰視之理正相反故加者減之減者加之以爲定差也

推東西泛差度法

置所推食甚入盈縮歷行定度就爲初限也去減半嵗周餘爲末限也以初末二限互相乘之【百度定四子十度定三子言十定一是也】得數復以一千八百七十度【去三子】爲法除之【不滿法去一子除過定有四子爲度三子爲十分】卽得所推東西泛差也

推東西定差度法

置所推東西泛差全分【度定四子千定三子】以所推距午定分【千定三子百定二子】爲法乘之【言十定一】得數以二千五百度【去三子】爲法除之【不滿法去一子除過定有四子爲度三子爲十分】視所推如在東西泛差以下者就爲東西定差度分也如在已上者倍其泛差內減去得數余爲東西定差度分也又視其盈縮歷及中前中後分與正交中交限度若是盈歷中前縮歷中後者正交爲減差中交爲加差也若是盈歷中後縮歷中前者正交爲加差中交爲減差也

按東西差卽古所謂刻差也易其名曰東西者其差只在東西也於天則近二分之黃道爲東西於地則近夘酉之時刻爲東西蓋日行在二至前後其勢平直日行在二分前後則其黃道與赤道縱橫交加其勢斜徑當其斜徑加時又當夘酉則有差也假如春分日在盈歷九十餘度其黃道之交於赤道自南而北勢甚斜徑若加時中前則是赤道倚而黃道橫也加時中後則是赤道倚而黃道縱也又如秋分日在縮歷九十餘度其黃道之交於赤道自北而南勢甚斜徑若加時中前則是赤道倚而黃道縱與盈歷中後同也加時中後則是赤道倚而黃道橫與盈歷中前同也黃道縱立於邜酉月道之出入亦從而縱正靣視之繩直相當其日內月外相去之中間人所見者少意與南北差縮初盈末正在人頂者同也故月道之出黃道南而爲正交也較常期遲四度有奇其入黃道北而爲中交也較常期早四度有奇此盈歷中後縮歷中前皆於正交以差加中交以差減也黃道橫偃於夘酉月道之出入亦從而橫人在赤道之北斜而望之其日內月外相去之中間皆得而見意與南北差盈初縮末橫偃南上漸近於地者同也故月道之出黃道南而爲正交也較常期早四度有奇其入黃道北而爲中交也較常期遲四度有奇此盈歷中前縮歷中後皆於正交以差減中交以差加也若盈縮歷當二分加時又在夘酉則其差之極四度有奇迨至二分前後黃道之斜徑以漸而平故其差亦以漸而少由是而至於二至黃道之斜徑依平而差亦復於平故曰二至無刻差也若加時不在夘酉則𨿽二分之黃道其差卻與他气不殊蓋其斜徑之勢亦以漸而平故也假如二分加時辰巳之間其定差則正與四立泛差等漸而至於午中則其差亦漸而復於平是其所差只在東西故曰東西差凡東西泛差近二分多是以天之東西而差也其定差以加時夘酉而多是以地之東西而差也以距午分乘之者距夘酉之數也以二千五百除之者日周四分之一乃夘酉距午之數也蓋此所謂泛差乃距午二千五百分時所有之差也乘除後得數若多於泛差是食甚距午分其數亦多於日周四分之一其加時乃在夘前酉後也夘前酉後之差於正夘酉者其數正與夘後酉前等故倍泛差減得數卽爲定差也凡差於南北者復於東西差於東西者復於南北並二差加減數總無過四度四十六分以是爲交度進退之極也蓋原所謂正交中交限各損陰曆六度余爲陽曆者乃是據中國地勢所差於南戴赤道之下者言人在赤道之北故所見黃道交處皆差而近北六度余此常數也若黃道在冬至橫於南上去人益逺故其交處差而北者又四度余而極是共差十度余矣若黃道在夏至去人反近正在中國人頂故其交處原差而北者乃復而南亦四度余而極是只差一度余矣此南北差之理據午上言也若移而至日岀入時則其橫於南上者已斜縱於夘酉其正當人頂者巳橫斜於夘酉所見差度以漸而平如常數故南北差近午多近日出沒則少也若黃道在春分而加時夘黃道在秋分而加時酉其勢皆橫偃於東西而與地相依故其交處益差而北又四度余而極是亦共差十度余矣若黃道在春分而加時酉黃道在秋分而加時夘其勢皆縱立於東西而與人相當故其交處原差而北者亦皆復而南四度余而極是亦只差一度余矣此東西泛差之理據夘酉而言也若移而至午則其橫偃於夘酉者反斜縱於午上其縱立於夘酉者反橫斜於午上所見差度自以漸而平如常數故東西差近夘酉多近午則少也假使人能正當赤道之下則兩極平見相望子午赤道平分界平夘酉則凡正交只在交終中交只在交中其气刻之差減正交加中交者則差而北其加正交減中交者則差而南當亦各四度有奇也今中國地勢則正在赤道之北故所見赤道皆斜倚於人之南其所見正交中交度常數亦皆因其赤道之斜倚者而斷惟其黃道交在四五之宿加時在巽坤之維則黃道之勢正自斜倚適如赤道之理而南北東西之差皆少與常數相依若黃道橫則其勢視赤道加偃故正交中交之度益差而北若黃道縱則其勢視赤道反直防有類於南戴日下之赤道故正交中交之度𨿽曰復差而南其實乃復於無差也凡縮初盈末而加時午盈歷而加時中後縮歷而加時中前皆黃道縱之類也其縮初盈末當午𨿽橫在天心然東西視之則亦縱也凡盈初縮末而加時午盈歷而加時中前縮歷而加時中後皆黃道橫之類也其冬夏至黃道當日出入其二分黃道當子皆黃道斜倚之類也

推日食在正交中交定限度

視所推日食在正交中交限度如食在正交者置正交度三百五十七度六十四分在中交者置中交度一百八十八度○五分俱以所推南北東西定差是加者加之減者減之卽爲所推正交中交定限度分也

按正交本在交終三百六十三度七十九分今曰三百五十七度六十四分者於陰曆本數內損六度余爲陽曆也中交本在交中一百八十一度八十九分今曰一百八十八度○五分者於陽曆本數外增六度余侵入陰曆也蓋黃道之於月道如大圓輪包小圓輪月在日內人又在月內而稍北日月交其南人自北斜而望之其月日相去中間獨得而見故其交處皆差而北也惟其交處差而近北故其交而南也早六度其交而北也遲六度此據中國地勢言在授時立法當只是據大都北極髙度斷之也若迆而漸南至於戴日之下所差當以漸而復其本度若迆而漸北以至於戴極之下所差當不知更有防許也又按此正交中交度增損六度者只是地勢使然巳爲常數其因時而差者又有南北東西二差於是復以加之減之而後乃今所推正交中交之度可得而定而後乃今交前交後陰陽曆可得而定矣

推日食入陰陽曆去交前交後度法

視所推交定度若在正交定限度已下者就於定限度內減去交定度余爲陰曆交前度也若在正交定限度已上者於交定度內減去正交定限度余爲陽曆交後度也又視其交定度若在中交定限度已下者就於定限度內減去交定度余爲陽曆交前度也若在中交定限度已上者於交定度內減去中交定限度余爲陰曆交後度也

按若交定度在七度已下者數𨿽在正交定限度下而實則爲陽曆交後度也法當置交定度加入交終度復減去正交定限度余爲陽曆交後度也【勿庵補】按凡交定度在正交後中交前者陽曆也其在正交前中交後者陰曆也若以東西南北差定之而正交度有加中交度有減者是陽曆變爲陰曆也其正交度有減中交度有加者是陰曆變爲陽曆也正交陽變陰中交陰變陽是交後變爲交前也正交陰變陽中交陽變陰是交前變爲中後也故必以所推正交中交定限度爲則與交定度相較而得合朔日躔距交前後的數也凡以交定度去減正交中交定限度者爲交前是逆從交處數來也其於交定度內減去正交中交定限度者爲交後是順從交處數去也又按交定度在七度已下食在正交也若以減正交定限度其所餘者當在三百五十度內外爲陰曆交前度也勿庵曰非也若然則凡正交七度已下者永不入食限不必布算矣況所謂陰陽曆者自正交中交而斷【正交後爲陽中交後爲陰】所謂交前後者皆附近正交中交前後而斷【正交後爲陽曆交後正交前爲陰曆交前中交後爲陰曆交後中交前爲陽曆交前】通交度分爲陰陽曆陰陽曆又各分前後安得有陰曆交前度乃多至三百五十餘度者乎此必無之理亦必不可通之數然則何以通之曰有法焉凡交定度在七度已下是其數不特在正交度下並在中交度下也然而又與中交數逺並亦不得減中交爲交前也夫在中交數下是陽曆非陰曆也不在交前是交後也夫陽曆交後度法當置交定度內減去正交定限度而此交定度數少不及減故必加入交終度而後可以減之也加入交終度減之則陽曆交後之度復其本位也則凡距交七度已下者皆得入陽食之限也然則歷經何以不云通軌何以闕載也曰是偶爾之遺也或姑略之以俟人之變通也或傳之久而失其眞所謂史有闕文也夫夏五傳疑三豕徴信各行其是而已爲其恐誤後學也故訂之然而古人不作吾亦安所取正乎可爲長嘆

推日食分秒法

視日食入陰陽曆交前交後度是陰者置陰食限八度是陽者置陽食限六度皆減去陰曆或陽曆交前交後度余【度定四十定三】爲實各以其定法是陰者置八十分陽者置六十分去爲法約之【不滿法去一子所定有二子爲單分一子爲十秒】卽得所推日食分秒也如陰陽食限不及減交前交後度者皆爲不食也

按陰食限八度者陰曆距交八度內有食也陽食限六度者陽曆距交六度內有食也凡合朔若正當交度其食十分漸離其處食亦漸少假如陽曆距交一度二十分則於食十分內減二分只食八分也又如陰曆距交二度四十分則於食十分內減三分只食七分也故合置陰陽食限以距交前後度減之卽是於食十分內減去若干分秒也其減不盡者則正是今所推合食之數故各以定法除之而得也凡陰陽定法皆十分其食限之一也如食限不及減爲不食者是距交前後之度多於陰陽食限其去交甚逺不能相掩斷爲不食也

推日食定用分法

置日食分二十分內減去推得日食分秒余【十分定三單分定二】爲實卽以日食分秒【單分定二】爲法乘之【言十定一所定有六子爲百分五子爲十分】卽爲所推開方積也立天元一於單微之下依平方法開之得爲開方數【有十定一】復以五千七百四十分【定五】爲法乘開方數【言十定一】得數又以所推定限行度【去四子空度去三子】爲法除之【不滿法去一子所定有二子爲百分一子爲十分】卽爲所推定用分也

按定用分者日食虧初復末中距食甚所定用之時刻也凡日食若干分則其所經歷凡有若干刻食分深者歷時久以月所行之白道長也食分淺者歷時暫以月所行之白道短也今所求開方之數卽自虧至甚或自甚至復月行白道之率也

月食只十分今用二十分者何也日月各徑十分其半徑五分凡兩圓相切則兩半徑聨爲一直綫正得十分爲兩心之距以此兩心之距爲半徑從太陽心爲心運規作大圓其外周各距日之邊五分爲日月相切時太陰心所到之界其大圓全徑正得二十分也

以日食分秒相減相乘何也此句股術中較求股法也依前所論初虧時兩圓相切其兩心之距十分此大圓之半徑常爲勾股之食甚時兩心之距如勾而太陰心侵入大圓邊之數如勾較自虧至甚太陰心所行白道如股而太陰心侵入大圓邊之數與食分正同蓋月邊掩日一分則月心亦移進一分也故卽以日食分秒爲勾較與大圓全徑二十分相減其餘卽爲勾和和較相乘爲開方積卽股實也其開方數卽股亦卽自虧至甚月心所行之白道矣其自食甚至復光理同

五千七百四十分乘者何也先求日食分秒及勾股開方等率皆就日體分爲十分其實日體不滿一度大約爲十之七耳五千七百四十者七因八百二十也月行一限得八百二十分其十之七則五百七十四分矣故以五百七十四分乘開方數爲實以定限行度除之爲定用分之時刻也

一率定限行度【爲本限月行遲疾之定率】

二率五百七十四分【爲十分八百二十而用其七】

三率開方數【卽自虧至甚或自甚至復月所行白道】

四率定用分【卽自虧至甚甚至復月行所歷之時刻】

初虧時兩心之距爲卽大圓二十分平徑食甚時兩心之距爲勾食甚時月心侵入圓界三分爲句較自虧至甚月心所行白道爲股甚至復亦仝此以月在陽曆日食三分爲例餘可仿推

【五千宜定三子防定五子者因此所謂分

乃度下二位分故加定二子也立大元一

子單防之下者如一子於實之微下一位

也所以然者前所推數皆止於秒秒以下

所棄者尙多故此於開積加之以湊平方

整齊也月食仿此】

推初虧復圓分法

置所推食甚定分內減去定用分爲初虧分不及減加日周【一萬】減之復置食甚定分加入定用分爲復圓分滿日周去之時刻依合朔法推之

按食甚者食之甚食之中也日月正相當於一度也初虧者虧之初食之始也月始進而掩日也復圓者復於圎食之終也月已掩日而退畢也凡言分者皆時刻也蓋初虧在食甚前防刻故減小餘復圓在食甚後防刻故加小餘初虧距食甚時刻正與食甚距復圓數等故皆以定用分加減之也月食仿此又按據加日周減滿日周去二語定用分當不止此數也

推日食起復方位法

視所推日食入陰陽曆如是陽曆者初起西南甚於正南復圓於東南也如是陰曆者初起西北甚於正北復圓於東北也若食在八分已上者無論陰陽曆皆初起正西復圎於正東也

按日食起復方位主日體言之卽人所見日之上下左右也以午位言則左爲東右爲西上爲北下爲南也日食入陰陽曆者主月道言之月在日道南爲陽曆月在日道北爲陰曆也如是陽曆食是月在日南掩而過故食起西南甚於正南復於東南也如是陰曆食是月在日北掩而過故食起西北甚於正北復於東北也其食在八分已上者是月與日相當一度正相掩而過故食起正西復於正東其食甚時正相掩覆而無南北不言可知也凡日月行天並自西而東日速月遲其有食也皆日先在東月自西追而及之旣相及矣則又行而過於日出於日東故日食虧初皆在西復末皆在東也○又按歷經云此所定起復方位皆自午地言之其餘處則更當臨時消息也推帶食分法

視朔下盈縮歷與太陽立成同日之日出入分如在初虧分已上食甚分【按食甚當作復圓】已下爲帶食之分也若是食在晨刻者置日出分昏刻者置日入分皆與食甚分相減余爲帶食差也置帶食差【百定六十定五】以所推日食分秒【十定五單定四】爲法乘之【言十定一】得數以所推定用分【百去六子】爲法除之【不滿法去一子所定有五子爲十分四子爲單分三子爲十秒】得數去減所推日食分秒余上下四處皆爲帶食也已見未見之分也按帶食分者日出入時所見食分進退之數也假如日出分在初虧分已上是初虧在日未出前但見食甚不見虧初也日入分在初虧分已上是食甚在日入後但見虧初不見食甚也又如日出分在復圎分已下是食甚在日未出前不見食甚但見復末也日入分在復圓分已下是復圓在日入後不見復末但見食甚也見食甚不見虧初是食在未出已有若干尙有見食若干帶之而出甚食爲進也見初虧不見食甚是食在未入見有若干尙有不見食若干帶之而入其食亦爲進也不見食甚但見復末是食在未出前已復若干尙有見復光若干帶之而出其食爲退也不見復末但見食甚是食在未入前見復若干尙有未復光若干帶之而入其食亦爲退也凡此日出入所帶進退分秒何以知之則視其帶食而出爲晨刻者置日出分其帶食而入爲昏刻者置日入分皆以食甚分與之相減而得帶食之差也假如日出分在初虧分以上其食甚分又在日出分已上則以日出分減其食甚分其減不盡者則是日出已後距食甚之時刻也若日入分在初虧分已上其食甚分又在日入分已上則以日入分減其食甚分其減不盡者則是日入已後距食甚之時刻也又如日出分在復圓分已下其食甚分又在日出分已下則於日出分內減去食甚分其減不盡者則是日出以前距食甚之時刻也若日入分在復圓分已下其食甚分又在日入分已下則於日入分內減去食甚分其減不盡者則是日入已前距食甚之時刻也凡此帶食差分用乘日食分秒又以定用分除之便知日出入時所距食甚時刻在定用分全數內占得防許卽知日出入時所帶食分於日食分秒全數內占得防許也以得數減食分所餘分秒卽是日出入前距虧初已過食分或日出入後距復末未見食分也上下兩處者得數與減余兩處之數也見未見之分卽已復未復已食未食如後二條所列也

推日有食例

置日出入分內減去食甚分謂之已復光未復光將所推帶食分錄於前

晨【日未出已復光若干日已出見復光若干】昏【日未入見復光若干日已入未復光若干】

置食甚分內減去日出入分謂之見食不見食將所推帶食分錄於後

晨【日未出已食若干日已出見食若干】

昏【日未入見食若干日已入不見食若干】按置日出入分內減去食甚分者其日出入分皆在復圓分已下也故謂之已復光未復光假如日食甚五分在日出入前其帶食三分以之相減尙餘二分若在晨刻是日未出前已復光三分日已出後見復光二分也若在昏刻是日未入前見復光三分日已入後未復光二分也此二端帶食分皆是已復光數故錄於前也其以帶食分減之而餘者則是未復光數故錄於食之後也置食甚分內減去日出入分者其日出入分皆在初虧分已上也故謂之見食不見食假如日食甚五分在日出入後其食三分以之相減尙餘二分若在晨刻是日未出前已食二分日已出後見食三分也若在昏刻是日未入前見食二分日已食後不見食三分也此二端帶食分皆是未食數故錄於後也其以帶食分減之而餘者則是已食數故錄於食之前也月食仿此但以日之昏爲月之晨以日之晨爲月之昏蓋日出於晨入於昏月出於昏入於晨也其餘皆同

推黃道定積度法

置所推食甚入盈縮歷行定度如是盈歷者內加入天正黃道箕宿度共得爲黃道定積度也如是縮歷者內加入半嵗周及天正箕宿黃道度共得爲黃道定積度也

按黃道定積度者逆計食甚日躔度距天正冬至日躔宿度積數也盈歷加入天正黃道箕度者是逆從天正冬至所躔宿初度積算起也縮歷復加半嵗周者縮歷本數是以夏至度起算今加入半嵗周又加入天正箕宿度是變而加盈歷亦以天正冬至箕宿初度起算也所得定積度卽是今所躔宿度與箕宿初度相距逺近之數也

推食甚日躔黃道宿次度法

置所推黃道定積度無論盈縮歷皆以黃道各宿次積度鈐挨及減之餘爲食甚日躔黃道某宿次度分也按所推黃道定積度無問盈縮皆是今食甚躔度前距箕宿初度之積數也然尙未知其爲黃道何宿度也故以黃道各宿積度鈐取其相挨及者減之其減去者是今積度內已滿其宿之度日躔已過此宿斷爲前宿也其不及減而餘者則是前宿算外所餘度分也是日躔正在此宿中未過故其積度亦未滿當卽以所減算外之度分斷爲食甚日躔某宿防度防分也假如食甚定積十度則以箕宿積度九度五九減之餘○度四十一分爲箕宿算外餘數斷爲食甚日躔黃道斗宿初度四十一分也餘仿此

按黃道積度鈐皆自箕初度積至其宿垜積之數也假如日躔斗二十三度四七加入箕宿九度五九則已共積得三十三度○六也又如日躔牛六度九十分加入斗二十三度四七又加入箕九度五九共積得三十九度九六也餘仿此

又按凡言鈐者皆豫將所算之數並其已前之數朶積而成以便臨算取用意同立成也𨿽然黃道不可以立鈐算者當知黃道度之所由生則可以斷其是非矣蓋黃道積度生於其宿黃道度各宿黃道度皆生於赤道赤道三百六十五度二五七五而其各宿度數不同者則以二至二分所躔不同也黃道近二至則其度視赤道損而少黃道近二分則其度視赤道益而多蓋赤道平分天腹適當二極之中所紀之度故終古而不易黃道不然其冬至則近南極在赤道外二十三度九十分其夏至則近北極在赤道內亦二十三度九十分其自南而北自赤道外而入於其內也則交於春分之宿其自北而南自赤道內而出於其外也則交於秋分之宿交則斜所占分數多此處占多則二至之黃道所占數少理勢然也黃道之損益旣系於分至分至旣以嵗而差黃道積度是必毎嵗不同古人則旣言之矣此所載者猶據授時歷經所測黃道之度乃至元辛巳一年之數也上考下求數十年間則皆有所不合況距今三百八十餘算積差尢多安得海制此鈐以盡古今之無窮乎今仍以授時歷經黃赤道差法求得天啟辛酉年黃道積度如左

依授時歷經求得天啟辛酉年黃道積度

天正冬至赤道箕宿四度九○

赤道四象積度

右夏至後一象之度﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷七﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷七﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷七﹥

已上度鈐俱據辛酉嵗差所在步定俟嵗差移一度時再攺步之又按歷經有增周天加嵗差法因前所推俱依通軌故仍之

大統歷志卷七

欽定四庫全書

大統歷志卷八

宣城梅文鼎撰

月食通軌

錄各有食之望下等數

經望全分

盈縮歷全分

盈縮差全分遲疾歷全分

遲疾限數

遲疾差全分加減差全分

定望全分【某甲子將本日日出分推在夘時何刻望在何刻已下者退一日也○按說見定朔望條夘時者舉例言其實卽以日出分如發斂條求之便得某時刻又按其定望退一日法只據其小餘在日出分已下者斷之並不必求時刻也】

交泛全分

定入遲疾歷

定入遲疾限【此限與前同者便不必書出損益分並行度○按其實此處損益分不言何用似總不必書出】

定限行度

晨分【月出之時刻也先於復圓者有帶食】

日出分

日入分

昏分【月出之時刻也復於初虧有帯食○按載晨昏分者所以定更防也其帶食分只用日出入分不用晨昏蓋晨刻日未出月則猶見昏前日已入月則已見也○注誤】

天正赤道度

天正黃道度

交定度【以上諸法皆與日食同】

推邜酉前後分法

視定望小餘如在二千五百分已下者就爲邜前分也如在已上者去減半日周五千分余爲邜後分也又如在七千五百分已下者內減去五千分就爲酉前分也如在已上者去減一萬分余爲酉後分也【已上已下皆指定望小餘而言】

按凡邜酉前後分皆據子午言之邜前分是距子正後之分也故卽以小餘在夘前者定之邜後分是距午正前之分也故以小餘減半日周其餘則是自午正逆數以前距數也酉前分是距午正後之分也故以半日周減小餘其減不盡者則是自午正順數以後距數也酉後分是距子正前之分也故以小餘減日周其餘則是自子正逆數以前距數也

推時差分法

置日周一萬內減去邜前邜後分或酉前後分【滿千分者命爲十分滿百分者命爲單分】得爲時差分也

推食甚定分法

置所推時差分加入定望小餘共得爲食甚定分也按气刻時三差皆起於唐長慶中宣明歷於日食用之月食則皆不用後之諸歷或有用月食時差者其數大約與日食相仿皆於近邜酉則差稍多近子午則差漸少其以之定食甚分則皆子前減子後加以加減其定望小餘而得也所異者朔食時差多望食時差少耳今依通軌所載推之則近邜酉者差反少近子午者差反多又不問子前子後皆以加定望小餘而無減法種種皆與歷經相反則何如不用之爲得乎且日食何以有時差以月之掩日去日尙逺也日光尙在但不見耳據所不見而言之故以時而差若月食則不然闇虛者日气所衝食則與月相著譬如呵气著鏡光體盡虧一如晦朔安得有左右視之差乎此唐宋諸歷所以多不用也卽曰用之所差不過九十餘分然亦不至反其所用如此也竊依元史所載月食時差法定之如左

依歷經求月食甚定分法

置卯酉前後分【有千法實皆定三有百法實皆定二】自相乘【言十加定一子】退二位去二子如四百七十八而一【去二子不滿法又去一子以所定二子爲百分一子爲十分】爲時差子前以減子後以加皆加減定望分爲食甚定分依發斂求之卽食甚辰刻

按卯酉前後分卽前所推卯前卯後分或酉前酉後分自相乘者如求南北差法卽以所得卯酉前後分爲法與實也凡卯酉前後分皆自子午起算以自相乘則近卯酉差多近子午差少矣退二位法同日食時差以得數後有百萬退作萬有十萬退作千而後歸除之也如四百七十八而一者是以四百七十八歸除之如四百七十八分爲一分也子前減子後加者凡望時之月在日所衝故日在子前月乃在午前其日食午前減故月食亦子前減也日在子後月乃在午後日食午後加故月食亦子後加也其差多者不過一百三十分有奇而止故以四百七十八爲法歸除之也

推食甚入盈縮歷及食甚入盈縮差並食甚入盈縮歷行定度三法俱與日食同只換望日

推月食入陰陽曆法

視所推交定度如在交中度一百八十一度八九六七已下者便爲入陽曆也如在已上者內減去交中度余爲入陰曆也

按交中度數原生於陰陽曆月入陽曆則在黃道南行一百八十一度有奇畢復入黃道北而行陰曆一百八十一度有奇畢則又復入陽曆矣行陽曆陰曆各一次謂之交終半之爲交中今交定度在一百八十一度已下是月尙在黃道南就爲入陽曆度數也其在已上者是月已在黃道北故於交定度內減去一百八十一度八九六七餘者命爲入陰曆度數也陽曆數自交初起算陰曆數自交中起算也

推交前交後度法

視所推月食入陰陽曆如在後凖一十五度五十分已下者便爲交後度也如在前凖一百六十六度三九六八已上者置交中度內減去陰陽曆爲交前度也按凡言交者皆月出入黃道十字相交之際也凡陰曆在後凖已下者是距陽曆交陰曆後未逺尙在十五度內故爲陰曆交後度也凡陰曆在前凖已上者是逆距陰曆交陽曆前已近只在十五度內故爲陰曆交前度也陽曆同十五度五十分者月食限一十三度○五分或有十五度五十分而入食限者蓋以盈縮差加減之則亦十三度有奇故以十五度五十分爲食凖也其前凖度𨿽多逆計其所距後交之數亦同也

推月食分秒法

置月食限一十三度○五分內減去交前或交後度【十度定三單度定二○按定子法疑有誤若如所云則月食必無十分者安得有旣內外之分乎愚意當是十度定五單度定四也】以定法八十七分【去一】爲法除之【不滿法去一子所定有三子爲十分二子爲單分】得爲月食分秒也不及減者必不食也十分已下者用三限辰刻法十分已下者用五限辰刻法按月食限度多於日食者闇虛大而月小也故不問陰陽曆只距交前後一十三度○五分內卽能相掩而有食也凡定望正當交度其食十五分漸離其處食分漸殺假如距交前後一度七十四分則於食十五分內減二分只食八分又如距交前後九度五十七分則於食十五分內減一十一分只食四分也故置食限一十二度○五分以距交前後度減之卽如於食十五分內減去若干分秒也其減不盡者則正是今所合食之分秒故以定法除之而得蓋月食定法卽十五分其食限之一也如食限不及減爲不食者是距交前後度多於月食限是已在十三度○五分之外闇虛𨿽大至此亦不能相掩斷爲不食也推月食定用分法

置月食分三十分減去所推月食分秒余【十分定三單分定二】爲實卻以月食分秒【十分定三單分定二○按十分宜定一今加定三子者以分下有十有秒也故亦以定六子爲百分法實共知定四子也】爲法乘之【言十定一定有六子爲百分五子爲十分】得爲開方積立天元一於單微之下依平方法開之得爲開方數【有十定一】復以四千九百二十分【定五○按以六分乘八百二十分得四千九百二十分又按元史數同日食】爲法乘開方數【有十定一】得數又以其前推得定限行度【去四子空度去三子】爲法除之【不滿法去一子定有二子爲百分一子爲十分】得爲所推定用分也

定用分者亦月食自初虧復距食甚之時刻也然日食只十分而月食則有十五分者闇虛大也闇虛之大幾何曰大一倍何以知之以算月食用三十分知之也依日食條論両圓相切法闇虛半徑十分月半徑五分両邊相切則両半徑聨爲一直綫共十五分爲両心之距以此距綫用闇虛心爲心運作大圓正得全徑三十分也此大圓邊距闇虛邊四周各五分爲両圓相切時月心所到之界其両之距十五分卽大圓半徑常用爲而以食甚時両心之距爲勾食甚時月心侵入大圓邊之數爲勾較其數與月食分秒同以此與大圓全徑相減余卽勾和和較相乘爲股實開方積也其開方數爲股卽自虧復至食甚月心所行之白道也

四千九百二十乘者何也依日食條論又是十分八百二十而用其六也蓋所得月體又小於日一分也然歷經所用與日食同此不同者蓋攺率也或亦攺三應數時所定而作史時未入如盈縮立成等耳推三限辰刻等法

置所推食甚定分內減去定用分余爲初虧分也不及減者加日周減之復置食甚定分內加入定用分共得爲復圓分也滿日周去之時刻依合朔推之

按三限辰刻同日食理不復贅

初虧時兩心之距爲卽

大圓三十分半徑

食甚時月心侵入大圓界

八分爲勾較

自虧至甚月心所行之度

分爲股甚至復亦同

此以月食八分爲例余可

仿推

又此系陽曆故月在闇虛

南若陰曆反此論之

推旣內分法

置月食限一十五分【按歷經作月食旣一十分今從之】內減去所推月食分秒自單以下全分余【十分定二單分定三○句誤按此處無十分當是有分定二十秒定一也】爲實卻以月食分秒自單分以下分秒【單分定二十秒定一】爲法乘之【言十定一所定有五子爲十分四子爲單分】得爲開方積立天元一於單微之下依平方法開之得爲開方數就置開方數【十分定五單分定四○按十分定五句誤此處開方數必無十分當作十秒定三有分定四也分加定四子者以有秒微也】復以四千九百二十分【定五】爲法乘之【言十定一】得數又以所推定限行度【去四子空度去三子】爲法除之【不滿法去一子所定有六子爲百分五子爲十分】得爲所推旣內分也

按歷經原是以旣內分與一十分相減相乘此則攺爲一十五分今以大圓掩小圓率求得旣內小平圓徑一十分與歷經合故斷從歷經也

月食十分則旣矣此時月體十分全入闇虛而月之邊正切闇虛之心兩心之距正得五分以此五分爲半徑自闇虛心作小平圓其全徑十分其邊各距闇虛心五分爲食旣時月心所到之界過此界則爲旣內矣假如月食十二分食旣時月心正掩小圓之邊食甚時月體則入闇虛內二分而月心亦侵入小平圓二分故卽用此二分爲勾較以與小平圓全徑相減余爲勾和和較相乘得積開方得股卽月心從食旣至食甚在闇虛內所行小平圓之白道也於是亦如前法變爲度分而計其行率則知月入闇虛以後行至食甚所歷時刻之數而命爲旣內之分也此旣內分食甚至復圓同論乙爲闇虛心初虧時月心在甲以其邊切闇虛於庚兩心

之距爲乙甲與壬乙

等大圓半徑十五分

也爲大食甚時

月心行至丁丁甲度

分爲自虧至甚之行

與甚至復丁戊之行等爲大

股丁乙三分食甚時兩心之

距也爲勾壬丁十二

分食甚時月心侵入大圓內之數也爲勾較食旣時月心在丙丙心之距乙丙與生光之時己乙之距等小平圓半徑五分也爲小丙丁爲月心自旣至甚之行與自甚至生光己下之行等爲小股丁巳三分仍爲勾午丁二分爲食甚時月心侵入小平圓之數爲勾較丙至丁所歷時刻與己丁時刻等是爲旣內分甲至丙所歷時刻與已至戊等是爲旣外分此以陰曆月食十二分爲式餘皆仿論

開方數

壬丁十二丁癸十八相乘二一六平方開之得丁甲十四【六九】午丁二分丁艮八分相乘十六平方開之得丁丙四分

推旣外分法

置所推定用分內減去旣內分余爲旣外分也

按旣外分者是月食初虧至食旣生光至復圓所占時刻也原所推定用是自虧初復末中距食甚之數則是旣內旣外總數也故於其中減去旣內所占時刻其餘便是旣外時刻也

推五限辰刻等法

置食甚定分內減去定用分爲初虧分初虧分加旣外分爲食旣分食旣分加旣內分爲食甚分食甚分加旣內分爲生光分生光分加旣外分爲復圓分也不及減者加日周減之滿日周去之推時刻同前

按月食所以有五限辰刻異於日食者日食只十分故其食而旣也卽其食甚也才食而旣其光卽生則其生光之分亦卽其食甚也若月食則十五分自食旣以至生光歷時且久爲刻皆殊中折二數以知食甚縂計虧復故有五限也以定用減小餘者所算定用原是食甚距初虧之數也故以減食甚得初虧以旣外加初虧及生光者所算旣外原是初虧距食旣生光距復圓數也故以加初虧得食旣以加生光得復圓至於所算旣內原是食旣至生光折半之數卽是食旣生光中距食甚之數也故以加食旣得食甚以加食甚得生光不及減加日周者是食甚在子正後初虧等在子正前也加滿日周去之者是食甚等在子正前復圓等在子正後也凡言時刻同前者皆用發斂也

推月食入更防法

視望下盈縮歷與太陽立成同日之日晨分就加一倍得數用五千分而一【句誤按當作五而一下同】得爲更法分也【定數滿法得十分不滿法得百分也】將更法又用五千分而一得爲防法分也【定數滿法得百分不滿法得十分也○句誤甚按當作滿法者百已上不滿法者二百已上也大約更法有千者則不滿法】

按更防倍晨分者凡日入後二刻半而昏日未出前二刻半而晨晨則辧色未昏則不禁行晨昏啟閉以此爲節是益晝五刻損夜五刻聖人扶抑之道無所往而不存也其晨分皆自本日子正距異之數夜之有晨分猶日之有半晝分也逆推子正前距昏之數正與相等故倍其晨分卽爲全夜之刻也於是以五除之卽其夜每更所占時刻之數也假如晨分二千五百倍之五千五除之則知毎一更分占有一十分也滿法者是在五千分已上故知得數爲千分不滿法者是在五千分已下故知得數爲百分於是又置更法以五除之卽其夜毎防所占刻數也假如更法分一千五除之則知毎防中占有二百分也其防法得數無論滿法不滿法縂是百分不必定數蓋千已上數則不滿法豈有轉少作十分之理十分句誤又除法只是單五毎夜五更毎更五防五千分誤當作五而一或以五除之也

推初虧等更防法

視初虧分如在晨分已下者就加入晨分共爲初虧更分也如在昏分已上者內減去昏分余爲初虧更分也卻以元推更法分爲法除之命起一更算外得爲初虧更數也將減余不及滿更法數卻以元推防法分爲法除之命起一防算外得爲初虧防數也次四限更防仿此而推各得更防也【若在日入已上昏分已下者命爲昏刻若在日出以下晨分以上者命爲晨刻皆無更防】

按初虧等分如在晨分已下者是在子後也加入晨分是逆從子前昏刻算起也其在昏分已上是在昏後也故減去昏分卽是減去晝刻截從初昏算起也究之二者則總是從初更初防起算其加後減後則知此所得數距初更初防已若干數於是以本日更法爲法除之其滿過更法有幾數便知已過幾更故算外命爲更數也其不滿更法而餘者則正是初入此更已來未滿之數故又以防法除之其滿過防法有幾數便知在此更中已過幾防故算外命爲防數便知所推初虧等尙在第幾更第幾防中未滿也其有總不滿更法數者則只是初更其有以防法除縂不滿法者則只是初防也

推月食起復方位法

視月食入陰陽曆如是陽曆者初起東北食甚正北復圓於西北也如是陰曆者初起東南食甚正南復圓於西南也若食在八分已上者無論陰陽曆皆初起正東復圓於正南也

按月食起復方位主月體言之卽人所見月之上下左右也以卯位言之則東爲下西爲上北爲左南爲右也以酉位言之則東爲上西爲下南爲左北爲右也月食入陰陽曆亦主月道言之如是陽曆食是月在日道南闇虛掩之者在其北故食起東北甚於正北復於西北也如是陰曆食是月在日道北闇虛掩之者在其南故食起東南甚於正南復於西南也其食在八分已上者是月食闇虛正相掩而過故食起正東復於正西也凡闇虛在日所衝太陽毎日行一度闇虛隨之而移月之行天旣視闇虛爲速故其食也皆闇虛光在東月自西來道有必經無所於避遂入其中而爲所掩旣受謫矣則始能行而出於闇虛之東卻視闇虛又在月西故月食虧初皆在東復末皆在西也又按歷經此亦據午地言之

推月有食分法同日食推

月有食例

昏【月未出已復光若干月已出見復光若干】晨【月未入見復光若干月已入未復光若干】昏【月未出已食若干月已出見食若干】

晨【月未入見食若干月已食不見食若干】按月帶食法同日食而只互易其晨昏書法者何也蓋月食於望望者日月相望故日出則月入月出則日入故易日之昏爲月之晨易日之晨爲月之昏也其所以同者何也假如日入分在復圓分已下是復圓在日入月出後於日爲見食甚不見復末者於月則見爲復末不見食甚也若日出分在復圓分已下是復圓在日出月入後於日爲見復末不見食甚者於月則爲見食甚不見復末也之二者總是以食甚分減其日出入分其所推帶食分則總是日月出入前距食甚之數其以減食分而餘者亦總是日月出入後未復光之數故總謂之已復光未復光而以所推帶食分錄於前也又如日入分在初虧分已上是初虧在日入月出前於日爲見虧初不見食甚者於月則爲見食甚不見虧初也若日出分在初虧分已上是食甚在日出月入後於日爲見食甚不見虧初者於月則爲見虧初不見食甚也之二者總是以日出入分減其食甚分其所推帶食分則總是日月出入後距食甚之數其以減食分而餘者亦總是日月出入前已食之數故總謂之見食不見食而以所推帶食分錄於後也余詳日食○又按歷經月食旣者以旣內分減帶食差余進一位如旣外分而一以減旣分卽月帶食出入所見之分不及減者爲帶食旣出入蓋凡所推帶食差是食甚所距日出入數今以旣內分減之而餘者卽是日出入後距食旣前或日出入前距生光後其間所有時刻也進一位者卽是以旣分乘之也又以旣外分除之則知其食旣生光距日出入時於旣外全數中分得防許時刻卽知其於食旣全數內分得防許食分也故以減月食旣十分卽爲月帶食出入之分也不及減者是帶食差少於旣內分其日出入分已在旣內分內故爲帶食旣出入也

推食甚月離黃道宿次度法

置元推食甚入盈縮歷行定度全分如是盈歷者加半周天一百八十二度六二八七五及天正黃道箕宿度共得爲黃道定積度也如是縮歷者正加天正黃道箕宿度內減去七十五秒余爲黃道定積度也無論盈縮歷皆以其黃道各宿次積度鈐挨及減之餘爲食甚月離黃道某宿次度分也

按月食黃道之積度者逆計月離度前距天正日躔宿度之數也元推食甚入盈縮歷行定度則是所求日躔距天正宿度數乃月食所衝也如日在北正月食於南正故盈歷加半周天便是食甚月離宿度又加天正箕宿度便知食甚月離距天正黃道箕宿初度若干也其縮歷行定度則是日躔距夏至宿度數故卽用其數爲月離蓋月食日衝日躔夏至宿後第防度月食亦卽在冬至宿後第防度故不必加半周天也內減去七十五秒者盈歷縮歷相距半嵗周不及半周天七十五秒其今嵗縮歷以後距來嵗盈歷亦止半嵗周若論其後距本嵗盈歷則反多一分五十秒卽多於半周天七十五秒也減此益彼卽各相距半周天平分天度而相望其衝也其止加天正箕宿度意同盈歷其不問盈縮皆減黃道積度鈐是算外命宿度同日食不贅

依授時歷經黃赤道法【勿庵補定】

求四正後赤道積度

置天正冬至所在宿赤道全度以天正赤道減之餘爲距後度以赤道宿度累加之卽得其宿距冬至後赤道積度加滿象限去之爲四正宿距後度亦以赤道宿度累加之滿象限去之卽各得其宿距春分夏至秋分後赤道積度

按四正者四時正气卽二至二分也凡天正赤道度是前距其宿初度之數故以減其宿全度卽各得後距其宿末度之數也於是以後宿赤道累而加之卽知各至後各宿距冬至度所積之度也滿象限去之者加滿象限是其宿當四正所在故減去象限卽知四正所在後距其宿末度之數也於是又以赤道各宿度累而加之卽各得四正後每象宿所距四正度之數也

求赤道變黃道

置各宿距四正後赤道積度用黃赤道立成視在至後者以第三格赤道積度相挨者減之餘【有十定三有分定二】爲實以上第二格黃道率乘之【不用乘只加定四子】以下第四格黃道率爲法除之【有度去四有十去三不滿法再去一視定有四子爲度三子爲十分】加入第一格黃道積度卽爲其宿距至後黃道積度其夏至後再加半周天卽各得其宿距天正黃道積度也若在分後者以第一格赤道積度相同者減之只用小餘【有十定三有分定二】爲實以下第四格黃道率爲法【有度定四空度定三】乘之【言十定一】得數以上第二格赤道率除之【不用除只去四子視定有四子爲度三子爲十分】加入第三格黃道積度卽得其宿距分後積度其春分後再加一象限其秋分後再加三象限卽各得其宿距天正黃道積度也於是各置其宿距天正黃道積度以其前宿黃道積度減之卽各得其宿黃道本度也秒就近約爲分

按至後不用乘者其立成黃道率只是一度乘過數不動故只加定四子也分後不用除者其立成赤道率亦是一度除過數亦不動故只虛去四子也夏至後加半周天春分後加一象限秋分後加三象限者此所求黃道積度皆距四正起算故各以四正距天正黃道數加之卽其宿前距天正之數也蓋至後黃道𨿽減於赤道分後黃道𨿽加於赤道其實至四立之後則加之極而反減減之極而反加總計一象皆得九十一度有奇此天道所以如環平陂往復間不容髮也減前宿積度爲其宿本度者積度旣是距天正數原包有前宿在內故減之卽得本度也【秒就近約爲分者凡秒五十已上收爲分已下棄之就整數也其七十五秒寄虛度】

求天正冬至黃道度

置周天度三百六十五度二五七五內減去天正前一宿距天正黃道積度余命爲天正冬至宿黃道度分也若逕求者置象限以其年天正赤道度減之餘爲天正前宿距秋分後赤道積度依赤道變黃道法求出其宿距分後黃道積度以減象限余卽命爲天正黃道度按周天度是自天正後積至天正前黃道總數故減去前宿距天正黃道積度卽得天正距所在宿初度之數也逕求法除象限者卽是自天正前距秋分後赤道總數也內減去天正赤道度其餘卽是前宿距秋分後赤道積度也赤道變黃道法卽是以立成第一格積度減余以第四格度率乘以第一格度率除加入第三格積度而命爲前宿距秋分後黃道積度也又以減象限者此所爲象限卽是自天正前距秋分後黃道總數故減去前宿距秋分黃道積度其餘卽是天正冬至距其宿初度黃道之數也

求黃道宿積度定鈐

置天正冬至宿黃道度及分如入其宿距至後黃道積度及分共得爲天正冬至宿黃道定積度以各宿黃道度累加之卽各得其宿黃道定積度

按分至每嵗有差黃道卽因而易卽不能毎嵗步之當於六十六年嵗差一度時更定度鈐始爲無也凡冬至所在宿皆有前後距其黃道皆減於赤道今所推其宿至後積度是自冬至日躔後距其宿末度黃道數其天正黃道宿度則是自冬至日躔前距其宿初度黃道數也合二數則是自其宿初度距其宿末度總數故卽命爲天正宿定積度也於是以各宿黃道度累加之卽各得其宿所距天正宿初度之數而命爲定積度也

求日月食甚宿次黃道度及分秒法同通軌

又術置所推食甚盈縮歷縮歷加半周天爲黃道定積度月食盈縮歷俱加半周天滿周天分去之爲黃道定積度皆逕以距天正黃道積度相挨者減之卽各得日月食甚黃道宿度及分秒

按此法不用定積度鈐故亦不加天正黃道度然必毎年步定黃道積度方可用之也

赤道宿度

角十二【一十】

亢九【二十】

氐十六【三十】

房五【六十】

心六【五十】

尾十九【一十】

箕十【四十】

右東方七宿七十九度二十分

斗二十五【二十】

牛七【二十】

女十一【三五】

虛八【九十五太】

危十五【四十】

室十七【一十】

壁八【六十】

右北方七宿九十三度八十分太

奎十六【六十】

婁十一【八十】

胃十五【六十】

十一【三十】

畢十七【四十】

觜初【五】

參十一【一十】

右西方七宿八十三度八十五分

井三十三【三十】

鬼二【二十】

栁十三【三十】

星六【三十】

張十七【二十五】

翼十八【七十五】軫十七【三十】

右南方七宿一百○八度四十分

黃赤道立成

積度度率積度度率積差差率

﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷八﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷八﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷八﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷八﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷八﹥﹤子部﹐天文算法類﹐推步之屬﹐大統歷志﹐卷八﹥

附郭守敬傳

初劉秉忠以大明歷自遼金承用二百餘年浸以後天議欲修正而卒十三年江左旣平世祖思用其言遂以守敬與王恂率南北日官分掌測驗推步於下而命張文謙與樞宻張易爲之主領裁奏於上左承許衡參預其事守敬首言歷之本在於測驗而測驗之器莫先儀表今司天渾儀宋皇祐中汴京所造不與此處天度相符比量南北二極約差四度表石年深亦復欹側守敬乃盡考其失而移置之旣又別圖髙爽地以木爲重棚創作簡儀髙表用相比覆又以爲天樞附極而動昔人嘗展管望之未得其的作極儀極辰旣位天體斯正作渾天象象𨿽形似莫適所用作玲瓏儀以表之矩方測天之正圜莫若以圜求圜作仰象古有經緯結而不動守敬易之作立運儀日有中道月有九行守敬一之作證理儀表髙景虛罔象非眞作景符月𨿽有明察景則難作闚幾歷法之驗在於交防作日月食儀天有赤道輪以當之兩極低昂標以指之作星晷定時儀又作正方案九表懸正儀座正儀爲四方行測者所用又作仰規覆矩圖異方渾蓋圖日出入永短圖與上諸儀互相參考十六年攺局爲太史院以恂爲太史令守敬爲同知太史院事給印章立官府及奏進儀表式守敬當帝前指陳理數至於日晏帝不爲倦守敬因奏唐一行開元間令南宮說天下測景書中見者凡十三處今疆宇比唐猶大若不逺方測驗日月交食分數時刻不同晝夜長短不同日月星辰去天髙下不同卽日測驗人少可先南北立表取直測景帝可其奏遂設監候官一十四員分道而出東至髙麗西極滇池南逾珠崖北盡鐵勒四海測驗凡二十七所十七年新曆告成守敬與諸臣同上奏曰臣等竊聞帝王之事莫重於歷自黃帝迎日推防帝堯以閏月定四時成嵗舜在璇璣玉衡以齊七政爰及三代歷無定法周秦之間閏餘乖次西漢造三統歷百二十年而後是非始定東漢造四分曆七十年而儀式方備又百二十一年劉洪造乾象歷始悟月行有遲疾及魏黃初間始以日食課其疎宻魏楊偉作景初曆始立交食起虧術又百八十年姜岌造三紀甲子元曆始悟以月食推驗日宿度所在又五十七年何承天造元嘉歷始悟以朔望及皆定大小餘及以晷景驗气又六十五年祖衝之造大明歷始悟太陽有嵗差之數極星去不動處一度余又五十二年張子信始悟日月交道有表裏五星有遲疾畱逆又三十三年張冑造大業歷始立五星入气加減法及月應食不食術劉焯造皇極歷始悟日行有盈縮及立推黃道月道又三十五年傅仁均造戊寅元歷頗采舊議始用定朔又四十六年李淳風造麟徳歷以古歷章蔀元首分度不齊始爲總法用進朔以避晦晨月見又六十三年一行造大衍歷始以朔有四大三小定九服交食軌漏之異及創立嵗星差合術又九十四年徐昂造宣明歷始悟日食有气刻時三差人七十二年邊岡造崇歷始立相減相乘法以求黃道月道又六十三年王朴造欽天歷始變五星法遲畱逆行舒亟有漸又九十八年周琮造明天歷始悟日法積年自然之數又三十六年姚舜輔造紀元歷始悟食甚泛余差數以上計千一百八十二年曆經七十攺其創法者十有三家自是又百七十四年聖朝専命臣等攺修新曆臣等用創造簡儀髙表憑其測實數所考正者凡七事一日冬至自丙子年立冬後依每日測到晷景逐日取對冬至前後日差同者爲凖得丁丑年冬至在戊戌日夜半後八刻半又定丁丑夏至在庚子日夜半後七十刻又定戊寅冬至在癸邜日夜半後三十三刻巳邜冬至在戊申日夜半後五十七刻庚辰冬至在癸丑日夜半後八十一刻各減大明歷十八刻逺近相符前後應凖二曰嵗余自大明歷以來凡測景驗气得冬至時刻眞數者有六用以相距各得其時合用嵗余考驗四年相符不差仍自宋大明壬寅年距至今日八百一十年每嵗合得三百六十五日二十四刻二十五分其二十五分爲今歷嵗余合用之數三曰日躔用至元丁丑四月癸酉望月食旣推求日躔得冬至日躔赤道箕宿十度黃道箕九度有奇仍憑每日測到太陽躔度或憑星測月或憑月測日或逕憑星度測日立術推算起自丁丑正月至巳邜十二月凡三年共得一百三十四事皆躔於箕與月食相符四曰月離自丁丑以來至今憑每日測到逐時太陰行度推算變從黃道求入轉極遲疾並平行處前後凡若干轉計五十一事內除去不眞的外有三十事得大明歷入轉後天又因考驗交食加大明歷三十刻與天道合五曰入交自丁丑五月以來憑毎日測到月道去極度數比擬黃道去極度得月道交於黃道出入度仍依日食法度推求皆有食分得入交時刻與大明歷所差不多六曰二十八宿距度自漢太初歷以來距度不同互有損益大明歷則於度下余分附以太半少皆私意牽就未嘗實測其數今新儀皆細刻周天度分毎度爲三十六分以距綫代管窺宿度余分並依實測不以私意牽就七曰日出入晝夜刻大明歷日出入晝夜刻皆據汴京爲凖其刻數與大都不同今更以本方北極出地髙下黃道出入內外度立術推求毎日日出入晝夜刻得夏至極長日出寅正二刻日入戌初二刻晝六十二刻夜三十八刻冬至極短日出辰初二刻日入申正二刻晝三十八刻夜六十二刻永爲定式所創法凡五事一曰太陽盈縮用四正定气立爲升降限依立招差求得毎日行分初末極差積度比古爲宻二曰月行遲疾古歷皆用二十八限今以萬分日之八百二十分爲一限凡析爲三百三十六限依垜疊招差求得轉分進退其遲疾度數逐時不同蓋前所未有三曰黃赤道差舊法以一百一度相減相乘今依算術勾股弧矢方圓斜直所容求到度數積差差數與天道實脗合四曰黃赤道內外度據累年實測內外極度二十三度九十分以圓容方直矢截勾股爲法求毎日去極與所測相符五曰白道交周舊法黃道變推白道以斜求斜今用立渾比量得月與赤道正交距春秋二正黃赤道正交一十四度六十六分擬以爲法推逐月毎交二十八宿度分於理爲盡十九年恂卒時歷𨿽頒然其推步之法與夫立成之數尙皆未有定稿守敬於是比次篇類整齊分秒裁爲推步七卷立成二卷歷議擬稿三卷轉神選擇二卷上中下三歷注式十二卷二十三年繼爲太史令遂上表奏進又有時候箋注二卷修攺源流一卷其測驗書有像象法式二卷二至晷景考二十卷五星細行考五十卷古今交食考一卷新測二十八捨雜坐諸星入宿去極一卷新測無名諸星一卷月離考一卷並藏之官

大統歷志卷八

