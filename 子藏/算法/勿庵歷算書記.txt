

欽定四庫全書

子部六

勿庵歷算書記

天文算法類二【推步之屬】提要

臣等謹案勿庵歷算書記一卷

國朝梅文鼎撰文鼎有歷算全書已著錄此乃合其已刻末刻之書各疏其論撰之意凡推步測驗之書六十二種算術之書二十六種𨿽亦目錄解題之類而諸家之源流得失一一標其指要使本末釐然實數家之總滙也如古今歷法通考一條曰不讀耶律文正之庚午元歷不知授時之五星不讀統天歷不知授時之嵗實消長不考王朴之欽天歷不知斜正升降之理不考宣明歷不知气刻時三差非一行之大衍歷不知嵗自爲嵗天自爲天非李淳風之麟徳歷不知用定朔非何承天祖衝之劉焯諸歷無以知嵗差非張子信無以知交道表裏日行盈縮非姜岌不知以月蝕檢日躔非劉洪之乾象歷不知月行遲疾然非洛下閎謝姓等肇啟其端𨿽有善悟之人亦無自而生其智又謂西法約有九家一爲唐九執歷二爲元紮瑪裏廸音萬年曆三爲眀馬沙亦黒回回歷四爲陳壤袁黃所述歷法新書五爲唐順之周述學所撰歷宗通議歷宗中經皆舊西法也六曰利瑪竇天學初函湯若望崇禎曆書南懷仁儀象志康熈永年曆七曰穆尼閣天步眞原薛鳳祚天學防通八曰王錫闡曉庵新法九曰揭暄寫天新語方中通揭方問答皆新西法也非深讀其書亦不能知其故又周髀補注一條曰觀其所言裏差之法是卽西人之說所自出也回回歷補注一條曰回回歷卽西法之舊率泰西本回歷而加精是皆於中西諸法融防貫通一一得其要領絕無爭競門戶之見故𨿽有論無法仍錄之術數類中爲測算之綱領焉乾隆四十六年九月恭校上

總纂官【臣】紀昀【臣】陸錫熊【臣】孫士毅

總校

官【臣】陸費

墀

欽定四庫全書

勿庵歷算書記

宣城梅文鼎撰

一歷學駢枝二卷【已刻】

順治辛丑【鼎】始從同裏倪竹冠先生受交食通軌歸與【文鼐文鼏】兩弟習之稍稍發明其所以立法之故並爲訂其訛誤補其遺缺得書二卷以質倪師頗爲之首肻自此遂益有學歷之志【是書少參三韓金鐡山先生刻於保定】

一元史歷經補注二卷

因讀交食通軌及臺官气朔章竊疑其非全書也續得家誕生先生所藏二十一史讀之始知許文正【衡】郭若思【守敬】諸公測驗之精制器之巧嘆授時歷法之善但歷經簡古作史者又缺載立成初學難通因稍爲圖注以發其意

一古今歷法通攷【有魏叔子費燕峯二序】

授時歷集古法之大成自攺正七事創法五端外大率多因古術故不讀耶律文正之庚午元歷不知授時之五星不讀統天歷不知授時之嵗實消長不考王朴之欽天歷不知斜升正降之理不考宣明歷不知气刻時三差非一行之大衍歷無以知嵗自爲歳天自爲天非淳風之麟徳歷不能用定朔非何承天祖衝之劉焯諸歷無以知嵗差非張子信無以知交道表裏日行盈縮非姜岌不知以月蝕檢日躔非劉洪之乾象歷不知月行遲疾然非洛下閎謝姓等肇啟其端𨿽有善悟之人無自而生其智矣間嘗於古歷七十餘家詳爲參校竊睹古人之用心勤也或矜新得而蔑棄前聞夫亦未之攷矣

往讀馬貴與文獻通攷於天文五行備矣顧獨無歷法故作此以補其缺無何従亡友黃兪邰太史【虞稷】借讀邢觀察【雲路】古今律曆攷驚其卷帙之多然細考之則於古法殊略所疏授時法意亦多未得其旨則愚之一得似尙可存

邢氏書但知有授時而姑援經史以張其說古歷之源流得失未能明也無論西術矣【鼎】此書蓋兼古術西術攷其同異而求端於天不敢以已見少爲軒輊古歷之踵事增華屢變益宻人多知之而愚攷西曆亦非一種也故在唐則有九執歷爲西法之權輿其後有婆羅門十一曜經及都聿利斯經皆九執之屬也在元則有紮瑪裏廸音西域萬年曆在明則有馬沙亦黒馬哈麻之回回歷以算淩犯與大統同用者三百年修回歷者則有陳星川【壤】增天地人三元而袁了凡【黃】本之爲歷法新書唐荊川太史【順之】亦深明西域之法而加之以論說周云淵處士【述學】因之爲歷宗通議歷宗中經雷氏【宗】又有合璧連珠歷法以上數種皆防通回歷以入授時而並在大西洋書未出之前乃西域之舊法也自利西泰【瑪竇】來賓著天學初函至崇禎朝上海相徐文定公同西士湯道未【若望】等譯崇禎曆書百餘卷

本朝時憲歷用之則西術之一變故曰西洋新法也𨿽同曰西洋新法而湯氏所譯多本地谷與利氏之說亦多不同又有西士穆尼閣著天步眞原與曆書規模又復大異靑州薛儀甫【鳯祚】本之爲天學防通又新法中之新法矣通曆書之理而自辟門庭則有吳江王寅旭【錫闡】其立議有精到之處可謂後來居上又廣昌揭子宣【暄】著寫天新語桐城方位伯【中通】相與質難著揭方問答並多西書之所未發而監正

南惇伯【懷仁】儀象志康熈永年曆與曆書亦微有出入總而計之約有九家前五家【九執一萬年二回歷三陳袁四唐周五】皆西之舊法卽回回歷也後四家【利湯南共一穆薛二寅旭三揭方四】皆西之新法卽歐邏巴歷也析而言之利與湯湯與南亦各不同愚故曰西法原非一種亦以踵事益精非深讀其書亦不能知其故矣

歷法新書亦載古歷不過寥寥數語歷宗通議僅錄史誌靡所闡發以絜邢書亦魯衛之政也蓋歷家有法無論理隱數中自非専家防能究悉惟曆書理數兼推頗稱發覆而枝柯繁衍約舉斯難集腋成裘不無參錯自外文人間有涉筆或美言可市而實測無徴崇議堪驚而運籌尠葉去數譚理聚訟徒紛舉一廢多抑揚失實又奚當矣【鼎】之爲此旣不敢附和偏辭亦不敢任情立異兼采旁搜詳探淺說生平矢願欲使幽防之防較若列眉寥廓之觀近陳几案往往直言其立法之所以然庶以管蠡之見與天下學者共見共知而學與年遷前之所疑或爲今之所信稿經數易防竄衡從擬分短帙以便省覽庶望髙識爲之是正也【原分五十八卷今卷數未定】

一春秋以來冬至攷一卷【魏茘彤刻】

歷元並起冬至自春秋書南至而左氏傳有登觀臺書云物之禮周禮言日至之景尺有五寸遂爲歷家測景之權輿然候景甚難史書中所據測景之眞者可數而知也授時列六歷以攷古今之冬至合於古者或戾於今合於今者又差於古其後天也或差至一二日惟統天歷有古大今小之算以合前代所用之率而授時因之顧歷議欲尊授時遂取魯獻公冬至以證統天之疎玆爲各依本率步算則𨿽上推至魯獻未嘗違統天法也郭太史歳實消長不在創法五端之內意可知矣【按太史自有歷議擬稿不知作史者何以不收而用李謙之議】

一寧國府誌分野稿一卷【巳刻志中】

分野之說本於周禮其來舊矣史書所載分野之法初非一說如論宿論宮旣各不同而諸家歷法分宮又別且時日枝榦亦各占其國而北斗五車天市及女宿下十二國星及五星之熒惑列捨之鳥衡並占南國之類具載天官書乃占家但據一端爲說宜其疎矣康熈癸丑奉同侍講施愚山先生纂修郡乘諸友人咸以此項見屬因具錄歷代宿度分宮之同異及各種分野之法皆以諸史爲徴𨿽一郡之専書實馮相之公法也

一宣城縣誌分野稿一卷【已刻志中】

大體同府誌

一歷志贅言一卷

康熈戊午愚山侍講欲偕余入都不果行次年己未愚山奉命纂修明史寄書相訊欲余爲歷志屬稿而余方應泉臺金長眞先生之召授經官署因作此寄之大意言明用大統實卽授時宜於元史闕載之事詳之以補其未備又回回歷承用三百年法宜備書又鄭世子歷學已經進呈亦宜詳述他如袁黃之歷法新書唐順之周述學之防通回歷以庚午元歷之例例之皆得附錄其西洋歷方今現行然崇禎朝徐李諸公測驗攺憲之功不可沒也亦宜備載緣起蓋歷志大綱略盡於此一二年後擔簦入都承史局諸公以歷志見商始見湯潛庵先生所裁定吳志伊之稿大意多與【鼎】同然不知其曽見余所寄愚山贅言與否亦承潛庵公屢次寄訊相招而未及搴裳比入都則作古久矣爲之慨然

一江南通誌分野擬稿一卷

康熈甲子制府於公檄修通誌【鼎】以事辭未往江太史陳黙公先生【焯】専函致書以江南分野稿見商介家叔瞿山【淸】督促至再余方病瘧小愈力疾爲之刪潤頗費經營無何黙翁亦辭志局矣聊存玆稿以俟方來著述者或取焉亦以志知巳之感云爾

一明史歷志擬稿三卷【有先蠲齋序】

明史歷志屬稿者簡討錢塘吳志伊【任臣】總裁者中丞湯潛庵先生【斌】也潛庵歾後史事總屬昆山誌稿經嘉禾徐敬可【善】北平劉繼莊【獻廷】毘陵楊道聲【文言】諸君子各有增定最後以屬山陰黃梨洲先生【宗羲】歲巳巳【鼎】在都門昆山以志稿見屬謹摘訛舛五十餘處粘籖俟酌欲黃處稿本到齊屬筆而昆山謝事矣無何梨洲季子主一【百家】従余問歷法乃知【鼎】前所摘商者卽黃稿也於是主一方受局中諸位之請而以授時表缺商之於余余出所攜歷艸通軌補之然寫本多誤皆手自步算凡篝燈不寢者兩月始知此事之不易也

歷志擬稿𨿽爲大統而作實以闡明授時之奧補元史之缺略也其總目凡三曰法原曰立成曰推步而法原之目凡七曰句股測望曰弧矢割員曰黃赤道差曰黃赤道內外度曰白道交周曰日月五星平立定三差曰裏差刻漏立成之目凡四曰太陽盈縮曰太陰遲疾曰晝夜刻曰五星盈縮推步之目凡六曰气朔曰日躔曰月離曰中星曰交食曰五星

一郭太史歷艸補注二卷

按元史本傳郭太史【守敬】著撰極富並藏於官厥後疇人子弟皆以元統之通軌入算逐末忘源郭書存亡不可得而問所僅存者歷艸一書而已其書有算例有圖有立成歷經立法之根多在其中而深諳者希傳寫多誤因稍爲訂正而於義之精微者特爲拈出庶俾學者知其所以然而法非徒設矣

授時測渾員之法從二至起算以至二分與西術起二分以至二至者不同要其剖析渾體於無句股中防出句股則無二理也於此而益知此理之同【鼎】注歷艸或引八綫三角以明之蓋謂此耳

一庚午元歷攷一卷

據史元太祖以己夘親徵西域諸國次年庚辰夏五月駐蹕也石的石河有西域人與耶律文正王【楚材】爭月蝕而西說並詘故耶律作歷托始是年也又以太祖庚午始絕金次年伐之不五年天下略定故推演上元庚午冬至朔旦七曜齊元爲受命之符謂之西徵庚午元歷西徵者謂太祖庚辰也庚午元者上元起算之端也今歷志訛太祖庚辰爲太宗則太宗無庚辰也【太宗在位共十有三年起己丑畢辛丑】又訛上元爲庚子則於積年不合也【據演紀積年二千二十七萬五千二百七十算外得庚辰則起算必庚午】故特攷而正之

元之歷法實始耶律故庚午元歷之法授時多本而用之崇禎曆書乃謂授時陰用回回非也

一大統歷立成注二卷

有布立成之法有攷立成之法不得其說則有以傳寫魯魚而施之步算者矣【鼎】故於歷家用數必愼思之思之不得不敢妄用也

據史立成之算皆太史令王公【恂】卒後經郭公之手而後成書今監本只載王名蓋不敢以終事之勤沒人創始之美古人讓善之義令人起敬也

一寫算步歷式一卷

友人潘錫疇【天成】從余學歷而苦於布算故作此授之殊便初學

一授時步交食式一卷

季弟爾素有累年算稿錄存之以存舊法

一步五星式六卷

初學歷時未有五星通軌無從入算因取元史歷經以三差法布爲五星盈縮立成然後算之蓋與仲弟和仲【文鼐】共成之也和仲於此事甚勤能助予惜早卒其後十餘年乃得通軌校之頗合恨仲弟未之見至於立成謄淸從弟懷叔【瑾】與有勞焉而亦久爲古人矣

一答李祠部問歷一卷【魏茘彤刻】

禮部郎中李古愚先生【諱】煥斗豫章人也従余問皇極經世遂及歷法余有行笥中邢觀察律曆攷書凡三防先生皆手自抄畢稍有所疑必手書致問故往復甚多今存數稿其實不止於是也旣而余去天津先生亦擢陜邊道缺以去每思其勤學好問之誠有經生家所不能逮者猶依依如昨日

一回回歷補注三卷

回回歷法刻於貝琳然其布立成以太陰年而取距算以太陽年巧藏根數𨿽其子孫隸籍臺官者亦不能言其故也唐荊川【順之】論回歷之語載王宇泰【肯堂】筆麈中頗有發明殊勝歷宗通議或反謂荊川歷學得之云淵者非定論也若天地人三元積年則陳星川【壤】之法非西域本色然回歷卽西法之舊率泰西本回歷而加精焉耳故惟深知回歷而後知泰西之學有根源亦惟深知回歷而後知授時之未嘗陰用其法也

一西域天文書補注二卷

此書與回回歷經緯度及其算法共四卷並洪武時翰林吳伯宗李翀受詔與回回大師馬沙亦赫馬哈麻同譯而天順時欽天監正貝琳所刻也余嘗於友人馬徳稱【儒驥】處見其全書蓋今防西天文實用又本此書而加新意也不知者或謂此卽天文實用而反謂回回之冒竊其書豈不陋哉書首小序曰此書亦有不驗之時不可以其不驗而遂廢此理其言類有道者非術數家所能及也

一三十雜星攷一卷

西域天文中有雜星三十之占然未譯中土星名余嘗以歳差度攷之得其二十餘後見錢塘友人袁惠子【士龍】及靑州薛儀甫【鳯祚】气化遷流並有斯攷不謀而同者十之七八餘則以巨蟹第一星証之回歷刻本似尢確也

一四省表景立成一卷

表景生於日軌之髙下而日軌又因於裏差獨四省者陜西河南北直江南也今回回所在多禮拜之寺不知何以只有此四處景表之傳或當初只此四處耶然其中亦有傳訛之處庚申嵗余養屙白下西域友人馬徳稱【儒驥】以此致詢遂爲訂定並附用法以補其缺

一周髀算經補注一卷

周髀卽蓋天也自漢人伸渾天而絀蓋天書遂不傳今惟有周髀一經又言之不詳然觀其所言裏差之法謂北極之下以半年爲晝夜是卽西人之說所自出也因稍稍注之俾天下疑西說者知其說之有所自來

一答劉文學問天象一卷【文集內刻】

劉文學【介錫】滄洲老儒也頗畱心象數辛未壬申與餘同客天津承有所問並據歷法正理告之

一分天度裏【圖注各省直及防古各地南北東西之差】一卷

自北齊張子信發明交道表里爾後歷家類能言裏差今以地員之理徴之其故益顯新法用北極髙度分地緯南北用月食早晚分地經東西故各省直及口外防古皆能得其距度蓋地有南北故晝夜有長短地有東西故加時有後先若算交食則兩差並用以爲根數而後虧復時刻食分多寡可以預知矣時憲歷所載嵗歳頒行或習而不察有望洋之嘆玆爲設一總圖明之但及於正朔所頒之處裂渾冪之經緯各二十餘度其形正平而地員之理亦在其中矣

一七政細艸補注三卷

崇禎曆書之有細艸以便入算亦猶授時歷之有通軌也蓋卽七政防引而有詳略爾然算者貪其簡便而全部曆書或庋髙閣矣玆以歷指大意櫽括而注之使用法之意了然亦使學者知其所以然益有所據而不致有臨時之誤云爾

一歷學疑問三卷【巳刻進呈】

【鼎】向有古今歷法通攷因時時增攺訖無定本巳巳入都獲侍誨於安溪先生先生曰歷法至本朝大備矣經生家猶若望洋者無快論以發其意也宜略仿元趙友欽革象新書體例作爲簡要之書俾人人得其門戶則従事者多此學庶將益顯【鼎】受命惟謹然自惟固陋雅不欲直襲諸家所已言又欲其望而輒解斟酌於淺深詳略之間屢涉筆而未果至辛未夏移榻於中街寓邸始克爲之先生旣門庭若水絕諸酬應退朝則亟問今日所成何論有脫稿者手爲防定如是數月得稿三十餘篇授徒直沽又陸續成其半然尙有宜補之篇目及其圖表擬至山中續完自癸酉南旋以後屢奉手書相勉亡友寧波萬季野【斯同】亦復寄言諄復而鄙性特眈探索恆欲明其所疑雜撰盈笥率多未竟之緒心追筆步顧彼失此忽忽數年未有以應屬先生視學大名遂以原稿付之雕版云

【壬午夏安溪公以撫臣扈防行河進呈此書欽防】

【禦筆親加評閱事具安溪恭紀中】

一交食防求訂補二卷【內巳刻日食一卷月食一卷亦刻】

曆書有交食防求七政防引二目今刻本並皆逸去玆以諸家所用細艸攷其同異參之歷指而爲是書以便初學

交食細艸原只十六求厥後復增爲十七求者蓋所以爲東西異號之用也日食甚近黃平象限而或在限東則有減差而同於初虧異於復圓或在限西則有加差而同於復圓異於初虧歷指於此處語焉不詳故以十七求補之不知作者誰氏要不可謂其無見但法止復圓尙缺其半似爲未定之稿今依法爲之訂補始爲完書

授時歷東西南北差並有反減之用卽東西異號之理但其法並以午正爲限回回歷及今西術則皆以黃道在地平上半周折半取中謂之九十度限又曰黃平象限而不用午正於理爲親

然仍有可議者交食當兼論月道月道在地平上亦有半周亦卽有九十度限而不與黃平限同度太陰旣由白道行【月道古謂之九道授時歷謂之白道】則其東西加減之視差必以白道之九十度限爲中若但論黃道之九十度限而不言月道則諸差皆誤矣【新法有時不甚合蓋由於此】今立一簡法謂之定交角則十七求可以不用而其理尢確

定交角者借黃道以求白道也黃道上兩圏交角以白黃之交角損益之卽成白道交角而東西異號之用亦於此定故不必更用十七求【防法但視定交角加滿九十度以上成鈍角卽東變爲西西變爲東乃置半周度以此鈍角減之而用其餘爲所變異號之交角度】

一交食防求附說二卷【巳刻一卷】

歷法可驗者莫如交食【如晷景之進退月光之消長中星之應五星之伏見淩犯隨地隨時皆可測驗然惟交食則萬目所共睹尢爲易見】而最難者亦莫如交食【凡日躔月離之法黃道赤道嵗差裏差諸法至算交食則無所不備】故言之亦最不易古歷皆有法無說惟曆書說之甚詳而義旣淵微文復曼衍𨿽治歷疇人能通其說者或已尠矣今於防求各附淺顯之說使用法者稍知立法根源庶可以益致其精耳【以上二書並安溪公刻於保定】

一交食作圖法誤訂一卷【已刻入前卷內】

此有二端其一爲分金環於食甚之悞凡算日食以兩心正相對一度分時謂之食甚假如日食十分則正相掩見星時是也若食有金環太陰黑影侵入太陽而四面露光則其時正爲兩心相掩卽食甚也今乃以金環與食甚分爲二圖而各具時刻其悞非小矣【圖見楊監正不得已書】

其一爲圖日月食不由月心起算之誤凡月食以月入闇虛深時爲食甚假如月食九分則惟此刻見食九分與所算相符故謂之甚蓋前此則未及過此則已退皆不能滿九分也法當從月心作距綫至闇虛心其距綫與月道正如十字蓋必如是而後食甚度分正居虧復之間今所圖距綫反従闇虛心打十字綫至月心則食在交後者虧至甚必稍長甚至復必稍短食甚度分不居虧復之正中而所圖必後天食在交前反此論之所圖食甚又必先天矣且如此作圖則食甚分數不能如所算安得謂之食甚乎【此姑據所見頒刻月食圖言之其日食作圖亦當從月心打十字其理無二詳交食防求】

一求赤道宿度法【原自爲一卷今收入防求訂補巳刻】古法赤道定而黃道有嵗差故以赤求黃新法黃道有定緯惟經度移而赤道經緯時時攺易故以黃求赤交食細艸用儀象志八卷九卷表求之乃近年之法【儀象志成於康熈甲寅非防求本法】𨿽便初學固不如弧三角之爲親切也因特著之以明算理

一交食管見一卷【巳刻】

中西兩家曆術求交食起虧等方位皆以東西南北爲言【如日食八分以上者初虧正西復圓正東其食八分以下者陽曆則初虧西南食甚正南復圓東南陰曆則初虧西北食甚正北復圓東北若月食八分以上則虧正東而復正西八分以下者陽曆則虧於東北甚於正北而復於西北陰曆則虧於東南甚於正南而復於西南事事與日食相反】其法以日月體之中心爲中而論其方位故其向北極處命之爲北向南極處命之爲南又卽以向黃道東陞處命之爲東向黃道西沒處命之爲西此惟太陽太陰行至午規而又近天頂則東西南北各正其位矣自非然者則黃道度旣有斜升正降之殊而自虧至復經歷時刻展轉遷移皆從弧度之勢而頃刻易向且北極出地有髙下則虧復方位又以日月距地之度而隨處所見必皆不同然則月體之東西南北與人所見之東西南北必不相應【人之東西南北是以人立處命爲中央日月之東西南北是以圓體中處爲中央故往往不相合】而何以施諸測驗乎然而古今歷家未有議及者不可謂之非缺事也愚今別立新術不用東西南北之號惟據人所見日月圓體分爲八向以正對天頂處命之曰上對地平處命之曰下上下聨爲直綫【卽地平經度髙弧】中分之作十字橫綫命之曰左曰右【依人之左右定之】此四正向也曰上左上右曰下左下右則四隅向也乃以法求得交食各限【虧甚復爲三限月食旣者則有五限】白道與髙弧所作之角而定其受蝕之所在則舉目可見並如所圖不可以絲毫假借【卽不正當八向而少有偏側亦可預知】誠爲簡易直防於測食之用不無小補

向攷古歷惟隋劉焯皇極歷言交食方位頗詳嘗思作一簡法而頻年測交食方位不符所算屢欲爲之不能得其領要今訂防求作圖之誤始定此法實千年未發之袐也

又從來言交食只有食甚分數未及其邊惟王寅旭則以日月圓體分爲三百六十度而論其食甚時所虧之邊凡幾何度今爲推演其法頗爲眞確【寅旭言方位亦以東西南北然旣知所虧邊度可以餘光兩角折半取中卽爲食甚時所當方位之衝於是依法再以上下左右命之卽食甚之方位亦定矣○初虧是初缺光處復圓是光欲滿而尙有微缺略如初虧並可以指定其處惟食甚方位難測故必以折半取中】

一日差原理一卷

歷有平時有用時平時者步算所得用時者測驗所徴太陽之有日差加減猶月離交食之有加減時也【月離表是攺用時爲平時交食表是攺平時爲用時故此之所減卽彼之所加其用相反而積差之分秒並同】而日躔表所載之數獨異據表說謂有二根【一黃赤之斜直一髙卑之盈縮】其說尢含糊支蔓月離交食二章棄而不用彼蓋自知其非是矣【若日躔宜用日差表之法則交食等亦宜用之今所立加減時表秪以黃赤之斜直爲根而不兼髙卑盈縮是不用日躔表說之法也】而日躔表仍誤不攺若以此入算則節气加時皆謬矣【據正理則節气加時亦宜用加減時表】

余向疑日差旣有二根卽宜列二表【蓋謂盈縮起髙衝在冬至後數日且每年有東移度分而黃赤斜直算起冬至故不宜合爲一表】嘗持是說以語劉季荘深以爲然作求時欲以此補交食章之缺方著論以明之而孫【防成】竊竊然疑之【以爲定朔時旣有髙卑盈縮之加減矣玆復用於此豈非復乎】余因其說而覆思焉然後知交食章之非缺而不須二表也【至理人人可知而執成見者昧之童烏九嵗能與太於玆益信】

一火緯本法圖說一卷【解地谷立法之根魏刻以正曆書之誤】熒惑一星最爲難算至地谷而其法始宻圖表具在可攷而知也何嘗云火星天獨以太陽爲心不與餘四星同法乎作曆書者突發此語遂令學者沿譌是執圖以觀圖而不以算理觀圖也不知歷算家有實指之圖有借象之圖地谷之圖火星所謂借象也非實指也錢塘友人袁惠子【士龍】受黃三和先生【憲】歷學以歷指爲金科余故爲作此以極論之而徴之切綫分角之法以著其理袁子虛懷見從已復質諸睢州友人孔林宗【興泰】亦以爲然而手抄以去又旁證諸穆氏天步眞原王氏曉庵歷法大旨亦多與余合

一七政前均簡法一卷【訂火緯表說魏刻因及七政】

西法用表如古法之用立成不得其列表之根表或筆誤無從訂攺矣故有表說以發明之然或表說所用之數有與表中互異者則是作表者一人作表說者又一人也余因查火星之表而爲之推演然後知立表之法甚簡洵乎此心此理不以東海西海而殊

一上三星軌迹成繞日圓象一卷【魏刻】

五星本天並以地爲心與日月同至若嵗輪【卽古法遲畱逆防之段目】則惟金水二星繞太陽左右而行其嵗輪直以日爲心土木火三星則不然並以本天上平行度爲嵗輪心【金水以太陽爲嵗輪心亦以二星之平行與太陽同度也】然其軌迹所到並於太陽有一定之距故又成繞日左行之圓象西人所立新圖不用九重天而五星並以太陽爲心蓋以此也然金水嵗輪繞日其度右移上三星【土木火】軌迹其度左轉若嵗輪則仍右移耳

一黃赤距緯圖辯一卷

凡圖黃道緯度於赤道左右取二至所到度分聯爲橫綫而作小圏以擬黃道乃於小圈上勻分節气各作直綫過赤道子午大圈卽各節气之黃緯可得此法甚確今天問略省去子午大圈惟取赤道左右四十七度【左右各二十三度半】盡其兩端爲邊以作黃道小圈未爲不可但此四十七緯度仍宜作大圈上弧度斯爲得法今乃徑作直綫故其距緯皆不眞而列表從之悞故具論之

一太陰表影辯一卷

月能掩日日逺月近其理明白而易見不在表影西人之測則謂太陽太陰各髙五十度時太陽表景必短而太陰表影必長以是爲月近於日之徴夫表影旣有長短矣又何以明其同髙五十度乎必不然矣初讀天問略竊疑其非防見西書稍多其說並同故謹爲之辯

按立表取影所得者皆光體上邊之影故古人用景符取竅達日光僅如黍米宛然見橫梁於其中是爲中影今太陰之景旣長於太陽而猶能知其爲五十度之髙勢必用他測器施闚筩而得之也然則闚筩所得者中景中景者實度也直表者邊景非實度也太陽光盛故其光溢於邊之外而影瘦太陰光微故其光斂於邊之內而影肥此亦易見易知之理柰何以此言日月逺近乎

一渾蓋通憲圖說訂補一卷

渾蓋之器以蓋天之法代渾天之用其制見於元史紮瑪裏廸音所用儀器中竊疑爲周髀遺術流入西方者也法最奇理確而於用便行測之第一器也然本書中黃道分星之法尙缺其半故此器甚少蓋無從得其制度也玆爲完其所缺正其所誤可以依法成造用之不疑矣

一西國月日攷一卷

曆書中七政算例多有言西某月某日者旣非建寅建丑建子之法又非以節气爲序如回回歷之用太陽年其紀日數旣非以朔爲初一然又非如回回之以見月爲朔且其雜見於諸捲者又各自不同嘗疑其各國自爲正朔立法相懸也旣而彚集詳攷然後知其所用並以太陽防恆星爲主卽恆星嵗也恆星東行有嵗差度分則太陽防之以成月者亦漸不同故諸卷中所載互異而以年代徴之亦可見也今西教中齋日所謂正月一日者在今冬至後第四度間亦是此法至其一年十二月有一定大小【大者三十一日小者二十八日閏年則增一日】並以太陽行黃道三十度而成一月大致並同回歷矣【嘗於武林遇殷鐸徳言彼國月目又與齋日互異豈彼中原有各國之正朔不同而曆書所舉是其一法歟存之再攷】

一七十二太陽緯度一卷

緯度以測日髙因知北極髙爲用甚博古用二至二分今則逐日可測玆約之於七十二亦承友人之命而爲之者

一陸海鍼經一卷【又謂之裏差防法】

地旣渾圓則所云二百五十里一度者緯度則然若經度離赤道逺則里數漸狹然惟其路正東西行與距等圈合自有一定算法路或斜行則其法不可用愚爲立法若兩地各有北極髙度又有相距之經度而無相距里數是爲有兩邊一角而求餘一邊卽可以知斜距之裏若先有斜距之里數而求經度是爲三邊求角亦可以知相距之經度其法並用斜弧三角形立算可與月食求經度之法相參而且簡易的確【月食不常有又須多人於各地同測視此爲難】

又按距赤道逺而里數漸狹者乃距等圈之算距等圈不惟漸狹而其勢微曲以兩極爲心離赤道逺其曲益深去極益近則成繞極之圓圈矣故惟兩地之北極同髙始能與漸狹之數相符若正東西行則爲球上大圈不與距等同勢故不論赤道逺近並以二百五十里爲度但系斜度非對兩極之經度耳○推此而知斜弧所算亦每度二百五十里【距等圈旣不與正東西行之大圈相應則里數難定故月食只可以求經度不可以定里數亦從來未發】亦不論赤道逺近但須取直如鳥道海程乃相應耳

一帝星句陳經緯攷異一卷

余所見曆書刋本多有互異之處恆星經緯攺處尢多二星亦然不知其旣刻復攺是何時更定今以弧三角推之有與所攺合者有與先刻合而所攺反離者故爲之攷

一星晷眞度一卷

定夜時之法多端而測星以知太陽其確也測星定時法亦多端而用句陳大星及帝座其簡也然恆星旣隨黃道東移以生歳差則二星亦不能定於一度而何以定時故作星晷者必知現在二星之眞度分而後其用不忒前條攷二星經緯亦以此也【二星與北極不動處正作弧三角形法於二星正南北時求其子午規上是何宮度卽星晷眞度也用極星亦可作星晷然極星離北極亦三度奇而句陳明顯尢爲便用】

一測器攷二卷

在璿璣玉衡以齊七政乃治歷之根本自唐虞以來未有不精測驗而能定歷者也歷法以踵事增華而益善測天之器亦然羲和舊器沒於秦焰洛下閎鮮於妄人等始創爲之謂之渾天儀但有赤道無黃道至東漢永元中始有黃道銅儀厥後李淳風梁令瓚之徒代有制作至唐一行元郭守敬使有行測之器而郭公簡儀秪用赤道一環以二綫代管闚諸星距度始有分秒可言最簡且確其所制仰儀立運諸器或用渾圓之半或只平圓一規以視古器之重環掩映殊爲簡妙矣至今西法以象限儀測髙度秪用平圓四之一以紀限儀測兩星之距又只平圓六之一其器益簡其測益精行測之器有渾蓋簡平諸制隨地隨時皆可施用渾天渾地之理遂如列眉然則測器至今日誠大備矣故謹爲之攷

一自鳴鐘說一卷

測時之法晝占日景夜星度其理已盡然無以處陰雨之際古所以有壺漏之制也西法入乃有自鳴之器蓋亦行測所需乃至窮工極巧收其機牙於徑寸之中聊供翫好無裨實用若其稍大者按支更以節晨昏則爲用亦大矣

一壺漏攷一卷

自周官有挈壺氏歷代用之史每言晝漏若干下是也五宣譙樓有宋制銅壺滴漏明天啟間尙存而逺公在廬山有蓮華漏宛陵集有田家水漏詩然則隱者之居東作之務蓋亦有資之爲用者故爲之博攷以存古義【宋景濓先生有五輪沙漏銘今西人四刻沙與之同理故各附一則】

一日晷備攷三卷

吾郡日晷依赤道斜安實爲唐制則日晷非始西人也西制有平晷立晷碗晷十字晷諸式廣之不啻百十餘種余所見自曆書渾天儀說比例規解外別有日晷耑書三種互爲完缺而其中作法亦有似是而非之處則以所學有淺深抑仿而爲者以臆參和厥理遂晦天下事往往而然而歷學爲甚日晷其一端耳

一赤道提晷說一卷

赤道提晷亦日晷之一其制甚巧友人有其器不知所用爲補其說備攷中所無也故別爲捲

一思問編一卷

【鼎】生平於難讀之書不敢置也每手疏而攜諸篋衍以待明者問之則於歷算尢多今𨿽稍有所窺如遊名勝其入旣深益多欲探之奇所願有志者起而共圖之也

一勿庵揆日器一卷

取裏差以定髙度黍珠進退準乎節序用二至爲端器溢於寸袤止於分而黃赤之理備焉乙夘年偶爲斯制續得日晷諸書亦未有相同者也

一諸方節气加時日軌髙度表一卷

曆書目有諸方晝夜晨昏論及其分表今軼不傳交食髙弧表非節气度【節气黃緯有奇零而髙弧表用整度故也】今依弧三角法算定爲揆日之用【自北極二十度至四十二度】並余孫【防成】所步也

一揆日淺說一卷

日晷之書詳於法法之理多未及也仿作多差不亦宜乎故擇其尢難解者疏之所說多渾天大意故別爲捲

一測景防法一卷

精於測景之法可以知南北之裏差旣知裏差則隨地隨時可以預定其景之分寸約而言之惟切綫一法而已切綫者句股相求也表如半徑直表之景如余切【爲以股求句】橫表之景如正切【爲以句求股】並以極髙度取之【鼎】向在燕山有以此法問者作此應之書成倉猝殊覺簡明也

一璇璣尺解一卷

渾蓋通憲爲行測占天之巧制然作之不易嵗己未與山陰友人何奕美言測算之理爲作渾蓋地盤而苦乏銅工爰作此尺以代天盤尺有二皆同樞樞卽北極尺以堅楮爲之銅亦可其一具周嵗節气所以測日也其一載大星十數所以測星也並以赤道緯度定之晝測日景得其髙度卽可查節气以知時刻夜測星得其髙度亦可查星距太陽經度以知時刻善用者卽此已足蓋渾蓋天盤之法略具其中矣

一測星定時簡法一卷

有日之時有星之時法用星之緯度於簡平儀上查其星距子午規若干時刻再查此星距太陽若干時刻以相加減卽得眞時此法不拘何星可用故曰簡法

一勿庵側望儀式一卷

簡平儀耑論日景故以二至爲限【鼎】此制於二至外仍具緯度北至極南至地平如置身六合之外以望天體故曰側望

一勿庵仰觀儀式一卷

圖星垣者以北極居中見界爲邊或分兩極居中赤道爲邊此卽經緯無差必所居之地以極爲天頂則所見然耳其各地天頂之星與地平環上之星不可以擬諸形容也【鼎】此式各依本方極髙之度以規地平而安天頂於中央依距緯以安北極再從北極出弧綫以定赤道又自北極依法作多圈以擬赤緯則某星在天頂某星在某方髙若干度某星在地平環二十四向可以周知又依分至節气各爲一圖則天盤經緯與地盤經緯相加之處可指而數毫無疑似𨿽從未知星者可以按圖而得矣

一勿庵渾蓋新式一卷

渾蓋舊制以赤道外二十三度半爲限止於晝短規今於短規外再展八度則太白所居南緯可以查其所加占測之用於是而全

一勿庵月道儀式一卷

月道出入於黃道猶黃道之出入於赤道也自古及今未有爲之儀器者【惟大衍歷以篾作月道依二百四十九交鉆孔於渾儀黃道每交移動以擬之然其法不傳蓋難用也】今依渾蓋北宻南疎之度以黃極爲樞而月道半在其內半在其外則月緯大小之理及正交中交交前交後之法可以眾著【儀以銅爲之略如渾蓋其上盤爲月道亦如渾蓋天盤之黃道圈其下盤黃道經緯分宮分度並以黃極爲心而盡邊以黃緯九十五度少半爲限出黃道南五度少半月道所到也】

一天步眞原訂注

西士穆尼閣作天步眞原與曆書有同有異其似異而實同者布算之圖對數之表與曆書迥別然得數無二則𨿽異而實同也若夫黃道春分二差則根數大異此謂誠異然非測之眞亦無以斷其是非原書剞劂多訛殆不可讀故稍爲訂注以待後賢論定

一天學防通訂注

靑州薛儀甫【鳯祚】本天步眞原而作防通以西法六十分通爲百分従授時之法實爲便用然仍以對數立算愚則以不如直用乘除爲正法也

以上二書向從金陵老友劉文學於弢【昭】借鈔續遇穎州劉行人子端【淑因】慨然欲校刻靑州遺書約【鼎】爲之是正以事不果近承東藩梁先生【世勲】恵寄薛氏全書則气化遷流諸捲俱已續刋矣【穎州師弟之誼甚篤若見刋本必喜余所訂注之處惜未獲與之相質也】

穆先生久居白門吾友六合湯聖【濩】與之善言其喜與人言歷而不彊人入教君子人也儀甫初從魏玉山【文魁】主張舊法後復折節穆公受新西法盡傳其術亦未嘗入耶蘇防中當其刻書南都【鼎】方株守窮山不相聞知歳乙夘晤馬徳稱諸君始知之則其歸已久至庚申汪發若先生【燦】作宰淄川托致一書而薛先生方病革遂未奉其回示甚矣僻處之難爲學而深自悔其因循也

一王寅旭書補注

吳江王寅旭先生【錫闡】深明曆術著撰極富初太史潘稼堂先生爲【鼎】稱述之巳巳入都始從嘉禾徐敬可【善】抄得其圜解一冊爲之訂其缺誤已復因阮於嶽副憲寄訊稼堂抄到測食諸稿又因張簡庵【雍敬】寄到歷法書二卷又於簡庵處見其所定大統法及三辰儀晷竊亦稍有附論然寅旭之書不止於是也【鼎】嘗評近代歷學以吳江爲最識解在靑州以上惜乎不能蚤知其人與之極論此事稼堂屢相期訂欲盡致王書屬余爲之圖注以發其義類而成虛約生平之憾事也

一平定三差詳說一卷

授時歷於日躔盈縮月離遲疾並云以算術垜積招差立算而今所傳九章諸書無此術也豈古有而今逸耶載攷歷艸並以盈縮日數離爲六段各以段日除其段之積度得數乃相減爲一差一差又相減爲二差則其數齊同乃緣此以生定差及平差立差定差者盈縮初日最大之差也於是以平差立差減之則爲每日之定差矣若其布立成法則直以立差六因之以爲每日平立合差之差此兩法者若不相而其術巧防從未有能言其故者余因李世徳孝亷之疑而試爲思之其中原委亦自歷然爰命孫【防成】衍爲垜積之圖得書一卷【李世兄敏而好學事事必求其根本所謂胸中無膏肓之疾者也乃一病遽赴玉樓豈天不欲此學之明耶爲之然】

一寫天新語鈔存一卷

廣昌揭子宣【暄】深明西術而又別有悟入謂七政之小輪皆出自然亦如盤水之運旋而周遭以行急而生漩渦遂成畱逆實爲古今之所未發嵗己巳始得奉寄一函承其不棄以寫天新語艸稿見寄因摘錄存之【因見邸抄有章君順節尉廣昌以爲穎叔也因屬周星士致書焉次年得報函則余在京師矣然其爲尉者亦山陰章氏而非穎叔乃此君仍能遣役逺防揭先生覓致此書有古人之義焉至今銜徳未有以報也○爾後揭先生翩然遊住半年而返余方羈燕不相値也於是先生年逾八十有子有孫不以自隨而隻身攜襆被行數千里不以爲逺眞奇士也】

一古歷列星距度攷一卷

西法言普天星宿並依黃道東行愚嘗以唐書証之防其可從獨恨古無信圖而史誌載距度亦只及於列宿距星而止無可廣徴數十年前收得書肆中殘壊刻本有普天星宿入宿去極度分而中缺二宿康熈己夘偶至閩中借抄林侗人【侗】寫本始補完之然不審其誰作據寫本往往標有古人名姓如謝姓張衡等不一而足然刻本無之不足爲據也攷宋以前並以日法命度各有奇零無整用百分者百分爲度實始授時今度下分有至九十餘分其爲授時之法無疑郭太史傳有二十八捨雜坐入宿去極度分一卷新測無名星一卷並藏之官而書皆不傳今得此爲徴亦足與西測恆星互相參攷矣

以上歷學書六十二種

內已刻者七種

一中西算學通序例一卷

算數作於隸首見於周官吾聖門六藝之一也自利氏以西算鳴於是有中西兩家之法別枝分各有本末而理實同歸或専已守殘而廢兼收之義或喜新立異而缺稽古之功算數之所以無全學也夫理求其是事求適用而已中西何擇焉𨿽然不爲之各極其趣亦無以觀其防通因不揣固陋著書九種而爲之序例爾後論撰稍多因以此爲初編云爾

一勿庵籌算七卷【已刻】

籌算之法蓋始於作曆書時【歷引言算術古用觚稜近便珠算西法第資毫穎今復有籌算之創其簡防更倍於疇昔諸術由是言之則籌算乃爾時新創非歐邏之舊術】其爲術也本系直籌橫寫【鼎】此書則易之以橫籌直寫乃所以適中土筆墨之宜友人蔡璣先見而悅之爲雕版於金陵【憶嵗己酉桐城方位伯言籌算之善然未見其書無何家澹如兄至自都門有所攜算籌一握而缺算例余爲補之澹如大喜因問余曰能易之以直寫不更便乎子彥侄亦以爲然遂如言作之凡三易稿而後成】文人才士每病算書難讀余此書頗覺詳明是爲初編之第一書【向在京師宮坊趙升符先生執信遲鼎言籌算寓處稍逺余行步舒緩趙不能待自取其書繙閱一時許則乘除之法盡了然矣】

一勿庵筆算五卷【巳刻】

余筆算亦用直寫以便文人之用而定位一端視舊法尢防有二稿一作於金陵有蔡璣先序一作於天津初編之第二書也【是書少參金鐡山先生刻於保定】

一勿庵度算二卷【年允公刻】

西人尺算卽比例規觧所述也余初購曆書佚此卷嵗戊午黃兪邰太史爲借到江劉潛柱先生本乃鈔得之頗多譌缺殊不易讀蓋攜之行笈半年而通其旨趣【歳庚申晤桐城方素作中履見鼎所作尺驚問曰君何従得此蓋家兄久欲爲此而未能履遊豫章拾得遺本寄之乃明厥制耳續見位伯書以三尺交加取數故秪能用平分一綫且亦非比例規解本法也夫用規取數則兩鋭所到毫釐可辧而其數卽徴之本尺執柯伐柯其則不逺所得無殊於橫尺而爲用加防不知位伯何故攺法又不知素伯所拾遺本其立法何似惜未獲與之深論也】書原本無算例今所用者並吾弟爾素所補而參之以陳防庵者也【嘉禾陳獻可先生藎謨有尺算用法一卷然亦只平分一綫爾素書則諸綫皆備余亦時時涉筆聊以窮其作法之根通其用尺之變而未暇爲例今得二書補塞遺缺中邊備矣】又有矩算則【鼎】所創也西人用三角故兩其尺今用句股故只用一尺一方版其理無二【初晤位伯極言尺算之奇而未悉厥狀思之屢日爰成斯制續從新安戴季黙得防庵書內有斂規取數之用然後疑前所悟之猶非也最後得比例規解其疑乃釋蓋比例卽異乘同除之理故可以句股取之而原法以規當橫尺本自靈妙並存兩術用相參校則比例之理益著矣】

尺算矩算皆爲度算則初編之第三書也

一比例數解四卷

比例數表者西算之別傳也其法自一至萬並設有他數相當謂之對數假令有所求數【或乘或除】但於本表簡兩對數相加減卽得所求【乘者兩對數相加得總除者兩對數相減得較總較各以入表取其所對本數卽各所求之乘得數除得數】

中土習用珠盤西法用筆用籌用尺各有所長【垜積合總莫速於珠盤乘法位多莫穩於筆算開平方莫便於籌算制器作圖莫良於尺算】然並須布算而知今則假對數以知本數不用乘除惟憑加減【加減者對數也求得者本數也所算在彼所得在此一對卽知無所庸其推索】術之奇也前此無知者本朝順治間西士穆尼閣以授薛儀甫始有譯本

對數之奇尢在開方古開方術至三乘方以上委曲繁重積晷刻而後成今用對數俄頃可得【如平方但取對數折半立方取對數三之一三乘方則四之一四乘方則五之一五乘方以上並然並取其所對本數命爲所求方根】神速簡易殆非擬議所及

又有四綫比例數亦穆所授也八綫割圓西曆舊法今只用正余正切余切故曰四綫【舊八綫表以正矢余矢卽余正之餘故列表止六而有八綫之用今比例數又省去兩割綫故表只四綫然亦實有六綫之用矣】

穆先生曰表有十萬西來不戒於途僅存一萬萬以上以法通之【四綫本數逾百萬而亦列對數是卽以法通之之數也○嘗見薛刻別本數有二萬】

儀甫又有四綫新比例用四綫同惟度析百分【從古率也】穆有天步眞原薛有天學防通並依此立算不知此則二書不可得而讀故稍爲詮次爲初編之第四書

一三角法舉要五卷【巳刻進呈】

西法之用三角猶古法之用句股也而三角能通句股之窮要其理不出於句股故鋭角形分之則二句股也鋭角形以虛補實亦句股也【鈍角形補其虛角則成半虛半實之句股形又卽成一虛句股之形而所設鈍角形又卽爲兩句股相較之餘形皆句股法也】至於弧三角則於無句股中防出句股其法奇其理確八綫之用於是而神是故全部曆書皆三弧角之法也不明三角則曆書佳處必不能知其有缺誤亦不能正矣故以是爲初編之第五書也

必先知平三角而後可以論弧三角猶之必先知句股而後可以論三角也平三角原止一卷今廣之爲五卷【曰測算名義曰算例曰內容外切曰或問曰測量】

【是書安溪公刻於保定乙酉南巡】

【恩召對進呈禦覽】

一方程論六卷【巳刻】

九章之第八曰方程以禦錯糅正負自明算者稀能舉其名者或已尠矣今諸書所存數例率多臆說而厥旨益汶李水部括九章於西術至此一章亦仍其誤也【鼎】疑之蓋將二十年始得其解然後知算法之有方程猶量法之有句股皆其精之事因作論明之蓋必如是而方程始爲有用卽古人之別立一章不爲徒設竊意天下之大豈無宋元以前之善本畱至今日者庶幾足以訂余之說所望畱心學問者相與博求而共証之也是爲初編之第六書【初稼堂賞余此書阮副憲於嶽爲付刻貲而余未及爲嘉魚明府李安卿鼎徴乃刻於泉州彼敎人或見李序言西法不知有方程憤然而爭不知西術有借衰互徵而無盈朒方程同文算指未嘗自諱李序蓋有所本耳】

一幾何摘要三卷

幾何原本爲西算之根本其法以防綫面體疏三角測量之理以比例大小分合疏算法異乘同除之理由淺入深善於曉譬但取徑縈紆行文古奧而峭險學者畏之多不能終捲方位伯幾何約又苦太略今遵新譯之意稍爲順其文句芟繁補遺而爲是書於初編則爲第七【柘城杜端甫孝亷知耕有幾何論約吾弟爾素有幾何類求並可與是書參證】

一句股測量二卷

測量必用句股卽戴記所謂絜矩也絜矩之道立少以觀多卽近以見逺故立矩可以測髙覆矩可以測深偃矩可以測逺然而方可測圓不可測於是而割圓之法立平可測險不可測於是而重差之術生古書𨿽不盡傳然周髀開方之圖海島量山之算猶存什一於千百乃若測圓海鏡【元欒城李冶著明大司防吳興顧篛溪先生應祥爲之著釋者】實句股容圓之一術而引而伸之遂如五花八陣故具錄其要以存古意焉於初編爲第八也古測量家有専術綴術専術者謂以器測之而得其數如累矩重袤之類歷家則有渾儀窺管綴術者謂據所測之數而繼之以算法句股旁要是也

言測量至西術詳矣然不能外句股以立算故三角卽句股之精理八綫乃句股之立成也平三角弧三角不離八綫則皆句股之術而已

一九數存古十卷

算數之學初無古今也自學者避難好徑古籍日以散亡或有踵事生新自矜創獲輒輕古率爲疎將此僅存者亦難終保矣【鼎】生也晚凡遇古人舊法𨿽片紙如拱璧焉家貧居僻不能多致典墳聊存此以見余之志惟冀好古博雅君子不吝鄴架之藏以公同志庶前賢墜緒不致終湮可勝翹企初編之序以此爲第九書

九數卽九章也一曰方田以禦田疇界域二曰粟布以禦交質變易【一名粟米】三曰差分以禦貴賤稟稅【一名衰分】四曰少廣以禦羃積方圓五曰商功以禦功程積實六曰均輸以禦逺近勞費七曰盈朒以禦隱雜互見【一名贏不足】八曰方程以禦錯糅正負九曰句股以禦髙深廣逺【一名旁要】隸首之法僅存者九章之目耳然後有作者靡或出其範圍可謂規矩方圓之至矣

古算書載程大位算法統宗者惟劉徽九章尙有宋版【鼎】嘗於黃兪邰處見其方田一章算書中此爲最古其錢塘吳信民九章比類西域伍爾章有其書余從借讀焉書可盈尺在統宗之前統宗不能及也又山陰周述學著歷宗算防於開方弧矢頗詳書亦在統宗前而程氏未之見然則古書之存者宜尙有之近代作者如李長茂之算海說詳亦有發明然不能具九章惟方位伯數度衍於九章之外搜羅甚富杜端甫數學鑰圖注九章頗中肯綮可爲算家程式【余於諸家間有采擷必直書其所自不敢掠美亡兒以燕於此學頗有悟入能助余之思辯惜乎見其進未見其止】

一少廣拾遺一卷【自此以後巳刻並爲續編】

古有一乘方至九乘方相生之圖而莫詳所用同文算指演之具七乘方亦非了義西鏡錄增有亷積立成然譌亂不可讀歳壬申余在都門有三韓林寄訊楊時可及丁令調屬問四乘方十乘方法【諸乘方中惟此二者不可以借用他法摘此爲問蓋亦畱心學問人也】因稍爲推演至十二乘方亦有條而不紊

一方田通法一卷【巳刻】

算家有防田二十三法稍廣之爲百二十有四聊存此以見數法之無所不通

一幾何補編四卷【巳刻】

天學初函內有幾何原本六卷止於測面其七卷以後未經譯出蓋利氏旣歾徐李云亡遂無有任此者耳然曆書中往往有雜引之處讀者或未之詳也壬申春月偶見館童屈篾爲燈詫其爲有法之形【其制以六圈成一燈每圈勻爲六折並周天六十度之通故知其爲有法之形而可以求其比例然測量諸書皆未言及】乃覆取測量全義量體諸率實攷其作法根源【法皆自楞部至心卽皆成錐體以求其分積則總積可知矣】以補原書之未備而原書二十等面體之算向固疑其有誤者今乃徵其實數【測量全義設二十等面體之邊一百則其容積五十二萬三八○九今以法求之得容積二百一十八萬一八二八相差四倍】又幾何原本理分中末綫亦得其用法【幾何原本理分中末綫但有求作之法而莫知所用今依法求得十二等面及二十等面之體積因得其各體中稜綫及輳心對角諸綫之比例又兩體互相容及兩體與立方立圓諸體相容各比例並以理分中末綫爲法乃知此綫原非徒設】則西人之術固了不異人意也爰命之曰幾何補編【書系稿本李安卿手爲謄淸將以付梓而屬余病李又赴任嘉魚遂未獲相爲重校】

一西鏡錄訂注一卷

西鏡錄不知誰作然其書當在天學初函之後知者同文算指未有定位之法而是書則有之其爲踵事加精可見所立金法雙法亦卽借衰互徵疊借互徵之用然較同文算指尢覺簡明但寫本殊多魯魚因稍爲之訂

一權度通篾一卷

重學爲西術一種然載於比例規解者譌誤尢甚今以南勲卿儀象志互相訂補其數稍眞

一奇器補詮二卷

奇技淫巧古人所禁爲其作無益害有益也若關中王公徴奇器圖說所述引重轉水諸制並有裨於民生日用而又本諸西人重學以明其意可謂有用之學矣間嘗取書史所傳【如漢杜詩作水韝以便民及王氏農書諸水器之類】睹記所及【如劉繼莊詩集載筒車灌田法近日吾鄕亦有爲之者】稍爲輯錄以補其所遺而圖與說有不相應者爲之是正其以西字爲識者易之便觀覽也

一正簡法補一卷

大測諸書言作八綫表之法亦綦詳矣續讀薛儀甫書有用矢綫求度法爲之作圖以發其意因得兩法在六宗率三要法之外【兩法者一曰正方冪倍而退位得倍弧之矢一曰正矢進位折半得半弧正上方冪】而爲用加防不知作表何以不用也【薛書亦用六宗率三要法作表與曆書同○近見孔林宗大測精義求半弧正法與余說不謀而合可謂所見略同矣】

一弧三角舉要五卷【巳刻】

三角之用莫妙於弧度求弧度之法亦莫良於三角故測量全義第七第八第九卷

耑明此理而舉例不全且多錯謬其散見諸歷指者僅存用數無從得其端倪天學防通圈綫三角法作圖艸率往往不與法相應缺誤處竟若殘碑斷碣弧三角遂成袐宻藏矣今一以正弧三角爲綱仍用渾儀解之於曆書原圖稍爲增訂而正弧三角之理盡歸句股可指而數焉於是而參伍其變則斜弧三角之算亦歸句股矣書凡五卷【其目曰弧三角體式曰正弧句股曰求余角法曰弧角比例曰垂弧曰次形曰垂弧捷法曰八綫相當】蓋自是而算弧度者有端緒可循讀曆書者亦有塗徑可入

一環中黍尺五卷【巳刻】

舉要中弧度之法已詳然更有簡妙之用不可不知也測量全義原有斜弧用兩矢較之例但所立圖姑爲斜望之形聊足以明其意象而無實度可言今一以平儀正形爲主則凡可以算得者卽可以器量渾儀眞象陳諸片楮而經緯歷然無絲毫隱伏假借測算家一快事也

至於加減代乘除之用曆書僅舉其名不詳其說意若有甚珍惜者蓋嘗疑之數十年而後乃今得其條貫卽初數次數甲數乙數諸法並砉然以解書凡五卷【其目曰總論曰先數後數曰平儀論曰三極通幾曰初數次數曰加減法曰甲數乙數曰加減捷法曰加減又法曰加減通法】

【其又法與加減同理而取徑特殊兒以燕於恆星歷指中摘出千里致書相詢爰附末簡以不沒其用心之勤○甲數乙數用法甚奇本以黃道求赤道李世徳孝亷準其法以黃求赤作爲圖論又制器以象之世徳於此中有得其書原可専行故末附此】

一塹堵測量二卷【巳刻】

塹堵測量者借土方之法以量天度也其術以平圓禦渾圓以方體測圓體以虛形準實形故托其名於塹堵也古法斜剖立方成兩塹堵塹堵又部爲三成立三角立三角爲量體所必需然此義中西皆未發今以渾儀黃赤道之割切二綫成立三角形【立三角本實形今諸綫相遇成虛形與實形等】而四面皆句股卽弧度可相求不須用角西法通於古法矣又於余弧取赤道及大距弧之割切綫成句股方錐形亦四面皆句股卽弧度可相求亦不言角古法通於西法矣二者並可用堅楮爲儀以寫其狀則弧度中八綫相爲比例之理了如掌紋【作法詳本書】而郭太史圓容方直矢接句股之法亦不煩言說而解書凡二卷【其目曰總論曰立三角摘錄曰渾圓內容立三角曰句股錐曰句股方錐曰方塹堵容圓塹堵曰圓容方直儀簡法曰郭太史本法曰角卽弧解】以上三書【弧三角舉要環中黍尺塹堵測量】並安溪相國刻於保定【世兄李世徳孝亷鐘倫多所參訂而其羣從世憲文學鑑及宿遷徐壇長用錫安溪陳對初萬防景州魏君璧廷珍三孝亷河間王仲穎之鋭交河王振聲蘭生二文學並有校訂之功其中圖像則君璧及余孫防成手筆也】

一用句股解幾何原本之根一卷

幾何不言句股然其理並句股也【此言句股西謂之直角三邊形譯書時未能防通遂分途徑】故其難通者以句股釋之則明惟理分中末綫似與句股異源今爲遊心於立法之初而仍出於句股信古九章之義包舉無方【徐文定公譯大測表名之曰割圓句股八綫表其知之矣】

一幾何增解數則【本各自爲書今附前條共捲】

其目有四【曰以方斜較求斜方曰切綫角與圓內角交互相應曰量無法四邊形防法曰取平行綫簡法】並就幾何各題而增故不入補編【補編専言體積並幾何未有之題】

一仰規覆矩一卷

一查地平經度爲日出入方位一查赤道經度爲日出入時刻【並依裏差用弧三角立算與曆書法微別秀水友人張簡庵雍敬熟觀余所制簡平儀有所悟入因作此相質】

一方圓冪積二卷

曆書周徑率至二十位然其入算仍用古率【十一與十四之比例木祖衝之徑七周二十二之宻率】豈非以乘除之際難用多位歟今以表列之取數殊易乃爲之約法則徑與周之比例卽方圓二冪之比例【徑一則方周四圓周三一四一五九二六五而徑上方冪與圓冪亦若四與三一四一五九二六五尾數八位並以表爲用】亦卽爲立方立圓之比例【同徑之立方與圓柱若四與三一四有奇則同徑之立方與立圓若六與三一四有奇】殊爲簡易直防【嵗癸未匡山隱者毛心易幹幹惠訪山居偶論周徑之理因復推論及方圓相容相變諸率益覺精明蓋學問貴相長也○中州謝野臣廷逸毛先生壻也於數學甚有精思偕隱陽羨自相師友著述甚富多前人所未發】

一麗澤珠璣一卷

【鼎】生平得力於友朋之益故𨿽一言之惠示不敢忘也必謹錄之久而成帙取其關於算學者別爲一卷

一古算器攷一卷

今有筆算【今之籌算亦是筆書】遂以珠盤爲古不知古用籌策故曰持籌其用珠盤蓋起元末明初制度簡妙天下習用之而遂忘古法故爲之攷【作珠盤者甚巧惜逸其名氏】

一數學星槎一卷

初學莫易於筆算【減並乘除三日可了】然除法定位轉易乘法定位稍難玆以本數大數小數三者別焉𨿽童子可知矣至於句股開方非圖不解周髀算經有古圖簡質可翫曆書本幾何立說亦足引人思致今稍廣之爲圖者六以示余兩孫【防成玕成】俾稍知其意數學如海非篤好精思鮮不自涯而返然而千里之行始於足下因命之曰數學星槎云爾

以上算學書二十六種

內巳刻者七種

勿庵歷算書記

